(self.webpackChunk=self.webpackChunk||[]).push([[689],{13268:function(q,be,ae){"use strict";ae.d(be,{Lc:function(){return Z},lM:function(){return E},jb:function(){return a},nd:function(){return re},lv:function(){return Ae},me:function(){return Se}});var P=ae(8923),F=ae(30620),Y=ae(15002),w=function(){var Q=function(te,O){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,M){d.__proto__=M}||function(d,M){for(var T in M)M.hasOwnProperty(T)&&(d[T]=M[T])},Q(te,O)};return function(te,O){Q(te,O);function d(){this.constructor=te}te.prototype=O===null?Object.create(O):(d.prototype=O.prototype,new d)}}(),ye={GroupGuid:"{271bbba0-1ee7}"},U=function(){function Q(te){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates",expand:"expand"},this.type=Q,this.dataSource=te,this.pvt={}}return Q.prototype.processResponse=function(te,O,d,M){return te},Q}(),Z=function(Q){w(te,Q);function te(){return Q!==null&&Q.apply(this,arguments)||this}return te.prototype.processQuery=function(O,d){for(var M=O.dataSource.json.slice(0),T=M.length,b=!0,k,S,m={},x=0,v=[],y,A=0;A<d.lazyLoad.length;A++)x++,m[d.lazyLoad[A].key]=d.lazyLoad[A].value;for(var I={},A=0;A<d.queries.length;A++){if(S=d.queries[A],(S.fn==="onPage"||S.fn==="onGroup")&&d.lazyLoad.length){S.fn==="onGroup"&&v.push(S.e),S.fn==="onPage"&&(y=S.e);continue}k=this[S.fn].call(this,M,S.e,d),S.fn==="onAggregates"?I[S.e.field+" - "+S.e.type]=k:M=k!==void 0?k:M,(S.fn==="onPage"||S.fn==="onSkip"||S.fn==="onTake"||S.fn==="onRange")&&(b=!1),b&&(T=M.length)}if(x){var N={query:d,lazyLoad:m,result:M,group:v,page:y},z=this.lazyLoadGroup(N);M=z.result,T=z.count}return d.isCountRequired&&(M={result:M,count:T,aggregates:I}),M},te.prototype.lazyLoadGroup=function(O){var d=0,M=this.getAggregate(O.query),T=O.result;if((0,P.le)(O.lazyLoad.onDemandGroupInfo)){var S=O.group[0].fieldName;T=F.j.group(T,S,M,null,null,O.group[0].comparer,!0),d=T.length;var m=T;O.page&&(T=this.onPage(T,O.page,O.query)),this.formGroupResult(T,m)}else{for(var b=O.lazyLoad.onDemandGroupInfo,k=b.where.length-1;k>=0;k--)T=this.onWhere(T,b.where[k]);if(O.group.length!==b.level){var S=O.group[b.level].fieldName;T=F.j.group(T,S,M,null,null,O.group[0].comparer,!0)}d=T.length;var m=T;T=T.slice(b.skip),T=T.slice(0,b.take),O.group.length!==b.level&&this.formGroupResult(T,m)}return{result:T,count:d}},te.prototype.formGroupResult=function(O,d){if(O.length&&d.length){var M="GroupGuid",T="childLevels",b="level",k="records";O[M]=d[M],O[T]=d[T],O[b]=d[b],O[k]=d[k]}return O},te.prototype.getAggregate=function(O){var d=Y.A.filterQueries(O.queries,"onAggregates"),M=[];if(d.length)for(var T=void 0,b=0;b<d.length;b++)T=d[b].e,M.push({type:T.type,field:F.j.getValue(T.field,O)});return M},te.prototype.batchRequest=function(O,d,M){var T,b=d.deletedRecords.length;for(T=0;T<d.addedRecords.length;T++)this.insert(O,d.addedRecords[T]);for(T=0;T<d.changedRecords.length;T++)this.update(O,M.key,d.changedRecords[T]);for(T=0;T<b;T++)this.remove(O,M.key,d.deletedRecords[T]);return d},te.prototype.onWhere=function(O,d){return!O||!O.length?O:O.filter(function(M){if(d)return d.validate(M)})},te.prototype.onAggregates=function(O,d){var M=F.j.aggregates[d.type];return!O||!M||O.length===0?null:M(O,d.field)},te.prototype.onSearch=function(O,d){return!O||!O.length?O:(d.fieldNames.length===0&&F.j.getFieldList(O[0],d.fieldNames),O.filter(function(M){for(var T=0;T<d.fieldNames.length;T++)if(d.comparer.call(M,F.j.getObject(d.fieldNames[T],M),d.searchKey,d.ignoreCase,d.ignoreAccent))return!0;return!1}))},te.prototype.onSortBy=function(O,d,M){if(!O||!O.length)return O;var T,b=F.j.getValue(d.fieldName,M);if(!b)return O.sort(d.comparer);if(b instanceof Array){b=b.slice(0);for(var k=b.length-1;k>=0;k--)!b[k]||(T=d.comparer,F.j.endsWith(b[k]," desc")&&(T=F.j.fnSort("descending"),b[k]=b[k].replace(" desc","")),O=F.j.sort(O,b[k],T));return O}return F.j.sort(O,b,d.comparer)},te.prototype.onGroup=function(O,d,M){if(!O||!O.length)return O;var T=this.getAggregate(M);return F.j.group(O,F.j.getValue(d.fieldName,M),T,null,null,d.comparer)},te.prototype.onPage=function(O,d,M){var T=F.j.getValue(d.pageSize,M),b=(F.j.getValue(d.pageIndex,M)-1)*T,k=b+T;return!O||!O.length?O:O.slice(b,k)},te.prototype.onRange=function(O,d){return!O||!O.length?O:O.slice(F.j.getValue(d.start),F.j.getValue(d.end))},te.prototype.onTake=function(O,d){return!O||!O.length?O:O.slice(0,F.j.getValue(d.nos))},te.prototype.onSkip=function(O,d){return!O||!O.length?O:O.slice(F.j.getValue(d.nos))},te.prototype.onSelect=function(O,d){return!O||!O.length?O:F.j.select(O,F.j.getValue(d.fieldNames))},te.prototype.insert=function(O,d,M,T,b){return(0,P.le)(b)?O.dataSource.json.push(d):O.dataSource.json.splice(b,0,d)},te.prototype.remove=function(O,d,M,T){var b=O.dataSource.json,k;for(typeof M=="object"&&!(M instanceof Date)&&(M=F.j.getObject(d,M)),k=0;k<b.length&&F.j.getObject(d,b[k])!==M;k++);return k!==b.length?b.splice(k,1):null},te.prototype.update=function(O,d,M,T){var b=O.dataSource.json,k,S;for((0,P.le)(d)||(S=(0,P.NA)(d,M)),k=0;k<b.length&&!(!(0,P.le)(d)&&(0,P.NA)(d,b[k])===S);k++);return k<b.length?(0,P.TS)(b[k],M):null},te}(U),E=function(Q){w(te,Q);function te(){return Q!==null&&Q.apply(this,arguments)||this}return te.prototype.processQuery=function(O,d,M){var T=this.getQueryRequest(d),b=Y.A.filterQueryLists(d.queries,["onSelect","onPage","onSkip","onTake","onRange"]),k=d.params,S=O.dataSource.url,m,x,v=null,y=this.options,A={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};"onPage"in b?(m=b.onPage,x=F.j.getValue(m.pageIndex,d),v=F.j.getValue(m.pageSize,d),x=(x-1)*v):"onRange"in b&&(m=b.onRange,x=m.start,v=m.end-m.start);for(var I=0;I<T.sorts.length;I++)m=F.j.getValue(T.sorts[I].e.fieldName,d),A.sorts.push(F.j.callAdaptorFunction(this,"onEachSort",{name:m,direction:T.sorts[I].e.direction},d));M&&(m=this.getFiltersFrom(M,d),m&&A.filters.push(F.j.callAdaptorFunction(this,"onEachWhere",m.toJson(),d)));for(var I=0;I<T.filters.length;I++){var N=F.j.callAdaptorFunction(this,"onEachWhere",T.filters[I].e.toJson(),d);this.getModuleName&&this.getModuleName()==="ODataV4Adaptor"&&!(0,P.le)(T.filters[I].e.key)&&T.filters.length>1&&(N="("+N+")"),A.filters.push(N);for(var z=typeof A.filters[I]=="object"?Object.keys(A.filters[I]):[],V=0,_=z;V<_.length;V++){var G=_[V];F.j.isNull(A[G])&&delete A[G]}}for(var I=0;I<T.searches.length;I++)m=T.searches[I].e,A.searches.push(F.j.callAdaptorFunction(this,"onEachSearch",{fields:m.fieldNames,operator:m.operator,key:m.searchKey,ignoreCase:m.ignoreCase},d));for(var I=0;I<T.groups.length;I++)A.groups.push(F.j.getValue(T.groups[I].e.fieldName,d));for(var I=0;I<T.aggregates.length;I++)m=T.aggregates[I].e,A.aggregates.push({type:m.type,field:F.j.getValue(m.field,d)});var K={};if(this.getRequestQuery(y,d,b,A,K),F.j.callAdaptorFunction(this,"addParams",{dm:O,query:d,params:k,reqParams:K}),d.lazyLoad.length)for(var I=0;I<d.lazyLoad.length;I++)K[d.lazyLoad[I].key]=d.lazyLoad[I].value;for(var oe=Object.keys(K),he=0,ue=oe;he<ue.length;he++){var G=ue[he];(F.j.isNull(K[G])||K[G]===""||K[G].length===0)&&delete K[G]}!(y.skip in K&&y.take in K)&&v!==null&&(K[y.skip]=F.j.callAdaptorFunction(this,"onSkip",x,d),K[y.take]=F.j.callAdaptorFunction(this,"onTake",v,d));var X=this.pvt;return this.pvt={},this.options.requestType==="json"?{data:JSON.stringify(K,F.j.parse.jsonDateReplacer),url:S,pvtData:X,type:"POST",contentType:"application/json; charset=utf-8"}:(m=this.convertToQueryString(K,d,O),m=(O.dataSource.url.indexOf("?")!==-1?"&":"/")+m,{type:"GET",url:m.length?S.replace(/\/*$/,m):S,pvtData:X})},te.prototype.getRequestQuery=function(O,d,M,T,b){var k="param",S=b;S[O.from]=d.fromTable,O.apply&&d.distincts.length&&(S[O.apply]="onDistinct"in this?F.j.callAdaptorFunction(this,"onDistinct",d.distincts):""),!d.distincts.length&&O.expand&&(S[O.expand]="onExpand"in this&&"onSelect"in M?F.j.callAdaptorFunction(this,"onExpand",{selects:F.j.getValue(M.onSelect.fieldNames,d),expands:d.expands},d):d.expands),S[O.select]="onSelect"in M&&!d.distincts.length?F.j.callAdaptorFunction(this,"onSelect",F.j.getValue(M.onSelect.fieldNames,d),d):"",S[O.count]=d.isCountRequired?F.j.callAdaptorFunction(this,"onCount",d.isCountRequired,d):"",S[O.search]=T.searches.length?F.j.callAdaptorFunction(this,"onSearch",T.searches,d):"",S[O.skip]="onSkip"in M?F.j.callAdaptorFunction(this,"onSkip",F.j.getValue(M.onSkip.nos,d),d):"",S[O.take]="onTake"in M?F.j.callAdaptorFunction(this,"onTake",F.j.getValue(M.onTake.nos,d),d):"",S[O.where]=T.filters.length||T.searches.length?F.j.callAdaptorFunction(this,"onWhere",T.filters,d):"",S[O.sortBy]=T.sorts.length?F.j.callAdaptorFunction(this,"onSortBy",T.sorts,d):"",S[O.group]=T.groups.length?F.j.callAdaptorFunction(this,"onGroup",T.groups,d):"",S[O.aggregates]=T.aggregates.length?F.j.callAdaptorFunction(this,"onAggregates",T.aggregates,d):"",S[k]=[]},te.prototype.convertToQueryString=function(O,d,M){return""},te.prototype.processResponse=function(O,d,M,T,b,k){if(T&&T.getResponseHeader("Content-Type")&&T.getResponseHeader("Content-Type").indexOf("application/json")!==-1){var S=F.j.timeZoneHandling;d&&!d.timeZoneHandling&&(F.j.timeZoneHandling=!1),O=F.j.parse.parseJson(O),F.j.timeZoneHandling=S}var m=b,x=m.pvtData||{},v=O?O.groupDs:[];if(T&&T.getResponseHeader("Content-Type")&&T.getResponseHeader("Content-Type").indexOf("xml")!==-1)return M.isCountRequired?{result:[],count:0}:[];var y=JSON.parse(m.data);if(y&&y.action==="batch"&&O&&O.addedRecords)return k.addedRecords=O.addedRecords,k;O&&O.d&&(O=O.d);var A={};O&&"count"in O&&(A.count=O.count),A.result=O&&O.result?O.result:O;var I=!1;if(Array.isArray(O.result)&&O.result.length){var N="key",z="value",V="level";if((0,P.le)(O.result[0][N])||(A.result=this.formRemoteGroupedData(A.result,1,x.groups.length-1)),M&&M.lazyLoad.length&&x.groups.length){for(var _=0;_<M.lazyLoad.length;_++)if(M.lazyLoad[_][N]==="onDemandGroupInfo"){var G=M.lazyLoad[_][z][V];x.groups.length===G&&(I=!0)}}}return I||this.getAggregateResult(x,O,A,v,M),F.j.isNull(A.count)?A.result:{result:A.result,count:A.count,aggregates:A.aggregates}},te.prototype.formRemoteGroupedData=function(O,d,M){for(var T=0;T<O.length;T++)O[T].items.length&&Object.keys(O[T].items[0]).indexOf("key")>-1&&this.formRemoteGroupedData(O[T].items,d+1,M-1);var b="GroupGuid",k="childLevels",S="level",m="records";return O[b]=ye[b],O[S]=d,O[k]=M,O[m]=O[0].items.length?this.getGroupedRecords(O,!(0,P.le)(O[0].items[m])):[],O},te.prototype.getGroupedRecords=function(O,d){for(var M=[],T="records",b=0;b<O.length;b++)if(d)M=M.concat(O[b].items[T]);else for(var k=0;k<O[b].items.length;k++)M.push(O[b].items[k]);return M},te.prototype.onGroup=function(O){return this.pvt.groups=O,O},te.prototype.onAggregates=function(O){this.pvt.aggregates=O},te.prototype.batchRequest=function(O,d,M,T,b){var k,S;return{type:"POST",url:O.dataSource.batchUrl||O.dataSource.crudUrl||O.dataSource.removeUrl||O.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify((0,P.l7)({},{changed:d.changedRecords,added:d.addedRecords,deleted:d.deletedRecords,action:"batch",table:M[k],key:M[S]},F.j.getAddParams(this,O,T)))}},te.prototype.beforeSend=function(O,d){},te.prototype.insert=function(O,d,M,T){return{url:O.dataSource.insertUrl||O.dataSource.crudUrl||O.dataSource.url,data:JSON.stringify((0,P.l7)({},{value:d,table:M,action:"insert"},F.j.getAddParams(this,O,T)))}},te.prototype.remove=function(O,d,M,T,b){return{type:"POST",url:O.dataSource.removeUrl||O.dataSource.crudUrl||O.dataSource.url,data:JSON.stringify((0,P.l7)({},{key:M,keyColumn:d,table:T,action:"remove"},F.j.getAddParams(this,O,b)))}},te.prototype.update=function(O,d,M,T,b){return{type:"POST",url:O.dataSource.updateUrl||O.dataSource.crudUrl||O.dataSource.url,data:JSON.stringify((0,P.l7)({},{value:M,action:"update",keyColumn:d,key:F.j.getObject(d,M),table:T},F.j.getAddParams(this,O,b)))}},te.prototype.getFiltersFrom=function(O,d){var M=d.fKey,T,b=M,k=d.key,S=[];typeof O[0]!="object"&&(b=null);for(var m=0;m<O.length;m++)typeof O[0]=="object"?T=F.j.getObject(k||b,O[m]):T=O[m],S.push(new Y.$(M,"equal",T));return Y.$.or(S)},te.prototype.getAggregateResult=function(O,d,M,T,b){var k=d;if(d&&d.result&&(k=d.result),O&&O.aggregates&&O.aggregates.length){var S=O.aggregates,m=void 0,x=k,v={};d.aggregate&&(x=d.aggregate);for(var y=0;y<S.length;y++)m=F.j.aggregates[S[y].type],m&&(v[S[y].field+" - "+S[y].type]=m(x,S[y].field));M.aggregates=v}var A="key",I=Array.isArray(d.result)&&d.result.length&&!(0,P.le)(d.result[0][A]);if(O&&O.groups&&O.groups.length&&!I){for(var N=O.groups,y=0;y<N.length;y++){var z=null;(0,P.le)(T)||(T=F.j.group(T,N[y]));var V=Y.A.filterQueries(b.queries,"onGroup")[y].e;k=F.j.group(k,N[y],O.aggregates,z,T,V.comparer)}M.result=k}return M},te.prototype.getQueryRequest=function(O){var d={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return d.sorts=Y.A.filterQueries(O.queries,"onSortBy"),d.groups=Y.A.filterQueries(O.queries,"onGroup"),d.filters=Y.A.filterQueries(O.queries,"onWhere"),d.searches=Y.A.filterQueries(O.queries,"onSearch"),d.aggregates=Y.A.filterQueries(O.queries,"onAggregates"),d},te.prototype.addParams=function(O){var d=O.reqParams;O.params.length&&(d.params={});for(var M=0,T=O.params;M<T.length;M++){var b=T[M];if(d[b.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");d[b.key]=b.value,b.fn&&(d[b.key]=b.fn.call(O.query,b.key,O.query,O.dm)),d.params[b.key]=d[b.key]}},te}(U),a=function(Q){w(te,Q);function te(O){var d=Q.call(this)||this;return d.options=(0,P.l7)({},d.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:`Content-Type: application/http
Content-Transfer-Encoding: binary `,batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PUT"}),(0,P.l7)(d.options,O||{}),d}return te.prototype.getModuleName=function(){return"ODataAdaptor"},te.prototype.onPredicate=function(O,d,M){var T="",b,k,S=O.value,m=typeof S,x=O.field?te.getField(O.field):null;if(S instanceof Date&&(S="datetime'"+F.j.parse.replacer(S)+"'"),m==="string"&&(S=S.replace(/'/g,"''"),O.ignoreCase&&(S=S.toLowerCase()),S=encodeURIComponent(S),S="'"+S+"'",M&&(x="cast("+x+", 'Edm.String')"),F.j.parse.isGuid(S)&&(k="guid"),O.ignoreCase&&(k||(x="tolower("+x+")"),S=S.toLowerCase())),b=F.j.odBiOperator[O.operator],b)return T+=x,T+=b,k&&(T+=k),T+S;if(!(0,P.le)(this.getModuleName)&&this.getModuleName()==="ODataV4Adaptor"?b=F.j.odv4UniOperator[O.operator]:b=F.j.odUniOperator[O.operator],b==="substringof"){var v=S;S=x,x=v}return T+=b+"(",T+=x+",",k&&(T+=k),T+=S+")",T},te.prototype.addParams=function(O){Q.prototype.addParams.call(this,O),delete O.reqParams.params},te.prototype.onComplexPredicate=function(O,d,M){for(var T=[],b=0;b<O.predicates.length;b++)T.push("("+this.onEachWhere(O.predicates[b],d,M)+")");return T.join(" "+O.condition+" ")},te.prototype.onEachWhere=function(O,d,M){return O.isComplex?this.onComplexPredicate(O,d,M):this.onPredicate(O,d,M)},te.prototype.onWhere=function(O){return this.pvt.search&&O.push(this.onEachWhere(this.pvt.search,null,!0)),O.join(" and ")},te.prototype.onEachSearch=function(O){O.fields&&O.fields.length===0&&F.j.throwError("Query() - Search : oData search requires list of field names to search");for(var d=this.pvt.search||[],M=0;M<O.fields.length;M++)d.push(new Y.$(O.fields[M],O.operator,O.key,O.ignoreCase));this.pvt.search=d},te.prototype.onSearch=function(O){return this.pvt.search=Y.$.or(this.pvt.search),""},te.prototype.onEachSort=function(O){var d=[];if(O.name instanceof Array)for(var M=0;M<O.name.length;M++)d.push(te.getField(O.name[M])+(O.direction==="descending"?" desc":""));else d.push(te.getField(O.name)+(O.direction==="descending"?" desc":""));return d.join(",")},te.prototype.onSortBy=function(O){return O.reverse().join(",")},te.prototype.onGroup=function(O){return this.pvt.groups=O,[]},te.prototype.onSelect=function(O){for(var d=0;d<O.length;d++)O[d]=te.getField(O[d]);return O.join(",")},te.prototype.onAggregates=function(O){return this.pvt.aggregates=O,""},te.prototype.onCount=function(O){return O===!0?"allpages":""},te.prototype.beforeSend=function(O,d,M){F.j.endsWith(M.url,this.options.batch)&&M.type.toLowerCase()==="post"?(d.setRequestHeader("Accept",this.options.multipartAccept),d.setRequestHeader("DataServiceVersion","2.0"),d.overrideMimeType("text/plain; charset=x-user-defined")):d.setRequestHeader("Accept",this.options.accept),d.setRequestHeader("DataServiceVersion","2.0"),d.setRequestHeader("MaxDataServiceVersion","2.0")},te.prototype.processResponse=function(O,d,M,T,b,k){var S="odata.metadata";if(b&&b.type==="GET"&&!this.rootUrl&&O[S]){var m=O[S].split("/$metadata#");this.rootUrl=m[0],this.resourceTableName=m[1]}var x="pvtData";if(!(0,P.le)(O.d)){var v=M&&M.isCountRequired?O.d.results:O.d,y="__metadata";if(!(0,P.le)(v))for(var A=0;A<v.length;A++)(0,P.le)(v[A][y])||delete v[A][y]}var I=b&&b[x],N=this.processBatchResponse(O,M,T,b,k);if(N)return N;var z=T&&b.getResponseHeader("DataServiceVersion"),V=null,_=z&&parseInt(z,10)||2;if(M&&M.isCountRequired){var G="__count";(O[G]||O["odata.count"])&&(V=O[G]||O["odata.count"]),O.d&&(O=O.d),(O[G]||O["odata.count"])&&(V=O[G]||O["odata.count"])}_===3&&O.value&&(O=O.value),O.d&&(O=O.d),_<3&&O.results&&(O=O.results);var K={};return K.count=V,K.result=O,this.getAggregateResult(I,O,K,null,M),F.j.isNull(V)?K.result:{result:K.result,count:K.count,aggregates:K.aggregates}},te.prototype.convertToQueryString=function(O,d,M){var T=[],b="table",k=O[b]||"",S="$format";delete O[b],M.dataSource.requiresFormat&&(O[S]="json");for(var m=Object.keys(O),x=0,v=m;x<v.length;x++){var y=v[x];T.push(y+"="+O[y])}return T=T.join("&"),M.dataSource.url&&M.dataSource.url.indexOf("?")!==-1&&!k?T:T.length?k+"?"+T:k||""},te.prototype.localTimeReplacer=function(O,d){for(var M=0,T=(0,P.le)(d)?[]:Object.keys(d);M<T.length;M++){var b=T[M];d[b]instanceof Date&&(d[b]=F.j.dateParse.toLocalTime(d[b]))}return d},te.prototype.insert=function(O,d,M){return{url:(O.dataSource.insertUrl||O.dataSource.url).replace(/\/*$/,M?"/"+M:""),data:JSON.stringify(d,this.options.localTime?this.localTimeReplacer:null)}},te.prototype.remove=function(O,d,M,T){var b;return typeof M=="string"&&!F.j.parse.isGuid(M)?b="('"+M+"')":b="("+M+")",{type:"DELETE",url:(O.dataSource.removeUrl||O.dataSource.url).replace(/\/*$/,T?"/"+T:"")+b}},te.prototype.update=function(O,d,M,T,b,k){this.options.updateType==="PATCH"&&!(0,P.le)(k)&&(M=this.compareAndRemove(M,k,d));var S;return typeof M[d]=="string"&&!F.j.parse.isGuid(M[d])?S="('"+M[d]+"')":S="("+M[d]+")",{type:this.options.updateType,url:(O.dataSource.updateUrl||O.dataSource.url).replace(/\/*$/,T?"/"+T:"")+S,data:JSON.stringify(M,this.options.localTime?this.localTimeReplacer:null),accept:this.options.accept}},te.prototype.batchRequest=function(O,d,M,T,b){var k=M.guid=F.j.getGuid(this.options.batchPre),S=this.rootUrl?this.rootUrl+"/"+this.options.batch:O.dataSource.url.replace(/\/*$/,"/"+this.options.batch);M.url=this.resourceTableName?this.resourceTableName:M.url;var m={url:M.url,key:M.key,cid:1,cSet:F.j.getGuid(this.options.changeSet)},x="--"+k+`
`;return x+="Content-Type: multipart/mixed; boundary="+m.cSet.replace("--","")+`
`,this.pvt.changeSet=0,x+=this.generateInsertRequest(d.addedRecords,m,O),x+=this.generateUpdateRequest(d.changedRecords,m,O,b?b.changedRecords:[]),x+=this.generateDeleteRequest(d.deletedRecords,m,O),x+=m.cSet+`--
`,x+="--"+k+"--",{type:"POST",url:S,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+k,data:x}},te.prototype.generateDeleteRequest=function(O,d,M){if(!O)return"";var T="",b={method:"DELETE ",url:function(k,S,m){var x=F.j.getObject(m,k[S]);if(typeof x=="number"||F.j.parse.isGuid(x))return"("+x+")";if(x instanceof Date){var v=k[S][m];return"("+v.toJSON()+")"}else return"('"+x+"')"},data:function(k,S){return""}};return T=this.generateBodyContent(O,d,b,M),T+`
`},te.prototype.generateInsertRequest=function(O,d,M){if(!O)return"";var T="",b={method:"POST ",url:function(k,S,m){return""},data:function(k,S){return JSON.stringify(k[S])+`

`}};return T=this.generateBodyContent(O,d,b,M),T},te.prototype.generateUpdateRequest=function(O,d,M,T){var b=this;if(!O)return"";var k="";O.forEach(function(m){return m=b.compareAndRemove(m,T.filter(function(x){return F.j.getObject(d.key,x)===F.j.getObject(d.key,m)})[0],d.key)});var S={method:this.options.updateType+" ",url:function(m,x,v){if(typeof m[x][v]=="number"||F.j.parse.isGuid(m[x][v]))return"("+m[x][v]+")";if(m[x][v]instanceof Date){var y=m[x][v];return"("+y.toJSON()+")"}else return"('"+m[x][v]+"')"},data:function(m,x){return JSON.stringify(m[x])+`

`}};return k=this.generateBodyContent(O,d,S,M),k},te.getField=function(O){return O.replace(/\./g,"/")},te.prototype.generateBodyContent=function(O,d,M,T){for(var b="",k=0;k<O.length;k++)b+=`
`+d.cSet+`
`,b+=this.options.changeSetContent+`

`,b+=M.method,M.method==="POST "?b+=(T.dataSource.insertUrl||T.dataSource.crudUrl||d.url)+M.url(O,k,d.key)+` HTTP/1.1
`:M.method==="PUT "||M.method==="PATCH "?b+=(T.dataSource.updateUrl||T.dataSource.crudUrl||d.url)+M.url(O,k,d.key)+` HTTP/1.1
`:M.method==="DELETE "&&(b+=(T.dataSource.removeUrl||T.dataSource.crudUrl||d.url)+M.url(O,k,d.key)+` HTTP/1.1
`),b+="Accept: "+this.options.accept+`
`,b+="Content-Id: "+this.pvt.changeSet+++`
`,b+=this.options.batchChangeSetContentType+`
`,(0,P.le)(O[k]["@odata.etag"])?b+=`
`:(b+="If-Match: "+O[k]["@odata.etag"]+`

`,delete O[k]["@odata.etag"]),b+=M.data(O,k);return b},te.prototype.processBatchResponse=function(O,d,M,T,b){if(M&&M.getResponseHeader("Content-Type")&&M.getResponseHeader("Content-Type").indexOf("xml")!==-1)return d.isCountRequired?{result:[],count:0}:[];if(T&&this.options.batch&&F.j.endsWith(T.url,this.options.batch)&&T.type.toLowerCase()==="post"){var k=M.getResponseHeader("Content-Type"),S=void 0,m=void 0,x=O+"";if(k=k.substring(k.indexOf("=batchresponse")+1),x=x.split(k),x.length<2)return{};x=x[1];var v=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(x);v&&x.replace(v[0],"");var y=v?v[1]:"";x=x.split(y);for(var A=x.length;A>-1;A--)!/\bContent-ID:/i.test(x[A])||!/\bHTTP.+201/.test(x[A])||(S=parseInt(/\bContent-ID: (\d+)/i.exec(x[A])[1],10),b.addedRecords[S]&&(m=F.j.parse.parseJson(/^\{.+\}/m.exec(x[A])[0]),(0,P.l7)({},b.addedRecords[S],this.processResponse(m))));return b}return null},te.prototype.compareAndRemove=function(O,d,M){var T=this;return(0,P.le)(d)||Object.keys(O).forEach(function(b){if(b!==M&&b!=="@odata.etag")if(F.j.isPlainObject(O[b])){T.compareAndRemove(O[b],d[b]);var k=Object.keys(O[b]).filter(function(S){return S!=="@odata.etag"});k.length===0&&delete O[b]}else(O[b]===d[b]||O[b]&&d[b]&&O[b].valueOf()===d[b].valueOf())&&delete O[b]}),O},te}(E),$=function(Q){w(te,Q);function te(O){var d=Q.call(this,O)||this;return d.options=(0,P.l7)({},d.options,{requestType:"get",accept:"application/json, text/javascript, */*; q=0.01",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$count",search:"$search",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:`Content-Type: application/http
Content-Transfer-Encoding: binary `,batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PATCH",localTime:!1,apply:"$apply"}),(0,P.l7)(d.options,O||{}),d}return te.prototype.getModuleName=function(){return"ODataV4Adaptor"},te.prototype.onCount=function(O){return O===!0?"true":""},te.prototype.onPredicate=function(O,d,M){var T="",b=O.value,k=b instanceof Date;if(d instanceof Y.A)for(var S=this.getQueryRequest(d),m=0;m<S.filters.length;m++)S.filters[m].e.key===O.value&&(M=!0);return T=Q.prototype.onPredicate.call(this,O,d,M),k&&(T=T.replace(/datetime'(.*)'$/,"$1")),F.j.parse.isGuid(b)&&(T=T.replace("guid","").replace(/'/g,"")),T},te.prototype.onEachSearch=function(O){var d=this.pvt.searches||[];d.push(O.key),this.pvt.searches=d},te.prototype.onSearch=function(O){return this.pvt.searches.join(" OR ")},te.prototype.onExpand=function(O){var d=this,M={},T={},b=O.expands.slice(),k=[],S=O.selects.filter(function(m){return m.indexOf(".")>-1});return S.forEach(function(m){var x=m.split(".");if(x[0]in M||(M[x[0]]=[]),x.length==2)M[x[0]].length&&Object.keys(M).indexOf(x[0])!==-1?M[x[0]][0].indexOf("$expand")!==-1&&M[x[0]][0].indexOf(";$select=")===-1?M[x[0]][0]=M[x[0]][0]+";$select="+x[1]:M[x[0]][0]=M[x[0]][0]+","+x[1]:M[x[0]].push("$select="+x[1]);else{for(var v="$select="+x[x.length-1],y="",A="",I=1;I<x.length-1;I++)y=y+"$expand="+x[I]+"(",A=A+")";var N=y+v+A;if(M[x[0]].length&&Object.keys(M).indexOf(x[0])!==-1&&d.expandQueryIndex(M[x[0]],!0)){var z=d.expandQueryIndex(M[x[0]]);M[x[0]][z]=M[x[0]][z]+N.replace("$expand=",",")}else M[x[0]].push(N)}}),Object.keys(M).forEach(function(m){b.indexOf(m)===-1&&b.push(m)}),b.forEach(function(m){T[m]=m in M?m+"("+M[m].join(";")+")":m}),Object.keys(T).forEach(function(m){return k.push(T[m])}),k.join(",")},te.prototype.expandQueryIndex=function(O,d){for(var M=0;M<O.length;M++)if(O[M].indexOf("$expand")!==-1)return d?!0:M;return d?!1:0},te.prototype.onDistinct=function(O){var d=O.map(function(M){return a.getField(M)}).join(",");return"groupby(("+d+"))"},te.prototype.onSelect=function(O){return Q.prototype.onSelect.call(this,O.filter(function(d){return d.indexOf(".")===-1}))},te.prototype.beforeSend=function(O,d,M){(M.type==="POST"||M.type==="PUT"||M.type==="PATCH")&&d.setRequestHeader("Prefer","return=representation"),d.setRequestHeader("Accept",this.options.accept)},te.prototype.processResponse=function(O,d,M,T,b,k){var S="@odata.context";if(b&&b.type==="GET"&&!this.rootUrl&&O[S]){var m=O[S].split("/$metadata#");this.rootUrl=m[0],this.resourceTableName=m[1]}var x="pvtData",v=b&&b[x],y=Q.prototype.processBatchResponse.call(this,O,M,T,b,k);if(y)return y;var A=null,I="@odata.count";M&&M.isCountRequired&&I in O&&(A=O[I]),O=(0,P.le)(O.value)?O:O.value;var N={};return N.count=A,N.result=O,this.getAggregateResult(v,O,N,null,M),F.j.isNull(A)?N.result:{result:N.result,count:A,aggregates:N.aggregates}},te}(a),J=function(Q){w(te,Q);function te(){return Q!==null&&Q.apply(this,arguments)||this}return te.prototype.getModuleName=function(){return"WebApiAdaptor"},te.prototype.insert=function(O,d,M){return{type:"POST",url:O.dataSource.url,data:JSON.stringify(d)}},te.prototype.remove=function(O,d,M,T){return{type:"DELETE",url:O.dataSource.url+"/"+M,data:JSON.stringify(M)}},te.prototype.update=function(O,d,M,T){return{type:"PUT",url:O.dataSource.url,data:JSON.stringify(M)}},te.prototype.batchRequest=function(O,d,M){var T=this,b=M.guid=F.j.getGuid(this.options.batchPre),k=O.dataSource.url.replace(/\/*$/,"/"+this.options.batch);M.url=this.resourceTableName?this.resourceTableName:M.url;for(var S=[],m=function(I,N){d.addedRecords.forEach(function(z,V){var _={method:"POST ",url:function(G,K,oe){return""},data:function(G,K){return JSON.stringify(G[K])+`

`}};S.push("--"+b),S.push("Content-Type: application/http; msgtype=request",""),S.push("POST /api/"+(O.dataSource.insertUrl||O.dataSource.crudUrl||M.url)+_.url(d.addedRecords,I,M.key)+" HTTP/1.1"),S.push("Content-Type: application/json; charset=utf-8"),S.push("Host: "+location.host),S.push("",z?JSON.stringify(z):"")})},x=0,v=d.addedRecords.length;x<v;x++)m(x,v);for(var y=function(I,N){d.changedRecords.forEach(function(z,V){var _={method:T.options.updateType+" ",url:function(G,K,oe){return""},data:function(G,K){return JSON.stringify(G[K])+`

`}};S.push("--"+b),S.push("Content-Type: application/http; msgtype=request",""),S.push("PUT /api/"+(O.dataSource.updateUrl||O.dataSource.crudUrl||M.url)+_.url(d.changedRecords,I,M.key)+" HTTP/1.1"),S.push("Content-Type: application/json; charset=utf-8"),S.push("Host: "+location.host),S.push("",z?JSON.stringify(z):"")})},x=0,v=d.changedRecords.length;x<v;x++)y(x,v);for(var A=function(I,N){d.deletedRecords.forEach(function(z,V){var _={mtd:"DELETE ",url:function(G,K,oe){var he=F.j.getObject(oe,G[K]);if(typeof he=="number"||F.j.parse.isGuid(he))return"/"+he;if(he instanceof Date){var ue=G[K][oe];return"/"+ue.toJSON()}else return"/'"+he+"'"},data:function(G,K){return""}};S.push("--"+b),S.push("Content-Type: application/http; msgtype=request",""),S.push("DELETE /api/"+(O.dataSource.removeUrl||O.dataSource.crudUrl||M.url)+_.url(d.deletedRecords,I,M.key)+" HTTP/1.1"),S.push("Content-Type: application/json; charset=utf-8"),S.push("Host: "+location.host),S.push("",z?JSON.stringify(z):"")})},x=0,v=d.deletedRecords.length;x<v;x++)A(x,v);return S.push("--"+b+"--",""),{type:"POST",url:k,contentType:"multipart/mixed; boundary="+b,data:S.join(`\r
`)}},te.prototype.beforeSend=function(O,d,M){d.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01")},te.prototype.processResponse=function(O,d,M,T,b,k){var S="pvtData",m=b&&b[S],x=null,v={};if(b&&b.type.toLowerCase()!=="post"){var y=T&&b.getResponseHeader("DataServiceVersion"),A=y&&parseInt(y,10)||2;M&&M.isCountRequired&&(F.j.isNull(O.Count)||(x=O.Count)),A<3&&O.Items&&(O=O.Items),v.count=x,v.result=O,this.getAggregateResult(m,O,v,null,M)}return v.result=v.result||O,F.j.isNull(x)?v.result:{result:v.result,count:v.count,aggregates:v.aggregates}},te}(a),se=function(Q){w(te,Q);function te(){return Q!==null&&Q.apply(this,arguments)||this}return te.prototype.processQuery=function(O,d,M){var T=new E().processQuery(O,d,M),b="data",k=F.j.parse.parseJson(T[b]),S={},m="value";if(k.param)for(var x=0;x<k.param.length;x++){var v=k.param[x],y=Object.keys(v)[0];S[y]=v[y]}S[m]=k;var A="pvtData",I="url";return{data:JSON.stringify(S),url:T[I],pvtData:T[A],type:"POST",contentType:"application/json; charset=utf-8"}},te}(E),re=function(Q){w(te,Q);function te(){var O=Q.call(this)||this;return(0,P.sO)("beforeSend",E.prototype.beforeSend,O),O}return te.prototype.insert=function(O,d,M,T,b){return this.pvt.position=b,this.updateType="add",{url:O.dataSource.insertUrl||O.dataSource.crudUrl||O.dataSource.url,data:JSON.stringify((0,P.l7)({},{value:d,table:M,action:"insert"},F.j.getAddParams(this,O,T)))}},te.prototype.remove=function(O,d,M,T,b){return Q.prototype.remove.call(this,O,d,M),{type:"POST",url:O.dataSource.removeUrl||O.dataSource.crudUrl||O.dataSource.url,data:JSON.stringify((0,P.l7)({},{key:M,keyColumn:d,table:T,action:"remove"},F.j.getAddParams(this,O,b)))}},te.prototype.update=function(O,d,M,T,b){return this.updateType="update",this.updateKey=d,{type:"POST",url:O.dataSource.updateUrl||O.dataSource.crudUrl||O.dataSource.url,data:JSON.stringify((0,P.l7)({},{value:M,action:"update",keyColumn:d,key:M[d],table:T},F.j.getAddParams(this,O,b)))}},te.prototype.processResponse=function(O,d,M,T,b,k,S){var m,x=b?JSON.parse(b.data):O;if(O=x.action==="batch"?F.j.parse.parseJson(O):O,this.updateType==="add"&&Q.prototype.insert.call(this,d,O,null,null,this.pvt.position),this.updateType==="update"&&Q.prototype.update.call(this,d,this.updateKey,O),this.updateType=void 0,O.added)for(m=0;m<O.added.length;m++)Q.prototype.insert.call(this,d,O.added[m]);if(O.changed)for(m=0;m<O.changed.length;m++)Q.prototype.update.call(this,d,S.key,O.changed[m]);if(O.deleted)for(m=0;m<O.deleted.length;m++)Q.prototype.remove.call(this,d,S.key,O.deleted[m]);return O},te.prototype.batchRequest=function(O,d,M,T,b){return{type:"POST",url:O.dataSource.batchUrl||O.dataSource.crudUrl||O.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify((0,P.l7)({},{changed:d.changedRecords,added:d.addedRecords,deleted:d.deletedRecords,action:"batch",table:M.url,key:M.key},F.j.getAddParams(this,O,T)))}},te.prototype.addParams=function(O){var d=new E;d.addParams(O)},te}(Z),Ae=function(Q){w(te,Q);function te(O){var d=Q.call(this)||this;return d.options=(0,P.l7)({},d.options,{getData:new Function,addRecord:new Function,updateRecord:new Function,deleteRecord:new Function,batchUpdate:new Function}),(0,P.l7)(d.options,O||{}),d}return te.prototype.getModuleName=function(){return"CustomDataAdaptor"},te}(E),Ie=function(Q){w(te,Q);function te(O){var d=Q.call(this)||this;return d.opt=O,d.schema=d.opt.response,d.query=d.opt.query,d.getVariables=d.opt.getVariables?d.opt.getVariables:function(){},d.getQuery=function(){return d.query},d}return te.prototype.getModuleName=function(){return"GraphQLAdaptor"},te.prototype.processQuery=function(O,d){var M=Q.prototype.processQuery.apply(this,arguments),T=JSON.parse(M.data),b=["skip","take","sorted","table","select","where","search","requiresCounts","aggregates","params"],k={},S="searchwhereparams";b.filter(function(v){k[v]=S.indexOf(v)>-1?JSON.stringify(T[v]):T[v]});var m=this.getVariables()||{};m.datamanager=k;var x=JSON.stringify({query:this.getQuery(),variables:m});return M.data=x,M},te.prototype.processResponse=function(O,d,M,T,b){var k=O,S,m,x=(0,P.NA)(this.schema.result,k.data);this.schema.count&&(S=(0,P.NA)(this.schema.count,k.data)),this.schema.aggregates&&(m=(0,P.NA)(this.schema.aggregates,k.data),m=(0,P.le)(m)?m:F.j.parse.parseJson(m));var v=b.pvtData||{},y={result:x,aggregates:m},A=y;return v&&v.groups&&v.groups.length&&this.getAggregateResult(v,A,y,null,M),(0,P.le)(S)?y.result:{result:y.result,count:S,aggregates:m}},te.prototype.insert=function(){var O=Q.prototype.insert.apply(this,arguments);return this.generateCrudData(O,"insert")},te.prototype.update=function(){var O=Q.prototype.update.apply(this,arguments);return this.generateCrudData(O,"update")},te.prototype.remove=function(){var O=Q.prototype.remove.apply(this,arguments);return this.generateCrudData(O,"remove")},te.prototype.batchRequest=function(O,d,M,T,b){var k=Q.prototype.batchRequest.apply(this,arguments),S=JSON.parse(k.data);return S.key=M.key,k.data=JSON.stringify(S),this.generateCrudData(k,"batch")},te.prototype.generateCrudData=function(O,d){var M=JSON.parse(O.data);return O.data=JSON.stringify({query:this.opt.getMutation(d),variables:M}),O},te}(E),Se=function(Q){w(te,Q);function te(O,d,M){var T=Q.call(this)||this;T.isCrudAction=!1,T.isInsertAction=!1,(0,P.le)(O)||(T.cacheAdaptor=O),T.pageSize=M,T.guidId=F.j.getGuid("cacheAdaptor");var b={keys:[],results:[]};window.localStorage.setItem(T.guidId,JSON.stringify(b));var k=T.guidId;return(0,P.le)(d)||setInterval(function(){var S;S=F.j.parse.parseJson(window.localStorage.getItem(k));for(var m=[],x=0;x<S.results.length;x++){var v=+new Date,y=+new Date(S.results[x].timeStamp);S.results[x].timeStamp=v-y,v-y>d&&m.push(x)}for(var x=0;x<m.length;x++)S.results.splice(m[x],1),S.keys.splice(m[x],1);window.localStorage.removeItem(k),window.localStorage.setItem(k,JSON.stringify(S))},d),T}return te.prototype.generateKey=function(O,d){var M=this.getQueryRequest(d),T=Y.A.filterQueryLists(d.queries,["onSelect","onPage","onSkip","onTake","onRange"]),b=O,k="onPage";k in T&&(b+=T[k].pageIndex),M.sorts.forEach(function(y){b+=y.e.direction+y.e.fieldName}),M.groups.forEach(function(y){b+=y.e.fieldName}),M.searches.forEach(function(y){b+=y.e.searchKey});for(var S=0;S<M.filters.length;S++){var m=M.filters[S];if(m.e.isComplex){var x=d.clone();x.queries=[];for(var v=0;v<m.e.predicates.length;v++)x.queries.push({fn:"onWhere",e:m.e.predicates[v],filter:d.queries.filter});b+=m.e.condition+this.generateKey(O,x)}else b+=m.e.field+m.e.operator+m.e.value}return b},te.prototype.processQuery=function(O,d,M){var T=this.generateKey(O.dataSource.url,d),b;b=F.j.parse.parseJson(window.localStorage.getItem(this.guidId));var k=b?b.results[b.keys.indexOf(T)]:null;return k!=null&&!this.isCrudAction&&!this.isInsertAction?k:(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0)))},te.prototype.processResponse=function(O,d,M,T,b,k){if(this.isInsertAction||b&&this.cacheAdaptor.options.batch&&F.j.endsWith(b.url,this.cacheAdaptor.options.batch)&&b.type.toLowerCase()==="post")return this.cacheAdaptor.processResponse(O,d,M,T,b,k);O=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));var S=M?this.generateKey(d.dataSource.url,M):d.dataSource.url,m={};m=F.j.parse.parseJson(window.localStorage.getItem(this.guidId));var x=m.keys.indexOf(S);for(x!==-1&&(m.results.splice(x,1),m.keys.splice(x,1)),m.results[m.keys.push(S)-1]={keys:S,result:O.result,timeStamp:new Date,count:O.count};m.results.length>this.pageSize;)m.results.splice(0,1),m.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(m)),O},te.prototype.beforeSend=function(O,d,M){!(0,P.le)(this.cacheAdaptor.options.batch)&&F.j.endsWith(M.url,this.cacheAdaptor.options.batch)&&M.type.toLowerCase()==="post"&&d.setRequestHeader("Accept",this.cacheAdaptor.options.multipartAccept),O.dataSource.crossDomain||d.setRequestHeader("Accept",this.cacheAdaptor.options.accept)},te.prototype.update=function(O,d,M,T){return this.isCrudAction=!0,this.cacheAdaptor.update(O,d,M,T)},te.prototype.insert=function(O,d,M){return this.isInsertAction=!0,this.cacheAdaptor.insert(O,d,M)},te.prototype.remove=function(O,d,M,T){return this.isCrudAction=!0,this.cacheAdaptor.remove(O,d,M,T)},te.prototype.batchRequest=function(O,d,M){return this.cacheAdaptor.batchRequest(O,d,M)},te}(E)},27976:function(q,be,ae){"use strict";ae.d(be,{h:function(){return ye},B:function(){return U}});var P=ae(8923),F=ae(30620),Y=ae(15002),w=ae(13268),ye=function(){function Z(E,a,$){var J=this;this.dateParse=!0,this.timeZoneHandling=!0,this.requests=[],!E&&!this.dataSource&&(E=[]),$=$||E.adaptor,E&&E.timeZoneHandling===!1&&(this.timeZoneHandling=E.timeZoneHandling);var se;return E instanceof Array?se={json:E,offline:!0}:typeof E=="object"?(E.json||(E.json=[]),se={url:E.url,insertUrl:E.insertUrl,removeUrl:E.removeUrl,updateUrl:E.updateUrl,crudUrl:E.crudUrl,batchUrl:E.batchUrl,json:E.json,headers:E.headers,accept:E.accept,data:E.data,timeTillExpiration:E.timeTillExpiration,cachingPageSize:E.cachingPageSize,enableCaching:E.enableCaching,requestType:E.requestType,key:E.key,crossDomain:E.crossDomain,jsonp:E.jsonp,dataType:E.dataType,offline:E.offline!==void 0?E.offline:E.adaptor instanceof w.nd||E.adaptor instanceof w.lv?!1:!E.url,requiresFormat:E.requiresFormat}):F.j.throwError("DataManager: Invalid arguments"),se.requiresFormat===void 0&&!F.j.isCors()&&(se.requiresFormat=(0,P.le)(se.crossDomain)?!0:se.crossDomain),se.dataType===void 0&&(se.dataType="json"),this.dataSource=se,this.defaultQuery=a,se.url&&se.offline&&!se.json.length?(this.isDataAvailable=!1,this.adaptor=$||new w.jb,this.dataSource.offline=!1,this.ready=this.executeQuery(a||new Y.A),this.ready.then(function(re){J.dataSource.offline=!0,J.isDataAvailable=!0,se.json=re.result,J.adaptor=new w.Lc})):this.adaptor=se.offline?new w.Lc:new w.jb,!se.jsonp&&this.adaptor instanceof w.jb&&(se.jsonp="callback"),this.adaptor=$||this.adaptor,se.enableCaching&&(this.adaptor=new w.me(this.adaptor,se.timeTillExpiration,se.cachingPageSize)),this}return Z.prototype.setDefaultQuery=function(E){return this.defaultQuery=E,this},Z.prototype.executeLocal=function(E){!this.defaultQuery&&!(E instanceof Y.A)&&F.j.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||F.j.throwError("DataManager - executeLocal() : Json data is required to execute"),E=E||this.defaultQuery;var a=this.adaptor.processQuery(this,E);if(E.subQuery){var $=E.subQuery.fromTable,J=E.subQuery.lookups,se=E.isCountRequired?a.result:a;J&&J instanceof Array&&F.j.buildHierarchy(E.subQuery.fKey,$,se,J,E.subQuery.key);for(var re=0;re<se.length;re++)se[re][$]instanceof Array&&(se[re]=(0,P.l7)({},{},se[re]),se[re][$]=this.adaptor.processResponse(E.subQuery.using(new Z(se[re][$].slice(0))).executeLocal(),this,E))}return this.adaptor.processResponse(a,this,E)},Z.prototype.executeQuery=function(E,a,$,J){var se=this,re="makeRequest";typeof E=="function"&&(J=$,$=a,a=E,E=null),E||(E=this.defaultQuery),E instanceof Y.A||F.j.throwError("DataManager - executeQuery() : A query is required to execute");var Ae=new U,Ie={query:E};if(!this.dataSource.offline&&this.dataSource.url!==void 0&&this.dataSource.url!==""||!(0,P.le)(this.adaptor[re])||this.isCustomDataAdaptor(this.adaptor)){var Se=this.adaptor.processQuery(this,E);(0,P.le)(this.adaptor[re])?!(0,P.le)(Se.url)||this.isCustomDataAdaptor(this.adaptor)?this.makeRequest(Se,Ae,Ie,E):(Ie=Z.getDeferedArgs(E,Se,Ie),Ae.resolve(Ie)):this.adaptor[re](Se,Ae,Ie,E)}else Z.nextTick(function(){var Q=se.executeLocal(E);Ie=Z.getDeferedArgs(E,Q,Ie),Ae.resolve(Ie)});return(a||$)&&Ae.promise.then(a,$),J&&Ae.promise.then(J,J),Ae.promise},Z.getDeferedArgs=function(E,a,$){return E.isCountRequired?($.result=a.result,$.count=a.count,$.aggregates=a.aggregates):$.result=a,$},Z.nextTick=function(E){(window.setImmediate||window.setTimeout)(E,0)},Z.prototype.extendRequest=function(E,a,$){return(0,P.l7)({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:a,onFailure:$},E)},Z.prototype.makeRequest=function(E,a,$,J){var se=this,re=!!J.subQuerySelector,Ae=function(b){$.error=b,a.reject($)},Ie=function(b,k,S,m,x,v,y){$.xhr=S,$.count=k?parseInt(k.toString(),10):0,$.result=b,$.request=m,$.aggregates=v,$.actual=x,$.virtualSelectRecords=y,a.resolve($)},Se=function(b,k){var S=new U,m={parent:$};J.subQuery.isChild=!0;var x=se.adaptor.processQuery(se,J.subQuery,b?se.adaptor.processResponse(b):k),v=se.makeRequest(x,S,m,J.subQuery);return re||S.then(function(y){b&&(F.j.buildHierarchy(J.subQuery.fKey,J.subQuery.fromTable,b,y,J.subQuery.key),Ie(b,y.count,y.xhr))},Ae),v},Q=function(b,k){if(se.isGraphQLAdaptor(se.adaptor)&&!(0,P.le)(b.errors))return Ae(b.errors,k);se.isCustomDataAdaptor(se.adaptor)&&(k=(0,P.l7)({},se.ajaxReqOption,k)),k.httpRequest.getResponseHeader("Content-Type").indexOf("xml")===-1&&se.dateParse&&(b=F.j.parse.parseJson(b));var S=se.adaptor.processResponse(b,se,J,k.httpRequest,k),m=0,x=null,v="virtualSelectRecords",y=b[v];if(J.isCountRequired&&(m=S.count,x=S.aggregates,S=S.result),!J.subQuery){Ie(S,m,k.httpRequest,k.type,b,x,y);return}re||Se(S,k)},te=this.extendRequest(E,Q,Ae);if(this.isCustomDataAdaptor(this.adaptor)){this.ajaxReqOption=te;var d=te;this.adaptor.options.getData({data:d.data,onSuccess:d.onSuccess,onFailure:d.onFailure})}else{var O=new P.tk(te);O.beforeSend=function(){se.beforeSend(O.httpRequest,O)},te=O.send(),te.catch(function(b){return!0}),this.requests.push(O)}if(re){var M=void 0,T=J.subQuerySelector.call(this,{query:J.subQuery,parent:J});T&&T.length?(M=Promise.all([te,Se(null,T)]),M.then(function(){for(var b=[],k=0;k<arguments.length;k++)b[k]=arguments[k];var S=b[0],m=se.adaptor.processResponse(S[0],se,J,se.requests[0].httpRequest,se.requests[0]),x=0;J.isCountRequired&&(x=m.count,m=m.result);var v=se.adaptor.processResponse(S[1],se,J.subQuery,se.requests[1].httpRequest,se.requests[1]);x=0,J.subQuery.isCountRequired&&(x=v.count,v=v.result),F.j.buildHierarchy(J.subQuery.fKey,J.subQuery.fromTable,m,v,J.subQuery.key),re=!1,Ie(m,x,se.requests[0].httpRequest)})):re=!1}return te},Z.prototype.beforeSend=function(E,a){this.adaptor.beforeSend(this,E,a);for(var $=this.dataSource.headers,J,se=0;$&&se<$.length;se++){J=[];for(var re=Object.keys($[se]),Ae=0,Ie=re;Ae<Ie.length;Ae++){var Se=Ie[Ae];J.push(Se),E.setRequestHeader(Se,$[se][Se])}}},Z.prototype.saveChanges=function(E,a,$,J,se){var re=this;$ instanceof Y.A&&(J=$,$=null);var Ae={url:$,key:a||this.dataSource.key},Ie=this.adaptor.batchRequest(this,E,Ae,J||new Y.A,se),Se="doAjaxRequest";if(this.dataSource.offline)return Ie;if((0,P.le)(this.adaptor[Se])){if(this.isCustomDataAdaptor(this.adaptor))return this.doAjaxRequest(Ie,this.adaptor.options.batchUpdate);var Q=new U,te=new P.tk(Ie);return te.beforeSend=function(){re.beforeSend(te.httpRequest,te)},te.onSuccess=function(O,d){re.isGraphQLAdaptor(re.adaptor)&&((0,P.le)(O.errors)||te.onFailure(JSON.stringify(O.errors))),Q.resolve(re.adaptor.processResponse(O,re,null,d.httpRequest,d,E,Ae))},te.onFailure=function(O){Q.reject([{error:O}])},te.send().catch(function(O){return!0}),Q.promise}else return this.adaptor[Se](Ie)},Z.prototype.insert=function(E,a,$,J){a instanceof Y.A&&($=a,a=null);var se=this.adaptor.insert(this,E,a,$,J),re="doAjaxRequest";return this.dataSource.offline?se:(0,P.le)(this.adaptor[re])?this.doAjaxRequest(se,this.adaptor.options.addRecord):this.adaptor[re](se)},Z.prototype.remove=function(E,a,$,J){typeof a=="object"&&(a=F.j.getObject(E,a)),$ instanceof Y.A&&(J=$,$=null);var se=this.adaptor.remove(this,E,a,$,J),re="doAjaxRequest";if(this.dataSource.offline)return se;if((0,P.le)(this.adaptor[re])){var Ae=this.adaptor.options.deleteRecord;return this.doAjaxRequest(se,Ae)}else return this.adaptor[re](se)},Z.prototype.update=function(E,a,$,J,se){$ instanceof Y.A&&(J=$,$=null);var re=this.adaptor.update(this,E,a,$,J,se),Ae="doAjaxRequest";if(this.dataSource.offline)return re;if((0,P.le)(this.adaptor[Ae])){var Ie=this.adaptor.options.updateRecord;return this.doAjaxRequest(re,Ie)}else return this.adaptor[Ae](re)},Z.prototype.isCustomDataAdaptor=function(E){return this.adaptor.getModuleName&&this.adaptor.getModuleName()==="CustomDataAdaptor"},Z.prototype.isGraphQLAdaptor=function(E){return this.adaptor.getModuleName&&this.adaptor.getModuleName()==="GraphQLAdaptor"},Z.prototype.successFunc=function(E,a){if(this.isGraphQLAdaptor(this.adaptor)){var $=JSON.parse(E);(0,P.le)($.errors)||this.failureFunc(JSON.stringify($.errors))}this.isCustomDataAdaptor(this.adaptor)&&(a=(0,P.l7)({},this.ajaxReqOption,a));try{F.j.parse.parseJson(E)}catch(J){E=[]}E=this.adaptor.processResponse(F.j.parse.parseJson(E),this,null,a.httpRequest,a),this.ajaxDeffered.resolve(E)},Z.prototype.failureFunc=function(E){this.ajaxDeffered.reject([{error:E}])},Z.prototype.doAjaxRequest=function(E,a){var $=this;if(E=(0,P.l7)({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},E),this.ajaxDeffered=new U,this.isCustomDataAdaptor(this.adaptor))this.ajaxReqOption=E,a.call(this,{data:E.data,onSuccess:this.successFunc.bind(this),onFailure:this.failureFunc.bind(this)});else{var J=new P.tk(E);J.beforeSend=function(){$.beforeSend(J.httpRequest,J)},J.onSuccess=this.successFunc.bind(this),J.onFailure=this.failureFunc.bind(this),J.send().catch(function(se){return!0})}return this.ajaxDeffered.promise},Z}(),U=function(){function Z(){var E=this;this.promise=new Promise(function(a,$){E.resolve=a,E.reject=$}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}return Z}()},15002:function(q,be,ae){"use strict";ae.d(be,{A:function(){return Y},$:function(){return w}});var P=ae(30620),F=ae(8923),Y=function(){function ye(U){return this.subQuery=null,this.isChild=!1,this.distincts=[],this.queries=[],this.key="",this.fKey="",typeof U=="string"?this.fromTable=U:U&&U instanceof Array&&(this.lookups=U),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this.lazyLoad=[],this}return ye.prototype.setKey=function(U){return this.key=U,this},ye.prototype.using=function(U){return this.dataManager=U,this},ye.prototype.execute=function(U,Z,E,a){return U=U||this.dataManager,U?U.executeQuery(this,Z,E,a):P.j.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')},ye.prototype.executeLocal=function(U){return U=U||this.dataManager,U?U.executeLocal(this):P.j.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')},ye.prototype.clone=function(){var U=new ye;return U.queries=this.queries.slice(0),U.key=this.key,U.isChild=this.isChild,U.dataManager=this.dataManager,U.fromTable=this.fromTable,U.params=this.params.slice(0),U.expands=this.expands.slice(0),U.sortedColumns=this.sortedColumns.slice(0),U.groupedColumns=this.groupedColumns.slice(0),U.subQuerySelector=this.subQuerySelector,U.subQuery=this.subQuery,U.fKey=this.fKey,U.isCountRequired=this.isCountRequired,U.distincts=this.distincts.slice(0),U.lazyLoad=this.lazyLoad.slice(0),U},ye.prototype.from=function(U){return this.fromTable=U,this},ye.prototype.addParams=function(U,Z){return typeof Z=="function"?this.params.push({key:U,fn:Z}):this.params.push({key:U,value:Z}),this},ye.prototype.distinct=function(U){return typeof U=="string"?this.distincts=[].slice.call([U],0):this.distincts=U.slice(0),this},ye.prototype.expand=function(U){return typeof U=="string"?this.expands=[].slice.call([U],0):this.expands=U.slice(0),this},ye.prototype.where=function(U,Z,E,a,$){Z=Z?Z.toLowerCase():null;var J=null;return typeof U=="string"?J=new w(U,Z,E,a,$):U instanceof w&&(J=U),this.queries.push({fn:"onWhere",e:J}),this},ye.prototype.search=function(U,Z,E,a,$){typeof Z=="string"&&(Z=[Z]),(!E||E==="none")&&(E="contains");var J=P.j.fnOperators[E];return this.queries.push({fn:"onSearch",e:{fieldNames:Z,operator:E,searchKey:U,ignoreCase:a,ignoreAccent:$,comparer:J}}),this},ye.prototype.sortBy=function(U,Z,E){return this.sortByForeignKey(U,Z,E)},ye.prototype.sortByForeignKey=function(U,Z,E,a){var $=(0,F.le)(a)?"ascending":a,J,se;if(typeof U=="string"&&P.j.endsWith(U.toLowerCase()," desc")&&(U=U.replace(/ desc$/i,""),Z="descending"),(!Z||typeof Z=="string")&&($=Z?Z.toLowerCase():"ascending",Z=P.j.fnSort(Z)),E){J=ye.filterQueries(this.queries,"onSortBy");for(var re=0;re<J.length;re++)if(se=J[re].e.fieldName,typeof se=="string"){if(se===U)return this}else if(se instanceof Array){for(var Ae=0;Ae<se.length;Ae++)if(se[Ae]===U||U.toLowerCase()===se[Ae]+" desc")return this}}return this.queries.push({fn:"onSortBy",e:{fieldName:U,comparer:Z,direction:$}}),this},ye.prototype.sortByDesc=function(U){return this.sortBy(U,"descending")},ye.prototype.group=function(U,Z,E){return this.sortBy(U,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:U,comparer:Z||null,format:E||null}}),this},ye.prototype.page=function(U,Z){return this.queries.push({fn:"onPage",e:{pageIndex:U,pageSize:Z}}),this},ye.prototype.range=function(U,Z){return this.queries.push({fn:"onRange",e:{start:U,end:Z}}),this},ye.prototype.take=function(U){return this.queries.push({fn:"onTake",e:{nos:U}}),this},ye.prototype.skip=function(U){return this.queries.push({fn:"onSkip",e:{nos:U}}),this},ye.prototype.select=function(U){return typeof U=="string"&&(U=[].slice.call([U],0)),this.queries.push({fn:"onSelect",e:{fieldNames:U}}),this},ye.prototype.hierarchy=function(U,Z){return this.subQuerySelector=Z,this.subQuery=U,this},ye.prototype.foreignKey=function(U){return this.fKey=U,this},ye.prototype.requiresCount=function(){return this.isCountRequired=!0,this},ye.prototype.aggregate=function(U,Z){return this.queries.push({fn:"onAggregates",e:{field:Z,type:U}}),this},ye.filterQueries=function(U,Z){return U.filter(function(E){return E.fn===Z})},ye.filterQueryLists=function(U,Z){for(var E=U.filter(function(J){return Z.indexOf(J.fn)!==-1}),a={},$=0;$<E.length;$++)a[E[$].fn]||(a[E[$].fn]=E[$].e);return a},ye}(),w=function(){function ye(U,Z,E,a,$){return a===void 0&&(a=!1),this.ignoreAccent=!1,this.isComplex=!1,typeof U=="string"?(this.field=U,this.operator=Z.toLowerCase(),this.value=E,this.ignoreCase=a,this.ignoreAccent=$,this.isComplex=!1,this.comparer=P.j.fnOperators.processOperator(this.operator)):(U instanceof ye&&E instanceof ye||E instanceof Array)&&(this.isComplex=!0,this.condition=Z.toLowerCase(),this.predicates=[U],E instanceof Array?[].push.apply(this.predicates,E):this.predicates.push(E)),this}return ye.and=function(){for(var U=[],Z=0;Z<arguments.length;Z++)U[Z]=arguments[Z];return ye.combinePredicates([].slice.call(U,0),"and")},ye.prototype.and=function(U,Z,E,a,$){return ye.combine(this,U,Z,E,"and",a,$)},ye.or=function(){for(var U=[],Z=0;Z<arguments.length;Z++)U[Z]=arguments[Z];return ye.combinePredicates([].slice.call(U,0),"or")},ye.prototype.or=function(U,Z,E,a,$){return ye.combine(this,U,Z,E,"or",a,$)},ye.fromJson=function(U){if(U instanceof Array){for(var Z=[],E=0,a=U.length;E<a;E++)Z.push(this.fromJSONData(U[E]));return Z}var $=U;return this.fromJSONData($)},ye.prototype.validate=function(U){var Z=this.predicates?this.predicates:[],E,a;if(!this.isComplex&&this.comparer)return this.comparer.call(this,P.j.getObject(this.field,U),this.value,this.ignoreCase,this.ignoreAccent);E=this.condition==="and";for(var $=0;$<Z.length;$++)if(a=Z[$].validate(U),E){if(!a)return!1}else if(a)return!0;return E},ye.prototype.toJson=function(){var U,Z;if(this.isComplex){U=[],Z=this.predicates;for(var E=0;E<Z.length;E++)U.push(Z[E].toJson())}return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:U}},ye.combinePredicates=function(U,Z){if(U.length===1){if(!(U[0]instanceof Array))return U[0];U=U[0]}return new ye(U[0],Z,U.slice(1))},ye.combine=function(U,Z,E,a,$,J,se){return Z instanceof ye?ye[$](U,Z):typeof Z=="string"?ye[$](U,new ye(Z,E,a,J,se)):P.j.throwError("Predicate - "+$+" : invalid arguments")},ye.fromJSONData=function(U){for(var Z=U.predicates||[],E=Z.length,a=[],$,J=0;J<E;J++)a.push(this.fromJSONData(Z[J]));return U.isComplex?$=new ye(a[0],U.condition,a.slice(1)):$=new ye(U.field,U.operator,U.value,U.ignoreCase,U.ignoreAccent),$},ye}()},30620:function(q,be,ae){"use strict";ae.d(be,{j:function(){return ye}});var P=ae(8923),F=ae(27976),Y=ae(15002),w={GroupGuid:"{271bbba0-1ee7}"},ye=function(){function U(){}return U.getValue=function(Z,E){return typeof Z=="function"?Z.call(E||{}):Z},U.endsWith=function(Z,E){return Z.slice&&Z.slice(-E.length)===E},U.startsWith=function(Z,E){return Z.slice(0,E.length)===E},U.fnSort=function(Z){return Z=Z?U.toLowerCase(Z):"ascending",Z==="ascending"?this.fnAscending:this.fnDescending},U.fnAscending=function(Z,E){return(0,P.le)(Z)&&(0,P.le)(E)||E==null?-1:typeof Z=="string"?Z.localeCompare(E):Z==null?1:Z-E},U.fnDescending=function(Z,E){return(0,P.le)(Z)&&(0,P.le)(E)?-1:E==null?1:typeof Z=="string"?Z.localeCompare(E)*-1:Z==null?-1:E-Z},U.extractFields=function(Z,E){for(var a={},$=0;$<E.length;$++)a=this.setValue(E[$],this.getObject(E[$],Z),a);return a},U.select=function(Z,E){for(var a=[],$=0;$<Z.length;$++)a.push(this.extractFields(Z[$],E));return a},U.group=function(Z,E,a,$,J,se,re){$=$||1;var Ae=Z,Ie="GroupGuid";if(Ae.GroupGuid===w[Ie]){for(var Se=function(S){if((0,P.le)(J))Ae[S].items=Q.group(Ae[S].items,E,a,Ae.level+1,null,se,re),Ae[S].count=Ae[S].items.length;else{var m=-1,x=J.filter(function(v){return v.key===Ae[S].key});m=J.indexOf(x[0]),Ae[S].items=Q.group(Ae[S].items,E,a,Ae.level+1,J[m].items,se,re),Ae[S].count=J[m].count}},Q=this,te=0;te<Ae.length;te++)Se(te);return Ae.childLevels+=1,Ae}var O={},d=[];d.GroupGuid=w[Ie],d.level=$,d.childLevels=0,d.records=Ae;for(var M=function(S){var m=T.getVal(Ae,S,E);if((0,P.le)(se)||(m=se(m,E)),!O[m]&&(O[m]={key:m,count:0,items:[],aggregates:{},field:E},d.push(O[m]),!(0,P.le)(J))){var x=J.filter(function(v){return v.key===O[m].key});O[m].count=x[0].count}O[m].count=(0,P.le)(J)?O[m].count+=1:O[m].count,(!re||re&&a.length)&&O[m].items.push(Ae[S])},T=this,b=0;b<Ae.length;b++)M(b);if(a&&a.length)for(var k=function(S){for(var m={},x=void 0,v=a,y=0;y<a.length;y++)if(x=U.aggregates[a[y].type],(0,P.le)(J))x&&(m[v[y].field+" - "+v[y].type]=x(d[S].items,v[y].field));else{var A=J.filter(function(I){return I.key===d[S].key});x&&(m[v[y].field+" - "+v[y].type]=x(A[0].items,v[y].field))}d[S].aggregates=m},b=0;b<d.length;b++)k(b);if(re&&d.length&&a.length)for(var b=0;b<d.length;b++)d[b].items=[];return Ae.length&&d||Ae},U.buildHierarchy=function(Z,E,a,$,J){var se,re={},Ae;for($.result&&($=$.result),$.GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),se=0;se<$.length;se++){var Ie=this.getObject(Z,$[se]);Ae=re[Ie]||(re[Ie]=[]),Ae.push($[se])}for(se=0;se<a.length;se++){var Ie=this.getObject(J||Z,a[se]);a[se][E]=re[Ie]}},U.getFieldList=function(Z,E,a){if(a===void 0&&(a=""),E==null)return this.getFieldList(Z,[],a);for(var $=Z,J=Object.keys(Z),se=0,re=J;se<re.length;se++){var Ae=re[se];typeof $[Ae]=="object"&&!($[Ae]instanceof Array)?this.getFieldList($[Ae],E,a+Ae+"."):E.push(a+Ae)}return E},U.getObject=function(Z,E){if(!Z)return E;if(!!E){if(Z.indexOf(".")===-1)return E[Z];for(var a=E,$=Z.split("."),J=0;J<$.length&&a!=null;J++)a=a[$[J]];return a}},U.setValue=function(Z,E,a){var $=Z.toString().split("."),J=a||{},se=J,re,Ae=$.length,Ie;for(re=0;re<Ae;re++)Ie=$[re],re+1===Ae?se[Ie]=E===void 0?void 0:E:(0,P.le)(se[Ie])&&(se[Ie]={}),se=se[Ie];return J},U.sort=function(Z,E,a){if(Z.length<=1)return Z;var $=parseInt((Z.length/2).toString(),10),J=Z.slice(0,$),se=Z.slice($);return J=this.sort(J,E,a),se=this.sort(se,E,a),this.merge(J,se,E,a)},U.ignoreDiacritics=function(Z){if(typeof Z!="string")return Z;var E=Z.split(""),a=E.map(function($){return $ in U.diacritics?U.diacritics[$]:$});return a.join("")},U.merge=function(Z,E,a,$){for(var J=[],se;Z.length>0||E.length>0;)Z.length>0&&E.length>0?$?se=$(this.getVal(Z,0,a),this.getVal(E,0,a),Z[0],E[0])<=0?Z:E:se=Z[0][a]<Z[0][a]?Z:E:se=Z.length>0?Z:E,J.push(se.shift());return J},U.getVal=function(Z,E,a){return a?this.getObject(a,Z[E]):Z[E]},U.toLowerCase=function(Z){return Z?typeof Z=="string"?Z.toLowerCase():Z.toString():Z===0||Z===!1?Z.toString():""},U.callAdaptorFunction=function(Z,E,a,$){if(E in Z){var J=Z[E](a,$);(0,P.le)(J)||(a=J)}return a},U.getAddParams=function(Z,E,a){var $={};return U.callAdaptorFunction(Z,"addParams",{dm:E,query:a,params:a.params,reqParams:$}),$},U.isPlainObject=function(Z){return!!Z&&Z.constructor===Object},U.isCors=function(){var Z=null,E="XMLHttpRequest";try{Z=new window[E]}catch(a){}return!!Z&&"withCredentials"in Z},U.getGuid=function(Z){var E="0123456789abcdef",a;return(Z||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,function($,J){if("crypto"in window&&"getRandomValues"in crypto){var se=new Uint8Array(1);window.crypto.getRandomValues(se),a=se[0]%16|0}else a=Math.random()*16|0;return E[J===19?a&3|8:a]})},U.isNull=function(Z){return Z==null},U.getItemFromComparer=function(Z,E,a){var $,J,se,re=0,Ae=typeof U.getVal(Z,0,E)=="string";if(Z.length)for(;(0,P.le)($)&&re<Z.length;)$=U.getVal(Z,re,E),se=Z[re++];for(;re<Z.length;re++)J=U.getVal(Z,re,E),!(0,P.le)(J)&&(Ae&&($=+$,J=+J),a($,J)>0&&($=J,se=Z[re]));return se},U.distinct=function(Z,E,a){a=(0,P.le)(a)?!1:a;var $=[],J,se={};return Z.forEach(function(re,Ae){J=typeof Z[Ae]=="object"?U.getVal(Z,Ae,E):Z[Ae],J in se||($.push(a?Z[Ae]:J),se[J]=1)}),$},U.processData=function(Z,E){var a=this.prepareQuery(Z),$=new F.h(E);Z.requiresCounts&&a.requiresCount();var J=$.executeLocal(a),se={result:Z.requiresCounts?J.result:J,count:J.count,aggregates:JSON.stringify(J.aggregates)};return Z.requiresCounts?se:J},U.prepareQuery=function(Z){var E=this,a=new Y.A;if(Z.select&&a.select(Z.select),Z.where){var $=U.parse.parseJson(Z.where);$.filter(function(se){if((0,P.le)(se.condition))a.where(se.field,se.operator,se.value,se.ignoreCase,se.ignoreAccent);else{var re=[];se.field?re.push(new Y.$(se.field,se.operator,se.value,se.ignoreCase,se.ignoreAccent)):re=re.concat(E.getPredicate(se.predicates)),se.condition=="or"?a.where(Y.$.or(re)):se.condition=="and"&&a.where(Y.$.and(re))}})}if(Z.search){var J=U.parse.parseJson(Z.search);J.filter(function(se){return a.search(se.key,se.fields,se.operator,se.ignoreCase,se.ignoreAccent)})}return Z.aggregates&&Z.aggregates.filter(function(se){return a.aggregate(se.type,se.field)}),Z.sorted&&Z.sorted.filter(function(se){return a.sortBy(se.name,se.direction)}),Z.skip&&a.skip(Z.skip),Z.take&&a.take(Z.take),Z.group&&Z.group.filter(function(se){return a.group(se)}),a},U.getPredicate=function(Z){for(var E=[],a=0;a<Z.length;a++){var $=Z[a];if($.field)E.push(new Y.$($.field,$.operator,$.value,$.ignoreCase,$.ignoreAccent));else{for(var J=[],se=this.getPredicate($.predicates),re=0,Ae=Object.keys(se);re<Ae.length;re++){var Ie=Ae[re];J.push(se[Ie])}E.push($.condition=="or"?Y.$.or(J):Y.$.and(J))}}return E},U.serverTimezoneOffset=null,U.timeZoneHandling=!0,U.throwError=function(Z){try{throw new Error(Z)}catch(E){throw E.message+`
`+E.stack}},U.aggregates={sum:function(Z,E){for(var a=0,$,J=typeof U.getVal(Z,0,E)!="number",se=0;se<Z.length;se++)$=U.getVal(Z,se,E),!isNaN($)&&$!==null&&(J&&($=+$),a+=$);return a},average:function(Z,E){return U.aggregates.sum(Z,E)/Z.length},min:function(Z,E){var a;return typeof E=="function"&&(a=E,E=null),U.getObject(E,U.getItemFromComparer(Z,E,a||U.fnAscending))},max:function(Z,E){var a;return typeof E=="function"&&(a=E,E=null),U.getObject(E,U.getItemFromComparer(Z,E,a||U.fnDescending))},truecount:function(Z,E){return new F.h(Z).executeLocal(new Y.A().where(E,"equal",!0,!0)).length},falsecount:function(Z,E){return new F.h(Z).executeLocal(new Y.A().where(E,"equal",!1,!0)).length},count:function(Z,E){return Z.length}},U.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},U.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},U.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof"},U.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains"},U.diacritics={"\u24B6":"A",\uFF21:"A",\u00C0:"A",\u00C1:"A",\u00C2:"A",\u1EA6:"A",\u1EA4:"A",\u1EAA:"A",\u1EA8:"A",\u00C3:"A",\u0100:"A",\u0102:"A",\u1EB0:"A",\u1EAE:"A",\u1EB4:"A",\u1EB2:"A",\u0226:"A",\u01E0:"A",\u00C4:"A",\u01DE:"A",\u1EA2:"A",\u00C5:"A",\u01FA:"A",\u01CD:"A",\u0200:"A",\u0202:"A",\u1EA0:"A",\u1EAC:"A",\u1EB6:"A",\u1E00:"A",\u0104:"A",\u023A:"A",\u2C6F:"A",\uA732:"AA",\u00C6:"AE",\u01FC:"AE",\u01E2:"AE",\uA734:"AO",\uA736:"AU",\uA738:"AV",\uA73A:"AV",\uA73C:"AY","\u24B7":"B",\uFF22:"B",\u1E02:"B",\u1E04:"B",\u1E06:"B",\u0243:"B",\u0182:"B",\u0181:"B","\u24B8":"C",\uFF23:"C",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u00C7:"C",\u1E08:"C",\u0187:"C",\u023B:"C",\uA73E:"C","\u24B9":"D",\uFF24:"D",\u1E0A:"D",\u010E:"D",\u1E0C:"D",\u1E10:"D",\u1E12:"D",\u1E0E:"D",\u0110:"D",\u018B:"D",\u018A:"D",\u0189:"D",\uA779:"D",\u01F1:"DZ",\u01C4:"DZ",\u01F2:"Dz",\u01C5:"Dz","\u24BA":"E",\uFF25:"E",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u1EC0:"E",\u1EBE:"E",\u1EC4:"E",\u1EC2:"E",\u1EBC:"E",\u0112:"E",\u1E14:"E",\u1E16:"E",\u0114:"E",\u0116:"E",\u00CB:"E",\u1EBA:"E",\u011A:"E",\u0204:"E",\u0206:"E",\u1EB8:"E",\u1EC6:"E",\u0228:"E",\u1E1C:"E",\u0118:"E",\u1E18:"E",\u1E1A:"E",\u0190:"E",\u018E:"E","\u24BB":"F",\uFF26:"F",\u1E1E:"F",\u0191:"F",\uA77B:"F","\u24BC":"G",\uFF27:"G",\u01F4:"G",\u011C:"G",\u1E20:"G",\u011E:"G",\u0120:"G",\u01E6:"G",\u0122:"G",\u01E4:"G",\u0193:"G",\uA7A0:"G",\uA77D:"G",\uA77E:"G","\u24BD":"H",\uFF28:"H",\u0124:"H",\u1E22:"H",\u1E26:"H",\u021E:"H",\u1E24:"H",\u1E28:"H",\u1E2A:"H",\u0126:"H",\u2C67:"H",\u2C75:"H",\uA78D:"H","\u24BE":"I",\uFF29:"I",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u0128:"I",\u012A:"I",\u012C:"I",\u0130:"I",\u00CF:"I",\u1E2E:"I",\u1EC8:"I",\u01CF:"I",\u0208:"I",\u020A:"I",\u1ECA:"I",\u012E:"I",\u1E2C:"I",\u0197:"I","\u24BF":"J",\uFF2A:"J",\u0134:"J",\u0248:"J","\u24C0":"K",\uFF2B:"K",\u1E30:"K",\u01E8:"K",\u1E32:"K",\u0136:"K",\u1E34:"K",\u0198:"K",\u2C69:"K",\uA740:"K",\uA742:"K",\uA744:"K",\uA7A2:"K","\u24C1":"L",\uFF2C:"L",\u013F:"L",\u0139:"L",\u013D:"L",\u1E36:"L",\u1E38:"L",\u013B:"L",\u1E3C:"L",\u1E3A:"L",\u0141:"L",\u023D:"L",\u2C62:"L",\u2C60:"L",\uA748:"L",\uA746:"L",\uA780:"L",\u01C7:"LJ",\u01C8:"Lj","\u24C2":"M",\uFF2D:"M",\u1E3E:"M",\u1E40:"M",\u1E42:"M",\u2C6E:"M",\u019C:"M","\u24C3":"N",\uFF2E:"N",\u01F8:"N",\u0143:"N",\u00D1:"N",\u1E44:"N",\u0147:"N",\u1E46:"N",\u0145:"N",\u1E4A:"N",\u1E48:"N",\u0220:"N",\u019D:"N",\uA790:"N",\uA7A4:"N",\u01CA:"NJ",\u01CB:"Nj","\u24C4":"O",\uFF2F:"O",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u1ED2:"O",\u1ED0:"O",\u1ED6:"O",\u1ED4:"O",\u00D5:"O",\u1E4C:"O",\u022C:"O",\u1E4E:"O",\u014C:"O",\u1E50:"O",\u1E52:"O",\u014E:"O",\u022E:"O",\u0230:"O",\u00D6:"O",\u022A:"O",\u1ECE:"O",\u0150:"O",\u01D1:"O",\u020C:"O",\u020E:"O",\u01A0:"O",\u1EDC:"O",\u1EDA:"O",\u1EE0:"O",\u1EDE:"O",\u1EE2:"O",\u1ECC:"O",\u1ED8:"O",\u01EA:"O",\u01EC:"O",\u00D8:"O",\u01FE:"O",\u0186:"O",\u019F:"O",\uA74A:"O",\uA74C:"O",\u01A2:"OI",\uA74E:"OO",\u0222:"OU","\u24C5":"P",\uFF30:"P",\u1E54:"P",\u1E56:"P",\u01A4:"P",\u2C63:"P",\uA750:"P",\uA752:"P",\uA754:"P","\u24C6":"Q",\uFF31:"Q",\uA756:"Q",\uA758:"Q",\u024A:"Q","\u24C7":"R",\uFF32:"R",\u0154:"R",\u1E58:"R",\u0158:"R",\u0210:"R",\u0212:"R",\u1E5A:"R",\u1E5C:"R",\u0156:"R",\u1E5E:"R",\u024C:"R",\u2C64:"R",\uA75A:"R",\uA7A6:"R",\uA782:"R","\u24C8":"S",\uFF33:"S",\u1E9E:"S",\u015A:"S",\u1E64:"S",\u015C:"S",\u1E60:"S",\u0160:"S",\u1E66:"S",\u1E62:"S",\u1E68:"S",\u0218:"S",\u015E:"S",\u2C7E:"S",\uA7A8:"S",\uA784:"S","\u24C9":"T",\uFF34:"T",\u1E6A:"T",\u0164:"T",\u1E6C:"T",\u021A:"T",\u0162:"T",\u1E70:"T",\u1E6E:"T",\u0166:"T",\u01AC:"T",\u01AE:"T",\u023E:"T",\uA786:"T",\uA728:"TZ","\u24CA":"U",\uFF35:"U",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u0168:"U",\u1E78:"U",\u016A:"U",\u1E7A:"U",\u016C:"U",\u00DC:"U",\u01DB:"U",\u01D7:"U",\u01D5:"U",\u01D9:"U",\u1EE6:"U",\u016E:"U",\u0170:"U",\u01D3:"U",\u0214:"U",\u0216:"U",\u01AF:"U",\u1EEA:"U",\u1EE8:"U",\u1EEE:"U",\u1EEC:"U",\u1EF0:"U",\u1EE4:"U",\u1E72:"U",\u0172:"U",\u1E76:"U",\u1E74:"U",\u0244:"U","\u24CB":"V",\uFF36:"V",\u1E7C:"V",\u1E7E:"V",\u01B2:"V",\uA75E:"V",\u0245:"V",\uA760:"VY","\u24CC":"W",\uFF37:"W",\u1E80:"W",\u1E82:"W",\u0174:"W",\u1E86:"W",\u1E84:"W",\u1E88:"W",\u2C72:"W","\u24CD":"X",\uFF38:"X",\u1E8A:"X",\u1E8C:"X","\u24CE":"Y",\uFF39:"Y",\u1EF2:"Y",\u00DD:"Y",\u0176:"Y",\u1EF8:"Y",\u0232:"Y",\u1E8E:"Y",\u0178:"Y",\u1EF6:"Y",\u1EF4:"Y",\u01B3:"Y",\u024E:"Y",\u1EFE:"Y","\u24CF":"Z",\uFF3A:"Z",\u0179:"Z",\u1E90:"Z",\u017B:"Z",\u017D:"Z",\u1E92:"Z",\u1E94:"Z",\u01B5:"Z",\u0224:"Z",\u2C7F:"Z",\u2C6B:"Z",\uA762:"Z","\u24D0":"a",\uFF41:"a",\u1E9A:"a",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u1EA7:"a",\u1EA5:"a",\u1EAB:"a",\u1EA9:"a",\u00E3:"a",\u0101:"a",\u0103:"a",\u1EB1:"a",\u1EAF:"a",\u1EB5:"a",\u1EB3:"a",\u0227:"a",\u01E1:"a",\u00E4:"a",\u01DF:"a",\u1EA3:"a",\u00E5:"a",\u01FB:"a",\u01CE:"a",\u0201:"a",\u0203:"a",\u1EA1:"a",\u1EAD:"a",\u1EB7:"a",\u1E01:"a",\u0105:"a",\u2C65:"a",\u0250:"a",\uA733:"aa",\u00E6:"ae",\u01FD:"ae",\u01E3:"ae",\uA735:"ao",\uA737:"au",\uA739:"av",\uA73B:"av",\uA73D:"ay","\u24D1":"b",\uFF42:"b",\u1E03:"b",\u1E05:"b",\u1E07:"b",\u0180:"b",\u0183:"b",\u0253:"b","\u24D2":"c",\uFF43:"c",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u00E7:"c",\u1E09:"c",\u0188:"c",\u023C:"c",\uA73F:"c",\u2184:"c","\u24D3":"d",\uFF44:"d",\u1E0B:"d",\u010F:"d",\u1E0D:"d",\u1E11:"d",\u1E13:"d",\u1E0F:"d",\u0111:"d",\u018C:"d",\u0256:"d",\u0257:"d",\uA77A:"d",\u01F3:"dz",\u01C6:"dz","\u24D4":"e",\uFF45:"e",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u1EC1:"e",\u1EBF:"e",\u1EC5:"e",\u1EC3:"e",\u1EBD:"e",\u0113:"e",\u1E15:"e",\u1E17:"e",\u0115:"e",\u0117:"e",\u00EB:"e",\u1EBB:"e",\u011B:"e",\u0205:"e",\u0207:"e",\u1EB9:"e",\u1EC7:"e",\u0229:"e",\u1E1D:"e",\u0119:"e",\u1E19:"e",\u1E1B:"e",\u0247:"e",\u025B:"e",\u01DD:"e","\u24D5":"f",\uFF46:"f",\u1E1F:"f",\u0192:"f",\uA77C:"f","\u24D6":"g",\uFF47:"g",\u01F5:"g",\u011D:"g",\u1E21:"g",\u011F:"g",\u0121:"g",\u01E7:"g",\u0123:"g",\u01E5:"g",\u0260:"g",\uA7A1:"g",\u1D79:"g",\uA77F:"g","\u24D7":"h",\uFF48:"h",\u0125:"h",\u1E23:"h",\u1E27:"h",\u021F:"h",\u1E25:"h",\u1E29:"h",\u1E2B:"h",\u1E96:"h",\u0127:"h",\u2C68:"h",\u2C76:"h",\u0265:"h",\u0195:"hv","\u24D8":"i",\uFF49:"i",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u0129:"i",\u012B:"i",\u012D:"i",\u00EF:"i",\u1E2F:"i",\u1EC9:"i",\u01D0:"i",\u0209:"i",\u020B:"i",\u1ECB:"i",\u012F:"i",\u1E2D:"i",\u0268:"i",\u0131:"i","\u24D9":"j",\uFF4A:"j",\u0135:"j",\u01F0:"j",\u0249:"j","\u24DA":"k",\uFF4B:"k",\u1E31:"k",\u01E9:"k",\u1E33:"k",\u0137:"k",\u1E35:"k",\u0199:"k",\u2C6A:"k",\uA741:"k",\uA743:"k",\uA745:"k",\uA7A3:"k","\u24DB":"l",\uFF4C:"l",\u0140:"l",\u013A:"l",\u013E:"l",\u1E37:"l",\u1E39:"l",\u013C:"l",\u1E3D:"l",\u1E3B:"l",\u017F:"l",\u0142:"l",\u019A:"l",\u026B:"l",\u2C61:"l",\uA749:"l",\uA781:"l",\uA747:"l",\u01C9:"lj","\u24DC":"m",\uFF4D:"m",\u1E3F:"m",\u1E41:"m",\u1E43:"m",\u0271:"m",\u026F:"m","\u24DD":"n",\uFF4E:"n",\u01F9:"n",\u0144:"n",\u00F1:"n",\u1E45:"n",\u0148:"n",\u1E47:"n",\u0146:"n",\u1E4B:"n",\u1E49:"n",\u019E:"n",\u0272:"n",\u0149:"n",\uA791:"n",\uA7A5:"n",\u01CC:"nj","\u24DE":"o",\uFF4F:"o",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u1ED3:"o",\u1ED1:"o",\u1ED7:"o",\u1ED5:"o",\u00F5:"o",\u1E4D:"o",\u022D:"o",\u1E4F:"o",\u014D:"o",\u1E51:"o",\u1E53:"o",\u014F:"o",\u022F:"o",\u0231:"o",\u00F6:"o",\u022B:"o",\u1ECF:"o",\u0151:"o",\u01D2:"o",\u020D:"o",\u020F:"o",\u01A1:"o",\u1EDD:"o",\u1EDB:"o",\u1EE1:"o",\u1EDF:"o",\u1EE3:"o",\u1ECD:"o",\u1ED9:"o",\u01EB:"o",\u01ED:"o",\u00F8:"o",\u01FF:"o",\u0254:"o",\uA74B:"o",\uA74D:"o",\u0275:"o",\u01A3:"oi",\u0223:"ou",\uA74F:"oo","\u24DF":"p",\uFF50:"p",\u1E55:"p",\u1E57:"p",\u01A5:"p",\u1D7D:"p",\uA751:"p",\uA753:"p",\uA755:"p","\u24E0":"q",\uFF51:"q",\u024B:"q",\uA757:"q",\uA759:"q","\u24E1":"r",\uFF52:"r",\u0155:"r",\u1E59:"r",\u0159:"r",\u0211:"r",\u0213:"r",\u1E5B:"r",\u1E5D:"r",\u0157:"r",\u1E5F:"r",\u024D:"r",\u027D:"r",\uA75B:"r",\uA7A7:"r",\uA783:"r","\u24E2":"s",\uFF53:"s",\u00DF:"s",\u015B:"s",\u1E65:"s",\u015D:"s",\u1E61:"s",\u0161:"s",\u1E67:"s",\u1E63:"s",\u1E69:"s",\u0219:"s",\u015F:"s",\u023F:"s",\uA7A9:"s",\uA785:"s",\u1E9B:"s","\u24E3":"t",\uFF54:"t",\u1E6B:"t",\u1E97:"t",\u0165:"t",\u1E6D:"t",\u021B:"t",\u0163:"t",\u1E71:"t",\u1E6F:"t",\u0167:"t",\u01AD:"t",\u0288:"t",\u2C66:"t",\uA787:"t",\uA729:"tz","\u24E4":"u",\uFF55:"u",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u0169:"u",\u1E79:"u",\u016B:"u",\u1E7B:"u",\u016D:"u",\u00FC:"u",\u01DC:"u",\u01D8:"u",\u01D6:"u",\u01DA:"u",\u1EE7:"u",\u016F:"u",\u0171:"u",\u01D4:"u",\u0215:"u",\u0217:"u",\u01B0:"u",\u1EEB:"u",\u1EE9:"u",\u1EEF:"u",\u1EED:"u",\u1EF1:"u",\u1EE5:"u",\u1E73:"u",\u0173:"u",\u1E77:"u",\u1E75:"u",\u0289:"u","\u24E5":"v",\uFF56:"v",\u1E7D:"v",\u1E7F:"v",\u028B:"v",\uA75F:"v",\u028C:"v",\uA761:"vy","\u24E6":"w",\uFF57:"w",\u1E81:"w",\u1E83:"w",\u0175:"w",\u1E87:"w",\u1E85:"w",\u1E98:"w",\u1E89:"w",\u2C73:"w","\u24E7":"x",\uFF58:"x",\u1E8B:"x",\u1E8D:"x","\u24E8":"y",\uFF59:"y",\u1EF3:"y",\u00FD:"y",\u0177:"y",\u1EF9:"y",\u0233:"y",\u1E8F:"y",\u00FF:"y",\u1EF7:"y",\u1E99:"y",\u1EF5:"y",\u01B4:"y",\u024F:"y",\u1EFF:"y","\u24E9":"z",\uFF5A:"z",\u017A:"z",\u1E91:"z",\u017C:"z",\u017E:"z",\u1E93:"z",\u1E95:"z",\u01B6:"z",\u0225:"z",\u0240:"z",\u2C6C:"z",\uA763:"z",\u0386:"\u0391",\u0388:"\u0395",\u0389:"\u0397",\u038A:"\u0399",\u03AA:"\u0399",\u038C:"\u039F",\u038E:"\u03A5",\u03AB:"\u03A5",\u038F:"\u03A9",\u03AC:"\u03B1",\u03AD:"\u03B5",\u03AE:"\u03B7",\u03AF:"\u03B9",\u03CA:"\u03B9",\u0390:"\u03B9",\u03CC:"\u03BF",\u03CD:"\u03C5",\u03CB:"\u03C5",\u03B0:"\u03C5",\u03C9:"\u03C9",\u03C2:"\u03C3"},U.fnOperators={equal:function(Z,E,a,$){return $&&(Z=U.ignoreDiacritics(Z),E=U.ignoreDiacritics(E)),a?U.toLowerCase(Z)===U.toLowerCase(E):Z===E},notequal:function(Z,E,a,$){return $&&(Z=U.ignoreDiacritics(Z),E=U.ignoreDiacritics(E)),!U.fnOperators.equal(Z,E,a)},lessthan:function(Z,E,a){return a?U.toLowerCase(Z)<U.toLowerCase(E):((0,P.le)(Z)&&(Z=void 0),Z<E)},greaterthan:function(Z,E,a){return a?U.toLowerCase(Z)>U.toLowerCase(E):Z>E},lessthanorequal:function(Z,E,a){return a?U.toLowerCase(Z)<=U.toLowerCase(E):((0,P.le)(Z)&&(Z=void 0),Z<=E)},greaterthanorequal:function(Z,E,a){return a?U.toLowerCase(Z)>=U.toLowerCase(E):Z>=E},contains:function(Z,E,a,$){return $&&(Z=U.ignoreDiacritics(Z),E=U.ignoreDiacritics(E)),a?!(0,P.le)(Z)&&!(0,P.le)(E)&&U.toLowerCase(Z).indexOf(U.toLowerCase(E))!==-1:!(0,P.le)(Z)&&!(0,P.le)(E)&&Z.toString().indexOf(E)!==-1},notnull:function(Z){return Z!==null},isnull:function(Z){return Z===null},startswith:function(Z,E,a,$){return $&&(Z=U.ignoreDiacritics(Z),E=U.ignoreDiacritics(E)),a?Z&&E&&U.startsWith(U.toLowerCase(Z),U.toLowerCase(E)):Z&&E&&U.startsWith(Z,E)},endswith:function(Z,E,a,$){return $&&(Z=U.ignoreDiacritics(Z),E=U.ignoreDiacritics(E)),a?Z&&E&&U.endsWith(U.toLowerCase(Z),U.toLowerCase(E)):Z&&E&&U.endsWith(Z,E)},processSymbols:function(Z){var E=U.operatorSymbols[Z];if(E){var a=U.fnOperators[E];return a}return U.throwError("Query - Process Operator : Invalid operator")},processOperator:function(Z){var E=U.fnOperators[Z];return E||U.fnOperators.processSymbols(Z)}},U.parse={parseJson:function(Z){return typeof Z=="string"?Z=JSON.parse(Z,U.parse.jsonReviver):Z instanceof Array?U.parse.iterateAndReviveArray(Z):typeof Z=="object"&&Z!==null&&U.parse.iterateAndReviveJson(Z),Z},iterateAndReviveArray:function(Z){for(var E=0;E<Z.length;E++)typeof Z[E]=="object"&&Z[E]!==null?U.parse.iterateAndReviveJson(Z[E]):typeof Z[E]=="string"&&!/^[\s]*\[|^[\s]*\{(.)+:|\"/g.test(Z[E])?Z[E]=U.parse.jsonReviver("",Z[E]):Z[E]=U.parse.parseJson(Z[E])},iterateAndReviveJson:function(Z){for(var E,a=Object.keys(Z),$=0,J=a;$<J.length;$++){var se=J[$];U.startsWith(se,"__")||(E=Z[se],typeof E=="object"?E instanceof Array?U.parse.iterateAndReviveArray(E):E&&U.parse.iterateAndReviveJson(E):Z[se]=U.parse.jsonReviver(Z[se],E))}},jsonReviver:function(Z,E){if(typeof E=="string"){var a=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(E),$=U.timeZoneHandling?U.serverTimezoneOffset:null;if(a)return U.dateParse.toTimeZone(new Date(parseInt(a[1],10)),$,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(E)){var J=E.indexOf("Z")>-1||E.indexOf("z")>-1,se=E.split(/[^0-9.]/);if(J)E=U.dateParse.toTimeZone(new Date(parseInt(se[0],10),parseInt(se[1],10)-1,parseInt(se[2],10),parseInt(se[3],10),parseInt(se[4],10),parseInt(se[5],10)),U.serverTimezoneOffset,!1);else{var re=new Date(parseInt(se[0],10),parseInt(se[1],10)-1,parseInt(se[2],10),parseInt(se[3],10),parseInt(se[4],10),parseInt(se[5],10)),Ae=parseInt(se[6],10),Ie=parseInt(se[7],10);if(isNaN(Ae)&&isNaN(Ie))return re;E.indexOf("+")>-1?re.setHours(re.getHours()-Ae,re.getMinutes()-Ie):re.setHours(re.getHours()+Ae,re.getMinutes()+Ie),E=U.dateParse.toTimeZone(re,U.serverTimezoneOffset,!1)}U.serverTimezoneOffset==null&&(E=U.dateParse.addSelfOffset(E))}}return E},isJson:function(Z){return typeof Z[0]=="string"?Z:U.parse.parseJson(Z)},isGuid:function(Z){var E=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i,a=E.exec(Z);return a!=null},replacer:function(Z,E){return U.isPlainObject(Z)?U.parse.jsonReplacer(Z,E):Z instanceof Array?U.parse.arrayReplacer(Z):Z instanceof Date?U.parse.jsonReplacer({val:Z},E).val:Z},jsonReplacer:function(Z,E){for(var a,$=Object.keys(Z),J=0,se=$;J<se.length;J++){var re=se[J];if(a=Z[re],a instanceof Date){var Ae=a;U.serverTimezoneOffset==null?Z[re]=U.dateParse.toTimeZone(Ae,null).toJSON():(Ae=new Date(+Ae+U.serverTimezoneOffset*36e5),Z[re]=U.dateParse.toTimeZone(U.dateParse.addSelfOffset(Ae),null).toJSON())}}return Z},arrayReplacer:function(Z){for(var E=0;E<Z.length;E++)U.isPlainObject(Z[E])?Z[E]=U.parse.jsonReplacer(Z[E]):Z[E]instanceof Date&&(Z[E]=U.parse.jsonReplacer({date:Z[E]}).date);return Z},jsonDateReplacer:function(Z,E){if(Z==="value"&&E){if(typeof E=="string"){var a=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(E);if(a)E=U.dateParse.toTimeZone(new Date(parseInt(a[1],10)),null,!0);else if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(E)){var $=E.split(/[^0-9]/);E=U.dateParse.toTimeZone(new Date(parseInt($[0],10),parseInt($[1],10)-1,parseInt($[2],10),parseInt($[3],10),parseInt($[4],10),parseInt($[5],10)),null,!0)}}if(E instanceof Date)return E=U.dateParse.addSelfOffset(E),U.serverTimezoneOffset===null?U.dateParse.toTimeZone(U.dateParse.addSelfOffset(E),null).toJSON():(E=U.dateParse.toTimeZone(E,E.getTimezoneOffset()/60*2-U.serverTimezoneOffset,!1),E.toJSON())}return E}},U.dateParse={addSelfOffset:function(Z){return new Date(+Z-Z.getTimezoneOffset()*6e4)},toUTC:function(Z){return new Date(+Z+Z.getTimezoneOffset()*6e4)},toTimeZone:function(Z,E,a){if(E===null)return Z;var $=a?U.dateParse.toUTC(Z):Z;return new Date(+$-E*36e5)},toLocalTime:function(Z){var E=Z,a=-E.getTimezoneOffset(),$=a>=0?"+":"-",J=function(re){var Ae=Math.floor(Math.abs(re));return(Ae<10?"0":"")+Ae},se=E.getFullYear()+"-"+J(E.getMonth()+1)+"-"+J(E.getDate())+"T"+J(E.getHours())+":"+J(E.getMinutes())+":"+J(E.getSeconds())+$+J(a/60)+":"+J(a%60);return se}},U}()},57474:function(q,be,ae){"use strict";ae.d(be,{Pz:function(){return O},Gl:function(){return F},Lh:function(){return k},Rj:function(){return b}});var P=ae(8923),F;(function(S){S[S.na=0]="na",S[S.value=1]="value",S[S.ref=2]="ref",S[S.divzero=3]="divzero",S[S.num=4]="num",S[S.name=5]="name",S[S.null=6]="null"})(F||(F={}));var Y;(function(S){S[S.operators_cannot_start_with_expression=0]="operators_cannot_start_with_expression",S[S.reservedWord_And=1]="reservedWord_And",S[S.reservedWord_Xor=2]="reservedWord_Xor",S[S.reservedWord_If=3]="reservedWord_If",S[S.number_contains_2_decimal_points=4]="number_contains_2_decimal_points",S[S.reservedWord_Else=5]="reservedWord_Else",S[S.reservedWord_Not=6]="reservedWord_Not",S[S.invalid_char_in_number=7]="invalid_char_in_number",S[S.invalid_characters_following_with_operator=6]="invalid_characters_following_with_operator",S[S.mismatched_parentheses=8]="mismatched_parentheses",S[S.unknown_formula_name=9]="unknown_formula_name",S[S.requires_a_single_argument=10]="requires_a_single_argument",S[S.requires_3_args=11]="requires_3_args",S[S.invalid_Math_argument=12]="invalid_Math_argument",S[S.requires_2_args=13]="requires_2_args",S[S.bad_index=14]="bad_index",S[S.too_complex=15]="too_complex",S[S.circular_reference=16]="circular_reference",S[S.missing_formula=17]="missing_formula",S[S.improper_formula=18]="improper_formula",S[S.invalid_expression=19]="invalid_expression",S[S.cell_empty=20]="cell_empty",S[S.bad_formula=21]="bad_formula",S[S.empty_expression=22]="empty_expression",S[S.virtual_mode_required=23]="virtual_mode_required",S[S.mismatched_tics=24]="mismatched_tics",S[S.wrong_number_arguments=25]="wrong_number_arguments",S[S.invalid_arguments=26]="invalid_arguments",S[S.iterations_do_not_converge=27]="iterations_do_not_converge",S[S.calculation_overflow=29]="calculation_overflow",S[S.already_registered=28]="already_registered",S[S.missing_sheet=30]="missing_sheet",S[S.cannot_parse=31]="cannot_parse",S[S.expression_cannot_end_with_an_operator=32]="expression_cannot_end_with_an_operator",S[S.spill=33]="spill",S[S.div=34]="div"})(Y||(Y={}));var w;(function(S){S.xlsx="xlsx",S.xlsm="xlsm",S.xlsb="xlsb",S.xltx="xltx",S.xltm="xltm",S.xls="xls",S.xml="xml",S.xlam="xlam",S.xla="xla",S.xlw="xlw",S.xlr="xlr",S.prn="prn",S.txt="txt",S.csv="csv",S.dif="dif",S.slk="slk"})(w||(w={}));var ye=function(){function S(m){this.parent=m}return S.prototype.getModuleName=function(){return"calc-common"},S}();function U(S){return typeof S=="undefined"}function Z(S){switch(S){case"dd-MMM-yyyy":case"dd MMM yyyy":S="medium";break;case"MMM-yyyy":case"MMM yyyy":S="yMMM";break;case"MM-dd-yyyy":case"dd-MM-yyyy":case"dd-MM-yy":case"MM/dd/yyyy":case"dd/MM/yyyy":case"dd/MM/yy":S="short";break;case"dddd MMMM dd yyyy":case"dd MMMM yyyy":S="long";break;case"d MMMM yyyy":S="yMMMd";break;case"yyyy":S="y";break;case"h:mm":S="Hm";break;case"h:mm tt":S="hm";break;case"h":S="H";break;case"h tt":S="h";break;case"dddd":S="E";break;case"h:mm:ss tt":S="hms";break;case"h:mm:ss":S="Hms";break;case"d":S="d";break;case"d dddd":S="Ed";break;case"M":S="M";break;case"Md":S="Md";break;case"MMM":S="MMM";break;case"ddd MMM d":S="MMMEd";break;case"MMM d":S="MMMd";break;case"M/yyyy":S="yM";break;case"ddd":S="E";break;default:S="";break}return S}function E(S){var m=!1;for(var x in w)if(S.indexOf("."+x+"]")>-1){m=!0;break}return m}function a(S){var m=[];return S.includeBasicFormulas&&m.push({member:"basic-formulas",args:[S]}),m}var $="Module";function J(S,m){for(var x=m,v=S.replace(/\[/g,".").replace(/\]/g,"").split("."),y=0;y<v.length&&!(0,P.o8)(x);y++)x=x[v[y]];return x}function se(S,m,x){var v=S.replace(/\[/g,".").replace(/\]/g,"").split("."),y=x||{},A=y,I,N=v.length,z;for(I=0;I<N;I++)z=v[I],I+1===N?A[z]=m===void 0?{}:m:(0,P.le)(A[z])&&(A[z]={}),A=A[z];return y}var re=function(){function S(m){this.loadedModules=[],this.parent=m}return S.prototype.inject=function(m,x){var v=m.length;if(v===0){this.clean();return}this.loadedModules.length&&this.clearUnusedModule(m);for(var y=0;y<v;y++)for(var A=m[y],I=0,N=x;I<N.length;I++){var z=N[I],V=A.member;if(z.prototype.getModuleName()===A.member&&!this.isModuleLoaded(V)){var _=this.createInstance(z,A.args),G=this.getMemberName(V);A.isProperty?se(G,z,this.parent):se(G,_,this.parent);var K=A;K.member=G,this.loadedModules.push(K)}}},S.prototype.createInstance=function(m,x){var v=x;return v.unshift(void 0),new(Function.prototype.bind.apply(m,v))},S.prototype.clean=function(){for(var m=0,x=this.loadedModules;m<x.length;m++){var v=x[m];v.isProperty||J(v.member,this.parent).destroy()}this.loadedModules=[]},S.prototype.clearUnusedModule=function(m){for(var x=this,v=m.map(function(z){return x.getMemberName(z.member)}),y=this.loadedModules.filter(function(z){return v.indexOf(z.member)===-1}),A=0,I=y;A<I.length;A++){var N=I[A];N.isProperty||J(N.member,this.parent).destroy(),this.loadedModules.splice(this.loadedModules.indexOf(N),1),this.deleteObject(this.parent,N.member)}},S.prototype.getMemberName=function(m){return m[0].toLowerCase()+m.substring(1)+$},S.prototype.deleteObject=function(m,x){delete m[x]},S.prototype.isModuleLoaded=function(m){for(var x=0,v=this.loadedModules;x<v.length;x++){var y=v[x];if(y.member===this.getMemberName(m))return!0}return!1},S}(),Ae=ae(30620),Ie=function(){function S(m){this.formulas=[{formulaName:"SUM",category:"Math & Trig",description:"Sums individual values, cell references or ranges."},{formulaName:"SUMIFS",category:"Math & Trig",description:"Sums the cells specified by a given set of conditionsor criteria."},{formulaName:"SUMPRODUCT",category:"Math & Trig",description:"Returns sum of the product of given ranges of arrays."},{formulaName:"ABS",category:"Math & Trig",description:"Returns the absolute value of a number."},{formulaName:"RAND",category:"Math & Trig",description:"Return a random number between 0 and 1."},{formulaName:"FLOOR",category:"Math & Trig",description:"Returns the round a number down to the nearest integer."},{formulaName:"CEILING",category:"Math & Trig",description:"Returns a number rounded up to a multiple of another number."},{formulaName:"SUMIF",category:"Math & Trig",description:"It will sum up cells that meet the given criteria."},{formulaName:"PRODUCT",category:"Math & Trig",description:"Multiplies all the numbers given as arguments and returns the product."},{formulaName:"AVERAGE",category:"Statistical",description:"The sum of the numbers divided by how many numbers are being averaged."},{formulaName:"AVERAGEIF",category:"Statistical",description:"Computes the average of the numbers in a range that meet the supplied criteria."},{formulaName:"COUNT",category:"Statistical",description:"Counts the numbers in the list of arguments, exclude text entries."},{formulaName:"COUNTA",category:"Statistical",description:"Counts the non-empty values in the list of arguments."},{formulaName:"COUNTIF",category:"Statistical",description:"Counts the number of cells in a range that meet a specified condition."},{formulaName:"COUNTIFS",category:"Statistical",description:"Counts the number of times each cells in all the ranges that meet the specific conditions."},{formulaName:"AVERAGEA",category:"Statistical",description:"Calculates the average of values in the list of arguments.Arguments can be numbers, names, arrays or references."},{formulaName:"AVERAGEIFS",category:"Statistical",description:"Conditionally returns the average of the contents of cells for the set of ranges."},{formulaName:"MIN",category:"Statistical",description:"Returns the smaller number in set of arguments."},{formulaName:"MAX",category:"Statistical",description:"Returns the largest number in set of arguments."},{formulaName:"DATE",category:"Date",description:"Returns the date, given the year, month and day of the month."},{formulaName:"DAY",category:"Date",description:"Returns the day of a given date."},{formulaName:"TODAY",category:"Date",description:"Returns the current date as date value."},{formulaName:"DAYS",category:"Date",description:"Returns the number of days between two dates."},{formulaName:"WEEKDAY",category:"Date",description:"Returns the day of the week corresponding to a date."},{formulaName:"IF",category:"Logical",description:"Returns one value if a logical expression is TRUE and another if it is FALSE"},{formulaName:"AND",category:"Logical",description:"Returns TRUE if all the arguments are considered TRUE, and FALSE otherwise."},{formulaName:"IFS",category:"Logical",description:"Checks multiple conditions and returns a value corresponding to the first TRUE result."},{formulaName:"IFERROR",category:"Logical",description:"Returns a value you specify if a formula evaluates to an error; otherwise, it returns the result of the formula."},{formulaName:"CHOOSE",category:"Lookup & Reference",description:"Returns a value from a list, given an index number."},{formulaName:"INDEX",category:"Lookup & Reference",description:"Returns a value from a table, given a row and column number."},{formulaName:"FIND",category:"Text",description:"Returns the position of a string of text within another string."},{formulaName:"CONCATENATE",category:"Text",description:" Used to join two or more strings together."},{formulaName:"CONCAT",category:"Text",description:"Concatenates a list or range of text strings."},{formulaName:"SUBTOTAL",category:"Lookup & Reference",description:"Returns a subtotal in a list or database."},{formulaName:"RADIANS",category:"Math & Trig",description:"Converts degrees to radians."},{formulaName:"OR",category:"Logical",description:"Returns TRUE if any arguments considered TRUE, and all the arguments are FALSE it will return FALSE."},{formulaName:"MATCH",category:"Lookup & Reference",description:"Returns the relative position of an checked item in range that matches a specified value in a specified order"},{formulaName:"RANDBETWEEN",category:"Math & Trig",description:"Returns an integer random number in a specified range."},{formulaName:"SLOPE",category:"Statistical",description:"Returns the slope of the line from linear regression of the data points."},{formulaName:"INTERCEPT",category:"Statistical",description:"Calculates the point of the Y-intercept line via linear regression."},{formulaName:"UNIQUE",category:"Lookup & Reference",description:"Returns a unique values from a range or array."},{formulaName:"ROUNDUP",category:"Math & Trig",description:"Rounds a number away from zero."},{formulaName:"INT",category:"Math & Trig",description:"Returns a number to the nearest integer."},{formulaName:"LN",category:"Math & Trig",description:"Returns the natural logarithm of a number."},{formulaName:"ISNUMBER",category:"Information",description:"Returns TRUE, if the argument is number and FALSE otherwise."},{formulaName:"ROUND",category:"Math & Trig",description:"Rounds a number to a specified number of digits."},{formulaName:"LOG",category:"Math & Trig",description:"Returns the logarithm of a number to the base that you specify."},{formulaName:"POWER",category:"Math & Trig",description:"Returns the result of a number raised to power."},{formulaName:"TRUNC",category:"Math & Trig",description:"Returns the truncated value of a number to a specified number of decimal places."},{formulaName:"EXP",category:"Math & Trig",description:"Returns e raised to the power of the given number."},{formulaName:"GEOMEAN",category:"Statistical",description:"Returns the geometric mean of an array or range of positive data."},{formulaName:"TEXT",category:"Lookup & Reference",description:"Converts a value to text in specified number format."},{formulaName:"SORT",category:"Lookup & Reference",description:"Sorts a range of an array."},{formulaName:"T",category:"Text",description:"Checks whether a value is text or not and returns the text."},{formulaName:"EXACT",category:"Text",description:"Checks whether a two text strings are exactly same and returns TRUE or FALSE."},{formulaName:"LEN",category:"Text",description:"Returns a number of characters in a given string."},{formulaName:"MOD",category:"Math & Trig",description:"Returns a remainder after a number is divided by divisor."},{formulaName:"ODD",category:"Math & Trig",description:"Rounds a positive number up and negative number down to the nearest odd integer."},{formulaName:"PI",category:"Math & Trig",description:"Returns the value of pi."},{formulaName:"COUNTBLANK",category:"Statistical",description:"Returns the number of empty cells in a specified range of cells."},{formulaName:"EVEN",category:"Math & Trig",description:"Rounds a positive number up and negative number down to the nearest even integer."},{formulaName:"FACT",category:"Math & Trig",description:"Returns the factorial of a number."},{formulaName:"DECIMAL",category:"Math & Trig",description:"Converts a text representation of a number in a given base into a decimal number."},{formulaName:"DEGREES",category:"Math & Trig",description:"Converts radians to degrees."},{formulaName:"ADDRESS",category:"Lookup & Reference",description:"Returns a cell reference as text, given specified row and column numbers."},{formulaName:"TIME",category:"Date & Time",description:"Converts hours, minutes, seconds to the time formatted text."},{formulaName:"CHAR",category:"Text",description:"Returns the character from the specified number."},{formulaName:"CODE",category:"Text",description:"Returns the numeric code for the first character in a given string."},{formulaName:"DOLLAR",category:"Text",description:"Converts the number to currency formatted text."},{formulaName:"SMALL",category:"Statistical",description:"Returns the k-th smallest value in a given array."},{formulaName:"LARGE",category:"Statistical",description:"Returns the k-th largest value in a given array."},{formulaName:"MEDIAN",category:"Statistical",description:"Returns the median of the given set of numbers."},{formulaName:"EDATE",category:"Date & Time",description:"Returns a date with given number of months before or after the specified date."},{formulaName:"DATEVALUE",category:"Date & Time",description:"Converts a date string into date value."},{formulaName:"HOUR",category:"Date & Time",description:"Returns the number of hours in a specified time string."},{formulaName:"MINUTE",category:"Date & Time",description:"Returns the number of minutes in a specified time string."},{formulaName:"SECOND",category:"Date & Time",description:"Returns the number of seconds in a specified time string."},{formulaName:"NOW",category:"Date & Time",description:"Returns the current date and time."},{formulaName:"MONTH",category:"Date & Time",description:"Returns the number of months in a specified date string."},{formulaName:"PROPER",category:"Text",description:"Converts a text to proper case; first letter to uppercase and other letters to lowercase."}],this.isConcat=!1,this.parent=m,this.init()}return S.prototype.init=function(){for(var m,x=0;x<this.formulas.length;x++)m=(0,P.NA)("Compute"+this.formulas[x].formulaName,this).bind(this),this.addFormulaCollection(this.formulas[x].formulaName.toUpperCase(),m,this.formulas[x].category,this.formulas[x].description)},S.prototype.addFormulaCollection=function(m,x,v,y){this.parent.libraryFormulas={fName:m,handler:x,category:v,description:y}},S.prototype.ComputeSUM=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];var v=0,y,A,I=0;if(!(0,P.le)(m))for(var N=m,z=function(oe){oe.toString().indexOf(".")>-1&&(I=Math.max(I,oe.split(".")[1].length))},V=0;V<N.length;V++){var _=N[V].toString();if(_.indexOf(":")>-1&&this.parent.isCellReference(_))for(var G=this.parent.getCellCollection(_.split(this.parent.tic).join("")),K=0;K<G.length;K++){if(y=this.parent.getValueFromArg(G[K]),this.parent.getErrorStrings().indexOf(y)>-1)return y;(0,P.le)(y[0])||isNaN(this.parent.parseFloat(y))||(z(y),v=v+this.parent.parseFloat(y))}else{if(N[V].split(this.parent.tic).join("")===this.parent.trueValue&&(N[V]="1"),N[V].split(this.parent.tic).join("")===this.parent.falseValue&&(N[V]="0"),A=this.parent.getValueFromArg(N[V].split(this.parent.tic).join("")),this.parent.getErrorStrings().indexOf(A)>-1)return A;if((0,P.le)(A)||isNaN(this.parent.parseFloat(A)))continue;A.length>0&&(z(A),v=v+this.parent.parseFloat(A+""))}}return v.toString().indexOf(".")>-1?v.toFixed(I):v},S.prototype.ComputeINT=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v,y,A;return(!(0,P.le)(m)&&m.length!==1||m[0]==="")&&(v=this.parent.formulaErrorStrings[Y.invalid_arguments]),m[0]!==""&&m.length===1&&(v=m[0],A=v.indexOf('"'),v=v.indexOf('"')>-1?v.replace('"',""):v,v=v.indexOf('"')>-1?v.replace('"',""):v,v=this.parent.getValueFromArg(v),v=v.toUpperCase()==="TRUE"?"1":v==="FALSE"?"0":v,y=this.parent.parseFloat(v),y=Math.floor(y)),isNaN(y)&&(v=A>-1?this.parent.getErrorStrings()[F.value]:this.parent.getErrorStrings()[F.name]),y||v},S.prototype.ComputeTODAY=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;if(m&&m[0]!=="")v=this.parent.formulaErrorStrings[Y.invalid_arguments];else{var y=new Date(Date.now());this.parent.parentObject.getModuleName()==="spreadsheet"?(v=this.parent.parentObject.dateToInt(y),this.parent.parser.storedStringText.toUpperCase().indexOf("TODAY")===0&&this.parent.parentObject.setDateFormat(this.parent.getSheetId(this.parent.grid),this.parent.rowIndex(this.parent.cell)-1,this.parent.colIndex(this.parent.cell)-1)):v=y.getFullYear()+"/"+this.parent.calculateDate((y.getMonth()+1).toString())+"/"+this.parent.calculateDate(y.getDate().toString())}return v},S.prototype.ComputeWEEKDAY=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;if(m[0]==="")v=this.parent.formulaErrorStrings[Y.invalid_arguments];else{var y=this.parent.getValueFromArg(m[0]);v=Math.ceil(Number(y))%7||7}return v},S.prototype.ComputePROPER=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;if(m&&m[0]===""||m.length!==1)return this.parent.formulaErrorStrings[Y.invalid_arguments];var y=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join("");if(y===this.parent.getErrorStrings()[F.name])return this.parent.getErrorStrings()[F.name];for(var A=y.toLowerCase().split(" "),I=0;I<A.length;I++)if(A[I][0]){for(var N=0;N<A[I].length;N++)if(A[I].charCodeAt(N)>=97&&A[I].charCodeAt(N)<=122){A[I]=A[I].replace(A[I][N],A[I][N].toUpperCase());break}}if(v=A.join(" "),v.indexOf("-")>0){for(var z=v.split("-"),I=0;I<z.length;I++)if(z[I][0]){for(var N=0;N<z[I].length;N++)if(z[I].charCodeAt(N)>=97&&z[I].charCodeAt(N)<=122){z[I]=z[I].replace(z[I][N],z[I][N].toUpperCase());break}}v=z.join("-")}if(v.indexOf(",")>0){for(var V=v.split(","),I=0;I<V.length;I++)if(V[I][0]){for(var N=0;N<V[I].length;N++)if(V[I].charCodeAt(N)>=97&&V[I].charCodeAt(N)<=122){V[I]=V[I].replace(V[I][N],V[I][N].toUpperCase());break}}v=V.join(",")}return v},S.prototype.ComputeSUMPRODUCT=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];for(var v=0,y=0,A,I=null,N=m,z=0;z<N.length;++z){var V=N[z];if(!V.startsWith(this.parent.tic)&&this.parent.isCellReference(V)){var _=V.indexOf(":"),G=this.parent.rowIndex(V.substr(0,_)),K=this.parent.rowIndex(V.substr(_+1));if(!(G!==-1||K===-1)==(G===-1||K!==-1))return this.parent.getErrorStrings()[F.name];var oe=this.parent.colIndex(V.substr(0,_)),he=this.parent.colIndex(V.substr(_+1));if(I===null)for(y=(K-G+1)*(he-oe+1),I=[],_=0;_<y;++_)I[_]=1;_=0;for(var ue=G;ue<=K;++ue)for(var X=oe;X<=he;++X){var Ce=this.getSheetReference(V)+this.parent.convertAlpha(X)+ue,ze=this.parent.getValueFromArg(Ce);if(isNaN(parseFloat(ze)))I[_]=0;else{if(isNaN(I[_]))return this.parent.getErrorStrings()[F.name];I[_]=I[_]*parseFloat(ze)}_++}}else{var We=this.parent.getValueFromArg(V);return A=We.indexOf('"'),this.parent.getErrorStrings().indexOf(We)>-1?We:A>-1?0:this.parent.formulaErrorStrings[Y.invalid_arguments]}}for(var _=0;_<y;++_)v+=I[_];return v},S.prototype.ComputeROUNDUP=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v,y,A,I,N,z=m.length;if(!(0,P.le)(m)&&z>2&&(v=this.parent.formulaErrorStrings[Y.invalid_arguments]),z===1&&m[0]!=="")N=m[0].indexOf('"'),A=m[0].indexOf('"')>-1?m[0].replace('"',""):m[0],A=A.indexOf('"')>-1?A.replace('"',""):A,A=A.toUpperCase()==="TRUE"?"1":A==="FALSE"?"0":A,A=this.parent.getValueFromArg(A),y=this.parent.parseFloat(A),y>0?y+=.4999999999:y<0&&(y-=.4999999999),y=this.parent.parseFloat(y.toFixed(0)),v=y.toString();else if(z===2&&m[0]!==""&&m[1]!==""){N=m[0].indexOf('"')>-1?m[0].indexOf('"'):m[1].indexOf('"')>-1?m[1].indexOf('"'):-1,A=m[0].indexOf('"')>-1?m[0].replace('"',""):m[0],A=A.indexOf('"')>-1?A.replace('"',""):A,I=m[1].indexOf('"')>-1?m[1].replace('"',""):m[1],I=I.indexOf('"')>-1?I.replace('"',""):I,A=A.toUpperCase()==="TRUE"?"1":A==="FALSE"?"0":A,I=I.toUpperCase()==="TRUE"?"1":I==="FALSE"?"0":I,A=this.parent.getValueFromArg(A),I=this.parent.getValueFromArg(I);var V=Math.ceil(this.parent.parseFloat(I));y=this.parent.parseFloat(A),V>0?(y>0?y+=.4999999999/Math.pow(10,V):y<0&&(y-=.4999999999/Math.pow(10,V)),y=this.parent.parseFloat(y.toFixed(V)),v=y.toFixed(V),isNaN(y)&&(V.toString().indexOf('"')>-1?v=this.parent.getErrorStrings()[F.value]:v=this.parent.getErrorStrings()[F.name])):(y>0?y=y/Math.pow(10,-V)+.49999:y<0&&(y=y/Math.pow(10,-V)-.49999),y=this.parent.parseFloat(y.toFixed(0))*Math.pow(10,-V),v=y.toString(),isNaN(y)&&(v=V.toString().indexOf('"')>-1?this.parent.getErrorStrings()[F.value]:v=this.parent.getErrorStrings()[F.name]))}else v=N>-1?this.parent.getErrorStrings()[F.value]:this.parent.formulaErrorStrings[Y.invalid_arguments];return v},S.prototype.ComputeCOUNT=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.wrong_number_arguments];for(var v=m,y,A,I=0,N,z=0;z<v.length;z++)if(y=v[z],y.indexOf(":")>-1&&this.parent.isCellReference(y)){A=this.parent.getCellCollection(y.split(this.parent.tic).join(""));for(var V=0;V<A.length;V++)N=this.parent.getValueFromArg(A[V]),isNaN(this.parent.parseFloat(N))||y.length>0&&y!==""&&y!==" "&&I++}else y=y.split(this.parent.tic).join(""),isNaN(this.parent.parseFloat(this.parent.getValueFromArg(y)))||y.length>0&&y!==""&&y!==" "&&I++;return I},S.prototype.ComputeDATE=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var v=m;if(v.length!==3)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];for(var y=0;y<v.length;++y)v[y]=this.parent.getValueFromArg(v[y]);v[0]=v[0].split(this.parent.tic).join("")==="TRUE"?"1":v[0].split(this.parent.tic).join("")==="FALSE"?"0":v[0],v[1]=v[1].split(this.parent.tic).join("")==="TRUE"?"1":v[1].split(this.parent.tic).join("")==="FALSE"?"0":v[1],v[2]=v[2].split(this.parent.tic).join("")==="TRUE"?"1":v[2].split(this.parent.tic).join("")==="FALSE"?"0":v[2];var A=this.parent.parseFloat(v[0].split(this.parent.tic).join("")),I=this.parent.parseFloat(v[1].split(this.parent.tic).join("")),N=this.parent.parseFloat(v[2].split(this.parent.tic).join("")),z=0;if(!isNaN(A)&&!isNaN(I)&&!isNaN(N)){if(A<0)return this.parent.getErrorStrings()[F.num].toString();for(;I>12;)I-=12,A++;z=this.parent.getSerialDateFromDate(A,I,N)}else return this.parent.getErrorStrings()[F.value].toString();if(z===0)return this.parent.getErrorStrings()[F.num].toString();var V=this.parent.fromOADate(z);return V.toString()!=="Invalid Date"?V.getFullYear()+"/"+this.parent.calculateDate((V.getMonth()+1).toString())+"/"+this.parent.calculateDate(V.getDate().toString()):z.toString()},S.prototype.ComputeFLOOR=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];var v=m,y=v.length,A=v[1].split(this.parent.tic).join(""),I=[],N,z;if(y!==2)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];if(I.push(N=this.parent.parseFloat(this.parent.getValueFromArg(v[0].split(this.parent.tic).join("")))),v[1]=A===this.parent.trueValue?"1":A===this.parent.falseValue?"0":v[1],I.push(z=this.parent.parseFloat(this.parent.getValueFromArg(v[1].split(this.parent.tic).join("")))),N>0&&z<0)return this.parent.getErrorStrings()[F.num];if(N>0&&z===0)return this.parent.getErrorStrings()[F.divzero];for(var V=0;V<v.length;V++)if(v[V].indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[F.value];return isNaN(N)?this.parent.getErrorStrings()[F.name]:Math.floor(N/z)*z},S.prototype.ComputeCEILING=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];var v=m,y=[],A=v.length,I=v[1].split(this.parent.tic).join(""),N,z;if(A!==2)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];if(y.push(N=this.parent.parseFloat(this.parent.getValueFromArg(v[0].split(this.parent.tic).join("")))),v[1]=I===this.parent.trueValue?"1":I===this.parent.falseValue?"0":v[1],y.push(z=this.parent.parseFloat(this.parent.getValueFromArg(v[1].split(this.parent.tic).join("")))),N>0&&z<0)return this.parent.getErrorStrings()[F.num];for(var V=0;V<v.length;V++)if(v[V].indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[F.value];return isNaN(N)?this.parent.getErrorStrings()[F.name]:z===0?0:Math.ceil(N/z)*z},S.prototype.ComputeDAY=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y;if((0,P.le)(v)||v.length===1&&v[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];if(v.length>1)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var A=this.parent.getValueFromArg(v[0].split(this.parent.tic).join(""));return isNaN(this.parent.parseFloat(A))?(y=this.parent.parseDate(A),Object.prototype.toString.call(y)==="[object Date]"&&(y=y.getDate()),y):this.parent.getErrorStrings()[F.name]},S.prototype.ComputeIF=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];if(this.parent.getErrorStrings().indexOf(m[0])>0)return m[0];var v=m,y;v.length===4&&v[3]==="nestedFormulaTrue"&&(y=!0,v.pop());var A,I;if(v.length>3||v.length===1)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];if(v.length<=3){if(A=this.parent.getValueFromArg(v[0]),this.parent.getErrorStrings().indexOf(A)>-1)return A;if(A===this.parent.trueValue||this.parent.parseFloat(A)>0||this.parent.parseFloat(A)<0)I=this.parent.getValueFromArg(v[1]);else if(A===this.parent.falseValue||this.parent.parseFloat(A)===0){if((0,P.le)(v[2]))return this.parent.falseValue;I=this.parent.getValueFromArg(v[2])}else return this.parent.formulaErrorStrings[Y.requires_3_args]}return!y&&I.indexOf(this.parent.tic)>-1?I.split(this.parent.tic).join(""):I},S.prototype.ComputeIFERROR=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];var v=m,y;return v.length!==2?this.parent.formulaErrorStrings[Y.wrong_number_arguments]:(y=this.parent.getValueFromArg(v[0]),y===this.parent.trueValue||y===this.parent.falseValue?y:(y[0]===this.parent.arithMarker&&(y=y.replace(this.parent.arithMarker," ")),y=this.parent.getValueFromArg(y).toUpperCase().split(this.parent.tic).join(""),y[0]==="#"||y.indexOf("Infinity")>-1||this.parent.getErrorStrings().indexOf(y)>-1?this.parent.getValueFromArg(v[1]).split(this.parent.tic).join(""):y))},S.prototype.ComputePRODUCT=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];var v=1,y,A,I=!0,N;if(!(0,P.le)(m))for(var z=m,V=0;V<z.length;V++){var _=z[V];if(_.indexOf(":")>-1&&this.parent.isCellReference(_))for(var G=this.parent.getCellCollection(_),K=0;K<G.length;K++){if(y=this.parent.getValueFromArg(G[K].split(this.parent.tic).join("")),this.parent.getErrorStrings().indexOf(y)>-1)return y;y=y.split(this.parent.tic).join("")==="TRUE"?"1":y.split(this.parent.tic).join("")==="FALSE"?"0":y,N=this.parent.parseFloat(y),isNaN(N)||y.length>0&&(v=v*N,I=!1)}else if(A=this.parent.getValueFromArg(z[V].split(this.parent.tic).join("")),this.parent.getErrorStrings().indexOf(A)>-1||(A=A.split(this.parent.tic).join("")==="TRUE"?"1":A.split(this.parent.tic).join("")==="FALSE"?"0":A,N=this.parent.parseFloat(A),isNaN(N)||A.length>0&&(v=v*N,I=!1),this.parent.getErrorStrings().indexOf(A)>-1))return A}return I?"0":v.toString()},S.prototype.ComputeDAYS=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;if((0,P.le)(m)&&m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];if(m.length!==2)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var y=m;y[0].split(this.parent.tic).join("")===this.parent.trueValue&&(y[0]="1"),y[0].split(this.parent.tic).join("")===this.parent.falseValue&&(y[0]="0");var A=this.parent.getValueFromArg(y[0].split(this.parent.tic).join("")),I=this.parent.getValueFromArg(y[1].split(this.parent.tic).join(""));if(I=I===""||I==null?new Date(Date.parse("1899-12-31")).toDateString():I,A=A===""||A==null?new Date(Date.parse("1899-12-31")).toDateString():A,A[0]==="#")return A;if(I[0]==="#")return I;var N=this.parent.intToDate(A),z=this.parent.intToDate(I);if(N.toString()[0]==="#")return N.toString();if(z.toString()[0]==="#")return z.toString();if(Object.prototype.toString.call(N)==="[object Date]"&&Object.prototype.toString.call(z)==="[object Date]")v=Math.ceil(N.getTime()-z.getTime())/(1e3*3600*24);else return this.parent.getErrorStrings()[F.value];return Math.round(v)},S.prototype.ComputeUNIQUE=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y;if((0,P.le)(m)||m[0]===""||v.length>3)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var A=v[1]?v[1].toUpperCase():"FALSE",I=v[2]?v[2].toUpperCase():"FALSE",N=[],z=this.parent.actCell;if(v[0].indexOf(":")>-1){if((0,P.le)(v[0].match(/[0-9]/))){var V=v[0].split(":");v[0]=V[0]+"1:"+V[1]+(this.parent.spreadSheetUsedRange[0]+1)}else if((0,P.le)(v[0].toUpperCase().match(/[A-Z]/))){var V=v[0].split(":");v[0]="A"+V[0]+":"+b(this.parent.spreadSheetUsedRange[1]+1)+V[1]}var _=v[0].split(":");if(this.parent.isCellReference(_[0])&&this.parent.isCellReference(_[1])){for(var G=this.parent.dependencyCollection,K=0;K<G.length;K++)G[K].split(":")[0]===v[0].split(":")[0]&&this.clearDependency(G[K]);this.parent.dependencyCollection.indexOf(v[0])===-1?this.parent.dependencyCollection.push(v[0]):this.clearDependency(v[0]);var oe=v[0].indexOf(":"),he=void 0,ue=this.parent.rowIndex(this.parent.substring(v[0],0,oe)),X=this.parent.colIndex(this.parent.substring(v[0],0,oe)),Ce=this.parent.rowIndex(this.parent.substring(v[0],oe+1,oe+v[0].length-oe-1)),ze=this.parent.colIndex(this.parent.substring(v[0],oe+1,oe+v[0].length-oe-1));ue>Ce&&(he=Ce,Ce=ue,ue=he),X>ze&&(he=ze,ze=X,X=he);var We="";v[0].indexOf("!")===0&&(We=v[0].substring(0,v[0].replace("!","").indexOf("!")+2)),v[0]=We+b(X)+ue+":"+b(ze)+Ce;for(var Xe=this.parent.getCellCollection(v[0]),tt=ze-X,pt=[],K=0;K<Xe.length;K++)pt.push(Xe[K]);if(A==="FALSE")if(tt===0)for(var K=0;K<pt.length;K++){var st=this.parent.getValueFromArg(pt[K]);st=st===""?"0":st,N.push(st)}else for(var ht="",rt=tt,K=0;K<pt.length;K++){if(K===pt.length-1){var st=this.parent.getValueFromArg(pt[K]);st=st===""?"0":st,ht=ht+st+"+",N.push(ht.substring(0,ht.length-1))}if(K<=rt){var st=this.parent.getValueFromArg(pt[K]);st=st===""?"0":st,ht=ht+st+"+"}else{N.push(ht.substring(0,ht.length-1)),rt=tt+K;var st=this.parent.getValueFromArg(pt[K]);st=st===""?"0":st,ht=st+"+"}}else for(var ht="",rt=tt+1,Et=Ce-ue,K=0;K<rt;K++){for(var Vt=0;Vt<=Et;Vt++){var st=this.parent.getValueFromArg(pt[Vt*rt+K]);st=st===""?"0":st,ht=ht+st+"+"}N.push(ht.substring(0,ht.length-1)),ht=""}for(var ce=[],ee=[],K=0;K<N.length;K++)ce.indexOf(N[K])===-1?ce.push(N[K]):ee.push(N[K]);if(I==="TRUE"){for(var Ne=[],K=0;K<ce.length;K++)ee.indexOf(ce[K])===-1&&Ne.push(ce[K]);ce=Ne}z=z.indexOf("!")>-1?z.split("!")[1]:z;var Te=this.parent.rowIndex(z),we=this.parent.colIndex(z);if(this.parent.dependencyLevel===0){var ct=!1;if(A==="FALSE")for(var K=Te,rt=ce.length+Te;K<rt;K++)for(var Lt=ce[0].split("+"),vt=we,Oe=Lt.length+we;vt<Oe;vt++)K===rt-1&&vt===Oe-1&&this.parent.uniqueRange.indexOf(this.parent.actCell+":"+b(vt)+K)===-1&&this.parent.uniqueRange.push(this.parent.actCell+":"+b(vt)+K),this.checkSpill(vt,K)&&(ct=!0);else for(var K=we,rt=ce.length+we;K<rt;K++)for(var Lt=ce[0].split("+"),gi=Te,Oe=Lt.length+Te;gi<Oe;gi++)K===rt-1&&gi===Oe-1&&this.parent.uniqueRange.indexOf(this.parent.actCell+":"+b(K)+gi)===-1&&this.parent.uniqueRange.push(this.parent.actCell+":"+b(K)+gi),this.checkSpill(K,gi)&&(ct=!0);if(ct)return this.parent.formulaErrorStrings[Y.spill]}else if(this.parent.dependencyLevel>0&&this.parent.getValueFromArg(b(we)+Te,!0).indexOf("#SPILL!")>-1)return this.parent.formulaErrorStrings[Y.spill];if(A==="FALSE"){var Ke=this.parent.getSheetFamilyItem(this.parent.grid),ot="",He=void 0;Ke.sheetNameToParentObject!==null&&Ke.sheetNameToParentObject.size>0&&(ot=Ke.parentObjectToToken.get(this.parent.grid),He=ot+z);for(var K=0;K<ce.length;K++){var Lt=ce[K].split("+");K>0&&(Te++,we=this.parent.colIndex(z));for(var Ci=0;Ci<Lt.length;Ci++)this.setValueRefresh(Lt[Ci],Te,we,z),(K>0||Ci>0)&&this.parent.refresh(ot+b(we)+Te.toString(),He),Lt[Ci+1]&&we++}y=ce[0].split("+")[0]}else{for(var K=0;K<ce.length;K++)for(var Lt=ce[K].split("+"),pe=0;pe<Lt.length;pe++)this.setValueRefresh(Lt[pe],Te,we,z),Lt[pe+1]?Te++:(we++,Te=this.parent.rowIndex(z));y=ce[0].split("+")[0]}}}else this.parent.isCellReference(v[0])&&(this.parent.dependencyCollection.indexOf(v[0])===-1?this.parent.dependencyCollection.push(v[0]):this.clearDependency(v[0]),y=this.parent.getValueFromArg(v[0]));return y},S.prototype.setValueRefresh=function(m,x,v,y){this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid)+1,m,x,v)},S.prototype.checkSpill=function(m,x){var v=!1,y=this.parent.getValueFromArg(b(m)+x,!0),A="!"+this.parent.getSheetID(this.parent.grid)+"!"+b(m)+x,I;return this.parent.getFormulaInfoTable().get(A)&&(I=this.parent.getFormulaInfoTable().get(A).formulaText),y&&(y.indexOf("UNIQUE")<0||I&&!I.toUpperCase().includes("UNIQUE"))&&y!==this.parent.formulaErrorStrings[Y.wrong_number_arguments]&&(v=!0),v},S.prototype.clearDependency=function(m){var x=this.parent.actCell;x=x.indexOf("!")>-1?x.split("!")[1]:x;for(var v=this.parent.rowIndex(x),y=this.parent.colIndex(x),A=m.indexOf(":"),I=this.parent.rowIndex(this.parent.substring(m,0,A)),N=this.parent.colIndex(this.parent.substring(m,0,A)),z=this.parent.rowIndex(this.parent.substring(m,A+1,A+m.length-A-1)),V=this.parent.colIndex(this.parent.substring(m,A+1,A+m.length-A-1)),_=z-I+v,G=V-N+y,K=this.parent.getFormulaInfoTable().get("!"+this.parent.getSheetID(this.parent.grid)+"!"+x)?this.parent.getFormulaInfoTable().get("!"+this.parent.getSheetID(this.parent.grid)+"!"+x).getFormulaText():"",oe=v;oe<=_;oe++)for(var he=y;he<=G;he++)if(this.parent.dependencyLevel>0||K.indexOf("UNIQUE")>-1){if(this.parent.getValueFromArg("!"+this.parent.getSheetID(this.parent.grid)+"!"+b(y)+v,!0).indexOf("#SPILL!")>-1)return;this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid)+1,"",oe,he),this.parent.refresh("!"+this.parent.getSheetID(this.parent.grid)+"!"+b(he)+oe,x),this.parent.actCell=x}},S.prototype.ComputeT=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v="";if((0,P.le)(m)||m.length!==1||m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];var y=m[0];y=y.indexOf(":")>-1?y.split(":")[0]:y,y=this.parent.getValueFromArg(y);var A=/^[0-9.]+$/;return y.match(A)===null&&y.toUpperCase()!=="TRUE"&&y.toUpperCase()!=="FALSE"&&(v=y),v},S.prototype.ComputeHOUR=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if(m.length!==1||(0,P.le)(m))return this.parent.formulaErrorStrings[Y.invalid_arguments];if(m[0]==="")return this.parent.getErrorStrings()[F.value];if(!this.parent.isCellReference(m[0])&&m[0].indexOf(this.parent.tic)===-1)return this.parent.getErrorStrings()[F.value];var v=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join("");v=this.parent.intToTime(v);var y=new Date(Date.parse(v)),A=parseInt(v,10);if(A<0)return this.parent.getErrorStrings()[F.num];if(y.toString()==="Invalid Date"){var I=new Date(Date.now()).toLocaleDateString()+" "+v;y=new Date(Date.parse(I))}return y.toString()==="Invalid Date"&&(y=this.parent.fromOADate(parseInt(v,10))),y.toString()==="Invalid Date"?this.parent.getErrorStrings()[F.value]:y.getHours()},S.prototype.ComputeMINUTE=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if(m.length!==1||(0,P.le)(m))return this.parent.formulaErrorStrings[Y.invalid_arguments];if(m[0]==="")return this.parent.getErrorStrings()[F.value];if(!this.parent.isCellReference(m[0])&&m[0].indexOf(this.parent.tic)===-1)return this.parent.getErrorStrings()[F.value];var v=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join("");v=this.parent.intToTime(v);var y=new Date(Date.parse(v)),A=parseInt(v,10);if(A<0)return this.parent.getErrorStrings()[F.num];if(y.toString()==="Invalid Date"){var I=new Date(Date.now()).toLocaleDateString()+" "+v;y=new Date(Date.parse(I))}return y.toString()==="Invalid Date"&&(y=this.parent.fromOADate(parseInt(v,10))),y.toString()==="Invalid Date"?this.parent.getErrorStrings()[F.value]:y.getMinutes()},S.prototype.ComputeSECOND=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if(m.length!==1||(0,P.le)(m))return this.parent.formulaErrorStrings[Y.invalid_arguments];if(!this.parent.isCellReference(m[0])&&m[0].indexOf(this.parent.tic)===-1)return this.parent.getErrorStrings()[F.value];if(m[0]==="")return this.parent.getErrorStrings()[F.value];var v=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join("");v=this.parent.intToTime(v);var y=new Date(Date.parse(v)),A=parseInt(v,10);if(A<0)return this.parent.getErrorStrings()[F.num];if(y.toString()==="Invalid Date"){var I=new Date(Date.now()).toLocaleDateString()+" "+v;y=new Date(Date.parse(I))}return y.toString()==="Invalid Date"&&(y=this.parent.fromOADate(parseInt(v,10))),y.toString()==="Invalid Date"?this.parent.getErrorStrings()[F.value]:y.getSeconds()},S.prototype.ComputeMONTH=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if(m[0]==="")return this.parent.getErrorStrings()[F.value];if(m.length!==1||(0,P.le)(m))return this.parent.formulaErrorStrings[Y.invalid_arguments];if(!this.parent.isCellReference(m[0])&&m[0].indexOf(this.parent.tic)===-1)return this.parent.getErrorStrings()[F.value];var v=this.spreadsheetFormat(m[0]),y=this.spreadsheetDisplayText(m[0]),A=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join(""),I=this.parseDouble(A),N=0,z=new Date(Date.parse(A));!isNaN(I)&&z.getFullYear()>9999&&(z=this.parent.fromOADate(I));var V=parseInt(A,10);return V<0?this.parent.getErrorStrings()[F.num]:(V===0&&A!==v&&v.indexOf("h:mm")>-1&&(z=this.parent.fromOADate(parseInt(y,10))),z.toString()==="Invalid Date"&&(z=this.parent.fromOADate(parseInt(A,10))),z.toString()==="Invalid Date"?this.parent.getErrorStrings()[F.value]:(z.toString()!=="Invalid Date"&&(N=z.getMonth()+1),N.toString()))},S.prototype.ComputeNOW=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if(m.length!==1||m[0]!=="")return this.parent.formulaErrorStrings[Y.invalid_arguments];var v=new Date(Date.now()),y=new P.eC,A=y.getDateFormat({format:"M/d/yyyy h:mm a"});return A(v)},S.prototype.ComputeEXACT=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=!1;if((0,P.le)(m)||m.length!==2)return this.parent.formulaErrorStrings[Y.invalid_arguments];var y=this.parent.getValueFromArg(m[1]).split(this.parent.tic).join(""),A=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join("");return A===y&&(v=!0),v},S.prototype.ComputeLEN=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length!==1)return this.parent.formulaErrorStrings[Y.invalid_arguments];if(m[0]==="")return this.parent.getErrorStrings()[F.value];var v=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join("");return v==="#NAME?"?this.parent.getErrorStrings()[F.name]:v.length},S.prototype.ComputeMOD=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length!==2)return this.parent.formulaErrorStrings[Y.invalid_arguments];var v=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join(""),y=this.parent.getValueFromArg(m[1]).split(this.parent.tic).join("");if(y===""||y==="0")return this.parent.formulaErrorStrings[Y.div];if(v===""||v==="0")return"0";if(v==="#NAME?"||y==="#NAME?")return this.parent.getErrorStrings()[F.name];if(v.toUpperCase().match(/[A-Z]/)||y.toUpperCase().match(/[A-Z]/))return this.parent.getErrorStrings()[F.value];var A=parseFloat(v.replace("-",""))%parseFloat(y);return parseFloat(y)<0&&(A=A*-1),isNaN(A)?this.parent.getErrorStrings()[F.name]:A},S.prototype.ComputeODD=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if(m[0]==="")return this.parent.getErrorStrings()[F.value];if((0,P.le)(m)||m.length!==1)return this.parent.formulaErrorStrings[Y.invalid_arguments];var v=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join("");if(v==="#NAME?")return this.parent.getErrorStrings()[F.name];if(v==="")v="0";else if(v.toUpperCase().match(/[A-Z]/))return this.parent.getErrorStrings()[F.value];var y=Math.ceil(parseInt(v,10)),A=y===0;return y=y%2==0?y>0?y+1:y-1:y,Math.ceil(parseInt(v,10))%2!=0&&(parseInt(v,10)>0&&parseFloat(v)>parseInt(v,10)?y=y+2:parseInt(v,10)<0&&parseFloat(v)<parseInt(v,10)&&(y=y-2)),isNaN(y)?this.parent.getErrorStrings()[F.name]:A?1:y},S.prototype.ComputeEVEN=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length!==1)return this.parent.formulaErrorStrings[Y.invalid_arguments];if(m[0]==="")return this.parent.getErrorStrings()[F.value];var v=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join("");if(v==="#NAME?")return this.parent.getErrorStrings()[F.name];if(v==="")v="0";else if(v.toUpperCase().match(/[A-Z]/))return this.parent.getErrorStrings()[F.value];var y=Math.ceil(parseFloat(v));return y=y%2==0?y:y>0?y+1:y-1,Math.ceil(parseFloat(v))%2==0&&(parseInt(v,10)>0&&parseFloat(v)>parseInt(v,10)?y=y+2:parseInt(v,10)<0&&parseFloat(v)<parseInt(v,10)&&(y=y-2)),isNaN(y)?this.parent.getErrorStrings()[F.name]:y},S.prototype.ComputePI=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;return m&&m[0]!==""?v=this.parent.formulaErrorStrings[Y.invalid_arguments]:v=Math.PI,v},S.prototype.ComputeMEDIAN=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;if((0,P.le)(m)||m[0]===""||m.length!==1)return this.parent.formulaErrorStrings[Y.invalid_arguments];for(var y=this.parent.getCellCollection(m[0]),A=[],I=0;I<y.length;I++)A.push(parseInt(this.parent.getValueFromArg(y[I]).split(this.parent.tic).join(""),10));A=A.sort(function(V,_){return V-_});for(var N=A.length,z=0;z<N&&!(isNaN(A[z])&&(A.splice(z,1),z--,A.length===0));z++);if(A.length%2!=0&&A[parseInt((A.length/2).toString(),10)])v=A[parseInt((A.length/2).toString(),10)];else if(!isNaN(A[A.length/2])&&!isNaN(A[A.length/2-1]))v=(A[A.length/2]+A[A.length/2-1])/2;else return this.parent.getErrorStrings()[F.num];return v},S.prototype.ComputeEDATE=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v,y;if(m.length!==2||(0,P.le)(m))return this.parent.formulaErrorStrings[Y.invalid_arguments];if(m[0]==="")return this.parent.getErrorStrings()[F.value];var A=this.parent.getValueFromArg(m[0]);return y=this.parent.getValueFromArg(m[1]),y=parseInt(y,10),isNaN(y)?this.parent.getErrorStrings()[F.num]:(v=isNaN(parseInt(A,10))?new Date(Date.parse(A)):this.parent.fromOADate(parseInt(A,10)),(0,P.le)(this.parent.isDate(v))?this.parent.getErrorStrings()[F.value]:new Date(v.setMonth(v.getMonth()+y)).toLocaleDateString())},S.prototype.ComputeDATEVALUE=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v,y;return m.length!==1||(0,P.le)(m)?this.parent.formulaErrorStrings[Y.invalid_arguments]:m[0]===""||this.parent.isCellReference(m[0])?this.parent.getErrorStrings()[F.value]:m[0].indexOf(this.parent.tic)===-1?this.parent.getErrorStrings()[F.value]:(y=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join(""),v=isNaN(parseInt(y,10))?new Date(Date.parse(y)):this.parent.fromOADate(parseInt(y,10)),(0,P.le)(this.parent.isDate(v))||parseInt(y,10).toString().length!==5?this.parent.getErrorStrings()[F.value]:this.parent.isDate(y)&&this.parent.isDate(y).getFullYear().toString().length!==4?this.parent.getErrorStrings()[F.value]:parseFloat(y).toFixed(0).toString())},S.prototype.ComputeCOUNTBLANK=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=0;if(m.length!==1||(0,P.le)(m)||!this.parent.isCellReference(m[0]))return this.parent.formulaErrorStrings[Y.invalid_arguments];if(m[0]==="")return this.parent.getErrorStrings()[F.value];for(var y=this.parent.getCellCollection(m[0]),A=0;A<y.length;A++)this.parent.getValueFromArg(y[A])===""&&v++;return v},S.prototype.ComputeFACT=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=1;if((0,P.le)(m)||m.length!==1)return this.parent.formulaErrorStrings[Y.invalid_arguments];if(m[0]==="")return this.parent.getErrorStrings()[F.value];var y=parseInt(this.parent.getValueFromArg(m[0]).split(this.parent.tic).join(""),10);if(this.parent.getValueFromArg(m[0]).split(this.parent.tic).join("").toUpperCase().match(/[A-Z]/))return this.parent.getErrorStrings()[F.value];if(y<0)return this.parent.getErrorStrings()[F.num];for(var A=1;A<=y;A++)v=v*A;return v},S.prototype.ComputeDECIMAL=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;if((0,P.le)(m)||m.length!==2)return this.parent.formulaErrorStrings[Y.invalid_arguments];var y=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join(""),A=this.parent.getValueFromArg(m[1]).split(this.parent.tic).join("");return y===""&&A!==""?0:y!==""&&A===""?this.parent.getErrorStrings()[F.value]:isNaN(parseInt(A,10))?this.parent.getErrorStrings()[F.value]:(v=parseInt(y,parseInt(A,10)),isNaN(v)?this.parent.getErrorStrings()[F.name]:v)},S.prototype.ComputeDEGREES=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;if((0,P.le)(m)||m.length!==1||m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];var y=Math.PI,A=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join("");return A.toUpperCase().match(/[A-Z]/)?this.parent.getErrorStrings()[F.value]:isNaN(parseInt(A,10))?this.parent.getErrorStrings()[F.value]:(v=parseFloat(A)*(180/y),parseInt(v.toString(),10))},S.prototype.ComputeADDRESS=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;if((0,P.le)(m)||m.length>5||m[0]===""||m[1]===""||m.length<2)return this.parent.formulaErrorStrings[Y.invalid_arguments];m[2]=m[2]?m[2]:"1",m[3]=m[3]?m[3]:"TRUE";var y=this.parent.getValueFromArg(m[0]),A=this.parent.getValueFromArg(m[1]),I=this.parent.getValueFromArg(m[2]),N=this.parent.getValueFromArg(m[3]);if(I=I.split(this.parent.tic).join(""),N=N.split(this.parent.tic).join(""),y=y.split(this.parent.tic).join(""),A=A.split(this.parent.tic).join(""),parseInt(y,10)<=0||parseInt(A,10)<=0)return this.parent.getErrorStrings()[F.value];if(y.toUpperCase().match(/[A-Z]/)||A.toUpperCase().match(/[A-Z]/)||I.toUpperCase().match(/[A-Z]/))return this.parent.getErrorStrings()[F.value];N==="TRUE"||N==="1"?I==="1"?v="$"+b(parseInt(A,10))+"$"+parseInt(y,10):I==="2"?v=b(parseInt(A,10))+"$"+parseInt(y,10):I==="3"?v="$"+b(parseInt(A,10))+parseInt(y,10):I==="4"&&(v=b(parseInt(A,10))+parseInt(y,10)):(N==="FALSE"||N==="0")&&(I==="1"?v="R"+parseInt(y,10)+"C"+parseInt(A,10):I==="2"?v="R"+parseInt(y,10)+"C["+parseInt(A,10)+"]":I==="3"?v="R["+parseInt(y,10)+"]C"+parseInt(A,10):I==="4"&&(v="R["+parseInt(y,10)+"]C["+parseInt(A,10)+"]"));var z=["TRUE","FALSE","1","0"];if(z.indexOf(N)===-1)return this.parent.getErrorStrings()[F.name];if(!(0,P.le)(m[4])&&m[4]!==""){var V=this.parent.getValueFromArg(m[4]).split(this.parent.tic).join("");if(V==="#NAME?")return this.parent.getErrorStrings()[F.name];v=V+"!"+v}return v},S.prototype.ComputeTIME=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length!==3||m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];var v=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join(""),y=this.parent.getValueFromArg(m[1]).split(this.parent.tic).join(""),A=this.parent.getValueFromArg(m[2]).split(this.parent.tic).join("");if(v==="#NAME?"||y==="#NAME?"||A==="#NAME?")return this.parent.getErrorStrings()[F.name];if(v=parseInt(v,10),y=parseInt(y,10),A=parseInt(A,10),isNaN(v)||isNaN(y)||isNaN(A))return this.parent.getErrorStrings()[F.name];if(v.toString().toUpperCase().match(/[A-Z]/)||y.toString().toUpperCase().match(/[A-Z]/)||A.toString().toUpperCase().match(/[A-Z]/))return this.parent.getErrorStrings()[F.value];if(v>32767||y>32767||A>32767)return this.parent.getErrorStrings()[F.num];var I=new Date(1900,0,1,v,y,A),N=I.getHours(),z=I.getMinutes(),V="AM",_=N;return _>=12&&(_=N-12,V="PM"),_===0&&(_=12),z=z<10?"0"+z:z,_=_<10?"0"+_:_,_+":"+z+" "+V},S.prototype.ComputeCHAR=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;if((0,P.le)(m)||m.length!==1||m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];var y=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join("");if(y==="#NAME?")return this.parent.getErrorStrings()[F.name];if(y.toUpperCase().match(/^[0-9]+$/)){var A=parseInt(y,10);if(A>255||A<=0)return this.parent.getErrorStrings()[F.value];v=String.fromCharCode(A)}else return this.parent.getErrorStrings()[F.value];return v},S.prototype.ComputeCODE=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;if((0,P.le)(m)||m.length!==1||m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];var y=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join("");if(y==="#NAME?")return this.parent.getErrorStrings()[F.name];if(y!=="")v=y.charCodeAt(0);else return this.parent.getErrorStrings()[F.value];return v},S.prototype.ComputeDOLLAR=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;if(m.length===1&&m.push("2"),(0,P.le)(m)||m.length!==2||m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];var y=this.parent.getValueFromArg(m[0]).split(this.parent.tic).join(""),A=this.parent.getValueFromArg(m[1]).split(this.parent.tic).join("");if(y=y===""?"0":y,A=A===""?"0":A,y==="#NAME?")return this.parent.getErrorStrings()[F.name];if(y.toUpperCase().match(/^[0-9.]+$/)&&A.toUpperCase().match(/^[0-9.]+$/)){for(var I=new P.eC,N=parseInt(A,10),z="",V=1;V<=N;V++)z+="0";v=I.formatNumber(parseFloat(parseFloat(y).toFixed(parseInt(A,10))),{format:"$#,##."+z})}else return this.parent.getErrorStrings()[F.value];return v},S.prototype.ComputeSMALL=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;if((0,P.le)(m)||m[0]===""||m.length!==2)return this.parent.formulaErrorStrings[Y.invalid_arguments];for(var y=this.parent.getCellCollection(m[0]),A=[],I=0;I<y.length;I++)A.push(parseFloat(this.parent.getValueFromArg(y[I]).split(this.parent.tic).join("")));A=A.sort(function(_,G){return _-G});for(var N=A.length,z=0;z<N&&!(isNaN(A[z])&&(A.splice(z,1),z--,A.length===0));z++);var V=this.parent.getValueFromArg(m[1]).split(this.parent.tic).join("");if(V==="#NAME?")return this.parent.getErrorStrings()[F.name];if(V=parseInt(V,10),V.toString().toUpperCase().match(/^[0-9]+$/)&&A[V-1]&&A[V-1].toString().toUpperCase().match(/^[-.0-9]+$/)&&V!==0)v=A[V-1];else return(0,P.le)(A[V-1])?this.parent.getErrorStrings()[F.num]:this.parent.getErrorStrings()[F.value];return v},S.prototype.ComputeLARGE=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v;if((0,P.le)(m)||m.length!==2||m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];for(var y=this.parent.getCellCollection(m[0]),A=[],I=0;I<y.length;I++)A.push(parseFloat(this.parent.getValueFromArg(y[I]).split(this.parent.tic).join("")));A=A.sort(function(_,G){return G-_});for(var N=A.length,z=0;z<N&&!(isNaN(A[z])&&(A.splice(z,1),z--,A.length===0));z++);var V=this.parent.getValueFromArg(m[1]).split(this.parent.tic).join("");if(V==="#NAME?")return this.parent.getErrorStrings()[F.name];if(V=parseInt(V,10),V.toString().toUpperCase().match(/^[0-9]+$/)&&A[V-1]&&A[V-1].toString().toUpperCase().match(/^[-.0-9]+$/)&&V!==0)v=A[V-1];else return(0,P.le)(A[V-1])?this.parent.getErrorStrings()[F.num]:this.parent.getErrorStrings()[F.value];return v},S.prototype.ComputeCHOOSE=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];if(m.length<2)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var v=m;if(v[0].indexOf(":")>-1&&this.parent.isCellReference(v[0])){var y=this.parent.getCellCollection(v[0]);if(y.length===1)v[0]=y[0];else return this.parent.getErrorStrings()[F.value]}var A=this.parent.getValueFromArg(v[0]);if(this.parent.getErrorStrings().indexOf(A)>-1)return A;var I=this.parent.parseFloat(this.parent.getValueFromArg(v[0].split(this.parent.tic).join("")));if(I<1)return this.parent.getErrorStrings()[F.value];I=Math.floor(I);var N;if((0,P.le)(v[I]))return this.parent.getErrorStrings()[F.value];if(N=v[I],N===""&&(N="0"),N.indexOf(":")>-1&&this.parent.isCellReference(N)){var y=this.parent.getCellCollection(v[0].split(this.parent.tic).join(""));if(y.length===1)v[0]=y[0];else return this.parent.getErrorStrings()[F.value]}return this.parent.getValueFromArg(N).split(this.parent.tic).join("")},S.prototype.ComputeSUMIF=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m;if(v[0].indexOf(":")<0&&!this.parent.isCellReference(v[0])||v[2]&&v[2].indexOf(":")<0&&!this.parent.isCellReference(v[2]))return this.parent.formulaErrorStrings[Y.improper_formula];if(v.length>3||v.length<2)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var y=this.parent.computeSumIfAndAvgIf(m);return typeof y=="string"&&(this.parent.formulaErrorStrings.indexOf(y)||this.parent.getErrorStrings().indexOf(y))?y:y[0]},S.prototype.ComputeABS=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y="",A;if(m.length===0||m.length>1)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];if(v[0].toString().split(this.parent.tic).join("").trim()===""||v[0].indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[F.value];if(this.parent.isCellReference(v[0])){if(y=this.parent.getValueFromArg(v[0]),y==="")return this.parent.getErrorStrings()[F.name];if(A=this.parent.parseFloat(y),isNaN(A))return this.parent.getErrorStrings()[F.value]}else if(A=this.parent.parseFloat(v[0]),isNaN(A))return this.parent.getErrorStrings()[F.name];return Math.abs(A)},S.prototype.ComputeAVERAGE=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];for(var v=m,y=0;y<v.length;y++)if(v[y].indexOf(":")>-1&&v[y].indexOf(this.parent.tic)>-1)return this.parent.getErrorStrings()[F.value];return this.parent.calculateAvg(v)},S.prototype.ComputeAVERAGEIF=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m;if(v[0].indexOf(":")<0&&!this.parent.isCellReference(v[0]))return this.parent.formulaErrorStrings[Y.improper_formula];var y=this.parent.computeSumIfAndAvgIf(m);return typeof y=="string"&&(this.parent.formulaErrorStrings.indexOf(y)||this.parent.getErrorStrings().indexOf(y))?y:this.parent.parseFloat(y[0])/this.parent.parseFloat(y[1])},S.prototype.ComputeCONCATENATE=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.invalid_arguments];for(var v=m,y="",A="",I=0;I<v.length;I++){if(v[I].indexOf(":")>-1&&this.parent.isCellReference(v[I]))if(this.isConcat)for(var N=this.parent.getCellCollection(v[I]),z=0;z<N.length;z++)A=this.parent.getValueFromArg(N[z]),y=y+A;else return this.parent.getErrorStrings()[F.value];else{if(v.length===1&&v[0].indexOf(this.parent.tic)<0)return this.parent.getErrorStrings()[F.name];A=this.parent.getValueFromArg(v[I]),y=y+A}if(this.parent.getErrorStrings().indexOf(A)>-1)return A}return y.split(this.parent.tic).join("")},S.prototype.ComputeCONCAT=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];return this.isConcat=!0,this.ComputeCONCATENATE.apply(this,m)},S.prototype.ComputeMAX=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];return this.parent.computeMinMax(m,"max")},S.prototype.ComputeMIN=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];return this.parent.computeMinMax(m,"min")},S.prototype.ComputeRAND=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];return m.length===1&&m[0]===""&&(m.length=0),m.length>0?this.parent.formulaErrorStrings[Y.wrong_number_arguments]:Math.random().toString()},S.prototype.ComputeAND=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];return this.parent.computeAndOr(m,"and")},S.prototype.ComputeOR=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];return this.parent.computeAndOr(m,"or")},S.prototype.ComputeFIND=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var v=m;if(v.length>3)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var y=this.parent.removeTics(this.parent.getValueFromArg(v[0])),A=this.parent.removeTics(this.parent.getValueFromArg(v[1]));if(this.parent.getErrorStrings().indexOf(y)>-1||this.parent.getErrorStrings().indexOf(A)>-1)return this.parent.getErrorStrings()[F.name];var I=1;if(v.length===3){if(I=this.parent.removeTics(this.parent.getValueFromArg(v[2])),this.parent.getErrorStrings().indexOf(I)>-1)return I;I=this.parent.parseFloat(I),isNaN(I)&&(I=1)}if(I<=0||I>A.length)return this.parent.getErrorStrings()[F.value];var N=A.indexOf(y,I-1);return N<0?this.parent.getErrorStrings()[F.value]:(Number(N)+Number(1)).toString()},S.prototype.ComputeINDEX=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y=v.length;if((0,P.le)(m)||v.length===1&&v[0]==="")return this.parent.formulaErrorStrings[Y.wrong_number_arguments];if(y>3)return this.parent.getErrorStrings()[F.ref];var A="",I=[];if(y>2)for(var N=0;N<y;N++){if(this.parent.isCellReference(v[N])&&v[N].indexOf(":")<0)return this.parent.getErrorStrings()[F.ref];this.parent.isCellReference(v[N])&&(I[N]=v[N])}if(A=v[0],v[1]=v[1]===""?"1":v[1],v[1]=this.parent.getValueFromArg(v[1]),this.parent.getErrorStrings().indexOf(v[1])>-1)return v[1];if(!(0,P.le)(v[2])){if(v[2]=v[2]===""?"1":v[2],v[2]=this.parent.getValueFromArg(v[2]),this.parent.getErrorStrings().indexOf(v[2])>-1)return v[2];if(v[2]==="0")return this.parent.getErrorStrings()[F.value]}var z=parseFloat(v[1]);z=isNaN(z)?-1:z;var V=parseFloat(v[2]?v[2]:"1");if(V=isNaN(V)?-1:V,z===-1||V===-1)return this.parent.getErrorStrings()[F.value];var _=v[0].indexOf(":"),G=this.parent.rowIndex(A.substring(0,_)),K=this.parent.rowIndex(A.substring(_+1)),oe=this.parent.colIndex(A.substring(0,_)),he=this.parent.colIndex(A.substring(_+1));if(z>K-G+1||V>he-oe+1)return this.parent.getErrorStrings()[F.ref];z=G+z-1,V=oe+V-1;var ue=this.getSheetReference(A)+this.parent.convertAlpha(V)+z,X=this.parent.getValueFromArg(ue);return X===""?0:X},S.prototype.getSheetReference=function(m){return m.indexOf(this.parent.sheetToken)===0&&m.lastIndexOf(this.parent.sheetToken)>m.indexOf(this.parent.sheetToken)?m.substring(0,m.lastIndexOf(this.parent.sheetToken)+1):""},S.prototype.ComputeIFS=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m;if((0,P.le)(m)||v.length===1&&v[0]==="")return this.parent.formulaErrorStrings[Y.wrong_number_arguments];for(var y="",A="",I=0;I<v.length;I++){if(y=this.parent.getValueFromArg(v[I]),y!==this.parent.trueValue&&y!==this.parent.falseValue)return this.parent.getErrorStrings()[F.value];if(y===this.parent.trueValue)return v[I+1].indexOf(this.parent.arithMarker)>-1?this.parent.trueValue:(this.parent.isCellReference(v[I+1].split(this.parent.tic).join(""))?A=this.parent.getValueFromArg(v[I+1]):A=v[I+1].indexOf(this.parent.tic)>-1?v[I+1].split(this.parent.tic).join(""):this.parent.getErrorStrings()[F.name],I=I+1,A);y===this.parent.falseValue&&(I=I+1)}return this.parent.getErrorStrings()[F.na]},S.prototype.ComputeCOUNTA=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.wrong_number_arguments];for(var v=m,y,A=0,I,N=0;N<v.length;N++)if(v[N].indexOf(":")>-1&&this.parent.isCellReference(v[N])){y=this.parent.getCellCollection(v[N].split(this.parent.tic).join(""));for(var z=0;z<y.length;z++)I=this.parent.getValueFromArg(y[z]),I.length>0&&A++}else{var V=this.parent.getValueFromArg(v[N].split(this.parent.tic).join(""));V.length>0&&A++}return A},S.prototype.ComputeAVERAGEA=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];if((0,P.le)(m)||m.length===1&&m[0]==="")return this.parent.formulaErrorStrings[Y.wrong_number_arguments];for(var v=m,y,A=0,I,N=0,z,V=0;V<v.length;V++){if(v[V].indexOf(":")>-1&&this.parent.isCellReference(v[V])){y=this.parent.getCellCollection(v[V].split(this.parent.tic).join(""));for(var _=0;_<y.length;_++)if(I=this.parent.getValueFromArg(y[_]),I.toUpperCase()===this.parent.trueValue)I="1";else if(I.toUpperCase()===this.parent.falseValue||I==="")I="0";else{if(this.parent.getErrorStrings().indexOf(I)>-1)return I;I.length>0&&(z=parseFloat(I),I=isNaN(z)?0:z,A=A+I,N=N+1)}N=y.length}else{if(v[V]===this.parent.trueValue&&(v[V]="1"),(v[V]===this.parent.falseValue||v[V]==="")&&(v[V]="0"),I=this.parent.getValueFromArg(v[V].split(this.parent.tic).join("")),this.parent.getErrorStrings().indexOf(I)>-1)return I;I.length>0&&(z=parseFloat(I),I=isNaN(z)?0:z,A=A+I,N=N+1)}if(N===0)return this.parent.getErrorStrings()[F.divzero]}return A/N},S.prototype.ComputeSORT=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y;if((0,P.le)(m)||m[0]===""||v.length>4)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];v[1]=v[1]?v[1]:"1",v[2]=v[2]?v[2]:"1";var A=v[2]==="1"?"Ascending":"Descending";v[3]=v[3]?v[3].toUpperCase():"FALSE",v[0]=v[0].split("$").join("");var I,N=[];if(v[0].indexOf(":")>-1){var z=v[0].split(":");if(this.parent.isCellReference(z[0])&&this.parent.isCellReference(z[1])){var V=v[0].indexOf(":"),_=void 0,G=this.parent.rowIndex(this.parent.substring(v[0],0,V)),K=this.parent.colIndex(this.parent.substring(v[0],0,V)),oe=this.parent.rowIndex(this.parent.substring(v[0],V+1,V+v[0].length-V-1)),he=this.parent.colIndex(this.parent.substring(v[0],V+1,V+v[0].length-V-1));if(G>oe&&(_=oe,oe=G,G=_),K>he&&(_=he,he=K,K=_),v[2]=this.parent.getValueFromArg(v[2]),v[2]!=="1"&&v[2]!=="-1")return this.parent.getErrorStrings()[F.value];if(!isNaN(this.parseDouble(v[1]))&&this.parseDouble(v[1])<1)return this.parent.getErrorStrings()[F.value];if(v[3].toUpperCase()!==this.parent.trueValue&&v[3].toUpperCase()!==this.parent.falseValue)return this.parent.getErrorStrings()[F.value];var ue="";v[0].indexOf("!")===0&&(ue=v[0],ue=ue.replace("!",""),ue=ue.indexOf("!"),ue=v[0].substring(0,ue+2)),v[0]=ue+b(K)+G+":"+b(he)+oe,I=this.parent.getCellCollection(v[0]);for(var X=0;X<I.length;X++)N.push(this.parent.getValueFromArg(I[X]));var Ce=[],ze=he-K+1;if(v[3]==="TRUE")for(var X=0;X<ze;X++)N[X+(this.parseDouble(v[1])-1)*ze]&&Ce.push(isNaN(this.parseDouble(N[X+(this.parseDouble(v[1])-1)*ze]))?N[X+(this.parseDouble(v[1])-1)*ze]:this.parseDouble(N[X+(this.parseDouble(v[1])-1)*ze]));if(v[3]==="FALSE")for(var X=0;X<N.length;X++)N[X*ze+this.parseDouble(v[1])-1]&&Ce.push(isNaN(this.parseDouble(N[X*ze+this.parseDouble(v[1])-1]))?N[X*ze+this.parseDouble(v[1])-1]:this.parseDouble(N[X*ze+this.parseDouble(v[1])-1]));for(var We=Ae.j.sort(Ce,null,Ae.j.fnSort(A)),Xe=[],tt=0;tt<We.length;tt++)for(var pt=0;pt<Ce.length;pt++)JSON.stringify(We[tt])===JSON.stringify(Ce[pt])&&Xe.indexOf(pt)===-1&&Xe.push(pt);if(v[3]==="TRUE"){for(var st=G,ht=0;st<=oe;st++,ht++)for(var tt=0,rt=0;tt<Xe.length;tt++,rt++){var Et=this.parent.getValueFromArg(ue+b(Xe[tt]+K)+st),Vt=this.parent.actCell;Vt=Vt.indexOf("!")>-1?Vt.split("!")[1]:Vt;var ce=this.parent.rowIndex(Vt),ee=this.parent.colIndex(Vt);this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid)+1,Et,ce+ht,ee+rt)}y=this.parent.getValueFromArg(ue+b(Xe[0]+K)+G)}if(v[3]==="FALSE"){for(var tt=0,ht=0;tt<Xe.length;tt++,ht++)for(var Ne=K,rt=0;Ne<=he;Ne++,rt++){var Te=this.parent.getValueFromArg(ue+b(Ne)+(Xe[tt]+G)),Vt=this.parent.actCell;Vt=Vt.indexOf("!")>-1?Vt.split("!")[1]:Vt;var ee=this.parent.colIndex(Vt),ce=this.parent.rowIndex(Vt);this.parent.parentObject.setValueRowCol(this.parent.getSheetID(this.parent.grid)+1,Te,ce+ht,ee+rt)}y=this.parent.getValueFromArg(ue+b(K)+(Xe[0]+G))}}}return y},S.prototype.ComputeCOUNTIF=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m;if((0,P.le)(m)||m[0]===""||v.length!==2)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var y,A=0,I,N=[],z="equal",V=v[1].split(this.parent.tic).join("");if(V.startsWith("<=")?(z="lessEq",V=V.substring(2)):V.startsWith(">=")?(z="greaterEq",V=V.substring(2)):V.startsWith("<>")?(z="notEq",V=V.substring(2)):V.startsWith("<")?(z="less",V=V.substring(1)):V.startsWith(">")?(z="greater",V=V.substring(1)):V.startsWith("=")&&(z="equal",V=V.substring(1)),v[0].indexOf(":")>-1&&this.parent.isCellReference(v[0])){y=this.parent.getCellCollection(v[0].split(this.parent.tic).join(""));for(var _=0;_<y.length;_++)I=this.parent.getValueFromArg(y[_]),(V.indexOf("*")>-1||V.indexOf("?")>-1)&&(I=this.parent.findWildCardValue(V,I)),N.push(I),N.push(V),this.parent.processLogical(N,z)===this.parent.trueValue&&A++}return A},S.prototype.ComputeSUMIFS=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=this.parent.computeIfsFormulas(m,this.parent.falseValue);return v},S.prototype.ComputeTEXT=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];for(var v,y=m.length,A=0;A<y;A++)(0,P.le)(v)?v=m[A]:v=v+","+m[A];var I=v.indexOf(","),N=v.slice(0,I),z=v.slice(v.indexOf('"')+1,v.length),V=z.indexOf('"');if(I>-1&&V!==z.length-1)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var _=N,G=z.slice(0,z.length-1),K=new Date(1900,0,1,0,0,0),oe=_+","+G,he=new P.eC;if(this.parent.getErrorStrings().indexOf(oe)>-1)return oe;if(_=this.parent.getValueFromArg(_),G=G.split(this.parent.tic).join(""),G==="")return"";_===""&&(G.length>0&&(G.toUpperCase().indexOf("M")>-1||G.toUpperCase().indexOf("D")>-1||G.toUpperCase().indexOf("Y")>-1||G.toUpperCase().indexOf("S")>-1||G.toUpperCase().indexOf("T")>-1)||G.toUpperCase().indexOf("H")>-1)&&(_=K.toString());var ue=this.parseDouble(_);if(isNaN(ue)&&this.parent.isDate(new Date(_))!==null&&(ue=this.parent.toOADate(new Date(_))),K=Date.parse(_.split(this.parent.tic).join("")),!isNaN(ue)||!isNaN(K)){if(G[0]==="[")return this.parent.tic+_+this.parent.tic;if(G.length>0&&(G.toUpperCase().indexOf("M")>-1||G.toUpperCase().indexOf("D")>-1||G.toUpperCase().indexOf("Y")>-1||G.toUpperCase().indexOf("S")>-1||G.toUpperCase().indexOf("T")>-1)||G.toUpperCase().indexOf("H")>-1){G=G.split("Y").join("y").split("D").join("d").split("H").join("h"),G=G.split("S").join("s").split("m").join("M").split("AM/PM").join("tt");var X=G.split(""),Ce=!1,ze=!1,A=0,We=0,Xe=0;for(A=0;A<X.length;){var tt=X[A];tt==="s"&&X[We]==="M"&&(X[We]="m",X[We-1]==="M"&&(X[We-1]="m")),this.parent.isChar(tt)?(We=A,tt==="M"&&Xe++):Xe>1&&Xe++,tt==="M"&&Ce&&(X[A]="m",ze=!0),tt==="h"?Ce=!0:this.parent.isChar(tt)&&tt!=="M"&&tt!=="h"&&!ze&&(Ce=!1,ze=!1),A++}G=String(X),G=G.split(",").join("").split(`
`).join(" ");var pt=this.parent.fromOADate(ue);ue===0&&(pt=K);var st=Z(G);if(st==="")return this.parent.getErrorStrings()[F.name];var ht=he.getDateFormat({skeleton:st,type:"date"}),rt=ht(new Date(pt.toString()));_=rt}else _=he.formatNumber(ue,{format:G})}return _},S.prototype.ComputeCOUNTIFS=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=this.parent.computeIfsFormulas(m,this.parent.trueValue);return v},S.prototype.ComputeAVERAGEIFS=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=this.parent.computeIfsFormulas(m,this.parent.falseValue,this.parent.trueValue);return v},S.prototype.ComputeMATCH=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m;if((0,P.le)(v)||v.length===1&&v[0]===""||v.length<2||v.length>3)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var y,A=[],I=v[0].split(this.parent.tic).join("");if(this.parent.isCellReference(I)&&(I=this.parent.getValueFromArg(I)),!I.toString().length)return this.parent.getErrorStrings()[F.na];v[2]=(0,P.le)(v[2])?"1":v[2].split(this.parent.tic).join(""),v[2].split(this.parent.tic).join("")===this.parent.trueValue&&(v[2]="1"),v[2].split(this.parent.tic).join("")===this.parent.falseValue&&(v[2]="0");var N=parseFloat(v[2]);if(N!==-1&&N!==0&&N!==1)return this.parent.getErrorStrings()[F.na];var z=0,V="";if(v[1].indexOf(":")>-1||this.parent.isCellReference(v[1])){y=this.parent.getCellCollection(v[1].split(this.parent.tic).join(""));for(var _=0;_<y.length;_++)A[_]=this.parent.getValueFromArg(y[_]).split(this.parent.tic).join("");for(var G=0;G<A.length;G++)if(!!A[G].toString().length){if(N===1){if(I===A[G])return G+1;I>A[G]&&(V?A[G]>V&&(z=G+1,V=A[G]):(z=G+1,V=A[G]))}else if(N===0){if((I.indexOf("*")>-1||I.indexOf("?")>-1)&&(A[G]=this.parent.findWildCardValue(I,A[G])),I===A[G]||this.parent.parseFloat(I)===this.parent.parseFloat(A[G]))return G+1}else if(N===-1){if(I===A[G])return G+1;I<A[G]&&(V?A[G]<V&&(z=G+1,V=A[G]):(z=G+1,V=A[G]))}}}return z||this.parent.getErrorStrings()[F.na]},S.prototype.ComputeSUBTOTAL=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y="";if(v.length<2)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var A=this.parent.parseFloat(this.parent.getValueFromArg(v[0].split(this.parent.tic).join(""))),I=v.slice(1,v.length);switch(A){case 1:case 101:y=this.ComputeAVERAGE.apply(this,I);break;case 2:case 102:y=this.ComputeCOUNT.apply(this,I);break;case 3:case 103:y=this.ComputeCOUNTA.apply(this,I);break;case 4:case 104:y=this.ComputeMAX.apply(this,I);break;case 5:case 105:y=this.ComputeMIN.apply(this,I);break;case 6:case 106:y=this.ComputePRODUCT.apply(this,I);break;case 7:case 107:y=this.ComputeDAY.apply(this,I);break;case 8:case 108:y=this.ComputeCONCAT.apply(this,I);break;case 9:case 109:y=this.ComputeSUM.apply(this,I);break;case 10:case 110:y=this.ComputeAVERAGEA.apply(this,I);break;case 11:case 111:y=this.ComputeABS.apply(this,I);break;default:y=this.parent.getErrorStrings()[F.value];break}return y},S.prototype.ComputeRADIANS=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y;if(v[0]===""||v.length>1)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];if(v[0].indexOf(":")>-1||v[0].split(this.parent.tic).join("")==="")return this.parent.getErrorStrings()[F.value];var A=v[0].split(this.parent.tic).join("");v[0]=isNaN(this.parent.parseFloat(A))?v[0]:A;var I=this.parent.getValueFromArg(v[0]),N=this.parent.parseFloat(I);if(!isNaN(N))y=Math.PI*N/180;else return I.indexOf(this.parent.tic)>-1?this.parent.getErrorStrings()[F.value]:this.parent.getErrorStrings()[F.name];return y},S.prototype.ComputeRANDBETWEEN=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m.length,y,A,I;if(v!==2)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];for(var N=0;N<v;N++){if(m[N]==="")return this.parent.getErrorStrings()[F.na];if(m[N].indexOf(this.parent.tic)>-1){if(isNaN(parseFloat(m[N].split(this.parent.tic).join(""))))return this.parent.getErrorStrings()[F.value];m[N]=m[N].split(this.parent.tic).join("")}if(I=parseFloat(this.parent.getValueFromArg(m[N])),this.parent.isCellReference(m[N])){if(I=this.parent.getValueFromArg(m[N])===""?0:I,N===0?y=I:A=I,y===0&&A===0)return"0";if(isNaN(I))return this.parent.getErrorStrings()[F.value]}else{if(isNaN(I))return this.parent.getErrorStrings()[F.name];N===0?y=I:A=I}}return A<y?this.parent.getErrorStrings()[F.num]:y===0?Math.floor(Math.random()*(A-(y-1)))+y:A-y==1?Math.round(Math.random()*(A-y)+y):Math.floor(Math.random()*(A-(y-1)))+y},S.prototype.ComputeSLOPE=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m;if(v.length!==2||v[0]==="")return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var y=this.parent.getCellCollection(v[1].split(this.parent.tic).join("")),A=this.parent.getCellCollection(v[0].split(this.parent.tic).join(""));if(A.length!==y.length)return this.parent.getErrorStrings()[F.na];var I=this.getDataCollection(A),N=this.getDataCollection(y);if(N.indexOf("#NAME?")>-1||I.indexOf("#NAME?")>-1)return this.parent.getErrorStrings()[F.name];for(var z=0,V=0,_=0,G=0,K=0,oe=N.length;K<oe;++K)Number(N[K]).toString()!=="NaN"&&Number(I[K]).toString()!=="NaN"&&(z+=Number(N[K])*Number(I[K]),_+=Number(N[K]),G+=Number(I[K]),V+=Number(N[K])*Number(N[K]));var he=((z-_*G/N.length)/(V-_*_/N.length)).toString();return he==="NaN"?this.parent.getErrorStrings()[F.divzero]:he},S.prototype.ComputeINTERCEPT=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m;if(v[0]===""||v.length!==2)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var y=this.parent.getCellCollection(v[0].split(this.parent.tic).join("")),A=this.parent.getCellCollection(v[1].split(this.parent.tic).join(""));if(y.length!==A.length)return this.parent.getErrorStrings()[F.na];var I=this.getDataCollection(A),N=this.getDataCollection(y);if(I.indexOf("#NAME?")>-1||N.indexOf("#NAME?")>-1)return this.parent.getErrorStrings()[F.name];for(var z=0,V=0,_=0,G=I.length;_<G;++_)z+=Number(I[_]),V+=Number(N[_]);z=z/I.length,V=V/I.length;for(var K=0,oe=0,he,_=0,G=I.length;_<G;++_)he=Number(I[_])-z,K+=he*(Number(N[_])-V),oe+=he*he;var ue=(V-K/oe*z).toString();return ue==="NaN"?this.parent.getErrorStrings()[F.divzero]:ue},S.prototype.ComputeLN=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y="",A,I;if(m.length===0||m.length>1)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];if(this.parent.isCellReference(v[0])){if(y=this.parent.getValueFromArg(v[0]),A=this.parent.parseFloat(y),A<=0||y==="")return this.parent.getErrorStrings()[F.num];if(isNaN(A))return this.parent.getErrorStrings()[F.value]}else{if(I=this.parent.getValueFromArg(v[0].split(this.parent.tic).join("")),A=this.parent.parseFloat(I),A<=0||A.toString()==="")return this.parent.getErrorStrings()[F.num];if(isNaN(A))return this.parent.getErrorStrings()[F.value]}return Math.log(A)},S.prototype.ComputeISNUMBER=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m;if(m.length===0||m.length>1)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];var y=this.parent.isCellReference(v[0])?this.parent.getValueFromArg(v[0]):this.parent.getValueFromArg(v[0].split(this.parent.tic).join(""));if(y.toString()==="")return!1;var A=this.parent.parseFloat(y);return!isNaN(A)},S.prototype.ComputeROUND=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y,A=0,I=0,N,z,V,_;return m.length===0||m.length>2?this.parent.formulaErrorStrings[Y.wrong_number_arguments]:m.length===1?(y=v[0].split(this.parent.tic).join("")==="TRUE"?"1":v[0].split(this.parent.tic).join("")==="FALSE"?"0":v[0],Math.round(this.parent.parseFloat(y)).toString()):(z=this.parent.getValueFromArg(v[0]),V=v[1].split(this.parent.tic).join("")===""?"0":this.parent.getValueFromArg(v[1].split(this.parent.tic).join("")),z=z.split(this.parent.tic).join("")==="TRUE"?"1":z.split(this.parent.tic).join("")==="FALSE"?"0":z,V=V.split(this.parent.tic).join("")==="TRUE"?"1":V.split(this.parent.tic).join("")==="FALSE"?"0":V,z!==""&&V!==""&&(A=this.parent.parseFloat(z),I=this.parent.parseFloat(V),!isNaN(I)&&!isNaN(A)&&I>0?N=A.toFixed(I):(_=Math.pow(10,-I),N=Math.round(A/_)*_)),N.toString())},S.prototype.ComputePOWER=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y,A,I;if(m.length===0||m.length>2)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];A=this.parent.getValueFromArg(v[0]),I=this.parent.getValueFromArg(v[1]),A=A.split(this.parent.tic).join("")==="TRUE"?"1":A.split(this.parent.tic).join("")==="FALSE"?"0":A,I=I.split(this.parent.tic).join("")==="TRUE"?"1":I.split(this.parent.tic).join("")==="FALSE"?"0":I;var N=this.parent.parseFloat(A),z=this.parent.parseFloat(I);if(!isNaN(N)&&!isNaN(z)){if(N===0&&z<0)return this.parent.getErrorStrings()[F.divzero];if(N===0&&z===0)return this.parent.getErrorStrings()[F.num];y=Math.pow(N,z)}else return this.parent.getErrorStrings()[F.value];return y.toString()},S.prototype.ComputeLOG=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y,A;if(m.length===0||m.length>2)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];if(y=this.parent.getValueFromArg(v[0]),A=m.length===2?this.parent.getValueFromArg(v[1]):"10",y===""||y===null||A===""||A===null)return this.parent.getErrorStrings()[F.num];y=y.split(this.parent.tic).join("")==="TRUE"?"1":y.split(this.parent.tic).join("")==="FALSE"?"0":y,A=A.split(this.parent.tic).join("")==="TRUE"?"1":A.split(this.parent.tic).join("")==="FALSE"?"0":A;var I=this.parent.parseFloat(y),N=this.parent.parseFloat(A);return I<=0||N<=0?this.parent.getErrorStrings()[F.num]:N===1?this.parent.getErrorStrings()[F.divzero]:!isNaN(I)&&!isNaN(N)?(Math.log(I)/Math.LN10/(Math.log(N)/Math.LN10)).toString():this.parent.getErrorStrings()[F.value]},S.prototype.ComputeTRUNC=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y,A=0;if(m.length===0||m.length>2)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];m.length===2&&(A=this.parent.getValueFromArg(v[1]),A=A.split(this.parent.tic).join("")==="TRUE"?"1":A.split(this.parent.tic).join("")==="FALSE"?"0":A,A=this.parent.parseFloat(A)),y=this.parent.getValueFromArg(v[0]),y=y.split(this.parent.tic).join("")==="TRUE"?"1":y.split(this.parent.tic).join("")==="FALSE"?"0":y;var I=this.parent.parseFloat(y.split(this.parent.tic).join(""));if(isNaN(I)||isNaN(A))return v[0]===this.parent.tic||this.parent.isCellReference(v[0])||v[1]===this.parent.tic||this.parent.isCellReference(v[1])?this.parent.getErrorStrings()[F.value]:this.parent.getErrorStrings()[F.name];var N=Math.pow(10,A),z=I<0?-1:1;return(z*Math.floor(N*Math.abs(I))/N).toString()},S.prototype.ComputeEXP=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y;if(m.length===0||m.length>1)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];y=this.parent.getValueFromArg(v[0]),y=y.split(this.parent.tic).join("")==="TRUE"?"1":y.split(this.parent.tic).join("")==="FALSE"?"0":y,y===""&&(y="0");var A=this.parent.parseFloat(y);return A>709?this.parent.getErrorStrings()[F.num]:isNaN(A)?v[0]===this.parent.tic||this.parent.isCellReference(v[0])?this.parent.getErrorStrings()[F.value]:this.parent.getErrorStrings()[F.name]:Math.exp(A).toString()},S.prototype.ComputeGEOMEAN=function(){for(var m=[],x=0;x<arguments.length;x++)m[x]=arguments[x];var v=m,y=1,A=0,I=0,N,z,V,_;if(m.length===0)return this.parent.formulaErrorStrings[Y.wrong_number_arguments];for(z=0;z<v.length;z++)if(v[z].indexOf(":")>-1){if(v[0]===this.parent.tic)return this.parent.getErrorStrings()[F.value];for(_=this.parent.getCellCollection(v[z].split(this.parent.tic).join("")),V=0;V<_.length;V++){if(I=this.parent.getValueFromArg(_[V]),I=I.split(this.parent.tic).join("")==="TRUE"?"1":I.split(this.parent.tic).join("")==="FALSE"?"0":I,N=this.parent.parseFloat(I),N<=0)return this.parent.getErrorStrings()[F.num];isNaN(N)||(A++,y=y*N)}}else if(I=this.parent.getValueFromArg(v[z]),I.length>0){if(I=I.split(this.parent.tic).join("")==="TRUE"?"1":I.split(this.parent.tic).join("")==="FALSE"?"0":I,!this.parent.isCellReference(v[z])&&isNaN(this.parent.parseFloat(I)))return this.parent.getErrorStrings()[F.name];if(N=this.parent.parseFloat(I),N<=0)return this.parent.getErrorStrings()[F.num];isNaN(N)||(A++,y=y*N)}return A>0&&(y=Math.pow(y,1/A)),y.toString()},S.prototype.getDataCollection=function(m){for(var x=[],v=0,y=m.length;v<y;v++)x.push(this.parent.getValueFromArg(m[v]));return x},S.prototype.parseDouble=function(m){var x=this.parent.parseFloat(m.toString());return isNaN(x)?NaN:x},S.prototype.spreadsheetDisplayText=function(m){if(this.parent.parentObject&&this.parent.parentObject.element&&this.parent.parentObject.element.classList.contains("e-spreadsheet")&&this.parent.isCellReference(m)){var x=this.parent.parentObject.getIndexes(m);m=this.parent.parentObject.getDisplayText(this.parent.parentObject.getActiveSheet().rows[x.startIdx].cells[x.endIdx])}return m},S.prototype.spreadsheetFormat=function(m){if(this.parent.parentObject&&this.parent.parentObject.element&&this.parent.parentObject.element.classList.contains("e-spreadsheet")&&this.parent.isCellReference(m)){var x=this.parent.parentObject.getIndexes(m);m=this.parent.parentObject.getActiveSheet().rows[x.startIdx].cells[x.endIdx].format}return m},S.prototype.getModuleName=function(){return"basic-formulas"},S}(),Se=function(){function S(m){this.emptyStr="",this.storedStringText=this.emptyStr,this.sheetToken="!",this.tokenAdd="a",this.tokenSubtract="s",this.tokenMultiply="m",this.tokenDivide="d",this.tokenLess="l",this.charEm="r",this.charEp="x",this.tokenGreater="g",this.tokenEqual="e",this.tokenLessEq="k",this.tokenGreaterEq="j",this.tokenNotEqual="o",this.tokenAnd="c",this.tokenEm="v",this.tokenEp="t",this.tokenOr=String.fromCharCode(126),this.charAnd="i",this.charLess="<",this.charGreater=">",this.charEqual="=",this.charLessEq="f",this.charGreaterEq="h",this.charNoEqual="z",this.stringGreaterEq=">=",this.stringLessEq="<=",this.stringNoEqual="<>",this.stringAnd="&",this.stringOr="^",this.charOr="w",this.charAdd="+",this.charSubtract="-",this.charMultiply="*",this.charDivide="/",this.fixedReference="$",this.spaceString=" ",this.ignoreBracet=!1,this.isError=!1,this.isFormulaParsed=!1,this.findNamedRange=!1,this.stringsColl=new Map,this.tokens=[this.tokenAdd,this.tokenSubtract,this.tokenMultiply,this.tokenDivide,this.tokenLess,this.tokenGreater,this.tokenEqual,this.tokenLessEq,this.tokenGreaterEq,this.tokenNotEqual,this.tokenAnd,this.tokenOr],this.charNOTop=String.fromCharCode(167),this.specialSym=["~","@","#","?"],this.isFailureTriggered=!1,this.parent=m}return S.prototype.parse=function(m,x){if(this.parent.isTextEmpty(m))return m;if(E(m))return this.parent.getErrorStrings()[F.ref];this.parent.getFormulaCharacter()!==String.fromCharCode(0)&&this.parent.getFormulaCharacter()===m[0]&&(m=m.substring(1)),(this.parent.namedRanges.size>0||this.parent.storedData.size>0)&&(m=this.checkForNamedRangeAndKeyValue(m),this.findNamedRange=!1),m=m.split("-+").join("-"),m=m.split("--").join("+"),m=m.split("+-").join("-"),m=m.split("-(-").join("(");var v=this.storeStrings(m);m=this.storedStringText;var y=0;if((0,P.le)(v)&&(m=m.split(" ").join("")),m=m.split("=>").join(">="),m=m.split("=<").join("<="),(m[m.length-1]!==this.parent.arithMarker||this.indexOfAny(m,this.tokens)!==m.length-2)&&(m=m.toUpperCase()),m.indexOf(this.sheetToken)>-1){var A=this.parent.getSheetFamilyItem(this.parent.grid);if(A.sheetNameToParentObject!=null&&A.sheetNameToParentObject.size>0){m[0]!==this.sheetToken.toString()&&(m=this.parent.setTokensForSheets(m));var I=this.parent.getSheetToken(m.split(this.parent.tic).join(this.emptyStr)),N=this.checkScopedRange(m.split('"').join(this.emptyStr).split(this.sheetToken).join(""));(0,P.le)(I)&&I!==""&&this.parent.namedRanges.size>0&&N!==""&&(m=N)}}m=this.markLibraryFormulas(m);try{m=this.formulaAutoCorrection(m)}catch(K){var z={message:K.message,exception:K,isForceCalculable:K.formulaCorrection,computeForceCalculate:!1};if(!z.isForceCalculable)throw this.parent.formulaErrorStrings[Y.invalid_expression];if(this.isFailureTriggered||(this.parent.trigger("onFailure",z),this.isFailureTriggered=!0),z.isForceCalculable&&z.computeForceCalculate)m=this.formulaAutoCorrection(m,z),this.parent.storedData.get(x).formulaText="="+m;else throw this.parent.formulaErrorStrings[Y.invalid_expression]}if(!this.ignoreBracet)for(y=m.indexOf(")");y>-1;){var V=m.substring(0,y).lastIndexOf("(");if(V===-1)throw new d(this.parent.formulaErrorStrings[Y.mismatched_parentheses]);if(V===y-1)throw new d(this.parent.formulaErrorStrings[Y.empty_expression]);var _=this.emptyStr;this.ignoreBracet?_=this.parent.substring(m,V,y-V+1):_=this.parent.substring(m,V+1,y-V-1);try{m=m.substring(0,V)+this.parseSimple(_)+m.substring(y+1)}catch(K){var z=this.exceptionArgs(K);this.isFailureTriggered||(this.parent.trigger("onFailure",z),this.isFailureTriggered=!0);var G=typeof z.exception=="string"?z.exception:z.message;return(this.parent.getErrorLine(K)?"":"#"+this.parent.getErrorLine(K)+": ")+G}y=m.indexOf(")")}if(!this.ignoreBracet&&m.indexOf("(")>-1)throw new d(this.parent.formulaErrorStrings[Y.mismatched_parentheses]);return m=this.parseSimple(m),v!==null&&v.size>0&&(m=this.setStrings(m,v)),m},S.prototype.exceptionArgs=function(m){return{message:m.message,exception:m,isForceCalculable:m.formulaCorrection,computeForceCalculate:!1}},S.prototype.formulaAutoCorrection=function(m,x){var v=["*","+","-","/","^","&"],y=[">","=","<"],A=0,I="",N="",z="",V="",_="",G="",K="",oe=0;if(this.parent.formulaErrorStrings.indexOf(m)>-1)return m;if(this.indexOfAny(m,this.specialSym)>-1)throw new d(this.parent.formulaErrorStrings[Y.invalid_expression],!1);for(;A<m.length;)if(m=m.split("-*").join("-").split("/*").join("/").split("*/").join("*").split("-/").join("-").split("*+").join("*").split("+*").join("+"),this.parent.isDigit(m[A])&&m.length>A+1&&this.indexOfAny(m[A+1],v)>-1&&m.length>A+2&&!(0,P.le)(m[A+2])&&this.indexOfAny(m[A+2],v)>-1&&(m[A+2]!=="-"||m[A+1]!=="*"&&m[A+1]!=="/")){if((0,P.le)(x))throw new d(this.parent.formulaErrorStrings[Y.invalid_expression],!0);if(x.computeForceCalculate)this.parent.isDigit(m[A])?(oe<1?(G=m[A],z=m[A+1],(0,P.le)(z)&&(z=this.emptyStr),z=z==="&"?"":z,oe=oe+1,I=I+G+z):oe<2&&(K=m[A],V=m[A-1],_=m[A+1],oe=0,V==="-"?(_=(0,P.le)(_)?this.emptyStr:_,_=_==="&"?"":_,I=I+V+K+_):(_=(0,P.le)(_)?this.emptyStr:_,I=I+K+_)),A=A+2):(I=m[A]==="-"?I+m[A]:I,A=A+1);else throw this.parent.formulaErrorStrings[Y.improper_formula]}else if((this.parent.isDigit(m[A])||m[A]===this.parent.rightBracket||this.parent.storedData.has(m[A].toUpperCase()))&&((0,P.le)(m[A+1])||this.indexOfAny(m[A+1],v))>-1)N=(0,P.le)(m[A+1])?this.emptyStr:m[A+1],N=N==="&"?"":N,I=m[A-1]==="-"?I+m[A-1]+m[A]+N:I+m[A]+N,A=A+2;else if(this.indexOfAny(m[A],y)>-1&&!(0,P.le)(m[A-1])&&!(0,P.le)(m[A+1]))I=I+m[A],A=A+1;else if(m[A]==="q")for(;m[A]!==this.parent.leftBracket;)I=I+m[A],A=A+1;else m[A]===this.parent.leftBracket||m[A]===this.parent.rightBracket||m[A]==="{"||m[A]==="}"||m[A]==="("||m[A]===")"||this.parent.isUpperChar(m[A])||m[A].indexOf(":")>-1||m[A]===this.parent.getParseArgumentSeparator()||m[A]==="%"&&this.parent.isDigit(m[A-1])||m[A]===this.parent.tic||m[A]===" "||m[A]==="."||m[A]===this.sheetToken||m[A]==="$"?(I=I+m[A],A=A+1):(this.parent.isDigit(m[A])&&(I=m[A-1]==="-"?I+m[A-1]+m[A]:I+m[A]),(m[A]==="-"||m[A]==="+")&&(I=I+m[A],I=I.split("++").join("+").split("+-").join("-").split("-+").join("-")),(m[A]==="/"||m[A]==="*")&&(I=I+m[A]),A=A+1);return I=I===this.emptyStr?m:I,this.indexOfAny(I[I.length-1],v)>-1&&(I=I.substring(0,I.length-1)),I=I.split("--").join("-").split("-+").join("-").split("+-").join("-"),I},S.prototype.checkScopedRange=function(m){var x=this,v=this.emptyStr,y="NaN",A=this.parent.getSheetID(this.parent.grid),I=this.parent.getSheetFamilyItem(this.parent.grid);if(m[0]===this.sheetToken.toString()){var N=m.indexOf(this.sheetToken,1),z=parseInt(m.substr(1,N-1),10);N>1&&!this.parent.isNaN(z)&&(m=m.substring(N+1),A=z)}var V="!"+A.toString()+"!";return I===null||I.sheetNameToToken==null||I.sheetNameToToken.forEach(function(_,G){if(I.sheetNameToToken.get(G).toString()===V){var K=x.emptyStr;x.parent.namedRanges.forEach(function(oe,he){(0,P.le)(x.parent.parentObject)?K=I.sheetNameToToken.get(he).toUpperCase():K=(x.parent.parentObject.getActiveSheet().name+x.sheetToken+m).toUpperCase(),x.parent.getNamedRanges().has(K)&&(v=x.parent.getNamedRanges().get(K).toUpperCase(),y=v)})}}),y},S.prototype.storeStrings=function(m){var x=0,v=0,y=0,A="",I=null,N,z=m.indexOf(this.parent.tic);if(z>-1)for(x=m.indexOf(this.parent.tic);x>-1&&m.length>0;){if(I===null&&(I=this.stringsColl),v=x+1<m.length?m.indexOf(this.parent.tic,x+1):-1,v===-1)throw new d(this.parent.formulaErrorStrings[Y.mismatched_tics]);N=this.parent.substring(m,x,v-x+1),A=this.parent.tic+this.spaceString+y.toString()+this.parent.tic,I=I.set(A,N),m=m.substring(0,x)+A+m.substring(v+1),x=x+A.length,x<=m.length&&(x=m.indexOf(this.parent.tic,x)),y++}return this.storedStringText=m,I},S.prototype.setStrings=function(m,x){for(var v=0;v<x.size;v++)x.forEach(function(y,A){m=m.split(A).join(y)});return m},S.prototype.parseSimple=function(m){var x=!0,v=m;if(v.length>0&&v[0]==="+"&&(v=v.substring(1)),v==="#DIV/0!")return"#DIV/0!";if(v==="#NAME?")return"#NAME?";if(v===""||this.parent.formulaErrorStrings.indexOf(v)>-1)return v;v=v.split(this.stringLessEq).join(this.charLessEq),v=v.split(this.stringGreaterEq).join(this.charGreaterEq),v=v.split(this.stringNoEqual).join(this.charNoEqual),v=v.split(this.stringAnd).join(this.charAnd),v=v.split(this.stringOr).join(this.charOr),v=v.split(this.fixedReference).join(this.emptyStr),x=!0;var y=[this.tokenEp,this.tokenEm],A=[this.tokenMultiply,this.tokenDivide],I=[this.tokenAdd,this.tokenSubtract],N=[this.charMultiply,this.charDivide],z=[this.charAdd,this.charSubtract],V=[this.tokenLess,this.tokenGreater,this.tokenEqual,this.tokenLessEq,this.tokenGreaterEq,this.tokenNotEqual],_=[this.charLess,this.charGreater,this.charEqual,this.charLessEq,this.charGreaterEq,this.charNoEqual],G=[this.charEp,this.charEm],K=[this.tokenAnd],oe=[this.charAnd],he=[this.charOr],ue=[this.tokenOr];return v=this.parseSimpleOperators(v,y,G),v=this.parseSimpleOperators(v,ue,he),x&&(v=this.parseSimpleOperators(v,A,N)),x&&(v=this.parseSimpleOperators(v,I,z)),x&&(v=this.parseSimpleOperators(v,V,_)),x&&(v=this.parseSimpleOperators(v,K,oe)),v},S.prototype.parseSimpleOperators=function(m,x,v){if(this.parent.getErrorStrings().indexOf(m)>-1)return m;for(var y=m,A=0,I="",N=0;N<v.length;N++)I=I+v[N];y=y.split("---").join("-").split("--").join("+").split(this.parent.getParseArgumentSeparator()+"-").join(this.parent.getParseArgumentSeparator()+"u").split(this.parent.leftBracket+"-").join(this.parent.leftBracket+"u").split("=-").join("=u"),y=y.split(",+").join(",").split(this.parent.leftBracket+"+").join(this.parent.leftBracket).split("=+").join("=").split(">+").join(">").split("<+").join("<").split("/+").join("/").split("*+").join("*").split("++").join("+").split("*-").join("*u").toString(),y.length>0&&y[0]==="-"?(y=y.substring(1).split("-").join(this.tokenOr),y="0-"+y,y=this.parseSimpleOperators(y,[this.tokenSubtract],[this.charSubtract]),y=y.split(this.tokenOr).join("-")):y.length>0&&y[0]==="+"?y=y.substring(1):y.length>0&&y[y.length-1]==="+"&&(y=y.substring(0,y.length-1));try{if(this.indexOfAny(y,v)>-1){if(y.includes(" ")){for(var z="",V=0;V<y.length;V++){var _=y[V];if(v.indexOf(_)>=0)z=z.trim()+_;else{if(_==" "&&v.indexOf(z[z.length-1])>=0)continue;z+=_}}y=z}for(A=this.indexOfAny(y,v);A>-1;){var G="",K="",oe=0,he=0,ue=y[A]===this.charNOTop,X=0;if(ue)oe=A;else if(X=A-1,y[X]===this.parent.arithMarker){var Ce=this.findLeftMarker(y.substring(0,X-1));if(Ce<0)throw new d(this.parent.formulaErrorStrings[Y.cannot_parse]);G=this.parent.substring(y,Ce+1,X-Ce-1),oe=Ce+1}else if(y[X]===this.parent.rightBracket){for(var ze=0,Ce=X-1;Ce>0&&(y[Ce]!=="q"||ze!==0);)y[Ce]==="q"?ze--:y[Ce]===this.parent.rightBracket&&ze++,Ce--;if(Ce<0)throw new d(this.parent.formulaErrorStrings[Y.cannot_parse]);G=this.parent.substring(y,Ce,X-Ce+1),oe=Ce}else if(y[X]===this.parent.tic[0]){var We=y.substring(0,X-1).lastIndexOf(this.parent.tic);if(We<0)throw new d(this.parent.formulaErrorStrings[Y.cannot_parse]);G=this.parent.substring(y,We,X-We+1),oe=We}else{for(var Xe=!1;X>-1&&(this.parent.isDigit(y[X])||!Xe&&y[X]===this.parent.getParseDecimalSeparator());)y[X]===this.parent.getParseDecimalSeparator()&&(Xe=!0),X=X-1;if(X>-1&&Xe&&y[X]===this.parent.getParseDecimalSeparator())throw new d(this.parent.formulaErrorStrings[Y.number_contains_2_decimal_points]);if(X=X+1,X===0||X>0&&!this.parent.isUpperChar(y[X-1]))G="n"+this.parent.substring(y,X,A-X),oe=X;else{for(X=X-1;X>-1&&(this.parent.isUpperChar(y[X])||this.parent.isDigit(y[X]));)X=X-1;if(X>-1&&y[X]===this.sheetToken){for(X=X-1;X>-1&&y[X]!==this.sheetToken;)X=X-1;X>-1&&y[X]===this.sheetToken&&(X=X-1)}if(X>-1&&y[X]===":"){for(X=X-1;X>-1&&this.parent.isDigit(y[X]);)X=X-1;for(;X>-1&&this.parent.isUpperChar(y[X]);)X=X-1;if(X>-1&&y[X]===this.sheetToken){for(X--;X>-1&&y[X]!==this.sheetToken;)X--;X>-1&&y[X]===this.sheetToken&&X--}X=X+1,G=this.parent.substring(y,X,A-X),G=this.parent.getCellFrom(G)}else X=X+1,G=this.parent.substring(y,X,A-X);this.parent.updateDependentCell(G),oe=X}(this.parent.namedRanges.size>0&&this.parent.namedRanges.has(G.toUpperCase())||this.parent.storedData.has(G.toUpperCase()))&&(G="n"+this.checkForNamedRangeAndKeyValue(G))}if(A===y.length-1)throw new d(this.parent.formulaErrorStrings[Y.expression_cannot_end_with_an_operator]);X=A+1;var tt=y[X]==="u";if(tt&&(X=X+1),y[X]===this.parent.tic[0]){var Ce=y.substring(X+1).indexOf(this.parent.tic);if(Ce<0)throw this.parent.formulaErrorStrings[Y.cannot_parse];K=this.parent.substring(y,X,Ce+2),he=Ce+X+2}else if(y[X]===this.parent.arithMarker){var Ce=this.findRightMarker(y.substring(X+1));if(Ce<0)throw new d(this.parent.formulaErrorStrings[Y.cannot_parse]);K=this.parent.substring(y,X+1,Ce),he=Ce+X+2}else if(y[X]==="q"){for(var ze=0,Ce=X+1;Ce<y.length&&(y[Ce]!==this.parent.rightBracket||ze!==0);)y[Ce]===this.parent.rightBracket?ze++:y[Ce]==="q"&&ze--,Ce++;if(Ce===y.length)throw this.parent.formulaErrorStrings[Y.cannot_parse];K=this.parent.substring(y,X,Ce-X+1),tt&&(K="u"+K),he=Ce+1}else if(this.parent.isDigit(y[X])||y[X]===this.parent.getParseDecimalSeparator()){var Xe=y[X]===this.parent.getParseDecimalSeparator();for(X=X+1;X<y.length&&(this.parent.isDigit(y[X])||!Xe&&y[X]===this.parent.getParseDecimalSeparator());)y[X]===this.parent.getParseDecimalSeparator()&&(Xe=!0),X=X+1;if(X<y.length&&y[X]==="%"&&(X+=1),Xe&&X<y.length&&y[X]===this.parent.getParseDecimalSeparator())throw this.parent.formulaErrorStrings[Y.number_contains_2_decimal_points];K="n"+this.parent.substring(y,A+1,X-A-1),he=X}else if(this.parent.isUpperChar(y[X])||y[X]===this.sheetToken||y[X]==="u"){if(y[X]===this.sheetToken)for(X=X+1;X<y.length&&y[X]!==this.sheetToken;)X=X+1;X=X+1;for(var pt=0,st=!1;X<y.length&&(this.parent.isUpperChar(y[X])||y[X]==="_"||y[X]==="."||y[X]==="["||y[X]==="]"||y[X]==="#"||y[X]===" "||y[X]==="%"||y[X]===this.parent.getParseDecimalSeparator()&&st);)X!==y.length-1&&y[X]==="["&&y[X+1]==="["&&(st=!0),X!==y.length-1&&y[X]==="]"&&y[X+1]==="]"&&(st=!1),X++,pt++;var ht=X===y.length||!this.parent.isDigit(y[X]);if(pt>1){for(;X<y.length&&(this.parent.isUpperChar(y[X])||this.parent.isDigit(y[X])||y[X]===" "||y[X]==="_");)X++;ht=!0}for(;X<y.length&&this.parent.isDigit(y[X]);)X=X+1;if(X<y.length&&y[X]===":"){if(X=X+1,X<y.length&&y[X]===this.sheetToken){for(X++;X<y.length&&y[X]!==this.sheetToken;)X=X+1;X<y.length&&y[X]===this.sheetToken&&X++}for(;X<y.length&&this.parent.isUpperChar(y[X]);)X=X+1;for(;X<y.length&&this.parent.isDigit(y[X]);)X=X+1;X=X-1,K=this.parent.substring(y,A+1,X-A),K=this.parent.getCellFrom(K)}else X=X-1,K=this.parent.substring(y,A+1,X-A),tt=y[X]==="u",tt&&(K="u"+K);ht&&K.startsWith(this.sheetToken)&&(ht=!this.parent.isCellReference(K)),ht||this.parent.updateDependentCell(K),(this.parent.namedRanges.size>0&&this.parent.namedRanges.has(K.toUpperCase())||this.parent.storedData.has(K.toUpperCase()))&&(K="n"+this.checkForNamedRangeAndKeyValue(K)),he=X+1}var rt=I.indexOf(y[A]),Et=this.parent.arithMarker+G+K+x[rt]+this.parent.arithMarker;oe>0&&(Et=y.substring(0,oe)+Et),he<y.length&&(Et=Et+y.substring(he)),Et=Et.split(this.parent.arithMarker2).join(this.parent.arithMarker.toString()),y=Et,A=this.indexOfAny(y,v)}}else if(y.length>0&&(this.parent.isUpperChar(y[0])||y[0]===this.sheetToken)){for(var Vt=!0,ce=!0,ee=!1,Ne=y.length,Ce=0;Ce<Ne;++Ce)if(y[Ce]===this.sheetToken){if(Ce>0&&!ee)throw this.parent.getErrorStrings()[F.ref];for(ee=!0,Ce++;Ce<Ne&&this.parent.isDigit(y[Ce]);)Ce++;if(Ce===Ne||y[Ce]!==this.sheetToken){Vt=!1;break}}else{if(!ce&&this.parent.isChar(y[Ce])){Vt=!1;break}if(this.parent.isChar(y[Ce])||this.parent.isDigit(y[Ce])||y[Ce]===this.sheetToken)ce=this.parent.isUpperChar(y[Ce]);else{Vt=!1;break}}Vt&&this.parent.updateDependentCell(y)}return y}catch(Te){return Te}},S.prototype.indexOfAny=function(m,x){for(var v=0;v<m.length;v++)if(x.indexOf(m[v])>-1)return v;return-1},S.prototype.findLeftMarker=function(m){var x=-1;if(m.indexOf(this.parent.arithMarker)>-1){for(var v=0,y=m.length-1;y>=0;--y)if(m[y]===this.parent.rightBracket)v--;else if(m[y]===this.parent.leftBracket)v++;else if(m[y]===this.parent.arithMarker&&v===0){x=y;break}}return x},S.prototype.findRightMarker=function(m){var x=-1;if(m.indexOf(this.parent.arithMarker)>-1){for(var v=0,y=0;y<m.length;++y)if(m[y]===this.parent.rightBracket)v--;else if(m[y]===this.parent.leftBracket)v++;else if(m[y]===this.parent.arithMarker&&v===0){x=y;break}}return x},S.prototype.parseFormula=function(m,x){if(m.length>0&&m[0]===this.parent.getFormulaCharacter()&&(m=m.substring(1)),m.indexOf("#REF!")>-1)return this.parent.getErrorStrings()[F.ref];m.length>0&&m[0]==="+"&&(m=m.substring(1));try{this.isFailureTriggered=!1,this.isError=!1,m=this.parse(m.trim(),x),this.isFormulaParsed=!0}catch(A){var v=this.exceptionArgs(A);this.isFailureTriggered||(this.parent.trigger("onFailure",v),this.isFailureTriggered=!0);var y=typeof v.exception=="string"?v.exception:v.message;m=((0,P.le)(this.parent.getErrorLine(A))?"":"#"+this.parent.getErrorLine(A)+": ")+y,this.isError=!0}return m},S.prototype.markLibraryFormulas=function(m){var x=0,v=m.indexOf(")");if(v===-1)m=this.markNamedRanges(m);else for(;v>-1;){for(var y=0,A=v-1;A>-1&&(m[A]!=="("||y!==0);)m[A]===")"&&y++,A--;if(A===-1)throw new d(this.parent.formulaErrorStrings[Y.mismatched_parentheses]);for(var I=A-1;I>-1&&this.parent.isChar(m[I]);)I--;var N=A-I-1,z=this.parent.substring(m,I+1,N);if(N>0&&!(0,P.le)(this.parent.getFunction(z))){this.parent.substring(m,I+1,N)==="AREAS"?this.ignoreBracet=!0:this.ignoreBracet=!1;var V=this.parent.substring(m,A,v-A+1);try{var _=void 0;V=V.split("(").join("").split(")").join(""),V="("+this.formulaAutoCorrection(V,_)+")"}catch(oe){var _={message:oe.message,exception:oe,isForceCalculable:oe.formulaCorrection,computeForceCalculate:!1};if(!_.isForceCalculable)throw this.parent.formulaErrorStrings[Y.improper_formula];if(this.isFailureTriggered||(this.parent.trigger("onFailure",_),this.isFailureTriggered=!0,x=x+1),_.computeForceCalculate=x>0?!0:_.computeForceCalculate,_.isForceCalculable)if(_.computeForceCalculate)V=V.split("(").join("").split(")").join(""),V="("+this.formulaAutoCorrection(V,_)+")";else throw this.parent.formulaErrorStrings[Y.improper_formula];else throw this.parent.formulaErrorStrings[Y.improper_formula]}V=this.markNamedRanges(V),V=this.swapInnerParens(V),V=this.addParensToArgs(V);var G=V.lastIndexOf(this.parent.getParseArgumentSeparator());G===-1&&V.length>2&&V[0]==="("&&V[V.length-1]===")"&&V[1]!=="{"&&V[1]!=="("&&(V=V.substring(0,V.length-1)+"}"+V.substring(V.length-1),V=V[0]+"{"+V.substring(1)),m=m.substring(0,I+1)+"q"+this.parent.substring(m,I+1,N)+V.split("(").join(this.parent.leftBracket).split(")").join(this.parent.rightBracket)+m.substring(v+1)}else{if(N>0)return this.parent.getErrorStrings()[F.name];var K=this.emptyStr;A>0&&(K=m.substring(0,A)),K=K+"{"+this.parent.substring(m,A+1,v-A-1)+"}",v<m.length&&(K=K+m.substring(v+1)),K=this.markNamedRanges(K),m=K}v=m.indexOf(")")}return m=m.split("{").join("(").split("}").join(")"),m},S.prototype.swapInnerParens=function(m){return m.length>2&&(m=m[0]+m.substr(1,m.length-2).split("(").join("{").split(")").join("}")+m[m.length-1]),m},S.prototype.addParensToArgs=function(m){if(m.length===0)return this.emptyStr;var x=[];x.push(this.parent.getParseArgumentSeparator()),x.push(this.parent.rightBracket);var v=m.lastIndexOf(this.parent.getParseArgumentSeparator()),y=0;if(v===-1){if(m.length>2&&m[0]==="("&&m[m.length-1]===")")if(m[1]!=="{"&&m[1]!=="(")m=m.substring(0,m.length-1)+"}"+m.substring(m.length-1),m=m[0]+"{"+m.substring(1);else{var A=["+","-","*","/"];v=this.lastIndexOfAny(m,A),y===0&&m[m.length-1]===")"&&(y=m.length-1),y>0&&m[v+1]!=="{"&&m[v-1]==="}"&&(m=m.substr(0,y)+"}"+m.substr(y),m=m.substr(0,v+1)+"{"+m.substr(v+1))}}else for(var I=!0;v>-1;){var N=this.indexOfAny(m.substring(v+1,m.length),x);N>=0?N=v+N+1:N===-1&&m[m.length-1]===")"&&(N=m.length-1),N>0&&m[v+1]!=="{"&&m[N-1]!=="}"&&(m=m.substr(0,N)+"}"+m.substr(N),m=m.substr(0,v+1)+"{"+m.substr(v+1)),v=m.substr(0,v).lastIndexOf(this.parent.getParseArgumentSeparator()),I&&v===-1&&m[0]==="("&&(v=0,I=!1)}return m=m.split("{}").join(this.emptyStr),m},S.prototype.lastIndexOfAny=function(m,x){for(var v=m.length-1;v>-1;v--)if(x.indexOf(m[v])>-1)return v;return-1},S.prototype.markNamedRanges=function(m){var x=[")",this.parent.getParseArgumentSeparator(),"}","+","-","*","/","<",">","=","&"],v=m.length>0&&(m[0]==="("||m[0]==="{")?1:0;m.indexOf("#N/A")>-1&&(m=m.split("#N/A").join("#N~A")),m.indexOf("#DIV/0!")>-1&&(m=m.split("#DIV/0!").join("#DIV~0!"));for(var y=this.indexOfAny(m.substring(v),x);y>-1&&y+v<m.length;){var A=this.emptyStr,I=null;if(this.parent.substring(m,v,y).indexOf("[")>-1?I=this.getTableRange(this.parent.substring(m,v,y)):this.parent.storedData.has(this.parent.substring(m,v,y))?I=this.checkForNamedRangeAndKeyValue(this.parent.substring(m,v,y)):this.parent.namedRanges.has(this.parent.substring(m,v,y))&&(I=this.checkForNamedRangeAndKeyValue(this.parent.substring(m,v,y))),(0,P.le)(I)&&(A=this.checkScopedRange(this.parent.substring(m,v,y)),A!=="NaN"?(this.findNamedRange=!0,I=A):this.parent.substring(m,v,y).startsWith(this.sheetToken.toString()),!(0,P.le)(I)&&this.findNamedRange&&I.indexOf(this.fixedReference)>-1&&(I=I.split(this.fixedReference).join(this.emptyStr))),(0,P.le)(I)||(I=I.toUpperCase(),I=this.parent.setTokensForSheets(I),I=this.markLibraryFormulas(I)),!(0,P.le)(I)&&I!==this.emptyStr)m=m.substring(0,v)+I+m.substring(v+y),v+=I.length+1;else for(v+=y+1;v<m.length&&!this.parent.isUpperChar(m[v])&&m[v]!==this.sheetToken;)v++;for(y=v,v<m.length-1&&m[v]==="{"&&(v=v+1),y=this.indexOfAny(m.substring(v),x);y===0&&v<m.length-1;)v++,y=this.indexOfAny(m.substring(v),x);if((y===-1||m.substring(v).indexOf("[")>-1)&&v<m.length){if(m.substring(v).indexOf("[")>-1?I=this.getTableRange(m.substring(v)):this.parent.storedData.has(m.substring(v))?I=this.parent.storedData.size>0?this.checkForNamedRangeAndKeyValue(m.substring(v)):I:I=this.parent.namedRanges.size>0?this.checkForNamedRangeAndKeyValue(m.substring(v)):I,(0,P.le)(I)&&(A=this.checkScopedRange(m.substring(v)),A!=="NaN"&&(I=A)),!(0,P.le)(I)&&I!==this.emptyStr&&(I=I.toUpperCase(),I=this.parent.setTokensForSheets(I),I=this.markLibraryFormulas(I),I!=null)){var N=m.substring(v);N[N.length-1]===")"?m=m.substring(0,v)+I+")":m=m.substring(0,v)+I,v+=I.toString().length+1}y=v<m.length?this.indexOfAny(m.substring(v),x):-1}}return m.indexOf("#N~A")>-1&&(m=m.split("#N~A").join("#N/A")),m.indexOf("#DIV~0!")>-1&&(m=m.split("#DIV~0!").join("#DIV/0!")),m},S.prototype.checkForNamedRangeAndKeyValue=function(m){var x=this.emptyStr;if(m.indexOf("[")>-1){var v=this.getTableRange(m);(0,P.le)(v)||(this.findNamedRange=!0,m=v)}if(x=this.checkScopedRange(m),x!=="NaN")this.findNamedRange=!0,m=x;else{if(m.indexOf(this.sheetToken)>-1){var y=this.parent.getSheetFamilyItem(this.parent.grid),A=m.split('"').join(this.emptyStr);if(A=A.substr(0,A.indexOf(this.sheetToken)),y.sheetNameToToken.has(A.toUpperCase()))var I=parseInt(y.sheetNameToToken.get(A.toUpperCase()).split(this.sheetToken).join(this.emptyStr))}this.parent.storedData.size>0&&this.parent.storedData.has(m)&&(m="A"+this.parent.colIndex(m)),this.parent.namedRanges.size>0&&this.parent.namedRanges.has(m.toUpperCase())&&((0,P.le)(this.parent.parentObject)?(m=this.parse(this.parent.namedRanges.get(m.toUpperCase())),m=this.parent.setTokensForSheets(m),m.indexOf(this.fixedReference)>-1&&m.split(this.fixedReference).join(this.emptyStr),this.findNamedRange=!0):m=this.parse(this.parent.namedRanges.get(m.toUpperCase()))),this.findNamedRange&&m[0]!=="!"&&m[0]!=="q"&&m[0]!=="bq"&&(m=this.parent.setTokensForSheets(m),m.indexOf(this.fixedReference)>-1&&(m=m.split(this.fixedReference).join(this.emptyStr)))}return m},S.prototype.getTableRange=function(m){m=m.replace(" ",this.emptyStr).toUpperCase();var x=m.replace("]",this.emptyStr).replace("#DATA",this.emptyStr),v=x;x.indexOf(this.parent.getParseArgumentSeparator())>-1&&(v=x.substring(0,x.indexOf(this.parent.getParseArgumentSeparator())).replace("[",this.emptyStr),x=x.replace("[",this.emptyStr).replace(this.parent.getParseArgumentSeparator(),"_"));var y=this.emptyStr;return x.toUpperCase()},S.prototype.findNextEndIndex=function(m,x){for(var v=0,y=x,A=!1;!A&&x<m.length;)m[y]==="["?v++:m[y]==="]"&&(v--,v===0&&(A=!0)),x++;return x=x-y,x},S}(),Q=function(){var S=function(m,x){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,y){v.__proto__=y}||function(v,y){for(var A in y)y.hasOwnProperty(A)&&(v[A]=y[A])},S(m,x)};return function(m,x){S(m,x);function v(){this.constructor=m}m.prototype=x===null?Object.create(x):(v.prototype=x.prototype,new v)}}(),te=function(S,m,x,v){var y=arguments.length,A=y<3?m:v===null?v=Object.getOwnPropertyDescriptor(m,x):v,I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(S,m,x,v);else for(var N=S.length-1;N>=0;N--)(I=S[N])&&(A=(y<3?I(A):y>3?I(m,x,A):I(m,x))||A);return y>3&&A&&Object.defineProperty(m,x,A),A},O=function(S){Q(m,S);function m(v){var y=S.call(this,null,null)||this;y.lFormulas=new Map,y.storedData=new Map,y.keyToRowsMap=new Map,y.rowsToKeyMap=new Map,y.rightBracket=String.fromCharCode(161),y.leftBracket=String.fromCharCode(162),y.sheetToken="!",y.emptyString="",y.leftBrace="{",y.rightBrace="}",y.cell=y.emptyString,y.cellPrefix="!0!A",y.treatEmptyStringAsZero=!1,y.tic='"',y.singleTic="'",y.trueValue="TRUE",y.falseValue="FALSE",y.parseDecimalSeparator=".",y.arithMarker=String.fromCharCode(180),y.arithMarker2=y.arithMarker+y.arithMarker,y.dependentCells=null,y.dependentFormulaCells=null,y.minValue=Number.MIN_SAFE_INTEGER,y.maxValue=Number.MAX_SAFE_INTEGER,y.categoryCollection=["All"],y.dependencyLevel=0,y.refreshedCells=new Map,y.computedValues=null,y.randomValues=new Map,y.isRandomVal=!1,y.randCollection=[],y.dependencyCollection=[],y.uniqueRange=[],y.formulaErrorStrings=["binary operators cannot start an expression","cannot parse","bad library","invalid char in front of","number contains 2 decimal points","expression cannot end with an operator","invalid characters following an operator","invalid character in number","mismatched parentheses","unknown formula name","requires a single argument","requires 3 arguments","invalid Math argument","requires 2 arguments","#NAME?","too complex","circular reference: ","missing formula","improper formula","invalid expression","cell empty","bad formula","empty expression","","mismatched string quotes","wrong number of arguments","invalid arguments","iterations do not converge","Control is already registered","Calculation overflow","Missing sheet","cannot_parse","expression_cannot_end_with_an_operator","#SPILL!","#DIV/0!"],y.errorStrings=null,y.parseArgumentSeparator=",",y.dateTime1900=new Date(1900,0,1,0,0,0),y.isParseDecimalSeparatorChanged=!1,y.isArgumentSeparatorChanged=!1,y.sheetFamilyID=0,y.defaultFamilyItem=null,y.sheetFamiliesList=null,y.modelToSheetID=null,y.tokenCount=0,y.sortedSheetNames=null,y.tempSheetPlaceHolder=String.fromCharCode(133),y.namedRanges=new Map,y.formulaInfoTable=null,y.oaDate=new Date(1899,11,30),y.millisecondsOfaDay=24*60*60*1e3,y.parseDateTimeSeparator="/";var A=new re(y);return y.includeBasicFormulas&&x.Inject(Ie),y.injectedModules&&y.injectedModules.length&&A.inject(y.requiredModules(),y.injectedModules),y.parentObject=(0,P.le)(v)?y:v,y.grid=y.parentObject,y.parser=new Se(y),y}x=m,Object.defineProperty(m.prototype,"libraryFormulas",{get:function(){return this.lFormulas},set:function(v){this.lFormulas.set(v.fName,{handler:v.handler,category:v.category,description:v.description})},enumerable:!0,configurable:!0}),m.prototype.getParseArgumentSeparator=function(){var v=",";return!this.isArgumentSeparatorChanged&&v!==this.parseArgumentSeparator&&(this.parseArgumentSeparator=v),this.parseArgumentSeparator},m.prototype.setParseArgumentSeparator=function(v){this.parseArgumentSeparator=v,this.isArgumentSeparatorChanged=!0},m.prototype.getParseDateTimeSeparator=function(){return this.parseDateTimeSeparator},m.prototype.setTreatEmptyStringAsZero=function(v){this.treatEmptyStringAsZero=v},m.prototype.getTreatEmptyStringAsZero=function(){return this.treatEmptyStringAsZero},m.prototype.setParseDateTimeSeparator=function(v){this.parseDateTimeSeparator=v},m.prototype.requiredModules=function(){return a(this)},m.Inject=function(){for(var v=[],y=0;y<arguments.length;y++)v[y]=arguments[y];this.prototype.injectedModules||(this.prototype.injectedModules=[]);for(var A=0;A<v.length;A++)this.prototype.injectedModules.indexOf(v[A])===-1&&this.prototype.injectedModules.push(v[A])},m.prototype.getInjectedModules=function(){return this.injectedModules},m.prototype.onPropertyChanged=function(v,y){},m.prototype.getModuleName=function(){return"calculate"},m.prototype.getFormulaCharacter=function(){return"="},m.prototype.isUpperChar=function(v){var y=v.charCodeAt(0);return y>64&&y<91},m.prototype.resetKeys=function(){this.storedData.clear(),this.keyToRowsMap.clear(),this.rowsToKeyMap.clear()},m.prototype.updateDependentCell=function(v){var y=this.getSheetFamilyItem(this.grid),A=this.cell;if(A!==this.emptyString){if(y.sheetNameToParentObject!==null){var I=y.parentObjectToToken.get(this.grid);A.indexOf(this.sheetToken)===-1&&(A=I+A),v.indexOf(this.sheetToken)===-1&&(v=I+v)}if(this.getDependentCells().has(v)){var N=this.getDependentCells().get(v);N.indexOf(A)<0&&A!==v&&N.push(A)}else this.getDependentCells().set(v,[A]);this.addToFormulaDependentCells(v)}},m.prototype.addToFormulaDependentCells=function(v){var y=this.cell,A=this.getSheetFamilyItem(this.grid);if(A.sheetNameToParentObject!=null&&y.indexOf(this.sheetToken)===-1){var I=A.parentObjectToToken.get(this.grid);y=I+y}this.getDependentFormulaCells().has(y)?this.getDependentFormulaCells().get(y).has(v)||this.getDependentFormulaCells().get(y).set(v,v):(this.getDependentFormulaCells().set(y,new Map),this.getDependentFormulaCells().get(y).set(v,v))},m.prototype.getDependentCells=function(){if(this.isSheetMember()){var v=this.getSheetFamilyItem(this.grid);return v.sheetDependentCells==null&&(v.sheetDependentCells=new Map),v.sheetDependentCells}else return this.dependentCells==null&&(this.dependentCells=new Map),this.dependentCells},m.prototype.getDependentFormulaCells=function(){if(this.isSheetMember()){var v=this.getSheetFamilyItem(this.grid);return v.sheetDependentFormulaCells==null&&(v.sheetDependentFormulaCells=new Map),v.sheetDependentFormulaCells}else return this.dependentFormulaCells==null&&(this.dependentFormulaCells=new Map),this.dependentFormulaCells},m.prototype.getLibraryFormulas=function(){return this.lFormulas},m.prototype.getFunction=function(v){return this.getLibraryFormulas().has(v.toUpperCase())?this.getLibraryFormulas().get(v.toUpperCase()).handler:null},m.prototype.intToDate=function(v){var y=Number(v);return y=y>0&&y<1?1+y:y===0?1:y,y>60&&(y-=1),new Date((y-1)*(1e3*3600*24)+new Date("01/01/1900").getTime())},m.prototype.getFormulaInfoTable=function(){if(this.isSheetMember()){var v=this.getSheetFamilyItem(this.grid);return v.sheetFormulaInfotable===null&&(v.sheetFormulaInfotable=new Map),v.sheetFormulaInfotable}else return this.formulaInfoTable===null&&(this.formulaInfoTable=new Map),this.formulaInfoTable},m.prototype.getFormula=function(v){return v=v.toUpperCase(),this.storedData.has(v)?this.storedData.get(v).getFormulaText():""},m.prototype.getParseDecimalSeparator=function(){var v=".";return!this.isParseDecimalSeparatorChanged&&v!==this.parseDecimalSeparator&&(this.parseDecimalSeparator=v),this.parseDecimalSeparator},m.prototype.setParseDecimalSeparator=function(v){this.parseDecimalSeparator=v,this.isParseDecimalSeparatorChanged=!0},m.prototype.getSheetToken=function(v){var y=0,A=this.emptyString;if(y<v.length&&v[y]===this.sheetToken){for(y++;y<v.length&&v[y]!==this.sheetToken;)y++;A=v.substring(0,y+1)}if(y<v.length)return A;throw this.formulaErrorStrings[Y.bad_index]},m.prototype.getSheetID=function(v){var y=this.getSheetFamilyItem(v);if(y.sheetNameToParentObject!=null&&y.sheetNameToParentObject.size>0){var A=y.parentObjectToToken.get(v);if(A){A=A.split(this.sheetToken).join(this.emptyString);var I=this.parseFloat(A);if(!this.isNaN(I))return I}}return-1},m.prototype.parseFloat=function(v){var y=Number(v);return isNaN(y)&&typeof v=="string"&&v.includes(",")&&(y=Number(v.split(",").join(""))),y},m.prototype.rowIndex=function(v){var y=0,A=!1;if(y<v.length&&v[y]===this.sheetToken){for(y++;y<v.length&&v[y]!==this.sheetToken;)y++;y++}for(;y<v.length&&this.isChar(v[y]);)A=!0,y++;var I=parseInt(v.substring(y),10);if(y<v.length&&!this.isNaN(I))return I;if(A)return-1;throw this.formulaErrorStrings[Y.bad_index]},m.prototype.colIndex=function(v){var y=0,A=0;if(v=v.toUpperCase(),y<v.length&&v[y]===this.sheetToken){for(y++;y<v.length&&v[y]!==this.sheetToken;)y++;y++}for(;y<v.length&&this.isChar(v[y]);){var I=v[y].charCodeAt(0);A=A*26+I-64,y++}return A===0?-1:A},m.prototype.getErrorStrings=function(){return this.errorStrings===null&&(this.errorStrings=["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"]),this.errorStrings},m.prototype.substring=function(v,y,A){return v.substring(y,A+y)},m.prototype.isChar=function(v){return v.charCodeAt(0)>=65&&v.charCodeAt(0)<=90||v.charCodeAt(0)>=97&&v.charCodeAt(0)<=122},m.prototype.getSheetFamilyItem=function(v){if(this.sheetFamilyID===0)return this.defaultFamilyItem==null&&(this.defaultFamilyItem=new T),this.defaultFamilyItem;this.sheetFamiliesList==null&&(this.sheetFamiliesList=new Map);var y=this.modelToSheetID.get(v);return this.sheetFamiliesList.has(y)||this.sheetFamiliesList.set(y,new T),this.sheetFamiliesList.get(y)},m.prototype.setKeyValue=function(v,y){v=v.toUpperCase();var A=y.toString().trim();(!this.storedData.get(v)||A.indexOf(this.leftBrace)===0)&&(this.storedData.set(v,new M),this.keyToRowsMap.set(v,this.keyToRowsMap.size+1),this.rowsToKeyMap.set(this.rowsToKeyMap.size+1,v));var I=this.storedData.get(v);if(I.getFormulaText()!=null&&I.getFormulaText().length>0&&I.getFormulaText()!==A){var N=this.cellPrefix+this.keyToRowsMap.get(v).toString(),z=this.getDependentFormulaCells().get(N);z!=null&&this.clearFormulaDependentCells(N)}A.length>0&&A[0]===this.getFormulaCharacter()?I.setFormulaText(A):I.getFormulaValue()!==A&&(I.setFormulaText(""),I.setParsedFormula(""),I.setFormulaValue(A))},m.prototype.clearFormulaDependentCells=function(v){var y=this,A=this.getDependentFormulaCells().get(v);A&&(A.forEach(function(I,N){var z=N,V=y.getDependentCells().get(z);y.arrayRemove(V,v),V.length===0&&y.getDependentCells().delete(z)}),this.getDependentFormulaCells().delete(v))},m.prototype.arrayRemove=function(v,y){var A=v.indexOf(y);return A!==-1&&v.splice(A,1),v},m.prototype.getKeyValue=function(v){if(v=v.toUpperCase(),this.storedData.has(v)!==null){var y=this.storedData.get(v),A=y.getFormulaText();if(A.length>0&&A[0]===this.getFormulaCharacter()){this.cell=this.cellPrefix+this.keyToRowsMap.get(v).toString(),A=A.substring(1);try{y.setParsedFormula(this.parser.parseFormula(A,v))}catch(z){var I={message:z.message,exception:z,isForceCalculable:!1,computeForceCalculate:!1};return this.trigger("onFailure",I),y.setFormulaValue(I.message),this.storedData.get(v).getFormulaValue()}try{y.setFormulaValue(this.computeFormula(y.getParsedFormula()))}catch(z){var I={message:z.message,exception:z,isForceCalculable:!1,computeForceCalculate:!1};this.trigger("onFailure",I);var N=typeof I.exception=="string"?I.exception:I.message;return((0,P.le)(this.getErrorLine(z))?"":"#"+this.getErrorLine(z)+": ")+N}}return this.storedData.get(v).getFormulaValue()}else return this.emptyString},m.prototype.getNamedRanges=function(){return this.namedRanges},m.prototype.addNamedRange=function(v,y){var A=v.split(this.sheetToken);if(A.length>1){var I=this.getSheetFamilyItem(this.grid);if(!I.parentObjectToToken.get(A[0]))return!1;v=A[0]+this.sheetToken+A[1].toUpperCase()}else v=v.toUpperCase();return this.namedRanges.set(v,y),!0},m.prototype.removeNamedRange=function(v){return v=v.toUpperCase(),this.namedRanges.get(v)!=null?(this.namedRanges.delete(v),!0):!1},m.prototype.convertAlpha=function(v){for(var y=[],A=0,I="A";v>0;){v--;var N=I.charCodeAt(0);y[A]=String.fromCharCode(v%26+N),v=parseInt((v/26).toString(),10),A++}for(var z=[],V=0;V<A;V++)z[A-V-1]=y[V];return z.join("")},m.prototype.getCellCollection=function(v){if(v.indexOf(":")<0)if(this.isCellReference(v))v=v+":"+v;else return v.split(this.getParseArgumentSeparator());var y=this.emptyString,A=v.indexOf(this.sheetToken);if(A>-1)for(var I=A,N=I+1;N<v.length;){if(v[N]===this.sheetToken){y=v.substr(0,N+1);break}N++}var z=v.indexOf(":"),V,_,G,K;if(z>0&&this.isChar(v[z-1]))for(var oe=z-2;oe>=0&&this.isDigit(v[oe]);)oe--;V=this.rowIndex(this.substring(v,0,z)),_=this.rowIndex(this.substring(v,z+1,z+v.length-z-1)),G=this.colIndex(this.substring(v,0,z)),K=this.colIndex(this.substring(v,z+1,z+v.length-z-1)),V>_&&(z=_,_=V,V=z),G>K&&(z=K,K=G,G=z);var he=[],ue,X=0;for(z=V;z<=_;z++)for(ue=G;ue<=K;ue++)he[X]=y+this.emptyString+this.convertAlpha(ue)+z.toString(),X++;return he},m.prototype.computeFormula=function(v){return this.calculateFormula(v,!1)},m.prototype.calculateFormula=function(v,y){var A=this,I,N,z,V=!1,_;if(this.parser.isError)return v;this.parser.isFormulaParsed?I=v:I=this.parser.parseFormula(v),this.parser.isFormulaParsed=!1;try{if(N=this.findLastIndexOfq(I),N>0&&(V=!0),I!==this.emptyString&&N>-1)for(var G=N+1;G>-1;){if(I[G]!==this.rightBracket){G++;continue}var K=I.substring(N,G+1),oe=K.split(this.leftBracket)[0].split("q").join(this.emptyString),he=void 0;if(this.getLibraryFormulas().get(oe.toUpperCase()).isCustom){he=K.substring(K.indexOf(this.leftBracket)+1,K.indexOf(this.rightBracket)).split(this.getParseArgumentSeparator());var ue=0,X=[],Ce=void 0;for(ue=0;ue<he.length;ue++)he[ue].includes(":")&&this.isCellReference(he[ue])?(Ce=this.getCellCollection(he[ue]),Ce.length>1?(X.push(he[ue]),Ce.forEach(function(pt){A.updateDependentCell(pt)})):X.push(this.getValueFromArg(he[ue]))):X.push(this.getValueFromArg(he[ue]));he=X}else{if(he=K.substring(K.indexOf(this.leftBracket)+1,K.indexOf(this.rightBracket)).replace(",n",",").split(this.getParseArgumentSeparator()),K.includes(this.getParseArgumentSeparator()+this.tic))for(var ze=null,We=0;We<he.length;We++)he[We]&&he[We][0]===this.tic&&he[We][he[We].length-1]!==this.tic&&(ze=We),ze!==null&&ze===We-1&&he[We][0]!==this.tic&&he[We][he[We].length-1]===this.tic&&(he[ze]=he[ze]+this.getParseArgumentSeparator()+he[We],he.splice(We,1),ze=null);V&&oe&&oe==="IF"&&he.push("nestedFormulaTrue")}if(z=(0,P.le)(this.getFunction(oe))?this.getErrorStrings()[F.name]:this.getFunction(oe).apply(void 0,he),V){_=this.processNestedFormula(I,K,z);var Xe=this.findLastIndexOfq(_);Xe===0&&(V=!1),Xe===-1&&(z=this.computeValue(_,y)),N=G=Xe,I=_;continue}break}else this.formulaErrorStrings.indexOf(I)>-1?z=I:I!==this.emptyString&&N===-1&&(z=this.computeValue(I,y))}catch(pt){var he={message:pt.message,exception:pt,isForceCalculable:!1,computeForceCalculate:!1};this.trigger("onFailure",he);var tt=typeof he.exception=="string"?he.exception:he.message;z=((0,P.le)(this.getErrorLine(pt))?"":"#"+this.getErrorLine(pt)+": ")+tt}return z},m.prototype.computeSumIfAndAvgIf=function(v){if((0,P.le)(v)||v[0]===this.emptyString||v.length===0)return this.formulaErrorStrings[Y.wrong_number_arguments];for(var y=v,A=0;A<y.length;A++)if(this.isCellReference(y[A])&&(0,P.le)(y[A].match(/[0-9]/))&&y[A].indexOf("!")<0){var I=y[A].split(":");y[A]=I[0]+"1:"+I[1]+this.spreadSheetUsedRange[0]}var N=y.length;if(N!==2&&N!==3&&N===0)return this.formulaErrorStrings[Y.wrong_number_arguments];var z=y[0],V=y[1].trim();if(V=V.split(this.tic).join(this.emptyString),V.length>255)return this.getErrorStrings()[F.value];var _=V.includes("*"),G=_?V.replace(/\*/g,"").trim():V;G=this.isCellReference(G)?this.getValueFromArg(G):V,_&&(V[0]==="*"&&(G="*"+G),V[V.length-1]==="*"&&(G+="*")),V=G;var K=this.parser.tokenEqual;V.startsWith("<=")?(K=this.parser.tokenLessEq,V=V.substring(2)):V.startsWith(">=")?(K=this.parser.tokenGreaterEq,V=V.substring(2)):V.startsWith("<>")?(K=this.parser.tokenNotEqual,V=V.substring(2)):V.startsWith("<")?(K=this.parser.tokenLess,V=V.substring(1)):V.startsWith(">")?(K=this.parser.tokenGreater,V=V.substring(1)):V.startsWith("=")&&(K=this.parser.tokenEqual,V=V.substring(1));var oe=this.parseFloat(V),he=y[0],ue=this.getCellCollection(N>2?y[2]:z),X=this.getCellCollection(he);if(X.length>ue.length){var Ce=this.colIndex(ue[ue.length-1])+this.colIndex(X[X.length-1])-this.colIndex(X[0]),ze=y[2].split(":");ze[1]=(this.convertAlpha(Ce)+this.rowIndex(X[X.length-1])).toString(),ue=this.getCellCollection(ze.join(":"))}var We=this.getComputeSumIfValue(X,ue,V,oe,K,_);return[We[0],We[1]]},m.prototype.findWildCardValue=function(v,y){var A="";if(v.indexOf("?")>-1){var I=v.indexOf("?"),N=v[I-1],z=v[I+1];if(y.indexOf(N)>-1&&y.indexOf(z)>-1){var V=y.indexOf(N);y[V]===N&&y[V+2]===z?A=v:A=y}else A=y}else if(v.indexOf("*")>-1){for(var I=v.indexOf("*"),_="",G="",K=this.falseValue,oe=this.falseValue,he=I-1;he>=0;he--)_=_+v[he],oe=this.trueValue;for(var he=I+1;he<v.length;he++)G=G+v[he],K=this.trueValue;var ue=_===""?-1:y.indexOf(_.split("").reverse().join("")),X=G===""?-1:y.indexOf(G);ue>-1||X>-1?oe===this.trueValue?A=_.split("").reverse().join("")===y.substr(0,_.length)?v:y:K===this.trueValue&&(A=G===y.substring(y.length-G.length,y.length)?v:y):A=y}return A},m.prototype.getComputeSumIfValue=function(v,y,A,I,N,z){var V=0,_=0;switch(N){case this.parser.tokenEqual:for(var G=z?A.replace(/\*/g,""):A,K=0;K<v.length;K++){var oe=this.getValueFromArg(v[K].split(this.tic).join("")),he=this.parseFloat(oe);if(oe===A&&he===I){var ue=this.getValueFromArg(y[K].split(this.tic).join("")),X=this.parseFloat(ue);V=V+X,_=_+1}else oe===A?(V=V+this.getValueFromRange(y,K),_=_+1):z&&G&&oe&&(A[0]==="*"&&G.length<=oe.length&&G===oe.slice(0,G.length)&&(V=V+this.getValueFromRange(y,K),_=_+1),A[A.length-1]==="*"&&G.length<=oe.length&&G===oe.slice(oe.length-G.length,oe.length)&&(V=V+this.getValueFromRange(y,K),_=_+1))}break;case this.parser.tokenLess:for(var K=0;K<v.length;K++){var oe=this.getValueFromArg(v[K].split(this.tic).join("")),he=this.parseFloat(oe);if(he<I){var ue=this.getValueFromArg(y[K].split(this.tic).join("")),X=this.parseFloat(ue);V=V+X,_=_+1}}break;case this.parser.tokenGreater:for(var K=0;K<v.length;K++){var oe=this.getValueFromArg(v[K].split(this.tic).join("")),he=this.parseFloat(oe);if(he>I){var ue=this.getValueFromArg(y[K].split(this.tic).join("")),X=this.parseFloat(ue);V=V+X,_=_+1}}break;case this.parser.tokenLessEq:for(var K=0;K<v.length;K++){var oe=this.getValueFromArg(v[K].split(this.tic).join("")),he=this.parseFloat(oe);if(he<=I){var ue=this.getValueFromArg(y[K].split(this.tic).join("")),X=this.parseFloat(ue);V=V+X,_=_+1}}break;case this.parser.tokenGreaterEq:for(var K=0;K<v.length;K++){var oe=this.getValueFromArg(v[K].split(this.tic).join("")),he=this.parseFloat(oe);if(he>=I){var ue=this.getValueFromArg(y[K].split(this.tic).join("")),X=this.parseFloat(ue);V=V+X,_=_+1}}break;case this.parser.tokenNotEqual:for(var K=0;K<v.length;K++){var oe=this.getValueFromArg(v[K].split(this.tic).join("")),he=this.parseFloat(oe);if(oe!==A&&he!==I){var ue=this.getValueFromArg(y[K].split(this.tic).join("")),X=this.parseFloat(ue);V=V+X,_=_+1}}break}return[V,_]},m.prototype.getValueFromRange=function(v,y){var A=v[y];return A=this.getValueFromArg(A),this.parseFloat(A.toString())},m.prototype.computeAndOr=function(v,y){var A=y==="and",I,N;if(v.length===0)return this.formulaErrorStrings[Y.wrong_number_arguments];for(var z=0,V=v.length;z<V;z++)if(v[z].split(this.tic).join("").trim()===this.emptyString)return this.getErrorStrings()[F.value];for(var _=v,G=0;G<_.length;G++){if(_[G]===this.tic)return this.getErrorStrings()[F.value];if(_[G].indexOf(":")>-1&&this.isCellReference(_[G]))for(var K=this.getCellCollection(_[G]),oe=0;oe<K.length;oe++){if(this.getErrorStrings().indexOf(K[oe])>-1)return K[oe];if(K[oe][0]===this.tic)return this.getErrorStrings()[F.name];if(I=this.getValueFromArg(K[oe]),I===""&&(I=this.trueValue),this.getErrorStrings().indexOf(I)>-1)return I;N=this.parseFloat(I)}else{if(I=this.getValueFromArg(_[G]).split(this.tic).join("").toUpperCase(),this.getErrorStrings().indexOf(I)>-1)return I;var he=Date.parse(I.split(this.tic).join(""));if(!isNaN(he))A=!0;else if(!(I===this.trueValue||I===this.falseValue))return this.getErrorStrings()[F.value].toString();N=this.parseFloat(I)}A=y==="and"?A&&(I===this.trueValue||!isNaN(N)):A||I===this.trueValue||!isNaN(N)}return A?this.trueValue:this.falseValue},m.prototype.removeTics=function(v){return v.length>1&&v[0]===this.tic[0]&&v[v.length-1]===this.tic[0]&&(v=this.substring(v,1,v.length-2)),v},m.prototype.getCellFrom=function(v){var y="",A=v.indexOf(":")>-1?v.split(":"):[v],I=A.length-1,N=this.rowIndex(A[0]),z;if(N===this.rowIndex(A[I])){var V=this.colIndex(A[0]),_=this.colIndex(A[I]),G=this.colIndex(this.cell);G>=V&&G<=_&&(y=b(G).toString()+N.toString())}else if(this.colIndex(A[0])===this.colIndex(A[I])){z=this.colIndex(A[0]);var K=this.rowIndex(A[I]),oe=this.rowIndex(this.cell);oe>=N&&oe<=K&&(y=b(z).toString()+oe.toString())}return y},m.prototype.computeValue=function(v,y){try{var A=[],I=0,N="";for(A.length=0;I<v.length;){var z=v[I]==="u";if(v[I]===this.arithMarker){I=I+1;continue}else if(this.isDigit(v[I])){for(var V=this.emptyString;I<v.length&&(this.isDigit(v[I])||v[I]===this.parseDecimalSeparator);)V=V+v[I],I=I+1;if(A.push(V),!v[I])return A.toString()}if(v[I]===this.sheetToken){for(N=v[I],I=I+1;I<v.length&&v[I]!==this.sheetToken;)N=N+v[I],I=I+1;I<v.length&&(N=N+v[I],I=I+1)}else if(this.isUpperChar(v[I])){for(var V=this.emptyString,_="";I<v.length&&this.isUpperChar(v[I]);){var G=v[I];V=V+G,I=I+1}for(;I<v.length&&this.isDigit(v[I]);){var K=v[I];V=V+K,I=I+1}if(I<v.length&&v[I]===":"){if(V=V+v[I],I=I+1,I<v.length&&v[I]===this.sheetToken)for(V=V+v[I],I=I+1;I<v.length&&v[I]!==this.sheetToken;)V=V+v[I],I=I+1;for(;I<v.length&&this.isUpperChar(v[I]);)V=V+v[I],I=I+1;for(;I<v.length&&this.isDigit(v[I]);)V=V+v[I],I=I+1;V=N+this.getCellFrom(V)}else V=N+V;if(_=this.getParentObjectCellValue(V,y).toString(),N="",typeof _=="string"&&this.getErrorStrings().indexOf(_)>-1)return _;A.push(_)}else if(v[I]==="q"){var oe=v.substring(I+1).indexOf(this.leftBracket),he=v.substring(I+oe+1).indexOf(this.rightBracket);v=this.substring(v,I+oe+2,he-1)}else if(v[I]===this.tic[0]){var V=v[I].toString();for(I=I+1;I<v.length&&v[I]!==this.tic[0];)V=V+v[I],I=I+1;A.push(V.split(this.tic).join(this.emptyString)),I=I+1}else if(v[I]==="%"&&A.length>0){var ue=A[0],X=this.parseFloat(ue);this.isNaN(X)||(A.pop(),A.push((X/100).toString())),I=I+1}else if(v.substring(I).indexOf(this.trueValue)===0)A.push(this.trueValue),I+=this.trueValue.length;else if(v.substring(I).indexOf(this.falseValue)===0)A.push(this.falseValue),I+=this.falseValue.length;else if(v[I]===this.tic[0]||v[I]==="|"){var V=v[I].toString();for(I++;I<v.length&&v[I]!==this.tic[0];)V=V+v[I],I=I+1;A.push(V+this.tic),I+=1}else switch(v[I]){case"#":{var Ce=0;this.getErrorStrings().indexOf(v.substring(I))>-1?(v.indexOf("!")===-1||v.substring(I).indexOf("!")===-1?Ce=v.indexOf("#N/A")>-1?v.indexOf("#N/A")+4+I:v.indexOf("?")+1+I:Ce=v.indexOf("!")+1+I,A.push(this.substring(v,I,Ce-I))):(Ce=I+1,A.push(this.substring(v,I,Ce-I))),I=Ce}break;case"n":{I=I+1;var V="";if(v.substring(I).indexOf("Infinity")===0)V="Infinity",I+=V.length;else{for((v[I]==="u"||z||v[I]==="-")&&(V="-",z?z=!1:I=I+1);I<v.length&&this.isDigit(v[I])||v[I]===this.getParseDecimalSeparator();)V=V+v[I],I=I+1;if(I<v.length&&v[I]==="%")if(I=I+1,V===""){if(A.length>0){var ue=A[0],X=this.parseFloat(ue);this.isNaN(X)||(A.pop(),A.push((X/100).toString()))}}else V=(this.parseFloat(V)/100).toString()}A.push(V)}break;case this.parser.tokenAdd:this.getValArithmetic(A,"add"),I=I+1;break;case this.parser.tokenSubtract:this.getValArithmetic(A,"sub"),I=I+1;break;case this.parser.tokenMultiply:this.getValArithmetic(A,"mul"),I=I+1;break;case this.parser.tokenDivide:this.getValArithmetic(A,"div"),I=I+1;break;case this.parser.tokenLess:this.processLogical(A,"less"),I=I+1;break;case this.parser.tokenGreater:this.processLogical(A,"greater"),I=I+1;break;case this.parser.tokenGreaterEq:this.processLogical(A,"greaterEq"),I=I+1;break;case this.parser.tokenLessEq:this.processLogical(A,"lessEq"),I=I+1;break;case this.parser.tokenNotEqual:this.processLogical(A,"notEq"),I=I+1;break;case this.parser.tokenOr:this.processLogical(A,"or"),I=I+1;break;case this.parser.tokenAnd:this.processLogical(A,"and"),I=I+1;break;case this.parser.tokenEqual:this.processLogical(A,"equal"),I=I+1;break;default:return this.getErrorStrings()[F.value]}}if(A.length===0)return this.emptyString;for(var V=this.emptyString,ze=A.length;ze>0;){if(V=A.pop()+V,V===this.emptyString&&this.isCellReference(v)&&this.getTreatEmptyStringAsZero())return"0";ze--}return V}catch(We){throw this.getErrorStrings().indexOf(We)>-1||this.formulaErrorStrings.indexOf(We)>-1?We:new d(this.formulaErrorStrings[Y.invalid_expression])}},m.prototype.getValArithmetic=function(v,y){var A=v.pop();A=A===this.emptyString?"0":A;var I=Number(A);if(isNaN(I))throw A===this.getErrorStrings()[F.divzero]?this.getErrorStrings()[F.divzero]:this.getErrorStrings()[F.value];var N=v.pop();if(N=N===this.emptyString?"0":N,I=Number(N),isNaN(I))throw A===this.getErrorStrings()[F.divzero]?this.getErrorStrings()[F.divzero]:this.getErrorStrings()[F.value];y==="add"&&v.push((Number(N)+Number(A)).toString()),y==="sub"&&v.push((Number(N)-Number(A)).toString()),y==="mul"&&v.push((Number(N)*Number(A)).toString()),y==="div"&&(this.isNaN(this.parseFloat(A))||this.isNaN(this.parseFloat(N))?v.push(this.getErrorStrings()[F.value]):this.parseFloat(A)===0?v.push(this.getErrorStrings()[F.divzero]):v.push((Number(N)/Number(A)).toString()))},m.prototype.processLogical=function(v,y){var A,I,N,z;y!=="and"&&y!=="equal"&&(A=v.pop(),I=v.pop(),N=A.indexOf(this.tic)>-1?A:this.parseFloat(A),z=I.indexOf(this.tic)>-1?I:this.parseFloat(I));var V;return y==="less"&&(!this.isNaN(N)&&!this.isNaN(z)?V=z<N?this.trueValue:this.falseValue:V=I.toUpperCase().split(this.tic).join("").localeCompare(A.toUpperCase().split(this.tic).join(""))<0?this.trueValue:this.falseValue),y==="greater"&&(!this.isNaN(N)&&!this.isNaN(z)?V=z>N?this.trueValue:this.falseValue:V=I.toUpperCase().split(this.tic).join("").localeCompare(A.toUpperCase().split(this.tic).join(""))>0?this.trueValue:this.falseValue),y==="lessEq"&&(!this.isNaN(N)&&!this.isNaN(z)?V=z<=N?this.trueValue:this.falseValue:V=I.toUpperCase().split(this.tic).join("").localeCompare(A.toUpperCase().split(this.tic).join(""))<=0?this.trueValue:this.falseValue),y==="greaterEq"&&(!this.isNaN(N)&&!this.isNaN(z)?V=z>=N?this.trueValue:this.falseValue:V=I.toUpperCase().split(this.tic).join("").localeCompare(A.toUpperCase().split(this.tic).join(""))>=0?this.trueValue:this.falseValue),y==="notEq"&&(V=I!==A?this.trueValue:this.falseValue),y==="and"&&(A=v.pop().toString(),I="",v.length>0&&(I=v.pop().toString()),V=this.emptyString+I+A+this.emptyString,V=V.split(this.tic).join("")),y==="equal"&&(A=v.pop().toString(),I=v.pop().toString(),I===""&&A!==""&&(I="0"),V=A===I?this.trueValue:this.falseValue),y==="or"&&(V=Math.pow(this.parseFloat(z),this.parseFloat(N)).toString()),v.push(V),V},m.prototype.computeStoreCells=function(v){for(var y=v.cellValue,A=v.cellRange,I=v.criteria,N=v.argArray,z=v.isCriteria,V=v.storedCells,_=v.isCountIfS,G=v.countVal,K=z===this.trueValue?V:y,oe=[],he=0;he<K.length;he++){var ue=[],X=this.getValueFromArg(y[he]),Ce=void 0,ze="";if(Ce=N[2].split(this.tic).join(this.emptyString),Ce=this.isCellReference(Ce)?this.getValueFromArg(Ce):Ce,z=_===this.trueValue?this.trueValue:z,z===this.trueValue){var We="",Xe=0,tt=0;for(V[he]=_===this.trueValue&&G===0?y[he]:V[he],We=V[he];!this.isDigit(We[Xe]);)Xe=Xe+1;if(this.isCellReference(A[G])&&A[G].indexOf(":")>-1){var pt=A[G].indexOf(":");for(ze=this.substring(A[G],pt);!this.isDigit(ze[tt]);)tt=tt+1}var st=this.substring(We,Xe),ht=this.substring(ze,tt);ze=V[he].split(st).join(ht),X=this.getValueFromArg(ze),Ce=_===this.trueValue?I[G].split(this.tic).join(this.emptyString):I[G-1].split(this.tic).join(this.emptyString)}var rt="equal";Ce.startsWith("<=")?(rt="lessEq",Ce=Ce.substring(2)):Ce.startsWith(">=")?(rt="greaterEq",Ce=Ce.substring(2)):Ce.startsWith("<>")?(rt="notEq",Ce=Ce.substring(2)):Ce.startsWith("<")?(rt="less",Ce=Ce.substring(1)):Ce.startsWith(">")?(rt="greater",Ce=Ce.substring(1)):Ce.startsWith("=")&&(rt="equal",Ce=Ce.substring(1)),(Ce.indexOf("*")>-1||Ce.indexOf("?")>-1)&&(X=this.findWildCardValue(Ce,X)),ue.push(X.toLowerCase()),ue.push(Ce.toLowerCase()),this.processLogical(ue,rt)===this.trueValue&&(z===this.falseValue?oe.push(y[he]):oe.push(ze))}return V=oe,oe=[],V},m.prototype.computeIfsFormulas=function(v,y,A){if((0,P.le)(v)||v[0]===""||v.length===0)return this.formulaErrorStrings[Y.wrong_number_arguments];var I=v,N=I.length;if(N<2||N>127)return this.formulaErrorStrings[Y.wrong_number_arguments];for(var z=[],V=[],_=[],G=0,K=0,oe=0;oe<I.length;oe++)I[oe].indexOf(":")>-1&&this.isCellReference(I[oe])?z.push(I[oe]):V.push(I[oe]);z=z.toString().split(",,").join(","),z=z.split(this.getParseArgumentSeparator());for(var he=[],oe=0;oe<z.length;oe++)he.push(this.getCellCollection(z[oe]).length);for(var ue=0;ue<he.length;ue++)if(he[ue]&&he[ue+1]&&he[ue]!==he[ue+1])return this.getErrorStrings()[F.value];var X,Ce;if(y===this.falseValue){Ce=this.falseValue,X=this.getCellCollection(z[1]);var ze={cellValue:X,cellRange:z,criteria:V,argArray:I,isCriteria:Ce,storedCells:_,isCountIfS:y};if(_=this.computeStoreCells(ze),G=_.length,G===0)return A===this.trueValue?this.getErrorStrings()[F.divzero]:0}for(var We=y===this.trueValue?0:2,oe=We;oe<z.length;oe++){Ce=this.trueValue,Ce=y===this.trueValue&&oe===0?this.falseValue:this.trueValue,X=this.getCellCollection(z[oe]);var ze={cellValue:X,cellRange:z,criteria:V,argArray:I,isCriteria:Ce,storedCells:_,isCountIfS:y,countVal:oe};if(_=this.computeStoreCells(ze),G=_.length,G===0)return 0}for(var Xe=0,ue=0;ue<_.length;ue++){var tt="",pt="",st=0,ht=0;for(tt=_[ue];!this.isDigit(tt[st]);)st=st+1;if(this.isCellReference(z[0])&&z[0].indexOf(":")>-1){var rt=z[0].indexOf(":");for(pt=this.substring(z[0],rt);!this.isDigit(pt[ht]);)ht=ht+1}var Et=this.substring(tt,st),Vt=this.substring(pt,ht);if(X=_[ue].split(Et).join(Vt),y===this.trueValue)K=K+1;else{Xe++;var ce=this.getValueFromArg(X);K=K+parseFloat(ce===""?"0":ce)}}return A===this.trueValue&&(K=K/Xe),K},m.prototype.processNestedFormula=function(v,y,A){var I=v.split(y).join("n"+A);return I},m.prototype.isNaN=function(v){return v.toString()==="NaN"||typeof v=="string"},m.prototype.fromOADate=function(v){var y=new Date;return y.setTime(v*this.millisecondsOfaDay+Date.parse(this.oaDate.toString())),y},m.prototype.getSerialDateFromDate=function(v,y,A){var I=0;v<1900&&(v+=1900);for(var N=!1;!N;){for(;y>12;)v++,y-=12;N=!0;for(var z=new Date(v,y,1,-1).getDate();A>z;)z=new Date(v,y,1,-1).getDate(),y++,A-=z,N=!1;A<1&&(y--,z=new Date(v,y,1,-1).getDate(),A=z-A)}var V=Date.parse(v.toString()+this.getParseDateTimeSeparator()+y.toString()+this.getParseDateTimeSeparator()+A.toString());return this.isNaN(V)||(I=this.toOADate(new Date(V))),I},m.prototype.intToTime=function(v){if((0,P.le)(v))return"";var y=v.toString().split(".");(0,P.le)(y[1])||(v=parseFloat(y[0]+1+"."+y[1])||v);var A=this.intToDate(v.toString()),I=new P.eC;return I.formatDate(A,{type:"time",skeleton:"medium",format:"h:mm:ss a"})},m.prototype.toOADate=function(v){var y=(v.getTime()-Date.parse(this.oaDate.toString()))/this.millisecondsOfaDay;return y},m.prototype.calculateDate=function(v){return this.parseFloat(v)<10?"0"+v:v},m.prototype.isTextEmpty=function(v){return v===null||v===""},m.prototype.isDigit=function(v){var y=v.charCodeAt(0);return y>47&&y<58},m.prototype.findLastIndexOfq=function(v){return v.lastIndexOf("q")},m.prototype.getValueFromArg=function(v,y){v=v.trim();var A=v,I=this.dateTime1900,N=A;if((0,P.le)(A)||this.isTextEmpty(A))return A;if(v[0]===this.tic||v[0]===this.singleTic)return I=this.isDate(v.split(this.tic).join("")),this.isNaN(this.parseFloat(v.split(this.tic).join("")))&&!(0,P.le)(I)&&!this.isNaN(I.getDate())&&this.dateTime1900<=I?this.toOADate(I).toString():v;if(v=v.split("u").join("-"),!this.isUpperChar(A[0])&&(this.isDigit(A[0])||A[0]===this.getParseDecimalSeparator()||A[0]==="-"||A[0]==="n"))return A[0]==="n"&&(A=A.substring(1),A.indexOf('"n')>-1&&(A=A.replace('"n','"'))),A;var z=["+","-","/","*",")",")","{"];if(this.parser.indexOfAny(A,z)===-1&&this.isUpperChar(A[0])||A[0]===this.sheetToken){if(A!==this.trueValue&&A!==this.falseValue&&this.isCellReference(A)){var V=this.getSheetFamilyItem(this.grid);if(V.sheetNameToParentObject!==null&&V.sheetNameToParentObject.size>0&&A.indexOf(this.sheetToken)===-1){var _=V.parentObjectToToken.get(this.grid);A=_+A}}if(A===this.cell){var G=this.getDependentCells().get(A);if(G!=null&&G.indexOf(A)>-1&&this.arrayRemove(G,A),this.getDependentFormulaCells().has(this.cell)||this.clearFormulaDependentCells(this.cell),!y)throw this.formulaErrorStrings[Y.circular_reference]+A}return N=this.getParentObjectCellValue(A,!1,y),this.updateDependentCell(A),N.toString()}return this.getErrorStrings().indexOf(v)>-1?v:this.computeValue(N.toString(),!1)},m.prototype.isDate=function(v){if(typeof v=="object"||Date.parse(v)!==null){var y=new Date(Date.parse(v));return y>=this.dateTime1900?y:null}else return null},m.prototype.isValidCellReference=function(v){var y=0,A=0,I=0,N=[89,71,69],z=this.emptyString;if(this.namedRanges.has(v))return!1;for(var V=0;V<v.length;V++)this.isChar(v[V])&&A++;if(z=v.substring(y,A),z.length<4){for(;I<z.length;)if(!(0,P.le)(z[I])&&z[I].charCodeAt(0)<N[I]){I++;continue}else{if((0,P.le)(z[I])&&I>0)break;return!1}var _=this.parseFloat(v.substring(A,v.length));if(_<1048576)return!0}return!1},m.prototype.parseDate=function(v){if(!this.isNaN(v)){if(v instanceof Date)return new Date(v);var y=parseInt(v,10);return y<0?this.getErrorStrings()[F.num]:y<=60?new Date(this.dateTime1900.getTime()+(y-1)*864e5):new Date(this.dateTime1900.getTime()+(y-2)*864e5)}return typeof v=="string"&&(v=new Date(v),!this.isNaN(v))?v:this.getErrorStrings()[F.value]},m.prototype.isCellReference=function(v){if(v===this.emptyString)return!1;v=v.trim(),v=this.setTokensForSheets(v);var y=this.getSheetToken(v),A=!1;y!==""&&(v=v.split(y).join(this.emptyString));var I=!1,N=!1;if(v.indexOf(":")!==v.lastIndexOf(":"))return!1;for(var z=v.split("").join(this.getParseArgumentSeparator()).split(this.getParseArgumentSeparator()),V=0;V<z.length;V++)if(this.isChar(z[V]))I=!0;else if(this.isDigit(z[V]))N=!0;else if(z[V]===":")I&&N&&(A=!0),I=!1,N=!1;else return!1;return v.indexOf(":")>-1&&v.indexOf(this.tic)===-1?A&&I&&N?!0:!!((I&&!N||!I&&N)&&!A):!!(I&&N&&v.indexOf(this.tic)===-1)},m.prototype.setTokensForSheets=function(v){var y=this.getSheetFamilyItem(this.grid),A=this.getSortedSheetNames();if(A!=null)for(var I=0;I<A.length;I++){var N=y.sheetNameToToken.get(A[I]);N=N.split(this.sheetToken).join(this.tempSheetPlaceHolder);var z=this.singleTic+"SHEET"+A[I]+this.singleTic+this.sheetToken;v.indexOf(z)===-1&&(z="SHEET"+A[I]+this.sheetToken),v=v.split(z).join(N),z=A[I]+this.sheetToken,v=v.split(z).join(N)}if(v=v.split(this.tempSheetPlaceHolder).join(this.sheetToken),v.indexOf("!!")>-1){v=v.replace("!!","!");var V=v.split("");V[1]=(parseInt(V[1],10)+1).toString(),v=V.join("")}return v},m.prototype.getParentObjectCellValue=function(v,y,A){if(v===this.trueValue||v===this.falseValue)return v;var I=v.lastIndexOf(this.sheetToken),N=0,z=0,V=this.grid,_=this.getSheetFamilyItem(V);if(I>-1&&_.tokenToParentObject!==null)this.grid=_.tokenToParentObject.get(v.substring(0,I+1)),N=this.rowIndex(v),z=this.colIndex(v);else if(I===-1){for(var G=0;G<v.length&&this.isChar(v[G]);)G++;if(G===v.length)return v=v.toLowerCase(),v===""?this.getErrorStrings()[F.value]:this.getErrorStrings()[F.name];N=this.rowIndex(v),z=this.colIndex(v),_.isSheetMember&&_.parentObjectToToken!=null&&(v=_.parentObjectToToken.get(this.grid)+v)}var K=this.cell===""||this.cell===null?"":this.cell;if(this.cell=v,K===this.cell&&!A)throw this.formulaErrorStrings[Y.circular_reference];var oe=this.getParentCellValue(N,z,this.grid,K,V,y,A);return this.grid=V,this.cell=K,oe},m.prototype.getParentCellValue=function(v,y,A,I,N,z,V){var _,G=this.getSheetId(A);if(this.parentObject.getValueRowCol===void 0)_=this.getValueRowCol(G,v,y);else return I&&(I=N===A?"":I+","+(N&&typeof N=="string"&&Number(N)>-1?N:this.getSheetID(N))),_=this.parentObject.getValueRowCol(G,v,y,I,z,V),(0,P.le)(_)?this.emptyString:_.toString();return(_===""||_===void 0)&&(_=""),_},m.prototype.getSheetId=function(v){return v&&typeof v=="string"&&Number(v)>-1?Number(v):this.getSheetID(v)+1},m.prototype.getValueRowCol=function(v,y,A){var I=this.rowsToKeyMap.get(y).toString(),N=this.getKeyValue(I).toString();if(N!=null&&N[N.length-1]==="%"&&N.length>1){var z=this.parseFloat(N.substring(0,N.length-1));this.isNaN(z)&&(N=(Number(z)/100).toString())}return N},m.prototype.defineFunction=function(v,y){typeof y=="string"&&(y=(0,P.NA)(y,window)),v=v.toUpperCase(),this.libraryFormulas.set(v,{handler:y,isCustom:!0})},m.prototype.valueChanged=function(v,y,A,I,N,z){var V=v;this.spreadSheetUsedRange=I,this.grid=v;var _=!0,G=!0,K=this.getSheetFamilyItem(V),oe=b(y.getColIndex())+y.getRowIndex().toString();if(this.actCell=z+"!"+oe,K.sheetNameToParentObject!==null&&K.sheetNameToParentObject.size>0){var he=K.parentObjectToToken.get(V);oe=he+oe}var ue=y.getValue().toUpperCase();if(ue.indexOf("=RAND()")>-1||ue.indexOf("RAND()")>-1||ue.indexOf("=RANDBETWEEN(")>-1||ue.indexOf("RANDBETWEEN(")>-1||this.randomValues.has(oe)){var X=this.randCollection.toString();this.randomValues.has(oe)?this.randomValues.has(oe)&&(ue.indexOf("=RAND()")>-1||ue.indexOf("RAND()")>-1||ue.indexOf("=RANDBETWEEN(")>-1||ue.indexOf("RANDBETWEEN(")>-1?this.randomValues.set(oe,y.getValue()):y.getValue().toUpperCase()!==this.randomValues.get(oe.toUpperCase())&&(this.randomValues.delete(oe),X=X.split(oe+this.parseArgumentSeparator).join("").split(this.parseArgumentSeparator+oe).join("").split(oe).join(""),this.randCollection=X.split(this.parseArgumentSeparator)),this.randomValues.size===0&&this.randCollection.length&&(this.isRandomVal=!1,this.randomValues.clear(),this.randCollection=[])):(this.randomValues.set(oe,y.getValue()),this.randCollection.push(oe),this.isRandomVal=!0)}if(y.getValue()&&y.getValue()[0]===this.getFormulaCharacter()){this.cell=oe;var Ce=void 0;if((0,P.le)(G)||(G=A),this.getFormulaInfoTable().has(oe)){if(Ce=this.getFormulaInfoTable().get(oe),y.getValue()!==Ce.getFormulaText()||Ce.getParsedFormula()==null){Ce.setFormulaText(y.getValue()),this.getDependentFormulaCells().has(this.cell)&&this.clearFormulaDependentCells(this.cell);try{Ce.setParsedFormula(this.parser.parseFormula(y.getValue()))}catch(We){Ce.setFormulaValue(We),G=!1}}if(G){this.parser.isFormulaParsed=!0;var ze=this.calculateFormula(Ce.getParsedFormula(),N);_=ze!==Ce.getFormulaValue(),Ce.setFormulaValue(ze)}}else{Ce=new M,Ce.setFormulaText(y.getValue()),this.getDependentFormulaCells().has(oe)||this.getDependentFormulaCells().set(oe,new Map);try{Ce.setParsedFormula(this.parser.parseFormula(y.getValue()))}catch(We){Ce.setFormulaValue(We),G=!1}G&&Ce.setFormulaValue(this.calculateFormula(Ce.getParsedFormula(),N)),this.getFormulaInfoTable().has(oe)?this.getFormulaInfoTable().set(oe,Ce):this.getFormulaInfoTable().set(oe,Ce)}G&&(this.parentObject.setValueRowCol===void 0?this.setValueRowCol(this.getSheetID(V)+1,Ce.getFormulaValue(),y.getRowIndex(),y.getColIndex()):this.parentObject.setValueRowCol(this.getSheetId(V),Ce.getFormulaValue(),y.getRowIndex(),y.getColIndex(),Ce.getFormulaText()))}else this.getFormulaInfoTable().has(oe)&&(this.getFormulaInfoTable().delete(oe),this.getDependentFormulaCells().has(oe)&&this.clearFormulaDependentCells(oe));G&&_&&this.getDependentCells().has(oe)&&this.getDependentCells().get(oe).toString()!==oe&&(this.getComputedValue().clear(),this.refresh(oe))},m.prototype.getComputedValue=function(){return this.computedValues===null&&(this.computedValues=new Map),this.computedValues},m.prototype.setValueRowCol=function(v,y,A,I){},m.prototype.getSortedSheetNames=function(){var v=this.getSheetFamilyItem(this.grid);if(v!=null&&v.sheetNameToToken!=null){var y=[];v.sheetNameToToken.forEach(function(A,I){y.push(I),y.sort()}),this.sortedSheetNames=y,this.sortedSheetNames.sort(),this.sortedSheetNames.length>9&&this.sortedSheetNames[0].includes("1")&&this.sortedSheetNames[1].includes("10")&&(this.sortedSheetNames.splice(this.sortedSheetNames.indexOf("2"),0,this.sortedSheetNames[0]),this.sortedSheetNames.splice(0,1))}return this.sortedSheetNames},m.prototype.getErrorLine=function(v){var y=v.stack?v.stack.split(`
`)[1].split(":"):null;return y?y[y.length-2]:null},m.prototype.createSheetFamilyID=function(){return this.sheetFamilyID===Number.MAX_SAFE_INTEGER&&(this.sheetFamilyID=Number.MIN_SAFE_INTEGER),this.sheetFamilyID++},m.prototype.computeMinMax=function(v,y){var A,I,N=0;if((0,P.le)(v)||v.length===0)return this.formulaErrorStrings[Y.wrong_number_arguments];for(var z=0,V=v.length;z<V;z++)if(v[z].split(this.tic).join("").trim()===this.emptyString)return this.getErrorStrings()[F.value];A=y==="max"?this.minValue:this.maxValue;var _=v;if(_.length>255)return this.getErrorStrings()[F.value];for(var G=0;G<_.length;G++)if(_[G].indexOf(":")>-1&&this.isCellReference(_[G]))for(var K=this.getCellCollection(_[G]),oe=0;oe<K.length;oe++){if(I=this.getValueFromArg(K[oe]),this.getErrorStrings().indexOf(I)>-1)return I;var he=this.parseFloat(I);if(I===""||this.isNaN(this.parseFloat(he))){N=N+1,N===K.length&&(A=0);continue}else A=y==="max"?Math.max(A,he):Math.min(A,he)}else{var ue=this.getValueFromArg(_[G])||"0";if(this.getErrorStrings().indexOf(ue)>-1)return ue;var he=this.isNaN(this.parseFloat(ue))?0:this.parseFloat(ue);A=y==="max"?Math.max(A,he):Math.min(A,he)}return A.toString()},m.prototype.calculateAvg=function(v){for(var y=0,A=v,I=[],N=0,z=0,V=0,_=0;_<A.length;_++)if(A[_].indexOf(":")>-1&&this.isCellReference(A[_])){z=0,I=this.getCellCollection(A[_]),N=0;for(var G=0;G<I.length;G++){var K=this.getValueFromArg(I[G]);(0,P.le)(K)||isNaN(this.parseFloat(K))||(N=N+this.parseFloat(K),z=z+1)}if(z===0)return this.getErrorStrings()[F.divzero];N=N/z,y=N+y}else{if(A[_].indexOf(this.tic)>-1&&isNaN(parseFloat(A[_].split(this.tic).join(""))))return this.getErrorStrings()[F.value];A[_].length===0&&(A[_]="1");var K=this.getValueFromArg(A[_].split(this.tic).join(""));if((0,P.le)(K)||isNaN(this.parseFloat(K)))return this.getErrorStrings()[F.name];y=y+this.parseFloat(K)}return(y/(A.length-V)).toString()},m.prototype.registerGridAsSheet=function(v,y,A){(0,P.le)(this.modelToSheetID)&&(this.modelToSheetID=new Map),(0,P.le)(this.modelToSheetID.get(y))&&this.modelToSheetID.set(y,A);var I=this.getSheetFamilyItem(y);I.isSheetMember=!0;var N=v.toUpperCase();if(I.parentObjectToToken.size===0&&(I.parentObjectToToken=new Map),I.sheetNameToParentObject.size===0&&(I.sheetNameToParentObject=new Map),I.sheetNameToToken.size===0&&(I.sheetNameToToken=new Map),I.tokenToParentObject.size===0&&(I.tokenToParentObject=new Map),(0,P.o8)(I.sheetNameToParentObject.get(N))){var z=this.sheetToken+this.tokenCount.toString()+this.sheetToken;this.tokenCount++,I.tokenToParentObject.set(z,y),I.parentObjectToToken.set(y,z),I.sheetNameToToken.set(N,z),I.sheetNameToParentObject.set(N,y)}else{var z=I.sheetNameToToken.get(N);I.tokenToParentObject.set(z,y),I.parentObjectToToken.set(y,z)}return v},m.prototype.unregisterGridAsSheet=function(v,y,A){var I=this,N=[y];A&&(N=[],(0,P.le)(this.modelToSheetID)||this.modelToSheetID.forEach(function(z,V){N.push(V)})),N.forEach(function(z){var V=I.getSheetFamilyItem(z),_=(A?z:v).toUpperCase();if(V.sheetNameToParentObject!=null&&V.sheetNameToParentObject.has(_)){V.sheetNameToParentObject.delete(_);var G=V.sheetNameToToken.get(_);V.sheetNameToToken.delete(_),V.tokenToParentObject.delete(G),V.parentObjectToToken.delete(z),A&&(V.sheetDependentCells=new Map)}})},m.prototype.computeExpression=function(v){var y=this.parser.parseFormula(v),A=this.computeFormula(y);return A},m.prototype.isSheetMember=function(){var v=this.getSheetFamilyItem(this.grid);return(0,P.le)(v)?!1:v.isSheetMember},m.prototype.dispose=function(){this.resetKeys(),this.namedRanges.clear(),this.lFormulas.clear()},m.prototype.refreshRandValues=function(v){var y,A,I,N="",z=this.randCollection.toString(),V;this.randomValues.has(v)&&(this.randomValues.delete(v),z=z.split(v+this.parseArgumentSeparator).join("").split(this.parseArgumentSeparator+v).join("").split(v).join(""),this.randomValues.size===0&&z===""?(this.randomValues.clear(),this.randCollection=[]):this.randCollection=z.split(this.parseArgumentSeparator));for(var _=0;_<this.randomValues.size;_++)y=this.rowIndex(this.randCollection[_]),A=this.colIndex(this.randCollection[_]),N=(parseFloat(this.getSheetToken(this.randCollection[_]).split(this.sheetToken).join(""))+1).toString(),V=this.getSheetFamilyItem(N),this.grid=V.sheetNameToParentObject.get(N),I=this.randomValues.get(this.randCollection[_]),I=this.computeFormula(I),this.parentObject.setValueRowCol===void 0?this.setValueRowCol(this.getSheetID(this.grid)+1,I,y,A):this.parentObject.setValueRowCol(this.getSheetId(this.grid),I,y,A)},m.prototype.refresh=function(v,y){if(this.dependencyLevel===0&&this.refreshedCells.clear(),this.getDependentCells().has(v)&&this.getDependentCells().get(v)!==null){var A=this.getSheetFamilyItem(this.grid);this.dependencyLevel=this.dependencyLevel+1;try{var I=this.getDependentCells().get(v),N=void 0;for(N=0;N<I.length;N++){var z=I[N];if(!(y&&z.indexOf(y)>-1||z===v)){var V=this.getSheetToken(z);this.actCell=z.split(V)[1],V.length&&(this.grid=A.tokenToParentObject.get(V));try{var _=this.rowIndex(z),G=this.colIndex(z),K=this.getFormulaInfoTable().get(z),oe=void 0;if(K){this.cell=z,this.parser.isFormulaParsed=!0,oe=this.calculateFormula(K.getParsedFormula(),!0);var he=this.getComputedValue();he.set(z,oe),K.setFormulaValue(oe)}this.parentObject.setValueRowCol===void 0?this.setValueRowCol(this.getSheetID(this.grid)+1,K.getFormulaValue(),_,G):this.parentObject.setValueRowCol(this.getSheetId(this.grid),K.getFormulaValue(),_,G,K.getFormulaText()),this.refresh(z)}catch(ue){continue}}}}finally{this.grid=A.tokenToParentObject.get(this.getSheetToken(v)),this.dependencyLevel--,this.dependencyLevel===0&&this.refreshedCells.clear()}}};var x;return te([(0,P.Z9)(!0)],m.prototype,"includeBasicFormulas",void 0),te([(0,P.ju)()],m.prototype,"onFailure",void 0),m=x=te([P.Zl],m),m}(P.XY),d=function(){function S(m,x){this.formulaCorrection=!1,this.message=m,this.formulaCorrection=x}return S}(),M=function(){function S(){this.calcID=Number.MIN_VALUE+1,this.calcID1=Number.MIN_VALUE+1}return S.prototype.getFormulaText=function(){return this.formulaText},S.prototype.setFormulaText=function(m){this.formulaText=m},S.prototype.getFormulaValue=function(){return this.formulaValue},S.prototype.setFormulaValue=function(m){this.formulaValue=m},S.prototype.getParsedFormula=function(){return this.parsedFormula},S.prototype.setParsedFormula=function(m){this.parsedFormula=m},S}(),T=function(){function S(){this.isSheetMember=!1,this.parentObjectToToken=new Map,this.sheetDependentCells=new Map,this.sheetDependentFormulaCells=new Map,this.sheetNameToParentObject=new Map,this.sheetNameToToken=new Map,this.tokenToParentObject=new Map,this.sheetFormulaInfotable=new Map}return S}();function b(S){for(var m=[],x=0,v="A";S>0&&x<9;){S--;var y=v.charCodeAt(0);m[x]=String.fromCharCode(S%26+y),S=parseInt((S/26).toString(),10),x++}for(var A=[],I=0;I<x;I++)A[x-I-1]=m[I];return A.join("")}var k=function(){function S(m,x,v){return this.row=m,this.col=x,this.value=v,this.getRowIndex=function(){return m},this.setRowIndex=function(y){m=y},this.getColIndex=function(){return x},this.setColIndex=function(y){x=y},this.getValue=function(){return v},this}return S}()},62243:function(q,be,ae){"use strict";ae.d(be,{cA:function(){return P},y8:function(){return F},LA:function(){return Y},$c:function(){return w},UM:function(){return ye},T5:function(){return U},eT:function(){return Z},uG:function(){return E},xn:function(){return a},vJ:function(){return $},Sn:function(){return J},GN:function(){return se},V4:function(){return re},yR:function(){return Ae},SH:function(){return Ie},oS:function(){return te},iI:function(){return O},lu:function(){return d},nQ:function(){return M},e2:function(){return T},Lc:function(){return k},Vo:function(){return S},MX:function(){return m},CX:function(){return x},Lh:function(){return v},Xd:function(){return y},hU:function(){return A},y3:function(){return N},Zp:function(){return z},Y0:function(){return V},z7:function(){return _},JG:function(){return G},v:function(){return K},EP:function(){return oe},ru:function(){return he},wy:function(){return ue},SF:function(){return X},vG:function(){return Ce},fL:function(){return ze},$V:function(){return We},BT:function(){return Xe},sO:function(){return tt},b6:function(){return pt},TP:function(){return st},Zf:function(){return ht},Pk:function(){return rt},vD:function(){return Et},c:function(){return Vt},QK:function(){return ce},N2:function(){return ee},tr:function(){return Ne},YF:function(){return Te},Z:function(){return we},Oe:function(){return ct},HR:function(){return Lt},vy:function(){return vt},TI:function(){return Oe},P_:function(){return gi},IE:function(){return Ke},tW:function(){return ot},qP:function(){return He},IO:function(){return Ci},Th:function(){return pe},Lu:function(){return gr},ej:function(){return on},oR:function(){return uo},Y5:function(){return Rl},dW:function(){return Ml},e9:function(){return os},Ay:function(){return ls},V9:function(){return po},WG:function(){return Pl},Yx:function(){return yr},Zh:function(){return Nl},FA:function(){return dr},Dg:function(){return $r},I2:function(){return Dr},Av:function(){return ln},Em:function(){return hs},CT:function(){return cs},SC:function(){return Hs},YM:function(){return wa},MF:function(){return Di},Z4:function(){return Hr},QG:function(){return xa},Vm:function(){return Vs},Oj:function(){return zs},qo:function(){return us},T7:function(){return _s},DK:function(){return js},nb:function(){return hn},i2:function(){return rr},Gn:function(){return Ws},Ev:function(){return Vr},HP:function(){return vo},KR:function(){return mo},$o:function(){return go},y9:function(){return Us},Sq:function(){return Aa},hu:function(){return yo},I4:function(){return Ta},lA:function(){return La},Rp:function(){return ka},h4:function(){return Ia},Nm:function(){return Da},MQ:function(){return Oa},BF:function(){return qs},jI:function(){return Zs},WI:function(){return Ys},PA:function(){return Gs},R:function(){return ps},aW:function(){return ds},UD:function(){return Ra},rL:function(){return Ma},LV:function(){return Pa},eh:function(){return Ti},M7:function(){return Na},oU:function(){return Ni},oE:function(){return br},ao:function(){return Ks},k0:function(){return cn},tB:function(){return Fl},z0:function(){return bo},LX:function(){return fs},R8:function(){return Xs},gs:function(){return Fc},jh:function(){return Hl},uU:function(){return Hc},A$:function(){return Co},k3:function(){return Vc},dG:function(){return Qi},x3:function(){return xn},o:function(){return Bi},NB:function(){return zc},Vi:function(){return _c},JJ:function(){return So},du:function(){return zr},xY:function(){return wo},VM:function(){return xo},eF:function(){return Vl},e:function(){return ai},wq:function(){return jc},pf:function(){return Wc},vV:function(){return Uc},Cj:function(){return qc},Of:function(){return Zc},uv:function(){return vs},LC:function(){return Eo},dt:function(){return zl},cQ:function(){return Yc},mw:function(){return Gc},z1:function(){return Ao},Qu:function(){return _l},z2:function(){return $s},$7:function(){return jl},M6:function(){return Ba},qN:function(){return Qs},HG:function(){return To},o0:function(){return Wl}});var P="ribbon",F="formulaBar",Y="sheetTabs",w="refreshSheetTabs",ye="isFormulaBarEdit",U="initialLoad",Z="contentLoaded",E="mouseDown",a="spreadsheetDestroyed",$="editOperation",J="formulaOperation",se="formulaBarOperation",re="click",Ae="keyUp",Ie="keyDown",Se="formulaKeyUp",Q="formulaBarUpdate",te="verticalScroll",O="horizontalScroll",d="beforeContentLoaded",M="beforeVirtualContentLoaded",T="virtualContentLoaded",b="contextMenuOpen",k="cellNavigate",S="mouseUpAfterSelection",m="contextmenuBeforeOpen",x="insertSheetTab",v="removeSheetTab",y="renameSheetTab",A="ribboClick",I="ribbonRefresh",N="enableToolbarItems",z="tabSwitch",V="selectRange",_="cut",G="copy",K="paste",oe="clearCopy",he="dataBound",ue="beforeDataBound",X="addContextMenuItems",Ce="removeContextMenuItems",ze="enableContextMenuItems",We="enableFileMenuItems",Xe="hideFileMenuItems",tt="addFileMenuItems",pt="hideRibbonTabs",st="enableRibbonTabs",ht="addRibbonTabs",rt="addToolbarItems",Et="hideToolbarItems",Vt="beforeRibbonCreate",ce="rowHeightChanged",ee="colWidthChanged",Ne="onContentScroll",Te="deInitProperties",we="activeSheetChanged",ct="renameSheet",Lt="initiateCustomSort",vt="applySort",Oe="collaborativeUpdate",gi="autoFitRowsColumns",Ke="updateToggleItem",ot="initiateHyperlink",He="editHyperlink",Ci="openHyperlink",pe="removeHyperlink",gr="createHyperlinkElement",on="sheetNameUpdate",uo="hideSheet",Rl="performUndoRedo",Ml="updateUndoRedoCollection",os="setActionData",ls="getBeforeActionData",po="clearUndoRedoCollection",Pl="initiateFilterUI",yr="renderFilterCell",Nl="reapplyFilter",dr="filterByCellValue",$r="clearFilter",Dr="getFilteredColumn",ln="actionComplete",hs="filterCellKeyDown",cs="getFilterRange",Hs="setAutoFit",wa="refreshFormulaDatasource",Di="setScrollEvent",Hr="initiatedatavalidation",Qr="validationError",Bl="startEdit",xa="invalidData",fo="clearInvalid",Vs="protectSheet",zs="applyProtect",Ea="unprotectSheet",us="protectCellFormat",_s="renderGotoDlgt",js="renderFindDlg",hn="findHandler",rr="created",Ws="editAlert",Vr="setUndoRedo",vo="enableFormulaInput",mo="protectSelection",go="hiddenMerge",Us="checkPrevMerge",Aa="checkMerge",yo="removeDataValidation",Ta="showAggregate",La="goToSheet",ka="showSheet",Ia="initiateConditionalFormat",Da="setCF",Oa="clearViewer",qs="initiateFormulaReference",Zs="initiateCur",Ys="clearCellRef",Gs="editValue",ps="addressHandle",ds="initiateEdit",Ra="forRefSelRender",Ma="insertImage",Pa="refreshImgElem",Ti="refreshImgCellObj",Na="getRowIdxFromClientY",Ni="getColIdxFromClientX",br="createImageElement",Ks="deleteImage",cn="deleteChart",Fl="refreshChartCellObj",bo="refreshImagePosition",fs="updateTableWidth",Xs="focusBorder",Fc="clearChartBorder",Hl="insertChart",Hc="chartRangeSelection",Co="insertDesignChart",Vc="removeDesignChart",Qi="chartDesignTab",xn="addChartEle",Bi="undoRedoForChartDesign",zc="isReact",_c="renderReactTemplates",So="clearTemplate",zr="protectWorkbook",wo="unProtectWorkbook",xo="getPassWord",Vl="setProtectWorkbook",ai="removeWorkbookProtection",jc="importProtectWorkbook",Wc="selectionStatus",Uc="freeze",qc="overlayEleSize",Zc="updateScroll",vs="positionAutoFillElement",Eo="hideAutoFillOptions",zl="performAutoFill",Yc="selectAutoFillRange",rf="autoFill",Gc="fillRange",Ao="UnProtectWorksheet",_l="hideAutoFillElement",$s="unProtectSheetPassword",jl="updateTranslate",Ba="getUpdatedScrollPosition",Qs="updateScrollValue",To="beforeCheckboxfilterRenderer",Wl="refreshCheckbox"},95005:function(q,be,ae){"use strict";ae.d(be,{e:function(){return ye}});var P=ae(91997),F=ae(93010),Y=ae(62243),w=ae(8923),ye=function(){function U(Z){this.parent=Z,this.addEventListener()}return U.prototype.destroy=function(){this.removeEventListener(),this.parent=null},U.prototype.addEventListener=function(){this.parent.on(F.axz,this.setCFRule,this),this.parent.on(F.G2p,this.clearRules,this),this.parent.on(F.L,this.cFUndoHandler,this)},U.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(F.axz,this.setCFRule),this.parent.off(F.G2p,this.clearRules),this.parent.off(F.L,this.cFUndoHandler))},U.prototype.setCFRule=function(Z){var E=Z.conditionalFormat,a=E.range,$=Z.isRedo?Z.sheetIdx:(0,F.MJG)(this.parent,a),J=(0,P.zf)(this.parent,$);a=a||J.selectedRange;var se=(0,F.gaE)((0,F.dK5)(a));E.range=(0,F.i0K)(se);var re;if(Z.isAction){var Ae={range:E.range,type:E.type,cancel:!1,cFColor:E.cFColor,value:E.value,sheetIdx:$};if(re={eventArgs:Ae,action:"conditionalFormat"},this.parent.notify(F.ya2,re),Ae.cancel)return;E.type=Ae.type,E.cFColor=Ae.cFColor,E.value=Ae.value,E.range=Ae.range,delete Ae.cancel}J.conditionalFormats||this.parent.setSheetPropertyOnMute(J,"conditionalFormats",[]);var Ie=J.conditionalFormats.length;if(J.conditionalFormats[Ie]=E,Z.isRedo&&$!==this.parent.activeSheetIndex)Z.isFromUpdateAction||this.parent.notify(F.E9X,{address:J.name+"!"+E.range});else for(var Se=se[0];Se<=se[2];Se++){J.rows[Se]||(0,P.ZG)(J,Se,{});for(var Q=se[1];Q<=se[3];Q++)if((!J.rows[Se].cells||!J.rows[Se].cells[Q])&&(0,P.Jx)(Se,Q,J,{}),$===this.parent.activeSheetIndex){var te=J.rows[Se].cells[Q];this.parent.notify(F.wWe,{rowIdx:Se,colIdx:Q,cell:te,conditionalFormat:E,isAction:Z.isAction})}}Z.isAction&&this.parent.notify(Y.Av,re)},U.prototype.clearRule=function(Z){for(var E=Z[0];E<=Z[2];E++)for(var a=Z[1];a<=Z[3];a++)this.parent.notify(F.bLA,{rIdx:E,cIdx:a})},U.prototype.clearRules=function(Z){var E=!!(0,w.le)(Z.isPublic),a=[],$=[],J=!0,se,re,Ae,Ie,Se,Q,te,O,d=Z.range,M=Z.isUndoRedo?Z.sheetIdx:this.parent.getAddressInfo(d).sheetIndex,T=(0,P.zf)(this.parent,M),b=T.conditionalFormats,k=(0,F.dK5)(d);if(M===this.parent.activeSheetIndex)if(b&&k[2]===T.rowCount-1&&k[3]===T.colCount-1&&k[0]===0&&k[1]===0)for(var S=0;S<b.length;S++){var m=(0,F.dK5)(b[S].range);this.clearRule(m)}else this.clearRule(k);if(!!b){for(var x=b.length-1;x>=0;x--){var v=!1,y="",A=b[x],I=A.range.split(",");if(M===this.parent.activeSheetIndex&&(Z.isClearCF||!Z.isUndoRedo))for(var N=0;N<I.length;N++){var z=!1,V=I[N],_=(0,F.dK5)(V);te=_[0],O=_[0],Se=_[1],Q=_[1],_[0]>=k[0]&&_[2]<=k[2]&&_[1]>=k[1]&&_[3]<=k[3]&&(z=!0);for(var G=_[0];G<=_[2];G++){for(var K=0,oe=_[1];oe<=_[3];oe++)for(var he=k[0];he<=k[2];he++)for(var ue=k[1];ue<=k[3];ue++)if(he===G&&ue===oe){var X=this.parent.getCellStyleValue(["backgroundColor","color"],[he,ue]);this.parent.notify(F.nJk,{style:X,rowIdx:he,colIdx:ue,lastCell:!0,isHeightCheckNeeded:!0,manualUpdate:!0}),K=K+1,v=!0,he===_[0]?ue===_[3]?Se===_[1]?Q===ue?Q=ue:Se=ue-1:Se!==_[1]&&Q+1===ue?(Q=_[1],Se=Se-1):Se!==_[1]&&Q===_[1]&&(Se=k[1]-1):ue===_[1]?Q===_[1]&&(Q=ue+1):Se===_[1]&&Q===_[1]?(Se=ue,Q=ue):Se===_[1]&&Q!==_[1]?Q=ue+1:Q=ue:ue===_[1]?Q===_[1]&&_[1]!==_[3]&&(Q=ue+1):ue===_[3]?Se===_[1]?Q===ue?Q=ue:Se=ue-1:Se!==_[1]&&Q===_[1]?Se=k[1]-1:Se!==_[1]&&Q+1===ue?(Q=_[1],Se=k[1]-1):O=he:Se===_[1]&&Q===_[1]?(Se=ue,Q=ue):Q!==_[1]&&Se!==_[1]?Q=ue:Se!==_[1]&&Q===_[1]?Se=ue:Q=ue+1}K>0&&!z?(J&&(se=te,re=O,Ae=Se,Ie=Q),Se===_[1]&&Q!==_[1]?Q===_[3]?(te!==G&&(y=y+" "+(0,F.i0K)([te,Ae,re,_[3]])),Se===_[1]&&Q===_[3]&&(G===_[2]?_[1]===k[3]&&(y=y+" "+(0,F.i0K)([G,Q,G,_[3]])):(k[2]===_[0]&&Q!==_[3]&&(y=y+" "+(0,F.i0K)([G,Q,G,_[3]])),te=G+1,O=G+1,Q=_[1]))):Ie!==Q?(y=y+" "+(0,F.i0K)([te,Ie,G-1,_[3]]),Q===_[3]&&Se===_[1]?(te=G+1,O=G+1,Q=_[1]):(te=G,O=G),Q===_[3]&&Se!==_[1]&&(Se=_[1])):Ae!==Se?(y=y+" "+(0,F.i0K)([te,_[1],G-1,Ae]),te=G+1,O=G+1,Se=_[1],Q=_[1]):G===_[2]?y=y+" "+(0,F.i0K)([te,Q,G,_[3]]):(O<G||Se===_[1]&&Q===_[3])&&(O=G):Q===_[1]&&Se!==_[1]?(Ie!==Q&&(y=y+" "+(0,F.i0K)([te,Ie,G-1,_[3]]),te=G,O=G),Ae!==Se&&(y=y+" "+(0,F.i0K)([te,Ae,G-1,_[3]]),te=G,O=G),G===_[2]?y=y+" "+(0,F.i0K)([te,Q,G,Se]):O=G):Q!==_[1]&&Se!==_[1]?G===_[2]&&_[2]===k[0]?_[0]===_[2]?(y=y+" "+(0,F.i0K)([te,_[1],O,Se-1]),y=y+" "+(0,F.i0K)([te,Q+1,O,_[3]])):(y=y+" "+(0,F.i0K)([te,_[1],O,_[3]]),y=y+" "+(0,F.i0K)([_[2],_[1],_[2],Se-1]),y=y+" "+(0,F.i0K)([_[2],Q+1,_[2],_[3]])):G===_[2]?(y=y+" "+(0,F.i0K)([te,_[1],G,Se-1]),y=y+" "+(0,F.i0K)([te,Q+1,G,_[3]])):(Ae===_[1]&&Ie===_[1]&&(y=y+" "+(0,F.i0K)([te,Ae,O,_[3]]),te=G),O=G):Se===_[1]&&Q===_[1]&&(k[2]!==_[0]?(_[2]>=k[2]&&G>k[2]&&(y=y+" "+(0,F.i0K)([te,Se,O,_[3]])),_[1]===_[3]&&G<=_[2]&&se!==_[2]&&G!==se&&(y=y+" "+(0,F.i0K)([te,Se,O,_[3]])),_[1]===_[3]&&(te=G+1,O=G+1)):((G===_[2]||G===_[0]&&_[1]!==_[3])&&(y=y+" "+(0,F.i0K)([te,Se,O,Q])),te=G+1,O=G+1),G===_[2]&&_[0]!==_[2]&&_[1]!==_[3]&&(y=y+" "+(0,F.i0K)([G,Se,G,Q]))),J||(se=te,re=O<=_[2]?O:_[2],Ae=Se,Ie=Q<=_[3]?Q:_[3]),J=!1):z||(J&&(se=te,re=O,Ae=Se,Ie=Q),Se===_[1]&&Q===_[1]&&(G===_[2]&&(y=y+" "+(0,F.i0K)([te,Se,G,_[3]])),O=G),Q!==_[1]&&Se!==_[1]&&(y=y+" "+(0,F.i0K)([te,_[1],G-1,Se-1]),y=y+" "+(0,F.i0K)([te,Q+1,G-1,_[3]]),te=G,O=G,Se=_[1],Q=_[1]),Q!==_[1]&&Se===_[1]&&(y=y+" "+(0,F.i0K)([te,Q,G-1,_[3]]),te=G,O=G,Se=_[1],Q=_[1]),Se!==_[1]&&Q===_[1]&&(y=y+" "+(0,F.i0K)([te,Q,G-1,Se]),te=G,O=G,Se=_[1],Q=_[1]),J||(se=te,re=O<=_[2]?O:_[2],Ae=Se,Ie=Q<=_[3]?Q:_[3]),J=!1)}}if(y===""?($.push(T.conditionalFormats[x].range),T.conditionalFormats.splice(x,1)):($.push(T.conditionalFormats[x].range),T.conditionalFormats[x].range=y.trim().replace(" ",",")),v&&!E&&(A.range=y.trim().replace(" ",","),a.push(A)),Z.isUndoRedo){this.parent.activeSheetIndex!==Z.sheetIdx&&!Z.isFromUpdateAction&&this.parent.notify(F.E9X,{address:T.name+"!"+Z.range});break}}if(!E){var Ce={cFormats:a,oldRange:$,selectedRange:d,sheetIdx:M};this.parent.notify(Y.Av,{eventArgs:Ce,action:"clearCF"})}Z.isclearFormat||this.parent.notify(F.CC2,{range:d,isclearFormat:!0})}},U.prototype.cFUndoHandler=function(Z){if(Z.sheetIdx===this.parent.activeSheetIndex)for(var E=Z.conditionalFormat,a=E.range.split(","),$=(0,P.zf)(this.parent,Z.sheetIdx),J=0;J<a.length;J++)for(var se=a[J],re=(0,F.dK5)(se),Ae=re[0];Ae<=re[2];Ae++)for(var Ie=re[1];Ie<=re[3];Ie++){var Se=$.rows[Ae].cells[Ie];this.parent.notify(F.wWe,{rowIdx:Ae,colIdx:Ie,cell:Se,conditionalFormat:E,isAction:!0})}},U.prototype.getModuleName=function(){return"workbookConditionalFormatting"},U}()},57387:function(q,be,ae){"use strict";ae.d(be,{aE:function(){return te},y9:function(){return Y},e0:function(){return Q.e},uZ:function(){return se},WC:function(){return J},Do:function(){return E},tq:function(){return Ae},zp:function(){return a},VB:function(){return $},nH:function(){return Se},tU:function(){return Ie}});var P=ae(93010),F=ae(77084),Y=function(){function O(d){this.parent=d,this.addEventListener()}return O.prototype.format=function(d){var M=this,T,b=d.range;b&&typeof b=="string"&&b.indexOf("!")>-1?(b=b.split("!")[1],T=this.parent.sheets[(0,F.Q8D)(this.parent,d.range.split("!")[0])]):T=this.parent.getActiveSheet(),b===void 0&&(b=T.selectedRange);var k=typeof b!="object"&&d.onActionUpdate,S={range:b,style:Object.assign({},d.style),requestType:"CellFormat"};d.borderType&&(S.borderType=d.borderType);var m={};if(Object.assign(m,S.style,null,!0),k&&(this.parent.trigger("beforeCellFormat",S),this.parent.notify("actionBegin",{eventArgs:S,action:"format"}),S.cancel)){d.cancel=!0;return}var x=typeof S.range=="object"?S.range:(0,P.gaE)((0,P.dK5)(S.range));d.borderType&&(this.setTypedBorder(T,d.style.border,x,d.borderType,d.onActionUpdate),delete d.style.border,delete S.style.border);var v,y,A={cell:null,rowIdx:0,colIdx:0,eventOnly:!0,preventEvt:!k},I=function(Et){return A.cell={style:Et},A.rowIdx=v,A.colIdx=y,(0,F.wWT)(M.parent,T,A)};if(S.style.borderTop!==void 0){for(y=x[1];y<=x[3];y++)v=x[0],I({borderTop:S.style.borderTop})||(this.checkAdjacentBorder(T,"borderBottom",v-1,y),this.checkFullBorder(T,"borderBottom",v-1,y),this.checkFullBorder(T,"borderTop",v,y),this.setCellBorder(T,A.cell.style,v,y,d.onActionUpdate,y===x[3]));delete S.style.borderTop}if(S.style.borderBottom!==void 0){var N=void 0,z=void 0;for(y=x[1];y<=x[3];y++)v=x[0],N=(0,F.$Su)(v,y,T,!1,!0),N.rowSpan>0?z=(0,F.$Su)(x[2],x[1],T,!1,!0):z=(0,F.$Su)(x[2],x[3],T,!1,!0),N.rowSpan>1&&z.rowSpan<0||(v=x[2]),I({borderBottom:S.style.borderBottom})||(this.checkAdjacentBorder(T,"borderTop",x[2]+1,y),this.checkFullBorder(T,"borderTop",x[2]+1,y),this.checkFullBorder(T,"borderBottom",x[2],y),this.setCellBorder(T,A.cell.style,v,y,d.onActionUpdate,y===x[3]),this.setBottomBorderPriority(T,x[2],y));delete S.style.borderBottom}if(S.style.borderLeft!==void 0){for(var V=x[0];V<=x[2];V++)y=x[1],I({borderLeft:S.style.borderLeft})||(this.checkAdjacentBorder(T,"borderRight",V,y-1),this.checkFullBorder(T,"borderRight",V,y-1),this.checkFullBorder(T,"borderLeft",V,y),this.setCellBorder(T,A.cell.style,V,y,d.onActionUpdate));delete S.style.borderLeft}if(S.style.borderRight!==void 0){for(var _=x[0];_<=x[2];_++)y=x[3],I({borderRight:S.style.borderRight})||(this.checkAdjacentBorder(T,"borderLeft",_,y+1),this.checkFullBorder(T,"borderLeft",_,y+1),this.checkFullBorder(T,"borderRight",_,y),this.setCellBorder(T,A.cell.style,_,y,d.onActionUpdate));delete S.style.borderRight}var G,K,oe;if(Object.keys(S.style).length){var he=this.parent,ue=he.viewport&&this.parent.getActiveSheet().id===T.id,X=this.parent.frozenRowCount(T),Ce=this.parent.frozenColCount(T),ze=[X+he.viewport.topIndex,Ce+he.viewport.leftIndex,he.viewport.bottomIndex,he.viewport.rightIndex],We=void 0,Xe=void 0,tt=void 0;for(v=x[0];v<=x[2];v++)if(Xe=(0,F.dMx)(T,v)||{},!Xe.isFiltered){for(We=v>=ze[0]&&v<=ze[2]||v<X,tt=!1,y=x[1];y<=x[3];y++)if(!I(S.style)){if(K===void 0&&(S.style.border!==void 0?(G=S.style.border,delete S.style.border,K=!0):K=!1),oe=(0,F.$Su)(v,y,T,!1,!0),oe.rowSpan>1||oe.colSpan>1)for(var pt=v,st=oe.rowSpan>1?v+(oe.rowSpan-1):v;pt<=st;pt++)for(var ht=y,rt=oe.colSpan>1?y+(oe.colSpan-1):y;ht<=rt;ht++)K&&this.setFullBorder(T,G,x,pt,ht,d.onActionUpdate,!0),this.setCellStyle(T,pt,ht,S.style);K&&this.setFullBorder(T,G,x,v,y,d.onActionUpdate),this.setCellStyle(T,v,y,S.style),!!ue&&(We&&(y>=ze[1]&&y<=ze[3]||y<Ce)?this.parent.notify(P.nJk,{style:S.style,rowIdx:v,colIdx:y,lastCell:y===x[3],isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:d.onActionUpdate}):Xe.customHeight||(tt=tt||(0,F.X1M)(S.style,d.onActionUpdate),tt&&this.parent.notify(P.nJk,{rowIdx:v,colIdx:y,lastCell:y===x[3],checkHeight:!0,outsideViewport:!We,onActionUpdate:d.onActionUpdate})))}}}K&&(S.style.border=G),this.parent.setUsedRange(x[2],x[3]),d.refreshRibbon&&this.parent.notify(P.q6q,null),k&&(S.style=m,S.range=T.name+"!"+b,this.parent.notify("actionComplete",{eventArgs:S,action:"format"}))},O.prototype.setBottomBorderPriority=function(d,M,T){if((0,F.gSQ)(d,M+1)){var b=this.skipHiddenRows(d,M+1),k=this.parent.getCellStyleValue(["borderTop"],[b,T]).borderTop;k!==""&&(d.rows[M].cells[T].style.bottomPriority=!0)}},O.prototype.setFullBorder=function(d,M,T,b,k,S,m){var x={};b===T[0]&&(this.checkAdjacentBorder(d,"borderBottom",b-1,k),this.checkFullBorder(d,"borderBottom",b-1,k)),k===T[1]&&(this.checkAdjacentBorder(d,"borderRight",b,k-1),this.checkFullBorder(d,"borderRight",b,k-1)),k===T[3]?(this.checkAdjacentBorder(d,"borderLeft",b,k+1),this.checkFullBorder(d,"borderLeft",b,k+1)):this.checkAdjacentBorder(d,"border",b,k+1),x.borderRight=M,x.borderTop=M,x.borderLeft=M,x.borderBottom=M,this.setCellBorder(d,x,b,k,S,k===T[3],null,m),b===T[2]?(this.checkAdjacentBorder(d,"borderTop",b+1,k),this.checkFullBorder(d,"borderTop",b+1,k),this.setBottomBorderPriority(d,b,k)):this.checkAdjacentBorder(d,"border",b+1,k)},O.prototype.checkAdjacentBorder=function(d,M,T,b){var k={};this.parent.getCellStyleValue([M],[T,b])[M]!==""&&(k[M]=void 0,this.setCellStyle(d,T,b,k))},O.prototype.checkFullBorder=function(d,M,T,b){var k=this.parent.getCellStyleValue(["border"],[T,b]).border;if(k!==""){var S={border:void 0};["borderBottom","borderTop","borderLeft","borderRight"].forEach(function(m){m!==M&&(S[m]=k)}),this.setCellStyle(d,T,b,S)}},O.prototype.textDecorationActionUpdate=function(d){var M=this.parent.getActiveSheet(),T={range:M.selectedRange,style:d.style,requestType:"CellFormat"};if(this.parent.trigger("beforeCellFormat",T),this.parent.notify("actionBegin",{eventArgs:T,action:"format"}),T.cancel){d.cancel=!0;return}var b=(0,P.gaE)((0,P.dK5)(M.selectedRange)),k=d.style.textDecoration,S=k,m=(0,P.dK5)(M.activeCell),x=this.parent.getCellStyleValue(["textDecoration"],m).textDecoration,v,y=!1;x==="underline"?S=k==="underline"?"none":"underline line-through":x==="line-through"?S=k==="line-through"?"none":"underline line-through":x==="underline line-through"&&(S=k==="underline"?"line-through":"underline",y=!0),S==="none"&&(y=!0),this.format({style:{textDecoration:S},range:m,refreshRibbon:d.refreshRibbon,onActionUpdate:!0});for(var A=b[0];A<=b[2];A++)for(var I=b[1];I<=b[3];I++)if(!(A===m[0]&&I===m[1])){if(v={},x=this.parent.getCellStyleValue(["textDecoration"],[A,I]).textDecoration,x==="none"){if(y)continue;v.textDecoration=k}else if(x==="underline"||x==="line-through")if(y)if(k===x)v.textDecoration="none";else continue;else v.textDecoration=k!==x?"underline line-through":k;else if(x==="underline line-through")if(y)v.textDecoration=k==="underline"?"line-through":"underline";else continue;this.format({style:v,range:[A,I,A,I],refreshRibbon:d.refreshRibbon,onActionUpdate:!0})}T.range=M.name+"!"+T.range,T.style.textDecoration=S,this.parent.notify("actionComplete",{eventArgs:T,action:"format"})},O.prototype.setTypedBorder=function(d,M,T,b,k){var S;if(b==="Outer"){for(var m=T[1];m<=T[3];m++)this.checkAdjacentBorder(d,"borderBottom",T[0]-1,m),this.checkFullBorder(d,"borderBottom",T[0]-1,m),this.setCellBorder(d,{borderTop:M},T[0],m,k,m===T[3]),this.checkAdjacentBorder(d,"borderTop",T[2]+1,m),this.checkFullBorder(d,"borderTop",T[2]+1,m),this.setCellBorder(d,{borderBottom:M},T[2],m,k,m===T[3],b),this.setBottomBorderPriority(d,T[2],m);for(var x=T[0];x<=T[2];x++)this.checkAdjacentBorder(d,"borderRight",x,T[1]-1),this.checkFullBorder(d,"borderRight",x,T[1]-1),this.setCellBorder(d,{borderLeft:M},x,T[1],k),this.checkAdjacentBorder(d,"borderLeft",x,T[3]+1),this.checkFullBorder(d,"borderLeft",x,T[3]+1),this.setCellBorder(d,{borderRight:M},x,T[3],k,null,b)}else if(b==="Inner")for(var v=T[0];v<=T[2];v++)for(var y=T[1];y<=T[3];y++){var A={};S=this.parent.getCellStyleValue(["border"],[v,y]).border,S!==""&&(A.border=void 0,(y===T[3]||y===T[1]||v===T[0]||v===T[2])&&(v===T[0]&&(A.borderTop=S),v===T[2]&&(A.borderBottom=S),y===T[3]&&(A.borderRight=S),y===T[1]&&(A.borderLeft=S))),y!==T[3]&&(A.borderRight=M),v!==T[0]&&(A.borderTop=M),v!==T[2]&&(A.borderBottom=M),y!==T[1]&&(A.borderLeft=M),this.setCellBorder(d,A,v,y,k,y===T[3])}else if(b==="Vertical")for(var v=T[0];v<=T[2];v++)for(var y=T[1];y<=T[3];y++){var A={borderRight:M,borderLeft:M};y===T[1]&&(this.checkAdjacentBorder(d,"borderRight",v,y-1),this.checkFullBorder(d,"borderRight",v,y-1)),y===T[3]&&(this.checkAdjacentBorder(d,"borderLeft",v,y+1),this.checkFullBorder(d,"borderLeft",v,y+1)),this.setCellBorder(d,A,v,y,k)}else for(var v=T[0];v<=T[2];v++)for(var y=T[1];y<=T[3];y++){var A={borderTop:M,borderBottom:M};v===T[0]&&(this.checkAdjacentBorder(d,"borderBottom",v-1,y),this.checkFullBorder(d,"borderBottom",v-1,y)),this.setCellBorder(d,A,v,y,k,y===T[3]),v===T[2]&&(this.checkAdjacentBorder(d,"borderTop",v+1,y),this.checkFullBorder(d,"borderTop",v+1,y),this.setBottomBorderPriority(d,v,y))}},O.prototype.setCellBorder=function(d,M,T,b,k,S,m,x){if(this.setCellStyle(d,T,b,M),!x&&this.parent.getActiveSheet().id===d.id){if(m==="Outer"&&(M.borderBottom||M.borderRight)){var v={range:[T,b,T,b]};this.parent.notify(P.Zf5,v),T=v.range[0],b=v.range[1]}this.parent.notify(P.nJk,{style:M,rowIdx:T,colIdx:b,onActionUpdate:k,first:"",lastCell:S,isHeightCheckNeeded:!0,manualUpdate:!0})}},O.prototype.setCellStyle=function(d,M,T,b){d.rows[M]?d.rows[M].cells||(d.rows[M].cells=[]):d.rows[M]={cells:[]},d.rows[M].cells[T]||(d.rows[M].cells[T]={}),d.rows[M].cells[T].style||(d.rows[M].cells[T].style={}),Object.assign(d.rows[M].cells[T].style,b,null,!0)},O.prototype.skipHiddenRows=function(d,M){return M++,(0,F.gSQ)(d,M)&&(M=this.skipHiddenRows(d,M)),M},O.prototype.addEventListener=function(){this.parent.on(P.vbl,this.format,this),this.parent.on(P.nQ,this.textDecorationActionUpdate,this),this.parent.on(P.ZHw,this.clearCellObj,this)},O.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(P.vbl,this.format),this.parent.off(P.nQ,this.textDecorationActionUpdate),this.parent.off(P.ZHw,this.clearCellObj))},O.prototype.clearCellObj=function(d){var M=d.range?d.range.indexOf("!")>0?d.range.split("!")[1]:d.range.split("!")[0]:this.parent.getActiveSheet().selectedRange,T=d.range&&d.range.indexOf("!")>0?(0,F.Q8D)(this.parent,d.range.split("!")[0]):this.parent.activeSheetIndex,b=(0,F.zfV)(this.parent,T),k=(0,P.IRR)(M),S=k[0],m=k[2],x,v,y;for(S;S<=m;S++)for(x=k[1],v=k[3],x;x<=v;x++){var A=(0,F.$Su)(S,x,b);if(A)switch(d.type){case"Clear Formats":delete A.format,delete A.rowSpan,delete A.style,delete A.wrap,delete A.colSpan;break;case"Clear Contents":A.hyperlink&&this.parent.notify(P.M3o,{sheet:b,rowIdx:S,colIdx:x,preventRefresh:!0}),y=!!(A.value||A.formula),delete A.value,delete A.formula,this.parent.notify(F.xMH,{rowIdx:S,colIdx:x,cell:A,isAction:!0}),y&&this.parent.notify(F.B7N,{action:"refreshCalculate",rowIndex:S,colIndex:x,sheetIndex:T});break;case"Clear Hyperlinks":delete A.hyperlink;break;case"Clear All":y=!!(A.value||A.formula),(0,F.Jxt)(S,x,b,{},!1),y&&this.parent.notify(F.B7N,{action:"refreshCalculate",rowIndex:S,colIndex:x,sheetIndex:T});break}}},O.prototype.destroy=function(){this.removeEventListener(),this.parent=null},O.prototype.getModuleName=function(){return"workbookcellformat"},O}(),w=ae(91997),ye=ae(80788),U=ae(8923),Z=ae(34819),E=function(){function O(d){this.parent=d,this.localeObj=(0,U.NE)(this.parent.locale),this.decimalSep=this.localeObj.decimal,this.addEventListener()}return O.prototype.destroy=function(){this.removeEventListener(),this.parent=null},O.prototype.addEventListener=function(){this.parent.on(ye.Bb,this.performEditOperation,this)},O.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(ye.Bb,this.performEditOperation)},O.prototype.getModuleName=function(){return"workbookEdit"},O.prototype.performEditOperation=function(d){var M=d.action;switch(M){case"updateCellValue":this.updateCellValue(d.address,d.value,d.sheetIndex,d.isValueOnly,d.formula);break}},O.prototype.checkDecimalPoint=function(d,M){if(Number(d)){var T=d.toString().indexOf(this.decimalSep)+1,b=d.toString().substr(T).length<=6;b?!M||M.includes("RANDBETWEEN")?d=T<7?d:parseFloat(d).toFixed(0):d=d.toString().length<11?d:T<11?parseFloat(d).toFixed(9-T+2):parseFloat(d).toFixed(0):d=T>7?parseFloat(d).toFixed(0):parseFloat(d).toFixed(6-T+2)}return d},O.prototype.updateCellValue=function(d,M,T,b,k){T===void 0&&(T=this.parent.activeSheetIndex);var S;typeof d=="string"?S=(0,P.dK5)(d):S=d;var m=(0,w.zf)(this.parent,T),x=(0,w.$S)(S[0],S[1],m,!0);if(x||(x=m.rows[S[0]].cells[S[1]]={}),b)M&&M.toString().indexOf(this.decimalSep)>-1&&(M=this.checkDecimalPoint(M,k)),x.value=M;else{var v=(0,P.C2M)(M);v=M==="#SPILL!"?!0:v;var y=!1;x.formula&&x.formula.indexOf("UNIQUE")>-1&&M===""&&(y=!0),!v&&!y&&(x.formula&&(x.formula=""),x.value=(0,P.MpA)(M));var A={action:"refreshCalculate",value:M,rowIndex:S[0],colIndex:S[1],sheetIndex:T,isFormula:v};if((0,Z.K2)(x.format)!=="Text"){var I={value:M,rowIndex:S[0],colIndex:S[1],sheetIndex:T,updatedVal:""};this.parent.notify(ye.w0,I),!(0,U.le)(I.updatedVal)&&I.updatedVal.length>0&&(x.value=I.updatedVal)}if(M==="#SPILL!")x.value=M;else{var N={cellIdx:S,isUnique:!1};this.parent.notify(ye.Az,N),y?M=x.value:this.parent.notify(ye.B7,A),v?(x.formula=A.value,M=x.value,x.formula==="=NOW()"&&x.format!=="M/d/yyyy h:mm"&&(x.format="M/d/yyyy h:mm")):x.value&&typeof x.value=="string"&&(x.value.indexOf("www.")===0||x.value.indexOf("https://")===0||x.value.indexOf("http://")===0||x.value.indexOf("ftp://")===0)&&this.parent.notify(P.g7J,{hyperlink:x.value,cell:m.name+"!"+(0,P.qkm)(S[0],S[1])})}}this.parent.setUsedRange(S[0],S[1],m),this.parent.chartColl.length&&this.parent.notify(ye.Pp,{cell:x,rIdx:S[0],cIdx:S[1],sheetIdx:T}),m.conditionalFormats&&m.conditionalFormats.length&&this.parent.notify(P.xMH,{rowIdx:S[0],colIdx:S[1],cell:x,isAction:!0,preventIfSheetNotRendered:!0})},O}(),a=function(){function O(d){this.parent=d,this.addEventListener()}return O.prototype.destroy=function(){this.removeEventListener(),this.parent=null},O.prototype.addEventListener=function(){this.parent.on(P.g7J,this.setLinkHandler,this)},O.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(P.g7J,this.setLinkHandler)},O.prototype.setLinkHandler=function(d){var M=d.hyperlink,T=d.cell,b,k,S=this.parent.getActiveSheet(),m;if(T&&T.indexOf("!")!==-1){b=T.split("!");for(var x=this.parent.sheets,v=0;v<x.length;v++)x[v].name===b[0]&&(k=v);S=this.parent.sheets[k],T=b[1]}T=T||this.parent.getActiveSheet().activeCell;var y=(0,P.dK5)(T),A=y[0],I=y[1];if(!!S){var N={};typeof M=="string"?(M.indexOf("http://")!==0&&M.indexOf("https://")!==0&&M.indexOf("ftp://")!==0&&(M=M.toLowerCase().indexOf("www.")===0?"http://"+M:M,m=M),N.hyperlink=M):(m=M.address,m.indexOf("http://")!==0&&m.indexOf("https://")!==0&&m.indexOf("ftp://")!==0&&(m=m.toLowerCase().indexOf("www.")===0?"http://"+m:m),N.hyperlink={address:m}),d.displayText&&(N.value=d.displayText),(0,P.wWT)(this.parent,S,{cell:N,rowIdx:A,colIdx:I,preventEvt:!d.triggerEvt})||(S.rows[A].cells[I].style||(S.rows[A].cells[I].style={}),S.rows[A].cells[I].style.textDecoration="underline",S.rows[A].cells[I].style.color="#00e")}},O.prototype.getModuleName=function(){return"workbookHyperlink"},O}(),$=function(){function O(d){this.parent=d,this.addEventListener()}return O.prototype.insertModel=function(d){var M=this,T,b,k,S;if(d.modelType==="Column"){if(typeof d.start=="number")for(var m=0;m<=this.parent.getActiveSheet().usedRange.rowIndex+1;m++){var x={cellIdx:[m,d.start],isUnique:!1};if(this.parent.notify(P.Azt,x),x.isUnique)return}}else if(d.modelType==="Row"&&typeof d.start=="number")for(var v=0;v<=this.parent.getActiveSheet().usedRange.colIndex+1;v++){var x={cellIdx:[d.start,v],isUnique:!1};if(this.parent.notify(P.Azt,x),x.isUnique)return}if(!!d.model){var y,A=[],I,N,z;if(typeof d.start=="number"){y=d.start,d.end=d.end||y,y>d.end&&(y=d.end,d.end=d.start),d.modelType==="Row"&&y<d.model.maxHgts.length&&(z=[]);for(var m=y;m<=d.end;m++)A.push({}),z&&z.push(null)}else d.start?(y=d.start[0].index||0,A=d.start,N=!0):(y=0,A.push({})),d.modelType==="Row"&&y<d.model.maxHgts.length&&(z=[],A.forEach(function(){z.push(null)}));var V={model:A,index:y,modelType:d.modelType,insertType:d.insertType,cancel:!1,isUndoRedo:d.isUndoRedo},_={eventArgs:V,action:"insert"};if(d.isAction){if(this.parent.notify(P.ya2,_),V.cancel)return;delete V.cancel,V.isAction=d.isAction}var G={startIndex:y,endIndex:y+A.length-1,modelType:d.modelType,sheet:d.model,isInsert:!0};if(d.modelType==="Row"){if(d.checkCount!==void 0&&d.model.rows&&d.checkCount===d.model.rows.length)return;if(this.parent.notify(P.HoA,G),d.model=d.model,d.model.rows||(d.model.rows=[]),N&&d.model.usedRange.rowIndex>-1&&y>d.model.usedRange.rowIndex)for(var m=d.model.usedRange.rowIndex;m<y-1;m++)A.splice(0,0,{});var K=this.parent.frozenRowCount(d.model);y<K&&(this.parent.setSheetPropertyOnMute(d.model,"frozenRows",d.model.frozenRows+A.length),V.freezePane=!0),(T=d.model.rows).splice.apply(T,[y,0].concat(A)),z&&(b=d.model.maxHgts).splice.apply(b,[y,0].concat(z)),this.setRowColCount(G.startIndex,G.endIndex,d.model,"row"),y>d.model.usedRange.rowIndex?this.parent.setUsedRange(y+(A.length-1),d.model.usedRange.colIndex,d.model,!0):this.parent.setUsedRange(d.model.usedRange.rowIndex+A.length,d.model.usedRange.colIndex,d.model,!0);for(var oe=y+A.length,he,ue=void 0,X=function(rt){d.model.rows[oe]&&d.model.rows[oe].cells&&d.model.rows[oe].cells[rt]&&(ue=d.model.rows[oe].cells[rt],ue.rowSpan!==void 0&&ue.rowSpan<0&&ue.colSpan===void 0&&Ce.parent.notify(P.z3C,{range:[oe,rt,oe,rt],insertCount:A.length,insertModel:"Row"}),ue.style&&(0,w.$S)(y-1,rt,d.model,!1,!0).style&&(he=Ce.checkBorder(ue.style,d.model.rows[y-1].cells[rt].style),he!=={}&&A.forEach(function(Et){Et.cells||(Et.cells=[]),Et.cells[rt]||(Et.cells[rt]={}),Et.cells[rt].style||(Et.cells[rt].style={}),Object.assign(Et.cells[rt].style,he)})))},Ce=this,m=0;m<=d.model.usedRange.colIndex;m++)X(m);V.sheetCount=d.model.rows.length}else if(d.modelType==="Column"){if(d.checkCount!==void 0&&d.model.columns&&d.checkCount===d.model.columns.length)return;this.parent.notify(P.HoA,G),d.model=d.model,d.model.columns||(d.model.columns=[]),y&&!d.model.columns[y-1]&&(d.model.columns[y-1]={}),(k=d.model.columns).splice.apply(k,[y,0].concat(A));var ze=this.parent.frozenColCount(d.model);y<ze&&(this.parent.setSheetPropertyOnMute(d.model,"frozenColumns",d.model.frozenColumns+A.length),V.freezePane=!0),this.setRowColCount(G.startIndex,G.endIndex,d.model,"col"),y>d.model.usedRange.colIndex?this.parent.setUsedRange(d.model.usedRange.rowIndex,y+(A.length-1),d.model,!0):this.parent.setUsedRange(d.model.usedRange.rowIndex,d.model.usedRange.colIndex+A.length,d.model,!0),d.model.rows||(d.model.rows=[]);var We=[];d.columnCellsModel||(d.columnCellsModel=[]);for(var m=0;m<A.length;m++)We.push(null);I=[];for(var ue=void 0,Xe=void 0,m=0;m<=d.model.usedRange.rowIndex;m++){d.model.rows[m]?d.model.rows[m].cells||(d.model.rows[m].cells=[]):d.model.rows[m]={cells:[]},y&&!d.model.rows[m].cells[y-1]&&(d.model.rows[m].cells[y-1]={}),(S=d.model.rows[m].cells).splice.apply(S,[y,0].concat(d.columnCellsModel[m]&&d.columnCellsModel[m].cells?d.columnCellsModel[m].cells:We));var oe=y+A.length;if(d.model.rows[m].cells[oe]&&(ue=d.model.rows[m].cells[oe],ue.colSpan!==void 0&&ue.colSpan<0&&ue.rowSpan===void 0&&I.push({range:[m,oe,m,oe],insertCount:We.length,insertModel:"Column"}),ue.style&&(0,w.$S)(m,y-1,d.model,!1,!0).style&&(Xe=this.checkBorder(ue.style,d.model.rows[m].cells[y-1].style),Xe!=={})))for(var v=y;v<oe;v++)d.model.rows[m].cells[v]||(d.model.rows[m].cells[v]={}),d.model.rows[m].cells[v].style||(d.model.rows[m].cells[v].style={}),Object.assign(d.model.rows[m].cells[v].style,Xe)}I.forEach(function(Et){M.parent.notify(P.z3C,Et)}),V.sheetCount=d.model.columns.length}else{if(d.checkCount!==void 0&&d.checkCount===this.parent.sheets.length)return;for(var tt=A,pt=(0,w.R)(this.parent),st=d.isFromUpdateAction,m=0;m<tt.length;m++)if(tt[m].name){for(var v=0;v<this.parent.sheets.length;v++)if(tt[m].name===this.parent.sheets[v].name){tt.splice(m,1),m--;break}}if(!tt.length)return;delete A[0].index,this.parent.createSheet(y,A);var ht;d.activeSheetIndex?(V.activeSheetIndex=d.activeSheetIndex,this.parent.setProperties({activeSheetIndex:d.activeSheetIndex},!0)):!d.isAction&&d.start<this.parent.activeSheetIndex&&this.parent.setProperties({activeSheetIndex:this.parent.skipHiddenSheets(this.parent.activeSheetIndex)},!0),st&&this.parent.setProperties({activeSheetIndex:(0,w.Q8)(this.parent,pt)},!0),A.forEach(function(rt){N&&M.updateRangeModel(rt.ranges),ht=rt.id,M.parent.notify(P.B7N,{action:"addSheet",visibleName:rt.name,sheetName:"Sheet"+ht,sheetId:ht})}),V.activeSheetIndex=d.activeSheetIndex,V.sheetCount=this.parent.sheets.length}d.modelType!=="Sheet"&&(this.insertConditionalFormats(d),this.parent.notify(P.cRm,{start:y,end:y+A.length-1,modelType:d.modelType,model:d.model,isInsert:!0}),V.activeSheetIndex=(0,w.Q8)(this.parent,d.model.name)),this.parent.notify(P.$Tr,_)}},O.prototype.setRowColCount=function(d,M,T,b){var k=b+"Count";this.parent.setSheetPropertyOnMute(T,k,T[k]+(M-d+1)),T.id===this.parent.getActiveSheet().id&&this.parent.notify(P.XRp,{index:T[k]-1,update:b,isInsert:!0,start:d,end:M})},O.prototype.updateRangeModel=function(d){d.forEach(function(M){M.dataSource&&(M.startCell=M.startCell||"A1",M.showFieldAsHeader=M.showFieldAsHeader===void 0||M.showFieldAsHeader,M.template=M.template||"",M.address=M.address||"A1")})},O.prototype.checkBorder=function(d,M){var T={};return d.borderLeft&&d.borderLeft===M.borderLeft&&(T.borderLeft=d.borderLeft),d.borderRight&&d.borderRight===M.borderRight&&(T.borderRight=d.borderRight),d.borderTop&&d.borderTop===M.borderTop&&(T.borderTop=d.borderTop),d.borderBottom&&d.borderBottom===M.borderBottom&&(T.borderBottom=d.borderBottom),T},O.prototype.setInsertInfo=function(d,M,T,b,k){k===void 0&&(k="Row");var S=T=M+(T-1);d.ranges.forEach(function(m){m.info&&M<m.info[b]&&(m.info["insert"+k+"Range"]?m.info["insert"+k+"Range"].push([M,S]):m.info["insert"+k+"Range"]=[[M,S]],m.info[b]+=S-M+1)})},O.prototype.insertConditionalFormats=function(d){var M=d.model.conditionalFormats;if(d.prevAction==="delete")this.parent.setSheetPropertyOnMute(d.model,"conditionalFormats",d.conditionalFormats);else if(M)for(var T=0,b=M.length;T<b;T++)M[T].range=(0,P.i0K)((0,F.gQT)(d,(0,P.dK5)(M[T].range),!d.isAction&&!d.isUndoRedo))},O.prototype.addEventListener=function(){this.parent.on(P.IQJ,this.insertModel,this)},O.prototype.destroy=function(){this.removeEventListener(),this.parent=null},O.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(P.IQJ,this.insertModel)},O.prototype.getModuleName=function(){return"workbookinsert"},O}(),J=function(){function O(d){this.parent=d,this.addEventListener()}return O.prototype.deleteModel=function(d){var M=this,T=this.parent.sheets.length;if(!(d.modelType==="Sheet"&&T===1)){if(d.modelType==="Column"){if(typeof d.start=="number")for(var b=0;b<=this.parent.getActiveSheet().usedRange.rowIndex+1;b++){var k={cellIdx:[b,d.start],isUnique:!1};if(this.parent.notify(F.Azt,k),k.isUnique)return}}else if(d.modelType==="Row"&&typeof d.start=="number")for(var S=0;S<=this.parent.getActiveSheet().usedRange.colIndex+1;S++){var k={cellIdx:[d.start,S],isUnique:!1};if(this.parent.notify(F.Azt,k),k.isUnique)return}var m=d.modelType.toLowerCase()+"s";if(d.start=d.start,d.start>d.end){var x=d.start;d.start=d.end,d.end=x}var v={startIndex:d.start,endIndex:d.end,modelType:d.modelType,cancel:!1,isUndoRedo:d.isUndoRedo},y={eventArgs:v,action:"delete"};if(!(d.isAction&&(this.parent.notify(F.ya2,y),v.cancel))){var A,I,N=[],z=d.end-d.start+1,V={startIndex:d.start,endIndex:d.end,modelType:d.modelType,sheet:d.model},_=this.parent.scrollSettings.isFinite;if(d.modelType==="Row"){if(d.checkCount!==void 0&&d.checkCount===d.model.usedRange.rowIndex)return;if(this.parent.notify(F.HoA,V),d.model=d.model,_){if(d.start>=d.model.rowCount)return;d.end>=d.model.rowCount&&(d.end=d.model.rowCount-1)}else{if(d.start>d.model.usedRange.rowIndex)return;d.end>d.model.usedRange.rowIndex&&(d.end-=d.end-d.model.usedRange.rowIndex)}this.setRowColCount(d.start,d.end,d.model,"row"),d.start<=d.model.usedRange.rowIndex&&(d.model.usedRange.rowIndex-=d.end-d.start+1,d.model.usedRange.rowIndex<0&&(d.model.usedRange.rowIndex=0));var G=this.parent.frozenRowCount(d.model);d.start<G&&(G=d.end<G?d.end-d.start+1:G-d.start,G=d.model.frozenRows-G,this.parent.setSheetPropertyOnMute(d.model,"frozenRows",G),v.freezePane=!0);var K=d.end+1,oe=void 0,he=void 0;if(d.model.rows[d.start]&&d.model.rows[d.start].cells)for(var S=0;S<=d.model.usedRange.colIndex;S++){if(d.model.rows[d.start].cells[S]&&d.model.rows[d.start].cells[S].rowSpan!==void 0&&d.model.rows[d.start].cells[S].rowSpan<0&&d.model.rows[d.start].cells[S].colSpan===void 0&&(he={range:[d.start,S,d.start,S]},this.parent.notify(P.Zf5,he),he.range=he.range,he.range[2]<=d.end&&(I=(0,F.$Su)(he.range[0],S,d.model),I&&I.rowSpan>1&&(I.rowSpan-(he.range[2]-d.start+1)>1?(0,F.Jxt)(he.range[0],S,d.model,{colSpan:I.rowSpan-(he.range[2]-d.start+1)},!0):delete d.model.rows[he.range[0]].cells[S].rowSpan),he=null)),d.model.rows[K]&&d.model.rows[K].cells&&d.model.rows[K].cells[S]&&d.model.rows[K].cells[S].rowSpan!==void 0&&d.model.rows[K].cells[S].rowSpan<0&&d.model.rows[K].cells[S].colSpan===void 0&&(he||(he={range:[K,S,K,S]},this.parent.notify(P.Zf5,he)),oe=new Object,he.range=he.range,Object.assign(oe,(0,F.$Su)(he.range[0],he.range[1],d.model)),oe&&oe.rowSpan&&(oe.rowSpan>1||oe.colSpan>1))){var ue=[];ue[1]=S,ue[3]=oe.colSpan>1?S+(oe.colSpan-1):S,he.range=he.range,he.range[0]<d.start?(ue[0]=ue[2]=he.range[0],oe.rowSpan-z>1&&(ue[2]+=oe.rowSpan-z-1)):(ue[0]=ue[2]=d.start,oe.rowSpan-(d.end-he.range[0]+1)>1&&(ue[2]+=oe.rowSpan-(d.end-he.range[0]+1)-1)),N.push({range:ue,isAction:!1,preventRefresh:!0,merge:!0,type:"All",skipChecking:!0})}he=null}v.sheetCount=d.model.usedRange.rowIndex}else if(d.modelType==="Column"){if(d.checkCount!==void 0&&d.checkCount===d.model.usedRange.colIndex)return;if(this.parent.notify(F.HoA,V),d.model=d.model,_){if(d.start>=d.model.colCount)return;d.end>=d.model.colCount&&(d.end=d.model.colCount-1)}else{if(d.start>d.model.usedRange.colIndex)return;d.end>d.model.usedRange.colIndex&&(d.end-=d.end-d.model.usedRange.colIndex)}this.setRowColCount(d.start,d.end,d.model,"col"),d.start<=d.model.usedRange.colIndex&&(d.model.usedRange.colIndex-=z,d.model.usedRange.colIndex<0&&(d.model.usedRange.colIndex=0));var X=this.parent.frozenColCount(d.model);d.start<X&&(X=d.end<X?d.end-d.start+1:X-d.start,X=d.model.frozenColumns-X,this.parent.setSheetPropertyOnMute(d.model,"frozenColumns",X),this.parent.updateTopLeftCell(),v.freezePane=!0),A=[];for(var K=d.end+1,oe=void 0,he=void 0,S=0;S<=d.model.usedRange.rowIndex;S++)if(A.push({}),d.model.rows[S]&&d.model.rows[S].cells){if(d.model.rows[S].cells[d.start]&&d.model.rows[S].cells[d.start].colSpan!==void 0&&d.model.rows[S].cells[d.start].colSpan<0&&d.model.rows[S].cells[d.start].rowSpan===void 0&&(he={range:[S,d.start,S,d.start]},this.parent.notify(P.Zf5,he),he.range=he.range,he.range[3]<=d.end)){var Ce=(0,F.$Su)(S,he.range[1],d.model);Ce&&Ce.colSpan>1&&(Ce.colSpan-(he.range[3]-d.start+1)>1?(0,F.Jxt)(S,he.range[1],d.model,{colSpan:Ce.colSpan-(he.range[3]-d.start+1)},!0):delete d.model.rows[S].cells[he.range[1]].colSpan),he=null}if(d.model.rows[S].cells[K]&&d.model.rows[S].cells[K].colSpan!==void 0&&d.model.rows[S].cells[K].colSpan<0&&d.model.rows[S].cells[K].rowSpan===void 0&&(he||(he={range:[S,K,S,K]},this.parent.notify(P.Zf5,he)),oe=new Object,he.range=he.range,Object.assign(oe,(0,F.$Su)(he.range[0],he.range[1],d.model)),oe&&oe.colSpan&&(oe.colSpan>1||oe.rowSpan>1))){var ue=[];ue[0]=S,ue[2]=oe.rowSpan>1?S+(oe.rowSpan-1):S,he.range=he.range,he.range[1]<d.start?(ue[1]=ue[3]=he.range[1],oe.colSpan-z>1&&(ue[3]+=oe.colSpan-z-1)):(ue[1]=ue[3]=d.start,oe.colSpan-(d.end-he.range[1]+1)>1&&(ue[3]+=oe.colSpan-(d.end-he.range[1]+1)-1)),N.push({range:ue,isAction:!1,preventRefresh:!0,merge:!0,type:"All",skipChecking:!0})}A[S].cells=d.model.rows[S].cells.splice(d.start,z),he=null}v.sheetCount=d.model.usedRange.colIndex,v.deletedCellsModel=A}else{if(d.end-d.start==this.parent.sheets.length-1||d.checkCount!==void 0&&d.checkCount===this.parent.sheets.length)return;v.sheetCount=this.parent.sheets.length,v.activeSheetIndex=this.parent.activeSheetIndex}for(var ze=[],We=d.modelType==="Row"&&d.start<d.model.maxHgts.length,S=d.start;S<=d.end;S++)d.modelType==="Sheet"&&d.model[m][S]&&this.parent.notify(P.B7N,{action:"deleteSheetTab",sheetId:d.model[m][S].id}),d.model[m][d.start]||d.start<d.model[m].length?(ze.push(d.model[m][d.start]||{}),d.model[m].splice(d.start,1)):ze.push({}),S===d.start&&(ze[0].index=d.start),We&&d.model.maxHgts.splice(d.start,1);N.forEach(function(Xe){return M.parent.notify(P.mtj,Xe)}),this.parent.notify(P.ToX,d),d.modelType!=="Sheet"&&(this.parent.notify(P.cRm,d),v.refreshSheet=d.refreshSheet,v.activeSheetIndex=(0,F.Q8D)(this.parent,d.model.name),v.conditionalFormats=[],this.deleteConditionalFormats(d,v)),v.definedNames=V.definedNames,v.isAction=d.isAction,v.deletedModel=ze,delete v.cancel,this.parent.notify(P.mnp,y)}}},O.prototype.setRowColCount=function(d,M,T,b){var k=b+"Count";M>=T[k]&&(M=T[k]-1),!(M<d)&&(this.parent.setSheetPropertyOnMute(T,k,T[k]-(M-d+1)),T.id===this.parent.getActiveSheet().id&&this.parent.notify(F.XRp,{index:T[k]-1,update:b,isDelete:!0,start:d,end:M}))},O.prototype.setDeleteInfo=function(d,M,T,b){b===void 0&&(b="Row");var k=M-d+1,S=[];this.parent.getActiveSheet().ranges.forEach(function(m){m.info&&d<m.info[T]&&(m.info["delete"+b+"Range"]?m.info["delete"+b+"Range"].push([d,M]):m.info["delete"+b+"Range"]=[[d,M]],m.info[T]-=k,m.info["insert"+b+"Range"]&&(m.info["insert"+b+"Range"]=S))})},O.prototype.deleteConditionalFormats=function(d,M){var T=d.model.conditionalFormats;if(T)for(var b=0;b<T.length;b++){M.conditionalFormats.push((0,U.l7)({},T[b],null,!0));var k=(0,P.dK5)(T[b].range),S=(0,P.dK5)(d.model.selectedRange);d.modelType==="Column"&&S[1]<=k[1]&&S[3]>=k[3]||d.modelType==="Row"&&S[0]<=k[0]&&S[2]>=k[2]?(T.splice(T.indexOf(T[b]),1),b--):T[b].range=(0,P.i0K)((0,F.OJx)(d,k))}},O.prototype.addEventListener=function(){this.parent.on(P.$sV,this.deleteModel,this)},O.prototype.destroy=function(){this.removeEventListener(),this.parent=null},O.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(P.$sV,this.deleteModel)},O.prototype.getModuleName=function(){return"workbookdelete"},O}(),se=function(){function O(d){this.parent=d,this.addEventListener()}return O.prototype.destroy=function(){this.removeEventListener(),this.parent=null},O.prototype.addEventListener=function(){this.parent.on(P.dKh,this.validationHandler,this),this.parent.on(P.CC2,this.addHighlightHandler,this),this.parent.on(P.A2l,this.removeHighlightHandler,this),this.parent.on(P.x2y,this.beforeInsertDeleteHandler,this),this.parent.on(P.ToX,this.beforeInsertDeleteHandler,this)},O.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(P.dKh,this.validationHandler),this.parent.off(P.CC2,this.addHighlightHandler),this.parent.off(P.A2l,this.removeHighlightHandler),this.parent.off(P.x2y,this.beforeInsertDeleteHandler),this.parent.off(P.ToX,this.beforeInsertDeleteHandler))},O.prototype.validationHandler=function(d){var M=d.range,T="",b;d.range.indexOf("!")>-1&&(M=d.range.split("!")[1],T=d.range.split("!")[0]);var k=(0,w.zf)(this.parent,T?(0,w.Q8)(this.parent,T):this.parent.activeSheetIndex);this.parent.dataValidationRange=(this.parent.dataValidationRange.indexOf("!")>-1?"":k.name+"!")+this.parent.dataValidationRange+M+",";var S=!1,m=k.rowCount,x=M.split(":");M.match(/\D/g)&&!M.match(/[0-9]/g)?(x[0]+=1,x[1]+=m,M=x[0]+":"+x[1],S=!0):!M.match(/\D/g)&&M.match(/[0-9]/g)&&(x[0]="A"+x[0],x[1]=(0,P.qkm)(0,k.colCount-1).replace(/[0-9]/g,"")+x[1],M=x[0]+":"+x[1]),(0,U.le)(T)||(d.range=T+"!"+M),d.range=d.range||k.selectedRange;var v=(0,P.gaE)((0,P.dK5)(d.range));if(S)for(var y=v[1];y<=v[3];y++)b=(0,w.wD)(k,y),S=!(S&&d.isRemoveValidation&&b&&!b.validation);if(S)for(var y=v[1];y<=v[3];y++)b=(0,w.wD)(k,y),d.isRemoveValidation&&b&&b.validation?delete k.columns[y].validation:d.isRemoveValidation||((0,U.le)(b)&&(k.columns[y]=(0,w.wD)(k,y)),k.columns[y].validation={operator:d.rules.operator,type:d.rules.type,value1:d.rules.value1,value2:d.rules.value2,inCellDropDown:d.rules.inCellDropDown,ignoreBlank:d.rules.ignoreBlank});else for(var A=void 0,I=v[0];I<=v[2];I++)for(var y=v[1];y<=v[3];y++)d.isRemoveValidation?(I===v[2]&&(b=(0,w.wD)(k,y),b&&b.validation&&(b.validation.address=(0,P.kFj)(b.validation.address,[v[0],y,v[2],y],y))),A=(0,w.$S)(I,y,k),A&&A.validation&&!(0,P.wWT)(this.parent,k,{cell:{validation:{}},rowIdx:I,colIdx:y})&&(delete A.validation,this.parent.notify(P.nJk,{rowIdx:I,colIdx:y,style:this.parent.getCellStyleValue(["backgroundColor","color"],[I,y])}))):(A={validation:Object.assign({},d.rules)},(0,P.wWT)(this.parent,k,{cell:A,rowIdx:I,colIdx:y}))},O.prototype.addHighlightHandler=function(d){this.InvalidDataHandler(d.range,!1,d.td,d.isclearFormat)},O.prototype.removeHighlightHandler=function(d){this.InvalidDataHandler(d.range,!0)},O.prototype.getRange=function(d){var M=(0,P.dK5)(d),T=this.parent.getActiveSheet(),b=T.colCount,k=T.rowCount;return M[2]===k-1&&M[0]===0?d=d.replace(/[0-9]/g,""):M[3]===b-1&&M[2]===0&&(d=d.replace(/\D/g,"")),d},O.prototype.InvalidDataHandler=function(d,M,T,b){var k=!1,S,m,x=d?(0,P.MJG)(this.parent,d):this.parent.activeSheetIndex,v=(0,w.zf)(this.parent,x);d=d||v.selectedRange;var y=d?(0,P.gaE)((0,P.dK5)(d)):[];d=this.getRange(d);var A=!1;d.match(/\D/g)&&!d.match(/[0-9]/g)&&(A=!0);var I=d?y[0]:0,N=d?y[2]:v.rows.length;for(I;I<=N;I++)if(v.rows[I]){var z=d?y[1]:0,V=d?y[3]:v.rows[I].cells.length;for(z;z<=V;z++){var _=void 0;if(v.rows[I].cells&&v.rows[I].cells[z]){var G=(0,w.wD)(v,z);if(S=v.rows[I].cells[z],S&&S.validation){if(_=S.validation,b&&!_.isHighlighted)return;M?_.isHighlighted&&(S.validation.isHighlighted=!1):S.validation.isHighlighted=!0}else if(G&&G.validation){if(_=G.validation,b&&!_.isHighlighted)return;M&&A?_.isHighlighted&&(G.validation.isHighlighted=!1):A&&(G.validation.isHighlighted=!0)}m=S.value?S.value:"";var K=[I,z];if(_&&this.parent.allowDataValidation){var oe={value:m,range:K,sheetIdx:x,isCell:k,td:T,isValid:!0};this.parent.notify(P.trg,oe);var he=oe.isValid;he||!(0,w.gS)(v,I)&&x===this.parent.activeSheetIndex&&this.parent.notify(P.F5$,{isRemoveHighlightedData:M,rowIdx:I,colIdx:z,td:T})}}}}},O.prototype.beforeInsertDeleteHandler=function(d){if(d.modelType!=="Sheet")for(var M,T,b=0,k=this.parent.sheets.length;b<k;b++){T=this.parent.sheets[b];for(var S=0,m=T.rows.length;S<m;S++)if(T.rows[S]&&T.rows[S].cells){for(var x=0,v=T.rows[S].cells.length;x<v;x++)if(M=T.rows[S].cells[x],M&&M.validation){var y=d.name==="beforeInsert",A=d.index+(d.model.length-1),I=d.modelType==="Row"?S>=d.index&&S<=A:x>=d.index&&x<=A,N=void 0;y?N={insertDeleteArgs:{startIndex:d.index,endIndex:d.index+d.model.length-1,modelType:d.modelType,isInsert:!0,sheet:(0,w.zf)(this.parent,d.activeSheetIndex)},row:S,col:x}:N={insertDeleteArgs:{startIndex:d.start,endIndex:d.end,modelType:d.modelType,sheet:d.model},row:S,col:x},(0,P.C2M)(M.validation.value1)&&!I&&(N.cell={formula:M.validation.value1},this.parent.notify(P.aU5,N),M.validation.value1=N.cell.formula),(0,P.C2M)(M.validation.value2)&&!I&&(N.cell={formula:M.validation.value2},this.parent.notify(P.aU5,N),M.validation.value2=N.cell.formula),d.activeSheetIndex===b&&y&&this.updateValidationForInsertedModel(d,T,S,x,M.validation)}}}},O.prototype.updateValidationForInsertedModel=function(d,M,T,b,k){var S=d.index+(d.model.length-1);if(d.modelType==="Column"){if(d.insertType==="before"&&S===b-1||d.insertType==="after"&&d.index-1===b)for(var m=d.index;m<=S;m++)(0,w.Jx)(T,m,M,{validation:(0,U.l7)({},k)},!0)}else if(d.modelType==="Row"&&(d.insertType==="above"&&S===T-1||d.insertType==="below"&&d.index-1===T))for(var m=d.index;m<=S;m++)(0,w.Jx)(m,b,M,{validation:(0,U.l7)({},k)},!0)},O.prototype.getModuleName=function(){return"workbookDataValidation"},O}(),re=function(){return re=Object.assign||function(O){for(var d,M=1,T=arguments.length;M<T;M++){d=arguments[M];for(var b in d)Object.prototype.hasOwnProperty.call(d,b)&&(O[b]=d[b])}return O},re.apply(this,arguments)},Ae=function(){function O(d){this.parent=d,this.addEventListener()}return O.prototype.destroy=function(){this.removeEventListener(),this.parent=null},O.prototype.addEventListener=function(){this.parent.on(P.gaV,this.findNext,this),this.parent.on(P.a7B,this.findPrevious,this),this.parent.on(P.gxs,this.replace,this),this.parent.on(P.kon,this.replaceAll,this),this.parent.on(P.QXW,this.totalCount,this),this.parent.on(P.GHh,this.findAllValues,this)},O.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(P.gaV,this.findNext),this.parent.off(P.a7B,this.findPrevious),this.parent.off(P.gxs,this.replace),this.parent.off(P.kon,this.replaceAll),this.parent.off(P.QXW,this.totalCount),this.parent.off(P.GHh,this.findAllValues))},O.prototype.findNext=function(d){var M=this.parent.sheets,T,b=(0,U.o8)(d.sheetIndex)?this.parent.activeSheetIndex:d.sheetIndex,k=M[b],S=(0,P.n53)(k.activeCell),m=k.usedRange,x=m.colIndex,v=d.value.toString(),y,A,I=0,N=m.rowIndex,z=0,V,_;y=S[1],A=S[0];var G=y,K=A;if(k.rows[A]&&k.rows[A].cells&&k.rows[A].cells[y])if(V=k.rows[A].cells[y].format,V){var oe=this.parent.getDisplayText(k.rows[A].cells[y]);_=oe.toString()}else k.rows[A].cells[y].value&&(_=k.rows[A].cells[y].value.toString());if(_){var he=_.toLowerCase(),ue=_.indexOf(d.value)>-1,X=he.indexOf(d.value.toString().toLowerCase())>-1;(v===_||v===he||ue||X)&&(d.searchBy==="By Column"?A++:y++,I++)}(S[0]>k.usedRange.rowIndex||S[1]>k.usedRange.colIndex)&&(S[0]>k.usedRange.rowIndex&&S[1]<=k.usedRange.colIndex?(A=0,y=S[1]):S[0]<=k.usedRange.rowIndex&&S[1]>k.usedRange.colIndex?(A=S[0],y=0):(A=0,y=0));var Ce={rowIndex:A,colIndex:y,usedRange:m,endRow:N,endColumn:x,startRow:K,mode:d.mode,loopCount:z,count:I,args:d,val:T,stringValue:v,sheetIndex:b,startColumn:G,sheets:M};d.searchBy==="By Row"&&this.findNxtRow(Ce),d.searchBy==="By Column"&&this.findNxtCol(Ce)},O.prototype.findNxtRow=function(d){var M,T=d.sheets[d.sheetIndex],b=this.parent.sheets.length;M=T.usedRange;var k=(0,P.n53)(T.activeCell);for(d.colIndex>=d.usedRange.colIndex+1&&(d.colIndex=0,d.rowIndex++),d.rowIndex;d.rowIndex<=d.endRow+1;d.rowIndex++){if(d.rowIndex>d.endRow){if(d.mode==="Workbook"){var S=this.parent.activeSheetIndex;if(d.sheetIndex++,b===d.sheetIndex&&(d.sheetIndex=0),S===d.sheetIndex&&d.count===0){this.parent.notify(P.vCD,null);return}T=d.sheets[d.sheetIndex],M=T.usedRange,k=(0,P.n53)(T.activeCell),d.rowIndex=0,d.colIndex=0,d.endColumn=M.colIndex,d.endRow=M.rowIndex}if(d.colIndex===0&&d.rowIndex>d.endRow)if(k[0]===0&&k[1]===0){if(d.count===0){this.parent.notify(P.vCD,null);return}}else(k[0]!==0&&k[1]!==0||k[0]!==0||k[1]!==0)&&(d.startColumn=0,d.startRow=0,d.endColumn=M.colIndex,d.endRow=k[0],d.rowIndex=d.startRow,d.colIndex=d.startColumn,d.loopCount++)}if(d.count>0&&M.rowIndex<d.rowIndex&&(d.rowIndex=0,d.rowIndex===0&&(d.colIndex=0)),T.rows[d.rowIndex]){var m=T.rows[d.rowIndex];for(d.colIndex;d.colIndex<=d.endColumn;d.colIndex++)if(m&&m.cells&&m.cells[d.colIndex]){var x=this.nextCommon(d);if(x)return}if(d.colIndex>d.endColumn&&(d.colIndex=0),d.loopCount>0&&k[0]===d.rowIndex){this.parent.notify(P.vCD,null);return}}}if(d.count===0){this.parent.notify(P.vCD,null);return}},O.prototype.findNxtCol=function(d){var M=d.sheets[d.sheetIndex],T,b=(0,P.n53)(M.activeCell),k=this.parent.sheets.length;for(d.rowIndex>=d.usedRange.rowIndex&&(d.rowIndex=0,d.colIndex++),d.colIndex;d.colIndex<=d.usedRange.colIndex+1;d.colIndex++){if(d.colIndex>=d.endColumn+1&&d.mode==="Workbook"){if(T=this.parent.activeSheetIndex,d.sheetIndex++,k===d.sheetIndex&&(d.sheetIndex=0),T===d.sheetIndex&&d.count===0){this.parent.notify(P.vCD,null);return}M=d.sheets[d.sheetIndex],d.usedRange=M.usedRange,b=(0,P.n53)(M.activeCell),d.colIndex=0,d.rowIndex=0,d.endColumn=d.usedRange.colIndex,d.endRow=d.usedRange.rowIndex}if(d.colIndex>=d.endColumn+1&&(d.colIndex=0),d.rowIndex>d.endRow&&d.colIndex===0)if(b[0]===0&&b[1]===0||b[1]>M.usedRange.rowIndex||b[0]>M.usedRange.colIndex){if(d.count===0){this.parent.notify(P.vCD,null);return}}else(b[1]!==0||b[0]!==0||b[1]!==0&&b[0]!==0)&&(d.startRow=0,d.startColumn=0,d.endRow=b[0],d.endColumn=d.usedRange.colIndex,d.colIndex=d.startColumn,d.rowIndex=d.startRow,d.loopCount++);if(d.count>0&&d.usedRange.colIndex+1<d.colIndex&&(d.colIndex=0,d.rowIndex=0),d.rowIndex>=d.endRow&&(d.rowIndex=0),d.colIndex<=d.usedRange.colIndex){for(d.rowIndex;d.rowIndex<=d.usedRange.rowIndex;d.rowIndex++)if(M.rows[d.rowIndex]&&M.rows[d.rowIndex].cells&&M.rows[d.rowIndex].cells[d.colIndex]){var S=this.nextCommon(d);if(S)return}if(d.loopCount>0&&b[1]===d.colIndex){this.parent.notify(P.vCD,null);return}}}if(d.count===0){this.parent.notify(P.vCD,null);return}},O.prototype.nextCommon=function(d){var M=d.sheets[d.sheetIndex];if(M.rows[d.rowIndex]){var T=M.rows[d.rowIndex].cells[d.colIndex];if(T&&T.value){if(M.isProtected&&(T.isLocked||T.isLocked===void 0)&&M.protectSettings.selectUnLockedCells)return!1;var b=M.rows[d.rowIndex].cells[d.colIndex];if(b){var k=void 0;if(b.format){var S=this.parent.getDisplayText(M.rows[d.rowIndex].cells[d.colIndex]);k=S}else k=M.rows[d.rowIndex].cells[d.colIndex].value.toString();if(d.args.isCSen&&d.args.isEMatch){if(k===d.stringValue){var m=M.name+"!"+(0,P.qkm)(d.rowIndex,d.colIndex);return this.parent.notify(P.E9X,{address:m}),d.count++,!0}}else if(d.args.isCSen&&!d.args.isEMatch){var x=k.indexOf(d.args.value)>-1;if(k===d.stringValue||x){var m=M.name+"!"+(0,P.qkm)(d.rowIndex,d.colIndex);return this.parent.notify(P.E9X,{address:m}),d.count++,!0}}else if(!d.args.isCSen&&d.args.isEMatch){if(d.val=k.toString().toLowerCase(),d.val===d.stringValue){var m=M.name+"!"+(0,P.qkm)(d.rowIndex,d.colIndex);return this.parent.notify(P.E9X,{address:m}),d.count++,!0}}else if(!d.args.isCSen&&!d.args.isEMatch){d.val=k.toString().toLowerCase();var x=d.val.indexOf(d.args.value.toString().toLowerCase())>-1,v=d.val.indexOf(d.args.value)>-1;if(d.val===d.stringValue||k===d.stringValue||x||k===d.stringValue||v){var m=M.name+"!"+(0,P.qkm)(d.rowIndex,d.colIndex);return this.parent.notify(P.E9X,{address:m}),d.count++,!0}}}}}return!1},O.prototype.findPrevious=function(d){var M=this.parent.sheets,T=d.sheetIndex,b=M[T],k,S,m,x=(0,P.n53)(b.activeCell),v=0,y=0,A=b.usedRange.rowIndex,I=b.usedRange.colIndex,N=d.value.toString(),z=x[1],V=x[0],_=z,G=V;if(b.rows[V]&&b.rows[V].cells[z])if(S=b.rows[V].cells[z].format,S){var K=this.parent.getDisplayText(b.rows[V].cells[z]);k=K.toString()}else b.rows[V].cells[z].value&&(k=b.rows[V].cells[z].value.toString());if(k){var oe=k.toLowerCase(),he=k.indexOf(d.value)>-1,ue=oe.indexOf(d.value.toString().toLowerCase())>-1;(N===k||N===oe||he||ue)&&(d.searchBy==="By Row"&&z--,d.searchBy==="By Column"&&V--,y++)}(x[0]>b.usedRange.rowIndex||x[1]>b.usedRange.colIndex)&&(x[0]>b.usedRange.rowIndex&&x[1]<=b.usedRange.colIndex?(V=b.usedRange.rowIndex,z=x[1]):x[0]<=b.usedRange.rowIndex&&x[1]>b.usedRange.colIndex?(V=x[0],z=b.usedRange.colIndex):(V=b.usedRange.rowIndex,z=b.usedRange.colIndex));var X={rowIndex:V,colIndex:z,endRow:A,endColumn:I,startRow:G,loopCount:v,count:y,args:d,val:m,stringValue:N,sheets:M,sheetIndex:T,startColumn:_};d.searchBy==="By Row"&&this.findPreRow(X),d.searchBy==="By Column"&&this.findPreCol(X)},O.prototype.findPreRow=function(d){var M,T=d.sheets[d.sheetIndex],b=this.parent.sheets.length,k=!1,S=(0,P.n53)(T.activeCell);for(d.colIndex===-1&&(d.colIndex=d.endColumn,d.rowIndex--),d.rowIndex;d.rowIndex>=-1;d.rowIndex--){if(d.rowIndex<0&&d.colIndex<=0){if(d.args.mode==="Workbook"){var m=this.parent.activeSheetIndex;if(d.sheetIndex--,d.sheetIndex===-1&&(d.sheetIndex=b-1),m===d.sheetIndex&&d.count===0){this.parent.notify(P.vCD,null);return}T=d.sheets[d.sheetIndex],M=T.usedRange,S=(0,P.n53)(T.activeCell),d.rowIndex=M.rowIndex,d.colIndex=M.colIndex,d.endColumn=0,d.endRow=0}k=this.commonCondition(d,S)}if(!k){d.args.mode!=="Workbook"&&d.count>0&&d.rowIndex===-1&&(d.rowIndex=d.endRow),d.rowIndex===-1&&(d.rowIndex=T.usedRange.rowIndex,d.colIndex=T.usedRange.colIndex);var x=T.rows[d.rowIndex];if(x){for(d.colIndex===-1&&(d.colIndex=T.usedRange.colIndex),d.colIndex;d.colIndex>=0;d.colIndex--)if(x&&x.cells&&x.cells[d.colIndex]){var v=this.prevCommon(d);if(v)return}if(d.loopCount>0&&S[0]===d.rowIndex){this.parent.notify(P.vCD,null);return}}}}if(!k&&d.count===0){this.parent.notify(P.vCD,null);return}},O.prototype.findPreCol=function(d){var M,T=d.sheets[d.sheetIndex],b=this.parent.sheets.length,k=!1,S=(0,P.n53)(T.activeCell);for(d.colIndex;d.colIndex>=-1;d.colIndex--){if(d.rowIndex<0&&d.colIndex<=0){if(d.args.mode==="Workbook"){var m=this.parent.activeSheetIndex;if(d.sheetIndex--,d.sheetIndex===-1&&(d.sheetIndex=b-1),m===d.sheetIndex&&d.count===0){this.parent.notify(P.vCD,null);return}T=d.sheets[d.sheetIndex],M=T.usedRange,S=(0,P.n53)(T.activeCell),d.rowIndex=M.rowIndex,d.colIndex=M.colIndex,d.endColumn=0,d.endRow=0}k=this.commonCondition(d,S)}if(!k){d.count>0&&d.colIndex<0&&(d.colIndex=d.endColumn),d.rowIndex<0&&(d.rowIndex=T.usedRange.rowIndex),d.colIndex<-1&&(d.colIndex=T.usedRange.colIndex,d.rowIndex--);var x=T.rows[d.rowIndex];for(x&&T.rows[d.rowIndex].cells[d.colIndex]&&d.rowIndex===-1&&(d.rowIndex=T.usedRange.rowIndex),d.rowIndex;d.rowIndex>=0;d.rowIndex--){if(x&&x.cells&&x.cells[d.colIndex]){var v=this.prevCommon(d);if(v)return}if(d.loopCount>0&&S[1]===d.colIndex){this.parent.notify(P.vCD,null);return}}}}if(!k&&d.count===0){this.parent.notify(P.vCD,null);return}},O.prototype.commonCondition=function(d,M){var T=d.sheets[d.sheetIndex],b;return M[0]!==d.endRow&&M[1]!==d.endColumn||M[0]!==d.endRow||M[1]!==d.endColumn?(d.startColumn=T.usedRange.colIndex,d.startRow=T.usedRange.rowIndex,d.endColumn=0,d.endRow=M[0],d.rowIndex=d.startRow,d.colIndex=d.startColumn,d.loopCount++,b=!1):(M[0]===T.usedRange.rowIndex&&M[1]===T.usedRange.colIndex||M[0]>T.usedRange.rowIndex||M[1]>T.usedRange.colIndex)&&M[0]!==0&&M[1]!==0&&(this.parent.notify(P.vCD,null),b=!0),b},O.prototype.prevCommon=function(d){var M=d.sheets[d.sheetIndex];if(M.rows[d.rowIndex]){var T=M.rows[d.rowIndex].cells[d.colIndex];if(T&&T.value){if(M.isProtected&&(T.isLocked||T.isLocked===void 0)&&M.protectSettings.selectUnLockedCells)return!1;var b=M.rows[d.rowIndex].cells[d.colIndex];if(b){var k=void 0;if(b.format){var S=this.parent.getDisplayText(M.rows[d.rowIndex].cells[d.colIndex]);k=S}else k=M.rows[d.rowIndex].cells[d.colIndex].value.toString();if(d.args.isCSen&&d.args.isEMatch){if(k===d.stringValue){var m=M.name+"!"+(0,P.qkm)(d.rowIndex,d.colIndex);return this.parent.notify(P.E9X,{address:m}),d.count++,!0}}else if(d.args.isCSen&&!d.args.isEMatch){var x=k.indexOf(d.args.value)>-1;if(k===d.stringValue||x){var m=M.name+"!"+(0,P.qkm)(d.rowIndex,d.colIndex);return this.parent.notify(P.E9X,{address:m}),d.count++,!0}}else if(!d.args.isCSen&&d.args.isEMatch){if(d.val=k.toString().toLowerCase(),d.val===d.stringValue){var m=M.name+"!"+(0,P.qkm)(d.rowIndex,d.colIndex);return this.parent.notify(P.E9X,{address:m}),d.count++,!0}}else if(!d.args.isCSen&&!d.args.isEMatch){d.val=k.toString().toLowerCase();var x=d.val.indexOf(d.args.value.toString().toLowerCase())>-1,v=d.val.indexOf(d.args.value)>-1;if(k===d.stringValue||k===d.stringValue||x||d.val===d.stringValue||v){var m=M.name+"!"+(0,P.qkm)(d.rowIndex,d.colIndex);return this.parent.notify(P.E9X,{address:m}),d.count++,!0}}}}}return!1},O.prototype.replace=function(d){var M=(0,U.o8)(d.sheetIndex)?this.parent.activeSheetIndex:d.sheetIndex,T=(0,w.zf)(this.parent,d.sheetIndex);if(T.isProtected){this.parent.notify(P.pwO,null);return}var b=d.address,k=(0,P.dK5)(b||T.activeCell),S=this.parent.getDisplayText((0,w.$S)(k[0],k[1],T,!1,!0)).toString(),m;d.value=d.value.toString(),d.isCSen||(m=d.value.toLowerCase());var x=this.getReplaceValue(d,S,m);if(!(!x&&(d.findOpt="next",this.findNext(d),k=(0,P.n53)(T.activeCell),S=this.parent.getDisplayText((0,w.$S)(k[0],k[1],T)).toString(),x=this.getReplaceValue(d,S,m),!x))){var v={address:T.name+"!"+(0,P.qkm)(k[0],k[1]),cancel:!1,compareValue:d.value,replaceValue:d.replaceValue,sheetIndex:M};if(d.isAction){if(this.parent.notify(P.ya2,{action:"beforeReplace",eventArgs:v}),v.cancel)return;delete v.cancel}(0,P.wWT)(this.parent,T,{cell:{value:x},rowIdx:k[0],colIdx:k[1],uiRefresh:!0,valChange:!0}),d.isAction&&this.parent.notify("actionComplete",{action:"replace",eventArgs:v})}},O.prototype.replaceAll=function(d){var M=this,T=d.mode==="Sheet"?d.sheetIndex:0,b=this.parent.sheets[T],k=b.usedRange.rowIndex,S=0,m=b.usedRange.colIndex,x=0,v=[],y=d.isAction,A=re({addressCollection:v,cancel:!1},d),I=function(G,K){requestAnimationFrame?requestAnimationFrame(function(){if(!A.cancel&&A.addressCollection[K]){var oe=(0,P.n53)(A.addressCollection[K].split("!")[1]);(0,P.wWT)(M.parent,b,{cell:{value:G},rowIdx:oe[0],colIdx:oe[1],uiRefresh:!0,valChange:!0}),K===A.addressCollection.length-1&&y&&M.parent.notify("actionComplete",{action:"replaceAll",eventArgs:A})}}):M.parent.updateCell({value:G},A.addressCollection[K])},N,z,V;for(S;S<=k+1;S++){if(x>m&&S>k&&d.mode==="Workbook")if(T++,b=this.parent.sheets[T],b)x=0,S=0,m=b.usedRange.colIndex,k=b.usedRange.rowIndex;else break;if(z=b.rows[S],z){for(x===m+1&&(x=0),x;x<=m;x++)if(z&&z.cells&&z.cells[x]&&(N=this.parent.getDisplayText(b.rows[S].cells[x]).toString(),N))if(d.isCSen)d.isEMatch?N===d.value&&(I(d.replaceValue,v.length),v.push(b.name+"!"+(0,P.qkm)(S,x))):N.indexOf(d.value)>-1&&(I(N.replace(d.value,d.replaceValue),v.length),v.push(b.name+"!"+(0,P.qkm)(S,x)));else if(d.isEMatch)N.toLowerCase()===d.value&&(I(d.replaceValue,v.length),v.push(b.name+"!"+(0,P.qkm)(S,x)));else{var _=N.toLowerCase();(N===d.value||_.indexOf(d.value.toString().toLowerCase())>-1||_===d.value||N===d.value||_.indexOf(d.value)>-1)&&(V=new RegExp(d.value.toString().replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig"),I(N.replace(V,d.replaceValue),v.length),v.push(b.name+"!"+(0,P.qkm)(S,x)))}}}v.length&&y?(this.parent.notify("actionBegin",{action:"beforeReplaceAll",eventArgs:A}),A.cancel||this.parent.notify(P.RDz,{count:A.addressCollection.length,replaceValue:A.replaceValue})):this.parent.notify(P.RDz,{count:A.addressCollection.length,replaceValue:A.replaceValue})},O.prototype.getReplaceValue=function(d,M,T){return d.isCSen?d.isEMatch?M===d.value&&d.replaceValue:M.indexOf(d.value)>-1&&M.replace(d.value,d.replaceValue):d.isEMatch?M.toLowerCase()===T&&d.replaceValue:M.toLowerCase().includes(T)&&M.replace(new RegExp(d.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig"),d.replaceValue)},O.prototype.totalCount=function(d){var M=this,T=this.parent.sheets[d.sheetIndex],b=(0,P.n53)(T.activeCell),k=0,S=0,m,x=d.value.toLowerCase();T.rows.filter(function(y,A){return y&&y.cells&&y.cells.filter(function(I,N){I&&(I.value||I.value===0)&&(m=(I.format?M.parent.getDisplayText(I):I.value.toString()).toLowerCase(),m.includes(x)&&(k++,(A===b[0]&&N>=b[1]||A>b[0])&&S++))})}),S-=1;var v=k;k=v-S,k>v&&(k=v),k!==0&&!this.parent.getDisplayText((0,w.$S)(b[0],b[1],T)).toLowerCase().includes(x)&&(k-=1),d.findCount=k+" of "+v},O.prototype.findAllValues=function(d){var M=d.sheetIndex,T=this.parent.sheets[M],b=T.usedRange.rowIndex,k=0,S=0,m,x=T.usedRange.colIndex,v=0,y=this.parent.sheets.length,A=d.sheetIndex;for(k;k<=b+1;k++){if(A!==1&&d.sheetIndex===y&&(M=1),k>b&&v>x&&d.mode==="Workbook"){if(M++,A===M)return S===0,void 0;M>y-1&&(M=0),T=this.parent.sheets[M],T&&(k=0,v=0,x=T.usedRange.colIndex,b=T.usedRange.rowIndex)}if(!(0,U.le)(T)&&T.rows[k]){var I=T.rows[k];for(v===x+2&&(v=0),v;v<=x+1;v++)if(I&&I.cells&&I.cells[v]){var N=T.rows[k].cells[v];if(N){var z=N.format,V=void 0;if(z){var _=this.parent.getDisplayText(T.rows[k].cells[v]);V=_.toString()}else V=N.value.toString();if(d.isCSen&&d.isEMatch)V===d.value&&(m=T.name+"!"+(0,P.qkm)(k,v),d.findCollection.push(m),S++);else if(d.isCSen&&!d.isEMatch){var G=V.indexOf(d.value)>-1;(V===d.value||G)&&(m=T.name+"!"+(0,P.qkm)(k,v),d.findCollection.push(m),S++)}else if(!d.isCSen&&d.isEMatch){var K=V.toString().toLowerCase();K===d.value&&(m=T.name+"!"+(0,P.qkm)(k,v),d.findCollection.push(m),S++)}else if(!d.isCSen&&!d.isEMatch){var K=V.toString().toLowerCase(),G=K.indexOf(d.value.toLowerCase())>-1;(K===d.value||V===d.value||G||V===d.value)&&(m=T.name+"!"+(0,P.qkm)(k,v),d.findCollection.push(m),S++)}}}}}},O.prototype.getModuleName=function(){return"workbookfindAndReplace"},O}(),Ie=function(){function O(d){this.parent=d,this.addEventListener()}return O.prototype.protectsheetHandler=function(d){var M=(0,U.le)(d.sheetIndex)?this.parent.activeSheetIndex:d.sheetIndex,T=(0,w.zf)(this.parent,M);this.parent.setSheetPropertyOnMute(T,"isProtected",!0),this.parent.setSheetPropertyOnMute(T,"protectSettings",{selectCells:d.protectSettings.selectCells,formatCells:d.protectSettings.formatCells,formatColumns:d.protectSettings.formatColumns,formatRows:d.protectSettings.formatRows,insertLink:d.protectSettings.insertLink,selectUnLockedCells:d.protectSettings.selectUnLockedCells}),this.parent.notify(P.hgb,{sheetIndex:M,triggerEvent:d.triggerEvent}),this.parent.notify(P.fg8,{props:"Protect"}),T.password=d.password?d.password:"",T.columns.forEach(function(b){b&&(0,U.o8)(b.isLocked)&&(b.isLocked=!0)})},O.prototype.unprotectsheetHandler=function(d){var M=this.parent.getActiveSheet();d.sheet&&(M=this.parent.sheets[d.sheet]),M.protectSettings.formatCells=M.protectSettings.formatColumns=!1,M.protectSettings.formatRows=M.protectSettings.selectCells=!1,this.parent.setSheetPropertyOnMute(M,"isProtected",!1),this.parent.notify(P.hgb,M.protectSettings),this.parent.notify(P.fg8,{props:"Protect"})},O.prototype.destroy=function(){this.removeEventListener(),this.parent=null},O.prototype.addEventListener=function(){this.parent.on(P.tVr,this.protectsheetHandler,this),this.parent.on(P.X5W,this.unprotectsheetHandler,this),this.parent.on(P.YYv,this.lockCells,this)},O.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(P.tVr,this.protectsheetHandler),this.parent.off(P.YYv,this.lockCells),this.parent.off(P.tVr,this.unprotectsheetHandler))},O.prototype.lockCells=function(d){var M=this.parent.getAddressInfo(d.range),T=(0,P.gaE)(M.indices),b=(0,w.zf)(this.parent,M.sheetIndex),k={isLocked:d.isLocked?d.isLocked:!1};if(T[0]===0&&T[2]===b.rowCount-1)for(var S=T[1];S<=T[3];S++)(0,w.XV)(b,S,{isLocked:d.isLocked});for(var S=T[0];S<=T[2];S++)for(var m=T[1];m<=T[3];m++)(0,w.Jx)(S,m,b,k,!0);d.triggerEvent&&this.parent.notify("actionComplete",{action:"lockCells",eventArgs:d})},O.prototype.getModuleName=function(){return"workbookProtectSheet"},O}(),Se=function(){function O(d){this.parent=d,this.addEventListener()}return O.prototype.merge=function(d){d.sheetIndex=(0,U.o8)(d.sheetIndex)?this.parent.activeSheetIndex:d.sheetIndex,d.isAction&&(this.parent.notify("actionBegin",{eventArgs:d,action:"merge"}),d.model||(d.model=[])),typeof d.range=="string"&&(d.range=(0,P.dK5)(d.range)),d.range=(0,P.gaE)(d.range),d.skipChecking||this.mergedRange(d),!d.merge||d.type==="All"?(this.mergeAll(d),d.refreshRibbon&&this.parent.notify(P.q6q,null)):d.type==="Horizontally"?this.mergeHorizontally(d):d.type==="Vertically"&&this.mergeVertically(d),this.parent.setUsedRange(d.range[2],d.range[3]),d.isAction&&this.parent.notify("actionComplete",{eventArgs:d,action:"merge"}),d.sheetIndex===this.parent.activeSheetIndex&&this.parent.notify("selectRange",{address:(0,w.zf)(this.parent,d.sheetIndex).selectedRange,skipChecking:!0})},O.prototype.mergeAll=function(d){var M=0,T;d.range=d.range;for(var b,k,S,m=(0,U.o8)(d.sheetIndex)?this.parent.getActiveSheet():(0,w.zf)(this.parent,d.sheetIndex),x=d.range[0];x<=d.range[2];x++){b=0,d.isAction&&d.model.push({cells:[]});for(var v=d.range[1];v<=d.range[3];v++){if(T=(0,w.$S)(x,v,m),T&&(T.value||T.formula)&&!k&&(k=T.formula||T.value),d.isAction&&d.merge&&(d.model[x-d.range[0]].cells[v-d.range[1]]={},(0,U.l7)(d.model[x-d.range[0]].cells[v-d.range[1]],T,null,!0)),m.rows[x]&&m.rows[x].cells&&m.rows[x].cells[v]&&(delete m.rows[x].cells[v].rowSpan,delete m.rows[x].cells[v].colSpan,!d.merge&&!d.isAction&&d.model&&d.model[x-d.range[0]]&&d.model[x-d.range[0]].cells[v-d.range[1]]&&d.model[x-d.range[0]].cells[v-d.range[1]]!=={}&&(0,w.Jx)(x,v,m,d.model[x-d.range[0]].cells[v-d.range[1]])),d.merge)if(T=new Object,x===d.range[0]&&v===d.range[1]){d.range[3]-d.range[1]>0&&(T.colSpan=d.range[3]-d.range[1]+1),d.range[2]-d.range[0]>0&&(T.rowSpan=d.range[2]-d.range[0]+1),(0,w.Jx)(d.range[0],d.range[1],m,T,!0);continue}else x!==d.range[0]&&(T.rowSpan=-M),v!==d.range[1]&&(b++,T.colSpan=-b),m.rows[x]&&m.rows[x].cells&&m.rows[x].cells[v]&&(delete m.rows[x].cells[v].value,delete m.rows[x].cells[v].formula),S=(0,w.$S)(x,v,m)||{},(0,w.Jx)(x,v,m,Object.assign(T,S));d.preventRefresh||this.parent.notify(P.i8F,{rowIdx:x,colIdx:v})}M++}d.merge&&(T=this.getCellValue(d.range[0],d.range[1],k,m),(0,w.Jx)(d.range[0],d.range[1],m,T,!0),d.preventRefresh||this.parent.notify(P.i8F,{rowIdx:d.range[0],colIdx:d.range[1]}))},O.prototype.mergeHorizontally=function(d){var M;d.range=d.range;for(var T,b=(0,w.zf)(this.parent,d.sheetIndex),k,S,m,x=d.range[0];x<=d.range[2];x++){M=0,d.isAction&&d.model.push({cells:[]});for(var v=d.range[1];v<=d.range[3];v++){if(m=(0,w.$S)(x,v,b),T=new Object,d.isAction&&(d.model[x-d.range[0]].cells[v-d.range[1]]={},Object.assign(d.model[x-d.range[0]].cells[v-d.range[1]],m)),v===d.range[1]){if(x===d.range[0])continue;S=x-1,b.rows[S]&&b.rows[S].cells&&b.rows[S].cells[v]&&delete b.rows[S].cells[v].rowSpan,T=this.getCellValue(S,v,k,b),d.range[3]-d.range[1]>0&&(T.colSpan=d.range[3]-d.range[1]+1),k=null,(0,w.Jx)(S,v,b,T,!0)}else m&&(m.value||m.formula)&&!k&&(k=m.formula||m.value),S=x,b.rows[S]&&b.rows[S].cells&&b.rows[S].cells[v]&&(delete b.rows[S].cells[v].rowSpan,delete b.rows[S].cells[v].value,delete b.rows[S].cells[v].formula),M++,T.colSpan=-M,(0,w.Jx)(S,v,b,T,!0);this.parent.notify(P.i8F,{rowIdx:S,colIdx:v})}}b.rows[d.range[2]]&&b.rows[d.range[2]].cells&&b.rows[d.range[2]].cells[d.range[1]]&&delete b.rows[d.range[2]].cells[d.range[1]].rowSpan,T=this.getCellValue(d.range[2],d.range[1],k,b),d.range[3]-d.range[1]>0&&(T.colSpan=d.range[3]-d.range[1]+1),(0,w.Jx)(d.range[2],d.range[1],b,T,!0),this.parent.notify(P.i8F,{rowIdx:d.range[2],colIdx:d.range[1]})},O.prototype.getCellValue=function(d,M,T,b){var k=new Object,S=(0,w.$S)(d,M,b);return T&&(!S||!S.value&&!S.formula)&&((0,P.C2M)(T)?k.formula=T:k.value=T),k},O.prototype.mergeVertically=function(d){var M=0;d.range=d.range;for(var T=(0,w.zf)(this.parent,d.sheetIndex),b,k,S,m,x=d.range[1];x<=d.range[3];x++)for(var v=d.range[0];v<=d.range[2];v++){if(m=(0,w.$S)(v,x,T),d.isAction&&(d.model[v-d.range[0]]===void 0&&(d.model[v-d.range[0]]={cells:[]}),d.model[v-d.range[0]].cells[x-d.range[1]]={},Object.assign(d.model[v-d.range[0]].cells[x-d.range[1]],m)),v===d.range[0]){if(M=0,x===d.range[1])continue;S=x-1,T.rows[v]&&T.rows[v].cells&&T.rows[v].cells[S]&&delete T.rows[v].cells[S].colSpan,b=this.getCellValue(v,S,k,T),d.range[2]-d.range[0]>0&&(b.rowSpan=d.range[2]-d.range[0]+1),k=null,(0,w.Jx)(v,S,T,b,!0)}else b=new Object,m&&(m.value||m.formula)&&!k&&(k=m.formula||m.value),M++,S=x,T.rows[v]&&T.rows[v].cells&&T.rows[v].cells[S]&&(delete T.rows[v].cells[S].colSpan,delete T.rows[v].cells[S].value,delete T.rows[v].cells[S].formula),b.rowSpan=-M,(0,w.Jx)(v,S,T,b,!0);this.parent.notify(P.i8F,{rowIdx:v,colIdx:S})}T.rows[d.range[0]]&&T.rows[d.range[0]].cells&&T.rows[d.range[0]].cells[d.range[3]]&&delete T.rows[d.range[0]].cells[d.range[3]].colSpan,b=this.getCellValue(d.range[0],d.range[1],k,T),d.range[2]-d.range[0]>0&&(b.rowSpan=d.range[2]-d.range[0]+1),(0,w.Jx)(d.range[0],d.range[3],T,b,!0),this.parent.notify(P.i8F,{rowIdx:d.range[0],colIdx:d.range[3]})},O.prototype.activeCellRange=function(d){d.range=d.range;var M=this.parent.getActiveSheet(),T=(0,w.$S)(d.range[0],d.range[1],M);T&&(!(0,U.le)(T.rowSpan)&&T.rowSpan<0&&(d.range[0]+=T.rowSpan,d.insertCount&&(d.range[0]-=d.insertCount)),!(0,U.le)(T.colSpan)&&T.colSpan<0&&(d.range[1]+=T.colSpan,d.insertCount&&(d.range[1]-=d.insertCount)),T=(0,w.$S)(d.range[0],d.range[1],M),T&&(T.rowSpan>1&&(d.range[0]+(T.rowSpan-1)>=d.range[2]||d.insertCount)&&(d.range[2]=d.range[0]+(T.rowSpan-1)),T.colSpan>1&&(d.range[1]+(T.colSpan-1)>=d.range[3]||d.insertCount)&&(d.range[3]=d.range[1]+(T.colSpan-1))))},O.prototype.mergedRange=function(d){typeof d.range=="string"&&(d.range=(0,P.dK5)(d.range)),d.range[0]<=d.range[2]&&d.range[1]<=d.range[3]?this.forward(d):d.range[0]>=d.range[2]&&d.range[1]>=d.range[3]?this.reverse(d):d.range[0]<d.range[2]&&d.range[1]>d.range[3]?this.forwardReverse(d):d.range[0]>d.range[2]&&d.range[1]<d.range[3]&&this.reverseForward(d)},O.prototype.forward=function(d){d.range=d.range;var M=(0,U.o8)(d.sheetIndex)?this.parent.getActiveSheet():(0,w.zf)(this.parent,d.sheetIndex),T=(0,w.$S)(d.range[0],d.range[1],M),b,k,S=b=d.range[0],m=k=d.range[1];if(T&&(!(0,U.le)(T.rowSpan)&&T.rowSpan<0&&(S=b=d.range[0]+T.rowSpan),!(0,U.le)(T.colSpan)&&T.colSpan<0&&(m=k=d.range[1]+T.colSpan),T=(0,w.$S)(S,m,M),T&&(T.rowSpan>1&&(b+=T.rowSpan-1,S+(T.rowSpan-1)>=d.range[2]&&(d.range[2]=d.range[0],d.range[2]=S+(T.rowSpan-1))),T.colSpan>1&&(k+=T.colSpan-1,m+(T.colSpan-1)>=d.range[3]&&(d.range[3]=d.range[1],d.range[3]=m+(T.colSpan-1))))),d.range[0]=S,d.range[1]=m,d.range[0]===S&&d.range[1]===m&&d.range[2]===b&&d.range[3]===k&&(d.isActiveCell=!0),!d.skipChecking){for(var x=d.range[1];x<=d.range[3];x++)T=(0,w.$S)(d.range[2],x,M),T&&(S=d.range[2],m=x,!(0,U.le)(T.colSpan)&&T.colSpan<0&&(m+=T.colSpan,m<d.range[1]&&(d.range[1]=m)),!(0,U.le)(T.rowSpan)&&T.rowSpan<0&&(S+=T.rowSpan,S<d.range[0]&&(d.range[0]=S)),T=(0,w.$S)(S,m,M),T&&(T.colSpan>1&&m+(T.colSpan-1)>d.range[3]&&(d.range[3]=m,d.range[3]=m+(T.colSpan-1)),T.rowSpan>1&&S+(T.rowSpan-1)>d.range[2]&&(d.range[2]=S,d.range[2]=S+(T.rowSpan-1))));for(var v,y,x=d.range[1];x<=d.range[3];x++)T=(0,w.$S)(d.range[0],x,M),T&&(y=x,v=d.range[0],!(0,U.le)(T.colSpan)&&T.colSpan<0&&(y+=T.colSpan,y<d.range[1]&&(d.range[1]=y)),!(0,U.le)(T.rowSpan)&&T.rowSpan<0&&(v+=T.rowSpan,v<d.range[0]&&(d.range[0]=v)));for(var x=d.range[0];x<=d.range[2];x++)T=(0,w.$S)(x,d.range[3],M),T&&(S=x,m=d.range[3],!(0,U.le)(T.rowSpan)&&T.rowSpan<0&&(S+=T.rowSpan,S<d.range[0]&&(d.range[0]=S)),!(0,U.le)(T.colSpan)&&T.colSpan<0&&(m+=T.colSpan,m<d.range[1]&&(d.range[1]=m)),T=(0,w.$S)(S,m,M),T&&(T.rowSpan>1&&S+(T.rowSpan-1)>d.range[2]&&(d.range[2]=S,d.range[2]=S+(T.rowSpan-1)),T.colSpan>1&&m+(T.colSpan-1)>d.range[3]&&(d.range[3]=m,d.range[3]=m+(T.colSpan-1))))}},O.prototype.forwardReverse=function(d){var M=this.parent.getActiveSheet();d.range=d.range;var T=d.range[1],b=(0,w.$S)(d.range[0],d.range[1],M),k=d.range[0];if(b&&(!(0,U.le)(b.colSpan)&&b.colSpan<0&&(T+=b.colSpan,d.range[3]>=T&&(d.range[3]=T)),!(0,U.le)(b.rowSpan)&&b.rowSpan<0&&(k+=b.rowSpan,k<d.range[0]&&(d.range[0]=k)),b=(0,w.$S)(k,T,M),b&&(b.rowSpan>1&&k+(b.rowSpan-1)>=d.range[2]&&(d.range[2]=k+(b.rowSpan-1)),b.colSpan>1&&T+(b.colSpan-1)>=d.range[1]&&(d.range[1]=T+(b.colSpan-1)))),d.range[0]=k,!d.skipChecking){for(var S,m,x=d.range[3];x<=d.range[1];x++)b=(0,w.$S)(d.range[2],x,M),b&&(m=x,S=d.range[2],!(0,U.le)(b.rowSpan)&&b.rowSpan<0&&(S+=b.rowSpan,S<d.range[0]&&(d.range[0]=S)),!(0,U.le)(b.colSpan)&&b.colSpan<0&&(m+=b.colSpan,m<d.range[3]&&(d.range[3]=m)),b=(0,w.$S)(S,m,M),b&&(b.rowSpan>1&&S+(b.rowSpan-1)>d.range[2]&&(d.range[2]=S+(b.rowSpan-1)),b.colSpan>1&&m+(b.colSpan-1)>d.range[1]&&(d.range[1]=m+(b.colSpan-1))));for(var v,x=d.range[3];x<=d.range[1];x++)b=(0,w.$S)(d.range[0],x,M),b&&(m=x,v=d.range[0],!(0,U.le)(b.rowSpan)&&b.rowSpan<0&&(v+=b.rowSpan,v<d.range[0]&&(d.range[0]=v)),!(0,U.le)(b.colSpan)&&b.colSpan<0&&(m+=b.colSpan),b=(0,w.$S)(v,m,M),b&&(b.rowSpan>1&&v+(b.rowSpan-1)>d.range[2]&&(d.range[2]=v+(b.rowSpan-1)),b.colSpan>1&&m+(b.colSpan-1)>d.range[1]&&(d.range[1]=m,d.range[1]=m+(b.colSpan-1))));for(var y,x=d.range[0];x<=d.range[2];x++)b=(0,w.$S)(x,d.range[3],M),b&&(v=x,y=d.range[3],!(0,U.le)(b.rowSpan)&&b.rowSpan<0&&(v+=b.rowSpan,v<d.range[0]&&(d.range[0]=v)),!(0,U.le)(b.colSpan)&&b.colSpan<0&&(y+=b.colSpan,y<d.range[3]&&(d.range[3]=y)),b=(0,w.$S)(v,y,M),b&&(b.rowSpan>1&&v+(b.rowSpan-1)>d.range[2]&&(d.range[2]=v,d.range[2]=v+(b.rowSpan-1)),b.colSpan>1&&y+(b.colSpan-1)>d.range[1]&&(d.range[1]=y,d.range[1]=y+(b.colSpan-1))))}},O.prototype.reverse=function(d){d.range=d.range;var M=d.range[1],T=(0,U.o8)(d.sheetIndex)?this.parent.getActiveSheet():(0,w.zf)(this.parent,d.sheetIndex),b=(0,w.$S)(d.range[0],d.range[1],T),k=d.range[0];b&&(!(0,U.le)(b.colSpan)&&b.colSpan<0&&(M+=b.colSpan),!(0,U.le)(b.rowSpan)&&b.rowSpan<0&&(k+=b.rowSpan),d.range[2]>=k&&(d.range[2]=k,d.isActiveCell=!0),d.range[3]>=M?(d.range[3]=M,d.range[2]===k&&(d.isActiveCell=!0)):d.isActiveCell&&(d.isActiveCell=!1),b=(0,w.$S)(k,M,T),b&&(b.rowSpan>1&&k+(b.rowSpan-1)>=d.range[0]&&(d.range[0]=k,d.range[0]=k+(b.rowSpan-1)),b.colSpan>1&&M+(b.colSpan-1)>=d.range[1]&&(d.range[1]=M,d.range[1]=M+(b.colSpan-1))));var S=d.range[3];if(!d.skipChecking){for(var m=d.range[3];m<=d.range[1];m++)b=(0,w.$S)(d.range[2],m,T),b&&(S=m,k=d.range[2],!(0,U.le)(b.rowSpan)&&b.rowSpan<0&&(k+=b.rowSpan,k<d.range[2]&&(d.range[2]=k)),!(0,U.le)(b.colSpan)&&b.colSpan<0&&(S+=b.colSpan,S<d.range[3]&&(d.range[3]=S)),b=(0,w.$S)(k,S,T),b&&(b.rowSpan>1&&k+(b.rowSpan-1)>d.range[0]&&(d.range[0]=k,d.range[0]=k+(b.rowSpan-1)),b.colSpan>1&&S+(b.colSpan-1)>d.range[1]&&(d.range[1]=S,d.range[1]=S+(b.colSpan-1))));S=d.range[3];for(var m=d.range[3];m<=d.range[1];m++)b=(0,w.$S)(d.range[0],m,T),b&&(S=m,k=d.range[0],!(0,U.le)(b.colSpan)&&b.colSpan<0&&(S+=b.colSpan),!(0,U.le)(b.rowSpan)&&b.rowSpan<0&&(k+=b.rowSpan),b=(0,w.$S)(k,S,T),b&&(b.colSpan>1&&S+(b.colSpan-1)>d.range[1]&&(d.range[1]=S,d.range[1]=S+(b.colSpan-1)),b.rowSpan>1&&k+(b.rowSpan-1)>d.range[0]&&(d.range[0]=k,d.range[0]=k+(b.rowSpan-1))));for(var x,v,m=d.range[2];m<=d.range[0];m++)b=(0,w.$S)(m,d.range[3],T),b&&(v=m,x=d.range[3],!(0,U.le)(b.rowSpan)&&b.rowSpan<0&&(v+=b.rowSpan,v<d.range[2]&&(d.range[2]=v)),!(0,U.le)(b.colSpan)&&b.colSpan<0&&(x+=b.colSpan,x<d.range[3]&&(d.range[3]=x)),b=(0,w.$S)(v,x,T),b&&(b.rowSpan>1&&v+(b.rowSpan-1)>d.range[0]&&(d.range[0]=v,d.range[0]=v+(b.rowSpan-1)),b.colSpan>1&&x+(b.colSpan-1)>d.range[1]&&(d.range[1]=x,d.range[1]=x+(b.colSpan-1))))}},O.prototype.reverseForward=function(d){d.range=d.range;var M=(0,U.o8)(d.sheetIndex)?this.parent.getActiveSheet():(0,w.zf)(this.parent,d.sheetIndex),T=d.range[0],b=d.range[1],k=(0,w.$S)(d.range[0],d.range[1],M);if(k&&(!(0,U.le)(k.rowSpan)&&k.rowSpan<0&&(T+=k.rowSpan,d.range[2]>=T&&(d.range[2]=T)),!(0,U.le)(k.colSpan)&&k.colSpan<0&&(b+=k.colSpan),k=(0,w.$S)(T,b,M),k&&(k.rowSpan>1&&T+(k.rowSpan-1)>=d.range[0]&&(d.range[0]=T,d.range[0]=T+(k.rowSpan-1)),k.colSpan>1&&b+(k.colSpan-1)>=d.range[3]&&(d.range[3]=d.range[1],d.range[3]=b+(k.colSpan-1)))),!d.skipChecking){for(var S=d.range[3],m,x=d.range[1];x<=d.range[3];x++)k=(0,w.$S)(d.range[2],x,M),k&&(m=d.range[2],S=x,!(0,U.le)(k.rowSpan)&&k.rowSpan<0&&(m+=k.rowSpan,m<d.range[2]&&(d.range[2]=m)),!(0,U.le)(k.colSpan)&&k.colSpan<0&&(S+=k.colSpan,S<d.range[1]&&(d.range[1]=S)),k=(0,w.$S)(m,S,M),k&&(k.colSpan>1&&S+(k.colSpan-1)>d.range[3]&&(d.range[3]=S+(k.colSpan-1)),k.rowSpan>1&&k.rowSpan-1+m>d.range[0]&&(d.range[0]=k.rowSpan-1+m)));for(var v,y,x=d.range[1];x<=d.range[3];x++)k=(0,w.$S)(d.range[0],x,M),k&&(y=x,v=d.range[0],!(0,U.le)(k.colSpan)&&k.colSpan<0&&(y+=k.colSpan,y<d.range[1]&&(d.range[1]=y)),!(0,U.le)(k.rowSpan)&&k.rowSpan<0&&(v+=k.rowSpan),k=(0,w.$S)(v,y,M),k&&k.rowSpan>1&&v+(k.rowSpan-1)>d.range[0]&&(d.range[0]=v+(k.rowSpan-1)));for(var A,x=d.range[2];x<=d.range[0];x++)k=(0,w.$S)(x,d.range[3],M),k&&(m=x,A=d.range[3],!(0,U.le)(k.rowSpan)&&k.rowSpan<0&&(m+=k.rowSpan,m<d.range[2]&&(d.range[2]=m)),!(0,U.le)(k.colSpan)&&k.colSpan<0&&(A+=k.colSpan,A<d.range[1]&&(d.range[1]=A)),k=(0,w.$S)(m,A,M),k&&(k.rowSpan>1&&k.rowSpan-1+m>d.range[0]&&(d.range[0]=k.rowSpan-1+m),k.colSpan>1&&k.colSpan-1+A>d.range[3]&&(d.range[3]=A,d.range[3]=k.colSpan-1+A)))}},O.prototype.insertHandler=function(d){this.activeCellRange(d),d.range=d.range,d.insertModel==="Row"?d.range[2]+=d.insertCount:d.range[3]+=d.insertCount,d.preventRefresh=!0,d.merge=!0,this.mergeAll(d)},O.prototype.pasteHandler=function(d){for(var M=this.parent.getActiveSheet(),T,b,k,S=(0,P.n53)(M.activeCell),m=d.range[0],x=0;m<=d.range[2];m++,x++)for(var v=d.range[1],y=0;v<=d.range[3];v++,y++){if(T=(0,w.$S)(m,v,d.prevSheet)||{},T.rowSpan>1&&(k=(0,w.$S)(S[0]+(T.rowSpan-1),S[1],M)||{},b=(0,w.$S)(S[0]+1,S[1],M)||{},k.colSpan!==void 0&&k.colSpan<0||b.colSpan!==void 0&&b.colSpan<0)){d.cancel=!0,this.parent.notify(P.i8F,{showDialog:!0});return}if(T.colSpan>1&&(k=(0,w.$S)(S[0],S[1]+(T.colSpan-1),M)||{},b=(0,w.$S)(S[0],S[1]+1,M)||{},k.rowSpan!==void 0&&k.rowSpan<0||b.rowSpan!==void 0&&b.rowSpan<0)){d.cancel=!0,this.parent.notify(P.i8F,{showDialog:!0});return}}},O.prototype.addEventListener=function(){this.parent.on(P.mtj,this.merge,this),this.parent.on(P.aQp,this.mergedRange,this),this.parent.on(P.Zf5,this.activeCellRange,this),this.parent.on(P.z3C,this.insertHandler,this),this.parent.on(P.Ice,this.pasteHandler,this)},O.prototype.destroy=function(){this.removeEventListener(),this.parent=null},O.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(P.mtj,this.merge),this.parent.off(P.aQp,this.mergedRange),this.parent.off(P.Zf5,this.activeCellRange),this.parent.off(P.z3C,this.insertHandler),this.parent.off(P.Ice,this.pasteHandler))},O.prototype.getModuleName=function(){return"workbookmerge"},O}(),Q=ae(95005),te=function(){function O(d){this.uniqueOBracket=String.fromCharCode(129),this.uniqueCBracket=String.fromCharCode(130),this.uniqueDOperator=String.fromCharCode(136),this.uniqueModOperator=String.fromCharCode(137),this.uniqueCSeparator=String.fromCharCode(131),this.uniqueCOperator=String.fromCharCode(132),this.uniqueExpOperator=String.fromCharCode(140),this.uniqueGTOperator=String.fromCharCode(141),this.uniqueConcateOperator=String.fromCharCode(138),this.uniqueEqualOperator=String.fromCharCode(139),this.uniqueLTOperator=String.fromCharCode(142),this.uniqueMOperator=String.fromCharCode(135),this.uniquePOperator=String.fromCharCode(133),this.uniqueSOperator=String.fromCharCode(134),this.parent=d,this.addEventListener()}return O.prototype.getFillInfo=function(d){for(var M="",T=!0,b="CopyCells",k=[],S=["Down","Up"].indexOf(d.direction)>-1,m=this.getRangeData({range:d.dataRange,sheetIdx:this.parent.activeSheetIndex}),x=m.join().replace(/,/g,"").length,v=this.isRange(d.dataRange)&&x?m.length:1;v--;)if(M=m[v]&&!(0,U.le)(m[v].value)?m[v].value:"",(0,P.hj$)(M)||(0,P.C2M)(M)||(0,P.hj$)(M[M.length-1])){T=!1,b=this.parent.autoFillSettings.fillType;break}return(!x||T)&&(k.push("Fill Series"),b=d.fillType==="FillSeries"?b:d.fillType),(!S||S&&d.dataRange[1]!==d.dataRange[3])&&k.push("Flash Fill"),{fillType:b,disableItems:k}},O.prototype.isRange=function(d){return d&&(d[0]!==d[2]||d[1]!==d[3])},O.prototype.autoFill=function(d){if(!(!d.dataRange||!d.fillRange||!d.direction||!this.parent.allowEditing||this.parent.getActiveSheet().isProtected&&d.isLockedCell)){var M={dataRange:null,fillRange:null,fillType:null,direction:null,sheetIndex:(0,P.MJG)(this.parent,d.dataRange)},T=(0,P.gaE)((0,P.dK5)(d.dataRange)),b=(0,P.gaE)((0,P.dK5)(d.fillRange));switch(this.fillInfo=this.getFillInfo({dataRange:T,fillRange:b,fillType:d.fillType,direction:d.direction}),M.dataRange=T,M.fillRange=b,M.direction=d.direction,M.fillType=d.fillType||this.fillInfo.fillType,this.fillInfo.fillType=d.isFillOptClick?d.fillType:this.fillInfo.fillType,d.fillType){case"FillSeries":case"FillWithoutFormatting":this.fillSeries(M);break;case"CopyCells":case"FillFormattingOnly":this.copyCells(M);break}}},O.prototype.fillSeries=function(d){for(var M,T,b,k,S,m,x,v,y,A,I,N,z,V,_,G,K,oe,he,ue={},X=0,Ce,ze=(0,U.o8)(d.sheetIndex)?this.parent.activeSheetIndex:d.sheetIndex,We=(0,w.zf)(this.parent,ze),Xe=d.dataRange[0],tt=d.dataRange[1],pt=d.dataRange[2],st=d.dataRange[3],ht=d.fillRange[0],rt=d.fillRange[1],Et=d.fillRange[2],Vt=d.fillRange[3],ce=["Down","Up"].indexOf(d.direction)>-1,ee=["Up","Left"].indexOf(d.direction)>-1,Ne=ce?st-tt:pt-Xe,Te=d.fillType==="FillSeries";X<=Ne;){if(S=this.updateFillValues(ce,Xe,tt,pt,st,ht,rt,Et,Vt,X),m=S.patternRange,x=S.fillRange,b=this.getPattern(m,{isRFill:ee,isVFill:ce}),v=this.getRangeData({range:m,sheetIdx:ze}),A=v.length,!b)return;for(T=b.length,K=this.getSelectedRange(We,{rowIndex:x[0],colIndex:x[1]},{rowIndex:x[2],colIndex:x[3]}),oe=K.length,ee&&(K=K.reverse(),b=b.reverse(),b=this.ensurePattern(b),v=v.reverse()),I=0;I<oe;){switch(he=K[I],k=b[I%T],(0,P.hj$)(k)&&(k=b[k]),z=I%A,k.type){case"number":if(M=this.round(k.regVal.a+k.regVal.b*k.i,5).toString(),k=k,k.dataVal){if(k.copy===void 0&&(k.copy=k.val.length>2,k.copy))for(var we=2;we<k.val.length&&(k.copy=Math.abs(this.round(k.regVal.a+k.regVal.b*we,5))!==k.val[we],!k.copy);we++);M=k.copy?v[z]&&!(0,U.le)(v[z].value)?v[z].value:"":k.start?Math.abs(Number(M))+k.dataVal:k.dataVal+Math.abs(Number(M))}ee?k.i--:k.i++;break;case"string":var ct=k.i%k.val.length;M=k.val[ct],k.i++;break;case"formula":for(G=!1,M="=",N=0,V=k.val.length;N<V;)y=k.val[N],typeof y=="object"?(G=!0,_=this.round(y.a+y.b*k.i,5),_<1?M+="#REF!":M+=ce?y.c+(y.b?_:"$"+_):(y.b?(0,P.AH9)(_):y.c.substring(0,y.c.search(/\d/))+"$"+(0,P.AH9)(_))+y.c.trim()):M+=y,N++;G&&ee?k.i--:k.i++;break;case"time":M=(k.regVal.a+k.regVal.b*k.i).toString(),ee?k.i--:k.i++;break}Ce=(0,w.$S)(he.rowIndex,he.colIndex,We,!1,!0),Te?Object.assign(ue,v[z],null,!0):(ue.style=Ce.style,ue.format=Ce.format,ue.wrap=Ce.wrap,ue.rowSpan=Ce.rowSpan,ue.colSpan=Ce.colSpan),ue.value=M,(0,P.C2M)(M)&&(ue.formula=M),(0,P.wWT)(this.parent,We,{cell:ue,rowIdx:he.rowIndex,colIdx:he.colIndex,valChange:!0,uiRefresh:!0,pvtExtend:!0}),ue={},I++}X++}},O.prototype.copyCells=function(d){for(var M=0,T,b,k,S,m,x,v,y,A,I={},N,z=d.dataRange[0],V=d.dataRange[1],_=d.dataRange[2],G=d.dataRange[3],K=d.fillRange[0],oe=d.fillRange[1],he=d.fillRange[2],ue=d.fillRange[3],X=["Down","Up"].indexOf(d.direction)>-1,Ce=["Up","Left"].indexOf(d.direction)>-1,ze=X?G-V:_-z,We=(0,U.o8)(d.sheetIndex)?this.parent.activeSheetIndex:d.sheetIndex,Xe=(0,w.zf)(this.parent,We),tt=d.fillType==="FillFormattingOnly",pt;M<=ze;){if(m=this.updateFillValues(X,z,V,_,G,K,oe,he,ue,M),k=m.patternRange,S=m.fillRange,x=this.getRangeData({range:k,sheetIdx:We}),v=x.length,y=this.getSelectedRange(Xe,{rowIndex:S[0],colIndex:S[1]},{rowIndex:S[2],colIndex:S[3]}),A=y.length,T=0,Ce&&(y=y.reverse()),tt)for(;T<A;)b=T%v,N=y[T],pt=(0,w.$S)(N.rowIndex,N.colIndex,Xe),Object.assign(I,x[b],null,!0),I.value=pt.value,I.formula=pt.formula,(0,P.wWT)(this.parent,Xe,{cell:I,rowIdx:N.rowIndex,colIdx:N.colIndex,valChange:!0,uiRefresh:!0,pvtExtend:!0}),I={},T++;else for(;T<A;)b=T%v,N=y[T],Object.assign(I,x[b],null,!0),(0,P.wWT)(this.parent,Xe,{cell:I,rowIdx:N.rowIndex,colIdx:N.colIndex,valChange:!0,uiRefresh:!0,pvtExtend:!0}),I={},T++;M++}},O.prototype.updateFillValues=function(d,M,T,b,k,S,m,x,v,y){var A,I,N,z;d?(A={rowIndex:M,colIndex:T+y},I={rowIndex:b,colIndex:T+y},N={rowIndex:S,colIndex:m+y},z={rowIndex:x,colIndex:m+y}):(A={rowIndex:M+y,colIndex:T},I={rowIndex:M+y,colIndex:k},N={rowIndex:S+y,colIndex:m},z={rowIndex:S+y,colIndex:v});var V=[A.rowIndex,A.colIndex,I.rowIndex,I.colIndex],_=[N.rowIndex,N.colIndex,z.rowIndex,z.colIndex];return{patternRange:V,fillRange:_}},O.prototype.getType=function(d,M){var T;return M?T="time":(0,P.C2M)(d)?T="formula":(0,P.hj$)(d)&&(T="number"),T||"string"},O.prototype.getDataPattern=function(d){var M,T,b=0,k={val:null,type:null},S=[],m=this.getRangeData({range:d,sheetIdx:this.parent.activeSheetIndex}),x=m.length,v;if(x){for(var y=void 0,A=void 0,I=function(N){return!v&&N&&N[N.length-1]==="-"?N.slice(0,N.length-1):N};b<x;){if(M=m[b]?m[b].formula?m[b].formula:(0,U.le)(m[b].value)?"":m[b].value:"",T=this.getType(M,m[b]&&m[b].format==="h:mm:ss AM/PM"),A="",T==="string"){if(v=!1,(0,P.hj$)(M[0])){y=0;do y++;while((0,P.hj$)(M[y]));M[y]===" "&&(v=!0,T="number",A=M.slice(y,M.length),M=Number(M.slice(0,y)))}if(M=M,!v&&(0,P.hj$)(M[M.length-1])){y=1;do y++;while((0,P.hj$)(M[M.length-y]));T="number",y-=1,A=M.slice(0,M.length-y),M=Number(M.slice(M.length-y,M.length)),k.dataVal&&k.dataVal!==A&&k.dataVal===I(A)&&(A=k.dataVal)}}b===0?(k={val:[M],type:T},A&&(k.dataVal=A,k.start=v)):T===k.type&&(!k.dataVal||I(k.dataVal)===I(A))?k.val.push(M):(S.push(k),k={val:[M],type:T},A&&(k.dataVal=A,k.start=v)),b++}return S.push(k),S}else return[{val:null,type:null}]},O.prototype.getPredictionValue=function(d,M){for(var T=0,b=0,k=0,S=0,m=0,x=0,v=0,y=d.length;T<y;)b=b+T,k=k+Number(d[T]),S=S+T*Number(d[T]),m=m+T*T,T++;return M?(x=(k*m-b*S)/(y*m-b*b),v=(y*S-b*k)/(y*m-b*b)):(x=this.round((k*m-b*S)/(y*m-b*b),5),v=this.round((y*S-b*k)/(y*m-b*b),5)),{a:x,b:v}},O.prototype.getPattern=function(d,M){var T,b,k,S,m,x,v=0,y=[],A=this.getDataPattern(d),I=A.length,N;if(A){for(;v<I;){switch(N=A[v],N.type){case"number":if(b=y.length,x=N.val.length,m=M.isRFill?-1:x,x===1){var z=parseFloat(N.val[0])+1;N.val.push(z)}for(S=this.getPredictionValue(N.dataVal?N.val.slice(0,2):N.val),k={regVal:S,type:N.type,i:m},N.dataVal&&(k.dataVal=N.dataVal,k.val=N.val,k.start=N.start),y.push(k),T=1;T<x;)y.push(b),T++;break;case"string":for(b=y.length,k={val:N.val,type:N.type,i:0},y.push(k),T=1,x=N.val.length;T<x;)y.push(b),T++;break;case"formula":if(x=N.val.length,N=this.getFormulaPattern(N.val,M),m=M.isRFill?-1:x,N.isInPattern)for(b=y.length,k={val:N.val,type:"formula",i:m},y.push(k),T=1;T<x;)y.push(b),T++;else for(T=0,m=M.isRFill?-1:1;T<x;)y.push({val:N.val[T],type:"formula",i:m}),T++;break;case"time":if(b=y.length,x=N.val.length,m=M.isRFill?-1:1,x===1){var V=(0,P.ODv)(N.val[0]),_=(0,P.twf)(new Date(V.getTime()+60*6e4),!0);N.val.push(_)}for(S=this.getPredictionValue(N.val,!0),k={regVal:S,type:N.type,i:m},y.push(k),T=1;T<x;)y.push(b),T++;break;default:break}v++}return y}else return[{regVal:null}]},O.prototype.isCellReference=function(d){return/^[a-z]{1,3}\d{1,7}$/gi.test(d)?"relative":/^\$[a-z]{1,3}\$\d{1,7}$/gi.test(d)?"absolute":/^((\$[a-z]{1,3})\d{1,7}|[a-z]{1,3}(\$\d{1,7}))$/gi.test(d)?"mixed":!1},O.prototype.round=function(d,M){return Number(Math.round(parseFloat(d+"e"+M))+"e-"+M)},O.prototype.getRangeData=function(d){for(var M=[],T=this.parent.getActiveSheet(),b=d.range[0],k=d.range[1],S=d.range[2],m=d.range[3],x=k,v;b<=S;){if((0,w.gS)(T,b)){b++;continue}for(k=x;k<=m;){if((0,w.Nq)(T,k)){k++;continue}v=(0,w.$S)(b,k,T),M.push(v),k++}b++}return M},O.prototype.getFormulaPattern=function(d,M){for(var T,b,k,S=[],m=0,x=d.length,v;m<x;)S.push(this.parseFormula(d[m])),m++;var y=this.isInPattern(S,M.isVFill);if(y){for(k=S[0],m=k.length;m--;)b=k[m],v=this.isCellReference(b),v&&v!=="absolute"&&(k[m]=this.getCellRefPrediction(b,M,null,v));return{isInPattern:y,val:k}}else{for(m=0;m<x;){for(k=S[m],T=k.length;T--;)b=k[T],v=this.isCellReference(b.trim()),v&&v!=="absolute"&&(S[m][T]=this.getCellRefPrediction(b,M,x,v));m++}return{isInPattern:y,val:S}}},O.prototype.generateColCount=function(d){for(var M=0,T=d.split("").reverse().join(""),b=T.length-1;b>=0;b--)M+=(d[b].charCodeAt(parseInt(T[b],10))-64)*Math.pow(26,b);return M},O.prototype.getCellRefPrediction=function(d,M,T,b){d=d.toUpperCase();var k="",S=new RegExp("[a-z$]","gi"),m=new RegExp("[0-9$]","g"),x=M.isVFill?d.replace(m,k):d.replace(S,k),v=M.isVFill?Number(d.replace(S,k)):this.generateColCount(d.replace(m,k).trim()),y=null,A=[v],I=d[0]==="$";if(!I&&d.includes("$")&&d.trim()[0]==="$"){for(var N=1;N<d.length;N++)if(d[N]==="$"){y=N,I=!0;break}}return T&&T!==1?A.push(v+T):A.push(v+1),v=this.getPredictionValue(A),b&&b==="mixed"&&(I===M.isVFill?y?x=x.substring(0,y)+"$"+x.substring(y):x="$"+x:v.b=0),v.c=x,v},O.prototype.isInPattern=function(d,M){var T,b,k,S,m,x,v,y,A="",I=0,N=1,z=d.length,V=new RegExp("[0-9$]","g"),_=new RegExp("[a-z$]","gi");if(z===1)return!1;for(;N<z;){if(T=d[I],k=d[N],b=T.length,S=k.length,b!==S)return!1;for(;b--;)if(m=T[b],x=k[b],this.isCellReference(m)===this.isCellReference(x)){if(M?(v=Number(m.replace(_,A)),y=Number(x.replace(_,A))):(v=this.generateColCount(m.replace(V,A)),y=this.generateColCount(x.replace(V,A))),v!==y-1)return!1}else if(m!==x)return!1;I++,N++}return!0},O.prototype.parseFormula=function(d){var M,T,b=0,k=[];d=this.markSpecialChar(d.replace("=","")),d=d.split(/\(|\)|=|\^|>|<|,|:|\+|-|\*|\/|%|&/g);for(var S=d.length;b<S;){if(M=d[b],!M){b++;continue}M.length===1?k.push(this.isUniqueChar(M)?this.getUniqueCharVal(M):M):(T=M[0],M.indexOf("!")>0?(this.isUniqueChar(T)&&(k.push(this.getUniqueCharVal(T)),M=M.substr(1)),T=M.indexOf("!")+1,k.push(M.substr(0,T)),k.push(M.substr(T))):this.isUniqueChar(T)?(k.push(this.getUniqueCharVal(T)),k.push(M.substr(1))):k.push(M)),b++}return k},O.prototype.getUniqueCharVal=function(d){switch(d){case this.uniqueSOperator:return"-";case this.uniqueOBracket:return"(";case this.uniqueCOperator:return":";case this.uniqueCBracket:return")";case this.uniqueCSeparator:return",";case this.uniqueGTOperator:return">";case this.uniqueLTOperator:return"<";case this.uniqueMOperator:return"*";case this.uniqueDOperator:return"/";case this.uniqueConcateOperator:return"&";case this.uniqueEqualOperator:return"=";case this.uniqueExpOperator:return"^";case this.uniqueModOperator:return"%";case this.uniquePOperator:return"+"}return""},O.prototype.isUniqueChar=function(d){var M=d.charCodeAt(parseInt(d,10));return M>=129&&M<=142},O.prototype.markSpecialChar=function(d){return d=d.replace(/\(/g,"("+this.uniqueOBracket).replace(/\)/g,")"+this.uniqueCBracket),d=d.replace(/,/g,","+this.uniqueCSeparator).replace(/:/g,":"+this.uniqueCOperator),d=d.replace(/\+/g,"+"+this.uniquePOperator).replace(/-/g,"-"+this.uniqueSOperator),d=d.replace(/\*/g,"*"+this.uniqueMOperator).replace(/\//g,"/"+this.uniqueDOperator),d=d.replace(/&/g,"&"+this.uniqueConcateOperator),d=d.replace(/=/g,"="+this.uniqueEqualOperator),d=d.replace(/\^/g,"^"+this.uniqueExpOperator),d=d.replace(/>/g,">"+this.uniqueGTOperator).replace(/</g,"<"+this.uniqueLTOperator),d.replace(/%/g,"%"+this.uniqueModOperator)},O.prototype.ensurePattern=function(d){for(var M,T=-1,b=d.length;b--;)M=d[b],typeof M=="object"?(T=b,M.type==="string"&&(M.val=M.val.reverse())):d[b]=T;return d},O.prototype.getSelectedRange=function(d,M,T){var b,k,S,m=[],x=(0,P.gaE)([M.rowIndex,M.colIndex,T.rowIndex,T.colIndex]);b=x[0];for(var v=x[2];b<=v;){if((0,w.y4)(d,b)){b++;continue}for(k=x[1],S=x[3];k<=S;)m.push({rowIndex:b,colIndex:k}),k++;b++}return m},O.prototype.getFillType=function(d){return d.fillType=this.fillInfo.fillType,d.disableItems=this.fillInfo.disableItems,d},O.prototype.addEventListener=function(){this.parent.on(P.O$v,this.autoFill,this),this.parent.on(P.$uf,this.getFillType,this)},O.prototype.destroy=function(){this.removeEventListener(),this.parent=null},O.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(P.O$v,this.autoFill),this.parent.off(P.$uf,this.getFillType))},O.prototype.getModuleName=function(){return"workbookautofill"},O}()},53857:function(q,be,ae){"use strict";ae.d(be,{bL:function(){return Z},$S:function(){return E},Jx:function(){return a},tC:function(){return $},re:function(){return J},AX:function(){return se},M5:function(){return re},vn:function(){return Ae}});var P=ae(8923),F=ae(93010),Y=ae(91997),w=ae(9276),ye=function(){var Ie=function(Se,Q){return Ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,O){te.__proto__=O}||function(te,O){for(var d in O)O.hasOwnProperty(d)&&(te[d]=O[d])},Ie(Se,Q)};return function(Se,Q){Ie(Se,Q);function te(){this.constructor=Se}Se.prototype=Q===null?Object.create(Q):(te.prototype=Q.prototype,new te)}}(),U=function(Ie,Se,Q,te){var O=arguments.length,d=O<3?Se:te===null?te=Object.getOwnPropertyDescriptor(Se,Q):te,M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(Ie,Se,Q,te);else for(var T=Ie.length-1;T>=0;T--)(M=Ie[T])&&(d=(O<3?M(d):O>3?M(Se,Q,d):M(Se,Q))||d);return O>3&&d&&Object.defineProperty(Se,Q,d),d},Z=function(Ie){ye(Se,Ie);function Se(){return Ie!==null&&Ie.apply(this,arguments)||this}return U([(0,P.FE)([],F.Eep)],Se.prototype,"image",void 0),U([(0,P.FE)([],F.kL2)],Se.prototype,"chart",void 0),U([(0,P.Z9)("")],Se.prototype,"value",void 0),U([(0,P.Z9)("")],Se.prototype,"formula",void 0),U([(0,P.Z9)(0)],Se.prototype,"index",void 0),U([(0,P.Z9)("General")],Se.prototype,"format",void 0),U([(0,P.Zz)({},F.qZI)],Se.prototype,"style",void 0),U([(0,P.Z9)("")],Se.prototype,"hyperlink",void 0),U([(0,P.Z9)(!1)],Se.prototype,"wrap",void 0),U([(0,P.Z9)(!0)],Se.prototype,"isLocked",void 0),U([(0,P.Z9)("")],Se.prototype,"validation",void 0),U([(0,P.Z9)(1)],Se.prototype,"colSpan",void 0),U([(0,P.Z9)(1)],Se.prototype,"rowSpan",void 0),Se}(P.rt);function E(Ie,Se,Q,te,O){var d=(0,Y.dM)(Q,Ie);if(!d||!d.cells)if(te)d?Q.rows[Ie].cells=[]:Q.rows[Ie]={cells:[]};else return O?{}:null;return Q.rows[Ie].cells[Se]||(O?{}:null)}function a(Ie,Se,Q,te,O){Q.rows[Ie]?Q.rows[Ie].cells||(Q.rows[Ie].cells=[]):Q.rows[Ie]={cells:[]},O&&Q.rows[Ie].cells[Se]?(0,P.l7)(Q.rows[Ie].cells[Se],te,null,!0):Q.rows[Ie].cells[Se]=te}function $(Ie,Se){var Q={fontFamily:"Calibri",verticalAlign:"bottom",textIndent:"0pt",backgroundColor:"#ffffff",color:"#000000",textAlign:"left",fontSize:"11pt",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",border:"",borderLeft:"",borderTop:"",borderRight:"",borderBottom:""},te={};return Object.keys(Se?Q:Ie).forEach(function(O){Ie[O]!==Q[O]&&(te[O]=Ie[O])}),te}function J(Ie,Se,Q,te){Se===void 0&&(Se=!0);for(var O=Q.getAddressInfo(Ie),d=O.indices,M=(0,w.zf)(Q,O.sheetIndex),T=O.sheetIndex===Q.activeSheetIndex,b=!te,k=d[0];k<=d[2];k++)for(var S=d[1];S<=d[3];S++)b=(0,F.wWT)(Q,M,{cell:{wrap:Se},rowIdx:k,colIdx:S,preventEvt:te}),!b&&T&&Q.notify(F.agw,{range:[k,S,k,S],wrap:Se,sheet:M});Q.setProperties({sheets:Q.sheets},!0)}function se(Ie){var Se;if(Ie.indexOf("[")>-1){var Q=Ie.split("[")[1].split("]")[0],te=re();te.indexOf(Q)>-1&&(Se=Q)}return Se}function re(){return["Black","Blue","Cyan","Green","Magenta","Red","White","Yellow"]}function Ae(Ie,Se){return!!((Ie.format.includes("d")||Ie.format.includes("y"))&&Ie.format.indexOf("#")===-1&&!se(Ie.format)||Se&&(Ie.format.includes("h")||Ie.format.includes("m")||Ie.format.includes("s"))&&Ie.format.indexOf("#")===-1&&!se(Ie.format))}},28197:function(q,be,ae){"use strict";ae.d(be,{wD:function(){return U},XV:function(){return Z},IQ:function(){return E},pG:function(){return a},Nq:function(){return $},ek:function(){return J}});var P=ae(8923),F=ae(93010),Y=function(){var se=function(re,Ae){return se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Ie,Se){Ie.__proto__=Se}||function(Ie,Se){for(var Q in Se)Se.hasOwnProperty(Q)&&(Ie[Q]=Se[Q])},se(re,Ae)};return function(re,Ae){se(re,Ae);function Ie(){this.constructor=re}re.prototype=Ae===null?Object.create(Ae):(Ie.prototype=Ae.prototype,new Ie)}}(),w=function(se,re,Ae,Ie){var Se=arguments.length,Q=Se<3?re:Ie===null?Ie=Object.getOwnPropertyDescriptor(re,Ae):Ie,te;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Q=Reflect.decorate(se,re,Ae,Ie);else for(var O=se.length-1;O>=0;O--)(te=se[O])&&(Q=(Se<3?te(Q):Se>3?te(re,Ae,Q):te(re,Ae))||Q);return Se>3&&Q&&Object.defineProperty(re,Ae,Q),Q},ye=function(se){Y(re,se);function re(){return se!==null&&se.apply(this,arguments)||this}return w([(0,P.Z9)(0)],re.prototype,"index",void 0),w([(0,P.Z9)(64)],re.prototype,"width",void 0),w([(0,P.Z9)(!1)],re.prototype,"customWidth",void 0),w([(0,P.Z9)(!1)],re.prototype,"hidden",void 0),w([(0,P.Zz)({},F.EDR)],re.prototype,"format",void 0),w([(0,P.Z9)(!0)],re.prototype,"isLocked",void 0),w([(0,P.Z9)("")],re.prototype,"validation",void 0),re}(P.rt);function U(se,re){return se.columns?se.columns[re]||(se.columns[re]={}):(se.columns=[],se.columns[re]={}),se.columns[re]}function Z(se,re,Ae){var Ie=U(se,re);Object.keys(Ae).forEach(function(Se){Ie[Se]=Ae[Se]})}function E(se,re,Ae,Ie){var Se;if(se&&se.columns&&se.columns[re]){if(!Ae&&se.columns[re].hidden)return 0;Se=se.columns[re].width||se.columns[re].customWidth?se.columns[re].width:64}else Se=64;if(Ie&&window.devicePixelRatio%1>0){var Q=Se*window.devicePixelRatio%1;return Se+(Q?(Q>.5?1-Q:-1*Q)/window.devicePixelRatio:0)}else return Se}function a(se,re,Ae,Ie){Ae===void 0&&(Ae=re);var Se=0;if(re>Ae){var Q=re;re=Ae,Ae=Q}for(var te=re;te<=Ae;te++)Se+=E(se,te,null,Ie);return Se}function $(se,re){return se.columns[re]&&se.columns[re].hidden}function J(se,re,Ae){return!!(se&&se.validation&&(!se.validation.address||se.validation.address&&(0,F.ZsD)(se.validation.address,re,Ae)))}},37180:function(q,be,ae){"use strict";ae.d(be,{Yu:function(){return ye},ZR:function(){return U},ok:function(){return E}});var P=ae(77084),F=ae(93010),Y=ae(91997),w=ae(8923);function ye(a,$,J,se,re,Ae,Ie,Se,Q,te,O,d){return Q===void 0&&(Q=!0),new Promise(function(M,T){M(function(){var b;$.indexOf("!")>-1?(b=(0,P.Q8D)(a,(0,P.HAf)($)),$=$.slice($.indexOf("!")+1,$.length)):b=a.activeSheetIndex;var k=(0,P.zfV)(a,b),S=(0,F.IRR)(te||$),m={sheet:k,indexes:S,formulaCellRef:Ie,sheetIndex:Se,isFinite:a.scrollSettings&&a.scrollSettings.isFinite,promise:new Promise(function(x,v){x(function(){}())})};return a.notify(F.uRS,m),m.promise.then(function(){var x,v,y,A=S[0],I=a.frozenRowCount(k),N=a.frozenColCount(k),z=!!d;if(J){y=[];var V,_,G;$.split(",").forEach(function(tt,pt){for(S=(0,P.dK5)(tt),V=0,A=S[0];A<=S[2];){for(_=y[V]||{},v=(0,Y.dM)(k,A),x=S[1];x<=S[3];){if(Q&&(0,Y.gS)(k,A)&&!Ae){A++;continue}if(G=(0,F.AH9)(x+1),se)_[G]=v?U(a,(0,Y.$S)(A,x,k)):"",typeof _[G]=="string"&&(0,F.hj$)(_[G])&&(_[G]=parseFloat(_[G]));else{var st=v?(0,Y.$S)(A,x,k):null;(st&&(st.formula||!(0,w.le)(st.value))||Object.keys(_).length)&&(x===O?(_[G]=(0,w.l7)({},st,{value:U(a,st,!0)}),typeof _[G].value=="string"&&(0,F.hj$)(_[G].value)&&(_[G].value=parseFloat(_[G].value))):_[G]=st)}x===S[3]&&Object.keys(_).length&&(_.__rowIndex=(A+1).toString(),y[V]=_,z&&pt===0&&!(0,P.wDH)(k,A)&&d.push(_),V++),x++}A++}})}else{y=new Map;for(var K=!!(!se&&re&&re.length);A<=S[2];){if(K&&A>=I&&A<re[0]){A=re[0];continue}if(!se&&(0,Y.gS)(k,A)){A++;continue}for(v=(0,Y.dM)(k,A),x=S[1];x<=S[3];){var oe={cell:(0,Y.$S)(A,x,k),address:(0,F.qkm)(A,x),rowIndex:A,colIndex:x};a.trigger(F.EXN,oe);var he=(0,Y.$S)(A,x,k,!1,!0);if(he.colSpan>1&&he.rowSpan>1)for(var ue=void 0,X=A,Ce=A+he.rowSpan;X<Ce;X++)for(var ze=x,We=x+he.colSpan;ze<We;ze++)X===A&&ze===x||(ue=new Object,X!==A&&(ue.rowSpan=A-X),ze!==x&&(ue.colSpan=x-ze),k.rows[X]&&k.rows[X].cells&&k.rows[X].cells[ze]&&(delete k.rows[X].cells[ze].value,delete k.rows[X].cells[ze].formula),(0,P.Jxt)(X,ze,k,ue,!0));else if(he.colSpan>1)for(var X=x+1,Ce=x+he.colSpan;X<Ce;X++)(0,P.Jxt)(A,X,k,{colSpan:x-X},!0),k.rows[A]&&k.rows[A].cells&&k.rows[A].cells[X]&&(delete k.rows[A].cells[X].value,delete k.rows[A].cells[X].formula);else if(he.rowSpan>1)for(var X=A+1,Ce=A+he.rowSpan;X<Ce;X++)(0,P.Jxt)(X,x,k,{rowSpan:A-X},!0),k.rows[X]&&k.rows[X].cells&&k.rows[X].cells[x]&&(delete k.rows[X].cells[x].value,delete k.rows[X].cells[x].formula);if(!se&&(0,Y.Nq)(k,x)){x++;continue}if(K&&x>=N&&x<re[1]){x=re[1];continue}if(he.style){var Xe={};Object.assign(Xe,he.style),he.style=Xe}y.set(oe.address,he),x++}A++}}return y})}())})}function U(a,$,J){if($){if((0,w.le)($.value))return"";if($.format){var se={value:$.value,formattedText:$.value,cell:$,format:$.format,onLoad:!0,checkDate:!J};return a.notify(F.eYQ,se),se.dateObj&&se.dateObj.toString()!=="Invalid Date"?se.dateObj:J?se.value:se.formattedText}else return $.value}else return""}function Z(a,$){var J,se,re;if(isUndefined(a[$])||!(a[$]&&a[$].index===$))for(var Ae=0;Ae<=$;Ae++)if(a&&a[Ae]){if(J=a[Ae].index-Ae,J>0){for(a.forEach(function(Ie,Se){Ie&&Ie.index&&(re=Ie.index,se=1),Ie&&!Ie.index&&Se!==0&&(Ie.index=re+se),se++});J--;)a.splice(Ae,0,null);Ae+=J}}else a?a[Ae]=null:a=[];return a[$]}function E(a,$,J){for(var se,re=0,Ae,Ie=a.length,Se=function(O){if(!(0,w.le)(a[O])&&!(0,w.o8)(a[O].index)&&(Ae=re=a[O].index-O,delete a[O].index),re>0){for(se=0;re--;)$?(J.createSheet(O+se),se++):a.splice(O,0,null);O+=Ae,Ie+=Ae}if($){a[O].id<1&&(a[O].id=(0,Y.Ip)(J.sheets),a[O].properties&&(a[O].properties.id=a[O].id)),a[O].name||J.setSheetPropertyOnMute(a[O],"name","Sheet"+(0,Y.N_)(J));var d=0;a[O].rows.forEach(function(M){d=Math.max(d,M&&M.cells&&M.cells.length-1||0)}),J.setSheetPropertyOnMute(a[O],"usedRange",{rowIndex:a[O].rows.length?a[O].rows.length-1:0,colIndex:d})}Q=O},Q,te=0;te<Ie;te++)Se(te),te=Q}},91997:function(q,be,ae){"use strict";ae.d(be,{IE:function(){return P.I},ek:function(){return Se.ek},tN:function(){return F.tN},$S:function(){return w.$S},AX:function(){return w.AX},wD:function(){return Se.wD},IQ:function(){return Se.IQ},pG:function(){return Se.pG},M5:function(){return w.M5},Yu:function(){return Q.Yu},Ip:function(){return F.Ip},dM:function(){return a},NE:function(){return re},EB:function(){return Ie},dP:function(){return F.dP},zf:function(){return F.zf},Q8:function(){return F.Q8},Pm:function(){return F.Pm},R:function(){return F.R},N_:function(){return F.N_},HA:function(){return F.HA},_6:function(){return F._6},ZR:function(){return Q.ZR},Vl:function(){return F.Vl},vn:function(){return w.vn},y4:function(){return se},Nq:function(){return Se.Nq},gS:function(){return J},j1:function(){return F.j1},Jx:function(){return w.Jx},XV:function(){return Se.XV},ZG:function(){return $},vm:function(){return Ae},tC:function(){return w.tC},Tm:function(){return F.Tm},re:function(){return w.re}});var P=ae(55134),F=ae(9276),Y=ae(8923),w=ae(53857),ye=ae(93010),U=function(){var te=function(O,d){return te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,T){M.__proto__=T}||function(M,T){for(var b in T)T.hasOwnProperty(b)&&(M[b]=T[b])},te(O,d)};return function(O,d){te(O,d);function M(){this.constructor=O}O.prototype=d===null?Object.create(d):(M.prototype=d.prototype,new M)}}(),Z=function(te,O,d,M){var T=arguments.length,b=T<3?O:M===null?M=Object.getOwnPropertyDescriptor(O,d):M,k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(te,O,d,M);else for(var S=te.length-1;S>=0;S--)(k=te[S])&&(b=(T<3?k(b):T>3?k(O,d,b):k(O,d))||b);return T>3&&b&&Object.defineProperty(O,d,b),b},E=function(te){U(O,te);function O(){return te!==null&&te.apply(this,arguments)||this}return Z([(0,Y.FE)([],w.bL)],O.prototype,"cells",void 0),Z([(0,Y.Z9)(0)],O.prototype,"index",void 0),Z([(0,Y.Z9)(20)],O.prototype,"height",void 0),Z([(0,Y.Z9)(!1)],O.prototype,"customHeight",void 0),Z([(0,Y.Z9)(!1)],O.prototype,"hidden",void 0),Z([(0,Y.Zz)({},ye.EDR)],O.prototype,"format",void 0),O}(Y.rt);function a(te,O){return te.rows[O]}function $(te,O,d){te.rows[O]||(te.rows[O]={}),Object.keys(d).forEach(function(M){te.rows[O][M]=d[M]})}function J(te,O){return te.rows[O]&&te.rows[O].hidden}function se(te,O){return te.rows[O]&&te.rows[O].isFiltered}function re(te,O,d,M){var T;if(te&&te.rows&&te.rows[O]){if(!M&&te.rows[O].hidden)return 0;T=te.rows[O].height===void 0?20:te.rows[O].height}else T=20;if(d&&window.devicePixelRatio%1>0){var b=T*window.devicePixelRatio%1;return T+(b?(b>.5?1-b:-1*b)/window.devicePixelRatio:0)}else return T}function Ae(te,O,d){te&&te.rows&&(te.rows[O]||(te.rows[O]={}),te.rows[O].height=d)}function Ie(te,O,d,M,T){d===void 0&&(d=O);var b=0,k;O>d&&(k=O,O=d,d=k);for(var S=O;S<=d;S++)b+=re(te,S,M,T);return b}var Se=ae(28197),Q=ae(37180)},9276:function(q,be,ae){"use strict";ae.d(be,{yo:function(){return E},Q8:function(){return a},Pm:function(){return $},HA:function(){return J},Rg:function(){return se},Tm:function(){return re},dP:function(){return Ae},_6:function(){return Ie},zf:function(){return Se},N_:function(){return Q},Ip:function(){return te},Vl:function(){return O},R:function(){return M},j1:function(){return T},tN:function(){return b}});var P=ae(37180),F=ae(93010),Y=ae(8923),w=function(){var S=function(m,x){return S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,y){v.__proto__=y}||function(v,y){for(var A in y)y.hasOwnProperty(A)&&(v[A]=y[A])},S(m,x)};return function(m,x){S(m,x);function v(){this.constructor=m}m.prototype=x===null?Object.create(x):(v.prototype=x.prototype,new v)}}(),ye=function(S,m,x,v){var y=arguments.length,A=y<3?m:v===null?v=Object.getOwnPropertyDescriptor(m,x):v,I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(S,m,x,v);else for(var N=S.length-1;N>=0;N--)(I=S[N])&&(A=(y<3?I(A):y>3?I(m,x,A):I(m,x))||A);return y>3&&A&&Object.defineProperty(m,x,A),A},U=function(S){w(m,S);function m(){return S!==null&&S.apply(this,arguments)||this}return m.prototype.setProperties=function(x,v){var y=this,A="name",I="instance",N="parentObj",z="currRangeIdx",V="controlParent";if(this[N].isComplexArraySetter&&this[V]&&this[V].isAngular){if(Object.keys(x).length){this[N][z]===void 0?this[N][z]=0:this[N][z]+=1;var _=this[N].ranges[this[N][z]];_&&_.info&&(this.info=_.info),setTimeout(function(){y[N][z]!==void 0&&delete y[N][z]})}else if(this[V].tagObjects[0].instance&&this[V].tagObjects[0].instance.hasChanges&&!this[V].tagObjects[0].instance.isInitChanges){var G=this[V].sheets.indexOf(this[N]);if(this[N].changedRangeIdx===void 0){for(var K,oe=this[V].tagObjects[0].instance.list[G].tagObjects,he=0;he<oe.length;he++)if(oe[he][A]==="ranges"){oe[he][I].list.forEach(function(ue,X){ue.hasChanges&&(K=X)});break}this[N].changedRangeIdx=K}}}S.prototype.setProperties.call(this,x,v)},ye([(0,Y.Z9)(null)],m.prototype,"dataSource",void 0),ye([(0,Y.Z9)("A1")],m.prototype,"startCell",void 0),ye([(0,Y.Z9)(null)],m.prototype,"query",void 0),ye([(0,Y.Z9)(!0)],m.prototype,"showFieldAsHeader",void 0),ye([(0,Y.Z9)("")],m.prototype,"template",void 0),ye([(0,Y.Z9)("A1")],m.prototype,"address",void 0),m}(Y.rt),Z=function(S){w(m,S);function m(){return S!==null&&S.apply(this,arguments)||this}return ye([(0,Y.Z9)(0)],m.prototype,"rowIndex",void 0),ye([(0,Y.Z9)(0)],m.prototype,"colIndex",void 0),m}(Y.rt),E=function(S){w(m,S);function m(){return S!==null&&S.apply(this,arguments)||this}return ye([(0,Y.Z9)(null)],m.prototype,"rows",void 0),ye([(0,Y.Z9)(null)],m.prototype,"columns",void 0),ye([(0,Y.Zz)({},F.kcM)],m.prototype,"protectSettings",void 0),ye([(0,Y.FE)([],U)],m.prototype,"ranges",void 0),ye([(0,Y.FE)([],F.i2Z)],m.prototype,"conditionalFormats",void 0),ye([(0,Y.Z9)(0)],m.prototype,"index",void 0),ye([(0,Y.Z9)("")],m.prototype,"name",void 0),ye([(0,Y.Z9)(100)],m.prototype,"rowCount",void 0),ye([(0,Y.Z9)(100)],m.prototype,"colCount",void 0),ye([(0,Y.Z9)("A1:A1")],m.prototype,"selectedRange",void 0),ye([(0,Y.Z9)("A1")],m.prototype,"activeCell",void 0),ye([(0,Y.Z9)({})],m.prototype,"usedRange",void 0),ye([(0,Y.Z9)("A1")],m.prototype,"topLeftCell",void 0),ye([(0,Y.Z9)(!0)],m.prototype,"showHeaders",void 0),ye([(0,Y.Z9)(!0)],m.prototype,"showGridLines",void 0),ye([(0,Y.Z9)(!1)],m.prototype,"isProtected",void 0),ye([(0,Y.Z9)("Visible")],m.prototype,"state",void 0),ye([(0,Y.Z9)(0)],m.prototype,"frozenRows",void 0),ye([(0,Y.Z9)(0)],m.prototype,"frozenColumns",void 0),ye([(0,Y.Z9)("A1")],m.prototype,"paneTopLeftCell",void 0),ye([(0,Y.Z9)("")],m.prototype,"password",void 0),m}(Y.rt);function a(S,m){for(var x,v=0;v<S.sheets.length;v++)if(S.sheets[v].name.toLowerCase()===m.toLowerCase()){x=v;break}return x}function $(S,m){for(var x,v=0;v<S.sheets.length;v++)if(S.sheets[v].id===m){x=v;break}return x}function J(S){return S.split("!")[0].replace(/\'/gi,"")}function se(S,m,x){for(var v=x.length,y=0;y<v;y++)if(x[y].sheet.toUpperCase()===m.toUpperCase())return x[y].index;return-1}function re(S,m,x,v){x===void 0&&(x={}),S.setSheetPropertyOnMute(x,"selectedRange",v?x.selectedRange+" "+m:m)}function Ae(S){return S&&S.selectedRange||"A1"}function Ie(S){return S.selectedRange.split(" ")[0]}function Se(S,m){return S.sheets[m]}function Q(S){var m=[];S.sheets.forEach(function(v){m.push(v.name.toLowerCase())});for(var x=0;x<m.length;x++)if(m.indexOf("sheet"+S.sheetNameCount)>-1)S.sheetNameCount++;else return S.sheetNameCount++;return S.sheetNameCount++}function te(S){var m=0;return S.forEach(function(x){m=Math.max(x.id,m)}),m+1}function O(S,m){var x=m||S.sheets;x.forEach(function(v){if(v.id=v.id||0,v.name=v.name||"",v.rowCount=(0,Y.o8)(v.rowCount)?100:v.rowCount,v.colCount=(0,Y.o8)(v.colCount)?100:v.colCount,v.topLeftCell=v.topLeftCell||"A1",v.activeCell=v.activeCell||"A1",v.selectedRange=v.selectedRange||"A1:A1",v.usedRange=v.usedRange||{rowIndex:0,colIndex:0},S.setSheetPropertyOnMute(v,"ranges",v.ranges?v.ranges:[]),S.setSheetPropertyOnMute(v,"rows",v.rows&&(0,Y.l7)([],v.rows,null,!0)||[]),S.setSheetPropertyOnMute(v,"columns",v.columns||[]),v.showHeaders=(0,Y.o8)(v.showHeaders)?!0:v.showHeaders,v.showGridLines=(0,Y.o8)(v.showGridLines)?!0:v.showGridLines,v.state=v.state||"Visible",v.maxHgts=[],v.protectSettings=v.protectSettings||{selectCells:!1,formatCells:!1,formatRows:!1,formatColumns:!1,insertLink:!1},v.isProtected=v.isProtected||!1,!v.paneTopLeftCell||v.paneTopLeftCell==="A1"){v.frozenRows=v.frozenRows?v.frozenRows:0,v.frozenColumns=v.frozenColumns?v.frozenColumns:0;var y=(0,F.n53)(v.topLeftCell);S.setSheetPropertyOnMute(v,"paneTopLeftCell",(0,F.qkm)(v.frozenRows?y[0]+v.frozenRows:y[0],v.frozenColumns?y[1]+v.frozenColumns:y[1]))}(0,P.ok)(v.columns),d(v.rows)}),(0,P.ok)(x,!0,S)}function d(S){S.forEach(function(m){m&&m.cells&&(0,P.ok)(m.cells)}),(0,P.ok)(S)}function M(S,m){return m===void 0&&(m=S.activeSheetIndex),Se(S,m).name}function T(S,m,x,v,y){var A=!!x;x=x||[S.activeSheetIndex];var I=M(S);m=k(S.sheets,m,S.activeSheetIndex>m);var N={action:"moveSheet",eventArgs:{position:m,sheetIndexes:x,cancel:!1}};v&&S.trigger("actionBegin",N),N.eventArgs.cancel||(x.forEach(function(z,V){S.sheets.splice(m+V,0,S.sheets.splice(z+(m>z?-1*V:0),1)[0])}),S.setProperties({activeSheetIndex:y?a(S,I):m>x[0]?m-(x.length-1):m},!0),S.notify(F.NGR,{refresh:A}),v&&(delete N.eventArgs.cancel,S.trigger("actionComplete",N)))}function b(S,m,x,v){m=(0,Y.o8)(m)?S.activeSheetIndex:m;var y={action:"duplicateSheet",eventArgs:{sheetIndex:m,cancel:!1}};if(x&&S.trigger("actionBegin",y),!y.eventArgs.cancel){var A=Se(S,m),I=(0,Y.l7)({},A.properties?A.properties:A,!0);I.id=te(S.sheets);var N=I.name;/^\(\d+\)$/.test("("+N.split(" (")[1])&&(N=N.split(" (")[0]);var z=[];S.sheets.forEach(function(_){z.push(_.name)});for(var V=2;;V++)if(z.indexOf(N+" ("+V+")")===-1){I.name=N+" ("+V+")";break}S.notify(F.W$A,{sheetIndex:m,newSheetIndex:m+1}),S.createSheet(m+1,[I]),S.notify(F.B7N,{action:"addSheet",sheetName:"Sheet"+I.id,visibleName:I.name,sheetId:I.id}),v||S.setProperties({activeSheetIndex:m+1},!0),S.notify(F.NGR,{refresh:!0,isDuplicate:!0}),x&&(delete y.eventArgs.cancel,S.trigger("actionComplete",y))}}function k(S,m,x){for(var v=m;x?v>=0:v<S.length;x?v--:v++)if(!(S[v].state==="Hidden"||S[v].state==="VeryHidden")){m=v;break}return m}},55134:function(q,be,ae){"use strict";ae.d(be,{I:function(){return te}});var P=ae(8923),F=ae(9276),Y=ae(70180),w=ae(91997),ye=ae(93010),U=ae(80788),Z=ae(53857),E=ae(77084),a=ae(34819),$=ae(55152),J=ae(57387),se=ae(47799),re=ae(62243),Ae=ae(95005),Ie=function(){var O=function(d,M){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,b){T.__proto__=b}||function(T,b){for(var k in b)b.hasOwnProperty(k)&&(T[k]=b[k])},O(d,M)};return function(d,M){O(d,M);function T(){this.constructor=d}d.prototype=M===null?Object.create(M):(T.prototype=M.prototype,new T)}}(),Se=function(){return Se=Object.assign||function(O){for(var d,M=1,T=arguments.length;M<T;M++){d=arguments[M];for(var b in d)Object.prototype.hasOwnProperty.call(d,b)&&(O[b]=d[b])}return O},Se.apply(this,arguments)},Q=function(O,d,M,T){var b=arguments.length,k=b<3?d:T===null?T=Object.getOwnPropertyDescriptor(d,M):T,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(O,d,M,T);else for(var m=O.length-1;m>=0;m--)(S=O[m])&&(k=(b<3?S(k):b>3?S(d,M,k):S(d,M))||k);return b>3&&k&&Object.defineProperty(d,M,k),k},te=function(O){Ie(d,O);function d(T){var b=O.call(this,T)||this;return b.isEdit=!1,b.sheetNameCount=1,b.dataValidationRange="",b.isOpen=!1,b.chartColl=[],b.chartCount=1,M.Inject(E.vdt,a.w0,a.rV,$.Np,J.y9,J.Do,a.VP,a.RD,J.zp,a.Yl,J.VB,E.tqm,J.uZ,J.tU,J.nH,Ae.e,a.g,a.s,J.aE),b.commonCellStyle={},T&&T.cellStyle&&(b.commonCellStyle=T.cellStyle),b.getModuleName()==="workbook"&&(b.serviceLocator=new se.S,b.initWorkbookServices(),b.dataBind(),b.initEmptySheet()),b}M=d,d.prototype.preRender=function(){Object.keys(this.commonCellStyle).length||(this.commonCellStyle=(0,Z.tC)(this.cellStyle,!0)),this.getModuleName()==="spreadsheet"&&!this.refreshing&&this.initEmptySheet()},d.prototype.initWorkbookServices=function(){this.serviceLocator.register(ye.L1M,new P.E7(this.getModuleName(),ye.jHi,this.locale))},d.prototype.render=function(){},d.prototype.requiredModules=function(){return(0,Y.a)(this)},d.prototype.getPersistData=function(){return this.addOnPersist([])},d.prototype.cellFormat=function(T,b){var k=this.getActiveSheet();b=b||k.selectedRange,this.notify(ye.vbl,{style:T,range:b,refreshRibbon:b.indexOf(k.activeCell)>-1})},d.prototype.lockCells=function(T,b){var k=this.getActiveSheet();T=T||k.selectedRange,this.notify(ye.YYv,{range:T,isLocked:b,triggerEvent:!0})},d.prototype.getCellStyleValue=function(T,b){var k=this,S=(0,Z.$S)(b[0],b[1],this.getActiveSheet()),m={};return T.forEach(function(x){m[x]=k.cellStyle[x],S&&S.style&&S.style[x]&&(m[x]=S.style[x])}),m},d.prototype.numberFormat=function(T,b){this.notify(U.XU,{format:T,range:b})},d.prototype.createSheet=function(T,b){T===void 0&&(T=this.sheets.length),b===void 0&&(b=[{}]);var k;(k=this.sheets).splice.apply(k,[T,0].concat(b)),(0,F.Vl)(this,b),this.notify(ye.GRU,{sheetIndex:T||0,sheets:b}),this.notify(U.B7,{action:"registerSheet",sheetIndex:T||0,sheetCount:T+b.length})},d.prototype.removeSheet=function(T){this.sheets.splice(T,1)},d.prototype.destroy=function(){this.notify(U.Zu,null),O.prototype.destroy.call(this)},d.prototype.onPropertyChanged=function(T,b){for(var k=0,S=Object.keys(T);k<S.length;k++){var m=S[k];switch(m){case"cellStyle":(0,P.TS)(this.commonCellStyle,T.cellStyle);break;case"sheets":T.sheets===this.sheets?(this.notify(U.B7,{action:"unRegisterSheet",propertyChange:!0}),this.sheetNameCount=1,this.notify(U.I,{}),(0,F.Vl)(this),this.notify(ye.GRU,null),this.notify(U.B7,{action:"registerSheet"})):(0,F.Vl)(this);break}}},d.prototype.appendTo=function(T){O.prototype.appendTo.call(this,T)},d.prototype.hideRow=function(T,b,k){b===void 0&&(b=T),k===void 0&&(k=!0);for(var S=this.getActiveSheet(),m=T;m<=b;m++)(0,E.ZG6)(S,m,{hidden:k})},d.prototype.hideColumn=function(T,b,k){b===void 0&&(b=T),k===void 0&&(k=!0);for(var S=this.getActiveSheet(),m=T;m<=b;m++)(0,E.XV5)(S,m,{hidden:k})},d.prototype.setBorder=function(T,b,k){this.notify(ye.vbl,{style:T,borderType:k,range:b||this.getActiveSheet().selectedRange})},d.prototype.insertRow=function(T,b,k){this.notify(ye.IQJ,{model:this.getSheetModel(k),start:T,end:b,modelType:"Row",insertType:"below"})},d.prototype.insertColumn=function(T,b,k){this.notify(ye.IQJ,{model:this.getSheetModel(k),start:T,end:b,modelType:"Column",insertType:"after"})},d.prototype.insertSheet=function(T,b){this.notify(ye.IQJ,{model:this,start:T,end:b,modelType:"Sheet"})},d.prototype.delete=function(T,b,k,S){T=T||0;var m;if(!k||k==="Sheet")m=this;else if(m=this.getSheetModel(S),!m)return;this.notify(ye.$sV,{model:m,start:T,end:(0,P.le)(b)?T:b,modelType:k||"Sheet"})},d.prototype.moveSheet=function(T,b){(0,F.j1)(this,T,b)},d.prototype.duplicateSheet=function(T){(0,F.tN)(this,T)},d.prototype.getSheetModel=function(T){if((0,P.le)(T))return this.getActiveSheet();var b=typeof T=="string"?(0,F.Q8)(this,T):T;return(0,P.le)(b)||b>=this.sheets.length?null:this.sheets[b]},d.prototype.merge=function(T,b){var k,S;T?(k=(0,ye.MJG)(this,T),S=(0,F.zf)(this,k)):(S=this.getActiveSheet(),T=S.selectedRange),this.notify(ye.mtj,{merge:!0,range:T,type:b||"All",sheetIndex:k,refreshRibbon:T.indexOf(S.activeCell)>-1,preventRefresh:this.activeSheetIndex!==k})},d.prototype.computeExpression=function(T){var b={action:"computeExpression",formula:T};return this.notify(U.B7,b),b.calcValue},d.prototype.initEmptySheet=function(){this.sheets.length?(0,F.Vl)(this):this.createSheet()},d.prototype.getActiveSheet=function(){return this.sheets[this.activeSheetIndex]},d.prototype.skipHiddenSheets=function(T,b,k){return k===void 0&&(k=0),this.sheets[T]&&this.sheets[T].state!=="Visible"&&(b===void 0&&(b=T),T&&T+1===this.sheets.length?T=b-1:T=T<b?--T:++T,T=this.skipHiddenSheets(T,b,++k)),k===this.sheets.length?(this.setSheetPropertyOnMute(this.sheets[0],"state","Visible"),0):T},d.prototype.setUsedRange=function(T,b,k,S,m){if(k===void 0&&(k=this.getActiveSheet()),m){k.usedRange.rowIndex=T,k.usedRange.colIndex=b;return}T>k.usedRange.rowIndex&&(k.usedRange.rowIndex=T,k===this.getActiveSheet()&&!S&&this.notify(ye.XRp,{index:T,update:"row"})),b>k.usedRange.colIndex&&(k.usedRange.colIndex=b,k===this.getActiveSheet()&&!S&&this.notify(ye.XRp,{index:b,update:"col"}))},d.prototype.getData=function(T){return(0,w.Yu)(this,T)},d.prototype.getModuleName=function(){return"workbook"},d.prototype.goTo=function(T){},d.prototype.getValueRowCol=function(T,b,k,S,m,x){var v={action:"getSheetInfo",sheetInfo:[]};if(this.notify(U.B7,v),(0,F.Rg)(this,"Sheet"+T,v.sheetInfo)===-1){var y={action:"getReferenceError",refError:""};return this.notify(U.B7,y),y.refError}var A=(0,F.Pm)(this,T),I=(0,F.zf)(this,A),N=(0,Z.$S)(b-1,k-1,I);if(S&&S.includes("!")&&!N&&I.ranges&&I.ranges.length){var z;if(this.formulaRefCell&&this.formulaRefCell===S)return N&&N.value;if(I.ranges.forEach(function(V){if(!V.info||!V.info.loadedRange||!V.info.loadedRange.length){z=!0;return}}),z){if(this.formulaRefCell=S,A=(0,F.Pm)(this,Number(S.substring(S.lastIndexOf(",")+1,S.length))),(0,P.le)(A))return N&&N.value;S=S.substring(S.lastIndexOf("!")+1,S.lastIndexOf(",")),(0,w.Yu)(this,I.name+"!A1:"+(0,ye.qkm)(b-1,k-1),null,null,null,null,S,A)}}else N&&N.formula&&(m||(0,P.le)(N.value))&&!x&&this.notify("calculateFormula",{cell:N,rowIdx:b-1,colIdx:k-1,sheetIndex:A,formulaRefresh:!0});return N&&N.value},d.prototype.setValueRowCol=function(T,b,k,S,m){this.notify(E.BbZ,{action:"updateCellValue",address:[k-1,S-1],value:b,sheetIndex:(0,F.Pm)(this,T),isValueOnly:!0,formula:m})},d.prototype.open=function(T){this.notify(U.yK,T)},d.prototype.openFromJson=function(T){this.isOpen=!0;var b=typeof T.file=="object"?JSON.stringify(T.file):T.file;this.notify(U.yK,{jsonObject:b})},d.prototype.save=function(T){if(T===void 0&&(T={}),this.allowSave){var b={url:this.saveUrl,fileName:T.fileName||"Sample",saveType:"Xlsx"},k=Se({},b,T,{customParams:{},isFullPost:!0,needBlobData:!1,cancel:!1,pdfLayoutSettings:{fitSheetOnOnePage:!1}});this.trigger("beforeSave",k),this.notify(E.ya2,{eventArgs:k,action:"beforeSave"}),k.cancel||this.notify(U.bC,{saveSettings:k,isFullPost:k.isFullPost,needBlobData:k.needBlobData,customParams:k.customParams,pdfLayoutSettings:k.pdfLayoutSettings})}},d.prototype.saveAsJson=function(){var T=this;return new Promise(function(b){T.on(U.Vv,function(k){k.cancel=!0,T.off(U.Vv),b({jsonObject:{Workbook:k.jsonObject}}),T.notify(U.Dw,k)}),T.save()})},d.prototype.addHyperlink=function(T,b){var k={hyperlink:T,cell:b};this.notify(ye.g7J,k)},d.prototype.findHandler=function(T){T.findOpt==="next"?this.notify(U.g,T):T.findOpt==="prev"&&this.notify(U.a7,T)},d.prototype.replaceHandler=function(T){T.replaceBy==="replace"?this.notify(U.gx,T):this.notify(U.ko,T)},d.prototype.protectSheet=function(T,b,k){this.notify(U.tV,{protectSettings:b,password:k,sheetIndex:T})},d.prototype.unprotectSheet=function(T){var b={sheet:T};this.notify(U.X5,b)},d.prototype.sort=function(T,b){if(!this.allowSorting)return Promise.reject();var k={range:b||this.getActiveSheet().selectedRange,sortOptions:T||{sortDescriptors:{}},cancel:!1},S=new Promise(function(x,v){x(function(){}())}),m={args:k,promise:S};return this.notify(U.fq,m),m.promise},d.prototype.addDataValidation=function(T,b){T.type==="List"&&T.value1.length>256&&(T.value1=T.value1.substring(0,255)),this.notify(U.dK,{rules:T,range:b||this.getActiveSheet().selectedRange})},d.prototype.removeDataValidation=function(T){this.notify(U.dK,{range:T,isRemoveValidation:!0})},d.prototype.addInvalidHighlight=function(T){this.notify(U.CC,{range:T})},d.prototype.removeInvalidHighlight=function(T){this.notify(U.A2,{range:T})},d.prototype.isValidCell=function(T){var b=(0,ye.n53)(T),k=(0,Z.$S)(b[0],b[1],this.getActiveSheet());if(k&&k.validation){var S=k.value?k.value:"",m=this.activeSheetIndex,x={value:S,range:b,sheetIdx:m,isCell:!1,td:null,isValid:!0};return this.notify(U.tr,x),x.isValid}else return!0},d.prototype.conditionalFormat=function(T){T.range=T.range||this.getActiveSheet().selectedRange,this.notify(U.ax,{conditionalFormat:T})},d.prototype.clearConditionalFormat=function(T){T=T||this.getActiveSheet().selectedRange,this.notify(U.G2,{range:T})},d.prototype.updateCell=function(T,b){var k,S;if(b||(b=this.getActiveSheet().activeCell),b.includes("!")){if(k=(0,ye.IRR)(b),S=(0,F.Q8)(this,b.split("!")[0]),S===void 0)return}else k=(0,E.dK5)(b),S=this.activeSheetIndex;(0,ye.wWT)(this,this.sheets[S],{cell:T,rowIdx:k[0],colIdx:k[1],preventEvt:!0}),(T.value||T.value===""||T.value===0)&&this.notify(E.BbZ,{action:"updateCellValue",address:k,value:T.value,sheetIndex:S}),S===this.activeSheetIndex&&(this.serviceLocator.getService("cell").refresh(k[0],k[1],!0),this.notify(ye.q6q,null),(0,ye.Z2v)((0,E.dK5)(this.sheets[S].activeCell),k[0],k[1])&&this.notify(re.GN,{action:"refreshFormulabar",value:this.getDisplayText(T)||T.formula}))},d.prototype.getRowData=function(T,b){(0,P.le)(T)&&(T=0),(0,P.le)(b)&&(b=this.activeSheetIndex);var k={sheetIdx:b,startIndex:T,modelType:"Row",isDataRequest:!0};return this.notify(ye.atk,k),k.data},d.prototype.updateRange=function(T,b){b=b?b-1:this.activeSheetIndex;var k=(0,F.zf)(this,b),S=k.ranges;(0,P.le)(k)||(S.push(T),k.ranges=S)},d.prototype.wrap=function(T,b){b===void 0&&(b=!0),(0,Z.re)(T,b,this)},d.prototype.addDefinedName=function(T){var b={action:"addDefinedName",isAdded:!1,definedName:T};return this.notify(U.B7,b),b.isAdded},d.prototype.removeDefinedName=function(T,b){b===void 0&&(b="");var k={action:"removeDefinedName",isRemoved:!1,definedName:T,scope:b};return this.notify(U.B7,k),k.isRemoved},d.prototype.clearRange=function(T,b,k){},d.prototype.insertImage=function(T,b){this.notify(ye.QLx,{options:T,range:b||this.getActiveSheet().selectedRange})},d.prototype.autoFill=function(T,b,k,S){var m={dataRange:b||this.getActiveSheet().selectedRange,fillRange:T,direction:k||"Down",fillType:S||"FillSeries"};this.notify(ye.O$v,m)},d.prototype.insertChart=function(T){this.notify(ye.UyC,{chart:T})},d.prototype.deleteChart=function(T){this.notify(re.k0,{id:T})},d.prototype.filter=function(T,b){if(!this.allowFiltering)return Promise.reject();var k={range:b||this.getActiveSheet().selectedRange,filterOptions:T,cancel:!1},S=new Promise(function(x,v){x(function(){}())}),m={args:k,promise:S};return this.notify(U.c3,m),m.promise},d.prototype.addCustomFunction=function(T,b){b=b||(typeof T=="string"?T:T.name.replace("bound ",""));var k={action:"addCustomFunction",functionHandler:T,functionName:b};this.notify(U.B7,k)},d.prototype.clear=function(T){this.notify(U.ZH,T)},d.prototype.getDisplayText=function(T){if(!T)return"";if(T.format&&!(0,P.le)(T.value)){var b={formattedText:T.value,value:T.value,format:T.format,onLoad:!0,cell:T};return this.notify(U.eY,b),b.formattedText}else return!T.value&&T.hyperlink?typeof T.hyperlink=="string"?T.hyperlink:T.hyperlink.address:T.value||typeof T.value=="number"?T.value.toString():""},d.prototype.freezePanes=function(T,b,k){T===void 0&&(T=1),b===void 0&&(b=1);var S=this.getSheetModel(k);!this.allowFreezePane||S.frozenRows===T&&S.frozenColumns===b||(this.setSheetPropertyOnMute(S,"frozenRows",T),this.setSheetPropertyOnMute(S,"frozenColumns",b),this.updateTopLeftCell(),S.id===this.getActiveSheet().id&&this.getModuleName()==="spreadsheet"&&this.renderModule.refreshSheet())},d.prototype.Unfreeze=function(T){this.freezePanes(0,0,T)},d.prototype.unfreezePanes=function(T){this.freezePanes(0,0,T)},d.prototype.updateTopLeftCell=function(T,b,k,S){S||(S=this.getActiveSheet());var m=(0,ye.n53)(S.topLeftCell);S.frozenRows||S.frozenColumns?((0,P.le)(T)&&(T=S.frozenRows?0:m[0]),(0,P.le)(b)&&(b=S.frozenColumns?0:m[1]),T+=this.frozenRowCount(S),b+=this.frozenColCount(S),k&&(k==="row"?T=(0,ye.n53)(S.paneTopLeftCell)[0]:b=(0,ye.n53)(S.paneTopLeftCell)[1]),this.setSheetPropertyOnMute(S,"paneTopLeftCell",(0,ye.qkm)(T,b)),S.frozenRows&&(T=m[0]),S.frozenColumns&&(b=m[1])):((0,P.le)(T)&&(T=m[0]),(0,P.le)(b)&&(b=m[1]),this.setSheetPropertyOnMute(S,"paneTopLeftCell",(0,ye.qkm)(T,b))),this.setSheetPropertyOnMute(S,"topLeftCell",(0,ye.qkm)(T,b))},d.prototype.getAddressInfo=function(T){return(0,ye.ZXJ)(this,T)},d.prototype.setSheetPropertyOnMute=function(T,b,k){this.isProtectedOnChange=!0,T[b]=k,this.isProtectedOnChange=!1},d.prototype.frozenRowCount=function(T){return T.frozenRows?T.topLeftCell==="A1"?T.frozenRows:(0,ye.n53)(T.topLeftCell)[0]+T.frozenRows:0},d.prototype.frozenColCount=function(T){return T.frozenColumns?T.topLeftCell==="A1"?T.frozenColumns:(0,ye.n53)(T.topLeftCell)[1]+T.frozenColumns:0},d.prototype.updateRangeOnInsertDelete=function(T,b){var k,S=!1;return T.isInsert?(k=T.endIndex-T.startIndex+1,T.modelType==="Row"?(T.startIndex<=b[0]&&(b[0]+=k,S=!0),T.startIndex<=b[2]&&(b[2]+=k,S=!0)):(T.startIndex<=b[1]&&(b[1]+=k,S=!0),T.startIndex<=b[3]&&(b[3]+=k,S=!0))):T.modelType==="Row"?(k=b[0]-T.startIndex,k>0&&(b[0]>T.endIndex?(k=T.endIndex-T.startIndex+1,k>0&&(b[0]-=k,S=!0)):(b[0]-=k,S=!0)),T.startIndex<=b[2]&&(T.endIndex<=b[2]?b[2]-=T.endIndex-T.startIndex+1:b[2]-=b[2]-T.startIndex+1,S=!0)):(k=b[1]-T.startIndex,k>0&&(b[1]>T.endIndex?(k=T.endIndex-T.startIndex+1,k>0&&(b[1]-=k,S=!0)):(b[1]-=k,S=!0)),T.startIndex<=b[3]&&(T.endIndex<=b[3]?b[3]-=T.endIndex-T.startIndex+1:b[3]-=b[3]-T.startIndex+1,S=!0)),S},d.prototype.dateToInt=function(T){return(0,ye.twf)(T)},d.prototype.setDateFormat=function(T,b,k){var S=(0,F.zf)(this,(0,F.Pm)(this,T));(0,Z.$S)(b,k,S,null,!0).format||(0,Z.Jx)(b,k,S,{format:(0,$.Kz)("ShortDate")},!0)};var M;return Q([(0,P.FE)([],F.yo)],d.prototype,"sheets",void 0),Q([(0,P.Z9)(0)],d.prototype,"activeSheetIndex",void 0),Q([(0,P.Z9)("100%")],d.prototype,"height",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowFindAndReplace",void 0),Q([(0,P.Z9)()],d.prototype,"filterCollection",void 0),Q([(0,P.Z9)()],d.prototype,"sortCollection",void 0),Q([(0,P.Z9)("100%")],d.prototype,"width",void 0),Q([(0,P.Z9)(!0)],d.prototype,"showRibbon",void 0),Q([(0,P.Z9)(!0)],d.prototype,"showFormulaBar",void 0),Q([(0,P.Z9)(!0)],d.prototype,"showSheetTabs",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowEditing",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowOpen",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowSave",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowSorting",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowFiltering",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowNumberFormatting",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowCellFormatting",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowHyperlink",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowInsert",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowDelete",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowMerge",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowDataValidation",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowImage",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowChart",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowAutoFill",void 0),Q([(0,P.Zz)({},ye.hQ8)],d.prototype,"autoFillSettings",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowConditionalFormat",void 0),Q([(0,P.Zz)({},ye.qZI)],d.prototype,"cellStyle",void 0),Q([(0,P.Z9)("")],d.prototype,"openUrl",void 0),Q([(0,P.Z9)("")],d.prototype,"saveUrl",void 0),Q([(0,P.Z9)("")],d.prototype,"password",void 0),Q([(0,P.Z9)(!1)],d.prototype,"isProtected",void 0),Q([(0,P.FE)([],ye.rRQ)],d.prototype,"definedNames",void 0),Q([(0,P.ju)()],d.prototype,"beforeOpen",void 0),Q([(0,P.ju)()],d.prototype,"openFailure",void 0),Q([(0,P.ju)()],d.prototype,"beforeSave",void 0),Q([(0,P.ju)()],d.prototype,"saveComplete",void 0),Q([(0,P.ju)()],d.prototype,"beforeCellFormat",void 0),Q([(0,P.ju)()],d.prototype,"queryCellInfo",void 0),Q([(0,P.ju)()],d.prototype,"beforeCellUpdate",void 0),Q([(0,P.Z9)(!0)],d.prototype,"allowFreezePane",void 0),d=M=Q([P.Zl],d),d}(P.wA)},41447:function(q,be,ae){"use strict";ae.d(be,{dK:function(){return Y},n5:function(){return w},ug:function(){return ye},qk:function(){return U},i0:function(){return Z},AH:function(){return E},IR:function(){return a},VB:function(){return $},CP:function(){return J},ZX:function(){return se},MJ:function(){return re},g:function(){return Ae},hY:function(){return Se}});var P=ae(8923),F=ae(91997);function Y(Q){var te,O=[];return Q=Q.indexOf("!")>-1?Q.split("!")[1]:Q,Q=Q.indexOf(":")===-1?Q+":"+Q:Q,Q.split(":").forEach(function(d){te=w(d),O.push(te[0]),O.push(te[1])}),O}function w(Q){return[parseInt(Q.match(/\d+/)[0],10)-1,ye(Q.match(/[A-Z]+/i)[0].toUpperCase())]}function ye(Q){var te=0;Q=Q.split("").reverse().join("");for(var O=Q.length-1;O>=0;O--)te+=(Q[O].charCodeAt(0)-64)*Math.pow(26,O);return te-1}function U(Q,te){return E(te+1)+(Q+1)}function Z(Q){return U(Q[0],Q[1])+":"+((0,P.le)(Q[2])?U(Q[0],Q[1]):U(Q[2],Q[3]))}function E(Q){var te="Z";return Q/26>1?E(Q%26==0?Q/26-1:Math.floor(Q/26))+String.fromCharCode(Q%26==0?te.charCodeAt(0):64+Q%26):String.fromCharCode(64+Q)}function a(Q){return Y($(Q))}function $(Q){return Q.split("!")[1]||Q}function J(Q){return Q.name+"!"+Q.selectedRange}function se(Q,te){return{sheetIndex:re(Q,te),indices:a(te)}}function re(Q,te){var O;return te.indexOf("!")>-1?O=(0,F.Q8)(Q,(0,F.HA)(te)):O=Q.activeSheetIndex,O}function Ae(Q){var te=Q.slice();return Q[0]>Q[2]&&Ie(te,0,2),Q[1]>Q[3]&&Ie(te,1,3),te}function Ie(Q,te,O){var d=Q[te];Q[te]=Q[O],Q[O]=d}function Se(Q){return Q[0]===Q[2]&&Q[1]===Q[3]}},80788:function(q,be,ae){"use strict";ae.d(be,{Zu:function(){return P},uR:function(){return F},vB:function(){return Y},at:function(){return w},sQ:function(){return ye},yK:function(){return U},bC:function(){return Z},y:function(){return E},Ae:function(){return a},JK:function(){return $},Ts:function(){return J},eM:function(){return se},Dw:function(){return re},XU:function(){return Ae},eY:function(){return Ie},RT:function(){return Se},vb:function(){return Q},GH:function(){return te},nQ:function(){return O},nJ:function(){return d},XR:function(){return T},B7:function(){return b},Bb:function(){return k},w0:function(){return S},gf:function(){return m},q6:function(){return x},jJ:function(){return v},zc:function(){return y},GR:function(){return A},I:function(){return I},Ai:function(){return N},Y:function(){return z},wU:function(){return V},Az:function(){return _},C4:function(){return G},fd:function(){return K},AV:function(){return oe},Cf:function(){return he},fq:function(){return ue},Vz:function(){return X},G$:function(){return We},V_:function(){return Xe},TU:function(){return tt},gy:function(){return pt},g7:function(){return ht},c3:function(){return Et},W2:function(){return ce},ag:function(){return Ne},Vv:function(){return Te},$T:function(){return we},mn:function(){return ct},IQ:function(){return Lt},$s:function(){return vt},tr:function(){return Oe},dK:function(){return gi},CC:function(){return Ke},g:function(){return He},a7:function(){return Ci},E9:function(){return pe},gx:function(){return on},ko:function(){return uo},vC:function(){return Rl},wz:function(){return Ml},A2:function(){return os},EX:function(){return ls},QX:function(){return po},hg:function(){return yr},fg:function(){return Nl},tV:function(){return dr},cv:function(){return $r},X5:function(){return Dr},pw:function(){return ln},YY:function(){return hs},mt:function(){return Hs},i8:function(){return wa},aQ:function(){return Di},Zf:function(){return Hr},z3:function(){return Qr},Ic:function(){return Bl},wt:function(){return xa},ax:function(){return fo},wW:function(){return Vs},G2:function(){return zs},uA:function(){return us},ZH:function(){return _s},bL:function(){return js},e:function(){return hn},QL:function(){return rr},Uy:function(){return Ws},hA:function(){return Vr},bU:function(){return vo},Pp:function(){return mo},$q:function(){return go},Ll:function(){return Us},g2:function(){return Aa},Pe:function(){return Ta},cE:function(){return La},F5:function(){return ka},a8:function(){return Ia},x2:function(){return Da},To:function(){return Oa},M3:function(){return qs},NG:function(){return Zs},O$:function(){return Ys},VY:function(){return Gs},$u:function(){return ps},AH:function(){return ds},db:function(){return Ra},d8:function(){return Ma},L:function(){return Pa},cR:function(){return Ti},NK:function(){return Na},Pm:function(){return Ni},Ho:function(){return br},aU:function(){return Ks},xM:function(){return cn},UX:function(){return Fl},W$:function(){return bo}});var P="workbookDestroyed",F="updateSheetFromDataSource",Y="dataSourceChanged",w="dataChanged",ye="triggerDataChange",U="workbookOpen",Z="beginSave",E="actionBegin",a="sortImport",$="ribbonFind",J="exportDialog",se="getFilteredCollection",re="saveCompleted",Ae="applyNumber",Ie="getFormattedCell",Se="refreshCellElem",Q="setCellFormat",te="findAllValues",O="textDecorationUpdate",d="applyCellFormat",M="updateUsedRange",T="updateRowColCount",b="workbookFormulaOperation",k="workbookEditOperation",S="checkDateFormat",m="getFormattedBarText",x="activeCellChanged",v="openSuccess",y="openFailure",A="sheetCreated",I="sheetsDestroyed",N="aggregateComputation",z="getUniqueRange",V="removeUniquecol",_="checkUniqueRange",G="reApplyFormula",K="clearFormulaDependentCells",oe="formulaInValidation",he="beforeSort",ue="initiateSort",X="sortComplete",Ce="sortRangeAlert",ze="initiatelink",We="beforeHyperlinkCreate",Xe="afterHyperlinkCreate",tt="beforeHyperlinkClick",pt="afterHyperlinkClick",st="addHyperlink",ht="setLinkModel",rt="beforeFilter",Et="initiateFilter",Vt="filterComplete",ce="filterRangeAlert",ee="clearAllFilter",Ne="wrapText",Te="onSave",we="insert",ct="delete",Lt="insertModel",vt="deleteModel",Oe="isValidation",gi="cellValidation",Ke="addHighlight",ot="dataValidate",He="findNext",Ci="findPrevious",pe="gotoHandler",gr="findHandler",on="replace",uo="replaceAll",Rl="ShowDialog",Ml="findKeyUp",os="removeHighlight",ls="queryCellInfo",po="count",Pl="findCount",yr="protectSheet",Nl="updateToggleItem",dr="protectsheetHandler",$r="replaceAllDialog",Dr="unprotectsheetHandler",ln="editAlert",hs="setLockCells",cs="applyLockCells",Hs="setMerge",wa="applyMerge",Di="mergedRange",Hr="activeCellMergedRange",Qr="insertMerge",Bl="pasteMerge",xa="hideShow",fo="setCFRule",Vs="cFInitialCheck",zs="clearCFRule",Ea="initiateClearCFRule",us="cFRender",_s="clear",js="clearCF",hn="clearCells",rr="setImage",Ws="setChart",Vr="initiateChart",vo="refreshRibbonIcons",mo="refreshChart",go="refreshChartSize",Us="updateChart",Aa="deleteChartColl",yo="initiateChartModel",Ta="focusChartBorder",La="saveError",ka="validationHighlight",Ia="updateFilter",Da="beforeInsert",Oa="beforeDelete",qs="deleteHyperlink",Zs="moveOrDuplicateSheet",Ys="setAutoFill",Gs="refreshCell",ps="getFillInfo",ds="getautofillDDB",Ra="rowFillHandler",Ma="getTextSpace",Pa="cFUndo",Ti="refreshClipboard",Na="updateView",Ni="selectionComplete",br="refreshInsertDelete",Ks="getUpdatedFormulaOnInsertDelete",cn="checkConditionalFormat",Fl="beforeCellUpdate",bo="duplicateSheetFilterHandler"},93010:function(q,be,ae){"use strict";ae.d(be,{hQ8:function(){return A},qZI:function(){return Ae},kL2:function(){return v},i2Z:function(){return T},rRQ:function(){return Q},EDR:function(){return M},Eep:function(){return y},kcM:function(){return te},q6q:function(){return I.q6},Zf5:function(){return I.Zf},CC2:function(){return I.CC},V_l:function(){return I.V_},Ai5:function(){return I.Ai},nJk:function(){return I.nJ},i8F:function(){return I.i8},XUD:function(){return I.XU},UXI:function(){return I.UX},ToX:function(){return I.To},G$g:function(){return I.G$},x2y:function(){return I.x2},ya2:function(){return I.y},wWe:function(){return I.wW},uAN:function(){return I.uA},L:function(){return I.L},dKh:function(){return I.dK},xMH:function(){return I.xM},w0y:function(){return I.w0},C2M:function(){return N},Azt:function(){return I.Az},ZHw:function(){return I.ZH},bLA:function(){return I.bL},G2p:function(){return I.G2},eaW:function(){return I.e},fdW:function(){return I.fd},QXW:function(){return I.QX},atk:function(){return I.at},vB1:function(){return I.vB},twf:function(){return rt.tw},mnp:function(){return I.mn},g2O:function(){return I.g2},OJx:function(){return ht},M3o:function(){return I.M3},$sV:function(){return I.$s},W$A:function(){return I.W$},Tsy:function(){return I.Ts},GHh:function(){return I.GH},wzZ:function(){return I.wz},gaV:function(){return I.g},a7B:function(){return I.a7},PeM:function(){return I.Pe},AVn:function(){return I.AV},CP8:function(){return P.CP},ZXJ:function(){return P.ZX},qkm:function(){return P.qk},n53:function(){return P.n5},ugT:function(){return P.ug},AH9:function(){return P.AH},Oyx:function(){return pt},$uf:function(){return I.$u},eM_:function(){return I.eM},gff:function(){return I.gf},eYQ:function(){return I.eY},IRR:function(){return P.IR},i0K:function(){return P.i0},VBe:function(){return P.VB},dK5:function(){return P.dK},MJG:function(){return P.MJ},kFj:function(){return ue},gaE:function(){return P.g},d8d:function(){return I.d8},uAQ:function(){return I.Y},flO:function(){return Xe},aU5:function(){return I.aU},AH7:function(){return I.AH},E9X:function(){return I.E9},wtl:function(){return I.wt},Z2v:function(){return K},hAg:function(){return I.hA},fqz:function(){return I.fq},$Tr:function(){return I.$T},gQT:function(){return st},z3C:function(){return I.z3},IQJ:function(){return I.IQ},ODv:function(){return rt.OD},qhV:function(){return z},uan:function(){return G},v9:function(){return rt.v9},X1M:function(){return We},ZsD:function(){return oe},mhJ:function(){return he},p1d:function(){return X},hj$:function(){return rt.hj},Axt:function(){return _},hYl:function(){return P.hY},trg:function(){return I.tr},jHi:function(){return Vt},aQp:function(){return I.aQ},NGR:function(){return I.NG},zcH:function(){return I.zc},jJC:function(){return I.jJ},MpA:function(){return rt.Mp},Ice:function(){return I.Ic},hgb:function(){return I.hg},tVr:function(){return I.tV},EXN:function(){return I.EX},C4_:function(){return I.C4},VYm:function(){return I.VY},RTt:function(){return I.RT},PpD:function(){return I.Pp},$qQ:function(){return I.$q},cRm:function(){return I.cR},HoA:function(){return I.Ho},bUq:function(){return I.bU},A2l:function(){return I.A2},wUt:function(){return I.wU},gxs:function(){return I.gx},kon:function(){return I.ko},RDz:function(){return I.cv},JK0:function(){return I.JK},dbz:function(){return I.db},Pmi:function(){return I.Pm},O$v:function(){return I.O$},axz:function(){return I.ax},vbl:function(){return I.vb},UyC:function(){return I.Uy},QLx:function(){return I.QL},g7J:function(){return I.g7},YYv:function(){return I.YY},mtj:function(){return I.mt},GRU:function(){return I.GR},Iap:function(){return I.I},vCD:function(){return I.vC},Sxm:function(){return ze},Vzf:function(){return I.Vz},Aed:function(){return I.Ae},nQ:function(){return I.nQ},ZUP:function(){return rt.ZU},ULC:function(){return rt.UL},sQc:function(){return I.sQ},X5W:function(){return I.X5},wWT:function(){return tt},Ll5:function(){return I.Ll},a8y:function(){return I.a8},XRp:function(){return I.XR},uRS:function(){return I.uR},fg8:function(){return I.fg},NK6:function(){return I.NK},F5$:function(){return I.F5},pwO:function(){return I.pw},BbZ:function(){return I.Bb},B7N:function(){return I.B7},L1M:function(){return Et},yKE:function(){return I.yK},agw:function(){return I.ag}});var P=ae(41447),F=ae(92715),Y=ae(77084),w=ae(34819),ye=ae(55152),U=ae(57387),Z=ae(95005),E=function(){function ce(){Y.IEE.Inject(Y.vdt,w.w0,w.rV,ye.Np,U.y9,U.Do,w.VP,w.RD,U.zp,w.Yl,U.VB,U.WC,U.tq,U.tU,U.uZ,U.nH,Z.e,w.g,w.s,U.aE)}return ce.prototype.getModuleName=function(){return"workbookBasic"},ce.prototype.destroy=function(){},ce}(),a=function(){function ce(){Y.IEE.Inject(Y.vdt,w.w0,w.Np,U.y9,U.Do,w.VP,w.rV,w.RD,U.zp,w.Yl,U.VB,U.WC,U.tq,U.tU,U.uZ,U.nH,Z.e,w.g,w.s,U.aE)}return ce.prototype.getModuleName=function(){return"workbook-all"},ce.prototype.destroy=function(){},ce}(),$=ae(70180),J=ae(8923),se=function(){var ce=function(ee,Ne){return ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Te,we){Te.__proto__=we}||function(Te,we){for(var ct in we)we.hasOwnProperty(ct)&&(Te[ct]=we[ct])},ce(ee,Ne)};return function(ee,Ne){ce(ee,Ne);function Te(){this.constructor=ee}ee.prototype=Ne===null?Object.create(Ne):(Te.prototype=Ne.prototype,new Te)}}(),re=function(ce,ee,Ne,Te){var we=arguments.length,ct=we<3?ee:Te===null?Te=Object.getOwnPropertyDescriptor(ee,Ne):Te,Lt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ct=Reflect.decorate(ce,ee,Ne,Te);else for(var vt=ce.length-1;vt>=0;vt--)(Lt=ce[vt])&&(ct=(we<3?Lt(ct):we>3?Lt(ee,Ne,ct):Lt(ee,Ne))||ct);return we>3&&ct&&Object.defineProperty(ee,Ne,ct),ct},Ae=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)("Calibri")],ee.prototype,"fontFamily",void 0),re([(0,J.Z9)("bottom")],ee.prototype,"verticalAlign",void 0),re([(0,J.Z9)("left")],ee.prototype,"textAlign",void 0),re([(0,J.Z9)("0pt")],ee.prototype,"textIndent",void 0),re([(0,J.Z9)("#000000")],ee.prototype,"color",void 0),re([(0,J.Z9)("#ffffff")],ee.prototype,"backgroundColor",void 0),re([(0,J.Z9)("normal")],ee.prototype,"fontWeight",void 0),re([(0,J.Z9)("normal")],ee.prototype,"fontStyle",void 0),re([(0,J.Z9)("11pt")],ee.prototype,"fontSize",void 0),re([(0,J.Z9)("none")],ee.prototype,"textDecoration",void 0),re([(0,J.Z9)("")],ee.prototype,"border",void 0),re([(0,J.Z9)("")],ee.prototype,"borderTop",void 0),re([(0,J.Z9)("")],ee.prototype,"borderBottom",void 0),re([(0,J.Z9)("")],ee.prototype,"borderLeft",void 0),re([(0,J.Z9)("")],ee.prototype,"borderRight",void 0),ee}(J.rt),Ie=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)()],ee.prototype,"sheetIndex",void 0),re([(0,J.Z9)()],ee.prototype,"filterRange",void 0),re([(0,J.Z9)(!1)],ee.prototype,"hasFilter",void 0),re([(0,J.Z9)()],ee.prototype,"column",void 0),re([(0,J.Z9)()],ee.prototype,"criteria",void 0),re([(0,J.Z9)()],ee.prototype,"value",void 0),re([(0,J.Z9)()],ee.prototype,"dataType",void 0),re([(0,J.Z9)()],ee.prototype,"predicates",void 0),ee}(J.rt),Se=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)()],ee.prototype,"sortRange",void 0),re([(0,J.Z9)()],ee.prototype,"columnIndex",void 0),re([(0,J.Z9)()],ee.prototype,"order",void 0),re([(0,J.Z9)()],ee.prototype,"sheetIndex",void 0),ee}(J.rt),Q=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)("")],ee.prototype,"name",void 0),re([(0,J.Z9)("")],ee.prototype,"scope",void 0),re([(0,J.Z9)("")],ee.prototype,"comment",void 0),re([(0,J.Z9)("")],ee.prototype,"refersTo",void 0),ee}(J.rt),te=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)(!1)],ee.prototype,"selectCells",void 0),re([(0,J.Z9)(!1)],ee.prototype,"selectUnLockedCells",void 0),re([(0,J.Z9)(!1)],ee.prototype,"formatCells",void 0),re([(0,J.Z9)(!1)],ee.prototype,"formatRows",void 0),re([(0,J.Z9)(!1)],ee.prototype,"formatColumns",void 0),re([(0,J.Z9)(!1)],ee.prototype,"insertLink",void 0),ee}(J.rt),O=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)("")],ee.prototype,"address",void 0),ee}(J.rt),d=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)("WholeNumber")],ee.prototype,"type",void 0),re([(0,J.Z9)("Between")],ee.prototype,"operator",void 0),re([(0,J.Z9)("0")],ee.prototype,"value1",void 0),re([(0,J.Z9)("0")],ee.prototype,"value2",void 0),re([(0,J.Z9)(!0)],ee.prototype,"ignoreBlank",void 0),re([(0,J.Z9)(!0)],ee.prototype,"inCellDropDown",void 0),re([(0,J.Z9)(!1)],ee.prototype,"isHighlighted",void 0),re([(0,J.Z9)("")],ee.prototype,"address",void 0),ee}(J.rt),M=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)("General")],ee.prototype,"format",void 0),re([(0,J.Zz)({},Ae)],ee.prototype,"style",void 0),re([(0,J.Z9)(!0)],ee.prototype,"isLocked",void 0),ee}(J.rt),T=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)("GreaterThan")],ee.prototype,"type",void 0),re([(0,J.Zz)({},M)],ee.prototype,"format",void 0),re([(0,J.Z9)("RedFT")],ee.prototype,"cFColor",void 0),re([(0,J.Z9)("")],ee.prototype,"value",void 0),re([(0,J.Z9)("")],ee.prototype,"range",void 0),ee}(J.rt),b=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)(!0)],ee.prototype,"visible",void 0),re([(0,J.Z9)("Auto")],ee.prototype,"position",void 0),ee}(J.rt),k=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)(!1)],ee.prototype,"visible",void 0),re([(0,J.Z9)("Auto")],ee.prototype,"position",void 0),ee}(J.rt),S=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)(0)],ee.prototype,"width",void 0),ee}(J.rt),m=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)(0)],ee.prototype,"width",void 0),ee}(J.rt),x=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)("")],ee.prototype,"title",void 0),re([(0,J.Zz)({},S)],ee.prototype,"majorGridLines",void 0),re([(0,J.Zz)({},m)],ee.prototype,"minorGridLines",void 0),re([(0,J.Z9)(!0)],ee.prototype,"visible",void 0),ee}(J.rt),v=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)("Line")],ee.prototype,"type",void 0),re([(0,J.Z9)("Material")],ee.prototype,"theme",void 0),re([(0,J.Z9)(!1)],ee.prototype,"isSeriesInRows",void 0),re([(0,J.Z9)("")],ee.prototype,"range",void 0),re([(0,J.Z9)("")],ee.prototype,"id",void 0),re([(0,J.Z9)("")],ee.prototype,"title",void 0),re([(0,J.Z9)(290)],ee.prototype,"height",void 0),re([(0,J.Z9)(480)],ee.prototype,"width",void 0),re([(0,J.Z9)(0)],ee.prototype,"top",void 0),re([(0,J.Z9)(0)],ee.prototype,"left",void 0),re([(0,J.Zz)({},b)],ee.prototype,"legendSettings",void 0),re([(0,J.Zz)({},x)],ee.prototype,"primaryXAxis",void 0),re([(0,J.Zz)({},x)],ee.prototype,"primaryYAxis",void 0),re([(0,J.Zz)({},k)],ee.prototype,"dataLabelSettings",void 0),ee}(J.rt),y=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)("")],ee.prototype,"src",void 0),re([(0,J.Z9)("")],ee.prototype,"id",void 0),re([(0,J.Z9)(300)],ee.prototype,"height",void 0),re([(0,J.Z9)(400)],ee.prototype,"width",void 0),re([(0,J.Z9)(0)],ee.prototype,"top",void 0),re([(0,J.Z9)(0)],ee.prototype,"left",void 0),ee}(J.rt),A=function(ce){se(ee,ce);function ee(){return ce!==null&&ce.apply(this,arguments)||this}return re([(0,J.Z9)("FillSeries")],ee.prototype,"fillType",void 0),re([(0,J.Z9)(!0)],ee.prototype,"showFillOptions",void 0),ee}(J.rt),I=ae(80788);function N(ce,ee){return ce&&ce[0]==="="&&(ce.length>1||ee)}function z(ce){var ee=ce;if(ee=ee.split("$").join(""),ee.indexOf(":")>-1){var Ne=ee.split(":");if(Ce(Ne[0])&&Ce(Ne[1]))return!0}else if(ee.indexOf(":")<0&&Ce(ee))return!0;return!1}function V(ce){return ce.charCodeAt(0)>=65&&ce.charCodeAt(0)<=90||ce.charCodeAt(0)>=97&&ce.charCodeAt(0)<=122}function _(ce,ee){return ee[1]===0&&ee[3]===ce.colCount-1}function G(ce,ee){return ee[0]===0&&ee[2]===ce.rowCount-1}function K(ce,ee,Ne){return ce&&ee>=ce[0]&&ee<=ce[2]&&Ne>=ce[1]&&Ne<=ce[3]}function oe(ce,ee,Ne){for(var Te,we,ct=ce.split(" "),Lt=0,vt=ct.length;Lt<vt&&(Te=(0,P.dK)(ct[Lt]),we=K(Te,ee,Ne),!we);Lt++);return we}function he(ce,ee,Ne){var Te=ce[0]<=ee[0]&&ce[2]>=ee[2]&&ce[1]<=ee[1]&&ce[3]>=ee[3];if(Te)return!0;if(Ne){if(ee[0]<ce[0]&&ee[2]<ce[0]||ee[0]>ce[2]&&ee[2]>ce[2]||(ee[0]<ce[0]&&ee[2]>ce[0]&&(ee[0]=ce[0],Te=!0),ee[2]>ce[2]&&(ee[2]=ce[2],Te=!0),ee[1]<ce[1]&&ee[3]<ce[1]||ee[1]>ce[3]&&ee[3]>ce[3]))return!1;ee[1]<ce[1]&&ee[3]>ce[1]&&(ee[1]=ce[1],Te=!0),ee[3]>ce[3]&&(ee[3]=ce[3],Te=!0)}return Te}function ue(ce,ee,Ne){var Te=(0,P.AH)(Ne+1);return ce?ce.split(" ").forEach(function(we){var ct=(0,P.dK)(we);if(he(ct,ee))ce=ce.split(we).join(Te+(ct[0]+1)+":"+Te+ee[0]+" "+Te+(ee[2]+2)+":"+Te+(ct[2]+1));else if(he(ct,ee,!0)){var Lt=void 0;ee[0]>ct[0]?Lt=Te+(ct[0]+1)+":"+Te+ee[0]:Lt=Te+(ee[2]+2)+":"+Te+(ct[2]+1),ce=ce.split(we).join(Lt)}}):ce=Te+"1:"+Te+ee[0]+" "+Te+(ee[2]+2)+":"+Te+"1048576",ce}function X(ce,ee){return ce||(ce={}),ce.isLocked?!0:ce.isLocked===!1?!1:ee&&ee.isLocked?!0:!!(!ce.isLocked&&ee&&ee.isLocked!==!1)}function Ce(ce){for(var ee=ce,Ne=0,Te=0,we=0,ct=[89,71,69],Lt="",vt=ee.length,Oe=0;Oe<vt;Oe++)V(ee[Oe])&&Te++;Lt=ee.substring(Ne,Te);var gi=Lt.length;if(gi!==vt&&gi<4&&vt!==1&&isNaN(parseInt(ee,10))){for(;we<gi;)if(Lt[we]&&Lt[we].charCodeAt(0)<ct[we]){we++;continue}else{if(!Lt[we]&&we>0)break;return!1}var Ke=parseFloat(ee.substring(Te,vt));if(Ke>0&&Ke<1048577)return!0}return!1}function ze(ce,ee,Ne,Te){if(Te===void 0&&(Te="rows"),Ne)for(var we=ee;we<Infinity&&(ce[Te][ee]&&ce[Te][ee].hidden);we++)ee++;else for(var we=ee;we>-1&&(ce[Te][ee]&&ce[Te][ee].hidden);we--)ee--;return ee}function We(ce,ee){var Ne=Object.keys(ce);return(ee?Ne.indexOf("fontSize")>-1:Ne.indexOf("fontSize")>-1&&Number(ce.fontSize.split("pt")[0])>12)||Ne.indexOf("fontFamily")>-1||Ne.indexOf("borderTop")>-1||Ne.indexOf("borderBottom")>-1}function Xe(ce,ee,Ne,Te){var we,ct;if(ee&&(ct=Te||(0,Y.$Su)(ee[0],ee[1],Ne,!1,!0),we=ct.formula?ct.formula.toUpperCase():""),we){we.indexOf("=")===0&&(we=we.slice(1)),we=we.split("(").join(",").split(")").join(",");for(var Lt=["+","-","*","/",">=","<=","<>",">","<","=","%"],vt=void 0,Oe=we,gi=0;gi<Lt.length;gi++)vt=Oe.split(Lt[gi]),Oe=vt.join(",");vt=Oe.split(",");for(var Ke=[],ot=void 0,He=void 0,Ci=0;Ci<vt.length;Ci++)if(z(vt[Ci])){var pe=(0,P.dK)(vt[Ci]),gr=[ce[0]-(ee[0]-pe[0]),ce[1]-(ee[1]-pe[1]),ce[0]-(ee[0]-pe[2]),ce[1]-(ee[1]-pe[3])];gr[0]<0||gr[1]<0||gr[2]<0||gr[3]<0?ot="#REF!":(ot=(0,P.qk)(gr[0],gr[1]),vt[Ci].includes(":")&&(ot+=":"+(0,P.qk)(gr[2],gr[3])),ot=z(ot)?ot:"#REF!"),He={},He[vt[Ci]]=ot,vt[Ci].includes(":")?Ke.splice(0,0,He):Ke.push(He)}var on=void 0;we=ct.formula;for(var Ci=0;Ci<Ke.length;Ci++)on=Object.keys(Ke[Ci])[0],we=we.replace(new RegExp(on,"gi"),Ke[Ci][on].toUpperCase());return we}else return null}function tt(ce,ee,Ne){var Te={cell:Ne.cell,rowIndex:Ne.rowIdx,colIndex:Ne.colIdx,cancel:!1,sheet:ee.name};if(Ne.preventEvt||ce.trigger(I.UX,Te),!Ne.eventOnly&&!Te.cancel)if(Ne.valChange){var we=(0,Y.$Su)(Te.rowIndex,Te.colIndex,ee),ct=!Ne.preventEvt&&ce.getDisplayText(we),Lt=!!(we&&we.formula);(0,Y.Jxt)(Te.rowIndex,Te.colIndex,ee,Te.cell,!Ne.pvtExtend);var vt=(0,Y.$Su)(Te.rowIndex,Te.colIndex,ee,!1,!0);if(ce.notify(I.Bb,{action:"updateCellValue",address:[Te.rowIndex,Te.colIndex],sheetIndex:(0,Y.Q8D)(ce,ee.name),value:Lt&&!vt.formula?vt.value||(vt.value===0?"0":""):vt.formula||vt.value||(vt.value===0?"0":"")}),Ne.requestType&&Te.cell===null&&(0,Y.Jxt)(Te.rowIndex,Te.colIndex,ee,Te.cell,!Ne.pvtExtend),Ne.cellDelete&&(delete vt.value,delete vt.formula,delete vt.hyperlink),Ne.uiRefresh&&ce.serviceLocator.getService("cell").refresh(Te.rowIndex,Te.colIndex,Ne.lastCell,Ne.td,Ne.checkCf,Ne.checkWrap),!Ne.preventEvt){var Oe=ce.getDisplayText(vt);if(Oe!==ct){var gi=(0,Y.$Su)(Te.rowIndex,Te.colIndex,ee,!1,!0).value;gi=gi||(gi===0?"0":"");var Ke={value:gi,oldValue:ct,formula:vt.formula||"",address:ee.name+"!"+(0,P.qk)(Te.rowIndex,Te.colIndex),displayText:Oe};Ne.requestType&&(Ke.requestType=Ne.requestType),ce.trigger("cellSave",Ke)}}}else(0,Y.Jxt)(Te.rowIndex,Te.colIndex,ee,Te.cell,!Ne.pvtExtend);return Te.cancel}function pt(ce,ee,Ne){var Te=0,we=0,ct=0,Lt=Ne.usedRange.rowIndex+Ne.usedRange.colIndex,vt={rowIndex:ce,colIndex:ee},Oe={rowIndex:ce,colIndex:ee};for(Te=1;Te<Lt+1;Te++){for(we=-ct;we<ct+1;we++)(0,Y.$Su)(ce+we,ee+Te,Ne,null,!0).value&&(Oe.rowIndex=Oe.rowIndex>ce+we?Oe.rowIndex:ce+we,Oe.colIndex=Oe.colIndex>ee+Te?Oe.colIndex:ee+Te);for((0,Y.$Su)(ce+Te,ee+Te,Ne,null,!0).value&&(Oe.rowIndex=Oe.rowIndex>ce+Te?Oe.rowIndex:ce+Te,Oe.colIndex=Oe.colIndex>ee+Te?Oe.colIndex:ee+Te),we=-ct;we<ct+1;we++)(0,Y.$Su)(ce+Te,ee+we,Ne,null,!0).value&&(Oe.rowIndex=Oe.rowIndex>ce+Te?Oe.rowIndex:ce+Te,Oe.colIndex=Oe.colIndex>ee+we?Oe.colIndex:ee+we);for((0,Y.$Su)(ce+Te,ee-Te,Ne,null,!0).value&&(Oe.rowIndex=Oe.rowIndex>ce+Te?Oe.rowIndex:ce+Te,vt.colIndex=vt.colIndex<ee-Te?vt.colIndex:ee-Te),we=-ct;we<ct+1;we++)(0,Y.$Su)(ce+we,ee-Te,Ne,null,!0).value&&(vt.rowIndex=vt.rowIndex<ce+we?vt.rowIndex:ce+we,vt.colIndex=vt.colIndex<ee-Te?vt.colIndex:ee-Te,Oe.rowIndex=Oe.rowIndex>ce+we?Oe.rowIndex:ce+we);for((0,Y.$Su)(ce-Te,ee-Te,Ne,null,!0).value&&(vt.rowIndex=vt.rowIndex<ce-Te?vt.rowIndex:ce-Te,vt.colIndex=vt.colIndex<ee-Te?vt.colIndex:ee-Te),we=-ct;we<ct+1;we++)(0,Y.$Su)(ce-Te,ee+we,Ne,null,!0).value&&(vt.rowIndex=vt.rowIndex<ce-Te?vt.rowIndex:ce-Te,vt.colIndex=vt.colIndex<ee+we?vt.colIndex:ee+we,Oe.colIndex=Oe.colIndex>ee+we?Oe.colIndex:ee+we);(0,Y.$Su)(ce-Te,ee+Te,Ne,null,!0).value&&(vt.rowIndex=vt.rowIndex<ce-Te?vt.rowIndex:ce-Te,Oe.colIndex=Oe.colIndex>ee+Te?Oe.colIndex:ee+Te),ct++}return[vt.rowIndex,vt.colIndex,Oe.rowIndex,Oe.colIndex]}function st(ce,ee,Ne){var Te=(0,P.dK)(ce.model.selectedRange),we=0,ct=0;return ce.modelType==="Column"?(Ne&&(Te=[0,ce.start,0,ce.end]),ce.insertType==="before"?ee[1]<=Te[1]&&ee[3]>=Te[1]?(we=0,ct=Te[3]-Te[1]+1):Te[1]<ee[1]&&(we=ct=Te[3]-Te[1]+1):ee[1]<=Te[3]&&ee[3]>=Te[3]?(we=0,ct=Te[3]-Te[1]+1):Te[3]<ee[3]&&(we=ct=Te[3]-Te[1]+1),[ee[0],ee[1]+we,ee[2],ee[3]+ct]):(Ne&&(Te=[ce.start,0,ce.end,0]),ce.insertType==="above"?ee[0]<=Te[0]&&ee[2]>=Te[0]?(we=0,ct=Te[2]-Te[0]+1):Te[0]<ee[0]&&(we=ct=Te[2]-Te[0]+1):ee[0]<=Te[2]&&ee[2]>=Te[2]?(we=0,ct=Te[2]-Te[0]+1):Te[2]<ee[2]&&(we=ct=Te[2]-Te[0]+1),[ee[0]+we,ee[1],ee[2]+ct,ee[3]])}function ht(ce,ee){var Ne,Te=0,we=0;return ce.modelType==="Column"?(Ne=[0,ce.start,ce.model.usedRange.rowIndex,ce.end],Ne[3]<ee[1]?Te=we=Ne[3]-Ne[1]+1:Ne[1]>=ee[1]&&Ne[3]<=ee[3]?we=Ne[3]-Ne[1]+1:Ne[1]>=ee[1]&&Ne[1]<=ee[3]?we=ee[3]-Ne[1]+1:Ne[1]<ee[1]&&Ne[3]>=ee[1]?(Te=ee[1]-Ne[1],we=Ne[3]-Ne[1]+1):Ne[1]<ee[1]&&Ne[3]<ee[3]&&(Te=Ne[3]-ee[1]+(Ne[3]-Ne[1])+1,we=Ne[3]-Ne[1]+1),[ee[0],ee[1]-Te,ee[2],ee[3]-we]):(Ne=[ce.start,0,ce.end,ce.model.usedRange.colIndex],Ne[2]<ee[0]?Te=we=Ne[2]-Ne[0]+1:Ne[0]>=ee[0]&&Ne[2]<=ee[2]?we=Ne[2]-Ne[0]+1:Ne[0]>=ee[0]&&Ne[0]<=ee[2]?we=ee[2]-Ne[0]+1:Ne[0]<ee[0]&&Ne[2]>=ee[0]?(Te=ee[0]-Ne[0],we=Ne[2]-Ne[0]+1):Ne[0]<ee[0]&&Ne[2]<ee[2]&&(Te=Ne[2]-ee[0]+(Ne[2]-Ne[0])+1,we=Ne[2]-Ne[0]+1),[ee[0]-Te,ee[1],ee[2]-we,ee[3]])}var rt=ae(9402),Et="spreadsheetLocale",Vt={SortOutOfRangeError:"Select a cell or range inside the used range and try again."}},81010:function(q,be,ae){"use strict";ae.d(be,{G:function(){return F}});var P=ae(9402);function F(w,ye,U,Z,E){var a=w.value;return(0,P.hj)(a)?{isNumber:!0,value:a}:(E&&w.format.indexOf(E)>-1&&a&&a.indexOf(E)>-1&&(a=a.replace(E,"")),w.format.indexOf(U)>-1&&a&&a.indexOf(U)>-1&&(a=Y(a,ye,U,Z)?a.split(U).join(""):a),{isNumber:(0,P.hj)(a),value:a})}function Y(w,ye,U,Z){for(var E=!1,a=123456,$=a.toLocaleString(ye),J=$.split(U).reverse(),se=w.split(Z)[0].split(U),re=0;re<se.length&&(re===se.length-1?E=se[re].length===J[0].length:E=re==0?se[re].length<=J[1].length:se[re].length===J[1].length,!!E);re++);return E}},9402:function(q,be,ae){"use strict";ae.d(be,{UL:function(){return F},OD:function(){return w},tw:function(){return ye},v9:function(){return U},hj:function(){return Z},ZU:function(){return E},Mp:function(){return a}});var P=ae(8923);function F($){var J=$.toString();if($===parseInt(J,10))return parseInt(J,10)+"  ";var se=J.indexOf(".")>-1?J.split(".")[1]:0,re=Math.pow(10,se.toString().replace("-","").length),Ae=Math.abs(Y(se,re));return se/Ae+"/"+re/Ae}function Y($,J){return $=Number($),J=Number(J),J?Y(J,$%J):$}function w($){$=Number($),$=$>0&&$<1?1+$:$===0?1:$,$>60&&($-=1);var J=new Date("01/01/1900"),se=Date.UTC(J.getFullYear(),J.getMonth(),J.getDate(),J.getHours(),J.getMinutes(),J.getSeconds(),J.getMilliseconds());return new Date(new Date(($-1)*(1e3*3600*24)+se).toUTCString().replace(" GMT",""))}function ye($,J,se){var re=new Date("01/01/1900"),Ae=U($)?$:new Date($),Ie=Date.UTC(re.getFullYear(),re.getMonth(),re.getDate(),re.getHours(),re.getMinutes(),re.getSeconds(),re.getMilliseconds()),Se=Date.UTC(Ae.getFullYear(),Ae.getMonth(),Ae.getDate(),Ae.getHours(),Ae.getMinutes(),Ae.getSeconds(),Ae.getMilliseconds()),Q=(Se-Ie)/(1e3*3600*24);return(J?Q:parseInt(Q.toString(),10))+(se?0:Q>60?2:1)}function U($){return Object.prototype.toString.call($)==="[object Date]"&&!isNaN($.valueOf())}function Z($){return $-parseFloat($)>=0}function E($,J,se,re,Ae){var Ie=P.sd.getDependables(P.qV,se,null).dateObject,Se=Ie.dateTimeFormats.availableFormats,Q={dateObj:null,isCustom:!1,type:""};if(typeof $=="string"&&($=$.toUpperCase()),re&&(Q.dateObj=J.parseDate($,{format:re}),Q.dateObj&&(Q.type=$.toString().indexOf(":")>-1?"time":"datetime",Q.isCustom=!0)),(0,P.le)(Q.dateObj)){if($=$.toString(),$&&$.indexOf("/")>-1||$.indexOf("-")>0){var te=Ae&&Ae.format||re,O=te.includes("dd-MM-yy");if((O||te.includes("dd/MM/yy"))&&(te=O?"d-M-y":"d/M/y",Q.dateObj=J.parseDate($,{format:te,skeleton:"yMd"}),Q.dateObj))return Q.type="date",Q}if($.indexOf(":")<0)for(var d=0,M=Object.keys(Ie.dateFormats);d<M.length;d++){var T=M[d];if(Q.dateObj=J.parseDate($,{format:Ie.dateFormats[T],skeleton:T}),Q.dateObj){Q.type="date",Q.isCustom=!1;break}}if((0,P.le)(Q.dateObj))for(var b=0,k=Object.keys(Se);b<k.length;b++){var T=k[b];if(Q.dateObj=J.parseDate($,{format:Se[T],skeleton:T}),!Q.dateObj&&$.indexOf(":")>-1&&Se[T].indexOf(":")>-1&&(Q.dateObj=J.parseDate($,{format:Se[T].split(" ")[0]})),Q.dateObj){if(Q.type=$.toString().indexOf(":")>-1?"time":"datetime",Q.type==="time"){var S=Q.dateObj.toLocaleTimeString();Q.dateObj=new Date("01/01/1900 "+S)}Q.isCustom=!0;break}}if((0,P.le)(Q.dateObj))for(var m=0,x=Object.keys(Ie.timeFormats);m<x.length;m++){var T=x[m];if(Q.dateObj=J.parseDate($,{format:Ie.timeFormats[T],skeleton:T}),Q.dateObj){var S=Q.dateObj.toLocaleTimeString();Q.dateObj=new Date("01/01/1900 "+S),Q.type="time",Q.isCustom=!1;break}}}return $!=="#DIV/0!"&&!Q.dateObj&&new Date($).toString()!=="Invalid Date"&&(Q.dateObj=new Date($)),Q}function a($){return $&&$!=="."&&/^\d*\.?\d*$/.test($)?parseFloat($):$}},70180:function(q,be,ae){"use strict";ae.d(be,{a:function(){return P}});function P(F,Y){return Y===void 0&&(Y=[]),Y.push({member:"workbookBasic",args:[]}),Y.push({member:"workbookAll",args:[]}),Y.push({member:"dataBind",args:[F]}),Y.push({member:"workbookProtectSheet",args:[F]}),F.allowSave&&Y.push({member:"workbookSave",args:[F]}),F.allowOpen&&Y.push({member:"workbookOpen",args:[F]}),F.allowEditing&&(Y.push({member:"workbookEdit",args:[F]}),Y.push({member:"workbookFormula",args:[F]})),F.allowNumberFormatting&&Y.push({member:"workbookNumberFormat",args:[F]}),F.allowCellFormatting&&Y.push({member:"workbookcellformat",args:[F]}),F.allowSorting&&Y.push({member:"workbookSort",args:[F]}),F.allowHyperlink&&Y.push({member:"workbookHyperlink",args:[F]}),F.allowFiltering&&Y.push({member:"workbookFilter",args:[F]}),F.allowFindAndReplace&&Y.push({member:"workbookfindAndReplace",args:[F]}),F.allowInsert&&Y.push({member:"workbookinsert",args:[F]}),F.allowDelete&&Y.push({member:"workbookdelete",args:[F]}),F.allowDataValidation&&Y.push({member:"workbookDataValidation",args:[F]}),F.allowMerge&&Y.push({member:"workbookmerge",args:[F]}),F.allowCellFormatting&&Y.push({member:"workbookConditionalFormatting",args:[F]}),F.allowImage&&Y.push({member:"workbookImage",args:[F]}),F.allowChart&&Y.push({member:"workbookChart",args:[F]}),F.allowAutoFill&&Y.push({member:"workbookautofill",args:[F]}),Y}},92715:function(q,be,ae){"use strict";ae.d(be,{s:function(){return P}});function P(Y,w,ye,U,Z){return new F(Y,w,ye,U,Z)}var F=function(){function Y(w,ye,U,Z,E){this.preventCallback=!1,this.context=w,this.workerTask=ye,this.defaultListener=U,this.workerData=Z,E&&(this.preventCallback=!0),this.initWorker()}return Y.prototype.terminate=function(){this.worker.terminate(),URL.revokeObjectURL(this.workerUrl)},Y.prototype.initWorker=function(){var w=new Blob([this.getFnCode()],{type:"text/javascript"});this.workerUrl=URL.createObjectURL(w),this.worker=new Worker(this.workerUrl),this.worker.onmessage=this.messageFromWorker.bind(this),this.worker.onerror=this.onError.bind(this),this.worker.postMessage(this.workerData)},Y.prototype.messageFromWorker=function(w){this.terminate(),this.defaultListener.apply(this.context,[w.data])},Y.prototype.onError=function(w){throw this.terminate(),w.message||w},Y.prototype.getFnCode=function(){var w="",ye,U,Z="",E=!1;if(typeof this.workerTask=="function")this.workerTask.toString().indexOf("function")<0?Z="function "+this.workerTask.toString():(Z=this.workerTask.toString(),E=!0),w+="self.workerTask = "+Z+`; 
`;else if(typeof this.workerTask=="object")for(U=Object.keys(this.workerTask),ye=0;ye<U.length;ye++)this.workerTask[U[ye]].toString().indexOf("function")<0?Z="function "+this.workerTask[U[ye]].toString():(Z=this.workerTask[U[ye]].toString(),E=!0),w+=(ye===0?"self.workerTask":U[ye])+"= "+Z+`; 
`;return w+="self.onmessage = "+(E?"":" function ")+(this.preventCallback?this.getMessageFn.toString():this.getCallbackMessageFn.toString())+`; 
`,w},Y.prototype.getCallbackMessageFn=function(w){postMessage(this.workerTask.apply(this,w.data))},Y.prototype.getMessageFn=function(w){this.workerTask.apply(this,w.data)},Y}()},77084:function(q,be,ae){"use strict";ae.d(be,{IEE:function(){return P.IE},ekG:function(){return P.ek},tNt:function(){return P.tN},$Su:function(){return P.$S},AXw:function(){return P.AX},wDo:function(){return P.wD},IQS:function(){return P.IQ},pGm:function(){return P.pG},YuF:function(){return P.Yu},dMx:function(){return P.dM},NEZ:function(){return P.NE},EB_:function(){return P.EB},dPh:function(){return P.dP},zfV:function(){return P.zf},Q8D:function(){return P.Q8},PmP:function(){return P.Pm},Rao:function(){return P.R},HAf:function(){return P.HA},ZRw:function(){return P.ZR},vnU:function(){return P.vn},wDH:function(){return P.y4},NqJ:function(){return P.Nq},gSQ:function(){return P.gS},j1e:function(){return P.j1},Jxt:function(){return P.Jx},XV5:function(){return P.XV},ZG6:function(){return P.ZG},vmj:function(){return P.vm},TmR:function(){return P.Tm},reQ:function(){return P.re},q6q:function(){return F.q6q},Zf5:function(){return F.Zf5},CC2:function(){return F.CC2},V_l:function(){return F.V_l},Ai5:function(){return F.Ai5},nJk:function(){return F.nJk},G$g:function(){return F.G$g},x2y:function(){return F.x2y},ya2:function(){return F.ya2},L:function(){return F.L},dKh:function(){return F.dKh},xMH:function(){return F.xMH},C2M:function(){return F.C2M},Azt:function(){return F.Azt},ZHw:function(){return F.ZHw},G2p:function(){return F.G2p},eaW:function(){return F.eaW},fdW:function(){return F.fdW},vB1:function(){return F.vB1},OJx:function(){return F.OJx},$sV:function(){return F.$sV},Tsy:function(){return F.Tsy},wzZ:function(){return F.wzZ},PeM:function(){return F.PeM},AVn:function(){return F.AVn},CP8:function(){return F.CP8},ZXJ:function(){return F.ZXJ},qkm:function(){return F.qkm},n53:function(){return F.n53},ugT:function(){return F.ugT},AH9:function(){return F.AH9},Oyx:function(){return F.Oyx},$uf:function(){return F.$uf},eM_:function(){return F.eM_},eYQ:function(){return F.eYQ},IRR:function(){return F.IRR},i0K:function(){return F.i0K},VBe:function(){return F.VBe},dK5:function(){return F.dK5},MJG:function(){return F.MJG},gaE:function(){return F.gaE},d8d:function(){return F.d8d},flO:function(){return F.flO},AH7:function(){return F.AH7},E9X:function(){return F.E9X},wtl:function(){return F.wtl},Z2v:function(){return F.Z2v},fqz:function(){return F.fqz},$Tr:function(){return F.$Tr},gQT:function(){return F.gQT},IQJ:function(){return F.IQJ},qhV:function(){return F.qhV},uan:function(){return F.uan},X1M:function(){return F.X1M},mhJ:function(){return F.mhJ},p1d:function(){return F.p1d},hj$:function(){return F.hj$},Axt:function(){return F.Axt},hYl:function(){return F.hYl},aQp:function(){return F.aQp},NGR:function(){return F.NGR},zcH:function(){return F.zcH},jJC:function(){return F.jJC},MpA:function(){return F.MpA},Ice:function(){return F.Ice},tVr:function(){return F.tVr},C4_:function(){return F.C4_},VYm:function(){return F.VYm},PpD:function(){return F.PpD},$qQ:function(){return F.$qQ},cRm:function(){return F.cRm},HoA:function(){return F.HoA},bUq:function(){return F.bUq},gxs:function(){return F.gxs},kon:function(){return F.kon},RDz:function(){return F.RDz},Pmi:function(){return F.Pmi},O$v:function(){return F.O$v},axz:function(){return F.axz},vbl:function(){return F.vbl},UyC:function(){return F.UyC},QLx:function(){return F.QLx},g7J:function(){return F.g7J},YYv:function(){return F.YYv},mtj:function(){return F.mtj},vCD:function(){return F.vCD},Sxm:function(){return F.Sxm},Vzf:function(){return F.Vzf},Aed:function(){return F.Aed},sQc:function(){return F.sQc},wWT:function(){return F.wWT},a8y:function(){return F.a8y},XRp:function(){return F.XRp},uRS:function(){return F.uRS},NK6:function(){return F.NK6},F5$:function(){return F.F5$},BbZ:function(){return F.BbZ},B7N:function(){return F.B7N},agw:function(){return F.agw},vdt:function(){return Y.vd},Yli:function(){return Y.Yl},VPM:function(){return Y.VP},Npz:function(){return Y.Np},rVv:function(){return Y.rV},w09:function(){return Y.w0},RDb:function(){return Y.RD},KzY:function(){return Y.Kz},K2R:function(){return Y.K2},y9o:function(){return w.y9},WCD:function(){return w.WC},DoV:function(){return w.Do},tqm:function(){return w.tq},zp5:function(){return w.zp},VBC:function(){return w.VB},nHy:function(){return w.nH}});var P=ae(91997),F=ae(93010),Y=ae(34819),w=ae(57387)},34819:function(q,be,ae){"use strict";ae.d(be,{vd:function(){return Z},s:function(){return M},Yl:function(){return O},VP:function(){return Ie},g:function(){return d},Np:function(){return ye.Np},rV:function(){return E},w0:function(){return re},RD:function(){return Q},Kz:function(){return ye.Kz},K2:function(){return ye.K2}});var P=ae(27976),F=ae(15002),Y=ae(91997),w=ae(93010),ye=ae(55152),U=ae(8923),Z=function(){function T(b){this.parent=b,this.requestedInfo=[],this.addEventListener()}return T.prototype.addEventListener=function(){this.parent.on(w.uRS,this.updateSheetFromDataSourceHandler,this),this.parent.on(w.vB1,this.dataSourceChangedHandler,this),this.parent.on(w.atk,this.dataChangedHandler,this),this.parent.on(w.sQc,this.triggerDataChangeHandler,this)},T.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(w.uRS,this.updateSheetFromDataSourceHandler),this.parent.off(w.vB1,this.dataSourceChangedHandler),this.parent.off(w.atk,this.dataChangedHandler),this.parent.off(w.sQc,this.triggerDataChangeHandler))},T.prototype.updateSheetFromDataSourceHandler=function(b){var k=this,S,m,x,v,y,A,I,N=[],z=[],V,_=new P.B,G,K,oe;if(b.promise=_.promise,b.sheet&&b.sheet.ranges.length)for(var he=function(Ce){var ze=b.indexes[0],We=b.indexes[2],Xe=b.sheet.ranges[Ce];G=(0,w.dK5)(Xe.startCell)[0],I=Xe.dataSource instanceof P.h?Xe.dataSource:Xe.dataSource?new P.h(Xe.dataSource):new P.h,y=y||I.dataSource.url,b.sheet.isLocalData=A||!I.dataSource.url,G<=ze?ze=ze-G:G<=We?(We=We-G,ze=0):ze=-1,Xe.showFieldAsHeader&&ze!==0&&(ze-=1);var tt=!1,pt=0;ue.initRangeInfo(Xe);var st=ue.getMaxCount(Xe);if(oe=ue.getLoadedInfo(ze,We,Xe),ze=oe.unloadedRange[0],We=oe.unloadedRange[1],Xe.info.insertRowRange&&(Xe.info.insertRowRange.forEach(function(rt){pt+=rt[1]-rt[0]+1}),ze-=pt,We-=pt),ze>=st?tt=!0:We>st&&(We=st),ue.requestedInfo.push({deferred:_,indexes:b.indexes,isNotLoaded:oe.isNotLoaded}),ze>=0&&oe.isNotLoaded&&!tt){z[Ce]=ze,N[Ce]=!1;var ht=(Xe.query?Xe.query:new F.A).clone();I.executeQuery(ht.range(ze,We>=st?We:We+1).requiresCount()).then(function(rt){if(!(!k.parent||k.parent.isDestroyed)){if(v=rt.result&&rt.result.result?rt.result.result:rt.result,x=(0,w.dK5)(Xe.startCell),G=x[0],K=x[1],v&&v.length){if(Xe.info.count||(st=rt.count,Xe.info.count=rt.count),m=Object.keys(v[0]),Xe.info.fldLen||(Xe.info.fldLen=m.length,Xe.info.flds=m),Xe.info.insertColumnRange){var Et=0;Xe.info.insertColumnRange.forEach(function(we){for(var ct=we[0];ct<=we[1];ct++)ct<=K?m.splice(0,0,"emptyCell"+Et):m.splice(ct-K,0,"emptyCell"+Et),Et++})}z[Ce]===0&&Xe.showFieldAsHeader&&(V=G+z[Ce]+pt,m.forEach(function(we,ct){S=(0,Y.$S)(V,K+ct,b.sheet,!0),S?we.includes("emptyCell")||(S.value=we):b.sheet.rows[G+z[Ce]].cells[K+ct]=we.includes("emptyCell")?{}:{value:we}}));var Vt=b.formulaCellRef?(0,Y.Pm)(k.parent,b.sheet.id):void 0;v.forEach(function(we,ct){V=G+z[Ce]+ct+(Xe.showFieldAsHeader?1:0)+pt;for(var Lt=0;Lt<m.length;Lt++)S=(0,Y.$S)(V,K+Lt,b.sheet,!0),S?m[Lt].includes("emptyCell")||(0,Y.Jx)(V,K+Lt,b.sheet,k.getCellDataFromProp(we[m[Lt]]),!0):b.sheet.rows[V].cells[K+Lt]=m[Lt].includes("emptyCell")?{}:k.getCellDataFromProp(we[m[Lt]])})}else m=[];var ce;G+(st||rt.count)>0?ce=G+(st||rt.count)+(Xe.showFieldAsHeader?1:0)+pt-1:ce=b.sheet.usedRange.rowIndex;var ee=K+m.length-1<0?b.sheet.usedRange.colIndex:K+m.length-1;if(b.isFinite?(b.sheet.usedRange.rowIndex=ce<b.sheet.rowCount?ce:b.sheet.rowCount-1,b.sheet.usedRange.colIndex=ee<b.sheet.colCount?ee:b.sheet.colCount-1):(b.sheet.usedRange.rowIndex=ce,b.sheet.usedRange.colIndex=ee),pt?(oe=k.getLoadedInfo(ze,We,Xe),ze=oe.unloadedRange[0],We=oe.unloadedRange[1],ze>st&&(oe.isNotLoaded=!1),oe.isNotLoaded&&(We>st&&(We=st),Xe.info.loadedRange.push([ze,We]))):Xe.info.loadedRange.push([ze,We]),N[Ce]=!0,N.indexOf(!1)===-1){var Ne=void 0;if(We+G<G+Xe.info.count){b.rangeSettingCount||(b.rangeSettingCount=[]),b.rangeSettingCount.push(Ce),Ne=!0;var Te={sheet:b.sheet,indexes:[0,0,ce,ee],promise:new Promise(function(we,ct){we(function(){}())}),rangeSettingCount:b.rangeSettingCount,isFinite:b.isFinite,resolveAfterFullDataLoaded:b.resolveAfterFullDataLoaded};k.updateSheetFromDataSourceHandler(Te),Te.promise.then(function(){k.parent.getModuleName()!=="workbook"&&(b.rangeSettingCount.pop(),b.rangeSettingCount.length||k.parent.notify("created",null),b.formulaCellRef&&k.notfyFormulaCellRefresh(b.formulaCellRef,b.sheetIndex))})}else b.formulaCellRef&&k.notfyFormulaCellRefresh(b.formulaCellRef,b.sheetIndex);Ne&&b.resolveAfterFullDataLoaded||(k.checkResolve(b.indexes),b.resolveAfterFullDataLoaded&&k.checkResolve([0,0,0,0]))}}})}else Ce===0&&N.indexOf(!1)===-1&&ue.checkResolve(b.indexes)},ue=this,X=b.sheet.ranges.length-1;X>=0;X--)he(X);else _.resolve()},T.prototype.notfyFormulaCellRefresh=function(b,k){this.parent.formulaRefCell=null,this.parent.notify("updateView",{indexes:(0,w.dK5)(b),sheetIndex:k,refreshing:!0})},T.prototype.checkResolve=function(b){var k,S,m=0;this.requestedInfo.forEach(function(x,v){S=JSON.stringify(x.indexes)===JSON.stringify(b),(S||k)&&(v===0?(x.deferred.resolve(),m++,k=!0):k&&(x.isLoaded||!x.isNotLoaded)||S&&k?(x.deferred.resolve(),m++):S?x.isLoaded=!0:k=!1)}),this.requestedInfo.splice(0,m)},T.prototype.getCellDataFromProp=function(b){var k={};return Object.prototype.toString.call(b)==="[object Object]"?b.formula?k.formula=b.formula:b.value&&(typeof b.value=="string"&&(b.value.indexOf("http://")===0||b.value.indexOf("https://")===0||b.value.indexOf("ftp://")===0||b.value.indexOf("www.")===0)?k.hyperlink=b.value:k.value=b.value):(0,w.C2M)(b)?k.formula=b:typeof b=="string"&&(b.indexOf("http://")===0||b.indexOf("https://")===0||b.indexOf("ftp://")===0||b.indexOf("www.")===0)?k.hyperlink=b:k.value=b,k},T.prototype.checkDataForFormat=function(b){if(b.value!==""){var k={value:b.value,rowIndex:b.rowIndex,colIndex:b.colIndex,isDate:!1,updatedVal:b.value,isTime:!1,sheetIndex:b.sheetIndex};this.parent.notify(w.w0y,k),k.isDate?b.cell?(b.cell.format||(b.cell.format=(0,ye.Kz)("ShortDate")),b.cell.value=k.updatedVal):(b.args.sheet.rows[b.rowIndex].cells[b.colIndex].format=(0,ye.Kz)("ShortDate"),b.args.sheet.rows[b.rowIndex].cells[b.colIndex].value=k.updatedVal):k.isTime&&(b.cell?(b.cell.format||(b.cell.format=(0,ye.Kz)("Time")),b.cell.value=k.updatedVal):(b.args.sheet.rows[b.rowIndex].cells[b.colIndex].format=(0,ye.Kz)("Time"),b.args.sheet.rows[b.rowIndex].cells[b.colIndex].value=k.updatedVal))}},T.prototype.getLoadedInfo=function(b,k,S){var m=!0;return S.info.loadedRange.forEach(function(x){x[0]<=b&&b<=x[1]?x[0]<=k&&k<=x[1]?m=!1:b=x[1]+1:x[0]<=k&&k<=x[1]&&(k=x[0]-1)}),{isNotLoaded:m,unloadedRange:[b,k]}},T.prototype.getMaxCount=function(b){if(b.query){for(var k=b.query.queries,S=0;S<k.length;S++)if(k[S].fn==="onTake")return Math.min(k[S].e.nos,b.info.count||k[S].e.nos)}return b.info.count},T.prototype.initRangeInfo=function(b){b.info||(b.info={loadedRange:[]})},T.prototype.dataSourceChangedHandler=function(b){var k=this,S,m=this.parent.sheets[b.sheetIdx],x=m.ranges[b.rangeIdx];if(x&&(this.checkRangeHasChanges(m,b.rangeIdx)||!x.info)){var v=x.showFieldAsHeader,y=(0,w.n53)(x.startCell);x.info&&(x.info.loadedRange.forEach(function(z){for(var V=z[0];V<=z[1]&&V<x.info.count+(v?1:0);V++)if(S=m.rows[V+y[0]],S)for(var _=y[1];_<y[1]+x.info.fldLen;_++)S.cells&&S.cells[_]&&delete S.cells[_]}),x.info=null);var A=this.parent.viewport,I=[A.topIndex,A.leftIndex,A.bottomIndex,A.rightIndex],N={sheet:m,indexes:I,dataSourceChange:!0,promise:new Promise(function(z,V){z(function(){}())})};this.updateSheetFromDataSourceHandler(N),N.promise.then(function(){k.parent.trigger("dataSourceChanged",{data:b.changedData,action:"dataSourceChanged",rangeIndex:Number(b.rangeIdx),sheetIndex:Number(b.sheetIdx)}),k.parent.notify("updateView",{indexes:I,checkWrap:!0,checkCf:!0})})}},T.prototype.checkRangeHasChanges=function(b,k){if(this.parent.isAngular){var S="changedRangeIdx";return b[S]===parseInt(k,10)?(delete b[S],!0):!1}else return!0},T.prototype.dataChangedHandler=function(b){var k=this,S=[{}],m,x,v,y,A,I,N,z=b.sheetIdx===void 0?this.parent.activeSheetIndex:b.sheetIdx,V=this.parent.sheets[z],_,G;V.ranges.forEach(function(K,oe){if(K.dataSource){var he=void 0;if(y=(0,w.n53)(K.startCell),v=y.concat([y[0]+K.info.count+(K.showFieldAsHeader?0:-1),y[1]+K.info.fldLen-1]),b.modelType==="Row"||b.modelType==="Column")if(b.modelType==="Column"){if(b.insertType)A=v[1]<b.index&&v[3]>=b.index,_=[b.index],A?(b.model.forEach(function(){K.info.flds.splice(b.index-y[1],0,"")}),K.info.fldLen+=b.model.length):v[3]+1===b.index&&b.insertType==="after"?(b.model.forEach(function(){K.info.flds.splice(b.index-y[1],0,"")}),K.info.fldLen+=b.model.length):v[1]>=b.index&&(K.startCell=(0,w.qkm)(y[0],y[1]+b.model.length));else if(A=v[1]<=b.startIndex&&v[3]>=b.startIndex,A)for(var ue=b.startIndex;ue<=b.endIndex;ue++)ue<=v[3]&&(K.info.flds.splice(b.startIndex,1),K.info.fldLen-=1);return}else if(b.insertType){if(A=(!K.showFieldAsHeader&&(b.insertType==="above"||b.isMethod)?v[0]<=b.index:v[0]<b.index)&&v[2]>=b.index,_=[b.index],A||v[2]+1===b.index&&b.insertType==="below"?(he=!0,K.info.count+=b.model.length):v[0]>=b.index&&(K.startCell=(0,w.qkm)(y[0]+b.model.length,y[1])),b.isMethod)return}else A=v[0]<=b.startIndex&&v[2]>=b.startIndex,b.isDataRequest?_=[b.startIndex,v[1],b.startIndex,v[1]]:m="delete";else{_=(0,w.dK5)(b.requestType&&b.requestType.toLowerCase().includes("paste")?b.pastedRange.split("!")[1]:b.sheetIdx>-1?b.address:(b.address||b.range||b.fillRange).split("!")[1]);var X=[K.showFieldAsHeader?v[0]+1:v[0]].concat(v.slice(1,4));if(K.showFieldAsHeader&&_[0]===y[0])for(var ue=_[1];ue<=_[3];ue++)ue>=X[1]&&ue<=X[3]&&(K.info.flds[ue-y[1]]=(0,Y.$S)(y[0],ue,V,!1,!0).value||"");if(A=(0,w.mhJ)(X,_,!0),b.requestType==="paste"&&b.copiedInfo.isCut){if(G=[].slice.call(b.copiedInfo.range),K.showFieldAsHeader&&G[0]===y[0]){for(var ue=G[1];ue<=G[3];ue++)ue>=X[1]&&ue<=X[3]&&(K.info.flds[ue-y[1]]="");A=!1}I=(0,w.mhJ)(X,G,!0)}}if(A||he||I){if(b.modelType==="Row"&&!b.insertType&&!b.isDataRequest){if(b.deletedModel.forEach(function(st,ht){S[ht]={},K.info.flds.forEach(function(rt,Et){st.cells?(x=st.cells[y[1]+Et],S[ht][rt]=k.getFormattedValue(x)):S[ht][rt]=null}),K.info.count-=1}),b.isMethod)return;N={count:b.deletedModel.length,index:b.endIndex}}else{m=he?"add":"edit";var Ce=0;if(I){Ce=G[2]-G[0]+1;for(var ze=function(st){S[st]={},K.info.flds.forEach(function(ht,rt){ht&&(x=(0,Y.$S)(G[0]+st,y[1]+rt,V),S[st][ht]=k.getFormattedValue(x))})},ue=0;ue<Ce;ue++)ze(ue)}if(A||he)for(var We=!b.isDataRequest&&!I&&!he&&!b.skipFilterCheck,Xe=function(st,ht){if(We&&(0,Y.y4)(V,_[0]+st))return tt=ht,"continue";S[ht+Ce]={},K.info.flds.forEach(function(rt,Et){rt&&(x=(0,Y.$S)(_[0]+st,y[1]+Et,V),S[ht+Ce][rt]=k.getFormattedValue(x))}),ht++,tt=ht},tt,ue=0,pt=0;ue<(he?b.model.length:_[2]-_[0]+1||1);ue++)Xe(ue,pt),pt=tt}b.isDataRequest?b.data=S:k.parent.trigger("dataSourceChanged",{data:S,action:m,rangeIndex:oe,sheetIndex:z})}else N&&N.count&&v[0]>N.index&&(K.startCell=(0,w.qkm)(y[0]-N.count,y[1]))}})},T.prototype.getFormattedValue=function(b){var k=this.parent.getDisplayText(b);return k===""?null:b&&!b.format&&typeof b.value=="number"?b.value:k},T.prototype.triggerDataChangeHandler=function(b){var k=["insert","delete","edit","cellDelete","cellSave","autofill","clipboard","clear"],S=!0;if(((b.action==="delete"||b.action==="insert")&&["Sheet"].indexOf(b.eventArgs.modelType)>-1||b.action==="clear"&&["Clear Formats","Clear Hyperlinks"].indexOf(b.eventArgs.type)>-1||b.action==="clipboard"&&b.eventArgs.requestType==="Formats")&&(S=!1),S&&k.indexOf(b.action)>-1){var m=void 0;b.isUndo&&(b.action==="delete"||b.action==="insert")?(m=(0,U.l7)({},b.eventArgs),b.action==="delete"?(m.index=m.startIndex,m.model=m.deletedModel,m.insertType="below"):(m.startIndex=m.index,m.endIndex=b.eventArgs.index+b.eventArgs.model.length-1,m.deletedModel=m.model,delete m.insertType)):m=b.eventArgs,this.parent.notify(w.atk,m)}},T.prototype.getModuleName=function(){return"dataBind"},T.prototype.destroy=function(){this.removeEventListener(),this.parent=null,this.requestedInfo=[]},T}(),E=function(){function T(b){this.parent=b,this.addEventListener()}return T.prototype.open=function(b){var k=this;if(!!this.parent.allowOpen){if(b.jsonObject){this.fetchSuccess(b.jsonObject,null,!0);return}var S=new FormData;if(b.file)S.append("file",b.file);else if(b.sheetIndex>=0)S.append("sheetPassword",b.sheetPassword),S.append("sheetIndex",b.sheetIndex.toString());else{this.parent.isOpen=!1;return}var m={passWord:""};b.password&&b.password.length&&(m.passWord=b.password),m.passWord&&m.passWord.length&&(b.password=m.passWord),b.password&&S.append("password",b.password);var x={file:b.file||null,cancel:!1,requestData:{method:"POST",body:S},password:m.passWord};if((0,U.le)(b.sheetPassword)&&(this.parent.trigger("beforeOpen",x),this.parent.notify(w.ya2,{eventArgs:x,action:"beforeOpen"})),x.cancel){this.parent.isOpen=!1;return}fetch(this.parent.openUrl,x.requestData).then(function(v){return v.ok?v.json():Promise.reject({status:v.status,statusText:v.statusText,url:v.url})}).then(function(v){return k.fetchSuccess(v,x)}).catch(function(v){return k.fetchFailure(v)})}},T.prototype.fetchFailure=function(b){(0,U.o8)(b.status)&&(0,U.o8)(b.statusText)&&(b.statusText="Improper response"),this.parent.notify(w.zcH,b),this.parent.isOpen=!1},T.prototype.fetchSuccess=function(b,k,S){var m=["UnsupportedFile","InvalidUrl","NeedPassword","InCorrectPassword","InCorrectSheetPassword","CorrectSheetPassword"],x=b;x=typeof b=="string"?JSON.parse(b):b;var v=x.Workbook;if(m.indexOf(v)>-1){this.parent.notify(w.jJC,{context:this,data:v,eventArgs:k,isOpenFromJson:S});return}this.updateModel(v,S),this.parent.notify(w.jJC,{context:this,data:v,isOpenFromJson:S}),this.parent.isOpen=!1,k&&k.password&&k.password.length>0&&(this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled"),this.parent.element.querySelector(".e-add-sheet-tab").classList.remove("e-disabled")),this.parent.password="")},T.prototype.updateModel=function(b,k){this.parent.notify(w.B7N,{action:"unRegisterSheet"}),this.setSelectAllRange(b.sheets,k),this.parent.sheetNameCount=1,this.parent.sheets=[],this.parent.notify(w.Iap,{}),b.activeSheetIndex=b.activeSheetIndex||0,this.parent.setProperties({sheets:b.sheets,activeSheetIndex:b.activeSheetIndex,definedNames:b.definedNames||[],filterCollection:b.filterCollection||[],sortCollection:b.sortCollection||[]},!0),(0,Y.Vl)(this.parent),this.parent.notify(w.GRU,null),this.parent.notify(w.B7N,{action:"registerSheet",isImport:!0}),this.parent.notify(w.B7N,{action:"initiateDefinedNames"}),this.parent.notify(w.hgb,null)},T.prototype.setSelectAllRange=function(b,k){var S=this,m,x;b.forEach(function(v){if(v.selectedRange){var y=(0,w.dK5)(v.selectedRange),A=((0,U.o8)(v.rowCount)?100:v.rowCount)-1,I=((0,U.o8)(v.colCount)?100:v.colCount)-1;y[2]===65535&&(y[2]=A),y[3]===255&&(y[3]=I),y[0]===65535&&(y[0]=A),y[1]===255&&(y[1]=I),v.selectedRange=(0,w.i0K)(y)}if(k&&S.parent.isAngular){for(var N=0;N<S.parent.sheets.length;N++)if(m=S.parent.sheets[N],v.name===m.name){v.ranges&&v.ranges.forEach(function(z,V){x=m.ranges[V],x&&x.template&&(z.template=x.template)});break}}})},T.prototype.addEventListener=function(){this.parent.on(w.yKE,this.open.bind(this))},T.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(w.yKE,this.open.bind(this))},T.prototype.destroy=function(){this.removeEventListener(),this.parent=null},T.prototype.getModuleName=function(){return"workbookOpen"},T}(),a=ae(92715),$=ae(80788),J=function(){function T(b){this.parent=b}return T.prototype.processSheet=function(b,k){var S=JSON.parse(b,function(m,x){if(!((Array.isArray(x)||typeof x=="string")&&!x.length))return x});return[k,S]},T.prototype.processSave=function(b,k,S,m){var x=new FormData,v,y=Object.keys(k);for(x.append("JSONData",JSON.stringify(b)),v=0;v<y.length;v++)x.append(y[v],k[y[v]]);for(y=Object.keys(S),v=0;v<y.length;v++)x.append(y[v],S[y[v]]);x.append("pdfLayoutSettings",JSON.stringify(m)),fetch(k.url,{method:"POST",body:x}).then(function(A){return A.ok?A.blob():Promise.reject({message:A.statusText})}).then(function(A){new Promise(function(I){var N=new FileReader;N.onload=function(){var z=N.result.toString();if(z.indexOf("data:text/plain;base64,")>-1||z.indexOf("data:text/html;base64,")>-1||z.indexOf("data:application/json;base64,")>-1){var V=void 0;if(z=z.replace("data:text/plain;base64,",""),z=z.replace("data:text/html;base64,",""),z.indexOf("data:application/json;base64,")>-1?(z=z.replace("data:application/json;base64,",""),V=atob(z).split(".")):V=atob(z).split(/(\r\n|\n|\r)/gm),V.length){var _=V[0].length>1&&V[0][0]==='"'?V[0].split('"')[1]+".":V[0];postMessage({dialog:_})}}else postMessage(A);I(N.result)},N.readAsDataURL(A)})}).catch(function(A){postMessage({error:A.message})})},T}(),se=function(){var T=function(b,k){return T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,m){S.__proto__=m}||function(S,m){for(var x in m)m.hasOwnProperty(x)&&(S[x]=m[x])},T(b,k)};return function(b,k){T(b,k);function S(){this.constructor=b}b.prototype=k===null?Object.create(k):(S.prototype=k.prototype,new S)}}(),re=function(T){se(b,T);function b(k){var S=T.call(this,k)||this;return S.isProcessCompleted=!1,S.saveJSON={},S.isFullPost=!1,S.needBlobData=!1,S.customParams=null,S.pdfLayoutSettings={fitSheetOnOnePage:!1},S.addEventListener(),S}return b.prototype.getModuleName=function(){return"workbookSave"},b.prototype.destroy=function(){this.removeEventListener(),this.parent=null},b.prototype.addEventListener=function(){this.parent.on($.bC,this.initiateSave,this)},b.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off($.bC,this.initiateSave)},b.prototype.initiateSave=function(k){var S=k.saveSettings;this.parent.notify($.eM,null),this.saveSettings={saveType:S.saveType,url:S.url,fileName:S.fileName||"Sample"},this.isFullPost=k.isFullPost,this.needBlobData=k.needBlobData,this.needBlobData&&(this.isFullPost=!1),this.customParams=k.customParams,this.pdfLayoutSettings=k.pdfLayoutSettings,this.updateBasicSettings(),this.processSheets()},b.prototype.updateBasicSettings=function(){var k=this.getStringifyObject(this.parent,["sheets","_isScalar","observers","closed","isStopped","hasError","__isAsync","beforeCellFormat","beforeCellRender","beforeDataBound","beforeOpen","beforeSave","beforeSelect","beforeSort","cellEdit","cellEditing","cellSave","beforeCellSave","contextMenuItemSelect","contextMenuBeforeClose","contextMenuBeforeOpen","created","dataBound","fileMenuItemSelect","fileMenuBeforeClose","fileMenuBeforeOpen","saveComplete","sortComplete","select","actionBegin","actionComplete","afterHyperlinkClick","afterHyperlinkCreate","beforeHyperlinkClick","beforeHyperlinkCreate","openComplete","openFailure","queryCellInfo","dialogBeforeOpen","dataSourceChanged","beforeConditionalFormat","beforeCellUpdate"]),S=JSON.parse(k),m=this.parent.sheets.length;m&&(S.sheets=[]),this.saveJSON=S},b.prototype.processSheets=function(){var k=["dataSource","startCell","query","showFieldAsHeader"];this.parent.isAngular&&k.push("template");for(var S=0,m=this.parent.sheets.length;S<m;S++)(0,a.s)(this,this.processSheet,this.updateSheet,[this.getStringifyObject(this.parent.sheets[S],k,S),S])},b.prototype.updateSheet=function(k){this.saveJSON.sheets[k[0]]=k[1],this.isProcessCompleted=this.getSheetLength(this.saveJSON.sheets)===this.parent.sheets.length,this.isProcessCompleted&&this.save(this.saveSettings)},b.prototype.getSheetLength=function(k){var S=0;return k.forEach(function(m){m&&S++}),S},b.prototype.save=function(k){var S={cancel:!1,jsonObject:this.saveJSON};this.parent.notify($.Vv,S),S.cancel||(this.isFullPost?this.initiateFullPostSave():(0,a.s)(this,{workerTask:this.processSave},this.updateSaveResult,[this.saveJSON,k,this.customParams,this.pdfLayoutSettings],!0)),this.saveJSON={}},b.prototype.updateSaveResult=function(k){var S={status:"Success",message:"",url:this.saveSettings.url,fileName:this.saveSettings.fileName,saveType:this.saveSettings.saveType,blobData:null};typeof k=="object"&&k.error?(S.status="Failure",S.message=k.error.toString()):typeof k=="object"&&k.dialog?this.parent.notify($.cE,{content:k.dialog}):this.needBlobData?S.blobData=k:this.ClientFileDownload(k),this.parent.trigger("saveComplete",S),this.parent.notify($.Dw,S)},b.prototype.ClientFileDownload=function(k){var S=this.parent.createElement("a",{attrs:{download:this.getFileNameWithExtension()}}),m=URL.createObjectURL(k);S.href=m,document.body.appendChild(S),S.click(),URL.revokeObjectURL(m),document.body.removeChild(S)},b.prototype.initiateFullPostSave=function(){var k=Object.keys(this.saveSettings),S,m=this.parent.createElement("form",{attrs:{method:"POST",action:this.saveSettings.url}}),x=this.parent.createElement("input",{attrs:{type:"hidden",name:"JSONData"}});for(x.value=JSON.stringify(this.saveJSON),m.appendChild(x),S=0;S<k.length;S++)x=this.parent.createElement("input",{attrs:{type:"hidden",name:k[S]}}),x.value=this.saveSettings[k[S]],m.appendChild(x);for(k=Object.keys(this.customParams),S=0;S<k.length;S++)x=this.parent.createElement("input",{attrs:{type:"hidden",name:k[S]}}),x.value=this.customParams[k[S]],m.appendChild(x);x=this.parent.createElement("input",{attrs:{type:"hidden",name:"pdfLayoutSettings"}}),x.value=JSON.stringify(this.pdfLayoutSettings),m.appendChild(x),document.body.appendChild(m),m.submit(),(0,U.og)(m),this.parent.notify($.Dw,{})},b.prototype.getStringifyObject=function(k,S,m){var x=this;return S===void 0&&(S=[]),JSON.stringify(k,function(v,y){if(!(S.indexOf(v)>-1)){if(y&&y.cells)for(var A=0,I=y.cells.length;A<I;A++){var N=y.cells[A],z=[Number(v),A];if(N){if(N.formula&&N.formula.indexOf("=UNIQUE(")>-1&&N.value){var V={range:[]};x.parent.notify($.Y,V);for(var _=V.range,G=x.parent.sheets,K=[],oe=0;oe<G.length;oe++)K.push(G[oe].name);for(var he=0;he<_.length;he++)for(var ue=x.parent.sheets[K.indexOf(_[he].split("!")[0])],X=(0,w.dK5)(_[he].split("!")[1]),Ce=X[0];Ce<=X[2];Ce++)for(var ze=X[1];ze<=X[3];ze++){var We=(0,Y.$S)(Ce,ze,ue);We&&We.value&&delete We.value}}!N.value&&N.formula&&N.formula.indexOf("=UNIQUE(")<0&&(x.parent.notify(w.B7N,{action:"refreshCalculate",value:N.formula,rowIndex:z[0],colIndex:A,isFormula:(0,w.C2M)(N.formula),sheetIndex:m,isRefreshing:!0}),N.value=(0,Y.$S)(z[0],A,k).value)}}return y&&typeof y=="object"&&y.hasOwnProperty("properties")?y.properties:y!==null?y:void 0}})},b.prototype.getFileNameWithExtension=function(k){k||(k=this.saveSettings.fileName);var S=this.getFileExtension(),m=k.lastIndexOf(".");return m>-1&&(k=k.substr(0,m)),k+S},b.prototype.getFileExtension=function(){return"."+this.saveSettings.saveType.toLowerCase()},b}(J),Ae=ae(57474),Ie=function(){function T(b){this.uniqueOBracket=String.fromCharCode(129),this.uniqueCBracket=String.fromCharCode(130),this.uniqueCSeparator=String.fromCharCode(131),this.uniqueCOperator=String.fromCharCode(132),this.uniquePOperator=String.fromCharCode(133),this.uniqueSOperator=String.fromCharCode(134),this.uniqueMOperator=String.fromCharCode(135),this.uniqueDOperator=String.fromCharCode(136),this.uniqueModOperator=String.fromCharCode(137),this.uniqueConcateOperator=String.fromCharCode(138),this.uniqueEqualOperator=String.fromCharCode(139),this.uniqueExpOperator=String.fromCharCode(140),this.uniqueGTOperator=String.fromCharCode(141),this.uniqueLTOperator=String.fromCharCode(142),this.sheetInfo=[],this.parent=b,this.init()}return T.prototype.init=function(){this.addEventListener(),this.initCalculate(),this.registerSheet()},T.prototype.destroy=function(){this.removeEventListener(),this.calculateInstance.dispose(),this.calculateInstance=null,this.parent=null},T.prototype.addEventListener=function(){this.parent.on(w.B7N,this.performFormulaOperation,this),this.parent.on(w.Ai5,this.aggregateComputation,this),this.parent.on(w.uAQ,this.getUniqueRange,this),this.parent.on(w.wUt,this.removeUniquecol,this),this.parent.on(w.fdW,this.clearFormulaDependentCells,this),this.parent.on(w.AVn,this.formulaInValidation,this),this.parent.on(w.HoA,this.refreshInsertDelete,this),this.parent.on(w.aU5,this.getUpdatedFormulaOnInsertDelete,this)},T.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(w.B7N,this.performFormulaOperation),this.parent.off(w.Ai5,this.aggregateComputation),this.parent.off(w.uAQ,this.getUniqueRange),this.parent.off(w.wUt,this.removeUniquecol),this.parent.off(w.fdW,this.clearFormulaDependentCells),this.parent.off(w.AVn,this.formulaInValidation),this.parent.off(w.HoA,this.refreshInsertDelete),this.parent.off(w.aU5,this.getUpdatedFormulaOnInsertDelete))},T.prototype.getModuleName=function(){return"workbookFormula"},T.prototype.initCalculate=function(){this.calculateInstance=new Ae.Pz(this.parent),this.calcID=this.calculateInstance.createSheetFamilyID(),this.calculateInstance.setTreatEmptyStringAsZero(!0),this.calculateInstance.grid=this.parent.getActiveSheet().id.toString()},T.prototype.clearFormulaDependentCells=function(b){if(b.isOpen){this.calculateInstance.getDependentCells().clear(),this.calculateInstance.getFormulaInfoTable().clear();return}var k=b.cellRef;k=k.split(":")[0],k="!"+this.parent.activeSheetIndex+"!"+k,this.calculateInstance.clearFormulaDependentCells(k)},T.prototype.formulaInValidation=function(b){var k=this.calculateInstance.getLibraryFormulas().get(b.value);b.skip=(0,U.le)(k)},T.prototype.performFormulaOperation=function(b){var k=b.action,S=this.calculateInstance.getLibraryFormulas(),m=Array.from(S.values()),x;switch(k){case"getLibraryFormulas":b.formulaCollection=Array.from(S.keys());break;case"getFormulaCategory":x=["All"];for(var v=1;v<Array.from(S.values()).length;v++)x.indexOf(m[v].category)<0&&x.push(m[v].category);b.categoryCollection=x;break;case"dropDownSelectFormulas":for(var v=0;v<Array.from(S.values()).length;v++)b.selectCategory===m[v].category&&(b.formulaCollection[v]=Array.from(S.keys())[v]);break;case"getFormulaDescription":for(var v=0;v<Array.from(S.values()).length;v++)b.selectedList===Array.from(S.keys())[v]&&(b.description=m[v].description);break;case"registerSheet":this.registerSheet(b.sheetIndex,b.sheetCount),b.isImport&&this.updateSheetInfo();break;case"unRegisterSheet":this.unRegisterSheet(b.sheetIndex,b.sheetCount,b.propertyChange);break;case"initSheetInfo":this.updateSheetInfo();break;case"refreshCalculate":b.isFormula&&(b.value=this.autoCorrectFormula(b.value,b.rowIndex,b.colIndex,b.sheetIndex),b.isClipboard&&b.value.toString().toUpperCase().includes("UNIQUE")&&(this.parent.sheets[b.sheetIndex].rows[b.rowIndex].cells[b.colIndex].value="")),this.refreshCalculate(b.rowIndex,b.colIndex,b.value,b.isFormula,b.sheetIndex,b.isRefreshing),b.value=b.value?b.value.toString().split("-*").join("-").split("/*").join("/").split("*/").join("*").split("-/").join("-").split("*+").join("*").split("+*").join("+"):b.value;break;case"getArgumentSeparator":b.argumentSeparator=this.calculateInstance.getParseArgumentSeparator();break;case"addDefinedName":b.isAdded=this.addDefinedName(b.definedName,!1,b.index,b.isEventTrigger);break;case"removeDefinedName":b.isRemoved=this.removeDefinedName(b.definedName,b.scope,b.isEventTrigger);break;case"initiateDefinedNames":this.initiateDefinedNames();break;case"renameUpdation":this.renameUpdation(b.value,b.pName);break;case"addSheet":this.sheetInfo.push({visibleName:b.visibleName,sheet:b.sheetName,index:b.sheetId});break;case"getSheetInfo":b.sheetInfo=this.sheetInfo;break;case"deleteSheetTab":for(var v=0;v<this.sheetInfo.length;v++)if(this.sheetInfo[v].index===b.sheetId){var y=this.sheetInfo[v].sheet;this.sheetInfo.splice(v,1);var A=b.sheetId.toString();this.sheetDeletion(y,A),this.calculateInstance.unregisterGridAsSheet(A,A);break}break;case"getReferenceError":b.refError=this.referenceError();break;case"getAlpha":b.col=(0,Ae.Rj)(b.col);break;case"addCustomFunction":this.addCustomFunction(b.functionHandler,b.functionName);break;case"computeExpression":b.calcValue=this.calculateInstance.computeExpression(b.formula);break;case"registerGridInCalc":this.calculateInstance.grid=b.sheetID;break;case"checkFormulaAdded":var I=this.calculateInstance.getSheetFamilyItem(b.sheetId);I.isSheetMember&&!(0,U.le)(I.parentObjectToToken)&&(b.address=I.parentObjectToToken.get(b.sheetId)+b.address),b.added=this.calculateInstance.getFormulaInfoTable().has(b.address);break}},T.prototype.referenceError=function(){return this.calculateInstance.getErrorStrings()[Ae.Gl.ref]},T.prototype.getSheetInfo=function(){return this.sheetInfo},T.prototype.addCustomFunction=function(b,k){this.calculateInstance.defineFunction(k,b)},T.prototype.updateSheetInfo=function(){var b=this;this.sheetInfo=[],this.parent.sheets.forEach(function(k){b.sheetInfo.push({visibleName:k.name,sheet:"Sheet"+k.id,index:k.id})})},T.prototype.sheetDeletion=function(b,k){var S=this,m=this.calculateInstance.getDependentCells(),x,v,y,A,I,N=this.calculateInstance.getSheetFamilyItem(k);m.forEach(function(z,V){z.forEach(function(_){x=S.calculateInstance.getFormulaInfoTable().get(_),(0,U.le)(x)||(v=x.formulaText,v.toUpperCase().indexOf(b.toUpperCase())>-1&&(v=v.toUpperCase().split(b.toUpperCase()+S.calculateInstance.sheetToken).join(S.referenceError()),y=S.calculateInstance.rowIndex(_),A=S.calculateInstance.colIndex(_),I=_.slice(0,_.lastIndexOf(S.calculateInstance.sheetToken)+1),S.updateDataContainer([y-1,A-1],{value:v,visible:!1,sheetId:N.tokenToParentObject.has(I)?Number(N.tokenToParentObject.get(I)):parseInt(_.split("!")[1],10)+1}),S.calculateInstance.refresh(x.getParsedFormula()))),I=V.slice(0,V.lastIndexOf(S.calculateInstance.sheetToken)+1),k===(N.tokenToParentObject.has(I)?N.tokenToParentObject.get(I):V.split("!")[1])&&(S.calculateInstance.getFormulaInfoTable().delete(V),S.calculateInstance.clearFormulaDependentCells(V))})})},T.prototype.renameUpdation=function(b,k){var S=this,m,x,v=k.toUpperCase(),y=new RegExp(`[!@#$%^&()+=';,.{}|\\":<>~_-]`,"g"),A=`(?=['!])(?=[^"]*(?:"[^"]*"[^"]*)*$)`,I=new RegExp(k.replace(y,"\\$&")+A,"gi");this.sheetInfo.forEach(function(N,z){m=S.parent.sheets[z];for(var V=0,_=m.usedRange.rowIndex;V<=_;V++)for(var G=0,K=m.usedRange.colIndex;G<=K;G++)x=(0,Y.$S)(V,G,m,!1,!0),x.formula&&(0,w.C2M)(x.formula)&&x.formula.toUpperCase().includes(v)&&x.formula.match(I)&&(x.formula=x.formula.replace(I,b));N.visibleName===k&&(N.visibleName=b)})},T.prototype.updateDataContainer=function(b,k){for(var S,m,x,v=0,y=this.parent.sheets.length;v<y;v++)if(this.parent.sheets[v].id===k.sheetId){S=this.parent.sheets[v],b[0]in S.rows?(m=S.rows[b[0]],b[1]in m.cells?(x=m.cells[b[1]],x.formula=k.value,k.visible?v===this.parent.activeSheetIndex&&S.activeCell===(0,w.qkm)(b[0],b[1])&&this.parent.notify(w.Pmi,{}):x.value=this.referenceError()):m.cells[b[1]]=x={}):(m=S.rows[b[0]]={},m[b[1]]=x={});break}},T.prototype.parseSheetRef=function(b){var k,S=new RegExp(`[!@#$%^&()+=';,.{}|":<>~_-]`,"g"),m=0,x=this.parent.sheets.length,v=[];v.length=0;var y,A,I,N,z,V=this.getSheetInfo(),_=`(?=['!])(?=[^"]*(?:"[^"]*"[^"]*)*$)`;for(m=0;m<x;m++)if(V[m].sheet!==V[m].visibleName&&(k=new RegExp(V[m].visibleName.replace(S,"\\$&")+_,"gi"),I=m,b.match(k))){for(var G=m+1;G<x;G++)y=new RegExp(V[G].visibleName.replace(S,"\\$&")+_,"gi"),A=b.search(y),N=b.search(k),A>-1&&(A<N||A===N&&V[G].visibleName.length>V[m].visibleName.length)&&(z=new RegExp("Sheet","gi"),V[G].visibleName.search(z)!==0&&(k=y,I=G));b=b.replace(k,I+"/"),v.push(I)}for(m=0;m<v.length;)k=new RegExp(v[m]+"/"+_,"gi"),b=b.replace(k,V[v[m]].sheet),m++;return b},T.prototype.registerSheet=function(b,k){b===void 0&&(b=0),k===void 0&&(k=this.parent.sheets.length);for(var S;b<k;)S=(0,Y.zf)(this.parent,b).id+"",this.calculateInstance.registerGridAsSheet(S,S,this.calcID),b++},T.prototype.unRegisterSheet=function(b,k,S){b===void 0&&(b=0),k===void 0&&(k=this.parent.sheets.length);var m;if(this.calculateInstance.tokenCount=0,S)this.calculateInstance.unregisterGridAsSheet(m,m,S);else for(;b<k;)m=(0,Y.zf)(this.parent,b).id+"",this.calculateInstance.unregisterGridAsSheet(m,m),b++},T.prototype.getUniqueRange=function(b){b.range=this.calculateInstance.uniqueRange},T.prototype.removeUniquecol=function(){for(var b=this.parent.getActiveSheet(),k=0;k<this.calculateInstance.uniqueRange.length;k++){var S=this.calculateInstance.uniqueRange[k].split(":")[0].split("!");if(S[0]===b.name&&S[1]===b.activeCell){var m=(0,w.dK5)(this.calculateInstance.uniqueRange[k]);this.calculateInstance.uniqueRange.splice(k,1);for(var x=m[0];x<=m[2];x++)for(var v=m[1];v<=m[3];v++){var y=(0,Y.$S)(x,v,this.parent.getActiveSheet());y.formula="",this.parent.updateCell({value:"",formula:""},(0,w.i0K)([x,v]))}}}},T.prototype.refreshCalculate=function(b,k,S,m,x,v){var y=(0,U.le)(x)?this.parent.getActiveSheet():(0,Y.zf)(this.parent,x),A=y.id+"",I=y.name;if(m){S=this.parseSheetRef(S);var N=new Ae.Lh(b+1,k+1,S),z=[y.usedRange.rowIndex,y.usedRange.colIndex];this.calculateInstance.valueChanged(A,N,!0,z,v,I);var V=this.calculateInstance.randCollection;if(this.calculateInstance.isRandomVal===!0){var _=void 0,G=void 0,K="";if(this.calculateInstance.randomValues.size>1&&this.calculateInstance.randomValues.size===V.length)for(var oe=0;oe<this.calculateInstance.randomValues.size;oe++){_=this.calculateInstance.rowIndex(V[oe]),G=this.calculateInstance.colIndex(V[oe]),K=this.calculateInstance.randomValues.get(V[oe]),A=(parseFloat(this.calculateInstance.getSheetToken(V[oe]).split(this.calculateInstance.sheetToken).join(""))+1).toString();var he=new Ae.Lh(_,G,K);this.calculateInstance.valueChanged(A,he,!0)}}}else{var ue=this.calculateInstance.getSheetFamilyItem(A),X=(0,w.AH9)(k+1)+(b+1);ue.isSheetMember&&!(0,U.le)(ue.parentObjectToToken)&&(X=ue.parentObjectToToken.get(A)+X),this.calculateInstance.getFormulaInfoTable().has(X)&&(this.calculateInstance.getFormulaInfoTable().delete(X),this.calculateInstance.clearFormulaDependentCells(X)),this.calculateInstance.getComputedValue().clear(),this.calculateInstance.refresh(X),this.calculateInstance.refreshRandValues(X)}this.calculateInstance.cell="";var Ce=(0,Y.$S)(b,k,this.parent.getActiveSheet());if(S&&S.toString().toUpperCase().startsWith("=DOLLAR(")&&Ce&&Ce.value&&Ce.value.startsWith("$")&&this.dollarFormulaDecimalHandler(Ce),Ce&&S&&S.toString().toUpperCase().indexOf("=SUM(")===0){var ze=["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!","invalid arguments"],We=S.toString().toUpperCase().replace("=SUM","").replace("(","").replace(")","").split(":")[0];if((0,w.qhV)(We)){var Xe=(0,w.dK5)(We),tt=(0,Y.$S)(Xe[0],Xe[1],this.parent.getActiveSheet());tt&&tt.value&&tt.format&&ze.indexOf(Ce.value)<0&&ze.indexOf(tt.value)<0&&(Ce.format=tt.format)}}},T.prototype.dollarFormulaDecimalHandler=function(b){for(var k=b.value.split(".")[1].length,S="",m=1;m<=k;m++)S+="0";b.format="$#,##."+S},T.prototype.autoCorrectFormula=function(b,k,S,m){if(!(0,U.le)(b)){b=b.toString(),b.split("(").length===2&&b.indexOf(")")<0&&(b+=")");var x=void 0;b.indexOf("=")===0&&(b=b.slice(1),x=!0);var v=b.match(/</g),y=b.match(/>/g),A=b.match(/=/g);if(v){for(var I="",N=0;N<v.length;N++)I=I+v[N];b=b.replace(I,"<")}if(y){for(var z="",V=0;V<y.length;V++)z=z+y[V];b=b.replace(z,">")}if(A){for(var _="",G=0;G<A.length;G++)_=_+A[G];b=b.split(_).join("=")}b=x?"="+b:b,(v||y||A)&&((0,Y.$S)(k,S,(0,U.le)(m)?this.parent.getActiveSheet():(0,Y.zf)(this.parent,m)).formula=b)}return b},T.prototype.initiateDefinedNames=function(){for(var b=this.parent.definedNames,k=0;k<b.length;){var S=b[k],m=this.parseSheetRef(S.refersTo),x=(0,w.VBe)(m),v=!1,y=m.indexOf("http:")>-1?!0:m.indexOf("https:")>-1;if(x=x.split("$").join(""),x=x.split("=").join(""),x.indexOf(":")>-1){var A=x.split(":");(0,w.qhV)(A[0])&&(0,w.qhV)(A[1])&&(v=!0)}else x.indexOf(":")<0&&(0,w.qhV)(x)&&(v=!0);y&&(v=!1),v?this.addDefinedName(S,!0,void 0,!0):(this.removeDefinedName(S.name,S.scope,!0),k--),k++}},T.prototype.addDefinedName=function(b,k,S,m){(S===void 0||S<-1)&&(S=this.parent.definedNames.length);var x=!0,v,y=b.name;if(b.refersTo.indexOf("!")<0){var A=(0,Y.R)(this.parent);A=A.indexOf(" ")!==-1?"'"+A+"'":A,b.refersTo=A+"!"+(b.refersTo.indexOf("=")<0?b.refersTo:b.refersTo.split("=")[1])}var I=b.refersTo,N=this.parseSheetRef(b.refersTo);b.scope?(v=(0,Y.Q8)(this.parent,b.scope),v>-1&&(y=(0,Y.R)(this.parent,v)+"!"+y)):b.scope="",b.comment||(b.comment=""),!k&&this.checkIsNameExist(b.name,b.scope)?x=!1:(this.calculateInstance.addNamedRange(y,N[0]==="="?N.substr(1):N),N[0]!=="="&&(b.refersTo="="+I),this.parent.definedNames.indexOf(b)<0&&this.parent.definedNames.splice(S,0,b));var z={name:b.name,scope:b.scope,comment:b.comment,refersTo:b.refersTo,cancel:!1};return m||this.parent.notify("actionComplete",{eventArgs:z,action:"addDefinedName"}),x},T.prototype.removeDefinedName=function(b,k,S){var m=!1,x=this.getIndexFromNameColl(b,k);if(x>-1){var v=b;if(k){var y=(0,Y.Q8)(this.parent,k);y&&(v=(0,Y.R)(this.parent,y)+"!"+b)}if(this.calculateInstance.removeNamedRange(v),this.parent.definedNames.splice(x,1),!S){var A={name:b,scope:k,cancel:!1};this.parent.notify("actionComplete",{eventArgs:A,action:"removeDefinedName"})}m=!0}return m},T.prototype.checkIsNameExist=function(b,k){var S=this.parent.definedNames.some(function(m){return m.name===b&&(k?m.scope===k:m.scope==="")});return S},T.prototype.getIndexFromNameColl=function(b,k){k===void 0&&(k="");var S=-1;return this.parent.definedNames.filter(function(m,x){m.name===b&&m.scope===k&&(S=x)}),S},T.prototype.toFixed=function(b){var k=Number(b);return Math.round(k)!==k&&(b=k.toFixed(2)),b},T.prototype.aggregateComputation=function(b){var k=this.parent.getActiveSheet(),S=(0,Y._6)(k),m=(0,w.dK5)(S.split(":")[1]);m[0]+1===k.rowCount&&m[1]+1===k.colCount&&(S="A1:"+(0,w.qkm)(k.usedRange.rowIndex,k.usedRange.colIndex));var x,v,y=this.calculateInstance.getCellCollection(S);for(v=0;v<y.length;v++)if(x=this.calculateInstance.getValueFromArg(y[v]),(0,w.hj$)(x)){b.countOnly=!1;break}if(b.Count=this.calculateInstance.getFunction("COUNTA")(S),!(!b.Count||b.countOnly)){var A=["SUM","AVERAGE","MIN","MAX"],I=[],N=(0,w.dK5)(k.activeCell),z=(0,Y.$S)(N[0],N[1],k,!1,!0);for(v=0;v<4;v++){if(x=this.toFixed(this.calculateInstance.getFunction(A[v])(S)),z.format){var V={formattedText:x,value:x,format:z.format,cell:{value:x,format:z.format},onLoad:!0};this.parent.notify(w.eYQ,V),x=V.formattedText}I.push(x)}b.Sum=I[0],b.Avg=I[1],b.Min=I[2],b.Max=I[3]}},T.prototype.refreshInsertDelete=function(b){var k=this,S=this.calculateInstance.getDependentFormulaCells(),m,x=(0,Y.Pm)(this.parent,b.sheet.id);this.parent.sheets.forEach(function(v,y){for(var A=0,I=v.usedRange.rowIndex;A<=I;A++)for(var N=0,z=v.usedRange.colIndex;N<=z;N++)m=(0,Y.$S)(A,N,v,!1,!0),m.formula&&(0,w.C2M)(m.formula)&&(y===x?(b.isInsert||!(b.modelType==="Row"?A>=b.startIndex&&A<=b.endIndex:N>=b.startIndex&&N<=b.endIndex))&&k.updateFormula(b,m,A,N):m.formula.includes(b.sheet.name)&&k.updateFormula(b,m,A,N,!0))}),S.clear(),this.calculateInstance.getDependentCells().clear(),this.calculateInstance.getFormulaInfoTable().clear(),this.refreshNamedRange(b)},T.prototype.getUpdatedFormulaOnInsertDelete=function(b){this.updateFormula(b.insertDeleteArgs,b.cell,b.row,b.col)},T.prototype.updateFormula=function(b,k,S,m,x){var v,y,A,I;k.formula&&k.formula.includes("UNIQUE")&&this.clearUniqueRange(S,m,b.sheet);for(var N=function(){return A[0]===A[2]&&A[1]===A[3]?(0,w.qkm)(A[0],A[1]):(0,w.i0K)(A)},z=this.parseFormula(k.formula,!0),V=0;V<z.length;V++)if(v=z[V].trim().replace(/[$]/g,""),this.calculateInstance.isCellReference(v)){if(y=V&&z[V-1].trim(),y&&y[y.length-1]==="!"){if(y=y.replace(/['!]/g,""),y!==b.sheet.name)continue}else if(x)continue;A=(0,w.dK5)(v),I=this.parent.updateRangeOnInsertDelete(b,A),I&&(z[V]=A[2]<A[0]||A[3]<A[1]?this.calculateInstance.getErrorStrings()[Ae.Gl.ref]:N())}var _="="+z.join("");k.formula!==_&&(k.formula=_,k.value=null)},T.prototype.clearUniqueRange=function(b,k,S){var m={cellIdx:[b,k,b,k],isUnique:!1,uniqueRange:""};this.parent.notify(w.Azt,m);for(var x=(0,w.dK5)(m.uniqueRange),v=x[0];v<=x[2];v++)for(var y=x[1];y<=x[3];y++)delete(0,Y.$S)(v,y,S,!1,!0).value},T.prototype.parseFormula=function(b,k){var S,m,x=0,v=[],y=[];y=this.markSpecialChar(b.replace("=",""),k),y=k?y.split(/\(|\)|=|\^|>|<|,|\+|-|\*|\/|%|&/g):y.split(/\(|\)|=|\^|>|<|,|:|\+|-|\*|\/|%|&/g);for(var A=y.length;x<A;){if(S=y[x],!S){x++;continue}S.length===1?v.push(this.isUniqueChar(S)?this.getUniqueCharVal(S):S):(m=S[0],S.indexOf("!")>0?(this.isUniqueChar(m)&&(v.push(this.getUniqueCharVal(m)),S=S.substr(1)),m=S.indexOf("!")+1,v.push(S.substr(0,m)),v.push(S.substr(m))):this.isUniqueChar(m)?(v.push(this.getUniqueCharVal(m)),v.push(S.substr(1))):v.push(S)),x++}return v},T.prototype.getUniqueCharVal=function(b){switch(b){case this.uniqueOBracket:return"(";case this.uniqueCBracket:return")";case this.uniqueCSeparator:return",";case this.uniqueCOperator:return":";case this.uniquePOperator:return"+";case this.uniqueSOperator:return"-";case this.uniqueMOperator:return"*";case this.uniqueDOperator:return"/";case this.uniqueModOperator:return"%";case this.uniqueConcateOperator:return"&";case this.uniqueEqualOperator:return"=";case this.uniqueExpOperator:return"^";case this.uniqueGTOperator:return">";case this.uniqueLTOperator:return"<"}return""},T.prototype.isUniqueChar=function(b){var k=b.charCodeAt(b);return k>=129&&k<=142},T.prototype.markSpecialChar=function(b,k){return b=b.replace(/\(/g,"("+this.uniqueOBracket).replace(/\)/g,")"+this.uniqueCBracket),k?b=b.replace(/,/g,","+this.uniqueCSeparator):b=b.replace(/,/g,","+this.uniqueCSeparator).replace(/:/g,":"+this.uniqueCOperator),b=b.replace(/\+/g,"+"+this.uniquePOperator).replace(/-/g,"-"+this.uniqueSOperator),b=b.replace(/\*/g,"*"+this.uniqueMOperator).replace(/\//g,"/"+this.uniqueDOperator),b=b.replace(/&/g,"&"+this.uniqueConcateOperator),b=b.replace(/=/g,"="+this.uniqueEqualOperator),b=b.replace(/\^/g,"^"+this.uniqueExpOperator),b=b.replace(/>/g,">"+this.uniqueGTOperator).replace(/</g,"<"+this.uniqueLTOperator),b.replace(/%/g,"%"+this.uniqueModOperator)},T.prototype.refreshNamedRange=function(b){var k=this;if(b.definedNames&&b.definedNames.length){b.definedNames.forEach(function(z){k.parent.removeDefinedName(z.name,z.scope),k.parent.addDefinedName(z)});return}var S=this.parent.definedNames.length;if(!!S)for(var m=Object.assign({},this.parent.definedNames),x,v,y,A,I,N=0;N<S;N++)A=m[N],y=A.refersTo.split("!"),v=y[0].split("=")[1],v===b.sheet.name&&(x=(0,w.dK5)(y[1]),I=this.parent.updateRangeOnInsertDelete(b,x),b.isInsert?this.updateDefinedNames(A,v,x,I):b.modelType==="Row"?this.updateDefinedNames(A,v,x,I,[x[0],x[2]],b):b.modelType==="Column"&&this.updateDefinedNames(A,v,x,I,[x[1],x[3]],b))},T.prototype.updateDefinedNames=function(b,k,S,m,x,v){if(!!m){var y=this.parent.definedNames.indexOf(b),A={action:"removeDefinedName",isRemoved:!1,definedName:b.name,scope:b.scope,isEventTrigger:!0};if(this.parent.notify(w.B7N,A),x){var I={name:b.name,comment:b.comment,refersTo:b.refersTo,scope:b.scope};if(I=new w.rRQ(this.parent,"definedNames",I,!0),v.definedNames?v.definedNames.push(I):v.definedNames=[I],x[1]<x[0])return}b.refersTo=k+"!"+(0,w.i0K)(S),this.parent.notify(w.B7N,{action:"addDefinedName",definedName:b,isAdded:!1,index:y,isEventTrigger:!0});var N={name:b.name,scope:b.scope,comment:b.comment,refersTo:b.refersTo,cancel:!1};this.parent.notify("actionComplete",{eventArgs:N,action:"refreshNamedRange"})}},T}(),Se=ae(30620),Q=function(){function T(b){this.parent=b,this.addEventListener()}return T.prototype.destroy=function(){this.removeEventListener(),this.parent=null},T.prototype.addEventListener=function(){this.parent.on($.fq,this.initiateSortHandler,this)},T.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off($.fq,this.initiateSortHandler)},T.prototype.initiateSortHandler=function(b){var k=this,S=b.args,m=new P.B,x=this.parent.getAddressInfo(S.range),v=(0,Y.zf)(this.parent,x.sheetIndex),y=(0,w.gaE)(x.indices),A=S.sortOptions||{sortDescriptors:{},containsHeader:!0},I=!1;if(b.promise=m.promise,y[0]>v.usedRange.rowIndex||y[1]>v.usedRange.colIndex){m.reject(this.parent.serviceLocator.getService(w.L1M).getConstant("SortOutOfRangeError"));return}var N=A.containsHeader,z=S.checkForHeader;if((y[0]===y[2]||z)&&(z||(y=(0,w.Oyx)(y[0],y[1],v)),I=!0,(0,U.le)(A.containsHeader)&&(typeof(0,Y.$S)(y[0],y[1],v,null,!0).value==typeof(0,Y.$S)(y[0]+1,y[1],v,null,!0).value?N=!this.isSameStyle((0,Y.$S)(y[0],y[1],v,null,!0).style,(0,Y.$S)(y[0]+1,y[1],v,null,!0).style):N=!0)),((0,U.le)(S.sortOptions)||(0,U.le)(S.sortOptions.containsHeader))&&!I){var V=(0,Y.$S)(y[0],y[1],v),_=(0,Y.$S)(y[0]+1,y[1],v);V&&_&&(typeof V.value==typeof _.value?N=!this.isSameStyle(V.style,_.style):N=!0)}var G=y[0]=N?y[0]+1:y[0],K,oe,he=(0,w.n53)(v.activeCell),ue=(0,w.AH9)(he[1]+1);delete A.containsHeader;var X=A.sortDescriptors,Ce=(0,w.i0K)(y);(0,Y.Yu)(this.parent,v.name+"!"+Ce,!0,null,null,null,null,null,void 0,null,he[1]).then(function(ze){var We=new P.h(ze),Xe=new F.A;if(Array.isArray(X)){(!X||X.length===0)&&(X=[{field:ue}]);for(var tt=X.length,pt=tt-1;pt>-1;pt--)if(X[tt-1].field||(X[tt-1].field=ue),!!X[pt].field){var st=X[pt].sortComparer||k.sortComparer.bind(k,X[pt],A.caseSensitive);Xe.sortBy(X[pt].field,st)}}else{X||(X={field:ue}),X.field||(X.field=ue);var st=X.sortComparer||k.sortComparer.bind(k,X,A.caseSensitive);Xe.sortBy(X.field,st)}We.executeQuery(Xe).then(function(ht){for(var rt,Et={},Vt="__rowIndex",ce,ee=G,Ne=0;ee<=y[2];ee++,Ne++){if((0,Y.gS)(v,ee)){Ne--;continue}for(K=y[1],oe=y[3],ce=ht.result[Ne]||{},K;K<=oe;K++){if(rt=(0,w.AH9)(K+1),ce[rt])Et=(0,U.l7)({},ce[rt],null,!0);else{if(!(0,Y.$S)(ee,K,v))continue;Et=null}Et=k.skipBorderOnSorting(ee,K,v,Et),Et&&Et.formula&&(Et.formula=(0,w.flO)([ee,K],[parseInt(ce[Vt],10)-1,K],v,Et)),(0,Y.Jx)(ee,K,v,Et)}}var Te={range:v.name+"!"+Ce,sortOptions:S.sortOptions};b.previousSort&&(Te.previousSort=b.previousSort),m.resolve(Te)})})},T.prototype.skipBorderOnSorting=function(b,k,S,m){var x=(0,Y.$S)(b,k,S),v=["borderBottom","borderTop","borderRight","borderLeft","border"];if(m&&m.style)for(var y=0,A=v;y<A.length;y++){var I=A[y];delete m.style[I]}if(x&&x.style)for(var N=0,z=v;N<z.length;N++){var I=z[N];x.style[I]&&(m||(m={}),m.style||(m.style={}),m.style[I]=x.style[I])}return m},T.prototype.isSameStyle=function(b,k){b||(b={}),k||(k={});for(var S=!0,m=Object.keys(b),x=0;x<m.length;x++)if(b[m[x]]===k[m[x]]||this.parent.cellStyle[m[x]]===b[m[x]])S=!0;else{S=!1;break}return S},T.prototype.sortComparer=function(b,k,S,m){var x=b.order||"",v=Se.j.fnSort(x),y=!1,A=!1,I={sensitivity:k?"case":"base"};if(S&&m&&(typeof S.value=="string"||typeof m.value=="string")&&S.value!==""&&m.value!==""&&((0,w.hj$)(S.value)&&(S.value=(0,w.MpA)(S.value),y=!0),(0,w.hj$)(m.value)&&(m.value=(0,w.MpA)(m.value),A=!0),!A&&!A)){var N=new Intl.Collator(this.parent.locale,I);return!x||x.toLowerCase()==="ascending"?N.compare(S.value,m.value):N.compare(S.value,m.value)*-1}var z=(0,U.le)(S)||S&&((0,U.le)(S.value)||S.value===""),V=(0,U.le)(m)||m&&((0,U.le)(m.value)||m.value==="");return z&&V?-1:z?1:V?-1:v(S&&S.value,m&&m.value)},T.prototype.getModuleName=function(){return"workbookSort"},T}(),te=ae(77084),O=function(){function T(b){this.parent=b,this.addEventListener()}return T.prototype.destroy=function(){this.removeEventListener(),this.parent=null},T.prototype.addEventListener=function(){this.parent.on($.c3,this.initiateFilterHandler,this)},T.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off($.c3,this.initiateFilterHandler)},T.prototype.initiateFilterHandler=function(b){var k=this,S=b.args,m=new P.B,x=(0,Y.zf)(this.parent,(0,w.MJG)(this.parent,S.range)),v=S.filterOptions||{};if(b.promise=m.promise,v.datasource){this.setFilter(v.datasource,v.predicates,S.range,b.refresh);var y={range:S.range,filterOptions:v};m.resolve(y)}else{var A=(0,w.gaE)((0,w.IRR)(S.range));if(A[0]>x.usedRange.rowIndex||A[1]>x.usedRange.colIndex){m.reject("Select a cell or range inside the used range and try again.");return}A[0]===A[2]&&A[2]-A[0]==0&&(A[0]=0,A[1]=0,A[3]=x.usedRange.colIndex),A[2]=x.usedRange.rowIndex,A[0]=A[0]+1;var I=(0,w.i0K)(A);(0,Y.Yu)(this.parent,x.name+"!"+I,!0,!0,null,null,null,null,!1).then(function(N){var z=new P.h(N);k.setFilter(z,v.predicates,S.range,b.refresh);var V={range:I,filterOptions:v};m.resolve(V)})}},T.prototype.setFilter=function(b,k,S,m){var x=this;if(b&&k){var v=b.dataSource.json,y=new F.A;k.length&&y.where(F.$.and(k));var A=b.executeLocal(y),I="__rowIndex",N,z;if(S.indexOf("!")>-1?(z=(0,te.Q8D)(this.parent,S.split("!")[0]),N=this.parent.sheets[z]):(N=this.parent.getActiveSheet(),z=(0,te.Q8D)(this.parent,N.name)),this.parent.getModuleName()==="spreadsheet"){var V=this.parent,_,G;if(V.scrollSettings.enableVirtualization&&v.length>V.viewport.rowCount+V.getThreshold("row")*2||N.frozenRows||N.frozenColumns||m){v.forEach(function(he){_=A.indexOf(he)<0,(0,te.ZG6)(N,Number(he[I])-1,{hidden:_,isFiltered:_})}),G=z===V.activeSheetIndex;var K=(0,w.dK5)(N.paneTopLeftCell);this.parent.updateTopLeftCell((0,w.Sxm)(N,K[0],!0)-this.parent.frozenRowCount(N),null,"col")}else v.forEach(function(he){if(_=A.indexOf(he)<0,G)(0,te.ZG6)(N,Number(he[I])-1,{hidden:_,isFiltered:_});else{var ue={startIndex:Number(he[I])-1,hide:_,isFiltering:!0,sheetIndex:z};ue.endIndex=ue.startIndex,x.parent.notify($.wt,ue),G=ue.refreshUI}});G&&V.renderModule.refreshSheet(!1,!1,!0)}else{var oe;v.forEach(function(he){oe=A.indexOf(he)<0,(0,te.ZG6)(N,Number(he[I])-1,{hidden:oe,isFiltered:oe})})}}},T.prototype.getModuleName=function(){return"workbookFilter"},T}(),d=function(){function T(b){this.parent=b,this.addEventListener()}return T.prototype.setImage=function(b){var k=b.range?b.range.indexOf("!")>0?b.range.split("!")[1]:b.range.split("!")[0]:this.parent.getActiveSheet().selectedRange,S=b.range&&b.range.indexOf("!")>0?(0,Y.Q8)(this.parent,b.range.split("!")[0]):this.parent.activeSheetIndex,m=(0,w.dK5)(k),x=(0,U.o8)(S)?this.parent.getActiveSheet():this.parent.sheets[S],v=(0,Y.$S)(m[0],m[1],x),y,A=b.options;if(v&&v.image){y=v.image;for(var I=0;I<A.length;I++)y.push(A[I])}(0,Y.Jx)(m[0],m[1],x,{image:v&&v.image?y:A},!0)},T.prototype.addEventListener=function(){this.parent.on($.QL,this.setImage,this)},T.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off($.QL,this.setImage)},T.prototype.destroy=function(){this.removeEventListener(),this.parent=null},T.prototype.getModuleName=function(){return"workbookImage"},T}(),M=function(){function T(b){this.parent=b,this.addEventListener()}return T.prototype.addEventListener=function(){this.parent.on($.Uy,this.setChartHandler,this),this.parent.on($.Pp,this.refreshChartData,this),this.parent.on($.g2,this.deleteChartColl,this),this.parent.on($.$q,this.refreshChartSize,this),this.parent.on($.Pe,this.focusChartBorder,this)},T.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off($.Uy,this.setChartHandler),this.parent.off($.Pp,this.refreshChartData),this.parent.off($.g2,this.deleteChartColl),this.parent.off($.$q,this.refreshChartSize),this.parent.off($.Pe,this.focusChartBorder))},T.prototype.setChartHandler=function(b){var k=0;b.isInitCell=(0,U.le)(b.isInitCell)?!1:b.isInitCell,b.isUndoRedo=(0,U.le)(b.isUndoRedo)?!0:b.isUndoRedo,b.isPaste=(0,U.le)(b.isPaste)?!1:b.isPaste;var S=b.chart;if(S.length>0)for(;k<S.length;){if(b.isCut===!1&&document.getElementById(b.chart[k].id)&&(S[k]={range:S[k].range,id:"e_spreadsheet_chart_"+this.parent.chartCount,isSeriesInRows:S[k].isSeriesInRows,theme:S[k].theme,type:S[k].type},S[k].id="e_spreadsheet_chart_"+this.parent.chartCount,b.isIdAvailabe=!1),document.getElementById(b.chart[k].id))return;var m=(0,U.le)(b.isIdAvailabe)?!0:b.isIdAvailabe;if(S[k].theme=S[k].theme||"Material",S[k].type=S[k].type||"Line",S[k].isSeriesInRows=S[k].isSeriesInRows||!1,S[k].range=S[k].range||this.parent.getActiveSheet().selectedRange,S[k].range.indexOf("!")<0&&(S[k].range=this.parent.getActiveSheet().name+"!"+S[k].range),(0,U.le)(S[k].id)&&(S[k].id="e_spreadsheet_chart_"+this.parent.chartCount,m=!1),S[k].height=S[k].height||290,S[k].width=S[k].width||480,this.parent.notify($.hA,{option:S[k],chartCount:this.parent.chartCount,isInitCell:b.isInitCell,triggerEvent:b.isUndoRedo,dataSheetIdx:b.dataSheetIdx,range:b.range,isPaste:b.isPaste}),this.parent.chartColl.push(S[k]),m||this.parent.chartCount++,!b.isInitCell||b.isPaste){var x=S[k].range&&S[k].range.indexOf("!")>0?(0,Y.Q8)(this.parent,S[k].range.split("!")[0]):this.parent.activeSheetIndex,v=b.isPaste?(0,w.dK5)(b.range):(0,w.dK5)(S[k].range),y=(0,U.o8)(x)?this.parent.getActiveSheet():this.parent.sheets[x],A=(0,Y.$S)(v[0],v[1],y);A&&A.chart?A.chart.push(S[k]):(0,Y.Jx)(v[0],v[1],y,{chart:[S[k]]},!0)}k++}},T.prototype.refreshChartData=function(b){for(var k,S=1,m=this.parent.sheets.length+1;S<m;){var x=this.parent.chartColl;if(k=x?x.length:0,k)for(;k--;){var v=this.parent.chartColl[k],y=(0,U.le)(b.showHide)?(0,w.Z2v)((0,w.dK5)(v.range),b.rIdx,b.cIdx):this.inRowColumnRange((0,w.dK5)(v.range),b.rIdx,b.showHide),A=v.range.indexOf("!")>-1?(0,Y.Q8)(this.parent,(0,Y.HA)(v.range)):this.parent.activeSheetIndex;y&&A===this.parent.activeSheetIndex&&this.parent.notify($.Ll,{chart:v})}S++}},T.prototype.inRowColumnRange=function(b,k,S){return S==="rows"?k>=b[0]&&k<=b[2]:k>=b[1]&&k<=b[3]},T.prototype.refreshChartSize=function(b){for(var k,S=1,m=this.parent.sheets.length+1;S<m;){var x=this.parent.chartColl;if(k=x?x.length:0,k)for(;k--;){var v=this.parent.chartColl[k];if(!(0,U.le)(b.overlayEle.querySelector("#"+v.id))){var y=this.parent.element.querySelector("."+v.id),A=(0,U.Xr)(y,"chart");A&&(A.height=b.height,A.width=b.width)}}S++}},T.prototype.focusChartBorder=function(b){for(var k=0;k<this.parent.chartColl.length;k++){var S=document.getElementById(b.id),m=document.getElementById(this.parent.chartColl[k].id);S&&m&&(0,U.oq)(m,"."+S.classList[1])===S&&this.parent.notify($.hA,{option:this.parent.chartColl[k],chartCount:this.parent.chartCount,isRefresh:!0})}},T.prototype.deleteChartColl=function(b){for(var k=0;k<this.parent.chartColl.length;k++)this.parent.chartColl[k].id+"_overlay"===b.id&&this.parent.chartColl.splice(k,1)},T.prototype.destroy=function(){this.removeEventListener(),this.parent=null},T.prototype.getModuleName=function(){return"workbookChart"},T}()},55152:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Np:function(){return WorkbookNumberFormat},Kz:function(){return getFormatFromType},K2:function(){return getTypeFromFormat}});var _common_index__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(93010),_base_index__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(91997),_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8923),_index__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(77084),_common_internalization__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(81010),WorkbookNumberFormat=function(){function WorkbookNumberFormat(q){this.parent=q,this.localeObj=(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.NE)(this.parent.locale),this.decimalSep=this.localeObj.decimal,this.groupSep=this.localeObj.group,this.addEventListener()}return WorkbookNumberFormat.prototype.numberFormatting=function(q){var be=this.parent.activeSheetIndex;q.range&&q.range.indexOf("!")>-1&&(be=(0,_base_index__WEBPACK_IMPORTED_MODULE_1__.Q8)(this.parent,q.range.split("!")[0]));for(var ae=this.parent.sheets[be],P=q.range?q.range.indexOf("!")>-1?q.range.split("!")[1]:q.range:ae.selectedRange,F=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.dK5)(P),Y,w=F[0];w<=F[2];w++)for(var ye=F[1];ye<=F[3];ye++)(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.wWT)(this.parent,ae,{cell:{format:q.format},rowIdx:w,colIdx:ye})||(Y=(0,_base_index__WEBPACK_IMPORTED_MODULE_1__.$S)(w,ye,ae),this.getFormattedCell({value:Y.value,format:Y.format,rowIndex:w,colIndex:ye,sheetIndex:be,cell:Y}))},WorkbookNumberFormat.prototype.getFormattedCell=function(q){var be=q.value===void 0||q.value===null?"":q.value,ae=q.sheetIndex===void 0?this.parent.activeSheetIndex:q.sheetIndex,P=this.parent.sheets[ae],F;q.rowIndex===void 0?F=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.dK5)(P.activeCell):F=[q.rowIndex,q.colIndex];var Y=q.cell||(0,_base_index__WEBPACK_IMPORTED_MODULE_1__.$S)(F[0],F[1],P,!1,!0),w=!1,ye={},U=new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.eC;U.getNumberFormat(ye);var Z=(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.o5)(this.parent.locale,ye.currency);if(!q.format||q.format==="General"){q.type=q.format="General";var E={value:be,updatedVal:be,cell:Y};this.checkDateFormat(E),(E.isDate||E.isTime)&&(w=!0,Y.value=q.value=E.updatedVal,Y.format?q.format=Y.format:Y.format=q.format=getFormatFromType(E.isDate?"ShortDate":"Time"))}else q.type=getTypeFromFormat(q.format);var a;if(Y.format&&this.isCustomType(Y)){q.type="Custom";var $=void 0,J=Y.format;Y.format=Y.format.split("\\").join(""),this.currentRange=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.qkm)(F[0],F[1]),Y.format.indexOf(";")>-1?(Y.format.indexOf("<")>-1||Y.format.indexOf(">")>-1?q.value=q.result=this.processCustomConditions(Y):(q.value=q.result=this.processCustomAccounting(Y,F[0],F[1],q.td,Z),$=!!(!(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.hj$)(Y.value)||Y.format&&Y.format.indexOf("@")>-1)),Y.format=J):(0,_index__WEBPACK_IMPORTED_MODULE_3__.vnU)(Y,!0)?(q.result=this.processCustomDate(q,Y),$=q.result==="",q.value=q.result=q.result||Y.value):Y.format.indexOf("/")>-1?q.value=q.result=this.processCustomFraction(Y):Y.format.indexOf("@")>-1?($=!0,q.value=q.result=this.processCustomText(Y)):(0,_common_internalization__WEBPACK_IMPORTED_MODULE_4__.G)(Y,this.parent.locale,this.groupSep,this.decimalSep).isNumber?(q.value=q.result=this.processCustomNumberFormat(Y,F[0],F[1],q.td),$=!(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.hj$)(Y.value)):$=!0,$?q.isRightAlign=!1:q.isRightAlign=!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.le)(Y.value)}else a=this.processFormats(q,be,w,Y,U,Z,ye.currency);return q.isRowFill=this.isRowFill,q.onLoad||(P.id===this.parent.getActiveSheet().id&&(this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.RTt,{isRightAlign:q.type==="Custom"?q.isRightAlign:a.rightAlign,result:q.type==="Custom"?q.value:a.fResult||q.value,rowIndex:q.rowIndex,colIndex:q.colIndex,sheetIndex:q.sheetIndex,type:q.type,curSymbol:Z,value:q.type==="Custom"?q.value:q.value||"",isRowFill:this.isRowFill}),this.isRowFill=!1),this.parent.setUsedRange(q.rowIndex,q.colIndex)),q.type==="Custom"?q.formattedText=q.value===void 0||q.value===null?"":q.value.toString():(q.formattedText=a.fResult||(q.value===void 0||q.value===null?"":q.value.toString()),q.isRightAlign=a.rightAlign),q.curSymbol=Z,q.formattedText},WorkbookNumberFormat.prototype.isCustomType=function(q){var be=getTypeFromFormat(q.format),ae=this.parent.serviceLocator.getService("spreadsheetLocale");return!!(be===ae.getConstant("General")&&q.format!==ae.getConstant("General")||be===ae.getConstant("Time")&&this.parent.isEdit)},WorkbookNumberFormat.prototype.processCustomFill=function(q,be,ae,P,F){var Y=be.format.indexOf("*"),w=q[Y+1],ye=q.split(q[Y]+w),U,Z;if(ye[1]===""){q=q.split(q[Y]+w).join("");var E={format:q,value:be.value};U=this.processCustomNumberFormat(E)}else{U=q.split(q[Y]+w)[0],q=ye[1];var E={format:q,value:be.value};Z=this.processCustomNumberFormat(E),parseFloat(be.value)===0&&(Z=Z.split("0").join(""))}return this.isRowFill=!0,this.parent.notify(_common_index__WEBPACK_IMPORTED_MODULE_0__.dbz,{cell:be,rowIdx:ae,colIdx:P,value:w,formatText:U,secText:Z,td:F}),U},WorkbookNumberFormat.prototype.processCustomDate=function(q,be){var ae=this,P=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.ODv)(parseFloat(be.value));if(isNaN(Number(P)))return be.value||"";var F,Y=be.format,w=new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.eC,ye=function(E){var a;if(be.value.toString().includes("/")||be.value.toString().includes("-")){if(P=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.ZUP)(be.value,new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.eC,ae.parent.locale,Y,be).dateObj,a=P&&P.toString()!=="Invalid Date"){if(P.getFullYear()<1900)return"";be.value=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.twf)(P).toString()}}else a=P&&P.toString()!=="Invalid Date";return E&&a&&(q.dateObj=P),a&&w.formatDate(P,{type:F,format:Y})||""};if(be.format.indexOf("h")>-1&&(Y=Y.split("h").join("H"),F="time"),be.format.indexOf("s")>-1&&(F="time"),(be.format.indexOf("AM/PM")>-1||be.format.indexOf("A/P")>-1)&&(Y=Y.split("H").join("h"),Y=Y.split("A/P").join("AM/PM").split("AM/PM").join("a"),F="time"),be.format.indexOf("d")>-1){F="date";var U=be.format.match(/d/g).length;U>2&&(Y=be.format.split("d").join("E"))}if(be.format.indexOf("m")>-1){if(be.format.indexOf("s")>-1||be.format.indexOf("h")>-1)F="time";else if(F="date",Y=Y.split("m").join("M"),be.format.indexOf("mmmmm")>-1){Y="MMMM";var Z=ye()[0];return Y=be.format.split("mmmmm").join("p"),ye(q.checkDate).split("p").join(Z)}}return ye(q.checkDate)},WorkbookNumberFormat.prototype.processCustomFraction=function(q){var be="";return be},WorkbookNumberFormat.prototype.processCustomConditions=function(cell){var result=cell.value;if((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.hj$)(cell.value)){for(var conditions=cell.format.split(";"),code=void 0,i=0;i<conditions.length;i++){code=conditions[i],(0,_base_index__WEBPACK_IMPORTED_MODULE_1__.AX)(code)&&(code=code.split("["+(0,_base_index__WEBPACK_IMPORTED_MODULE_1__.AX)(code)+"]").join(""));var cond=code.split("[")[1].split("]")[0];if(eval(cell.value+cond)){cell.format=conditions[i].split("["+cond+"]")[0]+conditions[i].split("["+cond+"]")[1];break}}return result=this.processCustomNumberFormat(cell),result}else return result},WorkbookNumberFormat.prototype.processCustomAccounting=function(q,be,ae,P,F){var Y,w=q.format.split(";"),ye=(0,_common_internalization__WEBPACK_IMPORTED_MODULE_4__.G)(q,this.parent.locale,this.groupSep,this.decimalSep,F),U=q.value;if(ye.isNumber&&(q.value=ye.value,Y=parseFloat(ye.value)),Y>0)q.format=w[0];else if(Y===0)if((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.le)(w[2]))q.format=w[0];else return q.format=w[2]+"0",this.processCustomNumberFormat(q,be,ae,P).split("0").join("");else if((0,_common_index__WEBPACK_IMPORTED_MODULE_0__.hj$)(Y))q.format=w[1];else return q.format=w[3],(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.le)(w[3])?q.value?q.value.toString():"":this.processCustomText(q);if(Y<0){q.value=Math.abs(Y).toString();var Z=this.processCustomNumberFormat(q,be,ae,P);return q.value=U,Z}return this.processCustomNumberFormat(q,be,ae,P)},WorkbookNumberFormat.prototype.processCustomText=function(q){var be=this.processCustomNumberFormat({format:q.format.split("@").join("#"),value:q.value?q.value.split(q.value).join("0"):""});return be&&be.split("0").join(q.value)},WorkbookNumberFormat.prototype.thousandSeparator=function(q,be){for(;q;)be=be/1e3,q--;return be},WorkbookNumberFormat.prototype.getSeparatorCount=function(q){for(var be=0,ae=["#","0"],P=0;P<q.format.length;P++)q.format[P]===","&&!(ae.indexOf(q.format[P+1])>-1)&&be++;return be},WorkbookNumberFormat.prototype.processSeparator=function(q){var be=this.getSeparatorCount(q),ae=this.thousandSeparator(be,parseInt(q.value,10));return q.format.indexOf(".")>-1||(ae=Math.round(ae)),q.value=this.getFormattedNumber(q.format.split(",").join(""),ae),q.value=q.value.replace(",",""),ae===0&&(q.value=q.value.replace("0","")),q.value},WorkbookNumberFormat.prototype.processDigits=function(q){var be=q.format.split("?").join("0"),ae=q.value;return q.value=this.getFormattedNumber(be,parseFloat(q.value)),!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.le)(q.value)&&q.value.includes(".")&&(q.value=q.value.split(".")[0]+"."+q.value.split(".")[1].split("0").join("  ")),q.value===""&&ae==="0"&&(q.value=ae),q.value},WorkbookNumberFormat.prototype.processSpace=function(q,be){var ae=" ",P={cell:be,char:ae,width:0};this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_3__.d8d,P);for(var F=P.width,Y,w=0;w<q.length;w++)if(q[w]==="_"){P.char=q[w+1],this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_3__.d8d,P);var ye=P.width;Y=Math.round(ye/F),q=q.replace(q[w]+q[w+1],ae.repeat(Y))}return q},WorkbookNumberFormat.prototype.processCustomNumberFormat=function(q,be,ae,P){if(q.format==="")return"";var F=0,Y=q.value,w=!1;if(F=(0,_common_internalization__WEBPACK_IMPORTED_MODULE_4__.G)(q,this.parent.locale,this.groupSep,this.decimalSep).value,q&&(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.hj$)(F)){q.value=F,F=parseFloat(F.toString());var ye=this.processCustomColor(q);this.getSeparatorCount(q)&&(w=!0,Y=this.processSeparator(q)),ye.indexOf("?")>-1&&(w=!0,ye=q.format.split("?").join(""),Y=this.processDigits(q)),ye.indexOf("_")>-1&&(w=!0,ye=q.format=this.processSpace(ye,q),Y=this.getFormattedNumber(ye,F)),(q.format.indexOf('"')>-1||q.format.indexOf("\\")>-1)&&(ye=this.processText(ye)),ye&&Y&&ye.indexOf("?")>-1&&(Y=Y.replace("?"," ")),ye.indexOf("*")>-1&&(w=!0,Y=this.processCustomFill(ye,q,be,ae,P)),ye==="General"&&(w=!0,Y=F.toString()),w||(Y=this.getFormattedNumber(ye,F)),ye!=null&&ye.split(".")[0].indexOf("#")>-1&&F<1&&(Y=Y.toString().replace(/^0+/,""))}return Y},WorkbookNumberFormat.prototype.processText=function(q){var be=q;return be.indexOf('"')>-1?be=be.split('"').join(""):be.indexOf("\\")>-1&&(be=be.split("\\").join("")),be},WorkbookNumberFormat.prototype.processCustomColor=function(q){var be=q.format,ae=(0,_base_index__WEBPACK_IMPORTED_MODULE_1__.AX)(be);return ae?(be=q.format.split("["+ae+"]")[0]+q.format.split("["+ae+"]")[1],this.currentRange.indexOf("NaN")>-1&&(this.currentRange=void 0),this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_3__.vbl,{style:{color:ae},range:this.currentRange})):q.style&&(0,_base_index__WEBPACK_IMPORTED_MODULE_1__.M5)().indexOf(q.style.color)>-1&&this.parent.notify(_index__WEBPACK_IMPORTED_MODULE_3__.vbl,{style:{color:"black"}}),be},WorkbookNumberFormat.prototype.processFormats=function(q,be,ae,P,F,Y,w){var ye;if(be!=="")switch(q.type){case"General":ye=this.autoDetectGeneralFormat({args:q,currencySymbol:Y,fResult:be,intl:F,isRightAlign:ae,curCode:w,cell:P,rowIdx:Number(q.rowIndex),colIdx:Number(q.colIndex)}),be=ye.fResult,ae=ye.isRightAlign;break;case"Number":(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.hj$)(be)&&(be=this.applyNumberFormat(q,F),ae=!0);break;case"Currency":var U=(0,_common_internalization__WEBPACK_IMPORTED_MODULE_4__.G)({value:be,format:q.format},this.parent.locale,this.groupSep,this.decimalSep,Y);U.isNumber&&(q.value=U.value,be=this.currencyFormat(q,F,w),ae=!0);break;case"Percentage":(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.hj$)(be)&&(be=this.percentageFormat(q,F),ae=!0);break;case"Accounting":(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.hj$)(be)&&(be=this.accountingFormat(q,F,Y,w),ae=!0);break;case"ShortDate":be=this.shortDateFormat(q,F),ae=!!be;break;case"LongDate":be=this.longDateFormat(q,F),ae=!!be;break;case"Time":be=this.timeFormat(q,F),ae=!!be;break;case"Fraction":(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.hj$)(be)&&(be=this.fractionFormat(q),ae=!0);break;case"Scientific":(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.hj$)(be)&&(be=this.scientificFormat(q),ae=!0);break;case"Text":ae=!1;break}return{fResult:be,rightAlign:ae}},WorkbookNumberFormat.prototype.autoDetectGeneralFormat=function(q){var be=!1,ae=q.fResult;if(q.args.cell&&q.args.cell.formula&&q.args.cell.formula.indexOf("ADDRESS(")>0&&(be=!0),(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.hj$)(q.fResult)&&(q.args.format&&q.args.format!==""&&(q.args.format.toString().indexOf("%")>-1?q.fResult=this.percentageFormat(q.args,q.intl):q.args.format.toString().indexOf(q.currencySymbol)>-1?q.fResult=this.currencyFormat(q.args,q.intl,q.curCode):q.fResult=this.applyNumberFormat(q.args,q.intl)),q.args.format==="General"&&q.fResult&&q.fResult.toString().split(this.decimalSep)[0].length>11&&(q.fResult=this.scientificFormat(q.args)),q.isRightAlign=!0),!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.le)(q.fResult)){var P=q.fResult.toString();P.indexOf("%")>-1&&P.split("%")[0]!==""&&P.split("%")[1].trim()===""&&Number(P.split("%")[0].split(this.groupSep).join("")).toString()!=="NaN"?(q.args.value=Number(P.split("%")[0].split(this.groupSep).join(""))/100,q.cell.format=q.args.format=this.getPercentageFormat(P),q.fResult=this.percentageFormat(q.args,q.intl),q.cell.value=q.args.value.toString(),q.isRightAlign=!0):P.indexOf(q.currencySymbol)>-1&&P.split(q.currencySymbol)[1]!==""&&Number(P.split(q.currencySymbol)[1].split(this.groupSep).join("")).toString()!=="NaN"&&(q.args.value=Number(P.split(q.currencySymbol)[1].split(this.groupSep).join("")),q.cell.format=q.args.format=getFormatFromType("Currency"),q.fResult=this.currencyFormat(q.args,q.intl,q.curCode),q.cell.value=q.args.value.toString(),(0,_base_index__WEBPACK_IMPORTED_MODULE_1__.Jx)(q.rowIdx,q.colIdx,this.parent.getActiveSheet(),q.cell,!0),q.isRightAlign=!0)}return be&&(q.isRightAlign=!1,q.fResult=ae),{isRightAlign:q.isRightAlign,fResult:q.fResult}},WorkbookNumberFormat.prototype.getPercentageFormat=function(q){return q.indexOf(this.decimalSep)>-1?getFormatFromType("Percentage"):"0%"},WorkbookNumberFormat.prototype.findSuffix=function(q,be){var ae=q.length,P=ae-be.length;return q.substr(0,P<0?0:P)+be},WorkbookNumberFormat.prototype.applyNumberFormat=function(q,be){q.format=this.isCustomFormat(q.format.toString());var ae=q.format.toString().split(";");if(Number(q.value)>0)q.format=ae[0];else if(Number(q.value)===0){if(q.format=ae[2]?ae[2]:ae[0],q.format.indexOf('"')>-1&&q.format.indexOf("#")===-1)return q.format=q.format.split("_").join(" ").split("*").join(" ").split("?").join(" ").split('"').join(""),q.format}else if(Number(q.value)<0)q.format=(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.le)(ae[1])?ae[0]:ae[1].split("*").join(" "),q.format.indexOf("-")>-1&&(q.value=q.value.toString().split("-").join(""));else if(q.format=ae[3]?ae[3]:ae[0],q.format=q.format.split("_").join(" ").split("*").join(" ").split("?").join(" "),q.format.indexOf("@")>-1)return q.format.split("@").join(q.value.toString());if(q.format=q.format.split("_").join(" ").split("*").join(" ").split('"').join(""),q.format.indexOf("?")>-1&&q.format.indexOf(this.decimalSep)>-1){var P=q.format.split(this.decimalSep)[1].length,F="";if(Number(q.value)%1){var Y=q.value.toString().split(".")[1].length;P>Y?F=" ":F="0"}q.format=q.format.split("?").join(F)}else q.format=q.format.split("?").join(" ");return Number(q.value)<0&&q.cell&&(q.format=q.cell.format),be.formatNumber(Number(q.value),{format:q.format})},WorkbookNumberFormat.prototype.isCustomFormat=function(q){return(q==='_-* #,##0.00_-;-* #,##0.00_-;_-* "-"_-;_-@_-'||q==='_-* #,##0_-;-* #,##0_-;_-* "-"_-;_-@_-')&&(q=""),q=q===""?getFormatFromType("Number"):q,q=q.toString().split("_)").join(" ").split("_(").join(" ").split("[Red]").join(""),q},WorkbookNumberFormat.prototype.currencyFormat=function(q,be,ae){q.format=q.format===""?getFormatFromType("Currency"):q.format,q.format=q.format.toString().split("_(").join(" ").split("_)").join(" ").split("[Red]").join("");var P=q.format.toString().split(";");return Number(q.value)>=0?q.format=P[0]:q.format=(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.le)(P[1])?P[0]:P[1].split("*").join(" "),q.format=this.getFormatForOtherCurrency(q.format),be.formatNumber(Number(q.value),{format:q.format,currency:ae})},WorkbookNumberFormat.prototype.percentageFormat=function(q,be){return q.format=q.format===""?getFormatFromType("Percentage"):q.format,be.formatNumber(Number(q.value),{format:q.format})},WorkbookNumberFormat.prototype.accountingFormat=function(q,be,ae,P){q.format=q.format===""?getFormatFromType("Accounting"):q.format,q.format=q.format.split("_(").join(" ").split("_)").join(" ").split("[Red]").join("").split("_").join("");var F=q.format.split(";");return Number(q.value)>=0?q.format=F[0]:q.format=F[1].split("*").join(" "),q.format=this.getFormatForOtherCurrency(q.format),Number(q.value)===0?ae+"- ":be.formatNumber(Number(q.value),{format:q.format,currency:P}).split("-").join("")},WorkbookNumberFormat.prototype.getFormatForOtherCurrency=function(q){if(q.indexOf("[$")>-1){var be=q.split("]")[0].split("[$")[1].split("-")[0];q.indexOf("0")>q.indexOf("[$")?q=be+q.slice(q.indexOf("]")+1,q.length):q=q.slice(0,q.indexOf("[$"))+be}return q},WorkbookNumberFormat.prototype.shortDateFormat=function(q,be){var ae=q.format===""||q.format==="General"?getFormatFromType("ShortDate"):q.format,P;if(ae===getFormatFromType("ShortDate")?(ae="MM-dd-yyyy",P={type:"date",skeleton:"yMd"}):P={type:"date",format:ae},q.value&&(q.value=q.value.toString(),q.value.includes("/")||q.value.includes("-"))){(ae==="dd-MM-yyyy"||ae==="dd/MM/yyyy")&&(ae="");var F=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.ZUP)(q.value,new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.eC,this.parent.locale,ae,q.cell).dateObj;if(F&&F.toString()!=="Invalid Date")return F.getFullYear()<1900?"":(q.value=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.twf)(F).toString(),q.cell&&(q.cell.value=q.value),q.checkDate&&(q.dateObj=F),be.formatDate(F,P))}var Y=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.ODv)(q.value);return q.checkDate&&(q.dateObj=Y),be.formatDate(Y,P)},WorkbookNumberFormat.prototype.longDateFormat=function(q,be){var ae=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.ODv)(q.value),P=q.format===""||q.format==="General"?getFormatFromType("LongDate"):q.format.toString();return P===getFormatFromType("LongDate")&&(P="EEEE, MMMM d, y"),q.checkDate&&(q.dateObj=ae),be.formatDate(ae,{type:"date",format:P})},WorkbookNumberFormat.prototype.timeFormat=function(q,be){if((0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.le)(q.value))return"";var ae=q.value.toString().split(this.decimalSep);(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.le)(ae[1])||(q.value=parseFloat(ae[0]+1+this.decimalSep+ae[1])||q.value);var P=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.ODv)(q.value),F=q.format===""||q.format==="General"?getFormatFromType("Time"):q.format.toString();return F===getFormatFromType("Time")&&(F="h:mm:ss a"),be.formatDate(P,{type:"time",skeleton:"medium",format:F})},WorkbookNumberFormat.prototype.scientificFormat=function(q){q.format=q.format===""?getFormatFromType("Scientific"):q.format;var be=q.format.split("+")[1],ae=this.findDecimalPlaces(q.format,"Scientific"),P=Number(q.value).toExponential(ae);return P.indexOf("e+")>-1?P=P.split("e+")[0]+"E+"+this.findSuffix(be,P.split("e+")[1]):P.indexOf("e-")>-1&&(P=P.split("e-")[0]+"E-"+ +this.findSuffix(be,P.split("e-")[1])),P},WorkbookNumberFormat.prototype.fractionFormat=function(q){q.format=q.format===""?getFormatFromType("Fraction"):q.format;var be="",ae;return q.value.toString().indexOf(this.decimalSep)>-1&&(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.hj$)(q.value)?(be=q.value.toString().split(this.decimalSep)[0],ae=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.ULC)(Number(q.value)),Number(be)===0?" "+ae:be+" "+ae):be},WorkbookNumberFormat.prototype.findDecimalPlaces=function(q,be){var ae,P;switch(be){case"Scientific":if(ae=q.toUpperCase().indexOf("E"),P=q.indexOf(this.decimalSep),ae>-1)return q.substring(P+1,ae).length}return 2},WorkbookNumberFormat.prototype.checkDateFormat=function(q){if(!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.le)(q.value)){var be=q.cell||(0,_base_index__WEBPACK_IMPORTED_MODULE_1__.$S)(q.rowIndex,q.colIndex,(0,_base_index__WEBPACK_IMPORTED_MODULE_1__.zf)(this.parent,(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.le)(q.sheetIndex)?this.parent.activeSheetIndex:q.sheetIndex),!1,!0),ae=this.checkCustomDateFormat(q.value.toString(),be);if(ae.val!=="Invalid"){var P=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.ZUP)(ae.val,new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.eC,this.parent.locale,ae.format,be);!(0,_syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.le)(P.dateObj)&&P.dateObj.toString()!=="Invalid Date"&&P.dateObj.getFullYear()>=1900&&(ae.val=(0,_common_index__WEBPACK_IMPORTED_MODULE_0__.twf)(P.dateObj,ae.val.indexOf(":")>-1,P.type&&P.type==="time").toString(),be.format||(P.type==="time"?be.format=getFormatFromType("Time"):be.format=getFormatFromType("ShortDate")),q.isDate=P.type==="date"||P.type==="datetime",q.isTime=P.type==="time",q.dateObj=P.dateObj),q.updatedVal=ae.val}}},WorkbookNumberFormat.prototype.checkCustomDateFormat=function(q,be){var ae;if(q.includes("/"))ae="/";else if(q.includes("-"))ae="-";else return{val:q.includes(":")?q:"Invalid",format:""};var P=q.split(ae),F="",Y=[],w=function(){F=Y.join(ae),be.format||(be.format=F)};if(P.length===2){var ye,U=function($){q=ye,Y[0]="MMM",Number($)<=31?(q=$+ae+q,Y.splice(0,0,"dd"),w()):Number($)>=1900&&Number($)<=9999&&(q+=ae+$.slice(2,4),Y[1]="yy",w())},Z=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];P[0]=P[0].toLowerCase().trim(),P[1]=P[1].toLowerCase().trim(),(ye=!Number(P[0])&&Z.find(function($){return P[0].includes($)}))?U(P[1]):(ye=!Number(P[1])&&Z.find(function($){return P[1].includes($)}))?U(P[0]):P[0]&&Number(P[0])<=12&&(ye=Z[Number(P[0])-1],U(P[1])),Y.length||(q="Invalid")}else if(P.length>2)for(var Z=["jan","feb","mar","apr","may","jun","jul","aug","sep","sept","oct","nov","dec"],E=function(J){Number(P[J])>-1||(Z.filter(function(se){return P[J].toLowerCase().includes(se)}).length?J===1&&(Y[1]="MMM",Number(P[0])<31&&Number(P[2])>=1900&&Number(P[2])<=9999&&(Y[0]="d",Y[2]="yy",w())):q="Invalid")},a=0;a<P.length;a++)E(a);return{val:q,format:F}},WorkbookNumberFormat.prototype.formattedBarText=function(q){if(q.value!==""){var be=getTypeFromFormat(q.cell?q.cell.format:""),ae=new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.eC,P=q.value,F=be==="ShortDate"&&q.cell&&q.cell.format?q.cell.format:getFormatFromType("ShortDate"),Y=getFormatFromType("Time");switch(be){case"ShortDate":case"LongDate":q.value=this.shortDateFormat({type:be,value:q.value,format:F,cell:q.cell},ae);break;case"Time":P&&Number(P)>=1?q.value=this.shortDateFormat({type:be,value:q.value,format:F},ae)+" "+this.timeFormat({type:be,value:q.value,format:Y},ae):q.value=this.timeFormat({type:be,value:q.value,format:Y},ae);break}(!q.value||q.value&&q.value.toString().indexOf("null")>-1)&&(q.value=P)}},WorkbookNumberFormat.prototype.getFormattedNumber=function(q,be){return new _syncfusion_ej2_base__WEBPACK_IMPORTED_MODULE_2__.eC().formatNumber(Number(be),{format:q})||""},WorkbookNumberFormat.prototype.addEventListener=function(){this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.XUD,this.numberFormatting,this),this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.eYQ,this.getFormattedCell,this),this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.w0y,this.checkDateFormat,this),this.parent.on(_common_index__WEBPACK_IMPORTED_MODULE_0__.gff,this.formattedBarText,this)},WorkbookNumberFormat.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.XUD,this.numberFormatting),this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.eYQ,this.getFormattedCell),this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.w0y,this.checkDateFormat),this.parent.off(_common_index__WEBPACK_IMPORTED_MODULE_0__.gff,this.formattedBarText))},WorkbookNumberFormat.prototype.destroy=function(){this.removeEventListener(),this.parent=null},WorkbookNumberFormat.prototype.getModuleName=function(){return"workbookNumberFormat"},WorkbookNumberFormat}();function getFormatFromType(q){var be="General";switch(q.split(" ").join("")){case"Number":be="0.00";break;case"Currency":be="$#,##0.00";break;case"Accounting":be='_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)';break;case"ShortDate":be="mm-dd-yyyy";break;case"LongDate":be="dddd, mmmm dd, yyyy";break;case"Time":be="h:mm:ss AM/PM";break;case"Percentage":be="0.00%";break;case"Fraction":be="# ?/?";break;case"Scientific":be="0.00E+00";break;case"Text":be="@";break}return be}function getTypeFromFormat(q){var be="General";switch(q){case'_-* #,##0.00_-;-* #,##0.00_-;_-* "-"_-;_-@_-':case'_-* #,##0_-;-* #,##0_-;_-* "-"_-;_-@_-':be="Number";break;case"$#,##0.00":case"$#,##0_);[Red]($#,##0)":case"$#,##0.00_);($#,##0.00)":case"$#,##0_);($#,##0)":be="Currency";break;case'_($*#,##0.00_);_($*(#,##0.00);_($*"-"??_);_(@_)':case'_($*#,##0.00_);_($* (#,##0.00);_($*"-"??_);_(@_)':case'_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)':case'_ $ * #,##0.00_ ;_ $ * -#,##0.00_ ;_ $ * "-"??_ ;_ @_ ':be="Accounting";break;case"mm-dd-yyyy":case"dd/MM/yyyy":be="ShortDate";break;case"dddd, mmmm dd, yyyy":be="LongDate";break;case"h:mm:ss AM/PM":be="Time";break;case"0.00%":case"0%":be="Percentage";break;case"# ?/?":case"# ??/??":case"# ???/???":be="Fraction";break;case"0.00E+00":be="Scientific";break;case"@":be="Text";break;default:q&&q.indexOf("[$")>-1&&(q.indexOf("* ")>-1?be="Accounting":be="Currency");break}return be}},47799:function(q,be,ae){"use strict";ae.d(be,{S:function(){return F}});var P=ae(8923),F=function(){function Y(){this.services={}}return Y.prototype.getService=function(w){if((0,P.le)(this.services[w]))throw"The service "+w+" is not registered";return this.services[w]},Y.prototype.register=function(w,ye){(0,P.le)(this.services[w])&&(this.services[w]=ye)},Y}()},80638:function(){},82680:function(q,be,ae){"use strict";ae.r(be),ae.d(be,{default:function(){return IA}});var P=ae(2824),F=ae(89460),Y=ae(67294),w=ae(77084),ye=ae(70180);function U(o){var t=[];return Z(o,t),(0,ye.a)(o,t),t}function Z(o,t){t.push({member:"basic",args:[]}),t.push({member:"all",args:[]}),o.showRibbon&&t.push({member:"ribbon",args:[o]}),o.showFormulaBar&&t.push({member:"formulaBar",args:[o]}),o.showSheetTabs&&t.push({member:"sheetTabs",args:[o]}),o.allowEditing&&(t.push({member:"edit",args:[o]}),t.push({member:"formula",args:[o]}),t.push({member:"workbookFormula",args:[o]}),t.push({member:"workbookEdit",args:[o]})),o.allowOpen&&t.push({member:"open",args:[o]}),o.allowSave&&t.push({member:"save",args:[o]}),o.enableContextMenu&&t.push({member:"contextMenu",args:[o]}),o.allowAutoFill&&t.push({member:"autofill",args:[o]}),o.selectionSettings.mode!=="None"&&t.push({member:"selection",args:[o]}),o.enableKeyboardNavigation&&t.push({member:"keyboardNavigation",args:[o]}),o.allowNumberFormatting&&t.push({member:"numberFormat",args:[o]}),o.enableKeyboardShortcut&&t.push({member:"keyboardShortcut",args:[o]}),o.enableClipboard&&t.push({member:"clipboard",args:[o]}),o.allowCellFormatting&&t.push({member:"cellformat",args:[o]}),o.allowSorting&&t.push({member:"sort",args:[o]}),o.allowResizing&&t.push({member:"resize",args:[o]}),t.push({member:"collaborativeEditing",args:[o]}),t.push({member:"protectSheet",args:[o]}),o.allowHyperlink&&t.push({member:"spreadsheetHyperlink",args:[o]}),o.allowUndoRedo&&t.push({member:"undoredo",args:[o]}),o.allowFiltering&&t.push({member:"filter",args:[o]}),o.allowWrap&&t.push({member:"wrapText",args:[o]}),o.allowInsert&&t.push({member:"insert",args:[o]}),o.allowDelete&&t.push({member:"delete",args:[o]}),o.allowDataValidation&&t.push({member:"dataValidation",args:[o]}),o.allowFindAndReplace&&t.push({member:"findAndReplace",args:[o]}),o.allowMerge&&t.push({member:"merge",args:[o]}),o.allowConditionalFormat&&t.push({member:"conditionalFormatting",args:[o]}),o.allowImage&&t.push({member:"spreadsheetImage",args:[o]}),o.allowChart&&t.push({member:"spreadsheetChart",args:[o]})}var E=ae(62243),a=ae(8923);function $(o){requestAnimationFrame(function(){o()})}function J(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function se(o){var t=30;return o.toString().length>3&&(t=o.toString().length*10),t}var re=null,Ae=1.24;function Ie(){if(re!==null)return re;var o=document.createElement("div"),t=0;return o.style.cssText="width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(o),t=o.offsetWidth-o.clientWidth|0,document.body.removeChild(o),re=t}var Se=["e-ribbon","e-formula-bar-panel","e-sheet-tab-panel","e-header-toolbar"];function Q(o,t){t===void 0&&(t=Se);var e=te(o,"previous",t),i=te(o,"next",t);return e+i}function te(o,t,e){for(var i=o[t+"ElementSibling"],r=0;i;)e.some(function(n){return i.classList.contains(n)})&&(r+=i.offsetHeight),i=i[t+"ElementSibling"];return r}function O(o,t,e){if(o.scrollSettings.enableVirtualization){var i=o.getActiveSheet(),r=o.frozenRowCount(i),n=o.frozenColCount(i),s=o.viewport.topIndex+r,l=o.viewport.leftIndex+n,h=o.viewport.bottomIndex,c=o.viewport.rightIndex;if(i.frozenRows||i.frozenColumns){if(o.insideViewport(t[0],t[1])||o.insideViewport(t[2],t[3]))return!0}else if(s<=t[0]&&h>=t[2]&&l<=t[1]&&c>=t[3])return!0;var u=!1;if(e){if(t[0]<s&&t[2]<s||t[0]>h&&t[2]>h||(t[0]<s&&t[2]>s&&t[0]>=r&&(t[0]=s,u=!0),t[2]>h&&(t[2]=h,u=!0),t[1]<l&&t[3]<l||t[1]>c&&t[3]>c))return!1;t[1]<l&&t[3]>l&&t[1]>=n&&(t[1]=l,u=!0),t[3]>c&&(t[3]=c,u=!0)}return u}else return!0}function d(o,t,e,i,r,n,s){var l,h={left:{idx:0,size:0},top:{idx:0,size:0}},c=h.top.size,u=h.left.size;for(l=h.top.idx;l<t[0];l++)e&&e-1<t[0]&&l<e||(c+=(0,w.NEZ)(o,l,!0));for(l=h.left.idx;l<t[1];l++)i&&i-1<t[1]&&l<i||(u+=(0,w.IQS)(o,l,null,!0));return e&&t[0]<e&&(o.showHeaders&&(c+=30),r&&(c-=r)),i&&t[1]<i&&(o.showHeaders&&(u+=s||30),n&&(u-=n)),{top:c,left:u}}function M(o,t,e,i,r,n,s){i===void 0&&(i="e-selection");var l=o.getActiveSheet();if(l.frozenRows||l.frozenColumns){var h,c=o.frozenRowCount(l),u=o.frozenColCount(l);if(i==="e-active-cell"){if(e[0]<c||e[1]<u){t.style.display="none",h=e[0]<c&&e[1]<u?o.getSelectAllContent():e[0]<c?o.getColumnHeaderContent():o.getRowHeaderContent();var p=h.querySelector("."+i);p||(p=t.cloneNode(!0),h.appendChild(p)),t=p,b(o,t,e,l,o.enableRtl,c,u,r,!0,o.viewport.beforeFreezeHeight,o.viewport.beforeFreezeWidth,o.sheetModule.colGroupWidth)}else b(o,t,e,l,o.enableRtl,c,u,r);t.style.display&&(t.style.display=""),T(o.getSelectAllContent(),h,"e-active-cell"),T(o.getColumnHeaderContent(),h,"e-active-cell"),T(o.getRowHeaderContent(),h,"e-active-cell")}else if(i==="e-autofill"){var f=void 0,g=o.frozenRowCount(l),C=o.frozenColCount(l);if(e[0]<g||e[1]<C){t.style.display="none",f=e[0]<g&&e[1]<C?o.getSelectAllContent():e[0]<g?o.getColumnHeaderContent():o.getRowHeaderContent();var p=f.querySelector("."+i);p||(p=t.cloneNode(!0),f.appendChild(p)),t=p,b(o,t,e,l,o.enableRtl,g,C,r,!0,o.viewport.beforeFreezeHeight,o.viewport.beforeFreezeWidth,o.sheetModule.colGroupWidth,"e-autofill")}else b(o,t,e,l,o.enableRtl,g,C,r,!1,0,0,0,"e-autofill");t.style.display&&(t.style.display=""),T(o.getSelectAllContent(),f,"e-autofill"),T(o.getColumnHeaderContent(),f,"e-autofill"),T(o.getRowHeaderContent(),f,"e-autofill")}else if(i==="e-filloption"){var f=void 0,g=o.frozenRowCount(l),C=o.frozenColCount(l);if(e[0]<g||e[1]<C)if(e[3]+1===C&&e[2]+1>g)b(o,o.getMainContent().querySelector(".e-filloption"),e,l,o.enableRtl,g,C,r,!1,0,0,0,"e-filloption",!0,{left:-4});else if(e[2]+1===g&&e[3]+1>C)b(o,o.getMainContent().querySelector(".e-filloption"),e,l,o.enableRtl,g,C,r,!1,0,0,0,"e-filloption",!0,{top:-4});else if(e[3]+1===C&&e[2]+1<g){f=o.getColumnHeaderContent();var L=f.querySelector("."+i);L||o.notify(w.AH7,{id:o.element.id+"_autofilloptionbtn",appendElem:f}),t=o.autofillModule.autoFillDropDown.element,b(o,t,e,l,o.enableRtl,g,C,r,!1,0,0,0,"e-filloption",!0,{left:-4})}else if(e[2]+1===g&&e[3]+1===C)b(o,o.getMainContent().querySelector(".e-filloption"),e,l,o.enableRtl,g,C,r,!1,0,0,0,"e-filloption",!0,{top:-4,left:-4});else{f=e[0]<g&&e[1]<C?o.getSelectAllContent():e[0]<g?o.getColumnHeaderContent():o.getRowHeaderContent();var p=f.querySelector("."+i);p||o.notify(w.AH7,{id:o.element.id+"_autofilloptionbtn",appendElem:f}),t=o.autofillModule.autoFillDropDown.element,b(o,t,e,l,o.enableRtl,g,C,r,!0,o.viewport.beforeFreezeHeight,o.viewport.beforeFreezeWidth,o.sheetModule.colGroupWidth,"e-filloption",!0)}else b(o,o.getMainContent().querySelector(".e-filloption"),e,l,o.enableRtl,g,C,r,!1,0,0,0,"e-filloption",!0);t.style.display&&(t.style.display=""),T(o.getSelectAllContent(),f,"e-filloption"),T(o.getColumnHeaderContent(),f,"e-filloption"),T(o.getRowHeaderContent(),f,"e-filloption")}else{var D=(0,w.gaE)(e);if(D[0]<c||D[1]<u){t.classList.contains("e-multi-range")||t.classList.add("e-hide");var R=[];D[0]<c&&D[1]<u?D[2]<c&&D[3]<u?(R.push(e),n||(T(o.getColumnHeaderContent(),h,i,!0),T(o.getRowHeaderContent(),h,i,!0))):D[2]>c-1?D[3]<u?(n||T(o.getColumnHeaderContent(),h,i,!0),R.push([D[0],D[1],c-1,D[3]]),R.push([c,D[1],D[2],D[3]])):(R.push([D[0],D[1],c-1,u-1]),R.push([c,D[1],D[2],u-1]),R.push([D[0],u,c-1,D[3]]),R.push([c,u,D[2],D[3]])):D[2]<c?(R.push([D[0],D[1],D[2],u-1]),R.push([D[0],u,D[2],D[3]]),n||T(o.getRowHeaderContent(),h,i,!0)):(R.push([c,D[1],D[2],u-1]),R.push([D[0],D[1],c-1,u-1]),R.push([c,u,D[2],D[3]]),R.push([D[0],u,c-1,D[3]])):D[0]<c?D[2]<c?(R.push(e),n||T(o.getRowHeaderContent(),h,i,!0)):(R.push([D[0],D[1],c-1,D[3]]),R.push([c,D[1],D[2],D[3]]),n||(T(o.getSelectAllContent(),h,i,!0),T(o.getRowHeaderContent(),h,i,!0))):D[3]<u?(R.push(e),n||T(o.getSelectAllContent(),h,i,!0)):(R.push([D[0],D[1],D[2],u-1]),R.push([D[0],u,D[2],D[3]]),n||(T(o.getSelectAllContent(),h,i,!0),T(o.getColumnHeaderContent(),h,i,!0)));var B;R.forEach(function(j){h=j[2]<c&&j[3]<u?o.getSelectAllContent():j[2]<c?o.getColumnHeaderContent():j[3]<u?o.getRowHeaderContent():o.getMainContent();var W;i==="e-copy-indicator"||i==="e-range-indicator"?(W=t.cloneNode(!0),h.appendChild(W),c&&(j[2]+1===c&&R.forEach(function(ne){ne!==j&&(B=W.getElementsByClassName("e-bottom")[0],B&&ne[0]===c&&(0,a.og)(B))}),j[0]===c&&h.parentElement.classList.contains("e-main-panel")&&R.forEach(function(ne){ne!==j&&(B=W.getElementsByClassName("e-top")[0],B&&ne[2]+1===c&&(0,a.og)(B))})),u&&(j[3]+1===u&&R.forEach(function(ne){ne!==j&&(B=W.getElementsByClassName("e-right")[0],B&&ne[1]===u&&(0,a.og)(B))}),j[1]===u&&(h.classList.contains("e-sheet-content")||h.classList.contains("e-column-header"))&&R.forEach(function(ne){ne!==j&&(B=W.getElementsByClassName("e-left")[0],B&&ne[3]+1===u&&(0,a.og)(B))}))):(W=h.querySelector("."+i),W||(W=t.cloneNode(!0),n&&!W.classList.contains("e-multi-range")&&W.classList.add("e-multi-range"),h.appendChild(W)),s&&W.classList.remove(i)),b(o,W,j,l,o.enableRtl,c,u,r,!1,o.viewport.beforeFreezeHeight,o.viewport.beforeFreezeWidth,o.sheetModule.colGroupWidth),W.classList.contains("e-hide")&&W.classList.remove("e-hide")})}else n||(T(o.getSelectAllContent(),null,i,!0),T(o.getColumnHeaderContent(),null,i,!0),T(o.getRowHeaderContent(),null,i,!0)),b(o,t,e,l,o.enableRtl,c,u,r),(i==="e-range-indicator"||!o.getMainContent().querySelector("."+i))&&o.getMainContent().appendChild(t),t.classList.contains("e-hide")&&t.classList.remove("e-hide"),s&&t.classList.remove(i)}}else{var H=b(o,t,e,l,o.enableRtl,0,0,r);return t&&!o.getMainContent().querySelector("."+i)&&o.getMainContent().appendChild(t),H}}function T(o,t,e,i,r){if(i||o!==t)if(r)for(var n=o.querySelectorAll("."+e),s=0;s<n.length;)n[s].classList.remove(e),s++;else{var l=o.querySelector("."+e);l&&(0,a.og)(l)}}function b(o,t,e,i,r,n,s,l,h,c,u,p,f,g,C){var L=(0,w.gaE)(e),D=d(i,L,n,s,c,u,p),R=[(0,w.Sxm)(i,0,!0),(0,w.Sxm)(i,0,!0,"columns")],B,H;o.scrollSettings.isFinite?(B=L[0]>=i.rowCount?0:(0,w.EB_)(i,L[0],L[2]<i.rowCount?L[2]:i.rowCount-1,!0),H=L[1]>=i.colCount?0:(0,w.pGm)(i,L[1],L[3]<i.colCount?L[3]:i.colCount-1,!0)):(B=(0,w.EB_)(i,L[0],L[2],!0),H=(0,w.pGm)(i,L[1],L[3],!0));var j=L[1]===0&&L[3]===i.colCount-1,W=L[0]===0&&L[2]===i.rowCount-1,ne=0,ie=-5,me=-5,ve=0,Ee=6,le=6;if((0,a.le)(f)){var de={top:(L[0]===R[0]?D.top:D.top-G(1))+"px",height:B&&B+(L[0]===R[0]?0:G(1))+"px",width:H&&H+(L[1]===R[1]?0:G(1))+(h&&s&&L[1]<s&&L[3]>=s?1:0)+"px"};if(de[r?"right":"left"]=(L[1]===R[1]?D.left:D.left-1)+"px",t){var fe=k([{element:t,attrs:de}],l);return fe}}else{j&&(ie=-5,me=-2,Ee=6,le=3),W&&(me=-5,ie=0,Ee=1,le=6),W||(ne+=B),j||(ve+=H),ne+=Math.round(D.top)+ie,ve+=Math.round(D.left)+me;var de={};g?((0,a.IV)([t],"e-hide"),ne=C&&C.top?C.top:ne,ve=C&&C.left?C.left:ve,de={top:ne+Ee+"px",left:ve+le+"px"},t&&k([{element:t,attrs:de}],l)):(de={top:ne+"px"},de[r?"right":"left"]=ve+"px",t&&k([{element:t,attrs:de}],l))}}function k(o,t){var e=new Promise(function(i){var r=function(){o.forEach(function(n){(0,a.V7)(n.element,n.attrs),i()})};t?r():requestAnimationFrame(function(){return r()})});return e}function S(){return a.AR.isPointer?"pointerdown":"mousedown touchstart"}function m(){return a.AR.isPointer?"pointermove":"mousemove touchmove"}function x(){return a.AR.isPointer?"pointerup":"mouseup touchend"}function v(o){return o.type==="touchstart"||o.type==="pointerdown"&&o.pointerType==="touch"}function y(o){return o.type==="touchmove"||o.type==="pointermove"&&o.pointerType==="touch"}function A(o){return o.type==="touchend"||o.type==="pointerup"&&o.pointerType==="touch"}function I(o){return o&&(o.type==="mousedown"||o.type==="pointerdown")}function N(o){return o&&(o.type==="mousemove"||o.type==="pointermove")}function z(o){return o&&(o.type==="mouseup"||o.type==="pointerup")}function V(o){return o.changedTouches?o.changedTouches[0].clientX:o.clientX}function _(o){return o.changedTouches?o.changedTouches[0].clientY:o.clientY}function G(o,t){if(window.devicePixelRatio%1>0){var e=o*window.devicePixelRatio%1;return o+(e?(e>.5||t?1-e:-1*e)/window.devicePixelRatio:0)}else return o}var K={role:"role",selected:"aria-selected",multiselectable:"aria-multiselectable",busy:"aria-busy",colcount:"aria-colcount"};function oe(o,t){var e=Object.keys(t);e.forEach(function(i){o&&o.setAttribute(K[i],t[i])})}function he(o,t){if(o){var e=(0,a.Xr)(o,t);e&&e.destroy()}}function ue(o,t,e,i,r){var n,s,l,h,c,u,p,f,g,C=r.getActiveSheet(),L=r.frozenRowCount(C),D=r.frozenColCount(C);if(i){var R=o<D?r.getSelectAllContent():r.getColumnHeaderContent();n=R.getElementsByTagName("th")[t],s=R.getElementsByTagName("col")[t],l=(o<D?r.getRowHeaderContent():r.getMainContent()).getElementsByTagName("col")[t]}else{n=s=L||D?r.getRow(o,null,D-1):r.getRow(o,r.getRowHeaderTable()),s.style.height=parseInt(e,10)>0?G(parseInt(e,10))+"px":"2px",l=r.getRow(o,null,D),l.style.height=parseInt(e,10)>0?G(parseInt(e,10))+"px":"0px";var B=void 0;if(C.showHeaders){var H=r.getRowHeaderContent().getElementsByClassName("e-row"),j=[];j[0]=H[t].getElementsByTagName("td")[0].cloneNode(!0),B=ze(r.getRowHeaderTable(),j,!1,r)+1}for(var W=r.getMainContent().getElementsByClassName("e-row"),ne=[],ie=0;ie<W[t].getElementsByTagName("td").length;ie++)ne[ie]=W[t].getElementsByTagName("td")[ie].cloneNode(!0);var me=ze(r.getContentTable(),ne,!1,r)+1,ve=B>=me?B:me;parseInt(l.style.height,10)<ve||n&&n.classList.contains("e-reach-fntsize")&&parseInt(l.style.height,10)===ve?(C.showHeaders&&(n.classList.add("e-reach-fntsize"),s.style.lineHeight=parseInt(e,10)>=4?parseInt(e,10)-4+"px":parseInt(e,10)>0?parseInt(e,10)-1+"px":"0px"),l.style.lineHeight=parseInt(e,10)>0?parseInt(e,10)-1+"px":"0px"):(s&&s.style.removeProperty("line-height"),l.style.removeProperty("line-height"),n&&n.classList.contains("e-reach-fntsize")&&n.classList.remove("e-reach-fntsize"))}if(u=l.previousElementSibling,g=l.nextElementSibling,u&&(C.showHeaders&&(h=n.previousElementSibling,c=s.previousElementSibling),u=l.previousElementSibling),g&&(C.showHeaders&&(p=n.nextElementSibling,f=s.nextElementSibling),g=l.nextElementSibling),parseInt(e,10)<=0&&!(l.classList.contains("e-zero")||l.classList.contains("e-zero-start"))){if(u&&g)if(i?(C.showHeaders&&(s.style.width="2px"),l.style.width="0px"):(C.showHeaders&&(s.style.height="2px"),l.style.height="0px"),u.classList.contains("e-zero-start")?(C.showHeaders&&n.classList.add("e-zero-start"),l.classList.add("e-zero-start")):(C.showHeaders&&n.classList.add("e-zero"),l.classList.add("e-zero")),p&&!p.classList.contains("e-zero")&&!p.classList.contains("e-zero-last")&&(C.showHeaders&&n.classList.add("e-zero-last"),l.classList.add("e-zero-last")),u.classList.contains("e-zero-last")&&(C.showHeaders&&h.classList.remove("e-zero-last"),u.classList.remove("e-zero-last")),C.showHeaders&&h.classList.contains("e-zero")?(n.classList.contains("e-zero-end"),X(c,-2,i)):C.showHeaders&&X(c,-1,i),C.showHeaders&&h.classList.contains("e-zero-start")&&X(s,-1,i),C.showHeaders&&p.classList.contains("e-zero"))if(n.classList.contains("e-zero-start"))for(;p;)if(p.classList.contains("e-zero")&&parseInt(f.style.height,10)!==0&&!i||parseInt(f.style.width,10)!==0&&i){i?(s.style.width=parseInt(s.style.width,10)-1+"px",f.style.width=parseInt(f.style.width,10)-1+"px"):(s.style.height=parseInt(s.style.height,10)-1+"px",f.style.height=parseInt(f.style.height,10)-1+"px"),p.classList.remove("e-zero"),p.classList.add("e-zero-start");break}else{var Ee=void 0;p.classList.remove("e-zero"),p.classList.add("e-zero-start"),i?(Ee=parseInt(p.getAttribute("aria-colindex"),10)-1,p=r.getColHeaderTable().getElementsByTagName("th")[Ee+1],f=r.getColHeaderTable().getElementsByTagName("col")[Ee+1]):(Ee=parseInt(p.getAttribute("aria-rowindex"),10)-1,p=r.getRowHeaderTable().getElementsByTagName("tr")[Ee+1],f=r.getRowHeaderTable().getElementsByTagName("tr")[Ee+1])}else X(s,-2,i);else C.showHeaders&&(p.classList.contains("e-zero-end")?i?s.style.width="0px":s.style.height="0px":X(f,-1,i));else if(u)i?(C.showHeaders&&(s.style.width="1px"),l.style.width="0px"):(C.showHeaders&&(s.style.height="1px"),l.style.height="0px"),C.showHeaders&&n.classList.add("e-zero-end"),l.classList.add("e-zero-end"),C.showHeaders&&n.classList.add("e-zero-last"),l.classList.add("e-zero-last"),C.showHeaders&&h.classList.contains("e-zero")?X(c,-2,i):X(c,-1,i);else if(p)if(n.classList.add("e-zero-start"),l.classList.add("e-zero-start"),p.classList.contains("e-zero")||(n.classList.add("e-zero-last"),l.classList.add("e-zero-last")),i?(s.style.width="1px",l.style.width="0px"):(s.style.height="1px",l.style.height="0px"),C.showHeaders&&p.classList.contains("e-zero"))for(;p;)if(p.classList.contains("e-zero")&&parseInt(f.style.width,10)!==0&&i||parseInt(f.style.height,10)!==0&&!i){i?(f.style.width=parseInt(f.style.width,10)-1+"px",s.style.width=parseInt(s.style.width,10)-1+"px"):(f.style.height=parseInt(f.style.height,10)-1+"px",s.style.height=parseInt(s.style.height,10)-1+"px"),p.classList.add("e-zero-start"),p.classList.remove("e-zero");break}else{var Ee=void 0;p.classList.add("e-zero-start"),p.classList.remove("e-zero"),i?(Ee=parseInt(p.getAttribute("aria-colindex"),10)-1,f=r.getColHeaderTable().getElementsByTagName("col")[Ee+1],p=r.getColHeaderTable().getElementsByTagName("th")[Ee+1]):(Ee=parseInt(p.getAttribute("aria-rowindex"),10)-1,f=r.getRowHeaderTable().getElementsByTagName("tr")[Ee+1],p=r.getRowHeaderTable().getElementsByTagName("tr")[Ee+1])}else C.showHeaders&&X(f,-1,i)}else if(parseInt(e,10)>0){var le=G(parseInt(e,10))+"px";i?(s.style.width=le,l.style.width=le):(s.style.height=le,l.style.height=le),C.showHeaders&&h&&p?(h.classList.contains("e-zero")?n.classList.contains("e-zero")?i?(c.style.width=parseInt(c.style.width,10)+2+"px",s.style.width=parseInt(s.style.width,10)-1+"px"):(c.style.height=parseInt(c.style.height,10)+2+"px",s.style.height=parseInt(s.style.height,10)-1+"px"):X(s,-1,i):n.classList.contains("e-zero")?X(c,1,i):n.classList.contains("e-zero-start")&&(i?(c.style.width=parseInt(c.style.width,10)+1+"px",s.style.width=parseInt(s.style.width,10)-1+"px"):(c.style.height=parseInt(c.style.height,10)+1+"px",s.style.height=parseInt(s.style.height,10)-1+"px")),p.classList.contains("e-zero")?X(s,-1,i):(n.classList.contains("e-zero")||n.classList.contains("e-zero-start"))&&X(f,1,i),n.classList.contains("e-zero")&&n.classList.remove("e-zero"),n.classList.contains("e-zero-start")&&n.classList.remove("e-zero-start"),l.classList.contains("e-zero")&&l.classList.remove("e-zero"),l.classList.contains("e-zero-start")&&l.classList.remove("e-zero-start"),n.classList.contains("e-zero-last")&&n.classList.remove("e-zero-last"),l.classList.contains("e-zero-last")&&l.classList.remove("e-zero-last"),(h.classList.contains("e-zero")||h.classList.contains("e-zero-start"))&&(h.classList.add("e-zero-last"),u.classList.add("e-zero-last"))):C.showHeaders&&h?(h.classList.contains("e-zero")?n.classList.contains("e-zero")?i?(s.style.width=parseInt(s.style.width,10)-1+"px",c.style.width=parseInt(c.style.width,10)+2+"px"):(s.style.height=parseInt(s.style.height,10)-1+"px",c.style.height=parseInt(c.style.height,10)+2+"px"):X(s,-1,i):n.classList.contains("e-zero")?X(c,1,i):X(s,-1,i),n.classList.contains("e-zero")&&n.classList.remove("e-zero"),n.classList.contains("e-zero-end")&&n.classList.remove("e-zero-end"),l.classList.contains("e-zero")&&l.classList.remove("e-zero"),l.classList.contains("e-zero-end")&&l.classList.remove("e-zero-end")):C.showHeaders&&p&&(p.classList.contains("e-zero")?X(s,-1,i):n.classList.contains("e-zero-start")&&(X(f,1,i),n.classList.remove("e-zero-start")),n.classList.contains("e-zero")&&n.classList.remove("e-zero"),l.classList.contains("e-zero")&&l.classList.remove("e-zero"),n.classList.contains("e-zero-start")&&n.classList.remove("e-zero-start"),l.classList.contains("e-zero-start")&&l.classList.remove("e-zero-start"))}}function X(o,t,e){e?o.style.width=parseInt(o.style.width,10)+t+"px":o.style.height=parseInt(o.style.height,10)+t+"px"}function Ce(o){Ae=o}function ze(o,t,e,i,r,n){var s=i.createElement("div",{className:i.element.className,styles:"display: block"}),l=i.createElement("table",{className:o.className+"e-resizetable",styles:"width: auto;height: auto"}),h=i.createElement("tr");e?t.forEach(function(g){var C=h.cloneNode();C.appendChild(g),l.appendChild(C)}):(t.forEach(function(g){h.appendChild(g.cloneNode(!0))}),l.appendChild(h)),s.appendChild(l),document.body.appendChild(s);var c,u,p=l.getBoundingClientRect().width,f=l.getBoundingClientRect().height;return n?(e&&parseInt(r,10)>p?c=p:c=parseInt(r,10),!e&&parseInt(r,10)>f?u=f:u=parseInt(r,10)):(u=f,c=p),document.body.removeChild(s),Math.ceil(e?c:u)}function We(o,t,e,i,r,n){var s=o.eventArgs,l,h,c,u,p,f,g,C,L,D,R,B,H,j=o.isFromUpdateAction||(0,a.o8)(e);if(o.isUndoRedo){j=o.isFromUpdateAction=!0,delete o.isUndoRedo,t.notify(E.Y5,o);return}if(j&&!n){var W=s.address||s.range||s.pastedRange||s.addressCollection&&s.addressCollection[0]||s.dataRange,ne=(0,a.o8)(s.sheetIndex)?(0,a.o8)(s.sheetIdx)?(0,a.o8)(s.activeSheetIndex)?W?(0,w.MJG)(t,W):t.activeSheetIndex:s.activeSheetIndex:s.sheetIdx:s.sheetIndex;if(ne!==t.activeSheetIndex){var ie={sheet:(0,w.zfV)(t,ne),resolveAfterFullDataLoaded:!0,indexes:[0,0,0,0],promise:new Promise(function(Ye){Ye(function(){}())})};t.notify(w.uRS,ie),ie.promise.then(function(){We(o,t,e,i,r,!0)});return}}switch(o.action){case"sorting":c={range:o.eventArgs.range,sortOptions:o.eventArgs.sortOptions,cancel:!1},u=new Promise(function(Ze,nt){Ze(function(){}())}),p={args:c,promise:u},t.notify(w.fqz,p),p.promise.then(function(Ze){t.serviceLocator.getService("cell").refreshRange((0,w.IRR)(Ze.range))});break;case"cellSave":f=o.eventArgs;var me={element:f.element,value:f.value,oldValue:f.oldValue,address:f.address,displayText:f.displayText,formula:f.formula,originalEvent:f.originalEvent};g=me.formula?{formula:me.formula}:{value:me.value},t.updateCell(g,me.address),e===!0&&t.trigger("cellSave",me);break;case"cellDelete":var ve=(0,w.ZXJ)(t,o.eventArgs.address);vt(t,ve.indices,ve.sheetIndex);break;case"format":if(s.requestType==="CellFormat"){if(s.style&&s.style.border&&!(0,a.le)(s.borderType)){var Ee={};Object.assign(Ee,s.style,null,!0),s.style.border=void 0,t.notify(w.vbl,{style:s.style,refreshRibbon:!0,range:s.range,onActionUpdate:!j}),s.style.border=Ee.border,t.setBorder(s.style,s.range,s.borderType),s.style=Ee}else t.notify(w.vbl,{style:s.style,refreshRibbon:!0,range:s.range,onActionUpdate:!j});$(function(){return t.selectRange(t.getActiveSheet().selectedRange)})}else t.numberFormat(s.format,s.range);break;case"clipboard":C=new Promise(function(Ze){Ze(function(){}())}),H=t.getAddressInfo(s.copiedRange),t.notify(s.copiedInfo.isCut?E.z7:E.JG,{range:H.indices,sId:(0,w.zfV)(t,H.sheetIndex).id,promise:u,invokeCopy:!0,isPublic:!0,isFromUpdateAction:!0}),C.then(function(){return t.notify(E.v,{range:(0,w.IRR)(s.pastedRange),sIdx:(0,w.Q8D)(t,(0,w.HAf)(s.pastedRange)),type:s.type,isAction:!1,isInternal:!0,isFromUpdateAction:!0})});break;case"gridLines":t.setSheetPropertyOnMute(t.sheets[s.sheetIdx],"showGridLines",s.isShow),t.serviceLocator.getService("sheet").toggleGridlines(),t.notify(w.bUq,null);break;case"headers":t.setSheetPropertyOnMute(t.sheets[s.sheetIdx],"showHeaders",s.isShow),t.serviceLocator.getService("sheet").showHideHeaders(),t.notify(w.bUq,null);break;case"resize":case"resizeToFit":j&&(D=t.sheets[s.sheetIndex],R=(0,w.wDo)(D,s.index),B=(0,w.dMx)(D,s.index),(s.isCol&&R&&R.hidden||B&&B.hidden)&&t.notify(w.wtl,{startIndex:s.index,endIndex:s.index,hide:!1,isCol:s.isCol,sheetIndex:s.sheetIndex})),s.isCol?s.hide===void 0?t.setColWidth(j&&!(0,a.o8)(e)?s.oldWidth:s.width,s.index,s.sheetIndex):t.hideColumn(s.index,s.index,s.hide):s.hide===void 0?t.setRowHeight(j&&!(0,a.o8)(e)?s.oldHeight:s.height,s.index,s.sheetIndex):t.hideRow(s.index,s.index,s.hide);break;case"renameSheet":var ne=(0,w.PmP)(t,s.index);t.setSheetPropertyOnMute(t.sheets[ne],"name",s.value),t.notify(E.ej,{items:t.element.querySelector(".e-sheet-tabs-items"),value:s.value,idx:ne});break;case"hideSheet":t.notify(E.oR,{sheetIndex:s.sheetIndex});break;case"showSheet":t.notify(E.Rp,s);break;case"removeSheet":t.notify(E.Lh,{index:s.index,isAction:!0,count:s.sheetCount,clicked:!0});break;case"gotoSheet":t.notify(E.lA,{selectedIndex:s.currentSheetIndex,previousIndex:s.previousSheetIndex});break;case"moveSheet":(0,w.j1e)(t,s.position,s.sheetIndexes,null,j);break;case"wrap":(0,w.reQ)(o.eventArgs.address,o.eventArgs.wrap,t);break;case"hideShow":s.isCol?t.notify(w.wtl,{startIndex:s.startIndex,endIndex:s.endIndex,isCol:!0,hide:e===!1?!s.hide:s.hide,sheetIndex:s.sheetIndex}):t.notify(w.wtl,{startIndex:s.startIndex,endIndex:s.endIndex,hide:e===!1?!s.hide:s.hide,sheetIndex:s.sheetIndex});break;case"replace":t.notify(w.gxs,{value:s.compareValue,replaceValue:s.replaceValue,sheetIndex:s.sheetIndex,address:s.address});break;case"replaceAll":t.notify(w.kon,s);break;case"filter":u=new Promise(function(Ze,nt){Ze(function(){}())}),e===!1?t.notify(E.WG,{predicates:s.previousPredicates,range:s.range,sIdx:s.sheetIndex,promise:u,isInternal:!0}):t.notify(E.WG,{predicates:s.predicates,range:s.range,sIdx:s.sheetIndex,promise:u,isInternal:!0,useFilterRange:s.useFilterRange}),r&&!j&&u.then(function(){t.notify(E.Av,(0,a.l7)({isUndo:!e,isUndoRedo:!j},r))});break;case"insert":if(o.eventArgs.modelType==="Sheet")D=t;else if(D=(0,w.zfV)(t,o.eventArgs.activeSheetIndex),!D)break;e===!1?t.notify(w.$sV,{model:D,start:o.eventArgs.index,isUndoRedo:!0,end:o.eventArgs.index+(o.eventArgs.model.length-1),modelType:o.eventArgs.modelType}):t.notify(w.IQJ,{model:D,start:o.eventArgs.index,end:o.eventArgs.index+(o.eventArgs.model.length-1),modelType:o.eventArgs.modelType,checkCount:e===void 0?o.eventArgs.sheetCount:null,activeSheetIndex:o.eventArgs.activeSheetIndex,isUndoRedo:!0,insertType:o.eventArgs.insertType,isFromUpdateAction:j});break;case"delete":if(o.eventArgs.modelType==="Sheet")D=t;else if(D=(0,w.zfV)(t,o.eventArgs.activeSheetIndex),!D)break;e===!1?t.notify(w.IQJ,{model:D,start:o.eventArgs.deletedModel,modelType:o.eventArgs.modelType,columnCellsModel:o.eventArgs.deletedCellsModel,definedNames:o.eventArgs.definedNames,activeSheetIndex:o.eventArgs.activeSheetIndex,isUndoRedo:!0,insertType:o.eventArgs.modelType==="Row"?"above":"before",conditionalFormats:o.eventArgs.conditionalFormats,prevAction:o.action}):t.notify(w.$sV,{model:D,start:o.eventArgs.startIndex,checkCount:o.eventArgs.sheetCount,end:o.eventArgs.endIndex,modelType:o.eventArgs.modelType,isUndoRedo:!0,insertType:o.eventArgs.modelType==="Row"?"above":"before"});break;case"validation":e===!1?t.notify(E.hu,{range:s.range}):t.notify(w.dKh,{rules:{type:s.type,operator:s.operator,value1:s.value1,value2:s.value2,ignoreBlank:s.ignoreBlank,inCellDropDown:s.inCellDropDown},range:s.range});break;case"removeHighlight":case"addHighlight":t.notify(E.QG,{isRemoveHighlight:o.action==="removeHighlight"?e!==!1:e===!1,range:s.range,isPublic:!0});break;case"merge":o.eventArgs.isAction=!1,L=[];for(var le=0,de=s.model.length;le<de;le++){L.push({cells:[]});for(var fe=0,Le=s.model[le].cells.length;fe<Le;fe++)L[le].cells[fe]={},Object.assign(L[le].cells[fe],s.model[le].cells[fe])}t.notify(w.mtj,o.eventArgs),s.model=L;break;case"clear":t.notify(E.MQ,{options:o.eventArgs,isPublic:!0,isFromUpdateAction:j});break;case"conditionalFormat":if(e===!1){t.notify(w.G2p,{range:s.range,sheetIdx:s.sheetIdx,isUndoRedo:!0,isFromUpdateAction:j});for(var ke=0;ke<i.length;ke++)if(i[ke].action==="conditionalFormat"){var Me={type:i[ke].eventArgs.type,cFColor:i[ke].eventArgs.cFColor,value:i[ke].eventArgs.value,range:i[ke].eventArgs.range};t.notify(w.L,{conditionalFormat:Me,sheetIdx:i[ke].eventArgs.sheetIdx})}}else{var Me={type:s.type,cFColor:s.cFColor,value:s.value,range:s.range};t.notify(w.axz,{conditionalFormat:Me,sheetIdx:s.sheetIdx,isRedo:!0,isAction:!1,isFromUpdateAction:j})}break;case"clearCF":e===!1?t.notify(w.eaW,{conditionalFormats:s.cFormats,oldRange:s.oldRange,selectedRange:s.selectedRange}):t.notify(w.G2p,{range:s.selectedRange,sheetIdx:s.sheetIdx,isClearCF:!0,isUndoRedo:!0,isFromUpdateAction:j});break;case"insertImage":e===!1?t.notify(E.ao,{id:o.eventArgs.id,sheetIdx:o.eventArgs.sheetIndex+1,range:o.eventArgs.range,preventEventTrigger:!0}):t.notify(E.oE,{options:{src:o.eventArgs.imageData,height:o.eventArgs.imageHeight,width:o.eventArgs.imageWidth,imageId:o.eventArgs.id},range:o.eventArgs.range,isPublic:!1,isUndoRedo:!0});break;case"deleteImage":e===!1?t.notify(E.oE,{options:{src:o.eventArgs.imageData,height:o.eventArgs.imageHeight,width:o.eventArgs.imageWidth,imageId:o.eventArgs.id},range:o.eventArgs.address,isPublic:!1,isUndoRedo:!0}):t.notify(E.ao,{id:o.eventArgs.id,range:o.eventArgs.address,preventEventTrigger:!0});break;case"imageRefresh":h=document.getElementById(o.eventArgs.id),e===!1?t.notify(E.eh,{prevTop:o.eventArgs.currentTop,prevLeft:o.eventArgs.currentLeft,currentTop:o.eventArgs.prevTop,currentLeft:o.eventArgs.prevLeft,id:o.eventArgs.id,currentHeight:o.eventArgs.prevHeight,currentWidth:o.eventArgs.prevWidth,requestType:"imageRefresh",prevHeight:o.eventArgs.currentHeight,prevWidth:o.eventArgs.currentWidth,isUndoRedo:!0}):(o.eventArgs.isUndoRedo=!0,t.notify(E.eh,o.eventArgs)),h&&(h.style.height=e===!1?o.eventArgs.prevHeight+"px":o.eventArgs.currentHeight+"px",h.style.width=e===!1?o.eventArgs.prevWidth+"px":o.eventArgs.currentWidth+"px",h.style.top=e===!1?o.eventArgs.prevTop+"px":o.eventArgs.currentTop+"px",h.style.left=e===!1?o.eventArgs.prevLeft+"px":o.eventArgs.currentLeft+"px");break;case"insertChart":if(e===!1)t.notify(E.k0,{id:s.id,range:s.range,isUndoRedo:!0});else{var De=[{type:s.type,theme:s.theme,isSeriesInRows:s.isSeriesInRows,range:s.range,id:s.id,height:s.height,width:s.width}];t.notify(w.UyC,{chart:De,isUndoRedo:!1,range:s.posRange})}break;case"deleteChart":if(e===!1){var Fe=[{type:s.type,theme:s.theme,isSeriesInRows:s.isSeriesInRows,range:s.range,id:s.id,height:s.height,width:s.width,top:s.top,left:s.left}];t.notify(w.UyC,{chart:Fe,isUndoRedo:!1,range:s.posRange})}else t.notify(E.k0,{id:s.id,range:s.range,isUndoRedo:!0});break;case"chartRefresh":l=document.getElementById(o.eventArgs.id),l&&(l.style.height=e===!1?o.eventArgs.prevHeight+"px":o.eventArgs.currentHeight+"px",l.style.width=e===!1?o.eventArgs.prevWidth+"px":o.eventArgs.currentWidth+"px",l.style.top=e===!1?o.eventArgs.prevTop+"px":o.eventArgs.currentTop+"px",l.style.left=e===!1?o.eventArgs.prevLeft+"px":o.eventArgs.currentLeft+"px"),e===!1?t.notify(E.tB,(0,a.l7)({},o.eventArgs,{currentColIdx:o.eventArgs.prevColIdx,currentHeight:o.eventArgs.prevHeight,currentLeft:o.eventArgs.prevLeft,currentRowIdx:o.eventArgs.prevRowIdx,currentTop:o.eventArgs.prevTop,currentWidth:o.eventArgs.prevWidth,prevColIdx:o.eventArgs.currentColIdx,prevHeight:o.eventArgs.currentHeight,prevLeft:o.eventArgs.currentLeft,prevRowIdx:o.eventArgs.currentRowIdx,prevTop:o.eventArgs.currentTop,prevWidth:o.eventArgs.currentWidth,isUndoRedo:!0})):(o.eventArgs.isUndoRedo=!0,t.notify(E.tB,o.eventArgs));break;case"chartDesign":t.notify(E.dG,o.eventArgs);break;case"autofill":t.notify(w.O$v,{fillRange:o.eventArgs.fillRange,dataRange:o.eventArgs.dataRange,fillType:o.eventArgs.fillType,direction:o.eventArgs.direction});break;case"removeValidation":e!==!1&&t.notify(E.hu,{range:s.range});break;case"addDefinedName":if(e===!1)t.notify(w.B7N,{action:"removeDefinedName",isRemoved:!1,definedName:s.name,scope:s.scope,isEventTrigger:!0});else{var Pe={name:s.name,refersTo:s.refersTo,scope:s.scope,comment:s.comment};t.notify(w.B7N,{action:"addDefinedName",isAdded:!1,definedName:Pe,isEventTrigger:!0})}break;case"hyperlink":t.notify(w.g7J,{hyperlink:s.hyperlink,cell:s.address,displayText:s.displayText,triggerEvt:!1}),t.serviceLocator.getService("cell").refreshRange((0,w.IRR)(s.address));break;case"removeHyperlink":t.notify(E.Th,{range:s.address,preventEventTrigger:!0});break;case"freezePanes":t.freezePanes(s.row,s.column,s.sheetIndex);break;case"duplicateSheet":(0,w.tNt)(t,s.sheetIndex,null,j);break;case"protectSheet":s.isProtected?t.notify(w.tVr,s):(t.setSheetPropertyOnMute((0,w.zfV)(t,s.sheetIndex),"password",""),t.notify(E.Oj,{isActive:!0,sheetIndex:s.sheetIndex}));break;case"protectWorkbook":s.isProtected?t.notify(E.eF,s):t.notify(E.e,null);break;case"lockCells":t.notify(w.YYv,s)}}function Xe(o,t,e,i){for(var r=o.sheets[i],n=r.ranges,s,l=0,h=n.length;l<h;l++)if(n[l].template&&(s=(0,w.dK5)(n[l].address.length?n[l].address:n[l].startCell),s[0]<=t&&s[1]<=e&&s[2]>=t&&s[3]>=e))return!0;return!1}function tt(o,t,e,i,r,n,s){s===void 0&&(s=!0);var l=(0,w.NEZ)(t,i,!0),h=o.frozenColCount(t),c=G(e);if(r=r||(t.frozenRows?o.getRow(i,null,h):o.getRow(i)),r&&(r.style.height=c+"px"),t.frozenColumns)n=o.getRow(i,null,h-1);else{var u=o.frozenRowCount(t);n=n||o.getRow(i,i<u?o.sheetModule.getSelectAllTable():o.getRowHeaderTable())}n&&(n.style.height=c+"px"),(0,w.vmj)(t,i,e),o.setProperties({sheets:o.sheets},!0),s&&o.notify(E.QK,{rowIdx:i,threshold:c-l})}function pt(o,t,e,i){e===void 0&&(e=1);var r=t&&t.fontSize||o.cellStyle.fontSize,n=r.indexOf("pt")>-1?parseInt(r,10)/.75:parseInt(r,10),s=n*(i||st(t&&t.fontFamily?t:o.cellStyle))*e;return Math.ceil(s%1>.9?s+1:s)}function st(o){var t=Ae;return o&&(o.fontFamily==="Arial Black"?t=1.44:o.fontFamily==='"Segoe UI", sans-serif'&&(t=1.36)),t}function ht(o,t,e,i){t||(t=e);var r=document.createElement("canvas"),n=r.getContext("2d");return n.font=(t.fontStyle||e.fontStyle)+" "+(t.fontWeight||e.fontWeight)+" "+(t.fontSize||e.fontSize)+" "+(t.fontFamily||e.fontFamily),i?n.measureText(o).width:G(n.measureText(o).width,!0)}function rt(o,t,e,i){var r,n,s,l,h=0,c=o.toString().split(" "),u=ht(" ",e,i),p,f,g=0,C=0,L=0,D=function(B,H){h&&g++,r/t>=1&&(B.split("").forEach(function(j){l=ht(j,e,i,!0),s+=l,s>t&&(g++,s=l)}),r=G(s,!0)),H||R(r),h=r},R=function(B){r+=(B+u)/t>=1?0:u};return c.forEach(function(B){s=0,l=0,r=ht(B,e,i),f=(h+r)/t,f>1?(n=B.split("-"),n.length>1?n.forEach(function(H){s=0,l=0,p||(p=ht("-",e,i)),r=ht(H,e,i),n[n.length-1]!==H&&(r+=p),f=(h+r)/t,f>=1?D(H,n[n.length-1]!==H):(n[n.length-1]===H&&c[c.length-1]!==B&&R(h+r),h+=r)}):D(B,!1)):(R(h+r),h+=r)}),h&&(C=(h-u)/t,L=parseFloat(C.toString().split(".")[0]),g+=C+.05>=L+1?Math.ceil(C)+1:Math.ceil(C)),g}function Et(o,t,e){var i=0,r=(0,w.$Su)(o,t,e,null,!0),n=(0,w.$Su)(o,t+1,e,null,!0);return r.style&&(r.style.border?i=(t===0?2:1)*parseFloat(r.style.border.split("px")[0]):(t===0&&r.style.borderLeft&&(i=parseFloat(r.style.borderLeft.split("px")[0])),r.style.borderRight&&(i+=parseFloat(r.style.borderRight.split("px")[0])))),!(r.style&&(r.style.border||r.style.borderRight))&&n.style&&n.style.borderLeft&&(i+=parseFloat(n.style.borderLeft.split("px")[0])),i>0&&i<1?1:i}function Vt(o,t,e){var i=0,r=(0,w.$Su)(o,t,e,null,!0);r.style&&(r.style.border?i=(o===0?2:1)*parseFloat(r.style.border.split("px")[0]):(o===0&&r.style.borderTop&&(i=parseFloat(r.style.borderTop.split("px")[0])),r.style.borderBottom&&(i+=parseFloat(r.style.borderBottom.split("px")[0]))));var n=(0,w.$Su)(o+1,t,e,null,!0);return!(r.style&&(r.style.border||r.style.borderBottom))&&n.style&&n.style.borderTop&&(i+=parseFloat(n.style.borderTop.split("px")[0])),Math.ceil(i)||1}function ce(o,t,e,i){return i===void 0&&(i=e),(0,w.pGm)(o,e,i,!0)-G(4+(Et(t,e,o)||1))}function ee(o,t,e,i,r,n,s){return pt(o,r,n,s)+Vt(t,e,i)}function Ne(o,t,e,i){o.maxHgts[t]||(o.maxHgts[t]={}),o.maxHgts[t][e]=i}function Te(o,t){var e=0,i=o.maxHgts[t];return i&&Object.keys(i).forEach(function(r){i[r]>e&&(e=i[r])}),e}function we(o){if(!document.activeElement.classList.contains("e-text-findNext-short"))if(a.AR.isIE){var t=window.scrollX,e=window.scrollY;o.focus(),window.scrollTo(t,e)}else o.focus({preventScroll:!0})}function ct(o,t){for(var e=o.getActiveSheet(),i,r=(0,a.le)(t)?(0,w.gaE)((0,w.dK5)(e.selectedRange)):t,n=r[0];n<=r[2];n++)for(var s=r[1];s<=r[3];s++){var l=(0,w.$Su)(n,s,e);if((0,w.p1d)(l,(0,w.wDo)(e,s))){i=!0;break}}return i}function Lt(o){return o.includes(" ")}function vt(o,t,e){for(var i=(0,w.zfV)(o,e),r,n,s,l,h=e===o.activeSheetIndex,c=t[0],u=t[2];c<=u;c++)if(!(0,w.wDH)(i,c))for(var p=t[1],f=t[3];p<=f;p++){var g={cellIdx:[c,p],isUnique:!1,uniqueRange:""};if(o.notify(w.Azt,g),r=!1,g.uniqueRange!==""){var C=(0,w.IRR)(g.uniqueRange);r=(0,w.$Su)(C[0],C[1],i).value==="#SPILL!"}if((!g.isUnique||r)&&(n=(0,w.$Su)(c,p,i),n)){if(s={},n.formula&&(s.formula=""),(n.value||n.value===0)&&(s.value=""),n.hyperlink&&(s.hyperlink=""),l=o.getCell(c,p),!Object.keys(s).length||(0,w.wWT)(o,i,{cell:s,rowIdx:c,colIdx:p,valChange:!0,uiRefresh:h,td:l,cellDelete:!0}))continue;l&&(l.querySelector(".e-cf-databar")&&l.removeChild(l.querySelector(".e-cf-databar")),l.querySelector(".e-iconsetspan")&&l.removeChild(l.querySelector(".e-iconsetspan"))),o.notify(w.xMH,{rowIdx:c,colIdx:p,cell:(0,w.$Su)(c,p,i),isAction:!0})}}}var Oe=ae(27976),gi=function(){function o(t){this.parent=t,this.init(),this.addEventListener()}return o.prototype.init=function(){this.parent.element.appendChild(this.parent.createElement("input",{className:"e-clipboard",attrs:{contenteditable:"true"}}))},o.prototype.addEventListener=function(){var t=this.getClipboardEle();this.parent.on(E.z7,this.cut,this),this.parent.on(E.JG,this.copy,this),this.parent.on(E.v,this.paste,this),this.parent.on(E.EP,this.clearCopiedInfo,this),this.parent.on(E.Zp,this.tabSwitchHandler,this),this.parent.on(E.MX,this.cMenuBeforeOpenHandler,this),this.parent.on(E.hU,this.ribbonClickHandler,this),this.parent.on(E.eT,this.initCopyIndicator,this),this.parent.on(E.QK,this.rowHeightChanged,this),this.parent.on(E.N2,this.colWidthChanged,this),this.parent.on(w.cRm,this.refreshOnInsertDelete,this),a.bi.add(t,"cut",this.cut,this),a.bi.add(t,"copy",this.copy,this),a.bi.add(t,"paste",this.paste,this)},o.prototype.removeEventListener=function(){var t=this.getClipboardEle();this.parent.isDestroyed||(this.parent.off(E.z7,this.cut),this.parent.off(E.JG,this.copy),this.parent.off(E.v,this.paste),this.parent.off(E.EP,this.clearCopiedInfo),this.parent.off(E.Zp,this.tabSwitchHandler),this.parent.off(E.MX,this.cMenuBeforeOpenHandler),this.parent.off(E.hU,this.ribbonClickHandler),this.parent.off(E.eT,this.initCopyIndicator),this.parent.off(E.QK,this.rowHeightChanged),this.parent.off(E.N2,this.colWidthChanged),this.parent.off(w.cRm,this.refreshOnInsertDelete)),a.bi.remove(t,"cut",this.cut),a.bi.remove(t,"copy",this.copy),a.bi.remove(t,"paste",this.paste)},o.prototype.ribbonClickHandler=function(t){var e=this.parent.element.id;switch(t.item.id){case e+"_cut":this.cut({invokeCopy:!0});break;case e+"_copy":this.copy({invokeCopy:!0});break}we(this.parent.element)},o.prototype.tabSwitchHandler=function(t){t.activeTab===0&&!this.copiedInfo&&!this.copiedShapeInfo&&this.hidePaste()},o.prototype.cMenuBeforeOpenHandler=function(t){var e=this.parent.getActiveSheet(),i=this.parent.serviceLocator.getService(Ve),r=[],n=[],s=[],l=[],h=e.activeCell,c=(0,w.n53)(h),u=(0,w.$Su)(c[0],c[1],e),p=e.isProtected&&(0,w.p1d)(u,(0,w.wDo)(e,c[1]));(t.target==="Content"||t.target==="RowHeader"||t.target==="ColumnHeader"||t.target==="SelectAll")&&(this.parent.enableContextMenuItems([i.getConstant("Paste"),i.getConstant("PasteSpecial")],!!(this.copiedInfo||this.copiedShapeInfo&&!p)),this.parent.enableContextMenuItems([i.getConstant("Cut")],!p)),t.target==="Content"&&p&&this.parent.enableContextMenuItems([i.getConstant("Cut"),i.getConstant("Filter"),i.getConstant("Sort")],!1),t.target==="Content"&&p&&!e.protectSettings.insertLink&&this.parent.enableContextMenuItems([i.getConstant("Hyperlink")],!1),t.target==="ColumnHeader"&&e.isProtected&&(s=[i.getConstant("DeleteColumn"),i.getConstant("DeleteColumns"),i.getConstant("InsertColumn"),i.getConstant("InsertColumns")],l=[i.getConstant("HideColumn"),i.getConstant("HideColumns"),i.getConstant("UnHideColumns")],this.parent.enableContextMenuItems(s,!1),this.parent.enableContextMenuItems(l,!!e.protectSettings.formatColumns)),t.target==="RowHeader"&&e.isProtected&&(r=[i.getConstant("DeleteRow"),i.getConstant("DeleteRows"),i.getConstant("InsertRow"),i.getConstant("InsertRows")],n=[i.getConstant("HideRow"),i.getConstant("HideRows"),i.getConstant("UnHideRows")],this.parent.enableContextMenuItems(r,!1),this.parent.enableContextMenuItems(n,!!e.protectSettings.formatRows))},o.prototype.rowHeightChanged=function(t){if(this.copiedInfo){var e=this.getCopyIndicator();e&&(this.copiedInfo.range[0]>t.rowIdx?e.style.top=parseFloat(e.style.top)+t.threshold+"px":(0,w.Z2v)(this.copiedInfo.range,t.rowIdx,this.copiedInfo.range[1])&&(e.style.height=parseFloat(e.style.height)+t.threshold+"px"))}},o.prototype.colWidthChanged=function(t){if(this.copiedInfo){var e=this.getCopyIndicator();e&&(this.copiedInfo.range[1]>t.colIdx?e.style.left=parseFloat(e.style.left)+t.threshold+"px":(0,w.Z2v)(this.copiedInfo.range,this.copiedInfo.range[0],t.colIdx)&&(e.style.width=parseFloat(e.style.width)+t.threshold+"px"))}},o.prototype.cut=function(t){this.setCopiedInfo(t,!0)},o.prototype.copy=function(t){this.setCopiedInfo(t,!1)},o.prototype.paste=function(t){if(!(this.parent.isEdit||this.parent.element.getElementsByClassName("e-dlg-overlay").length>0)){var e,i=t&&t.clipboardData||window.clipboardData;if(!(i&&t.clipboardData&&t.clipboardData.getData("isInternalCut").length&&!this.copiedInfo))if(i||this.copiedShapeInfo||t.isInternal&&this.copiedInfo){t.isInternal=!i;var r=void 0,n=this.getCopiedIdx();t.isAction=!!i||t.isAction;var s=t&&t.sIdx>-1?t.sIdx:this.parent.activeSheetIndex,l=(0,w.zfV)(this.parent,s),h=(0,w.gaE)(t&&t.range||(0,w.dK5)(l.selectedRange)),c=i&&this.getExternalCells(t);if(!t.isInternal&&c&&c.internal&&(i=!1,!this.copiedInfo))return;if(i&&!c.length)if(c.file){this.parent.notify(E.rL,{file:c.file});return}else if(this.copiedInfo)i=!1;else return;var u=Object.assign({isExternal:i},this.copiedInfo),p=1;if(c)for(var f=0;f<c.length;f++)p=c[f].cells.length>p?c[f].cells.length:p;var g=h[0],C=i?[0,0,c.length-1,p-1]:(0,w.gaE)(this.copiedShapeInfo?(0,w.dK5)(l.selectedRange):this.copiedInfo.range),L=(h[2]-h[0]+1)%(C[2]-C[0]+1)==0&&(h[3]-h[1]+1)%(C[3]-C[1]+1)==0;e=L?h:[h[0],h[1]].concat([h[0]+C[2]-C[0],h[1]+C[3]-C[1]||h[1]]);var D={requestType:"paste",copiedInfo:this.copiedInfo,copiedRange:(0,w.i0K)(C),pastedRange:(0,w.i0K)(e),type:t&&t.type||"All",cancel:!1};if(t.isAction&&!this.copiedShapeInfo&&this.parent.notify(w.ya2,{eventArgs:D,action:"clipboard"}),D.cancel)return;var R=void 0,B=void 0,H=void 0,j=[],W=(0,w.zfV)(this.parent,i?s:n),ne=(0,w.hYl)(C)&&this.isRangeMerged(h,l);h=(0,w.dK5)(D.pastedRange),g=h[0],C=i?[0,0,c.length-1,p-1]:(0,w.gaE)(this.copiedShapeInfo?(0,w.dK5)(l.selectedRange):this.copiedInfo.range),L=(h[2]-h[0]+1)%(C[2]-C[0]+1)==0&&(h[3]-h[1]+1)%(C[3]-C[1]+1)==0&&!ne,e=L?h:[h[0],h[1]].concat([h[0]+C[2]-C[0],h[1]+C[3]-C[1]||h[1]]);var ie=l.isProtected&&ct(this.parent,e);if(ie){this.parent.notify(E.Gn,null);return}if(this.copiedShapeInfo&&!this.copiedInfo){var me=this.copiedShapeInfo.pictureElem;me.classList.contains("e-datavisualization-chart")?(this.copiedShapeInfo.chartInfo.top=null,this.copiedShapeInfo.chartInfo.left=null,this.parent.notify(w.UyC,{chart:[this.copiedShapeInfo.chartInfo],isInitCell:!0,isUndoRedo:!0,isPaste:!0,dataSheetIdx:this.copiedShapeInfo.sheetIdx,isCut:this.copiedShapeInfo.isCut,range:t.range||l.selectedRange,isIdAvailabe:!1})):this.parent.notify(E.oE,{options:{src:me.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:this.copiedShapeInfo.height,width:this.copiedShapeInfo.width,imageId:this.copiedShapeInfo.isCut?me.id:""},range:(0,w.i0K)([g,h[1],g,h[1]]),isPublic:!1,isUndoRedo:!0});var ve=(0,w.$Su)(g,h[1],l);if(ve&&!(0,a.le)(ve.image)){var Ee=ve.image?ve.image.length-1:0,le={requestType:"imagePaste",copiedShapeInfo:this.copiedShapeInfo,pasteSheetIndex:this.parent.activeSheetIndex,pastedRange:(0,w.Rao)(this.parent)+"!"+(0,w.i0K)([g,h[1],g,h[1]]),pastedPictureElement:document.getElementById(ve.image[Ee].id)};this.parent.notify(E.Av,{eventArgs:le,action:"clipboard"})}}else{var de={range:C,prevSheet:W,cancel:!1};if(this.parent.notify(w.Ice,de),de.cancel)return;var fe=D.type||t.type,Le=[],ke=this.isInRange(C,h,n),Me=h[1]===0&&h[3]===l.colCount-1,De=h[0]===0&&h[2]===l.rowCount-1,Fe=!1,Pe=!1,Ye=0;L||this.setCF(C,e,W,l);for(var Ze=void 0,nt=void 0,it=!1,et=[],f=C[0],at=0;f<=C[2];f++,at++){if(!i&&!u.isCut&&(0,w.wDH)(W,f)){at--,Ye++;continue}ke&&(Le[h[0]+at]={cells:[]});for(var Ge=C[1],gt=0;Ge<=C[3];Ge++,gt++){if(ke&&(Le[h[0]+at].cells[h[1]+gt]=(0,w.$Su)(h[0]+at,h[1]+gt,W,!1,!0)),R=i?c[f].cells[Ge]:(0,a.l7)({},ke&&Le[f]&&Le[f].cells[Ge]?Le[f].cells[Ge]:(0,w.$Su)(f,Ge,W),null,!0),Me||De){if(R&&R.rowSpan){if(R.rowSpan>0)R.rowSpan+f-1<=C[2]?Fe=!0:R={};else if(!Fe)R={};else if(R.rowSpan<0){var ge=R.rowSpan,xe=R.colSpan?R.colSpan:0,je=(0,w.$Su)(g+ge,h[1]+gt+xe,l);je&&!je.rowSpan&&(R={})}}R&&R.colSpan&&(R.colSpan>0?R.colSpan+Ge-1<=C[3]?Pe=!0:R={}:Pe||(R={}))}if(R&&t&&t.type||fe){switch(fe){case"Formats":R={format:R.format,style:R.style};break;case"Values":if(R={value:R.value},R.value&&R.value.toString().indexOf(`
`)>-1){var Je=this.parent.getCell(h[0],h[1]);Je.classList.add("e-alt-unwrap")}break}B=["Formats","Values"].indexOf(t.type||fe)>-1}if(!this.parent.scrollSettings.isFinite&&(C[2]-C[0]>1048575-h[0]||C[3]-C[1]>16383-h[1])||this.parent.scrollSettings.isFinite&&(C[2]-C[0]>l.rowCount-1-h[0]||C[3]-C[1]>l.colCount-1-h[1])){this.showDialog();return}if(L){for(var lt=h[0];lt<=h[2];lt+=C[2]-C[0]+1)if(!(!u.isCut&&!Ye&&(0,w.wDH)(l,lt+at)))for(var Qe=h[1];Qe<=h[3];Qe+=C[3]-C[1]+1){if(f===C[0]&&Ge===C[1]&&(Ze===void 0||Ze.length)&&(Ze=this.setCF(C,[lt,Qe,lt+(C[2]-C[0]),Qe+(C[3]-C[1])],W,l,Ze)),H=(0,w.$Su)(lt+at,Qe+gt,l,!1,!0),!i&&(H.colSpan!==void 0||H.rowSpan!==void 0)){if(Me||De)continue;de={range:[lt+at,Qe+gt,lt+at,Qe+gt]};var Bt={range:de.range,merge:!1,isAction:!1,type:"All"};j.push(Bt),this.parent.activeSheetIndex===l.index&&this.parent.notify(w.mtj,Bt)}var pi=Qe+gt;if(R=(0,a.l7)({},R||{},null,!0),!B&&this.copiedInfo&&!this.copiedInfo.isCut&&R.formula){var si=(0,w.flO)([lt+at,pi],[f,Ge],W,ke?R:null);(0,a.le)(si)||(R.formula=si)}l.isProtected&&R&&R.isLocked!==!1&&(R.isLocked=H.isLocked);var Gt={cellIdx:[f,Ge],isUnique:!1,uniqueRange:"",sheetName:W.name};this.parent.notify(w.Azt,Gt),Gt.isUnique&&(R.value=null),it=!1,R&&R.formula&&R.formula.indexOf("=UNIQUE(")>-1&&(it=!0,et.push([lt,pi]),R.value=null),nt=this.setCell(lt+at,pi,l,R,B,pi===h[3],!!i,!!(Ze&&Ze.length),it),!nt&&R.formula&&this.copiedInfo.isCut&&this.parent.notify(w.fdW,{cellRef:(0,w.i0K)([f,Ge,f,Ge])})}}else(i||!Xe(this.parent,f,Ge,n))&&(ne?this.setCell(g,h[1]+gt,l,{value:R.value},!0,Ge===C[3]):this.setCell(g,h[1]+gt,l,R,B,Ge===C[3]));if(!i&&this.copiedInfo.isCut&&!((0,w.Z2v)(h,f,Ge)&&n===this.parent.activeSheetIndex)){var Pi=(0,w.$Su)(f,Ge,W);if(Pi)if(Pi.isLocked||(0,a.le)(Pi.isLocked)){if((Me||De)&&(Pi.rowSpan!==void 0||Pi.colSpan!==void 0))continue;Pi=null}else Pi.isLocked===!1&&(W.isProtected?Pi={isLocked:!1}:Pi=null);this.setCell(f,Ge,W,Pi,!1,Ge===C[3])}}g++}if(et.length)for(var f=0;f<et.length;f++)this.parent.serviceLocator.getService("cell").refresh(et[f][0],et[f][1]);if(this.parent.notify(w.bUq,null),e[2]-=Ye,this.parent.setUsedRange(e[2],e[3]),s===this.parent.activeSheetIndex&&!t.isFromUpdateAction&&this.parent.notify(E.Y0,{address:(0,w.i0K)(e)}),!i&&this.copiedInfo.isCut&&(r=this.copiedInfo.isCut,n===this.parent.activeSheetIndex&&this.parent.serviceLocator.getService("cell").refreshRange(C),this.clearCopiedInfo()),(i||ke)&&this.copiedInfo&&this.clearCopiedInfo(),(i||t&&t.isAction)&&we(this.parent.element),r){Ze&&Ze.length&&fe!=="Values"&&this.parent.notify(w.G2p,{range:(0,w.i0K)(C),sheetIdx:i?s:n}),Ne(W,C[0],C[1],(this.parent.getRow(C[0],null,this.parent.frozenColCount(W))||{offsetHeight:20}).offsetHeight);var Gr=Te(W,C[0]);tt(this.parent,W,Gr,C[0])}var Kr=(0,w.zfV)(this.parent,n);if(!i&&C[0]===C[2]&&C[3]-C[1]==Kr.colCount-1){for(var Gr=Kr.rows[C[0]].height,f=h[0];f<=h[2];f++)tt(this.parent,this.parent.getActiveSheet(),Gr,f);r&&tt(this.parent,Kr,20,C[0])}if(t.isAction){var le={requestType:"paste",copiedInfo:u,mergeCollection:j,pasteSheetIndex:this.parent.activeSheetIndex,copiedRange:W.name+"!"+(u.range?(0,w.i0K)(u.range):W.selectedRange),pastedRange:l.name+"!"+(0,w.i0K)(e),type:fe||"All"};Ye&&(le.skipFilterCheck=!0),this.parent.notify(E.Av,{eventArgs:le,action:"clipboard"})}}}else this.getClipboardEle().select()}},o.prototype.setCF=function(t,e,i,r,n){var s,l,h=function(p){s=[e[0]+(l[0]<=t[0]?0:l[0]-t[0]),e[1]+(l[1]<=t[1]?0:l[1]-t[1]),e[2]-(l[2]>=t[2]?0:t[2]-l[2]),e[3]-(l[3]>=t[3]?0:t[3]-l[3])],r.conditionalFormats.push({range:(0,w.i0K)(s),type:p.type,cFColor:p.cFColor,value:p.value,format:p.format})};if(n)for(var c=0,u=n.length;c<u;c++)l=(0,w.dK5)(n[c].range),h(n[c]);else if(n=[],i.conditionalFormats)for(var c=0,u=i.conditionalFormats.length;c<u;c++)l=(0,w.dK5)(i.conditionalFormats[c].range),(l[0]>=t[0]&&l[0]<=t[2]||l[2]>=t[0]&&l[2]<=t[2])&&(l[1]>=t[1]&&l[1]<=t[3]||l[3]>=t[1]&&l[3]<=t[3])&&(n.push(i.conditionalFormats[c]),h(i.conditionalFormats[c]));return n},o.prototype.isRangeMerged=function(t,e){var i=(0,w.$Su)(t[0],t[1],e);if(i&&(i.colSpan>1||i.rowSpan>1)){var r={range:t.slice(2,4).concat(t.slice(2,4))};return this.parent.notify(w.Zf5,r),r.range[0]===t[0]&&r.range[1]===t[1]&&r.range[2]===t[2]&&r.range[3]===t[3]}return!1},o.prototype.updateFilter=function(t,e){var i,r;this.parent.notify(w.eM_,null);for(var n=0;n<this.parent.sheets.length;n++)if(this.parent.filterCollection&&this.parent.filterCollection[n]&&this.parent.filterCollection[n].sheetIndex===(0,w.PmP)(this.parent,t.sId)){var s=t.range,l=(0,w.dK5)(this.parent.filterCollection[n].filterRange);s=(0,w.gaE)(s),l[0]===s[0]&&l[2]===s[2]&&l[1]===s[1]&&l[3]===s[3]&&(i=!0,r=[Math.abs(s[0]-l[0]),Math.abs(s[1]-l[1]),Math.abs(s[2]-l[2]),Math.abs(s[3]-l[3])])}var h=this.parent.getCell(t.range[0],t.range[1]);h=h&&(h.querySelector(".e-filter-icon")?h:this.parent.getCell(t.range[2],t.range[3]));var c=h&&h.querySelector(".e-sortasc-filter"),u=h&&h.querySelector(".e-sortdesc-filter");if(i)for(var p=0;p<this.parent.filterCollection.length;p++){var f=this.parent.filterCollection[p],g=t&&t.sId?(0,w.PmP)(this.parent,t.sId):this.parent.activeSheetIndex;if(f.sheetIndex===g&&this.parent.notify(E.WG,{predicates:null,range:f.filterRange,sIdx:g,isCut:!0}),f.sheetIndex===g&&g===this.parent.activeSheetIndex&&(r=[e[0]+r[0],e[1]+r[1],Math.abs(e[2]-r[2]),Math.abs(e[3]-r[3])],this.parent.notify(E.WG,{predicates:null,range:(0,w.i0K)(r),sIdx:null,isCut:!0}),t.range[3]===t.range[1])){var C=this.parent.getCell(e[0],e[1]);c&&C&&C.querySelector(".e-filter-icon").classList.add("e-sortasc-filter"),u&&C&&C.querySelector(".e-filter-icon").classList.add("e-sortdesc-filter")}}},o.prototype.isInRange=function(t,e,i){var r=this.parent.activeSheetIndex;return(0,w.Z2v)(t,e[0],e[1])&&i===r||(0,w.Z2v)(t,e[2],e[3])&&i===r},o.prototype.setCell=function(t,e,i,r,n,s,l,h,c){var u=(0,w.wWT)(this.parent,i,{cell:r,rowIdx:t,colIdx:e,pvtExtend:!n,valChange:!c,lastCell:s,uiRefresh:i.name===this.parent.getActiveSheet().name,checkCf:h,requestType:"paste"});if(!u&&r&&r.style&&l){var p=ee(this.parent,t,e,i,r.style||this.parent.cellStyle,r.wrap?rt(this.parent.getDisplayText(r),ce(i,t,e),r.style,this.parent.cellStyle):1);p=Math.round(p),p<20&&(p=20),Ne(i,t,e,p);var f=(0,w.EB_)(i,t),g=Te(i,t),C=g>f;C&&tt(this.parent,i,g,t)}return u},o.prototype.getCopiedIdx=function(){if(this.copiedInfo){for(var t=0;t<this.parent.sheets.length;t++)if(this.parent.sheets[t].id===this.copiedInfo.sId)return t;this.clearCopiedInfo()}return-1},o.prototype.setCopiedInfo=function(t,e){var i=this;if(!this.parent.isEdit){var r=new Oe.B;t.promise=r.promise;var n=this.parent.getActiveSheet(),s;if(t&&t.range){var l=t.range[1]===0&&t.range[3]===n.colCount-1,h=t.range[0]===0&&t.range[2]===n.rowCount-1,c={range:t.range};l||h||this.parent.notify(w.aQp,c),s=c.range}else s=(0,w.dK5)(n.selectedRange);if(t&&!t.isPublic&&!t.clipboardData){var u={copiedRange:n.name+"!"+(0,w.i0K)(s),cancel:!1,action:e?"cut":"copy"};if(this.parent.notify(w.ya2,u),u.cancel)return}var p={sheet:n,indexes:[0,0,n.rowCount-1,n.colCount-1],isFinite:this.parent.scrollSettings.isFinite,promise:new Promise(function(C,L){C(function(){}())})},f=document.getElementsByClassName("e-ss-overlay-active"),g=f.length;n.isLocalData&&!(t&&t.clipboardData)&&s[0]===0&&s[2]===n.rowCount-1&&(this.parent.showSpinner(),this.parent.notify("updateSheetFromDataSource",p)),this.checkForUncalculatedFormula(s,t&&t.sId?t.sId:n.id),p.promise.then(function(){if(g>0){var C={clientY:f[0].offsetTop,isImage:!0};i.parent.notify(E.M7,C);var L={clientX:f[0].offsetLeft,isImage:!0};i.parent.notify(E.oU,L),i.copiedShapeInfo={sId:t&&t.sId?t.sId:n.id,sheetIdx:n.index,isCut:e,pictureElem:f[0],copiedRange:(0,w.i0K)([C.clientY,L.clientX,C.clientY,L.clientX]),height:f[0].offsetHeight,width:f[0].offsetWidth,chartInfo:i.getChartElemInfo(f[0])},i.hidePaste(!0),e&&(f[0].classList.contains("e-datavisualization-chart")?i.parent.deleteChart(i.copiedShapeInfo.chartInfo.id):i.parent.notify(E.ao,{id:i.copiedShapeInfo.pictureElem.id,sheetIdx:i.copiedShapeInfo.sId,range:i.copiedShapeInfo.copiedRange}))}else t&&t.clipboardData||(i.copiedInfo&&i.clearCopiedInfo(),i.copiedInfo={range:s,sId:t&&t.sId?t.sId:n.id,isCut:e},i.hidePaste(!0),t.isFromUpdateAction||i.initCopyIndicator(),a.AR.isIE||i.getClipboardEle().select(),t&&t.invokeCopy&&document.execCommand(e?"cut":"copy"),i.parent.hideSpinner());a.AR.isIE&&i.setExternalCells(t,e),r.resolve()}),t&&t.clipboardData&&(this.setExternalCells(t,e),we(this.parent.element))}},o.prototype.checkForUncalculatedFormula=function(t,e){for(var i,r=(0,w.PmP)(this.parent,e),n=(0,w.zfV)(this.parent,r),s=t[0];s<=t[2];s++)for(var l=t[1];l<=t[3];l++)i=(0,w.$Su)(s,l,n,null,!0),i.formula&&(0,a.o8)(i.value)&&this.parent.notify(w.B7N,{action:"refreshCalculate",value:i.formula,rowIndex:s,colIndex:l,isFormula:(0,w.C2M)(i.formula),sheetIndex:r})},o.prototype.getChartElemInfo=function(t){var e=this.parent.chartColl;if(t.classList.contains("e-datavisualization-chart")){for(var i=t.getElementsByClassName("e-control")[0].id,r=0;r<e.length;r++)if(e[r].id===i){var n=e[r];return n}}return null},o.prototype.clearCopiedInfo=function(){this.copiedInfo&&(this.parent.getActiveSheet().id===this.copiedInfo.sId&&(this.removeIndicator(this.parent.getSelectAllContent()),this.removeIndicator(this.parent.getColumnHeaderContent()),this.removeIndicator(this.parent.getRowHeaderContent()),this.removeIndicator(this.parent.getMainContent())),this.copiedInfo=null,this.hidePaste()),this.copiedShapeInfo&&(this.copiedShapeInfo=null,this.hidePaste())},o.prototype.removeIndicator=function(t){if(t){var e=t.getElementsByClassName("e-copy-indicator")[0];e&&(0,a.og)(e)}},o.prototype.initCopyIndicator=function(){if(this.copiedInfo&&this.parent.getActiveSheet().id===this.copiedInfo.sId){var t=this.parent.createElement("div",{className:"e-copy-indicator"});t.appendChild(this.parent.createElement("div",{className:"e-top"})),t.appendChild(this.parent.createElement("div",{className:"e-bottom"})),t.appendChild(this.parent.createElement("div",{className:"e-left"})),t.appendChild(this.parent.createElement("div",{className:"e-right"})),M(this.parent,t,this.copiedInfo.range,"e-copy-indicator")}},o.prototype.showDialog=function(){var t=this;this.parent.serviceLocator.getService(Yt).show({header:"Spreadsheet",target:this.parent.element,height:205,width:340,isModal:!0,showCloseIcon:!0,content:this.parent.serviceLocator.getService(Ve).getConstant("PasteAlert"),beforeOpen:function(e){var i={dialogName:"PasteDialog",element:e.element,target:e.target,cancel:e.cancel};t.parent.trigger("dialogBeforeOpen",i),i.cancel&&(e.cancel=!0)}})},o.prototype.hidePaste=function(t){this.parent.getActiveSheet().isProtected&&(t=!1),this.parent.notify(E.y3,[{items:[this.parent.element.id+"_paste"],enable:t||!1}])},o.prototype.setExternalCells=function(t,e){for(var i,r,n="",s=(0,w.gaE)(this.copiedInfo.range),l=this.parent.getActiveSheet(),h='<html><body><table class="e-spreadsheet" xmlns="http://www.w3.org/1999/xhtml"><tbody>',c=s[0];c<=s[2];c++)if(!(!e&&(0,w.wDH)(l,c))){h+="<tr>";for(var u=s[1];u<=s[3];u++)if(i=(0,w.$Su)(c,u,l,!1,!0),!(i.colSpan<0||i.rowSpan<0)){if(h+="<td",i.colSpan&&(h+=' colspan="'+i.colSpan+'"'),i.rowSpan&&(h+=' rowspan="'+i.rowSpan+'"'),h+=' style="white-space:'+(i.wrap?"normal":"nowrap")+";vertical-align:bottom;",i.style&&Object.keys(i.style).forEach(function(f){var g=f.match(/[A-Z]/);h+=(f==="backgroundColor"?"background":g?f.replace(g[0],"-"+g[0].toLowerCase()):f)+":"+(f==="backgroundColor"||f==="color"?i.style[f].slice(0,7):i.style[f])+";"}),h+='"',(0,a.le)(i.value))h+="></td>";else{if(r=i.value,i.format&&i.format!=="General"){h+=i.value.toString().includes('"')?" cell-value='"+r+"'":' cell-value="'+i.value+'"';var p={formattedText:r,value:r,format:i.format,onLoad:!0,cell:i,rowIndex:c,colIndex:u};this.parent.notify(w.eYQ,p),r=p.formattedText}h+=">",h+=r,n+=r,h+="</td>"}n+=u===s[3]?"":"	"}h+="</tr>",n+=c===s[2]?"":`
`}h+="</tbody></table></body></html>",a.AR.isIE?(window.clipboardData.setData("text",n),e&&window.clipboardData.setData("isInternalCut",n)):(t.clipboardData.setData("text/html",h),t.clipboardData.setData("text/plain",n),e&&t.clipboardData.setData("isInternalCut",n),t.preventDefault())},o.prototype.getExternalCells=function(t){var e=this,i,r,n=[],s=this.parent.createElement("span");if(a.AR.isIE?r=window.clipboardData.getData("text"):(i=t.clipboardData.getData("text/html"),r=t.clipboardData.getData("text/plain"),s.innerHTML=i),s.querySelector("table")){var l=!1;if(this.copiedInfo&&!this.copiedInfo.isCut){var h=this.parent.filterCollection;if(h)for(var c=0;c<h.length;c++){var u=(0,w.dK5)(h[c].filterRange),p=this.copiedInfo.range;if(u[0]===p[0]&&u[1]===p[1]&&u[2]===p[2]&&u[3]===p[3]){l=!0;break}}}s.querySelector(".e-spreadsheet")&&this.copiedInfo&&!l?n={internal:!0}:this.generateCells(s,n)}else if(s.querySelector("img")){var f=s.querySelector("img");this.parent.notify(E.oE,{options:{src:f.src,height:f.height,width:f.width},isPublic:!0})}else if(r){var g=[],C,L,D;i&&(L=[].slice.call(s.children)),r.split(`
`).forEach(function(R){C=null,i&&(D=L.filter(function(B){return B.textContent&&B.textContent.replace(/(\r\n|\n|\r|\s)/gm," ").trim()===R.trim()})[0],D&&(C=e.getStyle(D,s),L.splice(L.indexOf(D),1))),R.split("	").forEach(function(B,H){(B||C)&&(g[H]={},C&&(C.whiteSpace&&C.whiteSpace!=="nowrap"?(g[H].wrap=!0,delete C.whiteSpace,Object.keys(C).length&&(g[H].style=C)):g[H].style=C),B&&((0,w.C2M)(B)?g[H].formula=B:g[H].value=(0,w.MpA)(B.trim())))}),n.push({cells:g}),g=[]})}else if(t.clipboardData.types.length===1&&t.clipboardData.types[0]==="Files"&&t.clipboardData.files[0]&&t.clipboardData.files[0].type.includes("image"))return{file:t.clipboardData.files[0]};return setTimeout(function(){e.getClipboardEle().innerHTML=""},0),n},o.prototype.generateCells=function(t,e){var i=this,r=t.querySelector("table"),n=[],s,l=0,h;[].slice.call(r.rows||[]).forEach(function(c){e[l]||(e[l]={cells:[]}),n=e[l].cells,h=0,[].slice.call(c.cells||[]).forEach(function(u){if(n[h]&&(h=i.getNewIndex(n,h)),n[h]={},s=i.getStyle(u,t),u.textContent=u.textContent.replace(/(\r\n|\n|\r)/gm,""),u.textContent=u.textContent.replace(/\s+/g," "),s.whiteSpace&&s.whiteSpace!=="nowrap"&&(n[h].wrap=!0,delete s.whiteSpace),Object.keys(s).length&&(s.border&&(["borderBottom","borderTop","borderLeft","borderRight"].forEach(function(D){s[D]=s.border}),delete s.border),n[h].style=s),u.textContent&&(n[h].value=(0,w.MpA)(u.textContent.trim())),u.getAttribute("number-format")&&(n[h].format=u.getAttribute("number-format"),n[h].value&&u.getAttribute("cell-value")&&(n[h].value=(0,w.MpA)(u.getAttribute("cell-value").trim()))),u.getAttribute("colspan")&&parseInt(u.getAttribute("colspan"),10)>1&&(n[h].colSpan=parseInt(u.getAttribute("colspan"),10)),u.getAttribute("rowspan")&&parseInt(u.getAttribute("rowspan"),10)>1&&(n[h].rowSpan=parseInt(u.getAttribute("rowspan"),10)),n[h].colSpan>1&&n[h].rowSpan>1)for(var p=void 0,f=l,g=l+n[h].rowSpan;f<g;f++)for(var C=h,L=h+n[h].colSpan;C<L;C++)f===l&&C===h||(p=n[h].style?{style:(0,a.l7)({},n[h].style)}:{},f!==l&&(p.rowSpan=l-f),C!==h&&(p.colSpan=h-C),e[f]||(e[f]={cells:[]}),e[f].cells[C]=p);else if(n[h].colSpan>1)for(var f=h+1,g=h+n[h].colSpan;f<g;f++)n[f]={colSpan:h-f,style:(0,a.l7)({},s)};else if(n[h].rowSpan>1)for(var f=l+1,g=l+n[h].rowSpan;f<g;f++)e[f]||(e[f]={cells:[]}),e[f].cells[h]={rowSpan:l-f,style:(0,a.l7)({},s)};h++}),l++})},o.prototype.getNewIndex=function(t,e){return t[e]&&(e++,e=this.getNewIndex(t,e)),e},o.prototype.getStyle=function(t,e){var i=[],r={},n=Object.keys(this.parent.commonCellStyle);if(e.querySelector("style")&&t.classList.length&&e.querySelector("style").innerHTML.indexOf(t.classList[0])>-1){var s=e.querySelector("style").innerHTML.split(t.classList[0]);i.push(s[s.length-1].split("{")[1].split("}")[0])}var l=[].slice.call(t.querySelectorAll("*"));if(l.unshift(t),l.forEach(function(W){W.getAttribute("style")&&i.push(W.getAttribute("style")),W.tagName==="B"&&i.push("font-weight:bold"),W.tagName==="I"&&i.push("font-style:italic"),W.tagName==="U"&&i.push("text-decoration:underline")}),n.length&&e.querySelector("style")){var h=e.querySelector("style").innerHTML.includes("td")?e.querySelector("style").innerHTML.split("td")[1]:e.querySelector("style").innerHTML;h=h.includes("{")?h.split("{")[1].split("}")[0]:h.split("}")[0];for(var c=0;c<n.length;c++){var u=n[c],p=u.match(/[A-Z]/);p&&(u=u.replace(p[0],"-"+p[0].toLowerCase())),h.indexOf(u)>-1&&(r[n[c]]=h.split(u+":")[1].split(";")[0].trim())}}if(i.length){var f,g,C,L,D,R=["font-family","vertical-align","text-align","text-indent","color","white-space","font-weight","font-style","font-size","text-decoration","background"],B=["fontFamily","verticalAlign","textAlign","textIndent","color","whiteSpace","fontWeight","fontStyle","fontSize","textDecoration","backgroundColor"],H=["border-bottom","border-top","border-right","border-left","border"],j=["borderBottom","borderTop","borderRight","borderLeft","border"];i.forEach(function(W){W.split(";").forEach(function(ne){if(g=ne.split(":")[0].trim(),f=R.indexOf(g),f>-1)g=ne.split(":")[1].trim(),r[B[f]]=g;else if(f=H.indexOf(g),f>-1){if(g=ne.split(":")[1].trim(),g==="none")g=void 0;else if(g.includes("pt")){C=g.split("pt"),L=C[0].split(" ");for(var ie=0;ie<L.length;ie++)if(D=parseFloat(L[ie]),D){L.splice(ie,1),L.unshift((D/.75).toFixed(2)+"px"),C[0]=L.join(" ");break}g=C.join("")}r[j[f]]=g}})})}return t.querySelector("S")&&(r.textDecoration=r.textDecoration?"underline line-through":"line-through"),r.textDecoration&&["underline","line-through","underline line-through","none"].indexOf(r.textDecoration)===-1&&(r.textDecoration="none"),r.textAlign&&["left","center","right"].indexOf(r.textAlign)===-1&&(r.textAlign="left"),r.verticalAlign&&["bottom","middle","top"].indexOf(r.verticalAlign)===-1&&(r.verticalAlign="bottom"),r.fontSize&&(r.fontSize=Math.round(parseFloat(r.fontSize.indexOf("px")>-1?(parseFloat(r.fontSize)*.75).toString():r.fontSize))+"pt"),r.fontWeight&&["bold","normal"].indexOf(r.fontWeight)===-1&&(r.fontWeight=r.fontWeight>"599"?"bold":"normal"),r},o.prototype.refreshOnInsertDelete=function(t){if(this.copiedInfo){if(t.model.id!==this.copiedInfo.sId)return;var e=this.copiedInfo.range;if(t.isInsert){if(t.modelType==="Column"){if(t.start<=e[3]){if(t.start<=e[1]){var i=t.end-t.start+1;e[1]+=i,e[3]+=i}else e[3]=e[1]+(t.start-e[1]-1);this.performAction()}}else if(t.start<=e[2]){if(t.start<=e[0]){var i=t.end-t.start+1;e[0]+=i,e[2]+=i}else e[2]=e[1]+(t.start-e[1]-1);this.performAction()}}else this.clearCopiedInfo()}},o.prototype.performAction=function(){var t=this.getCopyIndicator();t&&M(this.parent,t,this.copiedInfo.range,"e-copy-indicator")},o.prototype.getClipboardEle=function(){return this.parent.element.getElementsByClassName("e-clipboard")[0]},o.prototype.getCopyIndicator=function(){return this.parent.element.getElementsByClassName("e-copy-indicator")[0]},o.prototype.getModuleName=function(){return"clipboard"},o.prototype.destroy=function(){this.removeEventListener();var t=this.getClipboardEle();(0,a.og)(t),this.parent=null},o}(),Ke=ae(41447),ot=ae(80788),He=ae(91997),Ci=function(){function o(t){this.editorElem=null,this.editCellData={},this.isEdit=!1,this.isCellEdit=!0,this.isNewValueEdit=!0,this.isAltEnter=!1,this.validCharacters=["+","-","*","/",",","(","=","&"],this.formulaBarCurStartPos=null,this.curEndPos=null,this.curStartPos=null,this.selectionStart=null,this.selectionEnd=null,this.uniqueColl="",this.uniqueActCell="",this.isSpill=!1,this.keyCodes={BACKSPACE:8,SPACE:32,TAB:9,DELETE:46,ESC:27,ENTER:13,FIRSTALPHABET:65,LASTALPHABET:90,FIRSTNUMBER:48,LASTNUMBER:59,FIRSTNUMPAD:96,LASTNUMPAD:111,SYMBOLSETONESTART:186,SYMBOLSETONEEND:192,SYMBOLSETTWOSTART:219,SYMBOLSETTWOEND:222,FIREFOXEQUALPLUS:61,FIREFOXMINUS:173,F2:113},this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.isEdit&&this.cancelEdit(!0,!1),this.removeEventListener(),this.parent=null,this.editorElem=null},o.prototype.addEventListener=function(){a.bi.add(this.parent.element,"dblclick",this.dblClickHandler,this),this.parent.on(E.uG,this.mouseDownHandler,this),this.parent.on(E.yR,this.keyUpHandler,this),this.parent.on(E.SH,this.keyDownHandler,this),this.parent.on(E.vJ,this.performEditOperation,this),this.parent.on(E.jI,this.initiateCurPosition,this),this.parent.on(E.PA,this.updateFormulaBarValue,this),this.parent.on(E.R,this.addressHandler,this),this.parent.on(E.aW,this.initiateRefSelection,this),this.parent.on(E.UD,this.refSelectionRender,this),this.parent.on(ot.Az,this.checkUniqueRange,this),this.parent.on(ot.C4,this.reApplyFormula,this),this.parent.on(E.Z,this.sheetChangeHandler,this)},o.prototype.removeEventListener=function(){a.bi.remove(this.parent.element,"dblclick",this.dblClickHandler),this.parent.isDestroyed||(this.parent.off(E.uG,this.mouseDownHandler),this.parent.off(E.yR,this.keyUpHandler),this.parent.off(E.SH,this.keyDownHandler),this.parent.off(E.vJ,this.performEditOperation),this.parent.off(E.jI,this.initiateCurPosition),this.parent.off(E.PA,this.updateFormulaBarValue),this.parent.off(E.R,this.addressHandler),this.parent.off(E.aW,this.initiateRefSelection),this.parent.off(E.UD,this.refSelectionRender),this.parent.off(ot.Az,this.checkUniqueRange),this.parent.off(ot.C4,this.reApplyFormula),this.parent.off(E.Z,this.sheetChangeHandler))},o.prototype.getModuleName=function(){return"edit"},o.prototype.performEditOperation=function(t){var e=t.action;switch(e){case"renderEditor":this.renderEditor();break;case"refreshEditor":this.refreshEditor(t.value,t.refreshFormulaBar,t.refreshEditorElem,t.isAppend,t.trigEvent),t.refreshCurPos&&this.setCursorPosition();break;case"startEdit":if(!this.isEdit)this.isNewValueEdit=t.isNewValueEdit,this.startEdit(t.address,t.value,t.refreshCurPos);else{var i=!1,r={isEdit:i};this.parent.notify(E.UM,r),r.isEdit&&(this.isNewValueEdit=t.isNewValueEdit,this.startEdit(t.address,t.value,t.refreshCurPos))}break;case"endEdit":this.isEdit&&this.endEdit(t.refreshFormulaBar);break;case"cancelEdit":this.isEdit&&this.cancelEdit(t.refreshFormulaBar);break;case"getCurrentEditValue":t.editedValue=this.editCellData.value,t.endFormulaRef!==void 0&&(t.endFormulaRef=this.endFormulaRef);break;case"refreshDependentCellValue":this.refreshDependentCellValue(t.rowIdx,t.colIdx,t.sheetIdx);break;case"getElement":t.element=this.getEditElement(this.parent.getActiveSheet());break;case"focusEditorElem":this.editorElem.focus();break;case"getCurrentEditSheetIdx":t.sheetIndex=this.editCellData.sheetIndex;break}},o.prototype.keyUpHandler=function(t){if(this.isEdit){var e=this.getEditElement(this.parent.getActiveSheet());t.altKey&&t.keyCode===13?(e.focus(),this.altEnter(),this.isAltEnter=!0):this.isCellEdit&&this.editCellData.value!==e.textContent&&t.keyCode!==16&&this.refreshEditor(e.textContent,this.isCellEdit);var i=(0,w.C2M)(this.editCellData.value,!0);if(i&&(!t||t.keyCode!==16)&&(this.updateFormulaReference(e),this.endFormulaRef)){var r=this.getCurPosition();r.end&&this.validCharacters.indexOf(this.editCellData.value[r.end-1])>-1&&(this.endFormulaRef=!1)}}},o.prototype.updateFormulaReference=function(t){var e=this.parent.element.querySelector(".e-formularef-indicator");e&&e.parentElement.removeChild(e),this.editCellData.value!==t.textContent&&this.refreshEditor(t.textContent,!0);var i=this.editCellData.sheetIndex,r=this.editCellData.value;this.parent.notify(E.BF,{range:r,formulaSheetIdx:i})},o.prototype.keyDownHandler=function(t){var e=t.target,i=t.keyCode,r=this.parent.getActiveSheet(),n=(0,w.n53)(r.activeCell),s=(0,He.$S)(n[0],n[1],r)||{};if(!(0,a.oq)(t.target,".e-findtool-dlg")&&!(0,a.oq)(t.target,".e-validationerror-dlg")&&!(0,a.oq)(t.target,".e-hyperlink-dlg")){if(!r.isProtected||(0,a.oq)(t.target,".e-sheet-rename")||!(0,w.p1d)(s,(0,He.wD)(r,n[1]))){if(this.isEdit){var l=this.getEditElement(r),h=(0,w.C2M)(this.editCellData.value,!0);if((this.isCellEdit||h&&this.editCellData.value!==l.textContent&&t.keyCode!==16)&&(n[1]<this.parent.frozenColCount(r)&&(!r.frozenRows||n[0]>=this.parent.frozenRowCount(r))&&l&&l.style.height!=="auto"&&ht(l.textContent,s.style,this.parent.cellStyle)>parseInt(l.style.maxWidth,10)&&(l.style.height="auto"),ht(l.textContent,s.style,this.parent.cellStyle)>parseInt(l.style.maxWidth,10)-5&&(l.style.height="auto"),n[0]<this.parent.frozenRowCount(r)&&l&&!l.style.overflow&&ht(l.textContent,s.style,this.parent.cellStyle)>parseInt(l.style.maxWidth,10)&&(l.style.overflow="auto"),this.refreshEditor(l.textContent,this.isCellEdit,!1,!1,!1)),!t.altKey)switch(i){case this.keyCodes.ENTER:if(a.AR.isWindows&&t.preventDefault(),this.isAltEnter){var c=l.textContent;c&&c.indexOf(`
`)>-1&&((0,w.reQ)(this.parent.getActiveSheet().selectedRange,!0,this.parent,!0),this.refreshEditor(l.textContent,this.isCellEdit,!1,!1,!1),this.isAltEnter=!1)}if(!h)this.endEdit(!1,t);else{var u=this.parent.element.querySelector(".e-formularef-indicator");u&&u.parentElement.removeChild(u),this.editCellData.sheetIndex===r.id-1?this.endEdit(!1,t):(this.parent.goTo(this.editCellData.fullAddr),this.endEdit(!1,t))}break;case this.keyCodes.TAB:this.hasFormulaSuggSelected()||this.endEdit(!1,t);break;case this.keyCodes.ESC:this.cancelEdit(!0,!0,t);break}}else if(!this.isEdit&&(e.classList.contains("e-spreadsheet")||(0,a.oq)(e,".e-sheet-panel"))){var p=i>=this.keyCodes.FIRSTALPHABET&&i<=this.keyCodes.LASTALPHABET,f=i>=this.keyCodes.FIRSTNUMBER&&i<=this.keyCodes.LASTNUMBER,g=i>=this.keyCodes.FIRSTNUMPAD&&i<=this.keyCodes.LASTNUMPAD,C=i>=this.keyCodes.SYMBOLSETONESTART&&i<=this.keyCodes.SYMBOLSETONEEND;C||(C=i>=this.keyCodes.SYMBOLSETTWOSTART&&i<=this.keyCodes.SYMBOLSETTWOEND);var L=i===this.keyCodes.FIREFOXEQUALPLUS||i===this.keyCodes.FIREFOXMINUS,D=!t.shiftKey&&!t.ctrlKey&&!t.metaKey&&i===this.keyCodes.F2,R=i===this.keyCodes.BACKSPACE;if(!t.ctrlKey&&!t.metaKey&&!t.altKey&&(!t.shiftKey&&i===this.keyCodes.SPACE||p||f||g||C||a.AR.info.name==="mozilla"&&L)||D||R){D&&(this.isNewValueEdit=!1);var B=document.getElementsByClassName("e-ss-overlay-active"),H=B.length;H>0?i===this.keyCodes.DELETE&&this.parent.notify(E.ao,{id:B[0].id,sheetIdx:this.parent.activeSheetIndex+1}):this.startEdit(null,null,!0,!0)}if(i===this.keyCodes.DELETE){var j=r.isProtected&&ct(this.parent);j?this.parent.notify(E.Gn,null):(this.editingHandler("delete"),this.parent.notify(ot.q6,null))}}}else if((i>=this.keyCodes.FIRSTALPHABET&&i<=this.keyCodes.LASTALPHABET||i>=this.keyCodes.FIRSTNUMBER&&i<=this.keyCodes.LASTNUMBER||i===this.keyCodes.DELETE||i===this.keyCodes.BACKSPACE||i===this.keyCodes.SPACE||i>=this.keyCodes.FIRSTNUMPAD&&i<=this.keyCodes.LASTNUMPAD||i>=this.keyCodes.SYMBOLSETONESTART&&i<=this.keyCodes.SYMBOLSETONEEND||i>=219&&i<=222||!t.shiftKey&&!t.ctrlKey&&!t.metaKey&&i===this.keyCodes.F2)&&i!==67&&i!==89&&i!==90){if(r.protectSettings.insertLink&&i===75)return;!this.parent.element.querySelector(".e-editAlert-dlg")&&!t.ctrlKey&&t.keyCode!==70&&!e.parentElement.classList.contains("e-unprotectpwd-content")&&!e.parentElement.classList.contains("e-password-content")&&!e.parentElement.classList.contains("e-sheet-password-content")&&!e.parentElement.classList.contains("e-unprotectsheetpwd-content")&&!e.parentElement.classList.contains("e-reenterpwd-content")&&this.parent.notify(E.Gn,null)}}},o.prototype.renderEditor=function(){if(!this.editorElem||!(0,a.Ys)("#"+this.parent.element.id+"_edit",this.parent.element)){var t=this.parent.createElement("div",{id:this.parent.element.id+"_edit",className:"e-spreadsheet-edit"});t.contentEditable="true",t.spellcheck=!1,this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0]&&this.parent.element.getElementsByClassName("e-spreadsheet-edit")[0].remove();var e=this.parent.element.querySelector(".e-sheet-content");if(!e)return;e.appendChild(t),this.editorElem=t}this.parent.notify(E.Sn,{action:"renderAutoComplete"})},o.prototype.refreshEditor=function(t,e,i,r,n){n===void 0&&(n=!0),r?t=this.editCellData.value=this.editCellData.value+t:this.editCellData.value=t;var s=this.getEditElement(this.parent.getActiveSheet());i&&s&&(s.textContent=t),e&&this.parent.notify(E.GN,{action:"refreshFormulabar",value:t}),this.parent.isEdit&&s&&n&&this.editCellData.value===s.textContent&&this.triggerEvent("cellEditing").cancel&&this.cancelEdit()},o.prototype.startEdit=function(t,e,i,r){i===void 0&&(i=!0),this.parent.showSheetTabs&&this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true");var n=this.parent.getActiveSheet(),s=(0,w.n53)(n.activeCell),l=(0,He.$S)(s[0],s[1],n,!1,!0);if(Xe(this.parent,s[0],s[1],this.parent.activeSheetIndex)){var h=this.parent.getCell(s[0],s[1]),c=!1,u=h.innerHTML;if(h&&u.indexOf("<")>-1&&u.indexOf(">")>-1&&u.indexOf("input")>-1&&(c=!0),c)return}this.updateEditCellDetail(t,e),this.initiateEditor(i),this.positionEditor(),this.parent.isEdit=this.isEdit=!0,this.parent.notify(E.EP,null),this.parent.notify(E.y3,[{enable:!1}]),l.formula&&!r&&this.parent.notify(E.BF,{range:l.formula,formulaSheetIdx:this.editCellData.sheetIndex})},o.prototype.setCursorPosition=function(){var t=this.getEditElement(this.parent.getActiveSheet()),e=t.textContent.length;if(e){var i=document.getSelection(),r=document.createRange();r.setStart(t.firstChild,e),r.collapse(!0),i.removeAllRanges(),i.addRange(r)}t.focus()},o.prototype.hasFormulaSuggSelected=function(){var t=document.getElementById(this.parent.element.id+"_ac_popup");return t&&t.style.visibility==="visible"&&t.querySelectorAll(".e-item-focus").length>0},o.prototype.editingHandler=function(t){var e=document.getElementsByClassName("e-ss-overlay-active"),i=e.length,r;switch(t){case"delete":if(i>0)e[0].classList.contains("e-datavisualization-chart")?this.parent.notify(E.k0,{id:e[0].id,sheetIdx:this.parent.activeSheetIndex+1}):this.parent.notify(E.ao,{id:e[0].id,sheetIdx:this.parent.activeSheetIndex+1});else{var n=this.parent.getActiveSheet(),s=n.selectedRange,l=(0,Ke.IR)(s);l=l[0]>l[2]?(0,w.gaE)(l):l,s=(0,Ke.i0)(l);var h={address:n.name+"!"+s,cancel:!1};if(this.parent.notify(w.ya2,{action:"cellDelete",eventArgs:h}),h.cancel)return;s=(0,Ke.VB)(h.address),l=(0,Ke.dK)(s),vt(this.parent,l,this.parent.activeSheetIndex),this.parent.notify(w.Pmi,{}),l[0]===0&&l[1]===0&&l[2]>=n.usedRange.rowIndex&&l[3]>=n.usedRange.colIndex&&this.parent.setUsedRange(0,0,n,!1,!0);var c={cellIdx:l,isUnique:!1};if(this.checkUniqueRange(c),c.isUnique){var u=(0,Ke.dK)(this.uniqueColl),p=(0,He.$S)(u[0],u[1],this.parent.getActiveSheet());p&&(r=p.value.toString().indexOf("#SPILL!")>-1)}if(c.isUnique&&this.uniqueColl.split(":")[0]===s.split(":")[0]){for(var f=(0,Ke.dK)(this.uniqueColl),g=f[0];g<=f[2];g++)for(var C=f[1];C<=f[3];C++)this.parent.updateCell({value:"",formula:""},(0,Ke.i0)([g,C]));this.parent.notify(ot.wU,null),this.uniqueColl=""}else if(c.isUnique){var L=(0,Ke.dK)(this.uniqueColl);if((0,He.$S)(L[0],L[1],n).value==="#SPILL!"){for(var D=!1,C=L[0];C<=L[2];C++)for(var R=L[1];R<=L[3];R++){var p=(0,He.$S)(C,R,n);C===L[0]&&R===L[1]?D=!1:!(0,a.le)(p.value)&&p.value!==""&&(D=!0)}D||this.reApplyFormula()}}c.isUnique?this.parent.notify(E.Av,{action:"cellDelete",eventArgs:{address:n.name+"!"+s,isSpill:r}}):this.parent.notify(E.Av,{action:"cellDelete",eventArgs:{address:n.name+"!"+s}})}break}},o.prototype.getCurPosition=function(){var t={},e=window.getSelection();if(this.editorElem.textContent===this.editCellData.value&&(t.start=e.anchorOffset,t.end=e.focusOffset,t.start>t.end)){var i=t.start;t.start=t.end,t.end=i}if(e&&e.focusNode&&e.focusNode.classList&&e.focusNode.classList.contains("e-formula-bar-panel")&&this.editorElem.textContent===this.editCellData.value){var r=e.focusNode.getElementsByClassName("e-formula-bar e-css")[0];t.start=r.selectionStart,t.end=r.selectionEnd}return t},o.prototype.mouseDownHandler=function(t){if(!(0,a.oq)(t.target,".e-findtool-dlg")&&this.isEdit){var e=this.getCurPosition();e.start&&(this.curStartPos=this.selectionStart=e.start),e.end&&(this.curEndPos=this.selectionEnd=e.end);var i=t.target,r=this.parent.getActiveSheet(),n=this.parent.element.querySelector(".e-formularef-indicator");this.isCellEdit=i.classList.contains("e-spreadsheet-edit");var s=(0,w.C2M)(this.editCellData.value,!0),l=this.getEditElement(r);if(i.classList.contains("e-cell")||i.classList.contains("e-header-cell")||i.classList.contains("e-selectall")||(0,a.oq)(i,".e-toolbar-item.e-active")||(0,a.oq)(i,".e-table")){if(this.isAltEnter){var h=l.textContent;h&&h.indexOf(`
`)>-1&&(this.isAltEnter=!1,(0,w.reQ)(this.parent.getActiveSheet().selectedRange,!0,this.parent),this.refreshEditor(l.textContent,this.isCellEdit))}if(!s||this.endFormulaRef)this.endFormulaRef=!1,this.endEdit(!1,t);else{var c=this.selectionEnd,u=(0,w.n53)(r.activeCell),p=(0,He.$S)(u[0],u[1],r);if(this.selectionStart!==this.selectionEnd&&this.editCellData.value===l.textContent&&this.validCharacters.indexOf(l.textContent.substring(this.selectionStart-1,this.selectionStart))!==-1&&(0,w.qhV)(l.textContent.substring(this.selectionStart,this.selectionEnd))&&l.textContent.indexOf(":")!==this.selectionEnd&&(this.editCellData.value=l.textContent.substring(0,this.selectionStart)+l.textContent.substring(this.selectionEnd,l.textContent.length)),this.editCellData.value===l.textContent&&l.textContent.indexOf("(")!==l.textContent.length-1&&l.textContent.indexOf("(")!==-1&&this.selectionStart===this.selectionEnd){if(this.editCellData.sheetIndex!==(0,He.Q8)(this.parent,r.name)){var f=this.parent.element.querySelector(".e-formula-bar");if(l.textContent.substring(f.selectionEnd-1,f.selectionEnd)!==","&&!t.shiftKey){n&&n.parentElement.removeChild(n),this.parent.goTo(this.editCellData.fullAddr),this.endEdit(!1,t);return}}else if(this.validCharacters.indexOf(l.textContent.substring(c-1,c))===-1){n&&n.parentElement.removeChild(n),this.endEdit(!1,t);return}}if(!p)return;if(s=p.formula?(0,w.C2M)((0,He.$S)(u[0],u[1],r).formula)||this.editCellData.value&&this.editCellData.value.toString().indexOf("=")===0:!1,s&&this.parent.isEdit){var g=this.selectionEnd;this.editCellData.value.length===g?(this.editCellData.value.substring(this.editCellData.value.length-1)===")"||(0,w.hj$)(this.editCellData.value.substring(this.editCellData.value.length-1)))&&(n&&n.parentElement.removeChild(n),this.endEdit(!1,t)):this.editCellData.value===l.textContent&&(this.validCharacters.indexOf((this.editCellData.value+r.selectedRange).substring(g-1,g))===-1?(n&&n.parentElement.removeChild(n),this.endEdit(!1,t)):(this.validCharacters.indexOf(l.textContent.substring(g-1,g))===-1||l.textContent.substring(g,g+1)!==")"&&this.validCharacters.indexOf(l.textContent.substring(g,g+1))===-1)&&(n&&n.parentElement.removeChild(n),this.endEdit(!1,t)))}}}else if(s&&this.editCellData.value===l.textContent&&l.textContent.indexOf("(")!==l.textContent.length-1&&!this.isCellEdit&&this.validCharacters.indexOf(this.editCellData.value.substring(this.selectionStart-1,this.selectionStart))===-1&&this.editCellData.sheetIndex===r.id-1){var c=window.getSelection().focusOffset;if(this.validCharacters.indexOf(l.textContent.substring(c-1,c))===-1){n&&n.parentElement.removeChild(n),this.parent.goTo(this.editCellData.fullAddr),this.isEdit&&this.endEdit(!1,t);return}}}},o.prototype.dblClickHandler=function(t){var e=t.target,i=this.parent.getActiveSheet(),r=(0,w.n53)(i.activeCell),n=(0,He.$S)(r[0],r[1],i)||{};if(!(0,a.oq)(e,".e-datavisualization-chart"))if(!i.isProtected||!(0,w.p1d)(n,(0,He.wD)(i,r[1]))){if(e.className.indexOf("e-ss-overlay")<0&&(e.classList.contains("e-active-cell")||e.classList.contains("e-cell")||(0,a.oq)(e,".e-sheet-content")||e.classList.contains("e-table")))if(this.isEdit)if((0,w.C2M)(this.editCellData.value)){var s=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.indexOf("!"));this.parent.getActiveSheet().name===s&&this.endEdit()}else e.className.indexOf("e-spreadsheet-edit")<0&&this.endEdit();else this.isNewValueEdit=!1,this.startEdit()}else(e.classList.contains("e-active-cell")||e.classList.contains("e-cell"))&&this.parent.notify(E.Gn,null)},o.prototype.updateEditCellDetail=function(t,e){var i,r;if((0,a.le)(this.editCellData.sheetIndex)?t&&t.split("!").length>1?i=(0,He.Q8)(this.parent,(0,w.HAf)(t)):i=this.parent.activeSheetIndex:i=this.editCellData.sheetIndex,this.editCellData.addr?(0,w.C2M)(this.editCellData.value,!0)&&(r=(0,w.zfV)(this.parent,i),this.isNewValueEdit=!1):(r=(0,w.zfV)(this.parent,i),t?t=(0,Ke.VB)(t):t=r.activeCell),t){var n=(0,Ke.dK)(t),s=n[0],l=n[1],h=this.parent.getCell(s,l),c=d(r,n,this.parent.frozenRowCount(r),this.parent.frozenColCount(r),this.parent.viewport.beforeFreezeHeight,this.parent.viewport.beforeFreezeWidth,this.parent.sheetModule.colGroupWidth);this.editCellData={addr:t,fullAddr:(0,He.R)(this.parent,i)+"!"+t,rowIndex:s,colIndex:l,sheetIndex:i,element:h,value:e||"",position:c}}},o.prototype.initiateEditor=function(t){var e=this,i=this.parent.getData(this.editCellData.fullAddr);i.then(function(r){r.forEach(function(n){var s={cell:n,value:n?n.value:""};e.parent.notify(ot.gf,s);var l=n?s.value:"";n&&n.formula&&(l=n.formula),e.editCellData.oldValue=l,e.editCellData.value?l=e.editCellData.value:e.editCellData.value=l,e.isNewValueEdit?l="":e.isNewValueEdit=!0,(0,a.o8)(l)||e.refreshEditor(l,!1,!0,!1,!1),t&&e.setCursorPosition(),e.triggerEvent("cellEdit").cancel&&e.cancelEdit(!0,!1)})})},o.prototype.positionEditor=function(t){var e=this.editCellData.element,i=!1,r,n={isEdit:i};if(this.parent.notify(E.UM,n),n.isEdit&&(0,a.le)(e)&&(r=this.parent.getCell(this.editCellData.rowIndex,this.editCellData.colIndex),e=r,this.editCellData.element=r),e){e.classList.add("e-ss-edited");var s=this.parent.getActiveSheet(),l=(0,He.$S)(this.editCellData.rowIndex,this.editCellData.colIndex,s,!1,!0),h=this.editCellData.position.left+1,c=this.editCellData.position.top+1,u={range:[this.editCellData.rowIndex,this.editCellData.colIndex,this.editCellData.rowIndex,this.editCellData.colIndex]};this.parent.notify(ot.Zf,u);var p=(0,He.EB)(s,u.range[0],u.range[2])-3,f=(0,He.pG)(s,u.range[1],u.range[3])-3,g=this.parent.getMainContent(),C=g.parentElement,L=void 0,D=this.parent.frozenColCount(s),R=void 0,B=void 0,H=this.parent.frozenRowCount(s),j=void 0;this.editCellData.colIndex<D?(L=Math.abs(this.parent.getRowHeaderContent().getBoundingClientRect()[this.parent.enableRtl?"left":"right"]-e.getBoundingClientRect()[this.parent.enableRtl?"right":"left"])-1,this.editCellData.rowIndex<H?this.parent.getRowHeaderContent().style.zIndex==="2"&&(R="3"):ht(l.value,l.style,this.parent.cellStyle)>L&&(j=!0)):L=C.offsetWidth-(h-g.scrollLeft)-28-this.parent.sheetModule.getRowHeaderWidth(s),this.editCellData.rowIndex<H&&(B=!0);var W=!B&&(l&&l.wrap||e&&t||j)?"auto;":p+"px;",ne="display:block;top:"+c+"px;"+(this.parent.enableRtl?"right:":"left:")+h+"px;min-width:"+f+"px;max-width:"+(l&&l.wrap?f:L)+"px;height:"+W+(l&&l.wrap?"width:"+f+"px;":"")+"min-height:"+p+"px;"+(R?"z-index: "+R+";":"")+(B&&(l&&!l.wrap||e&&t)&&(ht(l.value,l.style,this.parent.cellStyle)>L||e&&t)?"overflow: auto;":"");ne+=e.style.cssText;var ie=this.getEditElement(s,!0);ie.setAttribute("style",ne),ht(ie.textContent,l.style,this.parent.cellStyle)>L&&(ie.style.height="auto");var me=this.parent.element.querySelector(".e-active-cell");me&&(me.style.height=p+4+"px"),e.classList.contains("e-right-align")?ie.classList.add("e-right-align"):e.classList.contains("e-center-align")&&ie.classList.add("e-center-align")}},o.prototype.updateEditedValue=function(t,e){t===void 0&&(t=!0);var i=this.editCellData.oldValue,r=i?i.toString().toUpperCase():"",n=!0,s=this.editCellData.addr,l=(0,Ke.dK)(this.parent.getActiveSheet().activeCell),h=this.parent.getActiveSheet(),c=(0,He.$S)(l[0],l[1],h),u=(0,He.wD)(h,l[1]);e&&(this.editCellData.value=e);var p=this.editCellData.value;if(this.parent.notify(E.e9,{args:{action:"beforeCellSave",eventArgs:{address:this.editCellData.addr}}}),this.parent.allowDataValidation&&(c&&c.validation||(0,He.ek)(u,l[0],l[1]))){var f=p||this.getEditElement(h).innerText,g=!0,C=this.parent.activeSheetIndex,L=void 0;typeof s=="string"?L=(0,Ke.dK)(s):L=s;var D={value:f,range:L,sheetIdx:C,isCell:g,td:null,isValid:!0};this.parent.notify(ot.tr,D),n=D.isValid,this.editCellData.value=n?f:this.editCellData.value}if((i!==this.editCellData.value||r.indexOf("=RAND()")>-1||r.indexOf("RAND()")>-1||r.indexOf("=RANDBETWEEN(")>-1||r.indexOf("RANDBETWEEN(")>-1)&&n){var R=this.parent.getActiveSheet(),B=(0,Ke.dK)(R.activeCell);i&&i.toString().indexOf("=UNIQUE(")>-1&&this.editCellData.value===""&&this.parent.notify(ot.wU,null);var H={cellIdx:B,isUnique:!1};this.checkUniqueRange(H);var j=H.isUnique;if(j&&i!==""&&this.editCellData.value===""){var W=(0,Ke.dK)(this.uniqueColl);if((0,He.$S)(W[0],W[1],R).value.toString().indexOf("#SPILL!")===-1)return n}i&&i.toString().indexOf("UNIQUE")>-1&&this.editCellData.value&&this.editCellData.value.toString().indexOf("UNIQUE")>-1&&j&&this.updateUniqueRange(""),this.parent.notify(ot.Bb,{action:"updateCellValue",address:this.editCellData.addr,value:this.editCellData.value});var ne=(0,He.$S)(B[0],B[1],R,!0),ie=this.getRefreshNodeArgs(ne);if(this.editCellData.value=ie.value,ne&&ne.formula&&(this.editCellData.formula=ne.formula),ne&&ne.wrap&&this.parent.notify(ot.ag,{range:B,wrap:!0,sheet:R}),t&&this.parent.refreshNode(this.editCellData.element,ie),ne&&ne.hyperlink&&this.parent.serviceLocator.getService("cell").refreshRange(B),j){var W=(0,Ke.dK)(this.uniqueColl);if((0,He.$S)(W[0],W[1],R).value.toString().indexOf("#SPILL!")>-1&&(this.isSpill=!0),i!==""&&this.editCellData.value===""||this.editCellData.formula&&this.editCellData.formula.length>1&&i!==this.editCellData.formula){for(var me=!1,ve=W[0];ve<=W[2];ve++)for(var Ee=W[1];Ee<=W[3];Ee++){var le=(0,He.$S)(ve,Ee,R);ve===W[0]&&Ee===W[1]?me=!1:le&&!(0,a.le)(le.value)&&le.value!==""&&(me=!0)}me||this.reApplyFormula()}else this.updateUniqueRange(p)}}return n},o.prototype.checkUniqueRange=function(t){var e={range:[]};this.parent.notify(ot.Y,e);var i=e.range;t.sheetName||(t.sheetName=this.parent.getActiveSheet().name);for(var r=0;r<i.length;r++)if(i[r].split("!")[0]===t.sheetName){for(var n=(0,Ke.dK)(i[r]),s=n[0];s<=n[2];s++)for(var l=n[1];l<=n[3];l++)if(t.cellIdx[0]===s&&t.cellIdx[1]===l){t.isUnique=!0,this.uniqueCell=!0;var h=this.uniqueColl!==""?(0,Ke.dK)(this.uniqueColl):[0,0,0,0],c=(0,Ke.dK)(i[r]);if(h[0]===c[0]&&h[1]===c[1]){var u=[h[0],c[1],h[0],c[1]];u[2]=h[2]>c[2]?h[2]:c[2],u[3]=h[3]>c[3]?h[3]:c[3],this.uniqueColl=(0,Ke.i0)(u),t.uniqueRange=(0,Ke.i0)(u)}else this.uniqueColl=i[r],t.uniqueRange=i[r]}}},o.prototype.updateUniqueRange=function(t){var e=(0,Ke.dK)(this.uniqueColl),i=!1;(0,He.$S)(e[0],e[1],this.parent.getActiveSheet()).value!=="#SPILL!"&&(i=!0);for(var r=e[0];r<=e[2];r++)for(var n=e[1];n<=e[3];n++)i&&(r===e[0]&&n===e[1]?this.parent.updateCell({value:"#SPILL!"},(0,Ke.i0)([r,n])):(0,Ke.i0)([r,n]).split(":")[0]===this.editCellData.addr?this.parent.updateCell({value:t},(0,Ke.i0)([r,n])):this.parent.updateCell({value:""},(0,Ke.i0)([r,n])))},o.prototype.reApplyFormula=function(){var t=(0,Ke.dK)(this.uniqueColl),e=(0,He.$S)(t[0],t[1],this.parent.getActiveSheet());this.parent.updateCell({value:""},(0,Ke.i0)([t[0],t[1]]));for(var i=this.parent.sheets,r=e.formula,n=0;n<i.length;n++)r.indexOf(i[n].name)>-1&&(r=r.replace(i[n].name,"!"+n));this.parent.computeExpression(r),this.uniqueCell=!1,this.uniqueActCell!==""&&(this.editCellData.value=this.uniqueActCell,this.uniqueActCell="")},o.prototype.refreshDependentCellValue=function(t,e,i){if(t&&e&&(t--,e--,(this.editCellData.rowIndex!==t||this.editCellData.colIndex!==e)&&this.parent.activeSheetIndex===i||this.uniqueCell&&this.parent.activeSheetIndex===i)){var r=(0,w.zfV)(this.parent,i),n=void 0;if(!(0,w.gSQ)(r,t)&&!(0,w.NqJ)(r,e)&&(n=this.parent.getCell(t,e)),n){if(n.parentElement){var s=n.parentElement.getAttribute("aria-rowindex");if(s&&Number(s)-1!==t)return}var l=(0,He.$S)(t,e,r),h=(0,Ke.dK)(r.activeCell);h[0]===t&&h[1]===e&&(this.uniqueActCell=l.value);var c=this.getRefreshNodeArgs(l,t,e);this.parent.refreshNode(n,c)}}},o.prototype.getRefreshNodeArgs=function(t,e,i){t=t||{};var r={value:t.value,format:t.format,onLoad:!0,formattedText:"",isRightAlign:!1,type:"General",cell:t,rowIndex:e===void 0?this.editCellData.rowIndex:e,colIndex:i===void 0?this.editCellData.colIndex:i,isRowFill:!1};this.parent.notify(ot.eY,r),r.formattedText=this.parent.allowNumberFormatting?r.formattedText:r.value;var n={isRightAlign:r.isRightAlign,result:r.formattedText,type:r.type,value:r.value,curSymbol:r.curSymbol,isRowFill:r.isRowFill};return n},o.prototype.endEdit=function(t,e){t===void 0&&(t=!1);var i=this.parent.getActiveSheet(),r=(0,w.n53)(i.activeCell),n=this.parent.getCell(r[0],r[1]),s="";this.editCellData.element&&this.editCellData.element.children[0]&&this.editCellData.element.children[0].className==="e-cf-databar"&&(s=n.children[0].querySelector(".e-databar-value").style.fontSize),t&&this.refreshEditor(this.editCellData.oldValue,!1,!0,!1,!1);var l=this.triggerEvent("beforeCellSave");if(l.cancel){this.parent.isEdit&&e&&e.preventDefault();return}l.value&&l.value.toString().indexOf(`
`)>-1&&((0,w.reQ)(this.parent.getActiveSheet().selectedRange,!0,this.parent),this.refreshEditor(l.value,this.isCellEdit,!1,!1,!1));var h=this.updateEditedValue(!0,l.value);h?(this.triggerEvent("cellSave",e,l.value),this.resetEditState(),this.focusElement()):e&&e.preventDefault(),s!==""&&(n.children[0].querySelector(".e-databar-value").style.fontSize=s),this.parent.showSheetTabs&&!this.parent.isProtected&&this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled"),this.parent.isValidationHighlighted&&(0,He.$S)(r[0],r[1],i).validation&&this.parent.addInvalidHighlight()},o.prototype.cancelEdit=function(t,e,i){t===void 0&&(t=!0),e===void 0&&(e=!0),this.refreshEditor(this.editCellData.oldValue,t,!1,!1,!1),e&&this.triggerEvent("cellSave",i),this.resetEditState(),this.focusElement()},o.prototype.focusElement=function(){we(this.parent.element),this.parent.notify(E.y3,[{enable:!0}])},o.prototype.triggerEvent=function(t,e,i){var r=this.parent.getActiveSheet(),n=(0,He.$S)(this.editCellData.rowIndex,this.editCellData.colIndex,r),s={element:this.editCellData.element,value:i||this.editCellData.value,oldValue:this.editCellData.oldValue,address:this.editCellData.fullAddr,displayText:this.parent.getDisplayText(n)};if(s.address){var l=(0,Ke.dK)(s.address),h={cellIdx:l,isUnique:!1};this.checkUniqueRange(h),h.isUnique&&(s.isSpill=this.isSpill)}if(s.value!==s.oldValue){if(t!=="cellSave"&&(s.cancel=!1),t==="beforeCellSave"){this.parent.notify(w.ya2,{eventArgs:s,action:"cellSave",preventAction:!0}),n=(0,w.C2M)(s.value)?{formula:s.value}:{value:s.value};var c=(0,w.wWT)(this.parent,r,{cell:n,rowIdx:this.editCellData.rowIndex,colIdx:this.editCellData.colIndex,eventOnly:!0});if(c)return this.cancelEdit(!1,!1),s.cancel=!0,s}this.parent.trigger(t,s),t==="cellSave"&&(this.editCellData.formula&&(s.formula=this.editCellData.formula),s.originalEvent=e,this.parent.notify(E.Av,{eventArgs:s,action:"cellSave"}))}else t!=="cellSave"&&t!=="beforeCellSave"&&this.parent.trigger(t,s);return{value:s.value,oldValue:null,element:null,address:null,cancel:s.cancel}},o.prototype.altEnter=function(){this.positionEditor(!0);var t=window.getSelection(),e=t.anchorNode,i,r=document.createRange();i=e.nodeType===3?t.anchorOffset:e.textContent.length,i===0&&e.textContent.length>0&&(i=e.textContent.length);var n=e.textContent,s=n.slice(0,i),l=n.slice(i)||" ";e.textContent=s+`
`+l,r=document.createRange(),e.nodeType===3?(r.setStart(e,i+1),r.setEnd(e,i+1)):e.nodeType===1&&(r.setStart(e.firstChild,i+1),r.setEnd(e.firstChild,i+1)),t.removeAllRanges(),t.addRange(r)},o.prototype.resetEditState=function(t){if(t===void 0&&(t=!0),t){var e=this.getEditElement(this.parent.getActiveSheet());((0,w.C2M)(e.textContent)||e.textContent==="")&&this.parent.notify(E.WI,null),this.editCellData.element&&(this.editCellData.element.classList.remove("e-ss-edited"),this.editorElem.textContent="",e===this.editorElem?(this.editorElem.removeAttribute("style"),this.editorElem.classList.remove("e-right-align")):(0,a.og)(e))}this.editCellData={},this.parent.isEdit=this.isEdit=!1,this.isCellEdit=!0,this.parent.notify(E.Sn,{action:"endEdit"})},o.prototype.refSelectionRender=function(){var t=this.getEditElement(this.parent.getActiveSheet());t&&(0,w.C2M)(t.textContent)&&this.parent.notify(E.BF,{range:t.textContent,formulaSheetIdx:this.editCellData.sheetIndex})},o.prototype.initiateRefSelection=function(){var t=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.indexOf("!")),e=this.editCellData.value;this.parent.getActiveSheet().name===t&&(0,w.C2M)(this.editCellData.value,!0)?(this.startEdit(this.editCellData.addr,e,!1),this.parent.notify(E.BF,{range:this.editCellData.value,formulaSheetIdx:this.editCellData.sheetIndex}),this.getEditElement(this.parent.getActiveSheet()).innerHTML=e,this.initiateCurPosition()):this.initiateCurPosition()},o.prototype.addressHandler=function(t){var e=window.getSelection();if(this.selectionStart=e.anchorOffset,this.selectionEnd=e.focusOffset,this.selectionStart>this.selectionEnd){var i=this.selectionStart;this.selectionStart=this.selectionEnd,this.selectionEnd=i}if(e&&e.focusNode&&e.focusNode.classList&&e.focusNode.classList.contains("e-formula-bar-panel")){var r=e.focusNode.getElementsByClassName("e-formula-bar e-css")[0];this.selectionStart=r.selectionStart,this.selectionEnd=r.selectionEnd}var n={action:"getCurrentEditValue",editedValue:""};this.parent.notify(E.vJ,n);var s=t.range,l=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.indexOf("!")),h=this.editCellData.sheetIndex,c=this.getEditElement(this.parent.getActiveSheet());if(this.parent.getActiveSheet().name!==l&&(s="'"+this.parent.getActiveSheet().name+"'!"+s),t.isSelect)this.parent.notify(E.BF,{range:n.editedValue+s,formulaSheetIdx:h});else{var u=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.indexOf("!"));if(this.parent.getActiveSheet().name===u){var p=n.editedValue;this.selectionStart!==this.selectionEnd?(this.formulaBarCurStartPos=this.selectionStart,this.curStartPos=this.selectionStart,this.curEndPos=this.selectionStart+s.length,c.textContent=p.substring(0,this.selectionStart)+s+p.substring(this.selectionStart)):p.indexOf(")")===p.length-1&&this.selectionEnd===p.length?(c.textContent=p.substring(0,p.length-1)+s+p.substring(p.length-1),this.curEndPos=c.textContent.length-1):p.indexOf(")")!==p.length-1?(c.textContent=p+s,this.curEndPos=c.textContent.length):c.textContent!==p?(c.textContent=p.substring(0,this.curStartPos)+s+p.substring(this.curStartPos),this.curEndPos=this.curStartPos+s.length):this.selectionStart===this.selectionEnd&&this.validCharacters.indexOf(p.substring(this.selectionStart-1,this.selectionEnd))!==-1&&(this.validCharacters.indexOf(p.substring(this.selectionStart,this.selectionEnd+1))!==-1||p.substring(this.selectionStart,this.selectionEnd+1)===")")&&(c.textContent=p.substring(0,this.selectionStart)+s+p.substring(this.selectionEnd),this.curStartPos=this.selectionStart,this.curEndPos=this.selectionStart+s.length,this.formulaBarCurStartPos=this.curStartPos)}}},o.prototype.updateFormulaBarValue=function(){var t=window.getSelection(),e=this.editCellData.value,i=this.parent.getActiveSheet().selectedRange;i=(0,Ke.hY)((0,Ke.IR)(i))?i.split(":")[0]:i;var r=this.parent.element.querySelector(".e-formula-bar");if(e&&(0,w.C2M)(e,!0)){var n=this.editCellData.fullAddr.substring(0,this.editCellData.fullAddr.indexOf("!"));this.parent.getActiveSheet().name!==n&&(i="'"+this.parent.getActiveSheet().name+"'!"+i),(0,a.le)(this.formulaBarCurStartPos)?e.indexOf(")")===e.length-1&&t.focusOffset===e.length?r.value=e.substring(0,e.length-1)+i+e.substring(e.length-1):e.indexOf(")")!==e.length-1?r.value=e+i:r.value!==e&&(r.value=e.substring(0,this.curStartPos)+i+e.substring(this.curStartPos)):r.value=e.substring(0,this.formulaBarCurStartPos)+i+e.substring(this.formulaBarCurStartPos),this.curEndPos=this.curStartPos+i.length}},o.prototype.setFormulaBarCurPosition=function(t,e,i){t.setSelectionRange&&(t.focus(),t.selectionStart=e,t.selectionEnd=e,t.setSelectionRange(e,i))},o.prototype.initiateCurPosition=function(t){t===void 0&&(t={isCellEdit:!1});var e=this.getEditElement(this.parent.getActiveSheet(),!0);if(t.isCellEdit){var i=this.getCurPosition();!this.endFormulaRef&&i.start===i.end&&(this.updateFormulaReference(e),i.end&&this.validCharacters.indexOf(this.editCellData.value[i.end-1])===-1&&(this.endFormulaRef=!0));return}var r=e.innerText,n=window.getSelection();if(n&&n.focusNode&&n.focusNode.classList&&n.focusNode.classList.contains("e-formula-bar-panel")){var s=this.parent.element.querySelector(".e-formula-bar");this.setFormulaBarCurPosition(s,this.curEndPos,this.curEndPos);return}if(r){var l=document.createRange();r.indexOf(")")===r.length-1?(l.setStart(e.childNodes[0],this.curEndPos),l.setEnd(e.childNodes[0],this.curEndPos)):(l.setStart(e.childNodes[0],this.curEndPos),l.setEnd(e.childNodes[0],this.curEndPos)),n.removeAllRanges(),n.addRange(l)}var h=this.editCellData.sheetIndex;if(h!==this.parent.getActiveSheet().id-1){var c=this.parent.element.querySelector(".e-formula-bar");if(c.value){var u=c.value.length;c.value.indexOf(")")===u-1?this.setFormulaBarCurPosition(c,u-1,u-1):this.setFormulaBarCurPosition(c,u,u)}}},o.prototype.getEditElement=function(t,e){if((this.isEdit||e)&&(t.frozenRows||t.frozenColumns)){var i=this.parent.frozenRowCount(t),r=this.parent.frozenColCount(t),n=(0,w.n53)(t.activeCell),s=void 0;if(n[0]<i&&n[1]<r)s=this.parent.getSelectAllContent();else if(n[0]<i)s=this.parent.getColumnHeaderContent();else if(n[1]<r)s=this.parent.getRowHeaderContent();else return this.editorElem;var l=s.getElementsByClassName("e-spreadsheet-edit")[0];return!l&&e&&(l=s.appendChild(this.editorElem.cloneNode())),l}return this.editorElem},o.prototype.sheetChangeHandler=function(){this.isEdit||(this.editCellData.value=null)},o}(),pe=ae(93010),gr=function(){function o(t){this.uniqueOBracket=String.fromCharCode(129),this.uniqueCBracket=String.fromCharCode(130),this.uniqueCSeparator=String.fromCharCode(131),this.uniqueCOperator=String.fromCharCode(132),this.uniquePOperator=String.fromCharCode(133),this.uniqueSOperator=String.fromCharCode(134),this.uniqueMOperator=String.fromCharCode(135),this.uniqueDOperator=String.fromCharCode(136),this.uniqueModOperator=String.fromCharCode(137),this.uniqueConcateOperator=String.fromCharCode(138),this.uniqueEqualOperator=String.fromCharCode(139),this.uniqueExpOperator=String.fromCharCode(140),this.uniqueGTOperator=String.fromCharCode(141),this.uniqueLTOperator=String.fromCharCode(142),this.invalidOperators=["%"],this.formulaRange=[],this.tableRangesFormula={},this.parent=t,this.addEventListener(),this.mouseMoveEvt=this.mouseMoveHandler.bind(this)}return o.prototype.addEventListener=function(){this.parent.on(E.eT,this.init,this),this.parent.on(E.uG,this.mouseDownHandler,this),this.parent.on(E.e2,this.virtualContentLoadedHandler,this),this.parent.on(E.Lc,this.cellNavigateHandler,this),this.parent.on(E.Y0,this.selectRange,this),this.parent.on(E.QK,this.rowHeightChanged,this),this.parent.on(E.N2,this.colWidthChanged,this),this.parent.on(E.KR,this.protectHandler,this),this.parent.on(E.BF,this.initiateFormulaSelection,this),this.parent.on(E.WI,this.clearBorder,this),this.parent.on(E.M7,this.getRowIdxFromClientY,this),this.parent.on(E.oU,this.getColIdxFromClientX,this),this.parent.on(E.R8,this.chartBorderHandler,this),this.parent.on(E.pf,this.isTouchSelectionStarted,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.eT,this.init),this.parent.off(E.uG,this.mouseDownHandler),this.parent.off(E.e2,this.virtualContentLoadedHandler),this.parent.off(E.Lc,this.cellNavigateHandler),this.parent.off(E.Y0,this.selectRange),this.parent.off(E.QK,this.rowHeightChanged),this.parent.off(E.N2,this.colWidthChanged),this.parent.off(E.KR,this.protectHandler),this.parent.off(E.BF,this.initiateFormulaSelection),this.parent.off(E.WI,this.clearBorder),this.parent.off(E.M7,this.getRowIdxFromClientY),this.parent.off(E.oU,this.getColIdxFromClientX),this.parent.off(E.R8,this.chartBorderHandler),this.parent.off(E.pf,this.isTouchSelectionStarted))},o.prototype.isTouchSelectionStarted=function(t){t.touchSelectionStarted=this.touchSelectionStarted},o.prototype.rowHeightChanged=function(t){var e=this;!t.threshold||$(function(){if(!!e.parent){var i=e.parent.getActiveSheet(),r=e.getActiveCell();if(r){if(i.frozenRows||i.frozenColumns||i.selectedRange.includes(" ")){e.selectRange({address:i.selectedRange});return}var n=(0,Ke.n5)(i.activeCell)[0];n===t.rowIdx?r.style.height=parseFloat(r.style.height)+t.threshold+"px":n>t.rowIdx&&(r.style.top=parseFloat(r.style.top)+t.threshold+"px")}if(r=e.getSelectionElement(),r){var s=(0,Ke.dK)(i.selectedRange),l=(0,Ke.g)(s),h={range:l,isActiveCell:!1,skipChecking:!0};if(e.parent.notify(w.aQp,h),h.isActiveCell||l[0]===l[2]&&l[1]===l[3])return;var c=l[0],u=l[2];c<=t.rowIdx&&u>=t.rowIdx&&r?r.style.height=parseFloat(r.style.height)+t.threshold+"px":c>t.rowIdx&&r&&(r.style.top=parseFloat(r.style.top)+t.threshold+"px")}}})},o.prototype.colWidthChanged=function(t){var e=this;!t.threshold||$(function(){if(!!e.parent){var i=e.getActiveCell(),r=e.parent.getActiveSheet();if(i){if(r.frozenRows||r.frozenColumns||r.selectedRange.includes(" ")){e.selectRange({address:r.selectedRange});return}var n=(0,Ke.n5)(r.activeCell)[1];n===t.colIdx?i.style.width=parseFloat(i.style.width)+t.threshold+"px":n>t.colIdx&&(i.style.left=parseFloat(i.style.left)+t.threshold+"px")}var s=(0,Ke.dK)(e.parent.getActiveSheet().selectedRange),l=(0,Ke.g)(s),h={range:l,isActiveCell:!1,skipChecking:!0};if(e.parent.notify(w.aQp,h),i=e.getSelectionElement(),!(!i||h.isActiveCell||l[0]===l[2]&&l[1]===l[3])){var c=l[1],u=l[3];c<=t.colIdx&&u>=t.colIdx&&i?i.style.width=parseFloat(i.style.width)+t.threshold+"px":c>t.colIdx&&i&&(i.style.left=parseFloat(i.style.left)+t.threshold+"px")}}})},o.prototype.selectRange=function(t){t.address=this.parent.selectionSettings.mode==="Single"?(0,Ke.i0)((0,Ke.n5)(t.address)):t.address,this.selectMultiRange(t.address,null,null,t.skipChecking)},o.prototype.init=function(){this.createSelectionElement();var t=this.parent.getActiveSheet(),e=(0,Ke.g)((0,Ke.dK)(t.selectedRange)),i=(0,Ke.n5)(t.activeCell),r=e[0]<=i[0]&&e[2]>=i[0]&&e[1]<=i[1]&&e[3]>=i[1];this.selectMultiRange(t.selectedRange,!0,r)},o.prototype.selectMultiRange=function(t,e,i,r){var n=this,s=this.parent.activeSheetIndex;t.indexOf("!")>-1&&(s=(0,w.Q8D)(this.parent,(0,w.HAf)(t)),t=t.split("!")[1]),this.parent.activeSheetIndex===s?t.split(" ").forEach(function(l,h){n.selectRangeByIdx((0,Ke.dK)(l),{type:"mousedown",ctrlKey:h!==0},null,i,e,r)}):(0,w.TmR)(this.parent,t,this.parent.sheets[s])},o.prototype.createSelectionElement=function(){var t=this.parent.getMainContent(),e=this.parent.createElement("div",{className:"e-selection"});t.appendChild(e),e=this.parent.createElement("div",{className:"e-active-cell"}),t.appendChild(e)},o.prototype.mouseDownHandler=function(t){if(!((0,a.oq)(t.target,".e-scrollbar")||t.target.classList.contains("e-main-panel")||t.target.classList.contains("e-sheet"))){var e={action:"getCurrentEditValue",editedValue:""},i=this.parent.getActiveSheet();this.parent.notify(E.vJ,e);var r=(0,w.C2M)(e.editedValue,!0);if(!this.parent.isEdit||r){var n=document.getElementById(this.parent.element.id+"_overlay");if(typeof t.target.className=="string"){if(t.target.className.indexOf("e-ss-overlay")>-1)return}else n&&n.classList.remove("e-ss-overlay-active");if((0,a.oq)(t.target,".e-datavisualization-chart")||i.isProtected&&!i.protectSettings.selectCells&&!i.protectSettings.selectUnLockedCells)return;if(!(0,a.oq)(t.target,".e-findtool-dlg")&&this.getSheetElement().contains(t.target)&&!t.target.classList.contains("e-colresize")&&!t.target.classList.contains("e-rowresize")){var s=this.parent.getActiveSheet(),l=this.parent.selectionSettings.mode,h=this.getRowIdxFromClientY({clientY:_(t),target:t.target}),c=this.getColIdxFromClientX({clientX:V(t),target:t.target}),u=(0,Ke.n5)(s.activeCell),p=(0,w.$Su)(h,c,s),f=void 0,g=void 0;if(s.isProtected&&s.protectSettings.selectUnLockedCells&&!s.protectSettings.selectCells)if((0,a.le)(p)){if(!s.protectSettings.selectCells)return}else{if(p.isLocked===!0||(0,a.le)(p.isLocked))return;var C=this.parent.element.getElementsByClassName("e-sheet-panel")[0];C&&C.classList.contains("e-protected")&&C.classList.remove("e-protected")}if(s.showHeaders){var L=t.target;if(s.frozenColumns||s.frozenRows){var D=this.parent.getSelectAllContent().querySelector("thead");D?g=(this.parent.getColumnHeaderContent().contains(L)||D.contains(L))&&L.classList.contains("e-header-cell"):g=this.parent.getColumnHeaderContent().contains(L)&&L.classList.contains("e-header-cell"),D=this.parent.getSelectAllContent().querySelector("tbody"),D?f=(this.parent.getRowHeaderContent().contains(L)||D.contains(L))&&L.classList.contains("e-header-cell"):f=this.parent.getRowHeaderContent().contains(L)&&L.classList.contains("e-header-cell")}else f=this.parent.getRowHeaderContent().contains(t.target),g=this.parent.getColumnHeaderContent().contains(t.target)}if(t.which===3&&this.isSelected(h,c))return;if(t.target.classList.contains("e-autofill")){this.isautoFillClicked=!0;var R=t.target.parentElement.querySelector(".e-dragfill-ddb");(!R||R.classList.contains("e-hide"))&&(this.dAutoFillCell=s.selectedRange)}var B=(0,Ke.dK)(s.topLeftCell),H=void 0;f?(this.isRowSelected=!0,(!t.shiftKey||l==="Single")&&(this.startCell=[h,0]),H=[this.startCell[0],s.frozenColumns?B[1]:0,h,s.colCount-1]):g?(this.isColSelected=!0,(!t.shiftKey||l==="Single")&&(this.startCell=[0,c]),H=[s.frozenRows?B[0]:0,this.startCell[1],s.rowCount-1,c]):(0,a.oq)(t.target,".e-select-all-cell")?(this.startCell=[s.frozenRows?B[0]:0,s.frozenColumns?B[1]:0],H=[].concat(this.startCell,[s.rowCount-1,s.colCount-1])):t.target.classList.contains("e-sheet-content")||((!t.shiftKey||l==="Single")&&(this.startCell=[h,c]),!this.isautoFillClicked&&!(0,a.oq)(t.target,".e-filloption")&&(H=[].concat(this.startCell?this.startCell:(0,Ke.n5)(s.activeCell),[h,c])));var j=t.ctrlKey&&H&&s.selectedRange.includes((0,Ke.i0)(H));if(!j&&l==="Multiple"&&(!A(t)&&(!v(t)||v(t)&&u[0]===h&&u[1]===c)||g||f)?(document.addEventListener(m().split(" ")[0],this.mouseMoveEvt),a.AR.isPointer||document.addEventListener(m().split(" ")[1],this.mouseMoveEvt,{passive:!1}),this.touchSelectionStarted=!0):this.touchSelectionStarted=!1,!j&&!A(t)&&a.bi.add(document,x(),this.mouseUpHandler,this),v(t)&&!(g||f)){this.touchEvt=t;return}H&&this.selectRangeByIdx(H,t),this.parent.isMobileView()&&(this.parent.element.classList.add("e-mobile-focused"),this.parent.renderModule.setSheetPanelSize())}}if(r&&(t.target.classList.contains("e-cell")||t.target.classList.contains("e-header-cell"))&&this.parent.isEdit){var H=this.parent.getActiveSheet().selectedRange;H=(0,w.hYl)((0,pe.IRR)(H))?H.split(":")[0]:H,this.parent.notify(E.R,{range:H,isSelect:!1})}}},o.prototype.mouseMoveHandler=function(t){var e=this,i=this.parent.getActiveSheet();y(t)&&t.preventDefault();var r={action:"getCurrentEditValue",editedValue:""};this.parent.notify(E.vJ,r);var n=(0,w.C2M)(r.editedValue,!0),s=this.parent.getMainContent().parentElement,l=this.parent.element.getElementsByClassName("e-scroller")[0],h=s.getBoundingClientRect(),c=this.parent.frozenColCount(i),u=h.left+this.parent.sheetModule.getRowHeaderWidth(i),p=h.top,f=h.right,g=h.bottom,C=V(t),L=_(t),D=this.isRowSelected?i.colCount-1:this.getColIdxFromClientX({clientX:Math.min(C,f),target:t.target}),R=this.isColSelected?i.rowCount-1:this.getRowIdxFromClientY({clientY:Math.min(L,g),target:t.target}),B;if(t.ctrlKey){var H=i.selectedRange.split(" ");B=(0,Ke.dK)(H[H.length-1])}else B=(0,Ke.dK)(i.selectedRange);var j={range:[R,D,R,D]};if(this.parent.notify(w.Zf5,j),!(j.range[2]===B[2]&&j.range[3]===B[3])){var W=this.parent.frozenRowCount(i),ne=(L>g?c?C<u:!0:!1)&&R<i.rowCount,ie=L<p&&R>=0&&!this.isColSelected&&!!s.scrollTop;W>R&&(ne=!1,ie=!1);var me=C>f&&D<i.colCount,ve=C<u&&D>=0&&!this.isRowSelected&&!!l.scrollLeft;c>D&&(me=!1,ve=!1),this.clearInterval();var Ee,le;if(!n&&!this.isColSelected&&!this.isRowSelected&&(B=(0,Ke.n5)(i.activeCell)),ne||ie||me||ve)(ie||ve)&&(Ee=R,le=D),this.scrollInterval=setInterval(function(){if((ne||ie)&&!e.isColSelected){if(R=e.getRowIdxFromClientY({clientY:ne?g:p}),R>=i.rowCount){e.clearInterval();return}s.scrollTop+=(ne?1:-1)*(0,w.NEZ)(i,R)}if((me||ve)&&!e.isRowSelected){if(D=e.getColIdxFromClientX({clientX:me?f:u}),D>=i.colCount){e.clearInterval();return}l.scrollLeft+=(me?1:-1)*(0,w.IQS)(i,D)}if(ie&&!s.scrollTop||ve&&!l.scrollLeft){e.selectRangeByIdx([].concat(B[0],B[1],[Ee,le]),t),e.clearInterval();return}e.selectRangeByIdx([].concat(B[0],B[1],[R,D]),t)},100);else{var de=[].concat(B[0],B[1],[R,D]);if(W&&de[0]<W&&de[2]>=W&&s.scrollTop&&(s.scrollTop=0,de[2]=W),c&&de[1]<c&&de[3]>=c&&l.scrollLeft&&(l.scrollLeft=0,de[3]=c),this.isautoFillClicked){t.target.classList.contains("e-autofill")&&(this.dAutoFillCell=i.selectedRange);var fe={e:t,indexes:null};this.parent.notify(E.cQ,fe),de=fe.indexes}this.selectRangeByIdx(de,t)}if(n&&this.parent.isEdit&&!(0,a.oq)(t.target,"#"+this.parent.element.id+"_edit")){var Le=this.parent.getActiveSheet().selectedRange;this.parent.notify(E.R,{range:Le,isSelect:!1})}}},o.prototype.mouseUpHandler=function(t){var e=this.getRowIdxFromClientY({clientY:_(t),target:t.target}),i=this.getColIdxFromClientX({clientX:V(t),target:t.target});this.clearInterval(),A(t)&&!(this.isColSelected||this.isRowSelected)&&this.getRowIdxFromClientY({clientY:_(this.touchEvt),target:t.target})===e&&this.getColIdxFromClientX({clientX:V(this.touchEvt),target:t.target})===i&&this.mouseDownHandler(t),document.removeEventListener(m().split(" ")[0],this.mouseMoveEvt),a.AR.isPointer||document.removeEventListener(m().split(" ")[1],this.mouseMoveEvt),a.bi.remove(document,x(),this.mouseUpHandler);var r=this.parent.getActiveSheet();if((r.frozenRows||r.frozenColumns)&&T(this.parent.element,null,"e-cur-selection",!0,!0),this.parent.notify(E.Vo,t),this.isautoFillClicked){var n=this.parent.getActiveSheet(),s=(0,Ke.dK)(n.selectedRange);!(this.isColSelected&&s[1]===i)&&!(this.isRowSelected&&s[0]===e)&&this.parent.notify(E.dt,{event:t,dAutoFillCell:this.dAutoFillCell}),this.isautoFillClicked=!1}else!t.ctrlKey&&!Lt((0,w.dPh)(this.parent.getActiveSheet()))?this.parent.notify(E.uv,null):this.parent.notify(E.Qu,null);var l={action:"getCurrentEditValue",editedValue:""};this.parent.notify(E.vJ,l);var h=(0,w.C2M)(l.editedValue)||l.editedValue&&l.editedValue.toString().indexOf("=")===0;h&&this.parent.isEdit&&this.parent.notify(E.jI,{isCellEdit:t.target.classList.contains("e-spreadsheet-edit")})},o.prototype.isSelected=function(t,e){for(var i=!1,r,n=this.parent.getActiveSheet().selectedRange.split(" "),s=0;s<n.length;s++)if(r=(0,Ke.g)((0,Ke.dK)(n[s])),r[0]<=t&&t<=r[2]&&r[1]<=e&&e<=r[3]){i=!0;break}return i},o.prototype.virtualContentLoadedHandler=function(t){var e=this,i=this.parent.getActiveSheet(),r=(0,Ke.dK)(i.selectedRange),n,s;i.selectedRange.split(" ").forEach(function(l,h){if(r=(0,Ke.dK)(l),s=r[1]===0&&r[3]===t.prevRowColCnt.colCount-1,n=r[0]===0&&r[2]===t.prevRowColCnt.rowCount-1,n&&s)e.selectRangeByIdx([0,0,i.rowCount-1,i.colCount-1],null,!0,null,null,null,h);else if(n)e.selectRangeByIdx([0,r[1],i.rowCount-1,r[3]],null,!0,null,null,null,h);else if(s)e.selectRangeByIdx([r[0],0,r[2],i.colCount-1],null,!0,null,null,null,h);else{r=(0,Ke.dK)(l);var c=e.parent.viewport.topIndex+e.parent.frozenRowCount(i),u=e.parent.viewport.leftIndex+e.parent.frozenColCount(i);e.highlightHdr(r,h!==0,r[0]>=c||r[2]>=c,r[1]>=u||r[3]>=u)}})},o.prototype.clearInterval=function(){clearInterval(this.scrollInterval),this.scrollInterval=null},o.prototype.getScrollLeft=function(){return this.parent.scrollModule?this.parent.scrollModule.prevScroll.scrollLeft:0},o.prototype.cellNavigateHandler=function(t){var e=this.parent.getActiveSheet();e.isProtected&&!e.protectSettings.selectCells&&!e.protectSettings.selectUnLockedCells||this.selectRangeByIdx(t.range.concat(t.range),void 0,!1,!1,!1,!1,void 0,t.preventAnimation)},o.prototype.getColIdxFromClientX=function(t){var e=0,i=this.parent.getActiveSheet(),r=0;if(t.isImage)r=t.clientX;else{var n=document.getElementById(this.parent.element.id+"_sheet").getBoundingClientRect();if(this.parent.enableRtl?r=n.right-this.parent.sheetModule.getRowHeaderWidth(i,!0)-1-t.clientX:r=t.clientX-(n.left+this.parent.sheetModule.getRowHeaderWidth(i,!0)+1),r+=this.parent.viewport.beforeFreezeWidth,!t.target||!(0,a.oq)(t.target,".e-row-header")&&!(0,a.oq)(t.target,".e-selectall-container")||this.isScrollableArea(t.clientX,t.target,!0))if(this.parent.frozenColCount(i)){var s=this.parent.element.querySelector(".e-frozen-column");r=parseInt(s.style.left)>r?r:r+this.getScrollLeft()}else r+=this.getScrollLeft()}for(var l=0;;l++)if(e+=(0,w.IQS)(i,l,null,!0),r<e||this.parent.scrollSettings.isFinite&&l===i.colCount-1)return t.isImage||(t.size=r),t.clientX=l,l},o.prototype.isScrollableArea=function(t,e,i){return e.classList.contains("e-table")?i?t>this.parent.getMainContent().getBoundingClientRect().left:t>this.parent.getMainContent().parentElement.getBoundingClientRect().top:!1},o.prototype.getRowIdxFromClientY=function(t){var e=0,i=this.parent.getActiveSheet(),r=0;if(t.isImage)r=t.clientY;else{var n=document.getElementById(this.parent.element.id+"_sheet");r=t.clientY+this.parent.viewport.beforeFreezeHeight-(n.getBoundingClientRect().top+(i.showHeaders?31:0)),(!t.target||!(0,a.oq)(t.target,".e-header-panel")||this.isScrollableArea(t.clientY,t.target))&&(r+=this.parent.getMainContent().parentElement.scrollTop)}for(var s=0;;s++)if(e+=(0,w.NEZ)(i,s,!0),r<e||this.parent.scrollSettings.isFinite&&s===i.rowCount-1)return t.isImage||(t.size=r),t.clientY=s,s},o.prototype.initFormulaReferenceIndicator=function(t){if(this.parent.isEdit){var e=this.parent.createElement("div",{className:"e-formularef-indicator"});e.appendChild(this.parent.createElement("div",{className:"e-top"})),e.appendChild(this.parent.createElement("div",{className:"e-bottom"})),e.appendChild(this.parent.createElement("div",{className:"e-left"})),e.appendChild(this.parent.createElement("div",{className:"e-right"})),this.parent.getMainContent().appendChild(e),M(this.parent,e,t,"e-formularef-indicator")}},o.prototype.selectRangeByIdx=function(t,e,i,r,n,s,l,h){var c=this;if(!(e&&e.target&&(0,a.oq)(e.target,"#"+this.parent.element.id+"_edit"))){var u={action:"getCurrentEditValue",editedValue:"",endFormulaRef:!1};this.parent.notify(E.vJ,u);var p=(0,w.C2M)(u.editedValue,!0)&&!u.endFormulaRef,f=e&&e.ctrlKey&&I(e),g;f||(g=this.getSelectionElement(e,l));var C=this.parent.getActiveSheet(),L=(0,Ke.dK)(C.topLeftCell),D=this.parent.element.querySelector(".e-formularef-indicator"),R={range:[].slice.call(t),isActiveCell:!1,skipChecking:s},B,H=document.querySelector(".e-datavisualization-chart.e-ss-overlay-active");!this.isColSelected&&!this.isRowSelected&&this.parent.notify(w.aQp,R),t!==R.range&&(B=!0),t=R.range;var j=new Promise(function(fe){fe(function(){}())}),W={range:(0,Ke.i0)(t),cancel:!1};if(this.parent.trigger("beforeSelect",W),!W.cancel){if(p&&D&&D.parentElement.removeChild(D),this.parent.notify(E.LC,null),((0,w.hYl)(t)||R.isActiveCell)&&!f){if(g&&(g.classList.contains("e-multi-range")||g.classList.add("e-hide"),C.frozenRows||C.frozenColumns)){var ne=N(e)?"e-cur-selection":"e-selection";T(this.parent.getSelectAllContent(),null,ne,!0),T(this.parent.getColumnHeaderContent(),null,ne,!0),T(this.parent.getRowHeaderContent(),null,ne,!0)}!C.frozenColumns&&!C.frozenRows&&g&&M(this.parent,g,t),p&&e&&e.target&&!e.target.classList.contains("e-spreadsheet-edit")&&this.parent.isEdit&&(this.parent.notify(E.R,{range:(0,Ke.i0)(t).split(":")[0],isSelect:!0}),this.initFormulaReferenceIndicator(t))}else{if(f)if(l===void 0){var ie=(0,Ke.i0)(t);if(C.selectedRange.includes(ie)){var me=C.selectedRange.split(" ");me.length>1?(me.splice(me.indexOf(ie),1),ie=me.join(" ")):ie=C.activeCell+":"+C.activeCell,this.selectRange({address:ie});return}else g=this.getSelectionElement(e,l)}else g=this.getSelectionElement(e,l);if(p&&this.parent.isEdit)e&&e.target&&!e.target.classList.contains("e-spreadsheet-edit")&&this.parent.isEdit&&(this.parent.notify(E.R,{range:(0,Ke.i0)(t),isSelect:!0}),this.initFormulaReferenceIndicator(t));else{var ne=void 0;g&&(g.classList.remove("e-hide"),(C.frozenRows||C.frozenColumns)&&((e&&e.target||f)&&(ne="e-cur-selection",N(e)&&g.classList.contains("e-cur-selection")?g.classList.add("e-hide"):g.classList.add(ne)),!f&&(this.isColSelected||this.isRowSelected)&&I(e)&&(T(this.parent.getSelectAllContent(),null,"e-selection"),T(this.parent.getColumnHeaderContent(),null,"e-selection"),T(this.parent.getRowHeaderContent(),null,"e-selection"))));var ve=this.isColSelected&&this.isRowSelected?void 0:this.getOffset(t[2],t[3]);B&&ve&&(ve.left={idx:0,size:0}),j=M(this.parent,g,t,ne,!1,f,f&&!e.target)||j}}var Ee={action:"getCurrentEditSheetIdx",sheetIndex:null};this.parent.notify(E.vJ,Ee),C.frozenColumns&&t[1]>0&&t[1]===L[1]&&t[3]===C.colCount-1&&(t[1]=0),C.frozenRows&&t[0]>0&&t[0]===L[0]&&t[2]===C.rowCount-1&&(t[0]=0);var le=(0,Ke.i0)(t);if(e&&e.ctrlKey&&(N(e)||z(e)))le=C.selectedRange.slice(0,C.selectedRange.lastIndexOf(" "))+" "+le;else if(l>-1){var me=C.selectedRange.split(" ");me[l]=le,le=me.join(" ")}if(!p&&!this.isautoFillClicked){var de=!1;C.selectedRange!==le&&(de=!0),(0,w.TmR)(this.parent,le,C,f),de&&j.then(function(){c.parent.trigger("select",{range:c.parent.getActiveSheet().selectedRange})})}else!n&&!this.isautoFillClicked&&(0,w.TmR)(this.parent,le,C,f);this.UpdateRowColSelected(t),this.highlightHdr(t,e&&e.ctrlKey),!i&&!(e&&(e.type==="mousemove"||y(e)))&&(p?Ee.sheetIndex===this.parent.getActiveSheet().id-1&&n?(r=!0,this.updateActiveCell(r?(0,Ke.dK)(C.activeCell):t,n,h)):this.parent.isEdit||this.updateActiveCell(r?(0,Ke.dK)(C.activeCell):t,n,h):this.updateActiveCell(r?(0,Ke.dK)(C.activeCell):t,n,h)),(0,a.le)(e)&&(e={type:"mousedown"}),p?n||this.parent.notify(pe.Pmi,e):this.parent.notify(pe.Pmi,e),!f&&!Lt((0,w.dPh)(this.parent.getActiveSheet()))?this.parent.notify(E.uv,{preventAnimation:h}):this.parent.notify(E.Qu,null),this.parent.showAggregate&&this.parent.notify(E.I4,{}),this.parent.notify(E.LV,{}),H&&this.parent.notify(E.k3,{}),this.parent.notify(E.gs,{})}}},o.prototype.UpdateRowColSelected=function(t){var e=this.parent.getActiveSheet();this.isRowSelected=t[1]===0&&t[3]===e.colCount-1,this.isColSelected=t[0]===0&&t[2]===e.rowCount-1},o.prototype.updateActiveCell=function(t,e,i){var r=this.parent.getActiveSheet(),n=(0,Ke.dK)(r.topLeftCell),s,l,h;this.isColSelected?(s=n[0],l=t[1],this.isRowSelected&&(l=n[1])):(s=t[0],l=t[1],this.isRowSelected&&(l=n[1]));var c={range:[s,l].concat([s,l])};if(this.parent.notify(w.Zf5,c),t!==c.range&&(h=!0),t=c.range,r.activeCell!==(0,Ke.qk)(t[0],t[1])||e){if(this.parent.setSheetPropertyOnMute(r,"activeCell",(0,Ke.qk)(t[0],t[1])),r.isProtected){var u=this.parent.element.querySelector(".e-formula-bar"),p=(0,w.$Su)(t[0],t[1],r),f=(0,w.p1d)(p,(0,w.wDo)(r,t[1]));f&&u&&!u.disabled?u.disabled=!0:!f&&u&&u.disabled&&(u.disabled=!1)}if(this.getActiveCell()){var g=this.getOffset(t[2],t[3]);h&&(g.left={idx:0,size:0}),M(this.parent,this.getActiveCell(),t,"e-active-cell",i)}this.parent.notify(w.q6q,null)}else M(this.parent,this.getActiveCell(),t,"e-active-cell",i)},o.prototype.getOffset=function(t,e){var i={left:{idx:0,size:0},top:{idx:0,size:0}};return this.parent.scrollModule&&(e>=this.parent.scrollModule.offset.left.idx&&(i.left=this.parent.scrollModule.offset.left),t>=this.parent.scrollModule.offset.top.idx&&(i.top=this.parent.scrollModule.offset.top)),i},o.prototype.getSelectionElement=function(t,e){if(t&&t.ctrlKey){var i=this.parent.getActiveSheet();if(z(t)||N(t))if(i.frozenColumns||i.frozenRows){var r=this.parent.getMainContent().querySelector(".e-cur-selection");return r||(r=this.parent.element.querySelector(".e-multi-range"),r&&r.cloneNode())}else return this.parent.getMainContent().querySelector(".e-selection:last-child");else{var n=this.parent.getMainContent().getElementsByClassName("e-selection")[0],r=n.cloneNode();return r.classList.add("e-multi-range"),i.frozenColumns||i.frozenRows?(i.selectedRange.includes(" ")||(n.classList.remove("e-hide"),M(this.parent,n,(0,Ke.g)((0,Ke.dK)(i.selectedRange)),void 0,!1,!0)),!this.parent.getMainContent().querySelector(".e-multi-range")&&n.classList.contains("e-hide")?n:r):(n.classList.remove("e-hide"),this.parent.getMainContent().appendChild(r))}}else{if(e>-1)return this.parent.getMainContent().getElementsByClassName("e-selection")[e];var s=[].slice.call(this.parent.element.getElementsByClassName("e-multi-range"));return s.forEach(function(l){(0,a.Od)(l)}),this.parent.getMainContent().getElementsByClassName("e-selection")[0]}},o.prototype.getActiveCell=function(){return this.parent.getMainContent().getElementsByClassName("e-active-cell")[0]},o.prototype.getSheetElement=function(){return document.getElementById(this.parent.element.id+"_sheet")},o.prototype.highlightHdr=function(t,e,i,r){var n=this;i===void 0&&(i=!0),r===void 0&&(r=!0);var s=this.parent.getActiveSheet();if(s.showHeaders){e||((0,a.IV)(this.getSheetElement().querySelectorAll(".e-highlight"),"e-highlight"),(0,a.IV)(this.getSheetElement().querySelectorAll(".e-prev-highlight"),"e-prev-highlight"));var l=this.parent.element.getElementsByClassName("e-select-all-cell")[0];l&&(0,a.IV)([l],["e-prev-highlight-right","e-prev-highlight-bottom"]);var h=[],c=[],u=(0,Ke.g)(t);this.isRowSelected&&(u[1]=(0,pe.Sxm)(s,u[1],!0,"columns")),this.isColSelected&&(u[0]=(0,pe.Sxm)(s,u[0],!0));var p=[0,0,0,0],f=[0,0,0,0],g=(0,Ke.n5)(s.topLeftCell),C,L,D=function(j,W,ne){var ie,me;j&&u[C]<j?(me=n.parent.hiddenCount(g[C],u[C],W,s),p[C]=u[C]-me-g[C],ie=u[L]<j?u[L]:j-1,p[L]=ie-n.parent.hiddenCount(u[C],ie,W,s)-me-g[C]+1,ie=n.parent.viewport[ne]+j,u[L]>=ie&&(f[C]=0,f[C]-=n.parent.hiddenCount(ie,ie,W,s),f[L]=u[L]-n.parent.hiddenCount(ie,u[L],W,s)-ie+1)):(ie=n.parent.viewport[ne]+j,me=n.parent.hiddenCount(ie,u[C],W,s),f[C]=u[C]-me-ie,f[L]=u[L]-n.parent.hiddenCount(u[C],u[L],W,s)-me-ie+1)},R=function(j,W,ne){for(var ie=[].slice.call(W.getElementsByClassName("e-header-cell")),me=j[C];me<j[L];me++)ie[me]&&ne.push(ie[me])};if(i){if(C=0,L=2,D(this.parent.frozenRowCount(s),"rows","topIndex"),s.frozenRows){var B=this.parent.getSelectAllContent().querySelector("tbody");B&&R(p,B,h)}R(f,this.parent.getRowHeaderContent(),h)}if(r){if(C=1,L=3,D(this.parent.frozenColCount(s),"columns","leftIndex"),s.frozenColumns){var H=this.parent.getSelectAllContent().querySelector("thead");H&&R(p,H,c)}R(f,this.parent.getColumnHeaderContent(),c)}s.isProtected&&!s.protectSettings.selectCells?(0,a.IV)([].concat(h,c),"e-highlight"):(0,a.cn)([].concat(h,c),"e-highlight"),h.length&&h[0].parentElement.previousElementSibling&&h[0].parentElement.previousElementSibling.classList.add("e-prev-highlight"),c.length&&c[0].previousElementSibling&&c[0].previousElementSibling.classList.add("e-prev-highlight"),this.isRowSelected&&this.isColSelected&&(s.isProtected&&!s.protectSettings.selectCells?document.getElementById(this.parent.element.id+"_select_all").classList.remove("e-highlight"):document.getElementById(this.parent.element.id+"_select_all").classList.add("e-highlight")),l&&(u[0]===0&&l.classList.add("e-prev-highlight-bottom"),u[1]===0&&l.classList.add("e-prev-highlight-right"))}},o.prototype.protectHandler=function(){var t=(0,Ke.dK)(this.parent.getActiveSheet().selectedRange),e=(0,Ke.g)(t),i=(0,Ke.n5)(this.parent.getActiveSheet().activeCell),r=e[0]<=i[0]&&e[2]>=i[0]&&e[1]<=i[1]&&e[3]>=i[1];this.selectRangeByIdx(t,null,null,r)},o.prototype.initiateFormulaSelection=function(t){this.processFormulaEditRange(t.range,t.formulaSheetIdx)},o.prototype.processFormulaEditRange=function(t,e){var i,r=e,n=0,s=this.parseFormula(t),l=s.length,h=0,c=[["e-vborderright","e-vborderbottom"],["e-pborderright","e-pborderbottom"],["e-cborderright","e-cborderbottom"],["e-gborderright","e-gborderbottom"],["e-oborderright","e-oborderbottom"],["e-bborderright","e-bborderbottom"]];this.clearBorder();for(var u=this.parent.getActiveSheet().id-1;n<l&&(i=s[n],!(this.invalidOperators.indexOf(i)>-1));){if((0,w.qhV)(i.toUpperCase())){if(i=i.replace(/\$/g,""),n>0&&s[n-1].indexOf("!")===s[n-1].length-1){var p=s[n-1].split("!");r=(0,w.Q8D)(this.parent,p[0].substring(1,p[0].length-1))}s[n+1]===":"&&(n++,s[n+1]&&(0,w.qhV)(s[n+1].toUpperCase())&&(i=i+":"+s[n+1],n++)),u===r&&this.updateFormulaEditRange(i,h,c),r=e,h++}n++}},o.prototype.updateFormulaEditRange=function(t,e,i){var r=(0,Ke.dK)(t);this.formulaRange[e]=t,this.dStartCell={rowIndex:r[0],colIndex:r[1]},this.dEndCell={rowIndex:r[2],colIndex:r[3]},this.focusBorder(this.dStartCell,this.dEndCell,i[e%6])},o.prototype.chartBorderHandler=function(t){this.focusBorder(t.startcell,t.endcell,t.classes,!0)},o.prototype.focusBorder=function(t,e,i,r){r=(0,a.le)(r)?!1:r;var n=(0,Ke.g)([t.rowIndex,t.colIndex,e.rowIndex,e.colIndex]),s=this.parent.getActiveSheet();if(s.frozenRows||s.frozenColumns){var l=this.parent.createElement("div",{className:r?"e-range-indicator e-chart-range":"e-range-indicator e-formuala-range"});l.appendChild(this.parent.createElement("div",{className:"e-top"})),l.appendChild(this.parent.createElement("div",{className:"e-bottom"})),l.appendChild(this.parent.createElement("div",{className:"e-left"})),l.appendChild(this.parent.createElement("div",{className:"e-right"})),M(this.parent,l,n,"e-range-indicator");return}var h=n[0],c=n[1],u=n[2],p=n[3];h&&this.getEleFromRange([h-1,c,h-1,p]).forEach(function(f){f&&(f.classList.add(i[1]),r||f.classList.add("e-formularef-selection"))}),this.getEleFromRange([h,p,u,p]).forEach(function(f){f&&(f.classList.add(i[0]),r||f.classList.add("e-formularef-selection"))}),this.getEleFromRange([u,c,u,p]).forEach(function(f){f&&(f.classList.add(i[1]),r||f.classList.add("e-formularef-selection"))}),c&&this.getEleFromRange([h,c-1,u,c-1]).forEach(function(f){f&&(f.classList.add(i[0]),r||f.classList.add("e-formularef-selection"))})},o.prototype.getEleFromRange=function(t){var e=t[0],i=t[1],r=t[2],n=t[3],s,l,h,c=[],u,p=[];if(e>r&&(h=e,e=r,r=h),i>n&&(h=i,i=n,n=h),this.parent.scrollSettings.enableVirtualization){for(s=e;s<=r;s++)if(l=s,l>-1){var f=this.parent.getRow(l,null);f&&(u=f.getElementsByClassName("e-cell"),c=n===i?[u[n]]:this.getRowCells(u,i,n+1),this.merge(p,c))}}return p},o.prototype.getRowCells=function(t,e,i){var r=[];for(e;e<i;e++)t[e]&&r.push(t[e]);return r},o.prototype.merge=function(t,e){!t||!e||Array.prototype.push.apply(t,e)},o.prototype.clearBorder=function(){var t=this.parent.getActiveSheet();if(t.frozenColumns||t.frozenRows){var e=[].slice.call(this.parent.element.getElementsByClassName("e-formuala-range"));e.forEach(function(h){(0,a.og)(h)});return}for(var i=this.parent.element.getElementsByClassName("e-formularef-selection"),r=0;r<i.length;r++)for(var n=i[r],s=["e-vborderright","e-vborderbottom","e-pborderright","e-pborderbottom","e-cborderright","e-cborderbottom","e-gborderright","e-gborderbottom","e-oborderright","e-oborderbottom","e-bborderright","e-bborderbottom"],l=0;l<s.length;l++)n.classList.remove(s[l])},o.prototype.parseFormula=function(t){var e,i,r=0,n=[];t=this.markSpecialChar(t.replace("=",""));for(var s=t.split(/\(|\)|=|\^|>|<|,|:|\+|-|\*|\/|%|&/g),l=s.length;r<l;){if(e=s[r],!e){r++;continue}if(e.length===1)n.push(this.isUniqueChar(e)?this.getUniqueCharVal(e):e);else if(i=e[0],e.indexOf("!")>0){this.isUniqueChar(i)&&(n.push(this.getUniqueCharVal(i)),e=e.substr(1));var h=e.indexOf("!")+1;n.push(e.substr(0,h)),n.push(e.substr(h))}else this.isUniqueChar(i)?(n.push(this.getUniqueCharVal(i)),n.push(e.substr(1))):n.push(e);r++}return n},o.prototype.isUniqueChar=function(t){var e=t.charCodeAt(t.charAt[0]);return e>=129&&e<=142},o.prototype.getUniqueCharVal=function(t){switch(t){case this.uniqueOBracket:return"(";case this.uniqueCBracket:return")";case this.uniqueCOperator:return":";case this.uniqueSOperator:return"-";case this.uniquePOperator:return"+";case this.uniqueMOperator:return"*";case this.uniqueDOperator:return"/";case this.uniqueModOperator:return"%";case this.uniqueCSeparator:return",";case this.uniqueConcateOperator:return"&";case this.uniqueEqualOperator:return"=";case this.uniqueExpOperator:return"^";case this.uniqueLTOperator:return"<";case this.uniqueGTOperator:return">"}return""},o.prototype.markSpecialChar=function(t){return t=t.replace(/\(/g,"("+this.uniqueOBracket).replace(/\)/g,")"+this.uniqueCBracket),t=t.replace(/,/g,","+this.uniqueCSeparator).replace(/:/g,":"+this.uniqueCOperator),t=t.replace(/\+/g,"+"+this.uniquePOperator).replace(/-/g,"-"+this.uniqueSOperator),t=t.replace(/\*/g,"*"+this.uniqueMOperator).replace(/\//g,"/"+this.uniqueDOperator),t=t.replace(/&/g,"&"+this.uniqueConcateOperator),t=t.replace(/=/g,"="+this.uniqueEqualOperator),t=t.replace(/\^/g,"^"+this.uniqueExpOperator),t=t.replace(/>/g,">"+this.uniqueGTOperator).replace(/</g,"<"+this.uniqueLTOperator),t.replace(/%/g,"%"+this.uniqueModOperator)},o.prototype.getModuleName=function(){return"selection"},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o}();function on(o,t,e,i,r,n){var s=i;if(i.tagName===t){var l=(0,a.NA)("ej2_instances",i);s=o("input",{attrs:{type:e}});for(var h=["change","cssClass","label","labelPosition","id"],c=0,u=i.attributes.length;c<u;c++)h.indexOf(i.attributes[c].nodeName)===-1&&s.setAttribute(i.attributes[c].nodeName,i.attributes[c].nodeValue);(0,a.Y4)(i,{class:r,"aria-checked":"false"}),i.appendChild(s),(0,a.sO)("ej2_instances",l,s),(0,a.ex)(i,"ej2_instances")}return s}function uo(o){for(var t,e=o.childNodes,i=0;i<e.length;i++)if(t=e[i],t.nodeType===3)return t;return null}function Rl(o,t,e){e==="INPUT"?(t.parentNode.insertBefore(o.element,t),detach(t),o.element.checked=!1,["name","value","disabled"].forEach(function(i){o.element.removeAttribute(i)})):(["role","aria-checked","class"].forEach(function(i){t.removeAttribute(i)}),t.innerHTML="")}function Ml(o,t,e,i,r){i=on(o.createElement,t,"checkbox",i,e,r),o.element=i,o.element.getAttribute("type")!=="checkbox"&&o.element.setAttribute("type","checkbox"),o.element.id||(o.element.id=getUniqueID("e-"+r))}function os(o,t,e){t===void 0&&(t=!1),e===void 0&&(e={});var i=o("div",{className:"e-checkbox-wrapper e-css"});if(e.cssClass&&(0,a.cn)([i],e.cssClass.split(" ")),e.enableRtl&&i.classList.add("e-rtl"),t){var r=o("span",{className:"e-ripple-container"});(0,a.qx)(r,{isCenterRipple:!0,duration:400}),i.appendChild(r)}var n=o("span",{className:"e-frame e-icons"});if(e.checked&&n.classList.add("e-check"),i.appendChild(n),e.label){var s=o("span",{className:"e-label"});e.disableHtmlEncode?s.textContent=e.label:s.innerHTML=e.label,i.appendChild(s)}return i}function ls(o,t){if(t){var e=document.createEvent("MouseEvents");e.initEvent(o.type,!1,!0),t.dispatchEvent(e)}}function po(o,t){o.element.getAttribute("ejs-for")&&t.appendChild(o.createElement("input",{attrs:{name:o.name||o.element.name,value:"false",type:"hidden"}}))}var Pl=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),yr=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Nl=new a.Qj,dr={RTL:"e-rtl",BUTTON:"e-btn",PRIMARY:"e-primary",ICONBTN:"e-icon-btn"},$r=function(o){Pl(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){},t.prototype.render=function(){this.initialize(),this.removeRippleEffect=(0,a.qx)(this.element,{selector:"."+dr.BUTTON}),this.renderComplete()},t.prototype.initialize=function(){if(this.cssClass&&(0,a.cn)([this.element],this.cssClass.split(" ")),this.isPrimary&&this.element.classList.add(dr.PRIMARY),!(0,a.xr)()||(0,a.xr)()&&this.getModuleName()!=="progress-btn"){if(this.content){var e=this.enableHtmlSanitizer?a.pJ.sanitize(this.content):this.content;this.element.innerHTML=e}this.setIconCss()}this.enableRtl&&this.element.classList.add(dr.RTL),this.disabled?this.controlStatus(this.disabled):this.wireEvents()},t.prototype.controlStatus=function(e){this.element.disabled=e},t.prototype.setIconCss=function(){if(this.iconCss){var e=this.createElement("span",{className:"e-btn-icon "+this.iconCss});this.element.textContent.trim()?(e.classList.add("e-icon-"+this.iconPosition.toLowerCase()),(this.iconPosition==="Top"||this.iconPosition==="Bottom")&&this.element.classList.add("e-"+this.iconPosition.toLowerCase()+"-icon-btn")):this.element.classList.add(dr.ICONBTN);var i=this.element.childNodes[0];i&&(this.iconPosition==="Left"||this.iconPosition==="Top")?this.element.insertBefore(e,i):this.element.appendChild(e)}},t.prototype.wireEvents=function(){this.isToggle&&a.bi.add(this.element,"click",this.btnClickHandler,this)},t.prototype.unWireEvents=function(){this.isToggle&&a.bi.remove(this.element,"click",this.btnClickHandler)},t.prototype.btnClickHandler=function(){this.element.classList.contains("e-active")?this.element.classList.remove("e-active"):this.element.classList.add("e-active")},t.prototype.destroy=function(){var e=[dr.PRIMARY,dr.RTL,dr.ICONBTN,"e-success","e-info","e-danger","e-warning","e-flat","e-outline","e-small","e-bigger","e-active","e-round","e-top-icon-btn","e-bottom-icon-btn"];this.cssClass&&(e=e.concat(this.cssClass.split(" "))),o.prototype.destroy.call(this),(0,a.IV)([this.element],e),this.element.getAttribute("class")||this.element.removeAttribute("class"),this.disabled&&this.element.removeAttribute("disabled"),this.content&&(this.element.innerHTML=this.element.innerHTML.replace(this.content,""));var i=this.element.querySelector("span.e-btn-icon");i&&(0,a.og)(i),this.unWireEvents(),a.re&&this.removeRippleEffect()},t.prototype.getModuleName=function(){return"btn"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.Inject=function(){},t.prototype.onPropertyChanged=function(e,i){for(var r=this.element.querySelector("span.e-btn-icon"),n=0,s=Object.keys(e);n<s.length;n++){var l=s[n];switch(l){case"isPrimary":e.isPrimary?this.element.classList.add(dr.PRIMARY):this.element.classList.remove(dr.PRIMARY);break;case"disabled":this.controlStatus(e.disabled);break;case"iconCss":{r?e.iconCss?(r.className="e-btn-icon "+e.iconCss,this.element.textContent.trim()&&(this.iconPosition==="Left"?r.classList.add("e-icon-left"):r.classList.add("e-icon-right"))):(0,a.og)(r):this.setIconCss();break}case"iconPosition":(0,a.IV)([this.element],["e-top-icon-btn","e-bottom-icon-btn"]),r=this.element.querySelector("span.e-btn-icon"),r&&(0,a.og)(r),this.setIconCss();break;case"cssClass":i.cssClass&&(0,a.IV)([this.element],i.cssClass.split(" ")),e.cssClass&&(0,a.cn)([this.element],e.cssClass.split(" "));break;case"enableRtl":e.enableRtl?this.element.classList.add(dr.RTL):this.element.classList.remove(dr.RTL);break;case"content":{var h=uo(this.element);h||this.element.classList.remove(dr.ICONBTN),(!(0,a.xr)()||(0,a.xr)()&&!this.isServerRendered&&this.getModuleName()!=="progress-btn")&&(this.enableHtmlSanitizer&&(e.content=a.pJ.sanitize(e.content)),this.element.innerHTML=e.content,this.setIconCss());break}case"isToggle":e.isToggle?a.bi.add(this.element,"click",this.btnClickHandler,this):(a.bi.remove(this.element,"click",this.btnClickHandler),(0,a.IV)([this.element],["e-active"]));break}}},t.prototype.click=function(){this.element.click()},t.prototype.focusIn=function(){this.element.focus()},yr([(0,a.Z9)("Left")],t.prototype,"iconPosition",void 0),yr([(0,a.Z9)("")],t.prototype,"iconCss",void 0),yr([(0,a.Z9)(!1)],t.prototype,"disabled",void 0),yr([(0,a.Z9)(!1)],t.prototype,"isPrimary",void 0),yr([(0,a.Z9)("")],t.prototype,"cssClass",void 0),yr([(0,a.Z9)("")],t.prototype,"content",void 0),yr([(0,a.Z9)(!1)],t.prototype,"isToggle",void 0),yr([(0,a.Z9)()],t.prototype,"locale",void 0),yr([(0,a.Z9)(!1)],t.prototype,"enableHtmlSanitizer",void 0),yr([(0,a.ju)()],t.prototype,"created",void 0),t=yr([a.Zl],t),t}(a.wA),Dr,ln,hs,cs,Hs=!1;function wa(o,t){var e=!1,i={left:0,top:0},r=o;if(!o||!t)return i;for((0,a.le)(t.offsetParent)&&t.style.position==="fixed"&&(e=!0);(t.offsetParent||e)&&o&&t.offsetParent!==o;)i.left+=o.offsetLeft,i.top+=o.offsetTop,o=o.offsetParent;for(o=r;(t.offsetParent||e)&&o&&t.offsetParent!==o;)i.left-=o.scrollLeft,i.top-=o.scrollTop,o=o.parentElement;return i}function Di(o,t,e,i,r){if(ln=void 0,ln=r,Hs=!!i,!o)return{left:0,top:0};t||(t="left"),e||(e="top"),cs=o.ownerDocument,hs=o;var n={left:0,top:0};return Bl(t.toLowerCase(),e.toLowerCase(),n)}function Hr(o,t){t.left=o}function Qr(o,t){t.top=o}function Bl(o,t,e){switch(Dr=hs.getBoundingClientRect(),t+o){case"topcenter":Hr(js(),e),Qr(Ea(),e);break;case"topright":Hr(_s(),e),Qr(Ea(),e);break;case"centercenter":Hr(js(),e),Qr(zs(),e);break;case"centerright":Hr(_s(),e),Qr(zs(),e);break;case"centerleft":Hr(us(),e),Qr(zs(),e);break;case"bottomcenter":Hr(js(),e),Qr(Vs(),e);break;case"bottomright":Hr(_s(),e),Qr(Vs(),e);break;case"bottomleft":Hr(us(),e),Qr(Vs(),e);break;default:case"topleft":Hr(us(),e),Qr(Ea(),e);break}return e}function xa(){return cs.documentElement.scrollTop||cs.body.scrollTop}function fo(){return cs.documentElement.scrollLeft||cs.body.scrollLeft}function Vs(){return Hs?Dr.bottom:Dr.bottom+xa()}function zs(){return Ea()+Dr.height/2}function Ea(){return Hs?Dr.top:Dr.top+xa()}function us(){return Dr.left+fo()}function _s(){var o=hs&&hs.classList.contains("e-date-range-wrapper")?ln?ln.width:0:ln&&Dr.width>=ln.width?ln.width:0;return Dr.right+fo()-o}function js(){return us()+Dr.width/2}var hn,rr;function Ws(o,t,e,i){if(t===void 0&&(t=null),e===void 0&&(e={X:!1,Y:!1}),!e.Y&&!e.X)return{left:0,top:0};var r=o.getBoundingClientRect();if(rr=t,hn=o.ownerDocument,i||(i=Di(o,"left","top")),e.X){var n=rr?ka():Ma(),s=Zs(),l=Ys(),h=s-i.left,c=i.left+r.width-l;r.width>n?h>0&&c<=0?i.left=l-r.width:c>0&&h<=0?i.left=s:i.left=h>c?l-r.width:s:h>0?i.left+=h:c>0&&(i.left-=c)}if(e.Y){var u=rr?Ia():Ra(),p=qs(),f=Gs(),g=p-i.top,C=i.top+r.height-f;r.height>u?g>0&&C<=0?i.top=f-r.height:C>0&&g<=0?i.top=p:i.top=g>C?f-r.height:p:g>0?i.top+=g:C>0&&(i.top-=C)}return i}function Vr(o,t,e,i){t===void 0&&(t=null);var r=Di(o,"left","top");e&&(r.left=e),i&&(r.top=i);var n=[];rr=t,hn=o.ownerDocument;var s=o.getBoundingClientRect(),l=r.top,h=r.left,c=r.left+s.width,u=r.top+s.height,p="",f="",g=La(l,u),C=Aa(h,c);return g.topSide&&n.push("top"),C.rightSide&&n.push("right"),C.leftSide&&n.push("left"),g.bottomSide&&n.push("bottom"),n}function vo(o,t,e,i,r,n,s,l,h){if(s===void 0&&(s=null),l===void 0&&(l={X:!0,Y:!0}),!(!t||!o||!r||!n||!l.X&&!l.Y)){var c={TL:null,TR:null,BL:null,BR:null},u={TL:null,TR:null,BL:null,BR:null},p;if(window.getComputedStyle(o).display==="none"){var f=o.style.visibility;o.style.visibility="hidden",o.style.display="block",p=o.getBoundingClientRect(),o.style.removeProperty("display"),o.style.visibility=f}else p=o.getBoundingClientRect();var g={posX:r,posY:n,offsetX:e,offsetY:i,position:{left:0,top:0}};rr=s,hn=t.ownerDocument,go(t,c,g,h,p),Us(u,g,p),l.X&&yo(t,u,c,g,p,!0),l.Y&&c.TL.top>-1&&Ta(t,u,c,g,p,!0),mo(o,g,p)}}function mo(o,t,e){var i=0,r=0;if(o.offsetParent!=null&&(getComputedStyle(o.offsetParent).position==="absolute"||getComputedStyle(o.offsetParent).position==="relative")){var n=Di(o.offsetParent,"left","top",!1,e);i=n.left,r=n.top}o.style.top=t.position.top+t.offsetY-r+"px",o.style.left=t.position.left+t.offsetX-i+"px"}function go(o,t,e,i,r){e.position=Di(o,e.posX,e.posY,i,r),t.TL=Di(o,"left","top",i,r),t.TR=Di(o,"right","top",i,r),t.BR=Di(o,"left","bottom",i,r),t.BL=Di(o,"right","bottom",i,r)}function Us(o,t,e){o.TL={top:t.position.top+t.offsetY,left:t.position.left+t.offsetX},o.TR={top:o.TL.top,left:o.TL.left+e.width},o.BL={top:o.TL.top+e.height,left:o.TL.left},o.BR={top:o.TL.top+e.height,left:o.TL.left+e.width}}function Aa(o,t){var e=!1,i=!1;return o-ds()<Zs()&&(e=!0),t>Ys()&&(i=!0),{leftSide:e,rightSide:i}}function yo(o,t,e,i,r,n){var s=Aa(t.TL.left,t.TR.left);e.TL.left-ds()<=Zs()&&(s.leftSide=!1),e.TR.left>Ys()&&(s.rightSide=!1),(s.leftSide&&!s.rightSide||!s.leftSide&&s.rightSide)&&(i.posX==="right"?i.posX="left":i.posX="right",i.offsetX=i.offsetX+r.width,i.offsetX=-1*i.offsetX,i.position=Di(o,i.posX,i.posY,!1),Us(t,i,r),n&&yo(o,t,e,i,r,!1))}function Ta(o,t,e,i,r,n){var s=La(t.TL.top,t.BL.top);e.TL.top-ps()<=qs()&&(s.topSide=!1),e.BL.top>=Gs()&&o.getBoundingClientRect().bottom<window.innerHeight&&(s.bottomSide=!1),(s.topSide&&!s.bottomSide||!s.topSide&&s.bottomSide)&&(i.posY==="top"?i.posY="bottom":i.posY="top",i.offsetY=i.offsetY+r.height,i.offsetY=-1*i.offsetY,i.position=Di(o,i.posX,i.posY,!1,r),Us(t,i,r),n&&Ta(o,t,e,i,r,!1))}function La(o,t){var e=!1,i=!1;return o-ps()<qs()&&(e=!0),t>Gs()&&(i=!0),{topSide:e,bottomSide:i}}function ka(){return rr.getBoundingClientRect().width}function Ia(){return rr.getBoundingClientRect().height}function Da(){return rr.getBoundingClientRect().left}function Oa(){return rr.getBoundingClientRect().top}function qs(){return rr?Oa():0}function Zs(){return rr?Da():0}function Ys(){return rr?ds()+Da()+ka():ds()+Ma()}function Gs(){return rr?ps()+Oa()+Ia():ps()+Ra()}function ps(){return hn.documentElement.scrollTop||hn.body.scrollTop}function ds(){return hn.documentElement.scrollLeft||hn.body.scrollLeft}function Ra(){return window.innerHeight}function Ma(){var o=window.innerWidth,t=document.documentElement.getBoundingClientRect(),e=(0,a.le)(document.documentElement)?0:t.width;return o-(o-e)}var Pa=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ti=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Na=function(o){Pa(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ti([(0,a.Z9)("left")],t.prototype,"X",void 0),Ti([(0,a.Z9)("top")],t.prototype,"Y",void 0),t}(a.rt),Ni={ROOT:"e-popup",RTL:"e-rtl",OPEN:"e-popup-open",CLOSE:"e-popup-close"},br=function(o){Pa(t,o);function t(e,i){return o.call(this,i,e)||this}return t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"width":(0,a.V7)(this.element,{width:(0,a.Ac)(e.width)});break;case"height":(0,a.V7)(this.element,{height:(0,a.Ac)(e.height)});break;case"zIndex":(0,a.V7)(this.element,{zIndex:e.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":var l=e.offsetX-i.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+l).toString()+"px";break;case"offsetY":var h=e.offsetY-i.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+h).toString()+"px";break;case"content":this.setContent();break;case"actionOnScroll":e.actionOnScroll!=="none"?this.wireScrollEvents():this.unwireScrollEvents();break}}},t.prototype.getModuleName=function(){return"popup"},t.prototype.resolveCollision=function(){this.checkCollision()},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.destroy=function(){this.element.classList.remove(Ni.ROOT,Ni.RTL,Ni.OPEN,Ni.CLOSE),this.element.classList.contains("e-popup-open")&&this.unwireEvents(),o.prototype.destroy.call(this)},t.prototype.render=function(){this.element.classList.add(Ni.ROOT);var e={};this.zIndex!==1e3&&(e.zIndex=this.zIndex),this.width!=="auto"&&(e.width=(0,a.Ac)(this.width)),this.height!=="auto"&&(e.height=(0,a.Ac)(this.height)),(0,a.V7)(this.element,e),this.fixedParent=!1,this.setEnableRtl(),this.setContent()},t.prototype.wireEvents=function(){a.AR.isDevice&&a.bi.add(window,"orientationchange",this.orientationOnChange,this),this.actionOnScroll!=="none"&&this.wireScrollEvents()},t.prototype.wireScrollEvents=function(){if(this.getRelateToElement())for(var e=0,i=this.getScrollableParent(this.getRelateToElement());e<i.length;e++){var r=i[e];a.bi.add(r,"scroll",this.scrollRefresh,this)}},t.prototype.unwireEvents=function(){a.AR.isDevice&&a.bi.remove(window,"orientationchange",this.orientationOnChange),this.actionOnScroll!=="none"&&this.unwireScrollEvents()},t.prototype.unwireScrollEvents=function(){if(this.getRelateToElement())for(var e=0,i=this.getScrollableParent(this.getRelateToElement());e<i.length;e++){var r=i[e];a.bi.remove(r,"scroll",this.scrollRefresh)}},t.prototype.getRelateToElement=function(){var e=this.relateTo===""||(0,a.le)(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:e},!0),typeof this.relateTo=="string"?document.querySelector(this.relateTo):this.relateTo},t.prototype.scrollRefresh=function(e){if(this.actionOnScroll==="reposition"?!(0,a.le)(this.element)&&!(this.element.offsetParent===e.target||this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&e.target.parentElement==null)&&this.refreshPosition():this.actionOnScroll==="hide"&&this.hide(),this.actionOnScroll!=="none"&&this.getRelateToElement()){var i=this.isElementOnViewport(this.getRelateToElement(),e.target);!i&&!this.targetInvisibleStatus?(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0):i&&(this.targetInvisibleStatus=!1)}},t.prototype.isElementOnViewport=function(e,i){for(var r=this.getScrollableParent(e),n=0;n<r.length;n++)if(!this.isElementVisible(e,r[n]))return!1;return!0},t.prototype.isElementVisible=function(e,i){var r=this.checkGetBoundingClientRect(e);if(!r.height||!r.width)return!1;if((0,a.le)(this.checkGetBoundingClientRect(i))){var s=window,l={top:s.scrollY,left:s.scrollX,right:s.scrollX+s.outerWidth,bottom:s.scrollY+s.outerHeight},h=Di(e),c={top:h.top,left:h.left,right:h.left+r.width,bottom:h.top+r.height},u={top:l.bottom-c.top,left:l.right-c.left,bottom:c.bottom-l.top,right:c.right-l.left};return u.top>0&&u.left>0&&u.right>0&&u.bottom>0}else{var n=i.getBoundingClientRect();return!(r.bottom<n.top)&&!(r.bottom>n.bottom)&&!(r.right>n.right)&&!(r.left<n.left)}},t.prototype.preRender=function(){},t.prototype.setEnableRtl=function(){this.reposition(),this.enableRtl?this.element.classList.add(Ni.RTL):this.element.classList.remove(Ni.RTL)},t.prototype.setContent=function(){if(!(0,a.le)(this.content))if(this.element.innerHTML="",typeof this.content=="string")this.element.textContent=this.content;else{var e=this.getRelateToElement(),i=this.content.props;(!e.classList.contains("e-dropdown-btn")||(0,a.le)(i))&&this.element.appendChild(this.content)}},t.prototype.orientationOnChange=function(){var e=this;setTimeout(function(){e.refreshPosition()},200)},t.prototype.refreshPosition=function(e,i){(0,a.le)(e)||this.checkFixedParent(e),this.reposition(),i||this.checkCollision()},t.prototype.reposition=function(){var e,i,r=this.getRelateToElement();if(typeof this.position.X=="number"&&typeof this.position.Y=="number")e={left:this.position.X,top:this.position.Y};else if(typeof this.position.X=="string"&&typeof this.position.Y=="number"||typeof this.position.X=="number"&&typeof this.position.Y=="string"){var n=void 0,s=this.element.style.display;this.element.style.display="block",this.element.classList.contains("e-dlg-modal")&&(n=this.element.parentElement.style.display,this.element.parentElement.style.display="block"),i=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY),typeof this.position.X=="string"?e={left:i.left,top:this.position.Y}:e={left:this.position.X,top:i.top},this.element.style.display=s,this.element.classList.contains("e-dlg-modal")&&(this.element.parentElement.style.display=n)}else if(r){var s=this.element.style.display;this.element.style.display="block",e=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY),this.element.style.display=s}else e={left:0,top:0};(0,a.le)(e)||(this.element.style.left=e.left+"px",this.element.style.top=e.top+"px")},t.prototype.checkGetBoundingClientRect=function(e){var i;try{return i=e.getBoundingClientRect(),i}catch(r){return null}},t.prototype.getAnchorPosition=function(e,i,r,n,s){var l=this.checkGetBoundingClientRect(i),h=this.checkGetBoundingClientRect(e);if((0,a.le)(l)||(0,a.le)(h))return null;var c=e,u={left:0,top:0};switch(i.offsetParent&&i.offsetParent.tagName==="BODY"&&e.tagName==="BODY"?u=Di(e):(i.classList.contains("e-dlg-modal")&&c.tagName!=="BODY"&&(i=i.parentElement),u=wa(c,i)),r.X){default:case"left":break;case"center":i.classList.contains("e-dlg-modal")&&c.tagName==="BODY"&&this.targetType==="container"?u.left+=window.innerWidth/2-l.width/2:this.targetType==="container"?u.left+=h.width/2-l.width/2:u.left+=h.width/2;break;case"right":i.classList.contains("e-dlg-modal")&&c.tagName==="BODY"&&this.targetType==="container"?u.left+=window.innerWidth-l.width:this.targetType==="container"?u.left+=h.width-l.width:u.left+=h.width;break}switch(r.Y){default:case"top":break;case"center":i.classList.contains("e-dlg-modal")&&c.tagName==="BODY"&&this.targetType==="container"?u.top+=window.innerHeight/2-l.height/2:this.targetType==="container"?u.top+=h.height/2-l.height/2:u.top+=h.height/2;break;case"bottom":i.classList.contains("e-dlg-modal")&&c.tagName==="BODY"&&this.targetType==="container"?u.top+=window.innerHeight-l.height:this.targetType==="container"?u.top+=h.height-l.height:u.top+=h.height;break}return u.left+=n,u.top+=s,u},t.prototype.callFlip=function(e){var i=this.getRelateToElement();vo(this.element,i,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,e,this.fixedParent)},t.prototype.callFit=function(e){if(Vr(this.element,this.viewPortElement).length!==0)if((0,a.le)(this.viewPortElement)){var i=Ws(this.element,this.viewPortElement,e);e.X&&(this.element.style.left=i.left+"px"),e.Y&&(this.element.style.top=i.top+"px")}else{var r=this.checkGetBoundingClientRect(this.element),n=this.checkGetBoundingClientRect(this.viewPortElement);if((0,a.le)(r)||(0,a.le)(n))return null;e&&e.Y===!0&&(n.top>r.top?this.element.style.top="0px":n.bottom<r.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(r.bottom-n.bottom)+"px")),e&&e.X===!0&&(n.right<r.right?this.element.style.left=parseInt(this.element.style.left,10)-(r.right-n.right)+"px":n.left>r.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(n.left-r.left)+"px"))}},t.prototype.checkCollision=function(){var e=this.collision.X,i=this.collision.Y;e==="none"&&i==="none"||(e==="flip"&&i==="flip"?this.callFlip({X:!0,Y:!0}):e==="fit"&&i==="fit"?this.callFit({X:!0,Y:!0}):(e==="flip"?this.callFlip({X:!0,Y:!1}):i==="flip"&&this.callFlip({Y:!0,X:!1}),e==="fit"?this.callFit({X:!0,Y:!1}):i==="fit"&&this.callFit({X:!1,Y:!0})))},t.prototype.show=function(e,i){var r=this;if(this.wireEvents(),this.zIndex===1e3||!(0,a.le)(i)){var n=(0,a.le)(i)?this.element:i;this.zIndex=cn(n),(0,a.V7)(this.element,{zIndex:this.zIndex})}e=!(0,a.le)(e)&&typeof e=="object"?e:this.showAnimation,(this.collision.X!=="none"||this.collision.Y!=="none")&&((0,a.IV)([this.element],Ni.CLOSE),(0,a.cn)([this.element],Ni.OPEN),this.checkCollision(),(0,a.IV)([this.element],Ni.OPEN),(0,a.cn)([this.element],Ni.CLOSE)),(0,a.le)(e)?((0,a.IV)([this.element],Ni.CLOSE),(0,a.cn)([this.element],Ni.OPEN),this.trigger("open")):(e.begin=function(){r.isDestroyed||((0,a.IV)([r.element],Ni.CLOSE),(0,a.cn)([r.element],Ni.OPEN))},e.end=function(){r.isDestroyed||r.trigger("open")},new a.fw(e).animate(this.element))},t.prototype.hide=function(e){var i=this;e=!(0,a.le)(e)&&typeof e=="object"?e:this.hideAnimation,(0,a.le)(e)?((0,a.IV)([this.element],Ni.OPEN),(0,a.cn)([this.element],Ni.CLOSE),this.trigger("close")):(e.end=function(){i.isDestroyed||((0,a.IV)([i.element],Ni.OPEN),(0,a.cn)([i.element],Ni.CLOSE),i.trigger("close"))},new a.fw(e).animate(this.element)),this.unwireEvents()},t.prototype.getScrollableParent=function(e){return this.checkFixedParent(e),Ks(e,this.fixedParent)},t.prototype.checkFixedParent=function(e){for(var i=e.parentElement;i&&i.tagName!=="HTML";){var r=getComputedStyle(i);r.position==="fixed"&&!(0,a.le)(this.element)&&this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&(this.element.style.top=window.scrollY>parseInt(this.element.style.top)?(0,a.Ac)(window.scrollY-parseInt(this.element.style.top)):(0,a.Ac)(parseInt(this.element.style.top)-window.scrollY),this.element.style.position="fixed",this.fixedParent=!0),i=i.parentElement,!(0,a.le)(this.element)&&(0,a.le)(this.element.offsetParent)&&r.position==="fixed"&&this.element.style.position==="fixed"&&(this.fixedParent=!0)}},Ti([(0,a.Z9)("auto")],t.prototype,"height",void 0),Ti([(0,a.Z9)("auto")],t.prototype,"width",void 0),Ti([(0,a.Z9)(null)],t.prototype,"content",void 0),Ti([(0,a.Z9)("container")],t.prototype,"targetType",void 0),Ti([(0,a.Z9)(null)],t.prototype,"viewPortElement",void 0),Ti([(0,a.Z9)({X:"none",Y:"none"})],t.prototype,"collision",void 0),Ti([(0,a.Z9)("")],t.prototype,"relateTo",void 0),Ti([(0,a.Zz)({},Na)],t.prototype,"position",void 0),Ti([(0,a.Z9)(0)],t.prototype,"offsetX",void 0),Ti([(0,a.Z9)(0)],t.prototype,"offsetY",void 0),Ti([(0,a.Z9)(1e3)],t.prototype,"zIndex",void 0),Ti([(0,a.Z9)(!1)],t.prototype,"enableRtl",void 0),Ti([(0,a.Z9)("reposition")],t.prototype,"actionOnScroll",void 0),Ti([(0,a.Z9)(null)],t.prototype,"showAnimation",void 0),Ti([(0,a.Z9)(null)],t.prototype,"hideAnimation",void 0),Ti([(0,a.ju)()],t.prototype,"open",void 0),Ti([(0,a.ju)()],t.prototype,"close",void 0),Ti([(0,a.ju)()],t.prototype,"targetExitViewport",void 0),t=Ti([a.Zl],t),t}(a.wA);function Ks(o,t){for(var e=getComputedStyle(o),i=[],r=/(auto|scroll)/,n=o.parentElement;n&&n.tagName!=="HTML";){var s=getComputedStyle(n);!(e.position==="absolute"&&s.position==="static")&&r.test(s.overflow+s.overflowY+s.overflowX)&&i.push(n),n=n.parentElement}return t||i.push(document),i}function cn(o){for(var t=o.parentElement,e=[];t&&t.tagName!=="BODY";){var i=document.defaultView.getComputedStyle(t,null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(t,null).getPropertyValue("position");i!=="auto"&&r!=="static"&&e.push(i),t=t.parentElement}for(var n=[],s=0;s<document.body.children.length;s++)if(!o.isEqualNode(document.body.children[s])){var i=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&n.push(i)}n.push("999");var l=[];if(!(0,a.le)(o.parentElement)&&o.parentElement.tagName!=="BODY"){for(var h=[].slice.call(o.parentElement.children),s=0;s<h.length;s++)if(!o.isEqualNode(h[s])){var i=document.defaultView.getComputedStyle(h[s],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(h[s],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&l.push(i)}}var c=e.concat(n,l),u=Math.max.apply(Math,c)+1;return u>2147483647?2147483647:u}function Fl(o){o===void 0&&(o=["*"]);for(var t=[],e=0;e<o.length;e++)for(var i=document.getElementsByTagName(o[e]),r=0;r<i.length;r++){var n=document.defaultView.getComputedStyle(i[r],null).getPropertyValue("z-index"),s=document.defaultView.getComputedStyle(i[r],null).getPropertyValue("position");n!=="auto"&&s!=="static"&&t.push(n)}var l=Math.max.apply(Math,t)+1;return l>2147483647?2147483647:l}var bo=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),fs=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n};function Xs(o,t){for(var e=(0,a.l7)({},o),i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];t.indexOf(n)<0&&(0,a.ex)(e,n)}return e}function Fc(o,t){var e=t===40?0:o.childElementCount-1,i=e,r,n=o.querySelector(".e-selected");n&&n.classList.remove("e-selected");for(var s=0,l=o.children.length;s<l;s++)o.children[s].classList.contains("e-focused")&&(r=o.children[s],i=s,r.classList.remove("e-focused"),t===40?i++:i--,i===(t===40?o.childElementCount:-1)&&(i=e));r=o.children[i],i=Hl(o,r,i,t),i!==-1&&((0,a.cn)([o.children[i]],"e-focused"),o.children[i].focus())}function Hl(o,t,e,i,r){if(r===void 0&&(r=0),(t.classList.contains("e-separator")||t.classList.contains("e-disabled"))&&(e===(i===40?o.childElementCount-1:0)?e=i===40?0:o.childElementCount-1:i===40?e++:e--),t=o.children[e],t.classList.contains("e-separator")||t.classList.contains("e-disabled")){if(r++,r===o.childElementCount)return e=-1;e=Hl(o,t,e,i,r)}return e}function Hc(o){var t=[].slice.call(o.getElementsByClassName("e-blank-icon"));if(!!t.length){var e=o.querySelector(".e-item:not(.e-blank-icon):not(.e-separator)");if(!(0,a.le)(e)){e.classList.contains("e-url")&&(e=e.querySelector(".e-menu-url"));var i=e.querySelector(".e-menu-icon"),r,n=o.classList.contains("e-rtl");n?r={padding:"paddingRight",margin:"marginLeft"}:r={padding:"paddingLeft",margin:"marginRight"};var s=parseInt(getComputedStyle(i).fontSize,10)+parseInt(getComputedStyle(i)[r.margin],10)+parseInt(getComputedStyle(e).paddingLeft,10)+"px";t.forEach(function(l){l.classList.contains("e-url")?l.querySelector(".e-menu-url").style[r.padding]=s:l.style[r.padding]=s})}}}var Co=function(o){bo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return fs([(0,a.Z9)("")],t.prototype,"iconCss",void 0),fs([(0,a.Z9)("")],t.prototype,"id",void 0),fs([(0,a.Z9)(!1)],t.prototype,"separator",void 0),fs([(0,a.Z9)("")],t.prototype,"text",void 0),fs([(0,a.Z9)("")],t.prototype,"url",void 0),fs([(0,a.Z9)(!1)],t.prototype,"disabled",void 0),t}(a.rt),Vc=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Qi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},xn={DISABLED:"e-disabled",FOCUS:"e-focused",ICON:"e-menu-icon",ITEM:"e-item",POPUP:"e-dropdown-popup",RTL:"e-rtl",SEPARATOR:"e-separator",VERTICAL:"e-vertical"},Bi=function(o){Vc(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.isPopupCreated=!0,r}return t.prototype.preRender=function(){},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.toggle=function(){this.canOpen()?this.openPopUp():this.closePopup()},t.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete()},t.prototype.addItems=function(e,i){for(var r,n=this.items.length,s=0,l=this.items.length;s<l;s++)if(i===this.items[s].text){n=s;break}for(var h=e.length-1;h>=0;h--)r=new Co(this,"items",e[h],!0),this.items.splice(n,0,r);this.canOpen()||this.createItems()},t.prototype.removeItems=function(e,i){for(var r=!1,n=0,s=e.length;n<s;n++)for(var l=0,h=this.items.length;l<h;l++)if(e[n]===(i?this.items[l].id:this.items[l].text)){this.items.splice(l,1),r=!0;break}r&&this.getULElement()&&this.createItems()},t.prototype.createPopup=function(){var e,i=this.createElement("div",{className:xn.POPUP,id:this.element.id+"-popup"});document.body.appendChild(i),this.dropDown=new br(i,{relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",enableRtl:this.enableRtl}),this.dropDown.element.style.position==="fixed"&&this.dropDown.refreshPosition(this.element),this.dropDown.hide(),(0,a.Y4)(this.element,(e={},e["aria-haspopup"]=this.items.length||this.target?"true":"false",e["aria-expanded"]="false",e["aria-owns"]=this.getPopUpElement().id,e.type="button",e["aria-label"]=this.element.textContent+" dropdownbutton",e)),this.cssClass&&(0,a.cn)([i],this.cssClass.split(" ")),this.isPopupCreated=!0},t.prototype.getTargetElement=function(){return typeof this.target=="string"?(0,a.Ys)(this.target):this.target},t.prototype.createItems=function(e){var i=this.items,r=this.hasIcon(this.items,"iconCss"),n,s,l,h,c=this.getULElement();c?c.innerHTML="":c=this.createElement("ul",{attrs:{role:"menu",tabindex:"0"}});for(var u=0;u<i.length;u++){s=i[u];var p=s.text;l=this.createElement("li",{className:s.separator?xn.ITEM+" "+xn.SEPARATOR:xn.ITEM,attrs:{role:"menuItem",tabindex:"-1"},id:s.id?s.id:(0,a.QI)("e-"+this.getModuleName()+"-item")}),this.enableHtmlSanitizer?l.textContent=s.url?"":p:l.innerHTML=s.url?"":p,s.url&&(l.appendChild(this.createAnchor(s)),l.classList.add("e-url")),s.iconCss?(n=this.createElement("span",{className:xn.ICON+" "+s.iconCss}),s.url?l.childNodes[0].appendChild(n):l.insertBefore(n,l.childNodes[0])):r&&!s.separator&&l.classList.add("e-blank-icon"),s.disabled&&l.classList.add("e-disabled"),h={item:s,element:l},this.trigger("beforeItemRender",h),c.appendChild(l)}e&&this.getPopUpElement().appendChild(c),r&&Hc(this.getPopUpElement())},t.prototype.hasIcon=function(e,i){for(var r=0,n=e.length;r<n;r++)if(e[r][i])return!0;return!1},t.prototype.createAnchor=function(e){var i=this.enableHtmlSanitizer?a.pJ.sanitize(e.text):e.text;return this.createElement("a",{className:"e-menu-text e-menu-url",innerHTML:i,attrs:{href:e.url}})},t.prototype.initialize=function(){this.button=new $r({iconCss:this.iconCss,iconPosition:this.iconPosition,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence}),this.button.createElement=this.createElement,this.button.appendTo(this.element),this.element.id||(this.element.id=(0,a.QI)("e-"+this.getModuleName())),this.appendArrowSpan(),this.setActiveElem([this.element]),this.target&&!this.isColorPicker()||!this.createPopupOnClick?this.createPopup():this.isPopupCreated=!1},t.prototype.isColorPicker=function(){if(!this.element)return!1;var e=this.element.previousSibling;return!!(e&&e.classList&&e.classList.contains("e-split-colorpicker"))},t.prototype.appendArrowSpan=function(){this.element.appendChild(this.createElement("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf(xn.VERTICAL)>-1?"bottom":"right")+" e-caret"}))},t.prototype.setActiveElem=function(e){this.activeElem=e},t.prototype.getModuleName=function(){return"dropdown-btn"},t.prototype.canOpen=function(){var e=!1;return this.isPopupCreated&&(e=this.getPopUpElement().classList.contains("e-popup-close")),e},t.prototype.destroy=function(){var e=this;if(o.prototype.destroy.call(this),this.getModuleName()==="dropdown-btn"){var i;this.element.querySelector("span.e-caret")&&(0,a.og)(this.element.querySelector("span.e-caret")),this.cssClass&&(i=this.cssClass.split(" ")),this.button.destroy(),i&&(0,a.IV)([this.element],i),(0,a.IV)(this.activeElem,["e-active"]);var r=this.element.getAttribute("class")?["aria-haspopup","aria-expanded","aria-owns","type"]:["aria-haspopup","aria-expanded","aria-owns","type","class"];r.forEach(function(n){e.element.removeAttribute(n)}),this.popupUnWireEvents(),this.destroyPopup(),this.isPopupCreated=!1,this.disabled||this.unWireEvents()}},t.prototype.destroyPopup=function(){if(this.isPopupCreated){if(this.dropDown.destroy(),this.getPopUpElement()){var e=document.getElementById(this.getPopUpElement().id);e&&((0,a.IV)([e],["e-popup-open","e-popup-close"]),(0,a.og)(e))}a.bi.remove(this.getPopUpElement(),"click",this.clickHandler),a.bi.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler),this.isPopupCreated&&(this.dropDown=void 0)}this.isPopupCreated=!1},t.prototype.getPopUpElement=function(){var e=null;return this.dropDown&&(e=this.dropDown.element),e},t.prototype.getULElement=function(){var e=null;return this.getPopUpElement()&&(e=this.getPopUpElement().children[0]),e},t.prototype.wireEvents=function(){this.delegateMousedownHandler=this.mousedownHandler.bind(this),this.createPopupOnClick||a.bi.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),a.bi.add(this.element,"click",this.clickHandler,this),a.bi.add(this.element,"keydown",this.keyBoardHandler,this)},t.prototype.popupWireEvents=function(){var e=this.getPopUpElement();this.createPopupOnClick&&a.bi.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),e&&(a.bi.add(e,"click",this.clickHandler,this),a.bi.add(e,"keydown",this.keyBoardHandler,this)),this.rippleFn=(0,a.qx)(e,{selector:"."+xn.ITEM})},t.prototype.popupUnWireEvents=function(){var e=this.getPopUpElement();this.createPopupOnClick&&a.bi.remove(document,"mousedown touchstart",this.delegateMousedownHandler),e&&e.parentElement&&(a.bi.remove(e,"click",this.clickHandler),a.bi.remove(e,"keydown",this.keyBoardHandler))},t.prototype.keyBoardHandler=function(e){if(!(e.target===this.element&&(e.keyCode===9||!e.altKey&&e.keyCode===40||e.keyCode===38)))switch(e.keyCode){case 38:case 40:e.altKey&&(e.keyCode===38||e.keyCode===40)?this.keyEventHandler(e):this.upDownKeyHandler(e);break;case 9:case 13:case 27:case 32:this.keyEventHandler(e);break}},t.prototype.upDownKeyHandler=function(e){this.target&&(e.keyCode===38||e.keyCode===40)||(e.preventDefault(),Fc(this.getULElement(),e.keyCode))},t.prototype.keyEventHandler=function(e){this.target&&(e.keyCode===13||e.keyCode===9)||e.target&&e.target.className.indexOf("e-edit-template")>-1&&e.keyCode===32||(e.keyCode!==9&&e.preventDefault(),e.keyCode===27||e.keyCode===38||e.keyCode===9?this.canOpen()||this.closePopup(e,this.element):this.clickHandler(e))},t.prototype.getLI=function(e){return e.tagName==="LI"?e:(0,a.oq)(e,"li")},t.prototype.mousedownHandler=function(e){var i=e.target;this.dropDown&&!this.canOpen()&&!((0,a.oq)(i,'[id="'+this.getPopUpElement().id+'"]')||(0,a.oq)(i,'[id="'+this.element.id+'"]'))&&this.closePopup(e)},t.prototype.clickHandler=function(e){var i=e.target;if((0,a.oq)(i,'[id="'+this.element.id+'"]'))!this.createPopupOnClick||this.target&&!this.isColorPicker()?this.getPopUpElement().classList.contains("e-popup-close")?this.openPopUp(e):this.closePopup(e):this.isPopupCreated?this.closePopup(e,this.activeElem[0]):(this.createPopup(),this.openPopUp(e));else if((0,a.oq)(i,'[id="'+this.getPopUpElement().id+'"]')){var r=void 0,n=void 0,s=void 0,l=this.getLI(i);l&&(n=Array.prototype.indexOf.call(this.getULElement().children,l),s=this.items[n],s&&(r={element:l,item:s},this.trigger("select",r)),this.closePopup(e,this.activeElem[0]))}},t.prototype.openPopUp=function(e){var i=this;e===void 0&&(e=null);var r=!1,n=this.getPopUpElement();if(!this.target)this.createItems(!0);else if(this.activeElem.length>1){var s=(0,a.Xr)(this.activeElem[0],"split-btn");s.isReact&&n.childNodes.length<1&&(r=!0,s.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates())}else this.isReact&&n.childNodes.length<1&&(r=!0,this.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates());var l=this.getULElement();this.popupWireEvents();var h={element:l,items:this.items,event:e,cancel:!1};this.trigger("beforeOpen",h,function(c){if(!c.cancel){var u=i.getULElement();i.dropDown.show(null,i.element),(0,a.cn)([i.element],"e-active"),i.element.setAttribute("aria-expanded","true"),u.focus();var p={element:u,items:i.items};i.trigger("open",p)}})},t.prototype.closePopup=function(e,i){var r=this;e===void 0&&(e=null);var n=this.getULElement(),s={element:n,items:this.items,event:e,cancel:!1},l=this.getPopUpElement();l&&a.bi.remove(l,"keydown",this.keyBoardHandler),this.trigger("beforeClose",s,function(h){if(!h.cancel){r.popupUnWireEvents();var c=r.getULElement(),u=c.querySelector(".e-selected");u&&u.classList.remove("e-selected"),r.dropDown.hide(),(0,a.IV)(r.activeElem,"e-active"),r.element.setAttribute("aria-expanded","false"),i&&i.focus();var p={element:c,items:r.items};r.trigger("close",p),!r.target&&c&&(0,a.og)(c),(!r.target||r.isColorPicker())&&r.createPopupOnClick&&r.destroyPopup(),r.target&&(r.isPopupCreated=!r.createPopupOnClick)}})},t.prototype.unWireEvents=function(){this.createPopupOnClick||a.bi.remove(document,"mousedown touchstart",this.delegateMousedownHandler),a.bi.remove(this.element,"click",this.clickHandler),a.bi.remove(this.element,"keydown",this.keyBoardHandler),this.isPopupCreated&&(a.bi.remove(this.getPopUpElement(),"click",this.clickHandler),a.bi.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler))},t.prototype.onPropertyChanged=function(e,i){var r=["content","cssClass","iconCss","iconPosition","disabled","enableRtl"];this.button.setProperties(Xs(e,r));var n;this.isPopupCreated&&(n=this.getPopUpElement(),this.dropDown.setProperties(Xs(e,["enableRtl"])));for(var s=0,l=Object.keys(e);s<l.length;s++){var h=l[s];switch(h){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":e.disabled?(this.unWireEvents(),this.isPopupCreated&&!this.canOpen()&&this.closePopup()):this.wireEvents();break;case"cssClass":if(e.cssClass.indexOf(xn.VERTICAL)>-1){var c=this.element.querySelector("span.e-caret");(0,a.s1)(c,["e-icon-bottom"],["e-icon-right"])}this.isPopupCreated&&(i.cssClass&&(0,a.IV)([n],i.cssClass.split(" ")),e.cssClass&&(0,a.cn)([n],e.cssClass.split(" ")));break;case"target":this.dropDown.content=this.getTargetElement(),this.dropDown.dataBind();break;case"items":this.isPopupCreated&&this.getULElement()&&this.createItems();break;case"createPopupOnClick":e.createPopupOnClick?this.destroyPopup():this.createPopup();break}}},t.prototype.focusIn=function(){this.element.focus()},Qi([(0,a.Z9)("")],t.prototype,"content",void 0),Qi([(0,a.Z9)("")],t.prototype,"cssClass",void 0),Qi([(0,a.Z9)(!1)],t.prototype,"disabled",void 0),Qi([(0,a.Z9)("")],t.prototype,"iconCss",void 0),Qi([(0,a.Z9)("Left")],t.prototype,"iconPosition",void 0),Qi([(0,a.Z9)(!1)],t.prototype,"enableHtmlSanitizer",void 0),Qi([(0,a.FE)([],Co)],t.prototype,"items",void 0),Qi([(0,a.Z9)(!1)],t.prototype,"createPopupOnClick",void 0),Qi([(0,a.Z9)("")],t.prototype,"target",void 0),Qi([(0,a.ju)()],t.prototype,"beforeItemRender",void 0),Qi([(0,a.ju)()],t.prototype,"beforeOpen",void 0),Qi([(0,a.ju)()],t.prototype,"beforeClose",void 0),Qi([(0,a.ju)()],t.prototype,"close",void 0),Qi([(0,a.ju)()],t.prototype,"open",void 0),Qi([(0,a.ju)()],t.prototype,"select",void 0),Qi([(0,a.ju)()],t.prototype,"created",void 0),t=Qi([a.Zl],t),t}(a.wA),zc=function(){function o(t){this.clientX=0,this.isKeyScroll=!0,this.parent=t,this.addEventListener(),this.initProps()}return o.prototype.onContentScroll=function(t){if(!!this.parent){var e=this.parent.getMainContent().parentElement,i=t.scrollLeft,r=t.scrollTop||e.scrollTop,n=i&&this.parent.enableRtl?this.initScrollValue-i:i,s,l;if(this.parent.allowAutoFill){var h=document.querySelector("#"+this.parent.element.id+"_autofilloptionbtn-popup"),c=document.querySelector("#"+this.parent.element.id+"_autofilloptionbtn");if(h){var u=(0,a.Xr)(c,Bi);u.toggle()}}if(!(0,a.le)(i)&&this.prevScroll.scrollLeft!==n){var p=n>this.prevScroll.scrollLeft;l=this.offset.left.size,this.offset.left=this.getColOffset(n,p,t.skipHidden),t.preventScroll||(this.parent.getColumnHeaderContent().scrollLeft=i,this.parent.getMainContent().scrollLeft=i,t.scrollLeft=i),s={cur:this.offset.left,prev:{idx:this.leftIndex,size:l},increase:p,preventScroll:t.preventScroll},this.updateTopLeftCell(p,!0),this.parent.notify(E.iI,s),!this.parent.scrollSettings.enableVirtualization&&p&&!this.parent.scrollSettings.isFinite&&this.updateNonVirtualCols(),this.leftIndex=s.prev.idx,this.prevScroll.scrollLeft=n}if(Math.round(this.prevScroll.scrollTop)!==Math.round(r)){t.skipRowVirualScroll&&(this.prevScroll.scrollTop=0,this.offset.top={idx:0,size:0});var f=r>this.prevScroll.scrollTop;l=this.offset.top.size,this.offset.top=this.getRowOffset(r,f),s={cur:this.offset.top,prev:{idx:this.topIndex,size:l},increase:f,preventScroll:t.preventScroll},this.updateTopLeftCell(f),t.preventScroll&&this.offset.top.idx<=this.parent.getThreshold("row")?this.offset.top={idx:0,size:0}:t.skipRowVirualScroll?s.prev.idx=s.cur.idx:this.parent.notify(E.oS,s),!this.parent.scrollSettings.enableVirtualization&&f&&!this.parent.scrollSettings.isFinite&&this.updateNonVirtualRows(),this.topIndex=s.prev.idx,this.prevScroll.scrollTop=r}var g=!1,C={isEdit:g};if(this.parent.notify(E.UM,C),C.isEdit){var L=this.parent.element.querySelector(".e-formula-bar");L.focus()}this.isKeyScroll=!0}},o.prototype.updateScrollValue=function(t){t.scrollLeft!==void 0&&(this.prevScroll.scrollLeft=t.scrollLeft+(this.prevScroll.scrollLeft-this.offset.left.size),this.offset.left.size=t.scrollLeft),t.scrollTop!==void 0&&(this.prevScroll.scrollTop=t.scrollTop+(this.prevScroll.scrollTop-this.offset.top.size),this.offset.top.size=t.scrollTop)},o.prototype.updateNonVirtualRows=function(){var t=this.parent.getActiveSheet(),e=this.parent.getThreshold("row");this.offset.top.idx>t.rowCount-(this.parent.viewport.rowCount+e)&&(this.parent.renderModule.refreshUI({rowIndex:t.rowCount,colIndex:0,direction:"first",refresh:"RowPart"},(0,w.qkm)(t.rowCount,0)+":"+(0,w.qkm)(t.rowCount+e-1,t.colCount-1)),this.parent.setSheetPropertyOnMute(t,"rowCount",t.rowCount+e),this.parent.viewport.bottomIndex=t.rowCount-1)},o.prototype.updateNonVirtualCols=function(){var t=this.parent.getActiveSheet(),e=this.parent.getThreshold("col");this.offset.left.idx>t.colCount-(this.parent.viewport.colCount+e)&&(this.parent.renderModule.refreshUI({rowIndex:0,colIndex:t.colCount,direction:"first",refresh:"ColumnPart"},(0,w.qkm)(0,t.colCount)+":"+(0,w.qkm)(t.rowCount-1,t.colCount+e-1)),this.parent.setSheetPropertyOnMute(t,"colCount",t.colCount+e),this.parent.viewport.rightIndex=t.colCount-1)},o.prototype.updateTopLeftCell=function(t,e){var i=this.parent.getActiveSheet(),r=this.offset.top.idx,n=this.offset.left.idx;if(!t){var s=this.parent.frozenRowCount(i);r=(0,w.Sxm)(i,r+s,!0)-s;var l=this.parent.frozenColCount(i);n=(0,w.Sxm)(i,n+l,!0,"columns")-l}e?this.parent.updateTopLeftCell(null,n,"row"):this.parent.updateTopLeftCell(r,null,"col")},o.prototype.getRowOffset=function(t,e){var i=this.offset.top.size,r=this.parent.getActiveSheet(),n=e?this.offset.top.idx+1:this.offset.top.idx?this.offset.top.idx-1:0,s=this.parent.frozenRowCount(r),l=this.parent.scrollSettings.isFinite?r.rowCount:Infinity;for(t=Math.round(t);n<l;)if(e){if(i+=(0,w.NEZ)(r,n-1+s,!0),Math.abs(Math.round(i)-t)<=1)return{idx:(0,w.Sxm)(r,n+s,!0)-s,size:i};if(Math.round(i)>t)return{idx:n-1,size:i-(0,w.NEZ)(r,n-1+s,!0)};n++}else{if(i-=(0,w.NEZ)(r,n+s,!0),i<=0)return{idx:0,size:0};if(Math.abs(Math.round(i)-t)<=1)return{idx:n,size:i};if(Math.round(i)<t)return i+=(0,w.NEZ)(r,n+s,!0),Math.round(i)>t?{idx:n,size:i-(0,w.NEZ)(r,n+s,!0)<0?0:i-(0,w.NEZ)(r,n+s,!0)}:{idx:(0,w.Sxm)(r,n+1+s,!0)-s,size:i};n--}return{idx:this.offset.top.idx,size:this.offset.top.size}},o.prototype.getColOffset=function(t,e,i){for(var r=this.offset.left.size,n=this.parent.getActiveSheet(),s=e?this.offset.left.idx+1:this.offset.left.idx?this.offset.left.idx-1:0,l=this.parent.frozenColCount(n),h=this.parent.scrollSettings.isFinite?n.colCount:Infinity;s<h;)if(e){if(r+=(0,w.IQS)(n,s-1+l,i,!0),Math.abs(Math.round(r)-t)<=1)return{idx:(0,w.Sxm)(n,s+l,!0,"columns")-l,size:r};if(Math.round(r)>t)return{idx:s-1,size:r-(0,w.IQS)(n,s-1+l,i,!0)};s++}else{if(r-=(0,w.IQS)(n,s+l,i,!0),r<=0)return{idx:0,size:0};if(Math.abs(Math.round(r)-t)<=1)return{idx:s,size:r};if(Math.round(r)<t)return r+=(0,w.IQS)(n,s+l,i,!0),Math.round(r)>t?(r=r-(0,w.IQS)(n,s+l,i,!0),{idx:s,size:r<0?0:r}):{idx:(0,w.Sxm)(n,s+1+l,!0,"columns")-l,size:r};s--}return{idx:this.offset.left.idx,size:this.offset.left.size}},o.prototype.contentLoaded=function(t){if(!this.parent.scrollSettings.enableVirtualization){var e=this.parent.createElement("div",{className:"e-virtualtrack"});this.updateNonVirualScrollWidth({scrollTrack:e}),this.parent.getScrollElement().appendChild(e)}t.left&&(this.parent.getScrollElement().scrollLeft=t.left),this.setScrollEvent(),this.parent.enableRtl&&(this.initScrollValue=this.parent.getScrollElement().scrollLeft)},o.prototype.updateNonVirualScrollWidth=function(t){t.scrollTrack||(t.scrollTrack=this.parent.getScrollElement().getElementsByClassName("e-virtualtrack")[0]),t.scrollTrack.style.width=Math.abs(this.parent.getContentTable().getBoundingClientRect().width)+"px"},o.prototype.onHeaderWheel=function(t){t.preventDefault(),this.parent.getMainContent().parentElement.scrollTop+=t.deltaY,this.parent.getScrollElement().scrollLeft+=t.deltaX},o.prototype.onContentWheel=function(t){t.deltaX!==0&&(t.preventDefault(),this.parent.getScrollElement().scrollLeft+=t.deltaX)},o.prototype.scrollHandler=function(t){this.onContentScroll({scrollLeft:t.target.scrollLeft})},o.prototype.updateScroll=function(t){(0,a.le)(t.left)?this.parent.sheetModule.contentPanel.scrollTop=t.top:this.parent.getScrollElement().scrollLeft=t.left},o.prototype.setScrollEvent=function(t){t===void 0&&(t={set:!0}),t.set?(a.bi.add(this.parent.sheetModule.contentPanel,"scroll",this.onContentScroll,this),a.bi.add(this.parent.getColumnHeaderContent(),"wheel",this.onHeaderWheel,this),a.bi.add(this.parent.getSelectAllContent(),"wheel",this.onHeaderWheel,this),a.bi.add(this.parent.getMainContent(),"wheel",this.onContentWheel,this),a.bi.add(this.parent.getRowHeaderContent(),"wheel",this.onContentWheel,this),a.bi.add(this.parent.getScrollElement(),"scroll",this.scrollHandler,this)):(a.bi.remove(this.parent.sheetModule.contentPanel,"scroll",this.onContentScroll),a.bi.remove(this.parent.getColumnHeaderContent(),"wheel",this.onHeaderWheel),a.bi.remove(this.parent.getSelectAllContent(),"wheel",this.onHeaderWheel),a.bi.remove(this.parent.getMainContent(),"wheel",this.onContentWheel),a.bi.remove(this.parent.getRowHeaderContent(),"wheel",this.onContentWheel),a.bi.remove(this.parent.getScrollElement(),"scroll",this.scrollHandler))},o.prototype.initProps=function(){this.topIndex=0,this.leftIndex=0,this.prevScroll={scrollLeft:0,scrollTop:0},this.offset={left:{idx:0,size:0},top:{idx:0,size:0}}},o.prototype.setPadding=function(){this.parent.sheetModule.contentPanel.style.overflowY="scroll";var t=Ie();if(t>0){var e=this.parent.getColumnHeaderContent(),i=this.parent.enableRtl?{margin:"marginLeft",border:"borderLeftWidth"}:{margin:"marginRight",border:"borderRightWidth"};e.parentElement.style[i.margin]=t+"px",e.style[i.border]="1px"}},o.prototype.setClientX=function(t){if(!(t.type==="mousedown"||t.pointerType==="mouse")){var e={touchSelectionStarted:!1};if(this.parent.notify(E.pf,e),!e.touchSelectionStarted){this.clientX=this.getPointX(t);var i=document.getElementById(this.parent.element.id+"_sheet");a.bi.add(i,a.AR.isPointer?"pointermove":"touchmove",this.onTouchScroll,this),a.bi.add(i,a.AR.isPointer?"pointerup":"touchend",this.pointerUpHandler,this)}}},o.prototype.getPointX=function(t){var e=0;return t.touches&&t.touches.length?e=t.touches[0].clientX:e=t.clientX,e},o.prototype.onTouchScroll=function(t){if(t.pointerType!=="mouse"){var e=this.getPointX(t),i=this.clientX-e,r=this.parent.element.getElementsByClassName("e-scroller")[0];(i>10||i<-10)&&r.scrollLeft+i>=0&&(t.preventDefault(),this.clientX=e,$(function(){r.scrollLeft+=i}))}},o.prototype.pointerUpHandler=function(){var t=document.getElementById(this.parent.element.id+"_sheet");a.bi.remove(t,a.AR.isPointer?"pointermove":"touchmove",this.onTouchScroll),a.bi.remove(t,a.AR.isPointer?"pointerup":"touchend",this.pointerUpHandler)},o.prototype.addEventListener=function(){this.parent.on(E.eT,this.contentLoaded,this),this.parent.on(E.tr,this.onContentScroll,this),this.parent.on(E.Of,this.updateScroll,this),this.parent.on(E.YF,this.initProps,this),this.parent.on(E.xn,this.destroy,this),this.parent.on(E.MF,this.setScrollEvent,this),this.parent.on(E.uG,this.setClientX,this),this.parent.on(E.qN,this.updateScrollValue,this),this.parent.scrollSettings.enableVirtualization||(this.parent.on(E.e2,this.updateNonVirualScrollWidth,this),this.parent.on(E.N2,this.updateNonVirualScrollWidth,this))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.off(E.eT,this.contentLoaded),this.parent.off(E.tr,this.onContentScroll),this.parent.off(E.Of,this.updateScroll),this.parent.off(E.YF,this.initProps),this.parent.off(E.xn,this.destroy),this.parent.off(E.MF,this.setScrollEvent),this.parent.off(E.uG,this.setClientX),this.parent.off(E.qN,this.updateScrollValue),this.parent.scrollSettings.enableVirtualization||(this.parent.off(E.e2,this.updateNonVirualScrollWidth),this.parent.off(E.N2,this.updateNonVirualScrollWidth))},o}(),_c=function(){function o(t){this.scroll=[],this.parent=t,this.addEventListener()}return o.prototype.createVirtualElement=function(t){var e=this.parent.getActiveSheet(),i=this.parent.getMainContent();this.content=this.parent.createElement("div",{className:"e-virtualable"}),this.content.appendChild(i.querySelector(".e-table")),i.appendChild(this.content);var r=i.appendChild(this.parent.createElement("div",{className:"e-virtualtrack"})),n=0,s;this.parent.sheets.length>this.scroll.length&&this.initScroll();var l=this.parent.viewport.bottomIndex;e.rowCount>l+1||e.usedRange.rowIndex>l?(!this.parent.scrollSettings.isFinite&&e.rowCount<=e.usedRange.rowIndex&&this.parent.setSheetPropertyOnMute(e,"rowCount",e.usedRange.rowIndex+1),this.setScrollCount(e.rowCount,"row")):(this.parent.scrollSettings.isFinite||this.parent.setSheetPropertyOnMute(e,"rowCount",l+1),this.scroll[this.parent.activeSheetIndex].rowCount=e.rowCount);var h=this.parent.frozenRowCount(e),c=(0,pe.n53)(e.topLeftCell);t.top&&(n=t.top,e.frozenRows&&(n+=(0,w.EB_)(e,c[0],h-1,!0)),h=(0,pe.n53)(e.paneTopLeftCell)[0]),n+=(0,w.EB_)(e,h,this.scroll[this.parent.activeSheetIndex].rowCount-1,!0),l=this.parent.viewport.rightIndex;var u=0,p=this.parent.frozenColCount(e);t.left?(u=t.left,p&&(u+=(0,w.pGm)(e,c[1],p-1,!0)),h=(0,pe.n53)(e.paneTopLeftCell)[1]):h=p,e.colCount>l+1||e.usedRange.colIndex>l?(!this.parent.scrollSettings.isFinite&&e.colCount<=e.usedRange.colIndex&&this.parent.setSheetPropertyOnMute(e,"colCount",e.usedRange.colIndex+1),u+=(0,w.pGm)(e,h,l,!0),this.setScrollCount(e.colCount,"col"),s=u+(0,w.pGm)(e,l+1,this.scroll[this.parent.activeSheetIndex].colCount-1,!0)):(this.parent.scrollSettings.isFinite||this.parent.setSheetPropertyOnMute(e,"colCount",l+1),u+=(0,w.pGm)(e,h,e.colCount-1,!0),this.scroll[this.parent.activeSheetIndex].colCount=e.colCount,s=u),(0,a.le)(this.parent.viewport.leftIndex)&&(this.parent.viewport.leftIndex=0),(0,a.le)(this.parent.viewport.topIndex)&&(this.parent.viewport.topIndex=0),t.left&&(u=(0,w.pGm)(e,this.parent.viewport.leftIndex+p,l,!0)),(0,a.le)(this.translateX)&&(this.translateX=0),(0,a.le)(this.translateY)&&(this.translateY=0),i=this.parent.getRowHeaderContent(),this.rowHeader=this.content.cloneNode(),this.rowHeader.appendChild(i.querySelector(".e-table")),i.appendChild(this.rowHeader);var f=i.appendChild(r.cloneNode());this.rowHeader.style.transform="translate(0px, "+this.translateY+"px)",i=this.parent.getColumnHeaderContent(),this.colHeader=this.content.cloneNode(),this.colHeader.appendChild(i.querySelector(".e-table")),i.appendChild(this.colHeader);var g=i.appendChild(r.cloneNode());this.colHeader.style.width=u+"px",f.style.height=n+"px",g.style.width=s+"px",this.colHeader.style.transform="translate("+this.translateX+"px, 0px)",this.content.style.transform="translate("+this.translateX+"px, "+this.translateY+"px)",this.content.style.width=u+"px",r.style.height=n+"px",r.style.width=s+"px",this.parent.allowScrolling&&this.parent.getScrollElement().appendChild(g.cloneNode(!0))},o.prototype.initScroll=function(){for(var t=0;t<this.parent.sheets.length;)this.scroll[t]||this.scroll.push({rowCount:0,colCount:0}),t++},o.prototype.setScrollCount=function(t,e){var i=this.parent.activeSheetIndex;(!this.scroll[i][e+"Count"]||this.scroll[i][e+"Count"]!==t)&&(this.scroll[i][e+"Count"]=t)},o.prototype.getRowAddress=function(t){var e=this.parent.getActiveSheet();return(0,pe.i0K)([t[0],e.frozenColumns?(0,pe.n53)(e.topLeftCell)[1]:this.parent.viewport.leftIndex,t[1],this.parent.viewport.rightIndex])},o.prototype.getColAddress=function(t){var e=this.parent.getActiveSheet();return(0,pe.i0K)([e.frozenRows?(0,pe.n53)(e.topLeftCell)[0]:this.parent.viewport.topIndex,t[0],this.parent.viewport.bottomIndex,t[1]])},o.prototype.updateScrollCount=function(t,e,i){i===void 0&&(i=t);var r=this.parent.getActiveSheet(),n=t+this.parent.viewport[e+"Count"]+1+i,s=this.scroll[this.parent.activeSheetIndex][e+"Count"];if(n<s){if(r[e+"Count"]===s)return;n=s}this.parent.scrollSettings.isFinite||this.parent.setSheetPropertyOnMute(r,e+"Count",n)},o.prototype.onVerticalScroll=function(t){var e=t.cur.idx,i=t.cur.size,r=t.prev.idx,n=Math.abs(e-r),s=this.parent.getThreshold("row");if(n>Math.round(s/2)){var l=void 0,h=void 0,c=void 0,u=this.parent.getActiveSheet();if(e<=s&&!t.increase){if(this.translateY&&r>s){this.translateY=0;var p=this.parent.frozenColCount(u),f=this.parent.frozenRowCount(u);if(t.preventScroll)this.parent.viewport.topIndex=r-(s-f);else{var g=p?(0,pe.n53)(u.topLeftCell)[1]:this.parent.viewport.leftIndex,C=p?[f,this.parent.viewport.leftIndex+p]:[];if(n<this.parent.viewport.rowCount+s){l=(0,w.Sxm)(u,f,!0),h=(0,w.Sxm)(u,this.parent.viewport.topIndex+f-1,!1),this.parent.viewport.topIndex=l-f;var L=this.hiddenCount(l,h),D=(0,w.Sxm)(u,this.parent.viewport.bottomIndex-(h-l+1-L),t.increase);this.parent.viewport.bottomIndex-=h-l+1-L+this.hiddenCount(D,this.parent.viewport.bottomIndex),this.parent.renderModule.refreshUI({colIndex:g,rowIndex:l,direction:"last",refresh:"RowPart",skipUpdateOnFirst:!0,frozenIndexes:C},this.getRowAddress([l,(0,w.Sxm)(u,h,!1)]))}else{var R=this.parent.viewport.leftIndex;this.parent.renderModule.refreshUI({rowIndex:0,colIndex:g,refresh:"Row",skipUpdateOnFirst:!0,frozenIndexes:C,skipTranslate:!0}),p&&(this.parent.viewport.leftIndex=R),this.translate({refresh:"Row"})}we(this.parent.element),e=0}}this.updateScrollCount(s,"row")}if(r<s&&(n=Math.abs(e-s)),!t.increase&&this.parent.scrollSettings.isFinite&&this.parent.viewport.bottomIndex===(0,w.Sxm)(u,u.rowCount-1,!1)){var f=this.parent.frozenRowCount(u),B=this.parent.viewport.topIndex+f+(0,w.dK5)(u.paneTopLeftCell)[0]-1;if(e+f>B){t.prev.idx=e;return}n=B-(e+f)}if(e>s){if(c=this.parent.viewport.topIndex,this.parent.viewport.topIndex=e-s,t.increase&&c>this.parent.viewport.topIndex){this.parent.viewport.topIndex=c;return}var f=this.parent.frozenRowCount(u);if(t.preventScroll)this.setThresholdHeight(i,s,f),this.translate({refresh:"Row"});else{var p=this.parent.frozenColCount(u),g=void 0,H=[];if(p?(g=(0,pe.n53)(u.topLeftCell)[1],H.push(f),H.push(this.parent.viewport.leftIndex+p)):g=this.parent.viewport.leftIndex,n<this.parent.viewport.rowCount+s)if(t.increase){if(l=this.parent.viewport.bottomIndex+1,h=this.parent.viewport.bottomIndex+(this.parent.viewport.topIndex-c),h-=this.hiddenCount(c+f,this.parent.viewport.topIndex-1+f),h<=this.parent.viewport.bottomIndex){this.parent.viewport.topIndex=c;return}var j=this.parent.skipHidden(l,h,"rows",!1),W=this.checkLastIdx(j[1],"row");l=j[0],h=W.index,this.parent.viewport.topIndex=(0,w.Sxm)(u,this.parent.viewport.topIndex-W.diff+f,!this.parent.scrollSettings.isFinite)-f,this.setThresholdHeight(i,e-this.parent.viewport.topIndex,f,!!W.diff,c===(0,w.Sxm)(u,f,!0)),this.parent.viewport.bottomIndex=h,this.parent.renderModule.refreshUI({colIndex:g,rowIndex:l,direction:"first",refresh:"RowPart",frozenIndexes:H},this.getRowAddress([l,h]))}else{if(l=(0,w.Sxm)(u,this.parent.viewport.topIndex+f,!1),l<f&&(l=f),this.parent.viewport.topIndex=l-f,l=(0,w.Sxm)(u,l,!0),h=(0,w.Sxm)(u,c-1+f,!1),h<f||h<l){this.parent.viewport.topIndex=c;return}var L=this.hiddenCount(l,h);this.parent.viewport.bottomIndex-=h-l+1-L,this.parent.viewport.bottomIndex=(0,w.Sxm)(u,this.parent.viewport.bottomIndex,!1),l=this.parent.skipHidden(l,h)[0],this.setThresholdHeight(i,e-this.parent.viewport.topIndex,f),this.parent.renderModule.refreshUI({colIndex:g,rowIndex:l,direction:"last",refresh:"RowPart",frozenIndexes:H},this.getRowAddress([l,h]))}else c=this.parent.viewport.leftIndex,this.parent.viewport.topIndex=(0,w.Sxm)(u,this.parent.viewport.topIndex+f,!1)-f,this.parent.viewport.topIndex<0&&(this.parent.viewport.topIndex=(0,w.Sxm)(u,f,!0)-f),this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,colIndex:g,refresh:"Row",frozenIndexes:H,skipTranslate:!0}),p&&(this.parent.viewport.leftIndex=c),this.setThresholdHeight(i,e-this.parent.viewport.topIndex,f,this.parent.scrollSettings.isFinite&&this.parent.viewport.bottomIndex===(0,w.Sxm)(u,u.rowCount-1,!1)),this.translate({refresh:"Row"});this.updateScrollCount(e,"row",s),this.focusSheet()}}t.prev.idx=e}},o.prototype.hiddenCount=function(t,e,i){i===void 0&&(i="rows");for(var r=0,n=this.parent.getActiveSheet(),s=t;s<=e;s++)n[i][s]&&n[i][s].hidden&&r++;return r},o.prototype.checkLastIdx=function(t,e){var i=0;if(this.parent.scrollSettings.isFinite){var r=this.parent.getActiveSheet(),n=r[e+"Count"]-1;t>n&&(i=t-n,t=(0,w.Sxm)(r,n,!1))}return{index:t,diff:i}},o.prototype.onHorizontalScroll=function(t){var e=t.cur.idx,i=t.cur.size,r=t.prev.idx,n=Math.abs(e-r),s=this.parent.getThreshold("col");if(n>Math.round(s/2)){var l=void 0,h=void 0,c=void 0,u=this.parent.getActiveSheet();if(e<=s&&!t.increase){if(this.translateX&&r>s){this.translateX=0;var p=this.parent.frozenColCount(u),f=this.parent.frozenRowCount(u);if(t.preventScroll)this.parent.viewport.leftIndex=r-(s-p);else{var g=f?(0,pe.n53)(u.topLeftCell)[0]:this.parent.viewport.topIndex,C=f?[this.parent.viewport.topIndex+f,p]:[];if(n<this.parent.viewport.colCount+s){l=(0,w.Sxm)(u,p,!0,"columns"),h=(0,w.Sxm)(u,this.parent.viewport.leftIndex+p-1,!1,"columns"),this.parent.viewport.leftIndex=l-p;var L=this.hiddenCount(l,h,"columns"),D=(0,w.Sxm)(u,this.parent.viewport.rightIndex-(h-l+1-L),t.increase,"columns");this.parent.viewport.rightIndex-=h-l+1-L+this.hiddenCount(D,this.parent.viewport.rightIndex,"columns"),this.parent.renderModule.refreshUI({rowIndex:g,colIndex:l,direction:"last",refresh:"ColumnPart",skipUpdateOnFirst:!0,frozenIndexes:C},this.getColAddress([l,(0,w.Sxm)(u,h,!1,"columns")]))}else{var R=this.parent.viewport.topIndex;this.parent.renderModule.refreshUI({rowIndex:g,colIndex:0,refresh:"Column",skipUpdateOnFirst:!0,frozenIndexes:C,skipTranslate:!0}),f&&(this.parent.viewport.topIndex=R),this.translate({refresh:"Column"})}we(this.parent.element),e=0}}this.updateScrollCount(s,"col")}if(r<s&&(n=Math.abs(e-s)),!t.increase&&this.parent.scrollSettings.isFinite&&this.parent.viewport.rightIndex===(0,w.Sxm)(u,u.colCount-1,!1,"columns")){var p=this.parent.frozenColCount(u),B=this.parent.viewport.leftIndex+p+(0,w.dK5)(u.paneTopLeftCell)[1]-1;if(B+=this.hiddenCount(this.parent.viewport.leftIndex+p,B),e+p>B){t.prev.idx=e;return}n=B-(e+p)}if(e>s){if(c=this.parent.viewport.leftIndex,this.parent.viewport.leftIndex=e-s,t.increase&&c>this.parent.viewport.leftIndex){this.parent.viewport.leftIndex=c;return}var p=this.parent.frozenColCount(u);if(t.preventScroll)this.setThresholdWidth(i,s,p),this.translate({refresh:"Column"});else{var f=this.parent.frozenRowCount(u),g=f?(0,pe.n53)(u.topLeftCell)[0]:this.parent.viewport.topIndex,H=[];if(f&&(H=[f+this.parent.viewport.topIndex,p]),n<this.parent.viewport.colCount+s)if(t.increase){if(l=this.parent.viewport.rightIndex+1,h=this.parent.viewport.rightIndex+(this.parent.viewport.leftIndex-c),h-=this.hiddenCount(c+p,this.parent.viewport.leftIndex-1+p,"columns"),h<=this.parent.viewport.rightIndex){this.parent.viewport.leftIndex=c;return}var j=this.parent.skipHidden(l,h,"columns",!1),W=this.checkLastIdx(j[1],"col");l=j[0],h=W.index,this.parent.viewport.leftIndex=(0,w.Sxm)(u,this.parent.viewport.leftIndex-W.diff+p,!this.parent.scrollSettings.isFinite,"columns")-p,this.setThresholdWidth(i,e-this.parent.viewport.leftIndex,p,!!W.diff,c===(0,w.Sxm)(u,p,!0,"columns")),this.parent.viewport.rightIndex=h,this.parent.renderModule.refreshUI({rowIndex:g,colIndex:l,direction:"first",refresh:"ColumnPart",frozenIndexes:H},this.getColAddress([l,h]))}else{if(l=(0,w.Sxm)(u,this.parent.viewport.leftIndex+p,!1,"columns"),l<p&&(l=p),this.parent.viewport.leftIndex=l,l=(0,w.Sxm)(u,l+p,!0,"columns"),h=(0,w.Sxm)(u,c-1+p,!1,"columns"),h<p||h<l){this.parent.viewport.leftIndex=c;return}var L=this.hiddenCount(l,h,"columns");this.parent.viewport.rightIndex-=h-l+1-L,this.parent.viewport.rightIndex=(0,w.Sxm)(u,this.parent.viewport.rightIndex,!1,"columns"),l=this.parent.skipHidden(l,h,"columns")[0],this.setThresholdWidth(i,e-this.parent.viewport.leftIndex,p),this.parent.renderModule.refreshUI({rowIndex:g,colIndex:l,direction:"last",refresh:"ColumnPart",frozenIndexes:H},this.getColAddress([l,h]))}else c=this.parent.viewport.topIndex,this.parent.viewport.leftIndex=(0,w.Sxm)(u,this.parent.viewport.leftIndex+p,!1,"columns")-p,this.parent.viewport.leftIndex<0&&(this.parent.viewport.leftIndex=(0,w.Sxm)(u,p,!0,"columns")-p),this.parent.renderModule.refreshUI({rowIndex:g,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:H,skipTranslate:!0}),f&&(this.parent.viewport.topIndex=c),this.setThresholdWidth(i,e-this.parent.viewport.leftIndex,p,this.parent.scrollSettings.isFinite&&this.parent.viewport.rightIndex===(0,w.Sxm)(u,u.colCount-1,!1,"columns")),this.translate({refresh:"Column"});this.updateScrollCount(e,"col",s),this.focusSheet()}}t.prev.idx=e}},o.prototype.focusSheet=function(){(!document.activeElement.classList.contains("e-text-findNext-short")||!(0,a.oq)(document.activeElement,"#"+this.parent.element.id))&&we(this.parent.element)},o.prototype.setThresholdHeight=function(t,e,i,r,n){var s=this.parent.getActiveSheet(),l=this.parent.viewport.topIndex+i,h=l+e-1;r||n||h<l?this.translateY=l<=i?0:(0,w.EB_)(s,i,l-1,!0):this.translateY=t-(0,w.EB_)(s,l,h,!0)},o.prototype.setThresholdWidth=function(t,e,i,r,n){var s=this.parent.getActiveSheet(),l=this.parent.viewport.leftIndex+i,h=l+e-1;r||n||h<l?this.translateX=l<=i?0:(0,w.pGm)(s,i,l-1,!0):this.translateX=t-(0,w.pGm)(s,l,h,!0)},o.prototype.translate=function(t){if(!(t.skipTranslate||!this.content)){var e=this.translateX||0;e=this.parent.enableRtl?-e:e,(t.refresh==="Row"||t.refresh==="RowPart")&&(this.content.style.transform="translate("+e+"px, "+this.translateY+"px)",this.rowHeader.style.transform="translate(0px, "+this.translateY+"px)"),(t.refresh==="Column"||t.refresh==="ColumnPart")&&(this.content.style.transform="translate("+e+"px, "+this.translateY+"px)",this.colHeader.style.transform="translate("+e+"px, 0px)")}},o.prototype.updateColumnWidth=function(t){if(t.refresh==="Column"){this.content.style.width="";var e=this.parent.getActiveSheet(),i=(0,w.pGm)(e,this.parent.viewport.leftIndex+this.parent.frozenColCount(e),this.parent.viewport.rightIndex,!0);if(this.colHeader.style.width=i+"px",this.content.style.width=i+"px",!this.parent.scrollSettings.isFinite||t.isUpdate){var r=this.parent.element.querySelector(".e-scroller .e-virtualtrack");if(!r)return;var n=parseInt(r.style.width,10),s=i+this.translateX+this.parent.viewport.beforeFreezeWidth;if(s>n){var l=s-n;r.style.width=n+l+"px"}else{var l=n-s,h=this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0];n-l<parseInt(h.style.width,10)&&(r.style.width=h.style.width)}}}else if(!this.parent.scrollSettings.isFinite){var h=this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0],c=parseInt(h.style.height,10),u=this.content.getBoundingClientRect().height,p=u+this.translateY+this.parent.viewport.beforeFreezeHeight;if(p>c){var l=p-c;h.style.height=c+l+"px"}else{var l=c-p,f=this.parent.getRowHeaderContent().getElementsByClassName("e-virtualtrack")[0];c-l<parseInt(f.style.height,10)&&(h.style.height=f.style.height)}}},o.prototype.updateRowColCount=function(t){if(!!this.scroll.length){var e=this.parent.getActiveSheet();if(t.update==="row"){if(t.index!==this.scroll[this.parent.activeSheetIndex].rowCount-1){var i=this.getVTrackHeight("height"),r=i;if(t.index>=this.scroll[this.parent.activeSheetIndex].rowCount?t.start===void 0?r+=(0,w.EB_)(e,this.scroll[this.parent.activeSheetIndex].rowCount,t.index,!0):r+=(0,w.EB_)(e,t.start,t.end,!0):t.start===void 0?r-=(0,w.EB_)(e,t.index+1,this.scroll[this.parent.activeSheetIndex].rowCount-1,!0):r-=(0,w.EB_)(e,t.start,t.end,!0),!t.isDelete&&r<i)return;this.scroll[this.parent.activeSheetIndex].rowCount=t.index+1,this.updateVTrack(this.rowHeader,r,"height"),this.scroll[this.parent.activeSheetIndex].rowCount>e.rowCount&&this.parent.setSheetPropertyOnMute(e,"rowCount",this.scroll[this.parent.activeSheetIndex].rowCount)}}else if(t.index!==this.scroll[this.parent.activeSheetIndex].colCount-1){var n=this.getVTrackHeight("width"),s=n;if(t.index>=this.scroll[this.parent.activeSheetIndex].colCount?t.start===void 0?s+=(0,w.pGm)(e,this.scroll[this.parent.activeSheetIndex].colCount,t.index,!0):s+=(0,w.pGm)(e,t.start,t.end,!0):t.start===void 0?s-=(0,w.pGm)(e,t.index+1,this.scroll[this.parent.activeSheetIndex].colCount-1,!0):s-=(0,w.pGm)(e,t.start,t.end,!0),!t.isDelete&&s<n)return;this.scroll[this.parent.activeSheetIndex].colCount=t.index+1,this.updateVTrack(this.colHeader,s,"width"),this.scroll[this.parent.activeSheetIndex].colCount>e.colCount&&this.parent.setSheetPropertyOnMute(e,"colCount",this.scroll[this.parent.activeSheetIndex].colCount)}}},o.prototype.getVTrackHeight=function(t){var e=this.content.nextElementSibling.style[t];if(e.includes("e+")){e=e.split("px")[0];var i=e.split("e+");return Number(i[0])*Math.pow(10,Number(i[1]))}else return parseFloat(e)},o.prototype.updateVTrackHeight=function(t){t.rowIdx<this.scroll[this.parent.activeSheetIndex].rowCount&&this.updateVTrack(this.rowHeader,this.getVTrackHeight("height")+t.threshold,"height"),(t.rowIdx<this.parent.viewport.topIndex||t.rowIdx>this.parent.viewport.bottomIndex)&&(this.translateY+=t.threshold,this.translate({refresh:"Row"}))},o.prototype.updateVTrackWidth=function(t){var e=this.parent.frozenColCount(this.parent.getActiveSheet());if(t.colIdx>=this.parent.viewport.leftIndex+e&&t.colIdx<=this.parent.viewport.rightIndex){var i=this.parent.getColumnHeaderContent().getElementsByClassName("e-virtualtrack")[0];i.style.width=parseFloat(i.style.width)+t.threshold+"px";var r=this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0];r.style.width=parseFloat(r.style.width)+t.threshold+"px";var n=this.parent.getColumnHeaderContent().getElementsByClassName("e-virtualable")[0];n.style.width=parseFloat(n.style.width)+t.threshold+"px";var s=this.parent.getMainContent().getElementsByClassName("e-virtualable")[0];s.style.width=parseFloat(s.style.width)+t.threshold+"px"}else t.colIdx>=e&&t.colIdx<this.parent.viewport.leftIndex+e&&(this.parent.scrollModule.offset.left.size+=t.threshold,this.translateX+=t.threshold,this.translate({refresh:"Column"}))},o.prototype.updateVTrack=function(t,e,i){t.nextElementSibling.style[i]=e+"px",this.content.nextElementSibling.style[i]=e+"px",i==="width"&&this.parent.allowScrolling&&(this.parent.getScrollElement().firstElementChild.style.width=e+"px")},o.prototype.deInitProps=function(){this.parent.viewport.leftIndex=null,this.parent.viewport.topIndex=null,this.parent.viewport.bottomIndex=null,this.translateX=null,this.translateY=null},o.prototype.updateScrollProps=function(t){var e=this;t===void 0&&(t={sheetIndex:0,sheets:this.parent.sheets}),this.scroll.length===0?this.initScroll():t.sheets.forEach(function(){e.scroll.splice(t.sheetIndex,0,{rowCount:0,colCount:0})})},o.prototype.sliceScrollProps=function(t){(0,a.le)(t.sheetIndex)?this.scroll.length=0:this.scroll.splice(t.sheetIndex,1)},o.prototype.updateTranslate=function(t){if(t.height){if(t.isRender)this.translateY-=t.height;else{var e=parseInt(this.parent.getMainContent().getElementsByClassName("e-virtualtrack")[0].style.height,10);t.isHide?(this.updateVTrack(this.rowHeader,e-t.height,"height"),this.setThresholdHeight(this.translateY,t.prevSize-1-this.parent.viewport.topIndex+1,this.parent.frozenRowCount(this.parent.getActiveSheet()))):(this.updateVTrack(this.rowHeader,e+t.height,"height"),this.translateY=this.translateY+t.size)}this.translate({refresh:"Row"})}t.width&&(this.translateX-=t.width,this.translate({refresh:"Column"}))},o.prototype.addEventListener=function(){this.parent.on(E.lu,this.createVirtualElement,this),this.parent.on(E.nQ,this.translate,this),this.parent.on(E.e2,this.updateColumnWidth,this),this.parent.on(E.LX,this.updateColumnWidth,this),this.parent.on(E.oS,this.onVerticalScroll,this),this.parent.on(E.iI,this.onHorizontalScroll,this),this.parent.on(pe.XRp,this.updateRowColCount,this),this.parent.on(E.QK,this.updateVTrackHeight,this),this.parent.on(E.N2,this.updateVTrackWidth,this),this.parent.on(E.YF,this.deInitProps,this),this.parent.on(pe.Iap,this.sliceScrollProps,this),this.parent.on(pe.GRU,this.updateScrollProps,this),this.parent.on(E.$7,this.updateTranslate,this),this.parent.on(E.xn,this.destroy,this)},o.prototype.destroy=function(){this.removeEventListener(),this.rowHeader=null,this.colHeader=null,this.content=null,this.parent=null,this.scroll.length=0,this.translateX=null,this.translateY=null},o.prototype.removeEventListener=function(){this.parent.off(E.lu,this.createVirtualElement),this.parent.off(E.nQ,this.translate),this.parent.off(E.e2,this.updateColumnWidth),this.parent.off(E.LX,this.updateColumnWidth),this.parent.off(E.oS,this.onVerticalScroll),this.parent.off(E.iI,this.onHorizontalScroll),this.parent.off(pe.XRp,this.updateRowColCount),this.parent.off(E.QK,this.updateVTrackHeight),this.parent.off(E.N2,this.updateVTrackWidth),this.parent.off(pe.Iap,this.sliceScrollProps),this.parent.off(pe.GRU,this.updateScrollProps),this.parent.off(E.$7,this.updateTranslate),this.parent.off(E.xn,this.destroy)},o}(),So=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(E.SH,this.keyDownHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(E.SH,this.keyDownHandler)},o.prototype.keyDownHandler=function(t){var e=this;if(!this.parent.isEdit&&(document.activeElement.classList.contains("e-spreadsheet")||(0,a.oq)(document.activeElement,".e-sheet"))&&!(0,a.oq)(t.target,".e-name-box")&&!(document.activeElement.classList.contains("e-ddl")&&document.activeElement.classList.contains("e-input-focus"))){var i=void 0,r=void 0,n=this.parent.enableRtl,s=this.parent.getActiveSheet(),l=(0,w.n53)(s.activeCell);[9,37,38,39,40,33,34].indexOf(t.keyCode)>-1&&t.preventDefault();var h={e:t,isFilterCell:!1};if(t.shiftKey?this.shiftSelection(t):t.altKey&&t.keyCode===40&&this.parent.notify(E.Em,h),!t.shiftKey&&(!n&&t.keyCode===37||n&&t.keyCode===39)||t.shiftKey&&t.keyCode===9)if(l[1]>0){if(s.isProtected&&!s.protectSettings.selectUnLockedCells||!s.isProtected)l[1]-=1;else{var c=this.getNextUnlockedCell(t.keyCode,l);l[1]=c[1],l[0]=c[0]}i=!0}else{var u=this.parent.getMainContent();l[1]===0&&u.scrollLeft&&!n&&(u.scrollLeft=0)}else if(t.shiftKey&&t.keyCode===13){if(!this.parent.element.querySelector(".e-find-toolbar"))if(l[0]>0){if(s.isProtected&&!s.protectSettings.selectUnLockedCells||!s.isProtected)l[0]-=1;else{var c=this.getNextUnlockedCell(t.keyCode,l);l[1]=c[1],l[0]=c[0]}i=!0}else{var u=this.parent.getMainContent().parentElement;l[0]===0&&u.scrollTop&&(u.scrollTop=0)}}else if(!h.isFilterCell&&!t.shiftKey&&t.keyCode===38)if(l[0]>0){if(s.isProtected&&!s.protectSettings.selectUnLockedCells||!s.isProtected)l[0]-=1;else{var p=this.getNextUnlockedCell(t.keyCode,l);l[1]=p[1],l[0]=p[0]}i=!0}else{var f=this.parent.getMainContent().parentElement;l[0]===0&&f.scrollTop&&(f.scrollTop=0)}else if(!t.shiftKey&&(!n&&t.keyCode===39||n&&t.keyCode===37)||t.keyCode===9){var g=(0,w.$Su)(l[0],l[1],s);if(g&&g.colSpan>1&&(l[1]+=g.colSpan-1),l[1]<s.colCount-1){if(s.isProtected&&!s.protectSettings.selectUnLockedCells||!s.isProtected)l[1]+=1;else{var c=this.getNextUnlockedCell(t.keyCode,l);l[1]=c[1],l[0]=c[0]}i=!0}}else if(!h.isFilterCell&&!t.shiftKey&&t.keyCode===40||t.keyCode===13){var g=(0,w.$Su)(l[0],l[1],s);if(g&&g.rowSpan>1&&(l[0]+=g.rowSpan-1),l[0]<s.rowCount-1){if(s.isProtected&&!s.protectSettings.selectUnLockedCells||!s.isProtected)l[0]+=1;else{var c=this.getNextUnlockedCell(t.keyCode,l);l[1]=c[1],l[0]=c[0]}i=!0}}else if(!t.shiftKey&&(t.keyCode===34||t.keyCode===33)&&(!this.parent.scrollModule||this.parent.scrollModule.isKeyScroll)){var C=this.parent.element.querySelector(".e-main-panel"),L=0;if(t.keyCode===34)L=C.getBoundingClientRect().height+C.scrollTop;else if(L=C.scrollTop-C.getBoundingClientRect().height,L<0)return;var D=(0,w.n53)(this.parent.getActiveSheet().activeCell)[0],R=(0,w.n53)(this.parent.getActiveSheet().paneTopLeftCell)[0],B=D-R;this.parent.scrollModule&&(this.parent.scrollModule.isKeyScroll=!1),C.scrollTop=L,$(function(){R=(0,w.n53)(e.parent.getActiveSheet().paneTopLeftCell)[0],e.parent.notify(E.Lc,{range:[R+B,l[1]],preventAnimation:!0})})}if(i&&(!this.parent.scrollModule||this.parent.scrollModule.isKeyScroll)){if(t.keyCode===40||t.keyCode===38||t.keyCode===13){for(;(0,w.gSQ)(s,l[0]);)if((t.keyCode===40||!t.shiftKey&&t.keyCode===13)&&(l[0]=l[0]+1),(t.keyCode===38||t.shiftKey&&t.keyCode===13)&&(l[0]=l[0]-1,l[0]<0))return}if(t.keyCode===37||t.keyCode===39||t.keyCode===9){for(;(0,w.NqJ)(s,l[1]);)if((t.keyCode===39||!t.shiftKey&&t.keyCode===9)&&(l[1]=l[1]+1),(t.keyCode===37||t.shiftKey&&t.keyCode===9)&&(l[1]=l[1]-1,l[1]<0))return}this.scrollNavigation(r||l,!!r);var H=(0,w.i0K)(l),j=function(W){H!==s.selectedRange&&(e.parent.setSheetPropertyOnMute(s,"activeCell",H),e.parent.notify(E.Lc,{range:l,preventAnimation:W}))};if(this.parent.scrollModule&&this.parent.scrollModule.isKeyScroll){if(H===s.selectedRange)return;$(j.bind(this,!0))}else j()}}else t.altKey&&t.keyCode===38&&this.parent.element.lastElementChild.classList.contains("e-filter-popup")&&this.parent.notify(E.Em,{closePopup:!0});t.target.classList.contains("e-sheet-rename")&&(t.keyCode===32?t.stopPropagation():(t.keyCode===13||t.keyCode===27)&&this.parent.notify(E.Oe,t))},o.prototype.getNextUnlockedCell=function(t,e){var i=this.parent.getActiveSheet(),r;if(t===39){var n=e[1]+1,s=e[0];e[1]===i.usedRange.colIndex&&(n=0,s=s+1,e[0]===i.usedRange.rowIndex&&(s=0)),e[1]===i.usedRange.colIndex&&e[0]===i.usedRange.rowIndex&&(s=n=0);for(var l=s;l<=i.usedRange.rowIndex+1;l++){l>i.usedRange.rowIndex&&(l=0);for(var h=n;h<=i.usedRange.colIndex;h++){if(!ct(this.parent,[l,h,l,h]))return r=[l,h],r;n=h}s=l,n===i.usedRange.colIndex&&(n=0,s===i.usedRange.rowIndex?s=0:s++)}}if(t===37){var n=e[1]-1,s=e[0];e[1]===0&&(n=i.usedRange.colIndex,s=s-1,e[0]===0&&(s=i.usedRange.rowIndex));for(var l=s;l>=-1;l--){l<0&&(l=i.usedRange.rowIndex);for(var h=n;h>=0;h--){if(!ct(this.parent,[l,h,l,h]))return r=[l,h],r;n=h}s=l,n===0&&(n=i.usedRange.colIndex,s===0?s=i.usedRange.rowIndex:s--)}}if(t===40){var n=e[1],s=e[0]+1;e[0]===i.usedRange.rowIndex&&(n=n+1,s=0,e[1]===i.usedRange.colIndex&&(s=0)),e[1]===i.usedRange.colIndex&&e[0]===i.usedRange.rowIndex&&(s=n=0);for(var l=n;l<=i.usedRange.colIndex+1;l++){l>i.usedRange.colIndex&&(l=0);for(var h=s;h<=i.usedRange.rowIndex;h++){if(!ct(this.parent,[h,l,h,l]))return r=[h,l],r;s=h}n=l,s===i.usedRange.rowIndex&&(n++,n===i.usedRange.colIndex,s=0)}}if(t===38){var n=e[1],s=e[0]-1;e[0]===0&&(n=n-1,s=i.usedRange.rowIndex,e[1]===0&&(n=i.usedRange.colIndex));for(var l=n;l>=-1;l--){l<0&&(l=i.usedRange.colIndex);for(var h=s;h>=0;h--){if(!ct(this.parent,[h,l,h,l]))return r=[h,l],r;s=h}n=l,s===0&&(s=i.usedRange.rowIndex,n===0?n=i.usedRange.colIndex:n--)}}return r},o.prototype.shiftSelection=function(t){var e=this.parent.getActiveSheet(),i=(0,w.dK5)(e.selectedRange),r=(0,w.gaE)(i),n=!0;if(t.keyCode===38){for(var s=r[1];s<=r[3];s++){var l=(0,w.$Su)(i[2],s,this.parent.getActiveSheet());if(!(0,a.le)(l)&&l.rowSpan&&l.rowSpan<0){i[2]=i[2]-(Math.abs(l.rowSpan)+1),n=!1;break}}n&&(i[2]=i[2]-1),i[2]<0&&(i[2]=0)}if(t.keyCode===40){for(var s=r[1];s<=r[3];s++){var l=(0,w.$Su)(i[2],s,this.parent.getActiveSheet());if(!(0,a.le)(l)&&l.rowSpan&&l.rowSpan>0){i[2]=i[2]+Math.abs(l.rowSpan),n=!1;break}}n&&(i[2]=i[2]+1),e.rowCount<=i[2]&&(i[2]=e.rowCount-1)}if(t.keyCode===39){for(var s=r[0];s<=r[2];s++){var l=(0,w.$Su)(s,i[3],this.parent.getActiveSheet());if(!(0,a.le)(l)&&l.colSpan&&l.colSpan>0){i[3]=i[3]+Math.abs(l.colSpan),n=!1;break}}n&&(i[3]=i[3]+1),e.colCount<=i[3]&&(i[3]=e.colCount-1)}if(t.keyCode===37){for(var s=r[0];s<=r[2];s++){var l=(0,w.$Su)(s,i[3],this.parent.getActiveSheet());if(!(0,a.le)(l)&&l.colSpan&&l.colSpan<0){i[3]=i[3]-(Math.abs(l.colSpan)+1),n=!1;break}}n&&(i[3]=i[3]-1),i[3]<0&&(i[3]=0)}if(t.shiftKey&&t.ctrlKey&&!this.parent.scrollSettings.enableVirtualization){var h=[e.usedRange.rowIndex,e.usedRange.colIndex];t.keyCode===37&&(i[3]<=h[1]?i[3]=0:i[3]=h[1]),t.keyCode===38&&(i[2]<=h[0]?i[2]=0:i[2]=h[0]),t.keyCode===39&&(i[3]<=h[1]?i[3]=h[1]:i[3]=this.parent.getActiveSheet().colCount),t.keyCode===40&&(i[2]<=h[0]?i[2]=h[0]:i[2]=this.parent.getActiveSheet().rowCount)}if(t.keyCode===37||t.keyCode===39||t.keyCode===38||t.keyCode===40){for(var c=(0,w.n53)(e.activeCell);(0,w.gSQ)(this.parent.getActiveSheet(),i[2]);)t.keyCode===40&&(i[2]=i[2]+1),t.keyCode===38&&(i[2]=i[2]-1);this.parent.selectRange((0,w.i0K)(i)),this.scrollNavigation([(0,w.uan)(e,i)?c[0]:i[2],(0,w.Axt)(e,i)?c[1]:i[3]],!1)}},o.prototype.scrollNavigation=function(t,e){if(!!this.parent.allowScrolling){var i=this.parent.enableRtl?-1:1,r=this.parent.getMainContent().parentElement,n=this.parent.getScrollElement(),s=this.parent.getActiveSheet(),l=(0,w.gaE)((0,w.dK5)(s.selectedRange)),h=(0,w.n53)(s.topLeftCell),c=this.parent.frozenRowCount(s),u=this.parent.frozenColCount(s),p=(0,w.n53)(s.paneTopLeftCell),f=(0,w.Sxm)(s,t[0]<c?h[0]:p[0],!0),g=t[1]<u?h[1]:p[1],C=this.parent.scrollModule.offset.top.size;if(r.scrollTop){if(c&&t[0]!==l[2]){if(t[0]===c){r.scrollTop=0;return}t[0]===c-1&&(r.scrollTop=0)}else if(t[0]===(0,w.Sxm)(s,0,!0)){r.scrollTop=0;return}}if(n&&n.scrollLeft){if(u&&t[1]!==l[3]){if(t[1]===u){n.scrollLeft=0;return}t[1]===u-1&&(n.scrollLeft=0)}else if(t[1]===(0,w.Sxm)(s,0,!0,"columns")){n.scrollLeft=0;return}}this.getBottomIdx(f)<=t[0]||e?(r.scrollTop=C+(0,w.NEZ)(s,(0,w.Sxm)(s,p[0],!0),!0),t[0]<(0,w.Sxm)(s,s.rowCount-1,!1)&&(this.parent.scrollModule.isKeyScroll=!1)):f>t[0]&&(r.scrollTop=C-Math.ceil((0,w.NEZ)(s,t[0],!0)),this.parent.scrollModule.isKeyScroll=!1);var L=this.getRightIdx(g);(L<=t[1]||e)&&n?(n.scrollLeft+=(0,w.IQS)(s,L,null,!0)*i,t[1]<L&&(this.parent.scrollModule.isKeyScroll=!1)):g>t[1]&&n&&(n.scrollLeft-=(0,w.IQS)(s,t[1],null,!0)*i,this.parent.scrollModule.isKeyScroll=!1)}},o.prototype.getBottomIdx=function(t){for(var e=0,i=this.parent.getActiveSheet(),r=(i.frozenRows?this.parent.viewport.height-this.parent.sheetModule.getColHeaderHeight(i,!0):this.parent.viewport.height)-17||20,n=t;;n++)if(e+=(0,w.NEZ)(i,n,!0),e>=r)return n},o.prototype.getRightIdx=function(t){for(var e=0,i=this.parent.getActiveSheet(),r=this.parent.getMainContent().parentElement.offsetWidth-this.parent.sheetModule.getRowHeaderWidth(i)-this.parent.sheetModule.getScrollSize(),n=t;;n++)if(e+=(0,w.IQS)(i,n,null,!0),e>=r)return n},o.prototype.getModuleName=function(){return"keyboardNavigation"},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o}(),zr=ae(53857),wo=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(E.SH,this.keyDownHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(E.SH,this.keyDownHandler)},o.prototype.isTrgtNotInput=function(t){var e=t.target;return!(0,a.oq)(e,".e-filter-popup")&&!(0,a.oq)(e,".e-find-dlg")&&!(0,a.oq)(e,".e-hyperlink-dlg")&&!(0,a.oq)(e,".e-sheet-tab")&&!(0,a.oq)(e,".e-name-box")&&!(0,a.oq)(e,".e-link-dialog")},o.prototype.keyDownHandler=function(t){if((t.ctrlKey||t.metaKey)&&this.isTrgtNotInput(t)){if((0,a.oq)(t.target,".e-find-dlg")||([79,83].indexOf(t.keyCode)>-1||t.keyCode===65&&!this.parent.isEdit)&&t.preventDefault(),t.keyCode===79)(0,a.Ys)("#"+this.parent.element.id+"_fileUpload",this.parent.element).click();else if(t.keyCode===83)this.parent.saveUrl&&this.parent.allowSave&&this.parent.notify(w.Tsy,null);else if(t.keyCode===67)this.parent.notify(E.JG,{promise:Promise});else if(t.keyCode===75){var e=this.parent.getActiveSheet(),i=(0,pe.n53)(e.activeCell),r=this.parent.sheets[this.parent.getActiveSheet().id-1].rows[i[0]],n=void 0;t.preventDefault(),(0,a.le)(r)||(n=r.cells[i[1]]),(0,a.le)(n)&&(0,zr.Jx)(i[0],i[1],this.parent.getActiveSheet(),n,!1),n&&n.hyperlink?this.parent.notify(E.qP,null):this.parent.notify(E.tW,null)}else t.keyCode===90?this.parent.isEdit||(t.preventDefault(),this.parent.notify(E.Y5,{isUndo:!0})):t.keyCode===89?this.parent.isEdit||(t.preventDefault(),this.parent.notify(E.Y5,{isUndo:!1})):(t.keyCode===82||t.keyCode===68)&&(t.preventDefault(),this.parent.notify(E.mw,{verticalFill:t.keyCode===68}));var s=this.parent.sheets[this.parent.getActiveSheet().id-1],l=void 0;if(s){var h=s.activeCell,c=(0,pe.n53)(h),u=(0,zr.$S)(c[0],c[1],s);l=s.isProtected&&(0,w.p1d)(u,(0,w.wDo)(s,c[1]))}if(t.keyCode===70&&(t.preventDefault(),this.parent.notify(pe.JK0,null)),(!l||!s.isProtected||t.keyCode===86)&&t.keyCode!==70){if(t.keyCode===71)t.preventDefault(),this.parent.notify(E.T7,null);else if(t.keyCode===72)t.preventDefault(),this.parent.notify(E.DK,null);else if(t.keyCode===88)this.parent.notify(E.z7,{promise:Promise});else if(t.keyCode===86)this.parent.notify(E.v,{isAction:!0});else if(t.keyCode===66){t.preventDefault();var p=this.parent.getCellStyleValue(["fontWeight"],(0,pe.n53)(this.parent.getActiveSheet().activeCell)).fontWeight;p=p==="bold"?"normal":"bold",this.parent.notify(pe.vbl,{style:{fontWeight:p},onActionUpdate:!0,refreshRibbon:!0})}else if(t.keyCode===73){t.preventDefault();var p=this.parent.getCellStyleValue(["fontStyle"],(0,pe.n53)(this.parent.getActiveSheet().activeCell)).fontStyle;p=p==="italic"?"normal":"italic",this.parent.notify(pe.vbl,{style:{fontStyle:p},onActionUpdate:!0,refreshRibbon:!0})}else t.keyCode===85?(t.preventDefault(),this.parent.notify(pe.nQ,{style:{textDecoration:"underline"},refreshRibbon:!0})):t.keyCode===53&&(t.preventDefault(),this.parent.notify(pe.nQ,{style:{textDecoration:"line-through"},refreshRibbon:!0}));t.shiftKey&&t.keyCode===76&&(this.parent.isEdit||(t.preventDefault(),this.parent.notify(E.WG,{})))}}t.keyCode===27&&this.parent.notify(E.EP,null)},o.prototype.getModuleName=function(){return"keyboardShortcut"},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o}(),xo=function(){function o(t){this.checkHeight=!1,this.parent=t,this.parent.on(E.T5,this.addEventListener,this)}return o.prototype.applyCellFormat=function(t){if(t.checkHeight){this.checkHeight||(this.checkHeight=!0),this.updateRowHeight(t.rowIdx,t.colIdx,t.lastCell,t.onActionUpdate,t.outsideViewport);return}var e=Object.keys(t.style),i=this.parent.getActiveSheet();if(!(t.lastCell&&Te(i,t.rowIdx)<=20&&!e.length)){var r=t.cell||this.parent.getCell(t.rowIdx,t.colIdx);if(r){if(this.updateMergeBorder(t,i),t.style.border!==void 0||t.style.borderTop!==void 0||t.style.borderLeft!==void 0){var n={};Object.keys(t.style).forEach(function(u){n[u]=t.style[u]}),n.border!==void 0&&(Object.assign(r.style,{borderRight:t.style.border,borderBottom:t.style.border}),this.setLeftBorder(t.style.border,r,t.rowIdx,t.colIdx,t.row,t.onActionUpdate,t.first,i),this.setTopBorder(t.style.border,r,t.rowIdx,t.colIdx,t.pRow,t.pHRow,t.onActionUpdate,t.first,t.lastCell,t.manualUpdate,i),delete n.border),n.borderTop!==void 0&&(this.setTopBorder(t.style.borderTop,r,t.rowIdx,t.colIdx,t.pRow,t.pHRow,t.onActionUpdate,t.first,t.lastCell,t.manualUpdate,i),delete n.borderTop),n.borderLeft!==void 0&&(this.setLeftBorder(t.style.borderLeft,r,t.rowIdx,t.colIdx,t.row,t.onActionUpdate,t.first,i),delete n.borderLeft),Object.keys(n).length&&(n.borderBottom!==void 0&&this.setThickBorderHeight(n.borderBottom,t.rowIdx,t.colIdx,r,t.row,t.hRow,t.onActionUpdate,t.lastCell,t.manualUpdate),Object.assign(r.style,n))}else{t.style.borderBottom!==void 0&&this.setThickBorderHeight(t.style.borderBottom,t.rowIdx,t.colIdx,r,t.row,t.hRow,t.onActionUpdate,t.lastCell,t.manualUpdate),Object.assign(r.style,t.style);var s=(0,w.$Su)(t.rowIdx,t.colIdx,i);if(s&&(s.rowSpan||s.colSpan)&&r.offsetHeight>0){var l=pt(this.parent,s.style||this.parent.cellStyle);l>r.offsetHeight&&tt(this.parent,i,r.offsetHeight,t.rowIdx)}}var h=(0,w.$Su)(t.rowIdx,t.colIdx,i,null,!0);if(!i.rows[t.rowIdx]||!i.rows[t.rowIdx].customHeight){if(t.isHeightCheckNeeded){if(t.manualUpdate)this.checkHeight||(this.checkHeight=(0,w.X1M)(t.style,t.onActionUpdate)),r&&r.children[0]&&r.children[0].className==="e-cf-databar"&&t.style.fontSize&&(r.children[0].querySelector(".e-databar-value").style.fontSize=t.style.fontSize),this.updateRowHeight(t.rowIdx,t.colIdx,t.lastCell,t.onActionUpdate),h.wrap&&(t.style.fontSize||t.style.fontFamily)&&(r.style.lineHeight=parseFloat(h.style&&h.style.fontSize||this.parent.cellStyle.fontSize)*st(h.style&&h.style.fontFamily?h.style:this.parent.cellStyle)+"pt");else if(!h.wrap&&(0,w.X1M)(t.style)&&Ne(i,t.rowIdx,t.colIdx,ee(this.parent,t.rowIdx,t.colIdx,i,t.style)),t.lastCell){var l=Te(i,t.rowIdx);l>20&&l>(0,w.NEZ)(i,t.rowIdx)&&tt(this.parent,i,l,t.rowIdx,t.row,t.hRow,this.parent.scrollSettings.isFinite)}}}else if(!h.wrap&&t.style.fontSize){var c=(0,w.NEZ)(i,t.rowIdx,!0)-Vt(t.rowIdx,t.colIdx,i);c<pt(this.parent,h.style)?r.style.lineHeight=c+"px":r.style.lineHeight&&(r.style.lineHeight="")}}else this.updateRowHeight(t.rowIdx,t.colIdx,!0,t.onActionUpdate)}},o.prototype.updateRowHeight=function(t,e,i,r,n){if(this.checkHeight){var s=this.parent.getActiveSheet(),l=(0,w.$Su)(t,e,s,null,!0);if(!l.rowSpan&&!l.colSpan){var h=0;h=ee(this.parent,t,e,s,l.style||this.parent.cellStyle,l.wrap?rt(this.parent.getDisplayText(l),ce(s,t,e),l.style,this.parent.cellStyle):1);var c=l.value&&l.value.toString();if(c&&c.indexOf(`
`)>-1){var u=void 0,p=c.split(`
`),f=0,g=p.length;for(u=0;u<g;u++){var C=rt(p[u],ce(s,t,e),l.style,this.parent.cellStyle);C===0&&(C=1),f=f+C}h=ee(this.parent,t,e,s,l.style||this.parent.cellStyle,f)}if(h<20&&(h=20),Ne(s,t,e,h),!n){var L=this.parent.getCell(t,e);L&&L.children[0]&&L.children[0].className==="e-cf-databar"&&(L.children[0].style.height="100%",L.children[0].firstElementChild.nextElementSibling.style.height="100%")}if(i){this.checkHeight=!1;var D=Te(s,t),R=(0,w.NEZ)(s,t);(r?D!==R:D>R)&&(n?(R=G(R),(0,w.vmj)(s,t,D),this.parent.setProperties({sheets:this.parent.sheets},!0),this.parent.notify(E.QK,{rowIdx:t,threshold:G(D)-R})):tt(this.parent,s,D,t,null,null,!0))}}}},o.prototype.updateMergeBorder=function(t,e){var i=(0,w.$Su)(t.rowIdx,t.colIdx,e,null,!0),r={range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]};if(this.parent.notify(w.Zf5,r),i.rowSpan>1&&!t.style.borderBottom){var n=(0,w.$Su)(r.range[2],r.range[1],e,null,!0);n.style&&n.style.borderBottom&&(t.style.borderBottom=n.style.borderBottom)}if(i.colSpan>1&&!t.style.borderRight){var s=(0,w.$Su)(r.range[0],r.range[3],e,null,!0);s.style&&s.style.borderRight&&(t.style.borderRight=s.style.borderRight)}},o.prototype.setLeftBorder=function(t,e,i,r,n,s,l,h){if(!(l&&l.includes("Column"))){var c=this.parent.getCell(i,r-1,n);if(c){var u=(0,w.$Su)(i,r-1,h,!1,!0);if(!!u.rowSpan&&u.rowSpan!==1||!!u.colSpan&&u.colSpan!==1){var p={range:[i,r-1,i,r-1]};if(this.parent.notify(w.Zf5,p),u=(0,w.$Su)(p.range[0],p.range[1],h,!1,!0),u.style&&u.style.borderRight&&u.style.borderRight!=="none")return;if(u=(0,w.$Su)(p.range[0],p.range[3],h,null,!0),u.style&&u.style.borderRight&&u.style.borderRight!=="none")return;e.style.borderLeft=t}else s&&t!==""&&r===this.parent.viewport.leftIndex&&(this.parent.getMainContent().scrollLeft-=this.getBorderSize(t)),c.style.borderRight=t==="none"?c.style.borderRight:t}else e.style.borderLeft=t}},o.prototype.setTopBorder=function(t,e,i,r,n,s,l,h,c,u,p){if(!(h&&h.includes("Row"))){var f=this.parent.getCell(i-1,r,n);if(f){var g=(0,w.$Su)(i-1,r,p,!1,!0);if(!!g.rowSpan&&g.rowSpan!==1||!!g.colSpan&&g.colSpan!==1){var C={range:[i-1,r,i-1,r]};if(this.parent.notify(w.Zf5,C),g=(0,w.$Su)(C.range[0],C.range[1],p,!1,!0),g.style&&g.style.borderBottom&&g.style.borderBottom!=="none")return;if(g=(0,w.$Su)(C.range[2],C.range[1],p,null,!0),g.style&&g.style.borderBottom&&g.style.borderBottom!=="none")return;e.style.borderTop=t}else{if((0,w.gSQ)(p,i-1)){var L=[Number(f.parentElement.getAttribute("aria-rowindex"))-1,r];if(this.parent.getCellStyleValue(["bottomPriority"],L).bottomPriority)return}l&&t!==""&&p.topLeftCell.includes(""+(i+1))&&(this.parent.getMainContent().parentElement.scrollTop-=this.getBorderSize(t)),this.setThickBorderHeight(t,i-1,r,f,n,s,l,c,u),f.style.borderBottom=t==="none"?f.style.borderBottom:t}}else e.style.borderTop=t}},o.prototype.setThickBorderHeight=function(t,e,i,r,n,s,l,h,c){var u=t?this.getBorderSize(t):1,p=this.parent.getActiveSheet();if(u>2&&(!p.rows[e]||!p.rows[e].customHeight))if(c)this.checkHeight||(this.checkHeight=!0),this.updateRowHeight(e,i,h,l);else{var f=(0,w.NEZ)(p,e),g=Math.ceil(this.parent.calculateHeight(this.parent.getCellStyleValue(["fontFamily","fontSize"],[e,i]),1,3));g>f&&(tt(this.parent,p,g,e,n,s,!1),this.parent.notify(E.QK,{rowIdx:e,threshold:g-20}))}l&&(h||!this.checkHeight)&&u<3&&(!p.rows[e]||!p.rows[e].customHeight)&&(this.checkHeight||(this.checkHeight=!0),this.updateRowHeight(e,i,h,l))},o.prototype.getBorderSize=function(t){var e=t.split(" ")[0];return e==="thin"?1:e==="medium"?2:e==="thick"?3:parseInt(e,10)?parseInt(e,10):1},o.prototype.clearObj=function(t){var e=t.options,i=e.range?e.range.indexOf("!")>0?e.range.split("!")[1]:e.range.split("!")[0]:this.parent.getActiveSheet().selectedRange,r=e.range&&e.range.indexOf("!")>0?(0,w.Q8D)(this.parent,e.range.split("!")[0]):this.parent.activeSheetIndex,n=(0,w.dK5)(i),s=this.parent.sheets[r],l=n[0],h=n[2],c,u,p=this.parent.element.getElementsByClassName("e-ss-overlay-active"),f=p.length>0,g={range:i,type:e.type,requestType:"clear",sheetIndex:r};if(t.isPublic||this.parent.notify(w.ya2,{action:"beforeClear",eventArgs:g}),(e.type==="Clear Formats"||e.type==="Clear All")&&(f||this.parent.notify(w.G2p,{range:i,isPublic:!1,isclearFormat:!0}),e.type==="Clear All"&&(f?p[0].classList.contains("e-datavisualization-chart")?this.parent.notify(E.k0,{id:p[0].id,sheetIdx:this.parent.activeSheetIndex+1}):this.parent.notify(E.ao,{id:p[0].id,sheetIdx:this.parent.activeSheetIndex+1}):(this.parent.notify(w.dKh,{range:i,isRemoveValidation:!0}),l===0&&n[1]===0&&h>=s.usedRange.rowIndex&&n[3]>=s.usedRange.colIndex&&this.parent.setUsedRange(l,n[1],s,!1,!0))),!f))for(l;l<=h;l++)for(c=n[1],u=n[3],c;c<=u;c++){var C=(0,w.$Su)(l,c,s),L=this.parent.getCell(l,c);C&&(C.formula&&this.parent.notify(w.fdW,{cellRef:(0,w.i0K)([l,c,l,c])}),C.wrap&&this.parent.notify(w.agw,{range:[l,c,l,c],wrap:!1,sheet:s}),C.hyperlink&&((0,a.IV)(L.querySelectorAll(".e-hyperlink"),"e-hyperlink-style"),e.type==="Clear All"&&this.parent.removeHyperlink(s.name+"!"+(0,w.i0K)([l,c,l,c]))))}f||(e.type==="Clear Hyperlinks"&&this.parent.removeHyperlink(s.name+"!"+i),this.parent.notify(w.ZHw,{range:s.name+"!"+i,type:e.type}),this.parent.serviceLocator.getService("cell").refreshRange((0,w.dK5)(i))),t.isPublic||(g={range:s.name+"!"+i,type:e.type,sheetIndex:r},this.parent.notify("actionComplete",{eventArgs:g,action:"clear"})),f||(this.parent.notify(w.CC2,{range:i,isclearFormat:!0}),t.isFromUpdateAction||this.parent.notify(E.Y0,{address:i}),this.parent.notify(w.q6q,null))},o.prototype.addEventListener=function(){this.parent.on(w.nJk,this.applyCellFormat,this),this.parent.on(E.MQ,this.clearObj,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.T5,this.addEventListener),this.parent.off(w.nJk,this.applyCellFormat),this.parent.off(E.MQ,this.clearObj))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null,this.checkHeight=null},o.prototype.getModuleName=function(){return"cellformat"},o}(),Vl=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ai=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},jc=1500,Wc=500,Uc=0,qc=8,Zc=2,vs=2,Eo="e-tooltip",zl="e-rtl",Yc="e-bigger",rf="e-icons",Gc="e-tooltip-close",Ao="e-tooltip-wrap",_l="e-tip-content",$s="e-arrow-tip",jl="e-arrow-tip-outer",Ba="e-arrow-tip-inner",Qs="e-tip-bottom",To="e-tip-top",Wl="e-tip-left",Kc="e-tip-right",Xc="e-popup",Ul="e-popup-open",$c="e-popup-close",ql="e-lib",X0="e-hidden",nf="e-tooltip-popup-container",$0=function(o){Vl(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ai([(0,a.Z9)({effect:"FadeIn",duration:150,delay:0})],t.prototype,"open",void 0),ai([(0,a.Z9)({effect:"FadeOut",duration:150,delay:0})],t.prototype,"close",void 0),t}(a.rt),Lo=function(o){Vl(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.mouseMoveEvent=null,r.mouseMoveTarget=null,r.containerElement=null,r.isBodyContainer=!0,r}return t.prototype.initialize=function(){this.formatPosition(),(0,a.cn)([this.element],Eo)},t.prototype.formatPosition=function(){var e,i;this.position.indexOf("Top")===0||this.position.indexOf("Bottom")===0?(e=this.position.split(/(?=[A-Z])/),this.tooltipPositionY=e[0],this.tooltipPositionX=e[1]):(i=this.position.split(/(?=[A-Z])/),this.tooltipPositionX=i[0],this.tooltipPositionY=i[1])},t.prototype.renderArrow=function(){this.setTipClass(this.position);var e=this.createElement("div",{className:$s+" "+this.tipClass});e.appendChild(this.createElement("div",{className:jl+" "+this.tipClass})),e.appendChild(this.createElement("div",{className:Ba+" "+this.tipClass})),this.tooltipEle.appendChild(e)},t.prototype.setTipClass=function(e){e.indexOf("Right")===0?this.tipClass=Wl:e.indexOf("Bottom")===0?this.tipClass=To:e.indexOf("Left")===0?this.tipClass=Kc:this.tipClass=Qs},t.prototype.renderPopup=function(e){var i=this.mouseTrail?{top:0,left:0}:this.getTooltipPosition(e);this.tooltipEle.classList.remove(ql),this.popupObj=new br(this.tooltipEle,{height:this.height,width:this.width,position:{X:i.left,Y:i.top},enableRtl:this.enableRtl,open:this.openPopupHandler.bind(this),close:this.closePopupHandler.bind(this)})},t.prototype.getTooltipPosition=function(e){this.tooltipEle.style.display="block";var i=Di(e,this.tooltipPositionX,this.tooltipPositionY,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect()),r=this.calculateTooltipOffset(this.position),n=this.calculateElementPosition(i,r),s=n[0],l=n[1],h=this.collisionFlipFit(e,s,l);return this.tooltipEle.style.display="",h},t.prototype.windowResize=function(){this.reposition(this.findTarget())},t.prototype.reposition=function(e){if(this.popupObj&&e){var i=this.getTooltipPosition(e);this.popupObj.position={X:i.left,Y:i.top},this.popupObj.dataBind()}},t.prototype.openPopupHandler=function(){!this.mouseTrail&&this.needTemplateReposition()&&this.reposition(this.findTarget()),this.trigger("afterOpen",this.tooltipEventArgs)},t.prototype.closePopupHandler=function(){this.clearTemplate(["content"]),this.clear(),this.trigger("afterClose",this.tooltipEventArgs)},t.prototype.calculateTooltipOffset=function(e){var i={top:0,left:0},r=this.tooltipEle.offsetWidth,n=this.tooltipEle.offsetHeight,s=(0,a.Ys)("."+$s,this.tooltipEle),l=s?s.offsetWidth:0,h=s?s.offsetHeight:0,c=this.showTipPointer?Uc:qc,u=h/2+vs+(this.tooltipEle.offsetHeight-this.tooltipEle.clientHeight),p=l/2+vs+(this.tooltipEle.offsetWidth-this.tooltipEle.clientWidth);switch(this.mouseTrail&&(c+=Zc),e){case"RightTop":i.left+=l+c,i.top-=n-u;break;case"RightCenter":i.left+=l+c,i.top-=n/2;break;case"RightBottom":i.left+=l+c,i.top-=u;break;case"BottomRight":i.top+=h+c,i.left-=p;break;case"BottomCenter":i.top+=h+c,i.left-=r/2;break;case"BottomLeft":i.top+=h+c,i.left-=r-p;break;case"LeftBottom":i.left-=l+r+c,i.top-=u;break;case"LeftCenter":i.left-=l+r+c,i.top-=n/2;break;case"LeftTop":i.left-=l+r+c,i.top-=n-u;break;case"TopLeft":i.top-=n+h+c,i.left-=r-p;break;case"TopRight":i.top-=n+h+c,i.left-=p;break;default:i.top-=n+h+c,i.left-=r/2;break}return i.left+=this.offsetX,i.top+=this.offsetY,i},t.prototype.updateTipPosition=function(e){var i=(0,a.td)("."+$s+",."+jl+",."+Ba,this.tooltipEle),r=[Qs,To,Wl,Kc];(0,a.IV)(i,r),this.setTipClass(e),(0,a.cn)(i,this.tipClass)},t.prototype.adjustArrow=function(e,i,r,n){if(this.showTipPointer!==!1){this.updateTipPosition(i);var s,l;this.tooltipEle.style.display="block";var h=this.tooltipEle.clientWidth,c=this.tooltipEle.clientHeight,u=(0,a.Ys)("."+$s,this.tooltipEle),p=(0,a.Ys)("."+Ba,this.tooltipEle),f=u.offsetWidth,g=u.offsetHeight;if(this.tooltipEle.style.display="",this.tipClass===Qs||this.tipClass===To){if(this.tipClass===Qs?(l="99.9%",p.style.top="-"+(g-2)+"px"):(l=-(g-1)+"px",p.style.top="-"+(g-6)+"px"),e){var C=r!=="Center"||h>e.offsetWidth||this.mouseTrail;C&&r==="Left"||!C&&this.tipPointerPosition==="End"?s=h-f-vs+"px":C&&r==="Right"||!C&&this.tipPointerPosition==="Start"?s=vs+"px":s=h/2-f/2+"px"}}else{this.tipClass===Kc?(s="99.9%",p.style.left="-"+(f-2)+"px"):(s=-(f-1)+"px",p.style.left=-f+(f-2)+"px");var C=n!=="Center"||c>e.offsetHeight||this.mouseTrail;C&&n==="Top"||!C&&this.tipPointerPosition==="End"?l=c-g-vs+"px":C&&n==="Bottom"||!C&&this.tipPointerPosition==="Start"?l=vs+"px":l=c/2-g/2+"px"}u.style.top=l,u.style.left=s}},t.prototype.renderContent=function(e){var i=(0,a.Ys)("."+_l,this.tooltipEle);if(this.cssClass&&(0,a.cn)([this.tooltipEle],this.cssClass.split(" ")),e&&!(0,a.le)(e.getAttribute("title"))&&(e.setAttribute("data-content",e.getAttribute("title")),e.removeAttribute("title")),(0,a.le)(this.content))e&&!(0,a.le)(e.getAttribute("data-content"))&&(i.innerHTML=e.getAttribute("data-content"));else if(i.innerHTML="",this.content instanceof HTMLElement)i.appendChild(this.content);else if(typeof this.content=="string"){this.enableHtmlSanitizer&&this.setProperties({content:a.pJ.sanitize(this.content)},!0);var r=(0,a.MY)(this.content),n=r({},this,"content",this.element.id+"content",void 0,void 0,i);if(n){if(this.enableHtmlParse)for(var s=n.length,l=0;l<s;l++)(0,a.R3)(n,i);else i.textContent=this.content;this.enableHtmlParse?(0,a.R3)(n,i):i.textContent=this.content}}else{var h=(0,a.MY)(this.content),n=h({},this,"content",this.element.id+"content",void 0,void 0,i);n&&(0,a.R3)(n,i),this.renderReactTemplates()}},t.prototype.renderCloseIcon=function(){if(!!this.isSticky){var e=this.createElement("div",{className:rf+" "+Gc});this.tooltipEle.appendChild(e),a.bi.add(e,a.AR.touchStartEvent,this.onStickyClose,this)}},t.prototype.addDescribedBy=function(e,i){var r=(e.getAttribute("aria-describedby")||"").split(/\s+/);r.indexOf(i)<0&&r.push(i),(0,a.Y4)(e,{"aria-describedby":r.join(" ").trim(),"data-tooltip-id":i})},t.prototype.removeDescribedBy=function(e){var i=e.getAttribute("data-tooltip-id"),r=(e.getAttribute("aria-describedby")||"").split(/\s+/),n=r.indexOf(i);n!==-1&&r.splice(n,1),e.removeAttribute("data-tooltip-id");var s=r.join(" ").trim();s?e.setAttribute("aria-describedby",s):e.removeAttribute("aria-describedby")},t.prototype.tapHoldHandler=function(e){clearTimeout(this.autoCloseTimer),this.targetHover(e.originalEvent)},t.prototype.touchEndHandler=function(e){var i=this;if(!this.isSticky){var r=function(){i.close()};this.autoCloseTimer=setTimeout(r,jc)}},t.prototype.targetClick=function(e){var i;this.target?i=(0,a.oq)(e.target,this.target):i=this.element,!(0,a.le)(i)&&(i.getAttribute("data-tooltip-id")===null?this.targetHover(e):this.isSticky||this.hideTooltip(this.animation.close,e,i))},t.prototype.targetHover=function(e){var i;if(this.target?i=(0,a.oq)(e.target,this.target):i=this.element,!((0,a.le)(i)||i.getAttribute("data-tooltip-id")!==null&&this.closeDelay===0)){for(var r=[].slice.call((0,a.td)('[data-tooltip-id= "'+this.ctrlId+'_content"]',document)),n=0,s=r;n<s.length;n++){var l=s[n];this.restoreElement(l)}this.showTooltip(i,this.animation.open,e)}},t.prototype.mouseMoveBeforeOpen=function(e){this.mouseMoveEvent=e},t.prototype.mouseMoveBeforeRemove=function(){this.mouseMoveTarget&&a.bi.remove(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen)},t.prototype.showTooltip=function(e,i,r){var n=this;clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.openDelay&&this.mouseTrail&&(this.mouseMoveBeforeRemove(),this.mouseMoveTarget=e,a.bi.add(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen,this)),this.tooltipEventArgs={type:r?r.type:null,cancel:!1,target:e,event:r||null,element:this.tooltipEle,isInteracted:!(0,a.le)(r)};var s=function(l){n.beforeRenderCallback(l,e,r,i)};this.trigger("beforeRender",this.tooltipEventArgs,s.bind(this))},t.prototype.beforeRenderCallback=function(e,i,r,n){e.cancel?(this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove()):(this.isHidden=!1,(0,a.le)(this.tooltipEle)?(this.ctrlId=this.element.getAttribute("id")?(0,a.QI)(this.element.getAttribute("id")):(0,a.QI)("tooltip"),this.tooltipEle=this.createElement("div",{className:Ao+" "+Xc+" "+ql,attrs:{role:"tooltip","aria-hidden":"false",id:this.ctrlId+"_content"},styles:"width:"+(0,a.Ac)(this.width)+";height:"+(0,a.Ac)(this.height)+";position:absolute;"}),this.tooltipBeforeRender(i,this),this.tooltipAfterRender(i,r,n,this)):i&&(this.adjustArrow(i,this.position,this.tooltipPositionX,this.tooltipPositionY),this.addDescribedBy(i,this.ctrlId+"_content"),this.renderContent(i),a.fw.stop(this.tooltipEle),this.reposition(i),this.tooltipAfterRender(i,r,n,this)))},t.prototype.appendContainer=function(e){typeof this.container=="string"?this.container==="body"?this.containerElement=document.body:(this.isBodyContainer=!1,this.containerElement=(0,a.Ys)(this.container,document)):this.container instanceof HTMLElement&&(this.containerElement=this.container,this.isBodyContainer=this.containerElement.tagName==="BODY"),this.isBodyContainer||(0,a.cn)([this.containerElement],nf),this.containerElement.appendChild(e.tooltipEle)},t.prototype.tooltipBeforeRender=function(e,i){e&&(a.AR.isDevice&&(0,a.cn)([i.tooltipEle],Yc),i.width!=="auto"&&(i.tooltipEle.style.maxWidth=(0,a.Ac)(i.width)),i.tooltipEle.appendChild(i.createElement("div",{className:_l})),this.appendContainer(i),(0,a.IV)([i.tooltipEle],X0),i.addDescribedBy(e,i.ctrlId+"_content"),i.renderContent(e),(0,a.cn)([i.tooltipEle],Ul),i.showTipPointer&&i.renderArrow(),i.renderCloseIcon(),i.renderPopup(e),i.adjustArrow(e,i.position,i.tooltipPositionX,i.tooltipPositionY),a.fw.stop(i.tooltipEle),i.reposition(e))},t.prototype.tooltipAfterRender=function(e,i,r,n){if(e){(0,a.IV)([n.tooltipEle],Ul),(0,a.cn)([n.tooltipEle],$c),n.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:e,event:i||null,element:n.tooltipEle,isInteracted:!(0,a.le)(i)},n.needTemplateReposition()&&!n.mouseTrail&&(n.tooltipEle.style.display="none");var s=function(l){n.beforeOpenCallback(l,e,r,i)};n.trigger("beforeOpen",n.tooltipEventArgs,s.bind(n))}},t.prototype.beforeOpenCallback=function(e,i,r,n){var s=this;if(e.cancel)this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove(),this.restoreElement(i);else{var l={name:r.effect,duration:r.duration,delay:r.delay,timingFunction:"easeOut"};if(r.effect==="None"&&(l=void 0),this.openDelay>0){var h=function(){s.mouseTrail&&a.bi.add(i,"mousemove touchstart mouseenter",s.onMouseMove,s),s.popupObj&&(s.popupObj.show(l,i),s.mouseMoveEvent&&s.mouseTrail&&s.onMouseMove(s.mouseMoveEvent))};this.showTimer=setTimeout(h,this.openDelay)}else this.popupObj&&this.popupObj.show(l,i)}n&&this.wireMouseEvents(n,i)},t.prototype.needTemplateReposition=function(){var e=this;return!(0,a.le)(e.viewContainerRef)&&typeof e.viewContainerRef!="string"},t.prototype.checkCollision=function(e,i,r){var n={left:i,top:r,position:this.position,horizontal:this.tooltipPositionX,vertical:this.tooltipPositionY},s=Vr(this.tooltipEle,this.checkCollideTarget(),i,r);return s.length>0&&(n.horizontal=s.indexOf("left")>=0?"Right":s.indexOf("right")>=0?"Left":this.tooltipPositionX,n.vertical=s.indexOf("top")>=0?"Bottom":s.indexOf("bottom")>=0?"Top":this.tooltipPositionY),n},t.prototype.calculateElementPosition=function(e,i){return[this.isBodyContainer?e.left+i.left:e.left-this.containerElement.offsetLeft+i.left+window.pageXOffset+this.containerElement.scrollLeft,this.isBodyContainer?e.top+i.top:e.top-this.containerElement.offsetTop+i.top+window.pageYOffset+this.containerElement.scrollTop]},t.prototype.collisionFlipFit=function(e,i,r){var n=this.checkCollision(e,i,r),s=n.position;this.tooltipPositionY!==n.vertical&&(s=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?n.vertical+this.tooltipPositionX:this.tooltipPositionX+n.vertical),this.tooltipPositionX!==n.horizontal&&(s.indexOf("Left")===0&&(n.vertical=s==="LeftTop"||s==="LeftCenter"?"Top":"Bottom",s=n.vertical+"Left"),s.indexOf("Right")===0&&(n.vertical=s==="RightTop"||s==="RightCenter"?"Top":"Bottom",s=n.vertical+"Right"),n.horizontal=this.tooltipPositionX),this.tooltipEventArgs={type:null,cancel:!1,target:e,event:null,element:this.tooltipEle,collidedPosition:s},this.trigger("beforeCollision",this.tooltipEventArgs);var l=n.vertical,h=n.horizontal;if(n.position!==s){var c=Di(e,h,l,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect());this.adjustArrow(e,s,h,l);var u=this.calculateTooltipOffset(s);u.top-=this.getOffSetPosition("TopBottom",s,this.offsetY),u.left-=this.getOffSetPosition("RightLeft",s,this.offsetX),n.position=s;var p=this.calculateElementPosition(c,u);n.left=p[0],n.top=p[1]}else this.adjustArrow(e,s,h,l);var f={left:n.left,top:n.top},g=this.isBodyContainer?Ws(this.tooltipEle,this.checkCollideTarget(),{X:!0,Y:!1},f).left:f.left;if(this.tooltipEle.style.display="block",this.showTipPointer&&(s.indexOf("Bottom")===0||s.indexOf("Top")===0)){var C=(0,a.Ys)("."+$s,this.tooltipEle),L=parseInt(C.style.left,10)-(g-n.left);L<0?L=0:L+C.offsetWidth>this.tooltipEle.clientWidth&&(L=this.tooltipEle.clientWidth-C.offsetWidth),C.style.left=L.toString()+"px"}return this.tooltipEle.style.display="",f.left=g,f},t.prototype.getOffSetPosition=function(e,i,r){return e.indexOf(this.position.split(/(?=[A-Z])/)[0])!==-1&&e.indexOf(i.split(/(?=[A-Z])/)[0])!==-1?2*r:0},t.prototype.checkCollideTarget=function(){return!this.windowCollision&&this.target?this.element:null},t.prototype.hideTooltip=function(e,i,r){var n=this;if(this.closeDelay>0){clearTimeout(this.hideTimer),clearTimeout(this.showTimer);var s=function(){n.closeDelay&&n.tooltipEle&&n.isTooltipOpen||n.tooltipHide(e,i,r)};this.hideTimer=setTimeout(s,this.closeDelay)}else this.tooltipHide(e,i,r)},t.prototype.tooltipHide=function(e,i,r){var n=this,s;i?s=this.target?r||i.target:this.element:s=(0,a.Ys)('[data-tooltip-id= "'+this.ctrlId+'_content"]',document),this.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:s,event:i||null,element:this.tooltipEle,isInteracted:!(0,a.le)(i)},this.trigger("beforeClose",this.tooltipEventArgs,function(l){l.cancel?n.isHidden=!1:(n.mouseMoveBeforeRemove(),n.popupHide(e,s))})},t.prototype.popupHide=function(e,i){i&&this.restoreElement(i),this.isHidden=!0;var r={name:e.effect,duration:e.duration,delay:e.delay,timingFunction:"easeIn"};e.effect==="None"&&(r=void 0),this.popupObj&&this.popupObj.hide(r)},t.prototype.restoreElement=function(e){this.unwireMouseEvents(e),(0,a.le)(e.getAttribute("data-content"))||(e.setAttribute("title",e.getAttribute("data-content")),e.removeAttribute("data-content")),this.removeDescribedBy(e)},t.prototype.clear=function(){this.tooltipEle&&((0,a.IV)([this.tooltipEle],$c),(0,a.cn)([this.tooltipEle],Ul)),this.isHidden&&(this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&(0,a.Od)(this.tooltipEle),this.tooltipEle=null,this.popupObj=null)},t.prototype.tooltipHover=function(e){this.tooltipEle&&(this.isTooltipOpen=!0)},t.prototype.tooltipMouseOut=function(e){this.isTooltipOpen=!1,this.hideTooltip(this.animation.close,e,this.findTarget())},t.prototype.onMouseOut=function(e){var i=e.relatedTarget;if(i&&!this.mouseTrail){var r=(0,a.oq)(i,"."+Ao+"."+ql+"."+Xc);r?a.bi.add(r,"mouseleave",this.tooltipElementMouseOut,this):(this.hideTooltip(this.animation.close,e,this.findTarget()),this.closeDelay===0&&this.clear())}else this.hideTooltip(this.animation.close,e,this.findTarget()),this.clear()},t.prototype.tooltipElementMouseOut=function(e){this.hideTooltip(this.animation.close,e,this.findTarget()),a.bi.remove(this.element,"mouseleave",this.tooltipElementMouseOut),this.clear()},t.prototype.onStickyClose=function(e){this.close()},t.prototype.onMouseMove=function(e){var i=0,r=0;e.type.indexOf("touch")>-1?(e.preventDefault(),i=e.touches[0].pageX,r=e.touches[0].pageY):(i=e.pageX,r=e.pageY),a.fw.stop(this.tooltipEle),(0,a.IV)([this.tooltipEle],$c),(0,a.cn)([this.tooltipEle],Ul),this.adjustArrow(e.target,this.position,this.tooltipPositionX,this.tooltipPositionY);var n=this.calculateTooltipOffset(this.position),s=i+n.left+this.offsetX,l=r+n.top+this.offsetY,h=this.checkCollision(e.target,s,l);if(this.tooltipPositionX!==h.horizontal||this.tooltipPositionY!==h.vertical){var c=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?h.vertical+h.horizontal:h.horizontal+h.vertical;h.position=c,this.adjustArrow(e.target,h.position,h.horizontal,h.vertical);var u=this.calculateTooltipOffset(h.position);h.left=i+u.left-this.offsetX,h.top=r+u.top-this.offsetY}this.tooltipEle.style.left=h.left+"px",this.tooltipEle.style.top=h.top+"px"},t.prototype.keyDown=function(e){this.tooltipEle&&e.keyCode===27&&this.close()},t.prototype.touchEnd=function(e){this.tooltipEle&&(0,a.oq)(e.target,"."+Eo)===null&&!this.isSticky&&this.close()},t.prototype.scrollHandler=function(e){this.tooltipEle&&((0,a.oq)(e.target,"."+Ao+"."+ql+"."+Xc)||this.close())},t.prototype.render=function(){this.initialize(),this.wireEvents(this.opensOn),this.renderComplete()},t.prototype.preRender=function(){this.tipClass=Qs,this.tooltipPositionX="Center",this.tooltipPositionY="Top",this.isHidden=!0},t.prototype.wireEvents=function(e){for(var i=this.getTriggerList(e),r=0,n=i;r<n.length;r++){var s=n[r];if(s==="Custom")return;s==="Focus"&&this.wireFocusEvents(),s==="Click"&&a.bi.add(this.element,a.AR.touchStartEvent,this.targetClick,this),s==="Hover"&&(a.AR.isDevice?(this.touchModule=new a.Xh(this.element,{tapHoldThreshold:Wc,tapHold:this.tapHoldHandler.bind(this)}),a.bi.add(this.element,a.AR.touchEndEvent,this.touchEndHandler,this)):a.bi.add(this.element,"mouseover",this.targetHover,this))}a.bi.add(document,"touchend",this.touchEnd,this),a.bi.add(document,"scroll wheel",this.scrollHandler,this),a.bi.add(window,"resize",this.windowResize,this),a.bi.add(document,"keydown",this.keyDown,this)},t.prototype.getTriggerList=function(e){return e==="Auto"&&(e=a.AR.isDevice?"Hover":"Hover Focus"),e.split(" ")},t.prototype.wireFocusEvents=function(){if((0,a.le)(this.target))a.bi.add(this.element,"focus",this.targetHover,this);else for(var e=[].slice.call((0,a.td)(this.target,this.element)),i=0,r=e;i<r.length;i++){var n=r[i];a.bi.add(n,"focus",this.targetHover,this)}},t.prototype.wireMouseEvents=function(e,i){this.tooltipEle&&(this.isSticky||(e.type==="focus"&&a.bi.add(i,"blur",this.onMouseOut,this),e.type==="mouseover"&&a.bi.add(i,"mouseleave",this.onMouseOut,this),this.closeDelay&&(a.bi.add(this.tooltipEle,"mouseenter",this.tooltipHover,this),a.bi.add(this.tooltipEle,"mouseleave",this.tooltipMouseOut,this))),this.mouseTrail&&this.openDelay===0&&a.bi.add(i,"mousemove touchstart mouseenter",this.onMouseMove,this))},t.prototype.unwireEvents=function(e){for(var i=this.getTriggerList(e),r=0,n=i;r<n.length;r++){var s=n[r];if(s==="Custom")return;s==="Focus"&&this.unwireFocusEvents(),s==="Click"&&a.bi.remove(this.element,a.AR.touchStartEvent,this.targetClick),s==="Hover"&&(a.AR.isDevice?(this.touchModule&&this.touchModule.destroy(),a.bi.remove(this.element,a.AR.touchEndEvent,this.touchEndHandler)):a.bi.remove(this.element,"mouseover",this.targetHover))}a.bi.remove(document,"touchend",this.touchEnd),a.bi.remove(document,"scroll wheel",this.scrollHandler),a.bi.remove(window,"resize",this.windowResize),a.bi.remove(document,"keydown",this.keyDown)},t.prototype.unwireFocusEvents=function(){if((0,a.le)(this.target))a.bi.remove(this.element,"focus",this.targetHover);else for(var e=[].slice.call((0,a.td)(this.target,this.element)),i=0,r=e;i<r.length;i++){var n=r[i];a.bi.remove(n,"focus",this.targetHover)}},t.prototype.unwireMouseEvents=function(e){if(!this.isSticky){for(var i=this.getTriggerList(this.opensOn),r=0,n=i;r<n.length;r++){var s=n[r];s==="Focus"&&a.bi.remove(e,"blur",this.onMouseOut),s==="Hover"&&!a.AR.isDevice&&a.bi.remove(e,"mouseleave",this.onMouseOut)}this.closeDelay&&(a.bi.remove(e,"mouseenter",this.tooltipHover),a.bi.remove(e,"mouseleave",this.tooltipMouseOut))}this.mouseTrail&&a.bi.remove(e,"mousemove touchstart mouseenter",this.onMouseMove)},t.prototype.findTarget=function(){var e=(0,a.Ys)('[data-tooltip-id= "'+this.ctrlId+'_content"]',document);return e},t.prototype.getModuleName=function(){return"tooltip"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.onPropertyChanged=function(e,i){for(var r=this.findTarget(),n=0,s=Object.keys(e);n<s.length;n++){var l=s[n];switch(l){case"width":this.tooltipEle&&r&&(this.tooltipEle.style.width=this.tooltipEle.style.maxWidth=(0,a.Ac)(e.width),this.reposition(r));break;case"height":this.tooltipEle&&r&&(this.tooltipEle.style.height=(0,a.Ac)(e.height),this.reposition(r));break;case"content":this.tooltipEle&&this.renderContent();break;case"opensOn":this.unwireEvents(i.opensOn),this.wireEvents(e.opensOn);break;case"position":if(this.formatPosition(),this.tooltipEle&&r){var h=(0,a.Ys)("."+Ba,this.tooltipEle);h.style.top=h.style.left=null,this.reposition(r)}break;case"tipPointerPosition":this.tooltipEle&&r&&this.reposition(r);break;case"offsetX":if(this.tooltipEle){var c=e.offsetX-i.offsetX;this.tooltipEle.style.left=(parseInt(this.tooltipEle.style.left,10)+c).toString()+"px"}break;case"offsetY":if(this.tooltipEle){var u=e.offsetY-i.offsetY;this.tooltipEle.style.top=(parseInt(this.tooltipEle.style.top,10)+u).toString()+"px"}break;case"cssClass":this.tooltipEle&&(i.cssClass&&(0,a.IV)([this.tooltipEle],i.cssClass.split(" ")),e.cssClass&&(0,a.cn)([this.tooltipEle],e.cssClass.split(" ")));break;case"enableRtl":this.tooltipEle&&(this.enableRtl?(0,a.cn)([this.tooltipEle],zl):(0,a.IV)([this.tooltipEle],zl));break;case"container":(0,a.le)(this.containerElement)||(0,a.IV)([this.containerElement],nf),this.container=e.container,this.tooltipEle&&r&&(this.appendContainer(this),this.reposition(r))}}},t.prototype.open=function(e,i){(0,a.le)(i)&&(i=this.animation.open),(0,a.le)(e)&&(e=this.element),e.style.display!=="none"&&this.showTooltip(e,i)},t.prototype.close=function(e){e||(e=this.animation.close),this.hideTooltip(e)},t.prototype.refresh=function(e){this.tooltipEle&&this.renderContent(e),this.popupObj&&e&&this.reposition(e)},t.prototype.destroy=function(){o.prototype.destroy.call(this),this.tooltipEle&&(0,a.Od)(this.tooltipEle),this.popupObj&&this.popupObj.destroy(),(0,a.IV)([this.element],Eo),this.unwireEvents(this.opensOn),this.unwireMouseEvents(this.element),this.tooltipEle=null,this.popupObj=null},ai([(0,a.Z9)("auto")],t.prototype,"width",void 0),ai([(0,a.Z9)("auto")],t.prototype,"height",void 0),ai([(0,a.Z9)()],t.prototype,"content",void 0),ai([(0,a.Z9)("body")],t.prototype,"container",void 0),ai([(0,a.Z9)()],t.prototype,"target",void 0),ai([(0,a.Z9)("TopCenter")],t.prototype,"position",void 0),ai([(0,a.Z9)(0)],t.prototype,"offsetX",void 0),ai([(0,a.Z9)(0)],t.prototype,"offsetY",void 0),ai([(0,a.Z9)(!0)],t.prototype,"showTipPointer",void 0),ai([(0,a.Z9)(!0)],t.prototype,"enableHtmlParse",void 0),ai([(0,a.Z9)(!1)],t.prototype,"windowCollision",void 0),ai([(0,a.Z9)("Auto")],t.prototype,"tipPointerPosition",void 0),ai([(0,a.Z9)("Auto")],t.prototype,"opensOn",void 0),ai([(0,a.Z9)(!1)],t.prototype,"mouseTrail",void 0),ai([(0,a.Z9)(!1)],t.prototype,"isSticky",void 0),ai([(0,a.Zz)({},$0)],t.prototype,"animation",void 0),ai([(0,a.Z9)(0)],t.prototype,"openDelay",void 0),ai([(0,a.Z9)(0)],t.prototype,"closeDelay",void 0),ai([(0,a.Z9)()],t.prototype,"cssClass",void 0),ai([(0,a.Z9)(!1)],t.prototype,"enableHtmlSanitizer",void 0),ai([(0,a.ju)()],t.prototype,"beforeRender",void 0),ai([(0,a.ju)()],t.prototype,"beforeOpen",void 0),ai([(0,a.ju)()],t.prototype,"afterOpen",void 0),ai([(0,a.ju)()],t.prototype,"beforeClose",void 0),ai([(0,a.ju)()],t.prototype,"afterClose",void 0),ai([(0,a.ju)()],t.prototype,"beforeCollision",void 0),ai([(0,a.ju)()],t.prototype,"created",void 0),ai([(0,a.ju)()],t.prototype,"destroyed",void 0),t=ai([a.Zl],t),t}(a.wA),Qc=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(E.eT,this.wireEvents,this),this.parent.on(E.P_,this.autoFit,this),this.parent.on(E.SC,this.setAutoFitHandler,this)},o.prototype.autoFit=function(t){for(var e=t.isRow?this.parent.getRowHeaderTable():this.parent.getColHeaderTable().rows[0],i=t.startIndex;i<=t.endIndex;i++)this.trgtEle=t.isRow?this.parent.getRow(i,e):this.parent.getCell(null,i,e),this.setAutofit(i,!t.isRow)},o.prototype.wireEvents=function(){var t=this.parent.getRowHeaderContent(),e=this.parent.element.getElementsByClassName("e-header-panel")[0];!e||(a.bi.add(e,"dblclick",this.dblClickHandler,this),a.bi.add(t,"dblclick",this.dblClickHandler,this),a.bi.add(e,"mousedown",this.mouseDownHandler,this),a.bi.add(t,"mousedown",this.mouseDownHandler,this),this.wireResizeCursorEvent(t,e))},o.prototype.wireResizeCursorEvent=function(t,e){a.bi.add(t,"mousemove",this.setTarget,this),a.bi.add(e,"mousemove",this.setTarget,this)},o.prototype.unWireResizeCursorEvent=function(){a.bi.remove(this.parent.getRowHeaderContent(),"mousemove",this.setTarget);var t=this.parent.element.getElementsByClassName("e-header-panel")[0];t&&a.bi.remove(t,"mousemove",this.setTarget)},o.prototype.unwireEvents=function(){a.bi.remove(this.parent.getColumnHeaderContent(),"dblclick",this.dblClickHandler),a.bi.remove(this.parent.getRowHeaderContent(),"dblclick",this.dblClickHandler),a.bi.remove(this.parent.getColumnHeaderContent(),"mousedown",this.mouseDownHandler),a.bi.remove(this.parent.getRowHeaderContent(),"mousedown",this.mouseDownHandler),this.unWireResizeCursorEvent()},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.eT,this.wireEvents),this.parent.off(E.P_,this.autoFit),this.parent.off(E.SC,this.setAutoFitHandler))},o.prototype.mouseMoveHandler=function(t){var e=this.parent.element.getElementsByClassName("e-colresize-handler")[0],i=this.parent.element.getElementsByClassName("e-rowresize-handler")[0];this.resizeTooltip(null,!0,t),(e||i)&&(this.isMouseMoved=!0,e?t.x>this.trgtEle.parentElement.firstChild.getBoundingClientRect().left&&(e.style.left=t.clientX-document.getElementById(this.parent.element.id+"_sheet").getBoundingClientRect().left+"px"):i&&t.y>=this.trgtEle.parentElement.parentElement.firstChild.getBoundingClientRect().top&&(i.style.top=t.clientY-document.getElementById(this.parent.element.id+"_sheet").getBoundingClientRect().top+"px"))},o.prototype.mouseDownHandler=function(t){if(!!(0,a.oq)(t.target,".e-header-cell")){if(this.event=t,this.trgtEle=t.target,this.trgtEle.parentElement.classList.contains("e-hide-end")||this.trgtEle.classList.contains("e-hide-end")){var e=this.trgtEle.offsetHeight,i=t.offsetY;(e>=10&&i<5||e-2<8&&i<Math.ceil((i-2)/2))&&this.trgtEle.classList.add("e-skip-resize")}this.updateTarget(t,this.trgtEle);var r=this.trgtEle,n=r.classList.contains("e-colresize")?"e-colresize-handler":r.classList.contains("e-rowresize")?"e-rowresize-handler":"";this.createResizeHandler(r,n),this.unWireResizeCursorEvent(),a.bi.add(this.parent.element,"mousemove",this.mouseMoveHandler,this),a.bi.add(document,"mouseup",this.mouseUpHandler,this)}},o.prototype.mouseUpHandler=function(t){var e=this.parent.element.getElementsByClassName("e-resize-handle")[0];this.resizeOn(t),this.isMouseMoved=null;var i=document.querySelector(".e-header-tooltip");e&&((0,a.og)(e),this.updateCursor()),i&&i.remove(),a.bi.remove(document,"mouseup",this.mouseUpHandler),a.bi.remove(this.parent.element,"mousemove",this.mouseMoveHandler);var r=this.parent.element.getElementsByClassName("e-header-panel")[0];r&&this.wireResizeCursorEvent(this.parent.getRowHeaderContent(),r),this.parent.notify(E.uv,null),this.parent.notify(E.LC,null)},o.prototype.dblClickHandler=function(t){if(!!(0,a.oq)(t.target,".e-header-cell")){if(this.trgtEle=t.target,this.updateTarget(t,this.trgtEle),this.trgtEle.classList.contains("e-colresize")){var e=parseInt(this.trgtEle.getAttribute("aria-colindex"),10)-1,i=(0,He.IQ)(this.parent.getActiveSheet(),e)+"px";this.trgtEle.classList.contains("e-unhide-column")?this.showHiddenColumns(e-1):this.setAutofit(e,!0,i)}else if(this.trgtEle.classList.contains("e-rowresize")){var r=parseInt(this.trgtEle.parentElement.getAttribute("aria-rowindex"),10)-1,n=(0,He.NE)(this.parent.getActiveSheet(),r)+"px";this.setAutofit(r,!1,n)}this.parent.notify(E.uv,null)}},o.prototype.setTarget=function(t){if(!!(0,a.oq)(t.target,".e-header-cell")){var e=t.target,i=this.parent.getActiveSheet();if(!(i.isProtected&&(!i.protectSettings.formatColumns||!i.protectSettings.formatRows)&&(!i.protectSettings.formatRows&&!i.protectSettings.formatColumns||i.protectSettings.formatRows&&(0,a.oq)(e,".e-colhdr-table")||i.protectSettings.formatColumns&&(0,a.oq)(e,".e-rowhdr-table")))){var r,n,s,l;if((0,a.oq)(e,".e-header-row")){s=t.offsetX,n=e.offsetWidth,l="e-colresize";var h=this.getColPrevSibling(e);h&&!h.classList.contains("e-select-all-cell")?r=h:Number(e.getAttribute("aria-colindex"))>1&&(r=e)}else if((0,a.oq)(e,".e-row")){s=t.offsetY,n=e.offsetHeight,l="e-rowresize";var h=this.getRowPrevSibling(e);h?r=h.firstElementChild:Number(e.parentElement.getAttribute("aria-rowindex"))>1&&(r=e)}if(n-2<8&&s!==Math.ceil((n-2)/2))s<Math.ceil((n-2)/2)?(e.classList.add(l),r.classList.add(l)):s>Math.ceil((n-2)/2)&&e.classList.add(l);else if(n-5<s&&s<=n&&n>=10)e.classList.add(l);else if(s<5&&r&&n>=10)e.classList.add(l),r.classList.add(l);else for(var c=this.parent.element.getElementsByClassName(l),u=0;u<c.length;u++)c[u].classList.remove(l)}}},o.prototype.getColPrevSibling=function(t){var e=this.parent.frozenColCount(this.parent.getActiveSheet());return t.previousElementSibling||(e&&(0,a.oq)(t,".e-column-header")?this.parent.getSelectAllContent().querySelector(".e-header-row").lastElementChild:null)},o.prototype.getRowPrevSibling=function(t){var e=this.parent.frozenRowCount(this.parent.getActiveSheet());return t.parentElement.previousElementSibling||(e&&(0,a.oq)(t,".e-row-header")?this.parent.getSelectAllContent().querySelector("tbody").lastElementChild:null)},o.prototype.updateTarget=function(t,e){if((0,a.oq)(e,".e-header-row")){if(e.offsetWidth<10&&t.offsetX<Math.ceil((e.offsetWidth-2)/2)||t.offsetX<5&&e.offsetWidth>=10&&e.classList.contains("e-colresize")){var i=this.parent.getActiveSheet(),r=Number(this.trgtEle.getAttribute("aria-colindex"))-2,n=this.getColPrevSibling(e);n&&!(0,He.Nq)(i,r)?this.trgtEle=n:r>-1&&this.trgtEle.classList.add("e-unhide-column")}}else if(e.offsetHeight<10&&t.offsetY<Math.ceil((e.offsetHeight-2)/2)||t.offsetY<5&&e.offsetHeight>=10&&e.classList.contains("e-rowresize")){var i=this.parent.getActiveSheet(),r=Number(e.parentElement.getAttribute("aria-rowindex"))-2,n=this.getRowPrevSibling(e);if(n||(0,He.gS)(i,r))if(t.type==="dblclick"&&(0,He.gS)(i,r)){var s=(0,pe.gaE)((0,pe.dK5)(i.selectedRange)),l=void 0;r<=s[2]&&r>s[0]?l={startIndex:s[0],endIndex:s[2],hide:!1,autoFit:!0}:l={startIndex:r,endIndex:r,hide:!1,autoFit:!0},this.parent.notify(ot.wt,l)}else(0,He.gS)(i,r)||(this.trgtEle=n.getElementsByClassName("e-header-cell")[0])}},o.prototype.setAutoFitHandler=function(t){t.isCol&&(0,He.Nq)(this.parent.getActiveSheet(),t.idx)?this.showHiddenColumns(t.idx):this.setAutofit(t.idx,t.isCol)},o.prototype.setAutofit=function(t,e,i){var r=0,n=this.parent.getActiveSheet(),s=this.parent.getMainContent(),l=e?(0,He.IQ)(this.parent.getActiveSheet(),t)+"px":(0,He.NE)(this.parent.getActiveSheet(),t)+"px",h=[],c=0,u=s.getElementsByClassName("e-content-table")[0],p=!1,f=0;if(e){for(var g=n.rows.length,C=0;C<g;C++)if(n.rows[C]&&n.rows[C].cells&&n.rows[C].cells[t]){(0,He.$S)(C,t,n).wrap&&(p=!0,f++);var L=this.parent.createElement("td",{className:"e-cell"});if(L.textContent=this.parent.getDisplayText(n.rows[C].cells[t]),n.rows[C].cells[t].style){var D=n.rows[C].cells[t].style;D.fontFamily&&(L.style.fontFamily=D.fontFamily),D.fontSize&&(L.style.fontSize=D.fontSize)}h[r]=L,r++}}else for(var R=n.rows[t]&&n.rows[t].cells?n.rows[t].cells.length:0,B=0;B<R;B++)if(n.rows[t]&&n.rows[t].cells[B]){(0,He.$S)(t,B,n).wrap&&(p=!0,f++);var L=this.parent.createElement("td");if(L.textContent=this.parent.getDisplayText(n.rows[t].cells[B]),n.rows[t].cells[B].style){var D=n.rows[t].cells[B].style;D.fontFamily&&(L.style.fontFamily=D.fontFamily),D.fontSize&&(L.style.fontSize=D.fontSize)}h[r]=L,r++}if(f===0){var H=ze(u,h,e,this.parent,i,p);e&&(H=this.getFloatingElementWidth(H,t));var j=H===0?parseInt(l,10):H,W=parseInt(l,10)>j?-(parseInt(l,10)-j):j-parseInt(l,10);if(e)if(t>=this.parent.viewport.leftIndex&&t<=this.parent.viewport.rightIndex)(0,He.wD)(n,t).width=j>0?j:0,this.resizeStart(t,this.parent.getViewportIndex(t,!0),j+"px",e,!0,i),this.parent.notify(E.N2,{threshold:W,colIdx:t});else{var ne=(0,He.IQ)(n,t),ie;j>0?ie=-(ne-j):ie=-ne,this.parent.notify(E.N2,{threshold:ie,colIdx:t}),(0,He.wD)(n,t).width=j>0?j:0}else if(!e)if(t>=this.parent.viewport.topIndex&&t<=this.parent.viewport.bottomIndex)j=j>20?j:20,c=(0,He.NE)(n,t),j>0?W=-(c-j):W=-c,(0,He.vm)(n,t,j>0?j:0),(0,He.ZG)(n,t,{customHeight:!1}),this.resizeStart(t,this.parent.getViewportIndex(t),j+"px",e,!0,i),this.parent.notify(E.QK,{threshold:W,rowIdx:t});else{c=(0,He.NE)(n,t);var me;j>0?me=-(c-j):me=-c,this.parent.notify(E.QK,{threshold:me,rowIdx:t}),(0,He.vm)(n,t,j>0?j:0)}}this.parent.selectRange(this.parent.getActiveSheet().selectedRange)},o.prototype.createResizeHandler=function(t,e){var i=this.parent.createElement("div",{className:e});i.classList.add("e-resize-handle");var r=document.getElementById(this.parent.element.id+"_sheet");t.classList.contains("e-colresize")?(i.style.height=this.parent.getMainContent().parentElement.clientHeight+this.parent.getColumnHeaderContent().offsetHeight+"px",i.style.left=this.event.clientX-r.getBoundingClientRect().left+"px",i.style.top="0px"):t.classList.contains("e-rowresize")&&(i.style.width=this.parent.getMainContent().parentElement.clientWidth+"px",i.style.left="0px",i.style.top=this.event.clientY-r.getBoundingClientRect().top+"px"),r.appendChild(i),this.resizeTooltip(t,!1),this.updateCursor()},o.prototype.resizeTooltip=function(t,e,i){if(e){var r=document.querySelector(".e-header-tooltip"),n=this.parent.element.getElementsByClassName("e-colresize-handler")[0],s=this.parent.element.getElementsByClassName("e-rowresize-handler")[0];if(n){var l=i.clientX-Math.round(this.trgtEle.getBoundingClientRect().left);r&&(r.firstChild.textContent=l>0?"Width:("+l.toString()+" pixels)":"Width: 0.00")}else if(s){var h=i.clientY-Math.round(this.trgtEle.getBoundingClientRect().top);r&&(r.firstChild.textContent=h>0?"Height:("+h.toString()+" pixels)":"Height: 0.00")}}else{var c=t.classList.contains("e-colresize"),u=t.classList.contains("e-rowresize");if(c||u){var p=c?"e-colresize-handler":"e-rowresize-handler",f=new Lo({cssClass:"e-header-tooltip",showTipPointer:!1});c?f.content="Width:("+Math.round(t.getBoundingClientRect().width).toString()+" pixels)":u&&(f.content="Height:("+Math.round(t.getBoundingClientRect().height).toString()+" pixels)",f.offsetX=-(this.parent.getMainContent().parentElement.clientWidth/2-Math.round(t.getBoundingClientRect().width))),f.appendTo("."+p),f.open(),f.refresh()}}},o.prototype.setColWidth=function(t,e,i,r){var n=this.parent.getActiveSheet(),s=G(i)-r;if(s<0&&r<-s&&(s=-r),i>0){if(this.isMouseMoved&&this.trgtEle.classList.contains("e-unhide-column")){this.showHiddenColumns(t,i),this.parent.notify(E.Av,{eventArgs:{index:t,width:0+"px",isCol:!0,sheetIndex:this.parent.activeSheetIndex,oldWidth:r+"px",hide:!1},action:"resize"});return}this.resizeStart(t,e,i+"px",!0,!1,r+"px"),(0,He.XV)(n,t,{width:i,customWidth:!0}),this.parent.notify(E.N2,{threshold:s,colIdx:t,checkWrapCell:!0})}else this.isMouseMoved&&(this.parent.hideColumn(t),this.showHideCopyIndicator(),this.parent.notify(E.Av,{eventArgs:{index:t,width:0+"px",isCol:!0,sheetIndex:this.parent.activeSheetIndex,oldWidth:r+"px",hide:!0},action:"resize"}))},o.prototype.showHideCopyIndicator=function(){var t=this.parent.element.getElementsByClassName("e-copy-indicator")[0],e=!1;t&&((0,a.og)(t),this.parent.notify(E.Qu,null),e=!0),e&&this.parent.notify(E.eT,{})},o.prototype.showHiddenColumns=function(t,e){var i=this,r=this.parent.getActiveSheet(),n=(0,pe.dK5)(r.selectedRange),s,l,h;if(t>=n[1]&&t<=n[3]&&n[2]===r.rowCount-1&&(0,pe.n53)(r.activeCell)[0]===(0,pe.n53)(r.topLeftCell)[0]?(s=n[1],l=n[3],h=this.parent.getMainContent().querySelector("colgroup")):s=l=t,e!==void 0)for(var c=s;c<=l;c++)(0,He.XV)(r,c,{width:e,customWidth:!0}),c>=this.parent.viewport.leftIndex&&c<=this.parent.viewport.rightIndex&&!(0,He.Nq)(r,c)&&(h.children[this.parent.getViewportIndex(c,!0)].style.width=e+"px");this.trgtEle&&this.trgtEle.classList.remove("e-unhide-column");var u={startIndex:s,endIndex:l,hide:!1,isCol:!0,autoFit:!0};if(this.parent.notify(ot.wt,u),this.showHideCopyIndicator(),e===void 0)if(u.autoFit)this.autoFit({isRow:!1,startIndex:s,endIndex:l});else{var p=function(){i.parent.off(E.eT,p),i.autoFit({isRow:!1,startIndex:s,endIndex:l})};this.parent.on(E.eT,p,this)}},o.prototype.setRowHeight=function(t,e,i,r){var n=this.parent.getActiveSheet(),s=this.parent.frozenColCount(n),l=parseInt(this.parent.getRow(t,null,s).style.height,10),h=i,c=G(parseInt(h,10))-l;c<0&&l<-c&&(c=-l),this.resizeStart(t,e,h,!1,!1,r),(0,He.ZG)(n,t,{height:parseInt(h,10)>0?parseInt(h,10):0,customHeight:!0}),this.parent.notify(E.QK,{threshold:c,rowIdx:t,isCustomHgt:!0})},o.prototype.resizeOn=function(t){var e=this,i,r,n=this.parent.getActiveSheet(),s=(0,pe.dK5)(n.activeCell),l=(0,He.$S)(s[0],s[1],n);if(this.trgtEle.classList.contains("e-rowresize")){var h=Number(this.trgtEle.parentElement.getAttribute("aria-rowindex"))-2;if(this.isMouseMoved&&(0,He.gS)(n,h)&&this.trgtEle.classList.contains("e-skip-resize")&&t.clientY>this.trgtEle.getBoundingClientRect().top){this.trgtEle.classList.remove("e-skip-resize");var c={startIndex:h,endIndex:h,hide:!1,skipAppend:!0};this.parent.notify(ot.wt,c);var u=this.parent.getRowHeaderTable().tBodies[0],p=this.parent.getContentTable().tBodies[0];c.hdrRow.style.display="none",c.row.style.display="none",u.insertBefore(c.hdrRow,u.children[c.insertIdx]),p.insertBefore(c.row,p.children[c.insertIdx]),this.trgtEle=c.hdrRow.firstElementChild,c.hdrRow.nextElementSibling.classList.remove("e-hide-end"),c.mergeCollection.forEach(function(W){e.parent.notify(pe.mtj,W)})}else if(this.trgtEle.classList.contains("e-skip-resize")){if(this.trgtEle.classList.remove("e-skip-resize"),!this.isMouseMoved&&(0,He.gS)(n,h)||!this.trgtEle.parentElement.previousElementSibling)return;this.trgtEle=this.trgtEle.parentElement.previousElementSibling.getElementsByClassName("e-header-cell")[0]}r=i=parseInt(this.trgtEle.parentElement.getAttribute("aria-rowindex"),10)-1,i=this.parent.getViewportIndex(r);var f=this.parent.frozenColCount(n),g=this.parent.getRow(r,null,f).style.height,C=t.clientY-this.event.clientY+parseInt(g,10);if(C<=0){this.parent.hideRow(r),this.showHideCopyIndicator(),(0,He.ZG)(n,r,{height:0,customHeight:!0}),this.parent.notify(E.Av,{eventArgs:{index:r,height:"0px",isCol:!1,sheetIndex:this.parent.activeSheetIndex,oldHeight:g},action:"resize"});return}if(this.setRowHeight(r,i,C+"px",g),l&&l.rowSpan){var L=this.parent.getCell(s[0],s[1]);this.parent.element.querySelector(".e-active-cell").style.height=L.offsetHeight+"px"}if(this.trgtEle.parentElement.style.display==="none"){var D=this.parent.getActiveSheet(),R=(0,pe.gaE)((0,pe.dK5)(D.selectedRange));if(r<=R[2]&&r>R[0]){C=(0,He.NE)(D,r);for(var B=void 0,H=R[0];H<=R[2];H++)H!==r&&(g=(0,He.NE)(D,H)+"px",(0,He.ZG)(D,H,{customHeight:!0,height:C}),(0,He.gS)(D,H)?B||(B=H):(this.parent.getRow(H).style.height=C+"px",D.showHeaders&&(this.parent.getRow(H,this.parent.getRowHeaderTable()).style.height=C+"px")),this.parent.notify(E.Av,{eventArgs:{index:H,height:C+"px",isCol:!1,sheetIndex:this.parent.activeSheetIndex,oldHeight:g},action:"resize"}));this.parent.hideRow(R[0],r-1,!1),this.showHideCopyIndicator(),i+=Math.abs(r-B)}else i!==0&&!(0,He.gS)(D,r-1)?this.trgtEle.parentElement.previousElementSibling.classList.remove("e-hide-start"):i!==0&&this.trgtEle.parentElement.classList.add("e-hide-end"),this.parent.selectRange(D.selectedRange);this.trgtEle.parentElement.style.display="",this.parent.getContentTable().rows[i].style.display=""}}else if(this.trgtEle.classList.contains("e-colresize")){this.isMouseMoved&&this.trgtEle.classList.contains("e-unhide-column")&&t.clientX<this.trgtEle.getBoundingClientRect().left&&(this.trgtEle.classList.remove("e-unhide-column"),this.trgtEle.previousElementSibling&&(this.trgtEle=this.trgtEle.previousElementSibling)),i=parseInt(this.trgtEle.getAttribute("aria-colindex"),10)-1;var j=void 0;if(this.trgtEle.classList.contains("e-unhide-column")?(i-=1,j=0):j=(0,He.IQ)(this.parent.getActiveSheet(),i),this.setColWidth(i,this.parent.getViewportIndex(i,!0),t.clientX-this.event.clientX+j,j),l&&l.colSpan){var L=this.parent.getCell(s[0],s[1]);this.parent.element.querySelector(".e-active-cell").style.width=L.offsetWidth+"px"}}l&&l.format&&l.format.indexOf("*")>-1&&this.parent.notify(ot.db,{cell:l,value:l.format[l.format.indexOf("*")+1].toString(),rowIdx:s[0],colIdx:s[1]})},o.prototype.resizeStart=function(t,e,i,r,n,s){ue(t,e,i,r,this.parent);var l=n?"resizeToFit":"resize",h,c;r?(h={index:t,width:i,isCol:r,sheetIndex:this.parent.activeSheetIndex,oldWidth:s},c=s!==i):(h={index:t,height:i,isCol:r,sheetIndex:this.parent.activeSheetIndex,oldHeight:s},c=s!==i),c&&this.parent.notify(E.Av,{eventArgs:h,action:l})},o.prototype.updateCursor=function(){this.parent.element.getElementsByClassName("e-colresize-handler")[0]?this.parent.element.classList.add("e-col-resizing"):this.parent.element.classList.contains("e-col-resizing")&&this.parent.element.classList.remove("e-col-resizing"),this.parent.element.getElementsByClassName("e-rowresize-handler")[0]?this.parent.element.classList.add("e-row-resizing"):this.parent.element.classList.contains("e-row-resizing")&&this.parent.element.classList.remove("e-row-resizing")},o.prototype.getFloatingElementWidth=function(t,e){var i=t,r={filterRange:[],hasFilter:!1};return this.parent.notify(E.CT,r),r.hasFilter&&r.filterRange&&r.filterRange[1]<=e&&r.filterRange[3]>=e&&(i=t+22),i},o.prototype.destroy=function(){this.unwireEvents(),this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"resize"},o}(),sf=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.refreshClients=function(t){We(t,this.parent)},o.prototype.addEventListener=function(){this.parent.on(E.TI,this.refreshClients,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(E.TI,this.refreshClients)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"collaborativeEditing"},o}(),Q0=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.hideShow=function(t){var e=this,i=(0,a.o8)(t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex,r=(0,w.zfV)(this.parent,i);if(t.startIndex>t.endIndex){var n=t.startIndex;t.startIndex=t.endIndex,t.endIndex=n}var s;if(t.actionUpdate){if(t.sheetIndex=i,s={eventArgs:t,action:"hideShow"},this.parent.notify(w.ya2,s),t.cancel)return;delete t.cancel}var l=function(p){t.isCol?(e.hideCol(t),p&&e.parent.sheetModule.colWidthChanged({colIdx:t.startIndex,isHideShow:!0})):(e.hideRow(t),p&&e.parent.sheetModule.rowHeightChanged({rowIdx:t.startIndex,isHideShow:!0}))},h=t.isCol?this.parent.frozenColCount(r):this.parent.frozenRowCount(r);if(h&&t.startIndex<h){var c=void 0;if(t.freezePane=!0,t.endIndex>=h&&(c=t.endIndex,t.endIndex=h-1),l(!0),delete t.freezePane,c!==void 0){var u=t.startIndex;t.endIndex=c,t.startIndex=h,l(),t.startIndex=u}}else l();t.actionUpdate&&this.parent.notify(E.Av,s)},o.prototype.hideRow=function(t){var e=this,i=(0,a.o8)(t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex,r=(0,w.zfV)(this.parent,i),n,s=0,l,h,c,u,p=Object.assign({},t),f=this.parent.scrollSettings.isFinite&&!p.freezePane,g;if(f){if(p.startIndex>=r.rowCount)return;p.endIndex>=r.rowCount&&(p.endIndex=r.rowCount-1),g=0}var C=this.parent.frozenRowCount(r);if(p.hide){for(var L=void 0,D,R=void 0,B=f&&p.endIndex===(0,w.Sxm)(r,r.rowCount-1,!1),H=p.startIndex;H<=p.endIndex;H++)if(!(0,w.gSQ)(r,H)&&(l===void 0&&(p.freezePane?(D=this.parent.sheetModule.getSelectAllTable(),L=this.parent.getColHeaderTable()):(D=this.parent.getRowHeaderTable(),L=this.parent.getContentTable()),l=this.parent.getViewportIndex(H),s=0),u={hidden:!0},p.isFiltering&&(u.isFiltered=!0),(0,w.ZG6)(r,H,u),i===this.parent.activeSheetIndex))if(f&&(g+=(0,w.NEZ)(r,H,!0,!0)),this.refreshChart(H,"rows"),R=L&&L.rows[l],R){if(!c){for(var j=0;j<=r.usedRange.colIndex;j++)if(n=(0,w.$Su)(H,j,r)||{},(n.colSpan||n.rowSpan)&&(p.startIndex>=this.parent.viewport.topIndex||this.parent.scrollSettings.enableVirtualization)){c=!0;break}}if(c)continue;if(D.rows[l]&&(0,a.og)(D.rows[l]),(0,a.og)(R),s++,R=L.rows[l],R&&H===p.endIndex){var W=void 0;h=(0,w.Sxm)(r,H+1,!0);for(var ne=h!==(0,w.Sxm)(r,0,!0)&&h===(this.parent.viewport.topIndex>=p.startIndex?p.endIndex+1:this.parent.viewport.topIndex)?"Row":"",j=this.parent.viewport.leftIndex;j<=this.parent.viewport.rightIndex;j++){var ie=this.parent.getCellStyleValue(["borderTop"],[h,j]).borderTop;ie!==""&&(W=R.cells[j],this.parent.notify(w.nJk,{onActionUpdate:!1,rowIdx:h,colIdx:j,style:{borderTop:ie},row:R,pRow:R.previousElementSibling,first:ne,cell:W}))}}}else H<=this.parent.viewport.bottomIndex?s++:s--;if(c&&(p.startIndex>=this.parent.viewport.topIndex||!this.parent.scrollSettings.enableVirtualization)){p.isFiltering?t.refreshUI=!0:(this.parent.selectRange(r.selectedRange),r.frozenRows||r.frozenColumns?this.parent.renderModule.refreshSheet(!1,!1,!0):this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,colIndex:this.parent.viewport.leftIndex,refresh:"Row"}));return}if(!s)return;this.parent.selectRange(r.selectedRange);var me=function(){if(r.showHeaders){var Qe=p.freezePane?1:0;l===Qe?D.rows[Qe]&&D.rows[Qe].classList.add("e-hide-end"):(D&&D.rows[l-1]&&D.rows[l-1].classList.add("e-hide-start"),D&&D.rows[l]&&D.rows[l].classList.add("e-hide-end"))}};if(!p.freezePane&&this.parent.scrollSettings.enableVirtualization){var ve=p.startIndex,Ee=p.startIndex;if(p.startIndex<(0,w.n53)(r.paneTopLeftCell)[0]||s>this.parent.viewport.rowCount){if(p.isFiltering){t.refreshUI=!0;return}this.parent.updateTopLeftCell((0,w.Sxm)(r,p.startIndex-1<C?C:p.startIndex-1,!0)-C,null,"col"),this.parent.renderModule.refreshSheet(!1,!1,!0)}else{ve=this.parent.viewport.bottomIndex+1,Ee=ve+s-1;var le=this.parent.skipHidden(ve,Ee,"rows",!1);if(ve=le[0],Ee=le[1],f)if(ve>=r.rowCount){this.parent.viewport.topIndex+C===(0,w.Sxm)(r,C,!0)?(me(),this.parent.notify(E.$7,{isHide:!0,height:g}),B&&(this.parent.viewport.bottomIndex=(0,w.Sxm)(r,r.rowCount-1,!1))):this.parent.renderModule.refreshSheet(!1,!1,!0);return}else if(Ee>=r.rowCount){this.parent.renderModule.refreshSheet(!1,!1,!0);return}else this.parent.notify(E.$7,{isHide:!0,height:g});this.parent.viewport.bottomIndex=Ee;var de=void 0,fe=this.parent.frozenColCount(r),Le=[];fe?(Le.push(C),Le.push(this.parent.viewport.leftIndex+fe),de=(0,w.n53)(r.topLeftCell)[1]):de=this.parent.viewport.leftIndex,this.parent.renderModule.refreshUI({colIndex:de,rowIndex:ve,direction:"",refresh:"RowPart",frozenIndexes:Le},(0,w.qkm)(ve,de)+":"+(0,w.qkm)(Ee,this.parent.viewport.rightIndex))}}me()}else{var ke=void 0,Me=void 0,De=void 0,R=void 0,Fe=void 0,Pe=void 0,L=void 0,Ye=void 0,Ze=void 0,nt=p.startIndex-1,it=[],et=p.freezePane,at="lastElementChild",Ge=0;if(f){var gt=(0,w.Sxm)(r,r.rowCount-1,!1);if(this.parent.viewport.bottomIndex===gt)if(this.parent.viewport.topIndex+C===(0,w.Sxm)(r,C,!0))et=!0;else{var ge=(0,w.dK5)(r.paneTopLeftCell)[0],xe=r.rowCount-1-ge+1-this.parent.hiddenCount(ge,r.rowCount-1);xe<this.parent.viewport.rowCount+Math.round(this.parent.getThreshold("row")/2)&&(at="firstElementChild")}}for(var H=p.startIndex,je=p.endIndex;H<=je;H++){if(!(0,w.gSQ)(r,H)){if(p.startIndex===p.endIndex)return;l===void 0?nt++:Fe=H;continue}if(Fe!==void 0){je=H;continue}if(u={hidden:!1},p.isFiltering&&(u.isFiltered=!1),!et&&H>this.parent.viewport.bottomIndex){if((0,w.ZG6)(r,H,u),Ze===void 0)return;continue}if(Ze===void 0&&(Ze=H),(0,w.ZG6)(r,H,u),i===this.parent.activeSheetIndex){f&&(g+=(0,w.NEZ)(r,H,!0,!0)),this.refreshChart(H,"rows"),l===void 0&&(ke=document.createDocumentFragment(),Me=document.createDocumentFragment(),Pe=this.parent.serviceLocator.getService("row"),p.freezePane?(Ye=this.parent.sheetModule.getSelectAllTable(),L=this.parent.getColHeaderTable()):(Ye=this.parent.getRowHeaderTable(),L=this.parent.getContentTable(),H<this.parent.viewport.topIndex+C&&(this.parent.viewport.topIndex=H-C)),l=this.parent.getViewportIndex(H)),nt++,De=Pe.refresh(H,null,null,!0,!0),ke.appendChild(De),Ye&&Ye.rows.length&&!et&&(0,a.og)(Ye.tBodies[0][at]),R=Me.appendChild(Pe.refresh(H,R,De)),L&&L.rows.length&&!et&&((0,a.og)(L.tBodies[0][at]),at==="firstElementChild"&&(l!==void 0&&l-1>-1&&(l-=1),Ge+=(0,w.NEZ)(r,this.parent.viewport.topIndex,!0),this.parent.viewport.topIndex=(0,w.Sxm)(r,this.parent.viewport.topIndex+1,!0)));for(var j=this.parent.viewport.leftIndex;j<=this.parent.viewport.rightIndex;j++)if(n=(0,w.$Su)(H,j,r)||{},n.rowSpan!==void 0){var Je={range:[H,j,H,j],isAction:!1,merge:!0,type:"All",skipChecking:!0};this.parent.notify(w.Zf5,Je),(!it.length||Je.range[1]!==it[it.length-1].range[1])&&it.push(Je)}}}if(l===void 0)return;if(!p.freezePane){if(p.isFiltering&&p.startIndex<(0,w.n53)(r.paneTopLeftCell)[0]&&(t.refreshUI=!0,Fe===void 0||Fe===p.endIndex))return;this.parent.viewport.bottomIndex=this.parent.viewport.topIndex+C+this.parent.viewport.rowCount+this.parent.getThreshold("row")*2,s=this.parent.hiddenCount(this.parent.viewport.topIndex+C,p.startIndex)+this.parent.hiddenCount(p.endIndex+1,this.parent.viewport.bottomIndex),this.parent.viewport.bottomIndex+=s,f&&this.parent.viewport.bottomIndex>=r.rowCount&&(this.parent.viewport.bottomIndex=(0,w.Sxm)(r,r.rowCount-1,!1))}if(p.insertIdx=t.insertIdx=l,p.row=t.row=Me.querySelector(".e-row"),p.mergeCollection=t.mergeCollection=it,r.showHeaders&&(t.hdrRow=p.hdrRow=ke.querySelector(".e-row"),l!==0&&!(0,w.gSQ)(r,nt-1)&&Ye.rows[l-1]&&Ye.rows[l-1].classList.remove("e-hide-start"),p.startIndex!==0&&(0,w.gSQ)(r,p.startIndex-1)&&p.hdrRow.classList.add("e-hide-end"),(0,w.gSQ)(r,nt+1)?ke.lastElementChild.classList.add("e-hide-start"):Ye.rows[l]&&Ye.rows[l].classList.remove("e-hide-end")),R&&L&&L.rows[l]){h=(0,w.Sxm)(r,nt+1,!0);for(var H=this.parent.viewport.leftIndex;H<=this.parent.viewport.rightIndex;H++){var ie=this.parent.getCellStyleValue(["borderTop"],[h,H]).borderTop;if(ie!==""){this.parent.notify(w.nJk,{onActionUpdate:!1,rowIdx:h,colIdx:H,style:{borderTop:ie},pRow:R,cell:L.rows[l].cells[H],first:""});var lt=(0,w.Sxm)(r,Ze-1,!1);lt>-1?L.rows[l-1]&&!this.parent.getCellStyleValue(["borderBottom"],[lt,H]).borderBottom&&!this.parent.getCellStyleValue(["borderTop"],[Ze,H]).borderTop&&(L.rows[l-1].cells[H].style.borderBottom=""):L.rows[l].cells[H].style.borderTop=""}}}if(p.skipAppend)return;f&&this.parent.notify(E.$7,{height:g,size:Ge}),Math.abs(nt-Ze)>this.parent.viewport.rowCount+this.parent.getThreshold("row")*2?this.parent.renderModule.refreshSheet(!1,!1,!0):(Ye&&(Ye.tBodies[0].rows.length?Ye.tBodies[0].insertBefore(ke,Ye.rows[l]):Ye.tBodies[0].appendChild(ke)),L&&L.tBodies[0]&&(L.tBodies[0].rows.length?L.tBodies[0].insertBefore(Me,L.rows[l]):L.tBodies[0].appendChild(Me)),this.parent.selectRange(r.selectedRange),p.autoFit&&r.showHeaders&&this.parent.notify(E.P_,{startIndex:p.startIndex,endIndex:p.endIndex,isRow:!0}),it.forEach(function(pi){e.parent.notify(w.mtj,pi)}),Fe!==void 0&&Fe!==p.endIndex&&(p.startIndex=Fe,this.hideRow(p)))}},o.prototype.hideCol=function(t){for(var e=this,i=(0,a.o8)(t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex,r=(0,w.zfV)(this.parent,i),n=[],s=[],l=(0,w.n53)(r.paneTopLeftCell),h=this.parent.frozenColCount(r),c=this.parent.frozenRowCount(r),u=this.parent.viewport.leftIndex+h,p,f=t.startIndex;f<=t.endIndex;f++)if(!(t.hide?(0,w.NqJ)(r,f):!(0,w.NqJ)(r,f))){if((0,w.XV5)(r,f,{hidden:t.hide}),this.refreshChart(f,"columns"),this.parent.scrollSettings.enableVirtualization&&!t.freezePane&&(f<u||f>this.parent.viewport.rightIndex)){f<u&&s.push(f);continue}n.push(f),t.hide&&f<=l[1]&&(p=!0)}if(!(!s.length&&!n.length)&&i===this.parent.activeSheetIndex){var g=(0,w.n53)(r.topLeftCell),C,L,D=function(){var Ee;return e.parent.scrollSettings.enableVirtualization?Ee=[c?g[0]:e.parent.viewport.topIndex,e.parent.viewport.bottomIndex]:Ee=[0,r.rowCount-1],t.freezePane?(C=e.parent.getRowHeaderTable(),L=e.parent.sheetModule.getSelectAllTable()):(C=e.parent.getContentTable(),L=e.parent.getColHeaderTable()),Ee};if(t.hide){if(!n.length)return;if((n.length<=this.parent.getThreshold("col")||!this.parent.scrollSettings.enableVirtualization||t.freezePane)&&this.removeCell(r,n,D(),C,L),!t.freezePane&&this.parent.scrollSettings.enableVirtualization){if(p){this.parent.updateTopLeftCell(null,(0,w.Sxm)(r,n[0]-1<h?h:n[0]-1,!0,"columns")-h,"row"),this.parent.renderModule.refreshSheet(!1,!1,!0);return}var R=[],B=this.parent.viewport.topIndex,H=c?g[0]:B;if(c&&(R=[c+B,h]),this.parent.scrollSettings.isFinite){var j=(0,w.Sxm)(r,r.colCount-1,!1,"columns"),W=this.parent.viewport.leftIndex+h,ne=this.parent.viewport.rightIndex;if(ne+n.length>=j){var ie=(0,w.Sxm)(r,W-(ne+n.length-j),!1,"columns");ie>=h&&(this.parent.viewport.leftIndex=ie,this.parent.viewport.leftIndex-=this.parent.hiddenCount(ne,j)),this.parent.viewport.rightIndex=j,W!==this.parent.viewport.leftIndex+h||ne!==this.parent.viewport.rightIndex?(this.parent.renderModule.refreshUI({colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:R,rowIndex:H,skipUpdateOnFirst:this.parent.viewport.leftIndex+h===(0,w.Sxm)(r,h,!0,"columns")}),c&&(this.parent.viewport.topIndex=B)):this.parent.notify(E.LX,{refresh:"Column",isUpdate:!0}),this.parent.selectRange(r.selectedRange);return}}if(n.length<=this.parent.getThreshold("col")){var me=this.parent.skipHidden(this.parent.viewport.rightIndex+1,this.parent.viewport.rightIndex+n.length,"columns");this.parent.viewport.rightIndex=me[1],this.parent.renderModule.refreshUI({rowIndex:H,colIndex:me[0],direction:"",refresh:"ColumnPart",frozenIndexes:R},""+(0,w.i0K)([H,me[0],this.parent.viewport.bottomIndex,me[1]]))}else this.parent.renderModule.refreshUI({skipUpdateOnFirst:this.parent.viewport.leftIndex+h===(0,w.Sxm)(r,h,!0,"columns"),rowIndex:H,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:R}),c&&(this.parent.viewport.topIndex=B)}this.parent.selectRange(r.selectedRange)}else{if(s.length&&this.parent.scrollSettings.enableVirtualization){s.sort(function(Ee,le){return Ee-le});var ve=s[0]-1<h?h:s[0]-1;this.parent.updateTopLeftCell(null,(0,w.Sxm)(r,ve,!0,"columns")-h,"row"),this.parent.renderModule.refreshSheet(!1,!1,!0),t.autoFit&&(t.autoFit=!1);return}if(n.length<=this.parent.getThreshold("col")||!this.parent.scrollSettings.enableVirtualization||t.freezePane)this.appendCell(r,n,D(),C,L,t.freezePane),this.parent.scrollSettings.enableVirtualization&&!t.freezePane&&this.parent.notify(E.e2,{refresh:"Column",prevRowColCnt:{rowCount:r.rowCount,colCount:r.colCount}});else{var B=this.parent.viewport.topIndex,H=c?g[0]:B;this.parent.renderModule.refreshUI({skipUpdateOnFirst:this.parent.viewport.leftIndex+h===(0,w.Sxm)(r,h,!0,"columns"),rowIndex:H,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:c?[c+B,h]:[]}),c&&(this.parent.viewport.topIndex=B),t.autoFit&&(t.autoFit=!1)}this.parent.selectRange(r.selectedRange)}}},o.prototype.removeCell=function(t,e,i,r,n){var s=this,l=i[0],h=i[1],c=0,u=e.length-1,p=this.parent.frozenRowCount(t),f=r.getElementsByTagName("colgroup")[0],g=this.parent.getViewportIndex(e[0],!0)+1,C=(0,w.Sxm)(t,p-1,!1),L,D,R,B,H;for(t.showHeaders&&(R=n.getElementsByTagName("colgroup")[0],L=n.rows[0]);l<=h;){if((0,w.gSQ)(t,l)){l++;continue}D=p&&l<p?n.rows[c+1]:r.rows[c],e.forEach(function(j,W){if(c===0&&l>=p&&(t.showHeaders&&((0,a.og)(R.children[g]),(0,a.og)(L.cells[g])),(0,a.og)(f.children[g])),(0,a.og)(D.cells[g]),W===0&&(B=(0,w.$Su)(l,j,t,!1,!0),B.colSpan!==void 0&&(B.rowSpan===void 0||B.colSpan>1)&&s.parent.notify(E.$o,{rowIdx:l,colIdx:j,model:"col",start:e[0],end:e[u]})),W===u){H=(0,w.Sxm)(t,j+1,!0,"columns");var ne=s.parent.getCellStyleValue(["borderLeft"],[c,H]).borderLeft;ne!==""&&s.parent.notify(w.nJk,{onActionUpdate:!1,rowIdx:c,colIdx:H,style:{borderLeft:ne},row:D,first:""}),B=(0,w.$Su)(l,j,t)||{},B.colSpan!==void 0&&(B.rowSpan===void 0||B.colSpan>1)&&s.parent.notify(E.$o,{rowIdx:l,colIdx:j,model:"col",start:e[0],end:e[u],isEnd:!0})}}),p&&l===C?(c=0,l=this.parent.viewport.topIndex+p):(c++,l++)}g-1>-1&&t.showHeaders&&L.cells[g-1]&&L.cells[g-1].classList.add("e-hide-start"),t.showHeaders&&L.cells[g]&&L.cells[g].classList.add("e-hide-end")},o.prototype.appendCell=function(t,e,i,r,n,s){var l=this,h=i[0],c=i[1],u=0,p=e.length-1,f,g,C,L,D=this.parent.frozenRowCount(t),R=r.getElementsByTagName("colgroup")[0];t.showHeaders&&(C=n.getElementsByTagName("colgroup")[0],f=n.rows[0]);var B=this.parent.serviceLocator.getService("cell");e.sort(function(Ee,le){return Ee-le});for(var H=[],j=[],W,ne,ie,me=(0,w.Sxm)(t,D-1,!1),ve;h<=c;){if((0,w.gSQ)(t,h)){h++;continue}g=D&&h<D?n.rows[u+1]:r.rows[u],e.forEach(function(Ee,le){if(u===0&&(j[le]=l.parent.getViewportIndex(Ee,!0),t.showHeaders&&(ne=f.cells[j[le]],ne&&(le===0&&e[le]&&!(0,w.NqJ)(t,e[le]-1)&&ne.previousSibling&&ne.previousElementSibling.classList.remove("e-hide-start"),le===p&&ne.classList.remove("e-hide-end"))),h>=D&&(R.children[j[le]]?(R.insertBefore(l.parent.sheetModule.updateCol(t,Ee),R.children[j[le]]),t.showHeaders&&B.renderColHeader(Ee,f,ne)):(R.appendChild(l.parent.sheetModule.updateCol(t,Ee)),t.showHeaders&&B.renderColHeader(Ee,f)),s||((0,a.og)(R.lastChild),t.showHeaders&&(0,a.og)(f.lastChild)),t.showHeaders&&le===p&&((0,a.og)(C),n.insertBefore(R.cloneNode(!0),n.tHead)))),s||(0,a.og)(g.lastChild),ne=g.cells[j[le]],ve={rowIdx:h,colIdx:Ee,cell:(0,w.$Su)(h,Ee,t),row:g,address:(0,w.qkm)(h,Ee),lastCell:Ee===p,isHeightCheckNeeded:!0,first:Ee!==(0,w.Sxm)(t,0,!0,"columns")&&Ee===l.parent.viewport.leftIndex?"Column":"",checkNextBorder:le===p?"Column":""},ne&&(ve.refChild=ne),W=B.render(ve),le===0&&W.previousSibling){var de=l.parent.getCellStyleValue(["borderLeft"],[u,(0,w.Sxm)(t,e[e.length-1]+1,!0,"columns")]).borderLeft;de!==""&&(L=(0,w.Sxm)(t,e[0]-1,!1,"columns"),L>-1&&!l.parent.getCellStyleValue(["borderRight"],[u,L]).borderRight&&!l.parent.getCellStyleValue(["borderLeft"],[u,e[0]]).borderLeft&&(W.previousSibling.style.borderRight=""))}if(ie=(0,w.$Su)(u,Ee,t)||{},ie.colSpan!==void 0&&(ie.rowSpan===void 0||ie.colSpan>1)){var fe={range:[u,Ee,u,Ee],isAction:!1,merge:!0,type:"All",skipChecking:!0};l.parent.notify(w.Zf5,fe),(!H.length||fe.range[1]!==H[H.length-1].range[1])&&H.push(fe)}}),D&&h===me?(h=this.parent.viewport.topIndex+D,u=0):(h++,u++)}H.forEach(function(Ee){l.parent.notify(w.mtj,Ee)}),this.parent.viewport.rightIndex=(0,w.Sxm)(t,this.parent.viewport.rightIndex-e.length,!1,"columns")},o.prototype.refreshChart=function(t,e){this.parent.notify(w.PpD,{rIdx:t,showHide:e})},o.prototype.addEventListener=function(){this.parent.on(w.wtl,this.hideShow,this),this.parent.on(E.xn,this.destroy,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.off(w.wtl,this.hideShow),this.parent.off(E.xn,this.destroy)},o}(),J0=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),af=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},ey="e-hscroll",Js="e-rtl",ms="e-overlay",ty="e-hscroll-bar",iy="e-hscroll-content",ko="e-nav-arrow",Io="e-nav-right-arrow",Zl="e-nav-left-arrow",ea="e-scroll-nav",Jc="e-scroll-right-nav",of="e-scroll-left-nav",lf="e-scroll-device",Yl="e-scroll-overlay",eu="e-scroll-right-overlay",tu="e-scroll-left-overlay",hf=40,iu=function(o){J0(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){this.browser=a.AR.info.name,this.browserCheck=this.browser==="mozilla",this.isDevice=a.AR.isDevice,this.customStep=!0;var e=this.element;this.ieCheck=this.browser==="edge"||this.browser==="msie",this.initialize(),e.id===""&&(e.id=(0,a.QI)("hscroll"),this.uniqueId=!0),e.style.display="block",this.enableRtl&&e.classList.add(Js)},t.prototype.render=function(){this.touchModule=new a.Xh(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),a.bi.add(this.scrollEle,"scroll",this.scrollHandler,this),this.isDevice?(this.element.classList.add(lf),this.createOverlay(this.element)):this.createNavIcon(this.element),this.setScrollState()},t.prototype.setScrollState=function(){(0,a.le)(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetWidth,this.customStep=!1):this.customStep=!0},t.prototype.initialize=function(){var e=this.createElement("div",{className:iy}),i=this.createElement("div",{className:ty});i.setAttribute("tabindex","-1");for(var r=this.element,n=[].slice.call(r.children),s=0,l=n;s<l.length;s++){var h=l[s];e.appendChild(h)}i.appendChild(e),r.appendChild(i),i.style.overflowX="hidden",this.scrollEle=i,this.scrollItems=e},t.prototype.getPersistData=function(){var e=["scrollStep"];return this.addOnPersist(e)},t.prototype.getModuleName=function(){return"hScroll"},t.prototype.destroy=function(){var e=this.element;e.style.display="",e.classList.remove(ey),e.classList.remove(lf);var i=(0,a.td)(".e-"+e.id+"_nav."+ea,e),r=(0,a.td)("."+Yl,e);[].slice.call(r).forEach(function(h){(0,a.og)(h)});for(var n=0,s=[].slice.call(this.scrollItems.children);n<s.length;n++){var l=s[n];e.appendChild(l)}this.uniqueId&&this.element.removeAttribute("id"),(0,a.og)(this.scrollEle),i.length>0&&((0,a.og)(i[0]),(0,a.le)(i[1])||(0,a.og)(i[1])),a.bi.remove(this.scrollEle,"scroll",this.scrollHandler),this.touchModule.destroy(),this.touchModule=null,o.prototype.destroy.call(this)},t.prototype.disable=function(e){var i=(0,a.td)(".e-scroll-nav:not(."+ms+")",this.element);e?this.element.classList.add(ms):this.element.classList.remove(ms),[].slice.call(i).forEach(function(r){r.setAttribute("tabindex",e?"-1":"0")})},t.prototype.createOverlay=function(e){var i=e.id.concat("_nav"),r=this.createElement("div",{className:Yl+" "+eu}),n="e-"+e.id.concat("_nav "+ea+" "+Jc),s=this.createElement("div",{id:i.concat("_right"),className:n}),l=this.createElement("div",{className:Io+" "+ko+" e-icons"});s.appendChild(l);var h=this.createElement("div",{className:Yl+" "+tu});this.ieCheck&&s.classList.add("e-ie-align"),e.appendChild(r),e.appendChild(s),e.insertBefore(h,e.firstChild),this.eventBinding([s])},t.prototype.createNavIcon=function(e){var i=e.id.concat("_nav"),r="e-"+e.id.concat("_nav "+ea+" "+Jc),n={role:"button",id:i.concat("_right"),"aria-label":"Scroll right"},s=this.createElement("div",{className:r,attrs:n});s.setAttribute("aria-disabled","false");var l=this.createElement("div",{className:Io+" "+ko+" e-icons"}),h="e-"+e.id.concat("_nav "+ea+" "+of),c={role:"button",id:i.concat("_left"),"aria-label":"Scroll left"},u=this.createElement("div",{className:h+" "+ms,attrs:c});u.setAttribute("aria-disabled","true");var p=this.createElement("div",{className:Zl+" "+ko+" e-icons"});u.appendChild(p),s.appendChild(l),e.appendChild(s),e.insertBefore(u,e.firstChild),this.ieCheck&&(s.classList.add("e-ie-align"),u.classList.add("e-ie-align")),this.eventBinding([s,u])},t.prototype.onKeyPress=function(e){var i=this;if(e.key==="Enter"){var r=function(){i.keyTimeout=!0,i.eleScrolling(10,e.target,!0)};this.keyTimer=window.setTimeout(function(){r()},100)}},t.prototype.onKeyUp=function(e){e.key==="Enter"&&(this.keyTimeout?this.keyTimeout=!1:e.target.click(),clearTimeout(this.keyTimer))},t.prototype.eventBinding=function(e){var i=this;[].slice.call(e).forEach(function(r){new a.Xh(r,{tapHold:i.tabHoldHandler.bind(i),tapHoldThreshold:500}),r.addEventListener("keydown",i.onKeyPress.bind(i)),r.addEventListener("keyup",i.onKeyUp.bind(i)),r.addEventListener("mouseup",i.repeatScroll.bind(i)),r.addEventListener("touchend",i.repeatScroll.bind(i)),r.addEventListener("contextmenu",function(n){n.preventDefault()}),a.bi.add(r,"click",i.clickEventHandler,i)})},t.prototype.repeatScroll=function(){clearInterval(this.timeout)},t.prototype.tabHoldHandler=function(e){var i=this,r=e.originalEvent.target;r=this.contains(r,ea)?r.firstElementChild:r;var n=10,s=function(){i.eleScrolling(n,r,!0)};this.timeout=window.setInterval(function(){s()},50)},t.prototype.contains=function(e,i){return e.classList.contains(i)},t.prototype.eleScrolling=function(e,i,r){var n=this.element,s=i.classList;s.contains(ea)&&(s=i.querySelector("."+ko).classList),this.contains(n,Js)&&this.browserCheck&&(e=-e),!this.contains(n,Js)||this.browserCheck||this.ieCheck?s.contains(Io)?this.frameScrollRequest(e,"add",r):this.frameScrollRequest(e,"",r):s.contains(Zl)?this.frameScrollRequest(e,"add",r):this.frameScrollRequest(e,"",r)},t.prototype.clickEventHandler=function(e){this.eleScrolling(this.scrollStep,e.target,!1)},t.prototype.swipeHandler=function(e){var i=this.scrollEle,r;e.velocity<=1?r=e.distanceX/(e.velocity*10):r=e.distanceX/e.velocity;var n=.5,s=function(){var l=Math.sin(n);l<=0?window.cancelAnimationFrame(l):(e.swipeDirection==="Left"?i.scrollLeft+=r*l:e.swipeDirection==="Right"&&(i.scrollLeft-=r*l),n-=.5,window.requestAnimationFrame(s))};s()},t.prototype.scrollUpdating=function(e,i){i==="add"?this.scrollEle.scrollLeft+=e:this.scrollEle.scrollLeft-=e},t.prototype.frameScrollRequest=function(e,i,r){var n=this,s=10;if(r){this.scrollUpdating(e,i);return}this.customStep||[].slice.call((0,a.td)("."+Yl,this.element)).forEach(function(h){e-=h.offsetWidth});var l=function(){var h,c;n.contains(n.element,Js)&&n.browserCheck?(h=-e,c=-s):(h=e,c=s),h<s?window.cancelAnimationFrame(c):(n.scrollUpdating(c,i),e-=c,window.requestAnimationFrame(l))};l()},t.prototype.touchHandler=function(e){var i=this.scrollEle,r=e.distanceX;this.ieCheck&&this.contains(this.element,Js)&&(r=-r),e.scrollDirection==="Left"?i.scrollLeft=i.scrollLeft+r:e.scrollDirection==="Right"&&(i.scrollLeft=i.scrollLeft-r)},t.prototype.arrowDisabling=function(e,i){if(this.isDevice){var r=(0,a.le)(e)?i:e,n=r.querySelector("."+ko);(0,a.le)(e)?(0,a.s1)(n,[Io],[Zl]):(0,a.s1)(n,[Zl],[Io])}else e&&i&&(e.classList.add(ms),e.setAttribute("aria-disabled","true"),e.removeAttribute("tabindex"),i.classList.remove(ms),i.setAttribute("aria-disabled","false"),i.setAttribute("tabindex","0"));this.repeatScroll()},t.prototype.scrollHandler=function(e){var i=e.target,r=i.offsetWidth,n=this.element,s=this.element.querySelector("."+of),l=this.element.querySelector("."+Jc),h=this.element.querySelector("."+tu),c=this.element.querySelector("."+eu),u=i.scrollLeft;if(u<=0&&(u=-u),this.isDevice&&(this.enableRtl&&!(this.browserCheck||this.ieCheck)&&(h=this.element.querySelector("."+eu),c=this.element.querySelector("."+tu)),u<hf?h.style.width=u+"px":h.style.width="40px",i.scrollWidth-Math.ceil(r+u)<hf?c.style.width=i.scrollWidth-Math.ceil(r+u)+"px":c.style.width="40px"),u===0)this.arrowDisabling(s,l);else if(Math.ceil(r+u+.1)>=i.scrollWidth)this.arrowDisabling(l,s);else{var p=this.element.querySelector("."+ea+"."+ms);p&&(p.classList.remove(ms),p.setAttribute("aria-disabled","false"),p.setAttribute("tabindex","0"))}},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"scrollStep":this.setScrollState();break;case"enableRtl":e.enableRtl?this.element.classList.add(Js):this.element.classList.remove(Js);break}}},af([(0,a.Z9)(null)],t.prototype,"scrollStep",void 0),t=af([a.Zl],t),t}(a.wA),ry=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),cf=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},ny="e-vscroll",ru="e-rtl",gs="e-overlay",sy="e-vscroll-bar",ay="e-vscroll-content",Do="e-nav-arrow",Gl="e-nav-up-arrow",Oo="e-nav-down-arrow",ta="e-scroll-nav",uf="e-scroll-up-nav",nu="e-scroll-down-nav",pf="e-scroll-device",Kl="e-scroll-overlay",df="e-scroll-up-overlay",ff="e-scroll-down-overlay",vf=40,Ro=function(o){ry(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){this.browser=a.AR.info.name,this.browserCheck=this.browser==="mozilla",this.isDevice=a.AR.isDevice,this.customStep=!0;var e=this.element;this.ieCheck=this.browser==="edge"||this.browser==="msie",this.initialize(),e.id===""&&(e.id=(0,a.QI)("vscroll"),this.uniqueId=!0),e.style.display="block",this.enableRtl&&e.classList.add(ru)},t.prototype.render=function(){this.touchModule=new a.Xh(this.element,{scroll:this.touchHandler.bind(this),swipe:this.swipeHandler.bind(this)}),a.bi.add(this.scrollEle,"scroll",this.scrollEventHandler,this),this.isDevice?(this.element.classList.add(pf),this.createOverlayElement(this.element)):this.createNavIcon(this.element),this.setScrollState(),a.bi.add(this.element,"wheel",this.wheelEventHandler,this)},t.prototype.setScrollState=function(){(0,a.le)(this.scrollStep)||this.scrollStep<0?(this.scrollStep=this.scrollEle.offsetHeight,this.customStep=!1):this.customStep=!0},t.prototype.initialize=function(){var e=(0,a.az)("div",{className:ay}),i=(0,a.az)("div",{className:sy});i.setAttribute("tabindex","-1");for(var r=this.element,n=[].slice.call(r.children),s=0,l=n;s<l.length;s++){var h=l[s];e.appendChild(h)}i.appendChild(e),r.appendChild(i),i.style.overflow="hidden",this.scrollEle=i,this.scrollItems=e},t.prototype.getPersistData=function(){var e=["scrollStep"];return this.addOnPersist(e)},t.prototype.getModuleName=function(){return"vScroll"},t.prototype.destroy=function(){var e=this.element;e.style.display="",(0,a.IV)([this.element],[ny,pf]);var i=(0,a.td)(".e-"+e.id+"_nav."+ta,e),r=(0,a.td)("."+Kl,e);[].slice.call(r).forEach(function(h){(0,a.og)(h)});for(var n=0,s=[].slice.call(this.scrollItems.children);n<s.length;n++){var l=s[n];e.appendChild(l)}this.uniqueId&&this.element.removeAttribute("id"),(0,a.og)(this.scrollEle),i.length>0&&((0,a.og)(i[0]),(0,a.le)(i[1])||(0,a.og)(i[1])),a.bi.remove(this.scrollEle,"scroll",this.scrollEventHandler),this.touchModule.destroy(),this.touchModule=null,o.prototype.destroy.call(this)},t.prototype.disable=function(e){var i=(0,a.td)(".e-scroll-nav:not(."+gs+")",this.element);e?this.element.classList.add(gs):this.element.classList.remove(gs),[].slice.call(i).forEach(function(r){r.setAttribute("tabindex",e?"-1":"0")})},t.prototype.createOverlayElement=function(e){var i=e.id.concat("_nav"),r=(0,a.az)("div",{className:Kl+" "+ff}),n="e-"+e.id.concat("_nav "+ta+" "+nu),s=(0,a.az)("div",{id:i.concat("down"),className:n}),l=(0,a.az)("div",{className:Oo+" "+Do+" e-icons"});s.appendChild(l);var h=(0,a.az)("div",{className:Kl+" "+df});this.ieCheck&&s.classList.add("e-ie-align"),e.appendChild(r),e.appendChild(s),e.insertBefore(h,e.firstChild),this.eventBinding([s])},t.prototype.createNavIcon=function(e){var i=e.id.concat("_nav"),r="e-"+e.id.concat("_nav "+ta+" "+nu),n=(0,a.az)("div",{id:i.concat("_down"),className:r});n.setAttribute("aria-disabled","false");var s=(0,a.az)("div",{className:Oo+" "+Do+" e-icons"}),l="e-"+e.id.concat("_nav "+ta+" "+uf),h=(0,a.az)("div",{id:i.concat("_up"),className:l+" "+gs});h.setAttribute("aria-disabled","true");var c=(0,a.az)("div",{className:Gl+" "+Do+" e-icons"});h.appendChild(c),n.appendChild(s),n.setAttribute("tabindex","0"),e.appendChild(n),e.insertBefore(h,e.firstChild),this.ieCheck&&(n.classList.add("e-ie-align"),h.classList.add("e-ie-align")),this.eventBinding([n,h])},t.prototype.onKeyPress=function(e){var i=this;if(e.key==="Enter"){var r=function(){i.keyTimeout=!0,i.eleScrolling(10,e.target,!0)};this.keyTimer=window.setTimeout(function(){r()},100)}},t.prototype.onKeyUp=function(e){e.key==="Enter"&&(this.keyTimeout?this.keyTimeout=!1:e.target.click(),clearTimeout(this.keyTimer))},t.prototype.eventBinding=function(e){var i=this;[].slice.call(e).forEach(function(r){new a.Xh(r,{tapHold:i.tabHoldHandler.bind(i),tapHoldThreshold:500}),r.addEventListener("keydown",i.onKeyPress.bind(i)),r.addEventListener("keyup",i.onKeyUp.bind(i)),r.addEventListener("mouseup",i.repeatScroll.bind(i)),r.addEventListener("touchend",i.repeatScroll.bind(i)),r.addEventListener("contextmenu",function(n){n.preventDefault()}),a.bi.add(r,"click",i.clickEventHandler,i)})},t.prototype.repeatScroll=function(){clearInterval(this.timeout)},t.prototype.tabHoldHandler=function(e){var i=this,r=e.originalEvent.target;r=this.contains(r,ta)?r.firstElementChild:r;var n=10,s=function(){i.eleScrolling(n,r,!0)};this.timeout=window.setInterval(function(){s()},50)},t.prototype.contains=function(e,i){return e.classList.contains(i)},t.prototype.eleScrolling=function(e,i,r){var n=i.classList;n.contains(ta)&&(n=i.querySelector("."+Do).classList),n.contains(Oo)?this.frameScrollRequest(e,"add",r):n.contains(Gl)&&this.frameScrollRequest(e,"",r)},t.prototype.clickEventHandler=function(e){this.eleScrolling(this.scrollStep,e.target,!1)},t.prototype.wheelEventHandler=function(e){e.preventDefault(),this.frameScrollRequest(this.scrollStep,e.deltaY>0?"add":"",!1)},t.prototype.swipeHandler=function(e){var i=this.scrollEle,r;e.velocity<=1?r=e.distanceY/(e.velocity*10):r=e.distanceY/e.velocity;var n=.5,s=function(){var l=Math.sin(n);l<=0?window.cancelAnimationFrame(l):(e.swipeDirection==="Up"?i.scrollTop+=r*l:e.swipeDirection==="Down"&&(i.scrollTop-=r*l),n-=.02,window.requestAnimationFrame(s))};s()},t.prototype.scrollUpdating=function(e,i){i==="add"?this.scrollEle.scrollTop+=e:this.scrollEle.scrollTop-=e},t.prototype.frameScrollRequest=function(e,i,r){var n=this,s=10;if(r){this.scrollUpdating(e,i);return}this.customStep||[].slice.call((0,a.td)("."+Kl,this.element)).forEach(function(h){e-=h.offsetHeight});var l=function(){e<s?window.cancelAnimationFrame(s):(n.scrollUpdating(s,i),e-=s,window.requestAnimationFrame(l))};l()},t.prototype.touchHandler=function(e){var i=this.scrollEle,r=e.distanceY;e.scrollDirection==="Up"?i.scrollTop=i.scrollTop+r:e.scrollDirection==="Down"&&(i.scrollTop=i.scrollTop-r)},t.prototype.arrowDisabling=function(e,i){if(this.isDevice){var r=(0,a.le)(e)?i:e,n=r.querySelector("."+Do);(0,a.le)(e)?(0,a.s1)(n,[Oo],[Gl]):(0,a.s1)(n,[Gl],[Oo])}else e.classList.add(gs),e.setAttribute("aria-disabled","true"),e.removeAttribute("tabindex"),i.classList.remove(gs),i.setAttribute("aria-disabled","false"),i.setAttribute("tabindex","0");this.repeatScroll()},t.prototype.scrollEventHandler=function(e){var i=e.target,r=i.offsetHeight,n=this.element.querySelector("."+uf),s=this.element.querySelector("."+nu),l=this.element.querySelector("."+df),h=this.element.querySelector("."+ff),c=i.scrollTop;if(c<=0&&(c=-c),this.isDevice&&(c<vf?l.style.height=c+"px":l.style.height="40px",i.scrollHeight-Math.ceil(r+c)<vf?h.style.height=i.scrollHeight-Math.ceil(r+c)+"px":h.style.height="40px"),c===0)this.arrowDisabling(n,s);else if(Math.ceil(r+c+.1)>=i.scrollHeight)this.arrowDisabling(s,n);else{var u=this.element.querySelector("."+ta+"."+gs);u&&(u.classList.remove(gs),u.setAttribute("aria-disabled","false"),u.setAttribute("tabindex","0"))}},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"scrollStep":this.setScrollState();break;case"enableRtl":e.enableRtl?this.element.classList.add(ru):this.element.classList.remove(ru);break}}},cf([(0,a.Z9)(null)],t.prototype,"scrollStep",void 0),t=cf([a.Zl],t),t}(a.wA),mf=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),hi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},su="e-vertical",Si="e-toolbar-items",ji="e-toolbar-item",En="e-rtl",Fi="e-separator",Xl="e-popup-up-icon",Mo="e-popup-down-icon",gf="e-popup-open",yf="e-template",un="e-overlay",bf="e-toolbar-text",au="e-popup-text",pn="e-overflow-show",$l="e-overflow-hide",oy="e-tbar-btn",Cr="e-hor-nav",Cf="e-scroll-nav",ly="e-toolbar-right",hy="e-toolbar-left",Sf="e-toolbar-center",dn="e-tbar-pos",cy="e-hscroll-content",uy="e-vscroll-content",wf="e-hscroll-bar",py="e-hor-nav",Po="e-toolbar-pop",Vn="e-toolbar-popup",dy="e-tbar-btn-text",No="e-nav-active",Bo="e-ignore",ou="e-popup-alone",Fo="e-hidden",xf="e-toolbar-multirow",Ef="e-multirow-pos",lu="e-multirow-separator",hu="e-extended-separator",Af="e-extended-toolbar",Ql="e-toolbar-extended",fy="e-expended-nav",cu="e-tbar-extended",uu=function(o){mf(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return hi([(0,a.Z9)("")],t.prototype,"id",void 0),hi([(0,a.Z9)("")],t.prototype,"text",void 0),hi([(0,a.Z9)("auto")],t.prototype,"width",void 0),hi([(0,a.Z9)("")],t.prototype,"cssClass",void 0),hi([(0,a.Z9)(!1)],t.prototype,"showAlwaysInPopup",void 0),hi([(0,a.Z9)(!1)],t.prototype,"disabled",void 0),hi([(0,a.Z9)("")],t.prototype,"prefixIcon",void 0),hi([(0,a.Z9)("")],t.prototype,"suffixIcon",void 0),hi([(0,a.Z9)(!0)],t.prototype,"visible",void 0),hi([(0,a.Z9)("None")],t.prototype,"overflow",void 0),hi([(0,a.Z9)("")],t.prototype,"template",void 0),hi([(0,a.Z9)("Button")],t.prototype,"type",void 0),hi([(0,a.Z9)("Both")],t.prototype,"showTextOn",void 0),hi([(0,a.Z9)(null)],t.prototype,"htmlAttributes",void 0),hi([(0,a.Z9)("")],t.prototype,"tooltipText",void 0),hi([(0,a.Z9)("Left")],t.prototype,"align",void 0),hi([(0,a.ju)()],t.prototype,"click",void 0),t}(a.rt),Ho=function(o){mf(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.resizeContext=r.resize.bind(r),r.keyConfigs={moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow",popupOpen:"enter",popupClose:"escape",tab:"tab",home:"home",end:"end"},r}return t.prototype.destroy=function(){var e=this;(this.isReact||this.isAngular)&&this.clearTemplate();var i=this.element.querySelectorAll(".e-control.e-btn");for([].slice.call(i).forEach(function(r){!(0,a.le)(r)&&!(0,a.le)(r.ej2_instances)&&!(0,a.le)(r.ej2_instances[0])&&!r.ej2_instances[0].isDestroyed&&r.ej2_instances[0].destroy()}),this.unwireEvents(),this.tempId.forEach(function(r){(0,a.le)(e.element.querySelector(r))||(document.body.appendChild(e.element.querySelector(r)).style.display="none")}),this.destroyItems();this.element.lastElementChild;)this.element.removeChild(this.element.lastElementChild);this.trgtEle&&(this.element.appendChild(this.ctrlTem),this.trgtEle=null,this.ctrlTem=null),this.popObj&&(this.popObj.destroy(),(0,a.og)(this.popObj.element)),this.activeEle&&(this.activeEle=null),this.popObj=null,this.tbarAlign=null,this.tbarItemsCol=[],this.remove(this.element,"e-toolpop"),this.cssClass&&(0,a.IV)([this.element],this.cssClass.split(" ")),this.element.removeAttribute("style"),["aria-disabled","aria-orientation","aria-haspopup","role"].forEach(function(r){return e.element.removeAttribute(r)}),o.prototype.destroy.call(this)},t.prototype.preRender=function(){var e={enableCollision:this.enableCollision,scrollStep:this.scrollStep};this.trigger("beforeCreate",e),this.enableCollision=e.enableCollision,this.scrollStep=e.scrollStep,this.scrollModule=null,this.popObj=null,this.tempId=[],this.tbarItemsCol=this.items,this.isVertical=!!this.element.classList.contains(su),this.isExtendedOpen=!1,this.popupPriCount=0,this.enableRtl&&this.add(this.element,En)},t.prototype.wireEvents=function(){a.bi.add(this.element,"click",this.clickHandler,this),window.addEventListener("resize",this.resizeContext),this.allowKeyboard&&this.wireKeyboardEvent()},t.prototype.wireKeyboardEvent=function(){this.keyModule=new a.nv(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs}),a.bi.add(this.element,"keydown",this.docKeyDown,this),this.element.setAttribute("tabIndex","0")},t.prototype.unwireKeyboardEvent=function(){this.keyModule&&(a.bi.remove(this.element,"keydown",this.docKeyDown),this.keyModule.destroy(),this.keyModule=null)},t.prototype.docKeyDown=function(e){if(e.target.tagName!=="INPUT"){var i=!(0,a.le)(this.popObj)&&(0,a.pn)(this.popObj.element)&&this.overflowMode!=="Extended";e.keyCode===9&&e.target.classList.contains("e-hor-nav")===!0&&i&&this.popObj.hide({name:"FadeOut",duration:100});var r=e.keyCode===40||e.keyCode===38||e.keyCode===35||e.keyCode===36;r&&e.preventDefault()}},t.prototype.unwireEvents=function(){a.bi.remove(this.element,"click",this.clickHandler),this.destroyScroll(),this.unwireKeyboardEvent(),window.removeEventListener("resize",this.resizeContext),a.bi.remove(document,"scroll",this.docEvent),a.bi.remove(document,"click",this.docEvent)},t.prototype.clearProperty=function(){this.tbarEle=[],this.tbarAlgEle={lefts:[],centers:[],rights:[]}},t.prototype.docEvent=function(e){var i=(0,a.oq)(e.target,".e-popup");this.popObj&&(0,a.pn)(this.popObj.element)&&!i&&this.overflowMode==="Popup"&&this.popObj.hide({name:"FadeOut",duration:100})},t.prototype.destroyScroll=function(){this.scrollModule&&(this.tbarAlign&&this.add(this.scrollModule.element,dn),this.scrollModule.destroy(),this.scrollModule=null)},t.prototype.destroyItems=function(){if(this.element&&[].slice.call(this.element.querySelectorAll("."+ji)).forEach(function(i){(0,a.og)(i)}),this.tbarAlign){var e=this.element.querySelector("."+Si);[].slice.call(e.children).forEach(function(i){(0,a.og)(i)}),this.tbarAlign=!1,this.remove(e,dn)}this.clearProperty()},t.prototype.destroyMode=function(){this.scrollModule&&(this.remove(this.scrollModule.element,En),this.destroyScroll()),this.remove(this.element,cu),this.remove(this.element,Af);var e=this.element.querySelector(".e-toolbar-multirow");e&&this.remove(e,xf),this.popObj&&this.popupRefresh(this.popObj.element,!0)},t.prototype.add=function(e,i){e.classList.add(i)},t.prototype.remove=function(e,i){e.classList.remove(i)},t.prototype.elementFocus=function(e){var i=e.firstElementChild;i?(i.focus(),this.activeEleSwitch(e)):e.focus()},t.prototype.clstElement=function(e,i){var r;return e&&this.popObj&&(0,a.pn)(this.popObj.element)?r=this.popObj.element.querySelector("."+ji):this.element===i||e?r=this.element.querySelector("."+ji+":not(."+un+" ):not(."+Fi+" ):not(."+Fo+" )"):r=(0,a.oq)(i,"."+ji),r},t.prototype.keyHandling=function(e,i,r,n,s){var l=this.popObj,h=this.element,c={name:"FadeOut",duration:100},u=i.action==="moveUp"?"previous":"next",p,f;switch(i.action){case"moveRight":if(this.isVertical)return;h===r?this.elementFocus(e):n||this.eleFocus(e,"next");break;case"moveLeft":if(this.isVertical)return;n||this.eleFocus(e,"previous");break;case"home":case"end":if(e){var g=(0,a.oq)(e,".e-popup"),C=this.element.querySelector("."+Ql);this.overflowMode==="Extended"&&C&&C.classList.contains("e-popup-open")&&(g=i.action==="end"?C:null),g?(0,a.pn)(this.popObj.element)&&(f=[].slice.call(g.children),i.action==="home"?p=f[0]:p=f[f.length-1]):(f=this.element.querySelectorAll("."+Si+" ."+ji+":not(."+Fi+")"),i.action==="home"?p=f[0]:p=f[f.length-1]),p&&this.elementFocus(p)}break;case"moveUp":case"moveDown":if(this.isVertical)i.action==="moveUp"?this.eleFocus(e,"previous"):this.eleFocus(e,"next");else if(l&&(0,a.oq)(r,".e-popup")){var L=l.element,D=L.firstElementChild;if(u==="previous"&&D===e||u==="next"&&L.lastElementChild===e)return;this.eleFocus(e,u)}else i.action==="moveDown"&&l&&(0,a.pn)(l.element)&&this.elementFocus(e);break;case"tab":if(!s&&!n){var R=e.firstElementChild;h===r&&(this.activeEle?this.activeEle.focus():(this.activeEleRemove(R),R.focus()),this.element.removeAttribute("tabindex"))}break;case"popupClose":l&&this.overflowMode!=="Extended"&&l.hide(c);break;case"popupOpen":if(!n)return;l&&!(0,a.pn)(l.element)?(l.element.style.top=h.offsetHeight+"px",l.show({name:"FadeIn",duration:100})):l.hide(c);break}},t.prototype.keyActionHandler=function(e){var i=e.target;if(!(i.tagName==="INPUT"||i.tagName==="TEXTAREA"||this.element.classList.contains(un))){e.preventDefault();var r=i.classList.contains(Cr),n=i.classList.contains(Cf),s=this.clstElement(r,i);(s||n)&&this.keyHandling(s,e,i,r,n)}},t.prototype.disable=function(e){var i=this.element;e?i.classList.add(un):i.classList.remove(un),i.setAttribute("tabindex",e?"-1":"0"),this.activeEle&&this.activeEle.setAttribute("tabindex",e?"-1":"0"),this.scrollModule&&this.scrollModule.disable(e),this.popObj&&((0,a.pn)(this.popObj.element)&&this.overflowMode!=="Extended"&&this.popObj.hide(),i.querySelector("#"+i.id+"_nav").setAttribute("tabindex",e?"-1":"0"))},t.prototype.eleContains=function(e){return e.classList.contains(Fi)||e.classList.contains(un)||e.getAttribute("disabled")||e.classList.contains(Fo)||!(0,a.pn)(e)},t.prototype.eleFocus=function(e,i){var r=Object(e)[i+"ElementSibling"];if(r){var n=this.eleContains(r);if(n){this.eleFocus(r,i);return}this.elementFocus(r)}else if(this.tbarAlign){var s=Object(e.parentElement)[i+"ElementSibling"];if(!(0,a.le)(s)&&s.children.length===0&&(s=Object(s)[i+"ElementSibling"]),!(0,a.le)(s)&&s.children.length>0)if(i==="next"){var l=s.querySelector("."+ji);this.eleContains(l)?this.eleFocus(l,i):(l.firstElementChild.focus(),this.activeEleSwitch(l))}else{var l=s.lastElementChild;this.eleContains(l)?this.eleFocus(l,i):this.elementFocus(l)}}},t.prototype.clickHandler=function(e){var i=this,r=e.target,n=this.element,s=!(0,a.le)((0,a.oq)(r,"."+Po)),l=r.classList,h=(0,a.oq)(r,"."+Cr);h||(h=r),!n.children[0].classList.contains("e-hscroll")&&!n.children[0].classList.contains("e-vscroll")&&l.contains(Cr)&&(l=r.querySelector(".e-icons").classList),(l.contains(Xl)||l.contains(Mo))&&this.popupClickHandler(n,h,En);var c,u=(0,a.oq)(e.target,"."+ji);if(!(((0,a.le)(u)||u.classList.contains(un))&&!h.classList.contains(Cr))){if(u){var p=this.items[this.tbarEle.indexOf(u)];c=p}var f={originalEvent:e,item:c};c&&!(0,a.le)(c.click)&&this.trigger("items["+this.tbarEle.indexOf(u)+"].click",f),f.cancel||this.trigger("clicked",f,function(g){!(0,a.le)(i.popObj)&&s&&!g.cancel&&i.overflowMode==="Popup"&&g.item&&g.item.type!=="Input"&&i.popObj.hide({name:"FadeOut",duration:100})})}},t.prototype.popupClickHandler=function(e,i,r){var n=this.popObj;(0,a.pn)(n.element)?(i.classList.remove(No),n.hide({name:"FadeOut",duration:100})):(e.classList.contains(r)&&(n.enableRtl=!0,n.position={X:"left",Y:"top"}),n.offsetX===0&&!e.classList.contains(r)&&(n.enableRtl=!1,n.position={X:"right",Y:"top"}),n.dataBind(),n.refreshPosition(),n.element.style.top=this.getElementOffsetY()+"px",this.overflowMode==="Extended"&&(n.element.style.minHeight="0px"),i.classList.add(No),n.show({name:"FadeIn",duration:100}))},t.prototype.render=function(){this.initialize(),this.renderControl(),this.wireEvents(),this.renderComplete()},t.prototype.initialize=function(){var e=(0,a.Ac)(this.width),i=(0,a.Ac)(this.height);(a.AR.info.name!=="msie"||this.height!=="auto"||this.overflowMode==="MultiRow")&&(0,a.V7)(this.element,{height:i}),(0,a.V7)(this.element,{width:e});var r={role:"toolbar","aria-disabled":"false","aria-haspopup":"false","aria-orientation":this.isVertical?"vertical":"horizontal"};(0,a.Y4)(this.element,r),this.cssClass&&(0,a.cn)([this.element],this.cssClass.split(" "))},t.prototype.renderControl=function(){var e=this.element;this.trgtEle=e.children.length>0?e.querySelector("div"):null,this.tbarAlgEle={lefts:[],centers:[],rights:[]},this.renderItems(),this.renderLayout()},t.prototype.renderLayout=function(){this.renderOverflowMode(),this.tbarAlign&&this.itemPositioning(),this.popObj&&this.popObj.element.childElementCount>1&&this.checkPopupRefresh(this.element,this.popObj.element)&&this.popupRefresh(this.popObj.element,!1),this.separator()},t.prototype.itemsAlign=function(e,i){var r,n;this.tbarEle||(this.tbarEle=[]);for(var s=0;s<e.length;s++)r=this.renderSubComponent(e[s],s),this.tbarEle.indexOf(r)===-1&&this.tbarEle.push(r),this.tbarAlign||this.tbarItemAlign(e[s],i,s),n=i.querySelector(".e-toolbar-"+e[s].align.toLowerCase()),n?(e[s].showAlwaysInPopup&&e[s].overflow!=="Show"||this.tbarAlgEle[(e[s].align+"s").toLowerCase()].push(r),n.appendChild(r)):i.appendChild(r);if(this.isReact){var l="portals";this.notify("render-react-toolbar-template",this[l]),this.renderReactTemplates()}},t.prototype.changeOrientation=function(){var e=this.element;this.isVertical?(e.classList.remove(su),this.isVertical=!1,(this.height==="auto"||this.height==="100%")&&(e.style.height=this.height),e.setAttribute("aria-orientation","horizontal")):(e.classList.add(su),this.isVertical=!0,e.setAttribute("aria-orientation","vertical"),(0,a.V7)(this.element,{height:(0,a.Ac)(this.height),width:(0,a.Ac)(this.width)})),this.destroyMode(),this.refreshOverflow()},t.prototype.initScroll=function(e,i){!this.scrollModule&&this.checkOverflow(e,i[0])&&(this.tbarAlign&&this.element.querySelector("."+Si+" ."+Sf).removeAttribute("style"),this.isVertical?this.scrollModule=new Ro({scrollStep:this.scrollStep,enableRtl:this.enableRtl},i[0]):this.scrollModule=new iu({scrollStep:this.scrollStep,enableRtl:this.enableRtl},i[0]),this.remove(this.scrollModule.element,dn),(0,a.V7)(this.element,{overflow:"hidden"}))},t.prototype.itemWidthCal=function(e){var i=this,r=0,n;return[].slice.call((0,a.td)("."+ji,e)).forEach(function(s){(0,a.pn)(s)&&(n=window.getComputedStyle(s),r+=i.isVertical?s.offsetHeight:s.offsetWidth,r+=parseFloat(i.isVertical?n.marginTop:n.marginRight),r+=parseFloat(i.isVertical?n.marginBottom:n.marginLeft))}),r},t.prototype.getScrollCntEle=function(e){var i=this.isVertical?".e-vscroll-content":".e-hscroll-content";return e.querySelector(i)},t.prototype.checkOverflow=function(e,i){if((0,a.le)(e)||(0,a.le)(i)||!(0,a.pn)(e))return!1;var r=this.isVertical?e.offsetHeight:e.offsetWidth,n=this.isVertical?i.offsetHeight:i.offsetWidth;(this.tbarAlign||this.scrollModule||r===n)&&(n=this.itemWidthCal(this.scrollModule?this.getScrollCntEle(i):i));var s=e.querySelector("."+Cr),l=e.querySelector("."+Cf),h=0;return s?h=this.isVertical?s.offsetHeight:s.offsetWidth:l&&(h=this.isVertical?l.offsetHeight*2:l.offsetWidth*2),n>r-h},t.prototype.refreshOverflow=function(){this.resize()},t.prototype.toolbarAlign=function(e){this.tbarAlign&&(this.add(e,dn),this.itemPositioning())},t.prototype.renderOverflowMode=function(){var e=this.element,i=e.querySelector("."+Si),r=this.popupPriCount>0;if(e&&e.children.length>0)switch(this.offsetWid=e.offsetWidth,this.remove(this.element,"e-toolpop"),a.AR.info.name==="msie"&&this.height==="auto"&&(e.style.height=""),this.overflowMode){case"Scrollable":(0,a.le)(this.scrollModule)&&this.initScroll(e,[].slice.call(e.getElementsByClassName(Si)));break;case"Popup":this.add(this.element,"e-toolpop"),this.tbarAlign&&this.removePositioning(),(this.checkOverflow(e,i)||r)&&this.setOverflowAttributes(e),this.toolbarAlign(i);break;case"MultiRow":this.add(i,xf),this.checkOverflow(e,i)&&this.tbarAlign&&(this.removePositioning(),this.add(i,Ef)),e.style.overflow==="hidden"&&(e.style.overflow=""),(a.AR.info.name==="msie"||e.style.height!=="auto")&&(e.style.height="auto");break;case"Extended":this.add(this.element,Af),(this.checkOverflow(e,i)||r)&&(this.tbarAlign&&this.removePositioning(),this.setOverflowAttributes(e)),this.toolbarAlign(i)}},t.prototype.setOverflowAttributes=function(e){this.createPopupEle(e,[].slice.call((0,a.td)("."+Si+" ."+ji,e))),this.element.querySelector("."+Cr).setAttribute("tabIndex","0"),this.element.querySelector("."+Cr).setAttribute("role","list")},t.prototype.separator=function(){var e=this.element,i=[].slice.call(e.querySelectorAll("."+Fi)),r=e.querySelector("."+lu),n=e.querySelector("."+hu),s=this.overflowMode==="MultiRow"?r:n;s!==null&&(this.overflowMode==="MultiRow"?s.classList.remove(lu):this.overflowMode==="Extended"&&s.classList.remove(hu));for(var l=0;l<=i.length-1;l++)i[l].offsetLeft<30&&i[l].offsetLeft!==0&&(this.overflowMode==="MultiRow"?i[l].classList.add(lu):this.overflowMode==="Extended"&&i[l].classList.add(hu))},t.prototype.createPopupEle=function(e,i){var r=e.querySelector("."+Cr),n=this.isVertical;r||this.createPopupIcon(e),r=e.querySelector("."+Cr);var s=n?r.offsetHeight:r.offsetWidth,l=(n?e.offsetHeight:e.offsetWidth)-s;this.element.classList.remove("e-rtl"),(0,a.V7)(this.element,{direction:"initial"}),this.checkPriority(e,i,l,!0),this.enableRtl&&this.element.classList.add("e-rtl"),this.element.style.removeProperty("direction"),this.createPopup()},t.prototype.pushingPoppedEle=function(e,i,r,n,s){var l=e.element,h=[].slice.call((0,a.td)("."+Vn,l.querySelector("."+Si))),c=(0,a.td)("."+pn,r),u=0,p=0;h.forEach(function(L,D){c=(0,a.td)("."+pn,r),L.classList.contains(pn)&&c.length>0?e.tbResize&&c.length>D?(r.insertBefore(L,c[D]),++p):(r.insertBefore(L,r.children[c.length]),++p):L.classList.contains(pn)||e.tbResize&&L.classList.contains($l)&&r.children.length>0&&c.length===0?(r.insertBefore(L,r.firstChild),++p):L.classList.contains($l)?i.push(L):e.tbResize?(r.insertBefore(L,r.childNodes[u+p]),++u):r.appendChild(L),L.classList.contains(Fi)?(0,a.V7)(L,{display:"",height:s+"px"}):(0,a.V7)(L,{display:"",height:n+"px"})}),i.forEach(function(L){r.appendChild(L)});for(var f=(0,a.td)("."+ji,l.querySelector("."+Si)),g=f.length-1;g>=0;g--){var C=f[g];if(C.classList.contains(Fi)&&this.overflowMode!=="Extended")(0,a.V7)(C,{display:"none"});else break}},t.prototype.createPopup=function(){var e=this.element,i,r;this.overflowMode==="Extended"&&(r=e.querySelector("."+Fi+":not(."+Vn+")"),i=e.style.height==="auto"||e.style.height===""?null:r.offsetHeight);var n=e.querySelector("."+ji+":not(."+Fi+"):not(."+Vn+")"),s=e.style.height==="auto"||e.style.height===""?null:n&&n.offsetHeight,l,h=[];if((0,a.Ys)("#"+e.id+"_popup."+Po,e))l=(0,a.Ys)("#"+e.id+"_popup."+Po,e);else{var c=this.createElement("div",{id:e.id+"_popup",className:Po+" "+Ql}),u=this.createElement("div",{id:e.id+"_popup",className:Po});l=this.overflowMode==="Extended"?c:u}this.pushingPoppedEle(this,h,l,s,i),this.popupInit(e,l)},t.prototype.getElementOffsetY=function(){return this.overflowMode==="Extended"&&window.getComputedStyle(this.element).getPropertyValue("box-sizing")==="border-box"?this.element.clientHeight:this.element.offsetHeight},t.prototype.popupInit=function(e,i){if(this.popObj){var l=this.popObj.element;(0,a.V7)(l,{maxHeight:"",display:"block"}),(0,a.V7)(l,{maxHeight:l.offsetHeight+"px",display:""})}else{e.appendChild(i),(0,a.V7)(this.element,{overflow:""});var r=window.getComputedStyle(this.element),n=new br(null,{relateTo:this.element,offsetY:this.isVertical?0:this.getElementOffsetY(),enableRtl:this.enableRtl,open:this.popupOpen.bind(this),close:this.popupClose.bind(this),collision:{Y:this.enableCollision?"flip":"none"},position:this.enableRtl?{X:"left",Y:"top"}:{X:"right",Y:"top"}});if(n.appendTo(i),this.overflowMode==="Extended"&&(n.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)*2,n.offsetX=0),a.bi.add(document,"scroll",this.docEvent.bind(this)),a.bi.add(document,"click ",this.docEvent.bind(this)),n.element.style.maxHeight=n.element.offsetHeight+"px",this.isVertical&&(n.element.style.visibility="hidden"),this.isExtendedOpen){var s=this.element.querySelector("."+Cr);s.classList.add(No),(0,a.s1)(s.firstElementChild,[Xl],[Mo]),this.element.querySelector("."+Ql).classList.add(gf)}else n.hide();this.popObj=n,this.element.setAttribute("aria-haspopup","true")}},t.prototype.tbarPopupHandler=function(e){this.overflowMode==="Extended"&&(e?this.add(this.element,cu):this.remove(this.element,cu))},t.prototype.popupOpen=function(e){var i=this.popObj;this.isVertical||(i.offsetY=this.getElementOffsetY(),i.dataBind());var r=this.popObj.element,n=this.popObj.element.parentElement,s=n.querySelector("."+Cr);(0,a.V7)(i.element,{height:"auto",maxHeight:""}),i.element.style.maxHeight=i.element.offsetHeight+"px",this.overflowMode==="Extended"&&(i.element.style.minHeight="");var l=r.offsetTop+r.offsetHeight+Di(n).top,h=s.firstElementChild;s.classList.add(No),(0,a.s1)(h,[Xl],[Mo]),this.tbarPopupHandler(!0);var c=(0,a.le)(window.scrollY)?0:window.scrollY;if(!this.isVertical&&window.innerHeight+c<l&&this.element.offsetTop<r.offsetHeight){var u=r.offsetHeight-(l-window.innerHeight-c+5);i.height=u+"px";for(var p=0;p<=r.childElementCount;p++){var f=r.children[p];if(f.offsetTop+f.offsetHeight>u){u=f.offsetTop;break}}(0,a.V7)(i.element,{maxHeight:u+"px"})}else if(this.isVertical){var g=this.element.getBoundingClientRect();(0,a.V7)(i.element,{maxHeight:g.top+this.element.offsetHeight+"px",bottom:0,visibility:""})}if(i){var C=r.getBoundingClientRect();C.right>document.documentElement.clientWidth&&C.width>n.getBoundingClientRect().width&&(i.collision={Y:"none"},i.dataBind()),i.refreshPosition()}},t.prototype.popupClose=function(e){var i=this.element,r=i.querySelector("."+Cr),n=r.firstElementChild;r.classList.remove(No),(0,a.s1)(n,[Mo],[Xl]),this.tbarPopupHandler(!1)},t.prototype.checkPriority=function(e,i,r,n){for(var s=this.popupPriCount>0,l=i.length,h=r,c,u,p=0,f=0,g=0,C=function(ne,ie){var me=!1;return ie.forEach(function(ve){ne.classList.contains(ve)&&(me=!0)}),me},L=l-1;L>=0;L--){var D=void 0,R=window.getComputedStyle(i[L]);this.isVertical?(D=parseFloat(R.marginTop),D+=parseFloat(R.marginBottom)):(D=parseFloat(R.marginRight),D+=parseFloat(R.marginLeft));var B=i[L]===this.tbarEle[0];B&&(this.tbarEleMrgn=D),c=this.isVertical?i[L].offsetHeight:i[L].offsetWidth;var H=B?c+D:c;if(C(i[L],[ou])&&s&&(i[L].classList.add(Vn),this.isVertical?(0,a.V7)(i[L],{display:"none",minHeight:H+"px"}):(0,a.V7)(i[L],{display:"none",minWidth:H+"px"}),g++),this.isVertical?u=i[L].offsetTop+i[L].offsetHeight+D>r:u=i[L].offsetLeft+i[L].offsetWidth+D>r,u){if(i[L].classList.contains(Fi)){if(this.overflowMode==="Extended"){if(f===g){var j=i[L];C(j,[Fi,Bo])&&(i[L].classList.add(Vn),g++)}f++}else if(this.overflowMode==="Popup"){if(p>0&&f===g){var j=i[L+f+(p-1)];C(j,[Fi,Bo])&&(0,a.V7)(j,{display:"none"})}p++,f=0,g=0}}else f++;i[L].classList.contains(pn)&&n?r-=(this.isVertical?i[L].offsetHeight:i[L].offsetWidth)+D:C(i[L],[Fi,Bo])?r-=(this.isVertical?i[L].offsetHeight:i[L].offsetWidth)+D:(i[L].classList.add(Vn),this.isVertical?(0,a.V7)(i[L],{display:"none",minHeight:H+"px"}):(0,a.V7)(i[L],{display:"none",minWidth:H+"px"}),g++)}}if(n){var W=(0,a.td)("."+ji+":not(."+Vn+")",this.element);this.checkPriority(e,W,h,!1)}},t.prototype.createPopupIcon=function(e){var i=e.id.concat("_nav"),r="e-"+e.id.concat("_nav "+py);r=this.overflowMode==="Extended"?r+" "+fy:r;var n=this.createElement("div",{id:i,className:r});(a.AR.info.name==="msie"||a.AR.info.name==="edge")&&n.classList.add("e-ie-align");var s=this.createElement("div",{className:Mo+" e-icons"});n.appendChild(s),n.setAttribute("tabindex","0"),n.setAttribute("role","list"),e.appendChild(n)},t.prototype.tbarPriRef=function(e,i,r,n,s,l,h,c){var u=c,p=this.popObj.element,f="."+ji+":not(."+Fi+"):not(."+pn+")",g=(0,a.td)("."+Vn+":not(."+pn+")",p).length,C=function(j,W){return j.classList.contains(W)};if((0,a.td)(f,e).length===0){var L=e.children[i-(i-r)-1],D=!(0,a.le)(L)&&C(L,Bo);if(!(0,a.le)(L)&&C(L,Fi)&&!(0,a.pn)(L)||D){var R="none";L.style.display="inherit";var B=L.offsetWidth+parseFloat(window.getComputedStyle(L).marginRight)*2,H=L.previousElementSibling;l+B<h||s?(e.insertBefore(n,e.children[i+u-(i-r)]),(0,a.le)(H)||(H.style.display="")):H.classList.contains(Fi)&&(H.style.display=R),L.style.display=""}else e.insertBefore(n,e.children[i+u-(i-r)])}else e.insertBefore(n,e.children[i+u-g])},t.prototype.popupRefresh=function(e,i){var r=this,n=this.element,s=this.isVertical,l=n.querySelector("."+Si),h=n.querySelector("."+Cr);if(!(0,a.le)(h)){l.removeAttribute("style"),e.style.display="block";var c;s?c=n.offsetHeight-(h.offsetHeight+l.offsetHeight):c=n.offsetWidth-(h.offsetWidth+l.offsetWidth);var u=0;[].slice.call(e.children).forEach(function(p){u+=r.popupEleWidth(p),(0,a.V7)(p,{position:""})}),c+(s?h.offsetHeight:h.offsetWidth)>u&&this.popupPriCount===0&&(i=!0),this.popupEleRefresh(c,e,i),e.style.display="",e.children.length===0&&h&&this.popObj&&((0,a.og)(h),h=null,this.popObj.destroy(),(0,a.og)(this.popObj.element),this.popObj=null,n.setAttribute("aria-haspopup","false"))}},t.prototype.ignoreEleFetch=function(e,i){var r=[].slice.call(i.querySelectorAll("."+Bo)),n=[],s=0;if(r.length>0)r.forEach(function(l){n.push([].slice.call(i.children).indexOf(l))});else return 0;return n.forEach(function(l){l<=e&&s++}),s},t.prototype.checkPopupRefresh=function(e,i){i.style.display="block";var r=this.popupEleWidth(i.firstElementChild);i.firstElementChild.style.removeProperty("Position");var n=e.offsetWidth-e.querySelector("."+Cr).offsetWidth,s=e.querySelector("."+Si).offsetWidth;return i.style.removeProperty("display"),n>r+s},t.prototype.popupEleWidth=function(e){e.style.position="absolute";var i=this.isVertical?e.offsetHeight:e.offsetWidth,r=e.querySelector("."+dy);if(e.classList.contains("e-tbtn-align")||e.classList.contains(au)){var n=e.children[0];!(0,a.le)(r)&&e.classList.contains(au)?r.style.display="none":!(0,a.le)(r)&&e.classList.contains(bf)&&(r.style.display="block"),n.style.minWidth="0%",i=parseFloat(this.isVertical?e.style.minHeight:e.style.minWidth),n.style.minWidth="",n.style.minHeight="",(0,a.le)(r)||(r.style.display="")}return i},t.prototype.popupEleRefresh=function(e,i,r){for(var n=this.popupPriCount>0,s=this.tbarEle,l,h,c=this.element.querySelector("."+Si),u=0,p=function(B){if(B.classList.contains(ou)&&n&&!r)return"continue";var H=f.popupEleWidth(B);if(B===f.tbarEle[0]&&(H+=f.tbarEleMrgn),B.style.position="",H<e||r){if((0,a.V7)(B,{minWidth:"",height:"",minHeight:""}),B.classList.contains($l)||B.classList.remove(Vn),h=f.tbarEle.indexOf(B),f.tbarAlign){var j=f.items[h].align;h=f.tbarAlgEle[(j+"s").toLowerCase()].indexOf(B),s=f.tbarAlgEle[(j+"s").toLowerCase()],c=f.element.querySelector("."+Si+" .e-toolbar-"+j.toLowerCase())}var W=0;f.overflowMode!=="Extended"&&s.slice(0,h).forEach(function(ne){(ne.classList.contains(pn)||ne.classList.contains(Fi))&&(ne.classList.contains(Fi)&&(ne.style.display="",e-=ne.offsetWidth),W++)}),u=f.ignoreEleFetch(h,c),B.classList.contains(pn)?(f.tbarPriRef(c,h,W,B,r,H,e,u),e-=B.offsetWidth):h===0?(c.insertBefore(B,c.firstChild),e-=B.offsetWidth):(l=(0,a.td)("."+pn,f.popObj.element).length,c.insertBefore(B,c.children[h+u-l]),e-=B.offsetWidth),B.style.height=""}else return"break"},f=this,g=0,C=[].slice.call(i.children);g<C.length;g++){var L=C[g],D=p(L);if(D==="break")break}var R=this.checkOverflow(this.element,this.element.getElementsByClassName(Si)[0]);R&&!r&&this.renderOverflowMode()},t.prototype.removePositioning=function(){var e=this.element.querySelector("."+Si);if(!((0,a.le)(e)||!e.classList.contains(dn))){this.remove(e,dn);var i=[].slice.call(e.childNodes);i[1].removeAttribute("style"),i[2].removeAttribute("style")}},t.prototype.refreshPositioning=function(){var e=this.element.querySelector("."+Si);this.add(e,dn),this.itemPositioning()},t.prototype.itemPositioning=function(){var e=this.element.querySelector("."+Si),i;if(!((0,a.le)(e)||!e.classList.contains(dn))){var r=this.element.querySelector("."+Cr),n;if(this.scrollModule){var s=this.isVertical?uy:cy;n=[].slice.call(e.querySelector("."+s).children)}else n=[].slice.call(e.childNodes);this.isVertical?i=n[0].offsetHeight+n[2].offsetHeight:i=n[0].offsetWidth+n[2].offsetWidth;var l=this.isVertical?this.element.offsetHeight:this.element.offsetWidth;if(r){l-=this.isVertical?r.offsetHeight:r.offsetWidth;var h=(this.isVertical?r.offsetHeight:r.offsetWidth)+"px";n[2].removeAttribute("style"),this.isVertical?this.enableRtl?n[2].style.top=h:n[2].style.bottom=h:this.enableRtl?n[2].style.left=h:n[2].style.right=h}if(!(l<=i)){var c=(l-i-(this.isVertical?n[1].offsetHeight:n[1].offsetWidth))/2;n[1].removeAttribute("style");var u=(this.isVertical?n[0].offsetHeight:n[0].offsetWidth)+c+"px";this.isVertical?this.enableRtl?n[1].style.marginBottom=u:n[1].style.marginTop=u:this.enableRtl?n[1].style.marginRight=u:n[1].style.marginLeft=u}}},t.prototype.tbarItemAlign=function(e,i,r){var n=this;if(!(e.showAlwaysInPopup&&e.overflow!=="Show")){var s=[];if(s.push(this.createElement("div",{className:hy})),s.push(this.createElement("div",{className:Sf})),s.push(this.createElement("div",{className:ly})),r===0&&e.align!=="Left")s.forEach(function(c){i.appendChild(c)}),this.tbarAlign=!0,this.add(i,dn);else if(e.align!=="Left"){var l=i.childNodes,h=s[0];[].slice.call(l).forEach(function(c){n.tbarAlgEle.lefts.push(c),h.appendChild(c)}),i.appendChild(h),i.appendChild(s[1]),i.appendChild(s[2]),this.tbarAlign=!0,this.add(i,dn)}}},t.prototype.ctrlTemplate=function(){var e=this;this.ctrlTem=this.trgtEle.cloneNode(!0),this.add(this.trgtEle,Si),this.tbarEle=[];var i=[].slice.call(this.trgtEle.children);i.forEach(function(r){r.tagName==="DIV"&&(e.tbarEle.push(r),r.setAttribute("aria-disabled","false"),e.add(r,ji))})},t.prototype.renderItems=function(){var e=this.element,i=this.items;if(this.trgtEle!=null)this.ctrlTemplate();else if(e&&i.length>0){var r=void 0;e&&e.children.length>0&&(r=e.querySelector("."+Si)),r||(r=this.createElement("div",{className:Si})),this.itemsAlign(i,r),e.appendChild(r)}},t.prototype.setAttr=function(e,i){for(var r=Object.keys(e),n,s=0;s<r.length;s++)n=r[s],n==="class"?this.add(i,e[n]):i.setAttribute(n,e[n])},t.prototype.enableItems=function(e,i){var r=e,n=r.length,s;(0,a.le)(i)&&(i=!0);var l=function(p,f){p?(f.classList.remove(un),f.setAttribute("aria-disabled","false")):(f.classList.add(un),f.setAttribute("aria-disabled","true"))};if(!(0,a.le)(n)&&n>=1){for(var h=0,c=[].slice.call(r);h<n;h++){var u=c[h];if(typeof u=="number"){if(s=this.getElementByIndex(u),(0,a.le)(s))return;r[h]=s}else s=u;l(i,s)}i?(0,a.IV)(r,un):(0,a.cn)(r,un)}else{if(typeof r=="number"){if(s=this.getElementByIndex(r),(0,a.le)(s))return}else s=e;l(i,s)}},t.prototype.getElementByIndex=function(e){return this.tbarEle[e]?this.tbarEle[e]:null},t.prototype.addItems=function(e,i){var r;this.extendedOpen();var n=this.element.querySelector("."+Si);if((0,a.le)(n)){this.itemsRerender(e);return}var s,l="Left";(0,a.le)(i)&&(i=0),e.forEach(function(g){!(0,a.le)(g.align)&&g.align!=="Left"&&l==="Left"&&(l=g.align)});for(var h=0,c=e;h<c.length;h++){var u=c[h];if((0,a.le)(u.type)&&(u.type="Button"),r=(0,a.td)("."+ji,this.element),u.align=l,s=this.renderSubComponent(u,i),this.tbarEle.length>=i&&r.length>=0){(0,a.le)(this.scrollModule)&&this.destroyMode();var p=u.align[0]==="L"?0:u.align[0]==="C"?1:2,f=void 0;!this.tbarAlign&&l!=="Left"?(this.tbarItemAlign(u,n,1),this.tbarAlign=!0,f=(0,a.oq)(r[0],"."+Si).children[p],f.appendChild(s),this.tbarAlgEle[(u.align+"s").toLowerCase()].push(s),this.refreshPositioning()):this.tbarAlign?(f=(0,a.oq)(r[0],"."+Si).children[p],f.insertBefore(s,f.children[i]),this.tbarAlgEle[(u.align+"s").toLowerCase()].splice(i,0,s),this.refreshPositioning()):r.length===0?(r=(0,a.td)("."+Si,this.element),r[0].appendChild(s)):r[0].parentNode.insertBefore(s,r[i]),this.items.splice(i,0,u),u.template&&this.tbarEle.splice(this.tbarEle.length-1,1),this.tbarEle.splice(i,0,s),i++,this.offsetWid=n.offsetWidth}}n.style.width="",this.renderOverflowMode(),this.isReact&&this.renderReactTemplates()},t.prototype.removeItems=function(e){var i=e,r,n=[].slice.call((0,a.td)("."+ji,this.element));if(typeof i=="number")r=parseInt(e.toString(),10),this.removeItemByIndex(r,n);else if(i&&i.length>1)for(var s=0,l=[].slice.call(i);s<l.length;s++){var h=l[s];r=this.tbarEle.indexOf(h),this.removeItemByIndex(r,n),n=(0,a.td)("."+ji,this.element)}else{var h=i&&i.length&&i.length===1?i[0]:e;r=n.indexOf(h),this.removeItemByIndex(r,n)}this.resize()},t.prototype.removeItemByIndex=function(e,i){if(this.tbarEle[e]&&i[e]){var r=this.tbarEle.indexOf(i[e]);if(this.tbarAlign){var n=this.tbarAlgEle[(this.items[r].align+"s").toLowerCase()].indexOf(this.tbarEle[r]);this.tbarAlgEle[(this.items[r].align+"s").toLowerCase()].splice(n,1)}this.isReact&&this.clearTemplate();var s=i[e].querySelector(".e-control.e-btn");!(0,a.le)(s)&&!(0,a.le)(s.ej2_instances[0])&&!s.ej2_instances[0].isDestroyed&&s.ej2_instances[0].destroy(),(0,a.og)(i[e]),this.items.splice(r,1),this.tbarEle.splice(r,1)}},t.prototype.templateRender=function(e,i,r,n){var s=r.type,l=e,h;if(typeof e=="object"&&(h=typeof l.appendTo=="function"),typeof e=="string"||!h){var c=void 0,u=e,p=new RegExp(/<(?=.*? .*?\/ ?>|br|hr|input|!--|wbr)[a-z]+.*?>|<([a-z]+).*?<\/\1>/i);u=typeof e=="string"?e.trim():e;try{if(typeof e=="object"&&!(0,a.le)(e.tagName))i.appendChild(e);else if(typeof e=="string"&&p.test(u))i.innerHTML=u;else if(document.querySelectorAll(u).length){var f=document.querySelector(u),g=f.outerHTML.trim();i.appendChild(f),f.style.display="",(0,a.le)(g)||this.tempId.push(u)}else c=(0,a.MY)(u)}catch(D){c=(0,a.MY)(u)}var C=void 0;if(!(0,a.le)(c)){var L=this.element.id+n+"_template";C=c({},this,"template",L,this.isStringTemplate)}!(0,a.le)(C)&&C.length>0&&[].slice.call(C).forEach(function(D){(0,a.le)(D.tagName)||(D.style.display=""),i.appendChild(D)})}else if(s==="Input"){var f=this.createElement("input");r.id?f.id=r.id:f.id=(0,a.QI)("tbr-ipt"),i.appendChild(f),l.appendTo(f)}this.add(i,yf),this.tbarEle.push(i)},t.prototype.buttonRendering=function(e,i){var r=this.createElement("button",{className:oy});r.setAttribute("type","button");var n=e.text,s,l;e.id?r.id=e.id:r.id=(0,a.QI)("e-tbr-btn");var h=this.createElement("span",{className:"e-tbar-btn-text"});n?(h.innerHTML=this.enableHtmlSanitizer?a.pJ.sanitize(n):n,r.appendChild(h),r.classList.add("e-tbtn-txt")):this.add(i,"e-tbtn-align"),(e.prefixIcon||e.suffixIcon)&&(e.prefixIcon&&e.suffixIcon||e.prefixIcon?(s=e.prefixIcon+" e-icons",l="Left"):(s=e.suffixIcon+" e-icons",l="Right"));var c=new $r({iconCss:s,iconPosition:l});return c.createElement=this.createElement,c.appendTo(r),e.width&&(0,a.V7)(r,{width:(0,a.Ac)(e.width)}),r},t.prototype.renderSubComponent=function(e,i){var r,n=this.createElement("div",{className:ji});n.setAttribute("aria-disabled","false");var s=this.createElement("div",{innerHTML:this.enableHtmlSanitizer?a.pJ.sanitize(e.tooltipText):e.tooltipText});if(this.tbarEle||(this.tbarEle=[]),e.htmlAttributes&&this.setAttr(e.htmlAttributes,n),e.tooltipText&&n.setAttribute("title",s.textContent),e.cssClass&&(n.className=n.className+" "+e.cssClass),e.template)this.templateRender(e.template,n,e,i);else switch(e.type){case"Button":r=this.buttonRendering(e,n),r.setAttribute("tabindex","-1"),r.setAttribute("aria-label",e.text||e.tooltipText),n.appendChild(r),n.addEventListener("click",this.itemClick.bind(this));break;case"Separator":this.add(n,Fi);break}if(e.showTextOn){var l=e.showTextOn;l==="Toolbar"?(this.add(n,bf),this.add(n,"e-tbtn-align")):l==="Overflow"&&this.add(n,au)}if(e.overflow){var h=e.overflow;h==="Show"?this.add(n,pn):h==="Hide"&&(n.classList.contains(Fi)||this.add(n,$l))}return e.overflow!=="Show"&&e.showAlwaysInPopup&&!n.classList.contains(Fi)&&(this.add(n,ou),this.popupPriCount++),e.disabled&&this.add(n,un),e.visible===!1&&this.add(n,Fo),n},t.prototype.itemClick=function(e){this.activeEleSwitch(e.currentTarget)},t.prototype.activeEleSwitch=function(e){this.activeEleRemove(e.firstElementChild),this.activeEle.focus()},t.prototype.activeEleRemove=function(e){(0,a.le)(this.activeEle)||this.activeEle.setAttribute("tabindex","-1"),this.activeEle=e,(0,a.le)(this.trgtEle)&&!e.parentElement.classList.contains(yf)?e.removeAttribute("tabindex"):this.activeEle.setAttribute("tabindex","0")},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.getModuleName=function(){return"toolbar"},t.prototype.itemsRerender=function(e){this.items=this.tbarItemsCol,(this.isReact||this.isAngular)&&this.clearTemplate(),this.destroyMode(),this.destroyItems(),this.items=e,this.tbarItemsCol=this.items,this.renderItems(),this.renderOverflowMode(),this.isReact&&this.renderReactTemplates()},t.prototype.resize=function(){var e=this.element;this.tbResize=!0,this.tbarAlign&&this.itemPositioning(),this.popObj&&this.overflowMode==="Popup"&&this.popObj.hide();var i=this.checkOverflow(e,e.getElementsByClassName(Si)[0]);if(!i){this.destroyScroll();var r=e.querySelector("."+Si);(0,a.le)(r)||(this.remove(r,Ef),this.tbarAlign&&this.add(r,dn))}if(!(i&&this.scrollModule&&this.offsetWid===e.offsetWidth)){if((this.offsetWid>e.offsetWidth||i)&&this.renderOverflowMode(),this.popObj){if(this.overflowMode==="Extended"){var n=window.getComputedStyle(this.element);this.popObj.width=parseFloat(n.width)+parseFloat(n.borderRightWidth)*2}this.tbarAlign&&this.removePositioning(),this.popupRefresh(this.popObj.element,!1),this.tbarAlign&&this.refreshPositioning()}this.element.querySelector("."+wf)&&(this.scrollStep=this.element.querySelector("."+wf).offsetWidth),this.offsetWid=e.offsetWidth,this.tbResize=!1,this.separator()}},t.prototype.extendedOpen=function(){var e=this.element.querySelector("."+Ql);this.overflowMode==="Extended"&&e&&(this.isExtendedOpen=e.classList.contains(gf))},t.prototype.onPropertyChanged=function(e,i){var r=this.element,n=r.offsetWidth;this.extendedOpen();for(var s=0,l=Object.keys(e);s<l.length;s++){var h=l[s];switch(h){case"items":if(e.items instanceof Array&&i.items instanceof Array)this.itemsRerender(e.items);else for(var c=Object.keys(e.items),u=0;u<c.length;u++){var p=parseInt(Object.keys(e.items)[u],10),f=Object.keys(e.items[p])[0],g=Object(e.items[p])[f];if(typeof g!="function"){if(this.tbarAlign||f==="align"){this.refresh(),this.trigger("created");break}var C=f==="showAlwaysInPopup"&&!g,L=f==="overflow"&&this.popupPriCount!==0;(C||this.items[p].showAlwaysInPopup&&L)&&--this.popupPriCount,(0,a.le)(this.scrollModule)&&this.destroyMode();var D=[].slice.call((0,a.td)("."+Si+" ."+ji,r));this.isReact&&this.clearTemplate(),(0,a.og)(D[p]),this.tbarEle.splice(p,1),this.addItems([this.items[p]],p),this.items.splice(p,1),this.items[p].template&&this.tbarEle.splice(this.items.length,1)}}break;case"width":(0,a.V7)(r,{width:(0,a.Ac)(e.width)}),this.renderOverflowMode(),this.popObj&&n<r.offsetWidth&&this.popupRefresh(this.popObj.element,!1);break;case"height":(0,a.V7)(this.element,{height:(0,a.Ac)(e.height)});break;case"overflowMode":this.destroyMode(),this.renderOverflowMode(),this.enableRtl&&this.add(r,En),this.refreshOverflow();break;case"enableRtl":e.enableRtl?this.add(r,En):this.remove(r,En),(0,a.le)(this.scrollModule)||(e.enableRtl?this.add(this.scrollModule.element,En):this.remove(this.scrollModule.element,En)),(0,a.le)(this.popObj)||(e.enableRtl?this.add(this.popObj.element,En):this.remove(this.popObj.element,En)),this.tbarAlign&&this.itemPositioning();break;case"scrollStep":this.scrollModule&&(this.scrollModule.scrollStep=this.scrollStep);break;case"enableCollision":this.popObj&&(this.popObj.collision={Y:this.enableCollision?"flip":"none"});break;case"cssClass":i.cssClass&&(0,a.IV)([this.element],i.cssClass.split(" ")),e.cssClass&&(0,a.cn)([this.element],e.cssClass.split(" "));break;case"allowKeyboard":this.unwireKeyboardEvent(),e.allowKeyboard&&this.wireKeyboardEvent();break}}},t.prototype.hideItem=function(e,i){var r=typeof e=="object",n=e,s,l,h=[].slice.call((0,a.td)("."+ji,this.element));if(r)l=e;else if(this.tbarEle[n]){var c=[].slice.call((0,a.td)("."+ji,this.element));l=c[n]}if(l){if(i?l.classList.add(Fo):l.classList.remove(Fo),i&&(0,a.le)(this.element.getAttribute("tabindex"))&&!l.classList.contains(Fi)){if((0,a.le)(l.firstElementChild.getAttribute("tabindex"))){l.firstElementChild.setAttribute("tabindex","-1");var u=[].slice.call((0,a.td)("."+ji,this.element));r&&(n=u.indexOf(l));for(var p=u[++n];p;){var f=this.eleContains(p);if(!f){p.firstElementChild.removeAttribute("tabindex");break}p=u[++n]}}}else if((0,a.le)(this.element.getAttribute("tabindex"))&&!l.classList.contains(Fi)){s=0;for(var g=!1,C=!1,L=h[s];L;)if(L.classList.contains(Fi))L=h[++s];else if((0,a.le)(L.firstElementChild.getAttribute("tabindex")))L.firstElementChild.setAttribute("tabindex","-1"),g=!0;else{if(g&&C)break;var f=this.eleContains(L);f||(L.firstElementChild.removeAttribute("tabindex"),C=!0),L=h[++s]}}this.refreshOverflow()}},hi([(0,a.FE)([],uu)],t.prototype,"items",void 0),hi([(0,a.Z9)("auto")],t.prototype,"width",void 0),hi([(0,a.Z9)("auto")],t.prototype,"height",void 0),hi([(0,a.Z9)("")],t.prototype,"cssClass",void 0),hi([(0,a.Z9)("Scrollable")],t.prototype,"overflowMode",void 0),hi([(0,a.Z9)()],t.prototype,"scrollStep",void 0),hi([(0,a.Z9)(!0)],t.prototype,"enableCollision",void 0),hi([(0,a.Z9)(!0)],t.prototype,"enableHtmlSanitizer",void 0),hi([(0,a.Z9)(!0)],t.prototype,"allowKeyboard",void 0),hi([(0,a.ju)()],t.prototype,"clicked",void 0),hi([(0,a.ju)()],t.prototype,"created",void 0),hi([(0,a.ju)()],t.prototype,"destroyed",void 0),hi([(0,a.ju)()],t.prototype,"beforeCreate",void 0),t=hi([a.Zl],t),t}(a.wA),Vo=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ht=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},zn="e-tab",nr="e-tab-header",vy="blazor-template",Ut="e-content",Jl="e-nested",my="e-items",Wi="e-item",pu="e-template",du="e-rtl",Qt="e-active",ys="e-disable",vi="e-hidden",fu="e-focused",vu="e-icons",mu="e-icon",Tf="e-icon-tab",gu="e-close-icon",eh="e-close-show",th="e-tab-text",Fa="e-indicator",Jr="e-tab-wrap",ih="e-text-wrap",Lf="e-tab-icon",Or="e-toolbar-items",jt="e-toolbar-item",kf="e-toolbar-pop",_n="e-toolbar-popup",gy="e-hor-nav",yy="e-popup-open",by="e-popup-close",rh="e-progress",If="e-ignore",yu="e-overlay",Cy="e-hscroll-content",Sy="e-vscroll-content",bu="e-vertical-tab",Cu="e-vertical",Df="e-vertical-left",Of="e-vertical-right",Rf="e-horizontal-bottom",Su="e-fill-mode",Mf="tabitem_",wu="e-reorder-active-item",Pf=function(o){Vo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ht([(0,a.Z9)("SlideLeftIn")],t.prototype,"effect",void 0),Ht([(0,a.Z9)(600)],t.prototype,"duration",void 0),Ht([(0,a.Z9)("ease")],t.prototype,"easing",void 0),t}(a.rt),wy=function(o){Vo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ht([(0,a.Zz)({effect:"SlideLeftIn",duration:600,easing:"ease"},Pf)],t.prototype,"previous",void 0),Ht([(0,a.Zz)({effect:"SlideRightIn",duration:600,easing:"ease"},Pf)],t.prototype,"next",void 0),t}(a.rt),xy=function(o){Vo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ht([(0,a.Z9)("")],t.prototype,"text",void 0),Ht([(0,a.Z9)("")],t.prototype,"iconCss",void 0),Ht([(0,a.Z9)("left")],t.prototype,"iconPosition",void 0),t}(a.rt),Ey=function(o){Vo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ht([(0,a.Zz)({},xy)],t.prototype,"header",void 0),Ht([(0,a.Z9)(null)],t.prototype,"headerTemplate",void 0),Ht([(0,a.Z9)("")],t.prototype,"content",void 0),Ht([(0,a.Z9)("")],t.prototype,"cssClass",void 0),Ht([(0,a.Z9)(!1)],t.prototype,"disabled",void 0),Ht([(0,a.Z9)(!0)],t.prototype,"visible",void 0),Ht([(0,a.Z9)()],t.prototype,"id",void 0),t}(a.rt),xu=function(o){Vo(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.show={},r.hide={},r.maxHeight=0,r.title="Close",r.isInteracted=!1,r.lastIndex=0,r.isAdd=!1,r.isIconAlone=!1,r.draggableItems=[],r.resizeContext=r.refreshActiveTabBorder.bind(r),r.keyConfigs={tab:"tab",home:"home",end:"end",enter:"enter",space:"space",delete:"delete",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",moveDown:"downarrow"},r}return t.prototype.destroy=function(){var e=this;if((this.isReact||this.isAngular)&&this.clearTemplate(),(0,a.le)(this.tbObj)||(this.tbObj.destroy(),this.tbObj=null),this.unWireEvents(),["role","aria-disabled","aria-activedescendant","tabindex","aria-orientation","aria-owns"].forEach(function(n){e.element.removeAttribute(n)}),this.expTemplateContent(),this.isTemplate){var i=(0,a.Ys)("."+zn+" > ."+Ut,this.element);this.element.classList.remove(pu),(0,a.le)(i)||(i.innerHTML=this.cnt)}else for(;this.element.firstElementChild;)(0,a.Od)(this.element.firstElementChild);if(this.btnCls&&(this.btnCls=null),this.hdrEle=null,this.cntEle=null,this.tbItems=null,this.tbItem=null,this.tbPop=null,this.prevItem=null,this.popEle=null,this.bdrLine=null,this.content=null,this.dragItem=null,this.cloneElement=null,this.draggingItems=[],this.draggableItems&&this.draggableItems.length>0){for(var r=0;r<this.draggableItems.length;r++)this.draggableItems[r].destroy(),this.draggableItems[r]=null;this.draggableItems=[]}o.prototype.destroy.call(this),this.trigger("destroyed")},t.prototype.refresh=function(){this.isReact&&this.clearTemplate(),o.prototype.refresh.call(this),this.isReact&&this.renderReactTemplates()},t.prototype.preRender=function(){var e=(0,a.oq)(this.element,"."+Ut);this.prevIndex=0,this.isNested=!1,this.isPopup=!1,this.initRender=!0,this.isSwipeed=!1,this.itemIndexArray=[],this.templateEle=[],this.allowDragAndDrop&&(this.dragArea=(0,a.le)(this.dragArea)?"#"+this.element.id+" "+("."+nr):this.dragArea),(0,a.le)(e)||(e.parentElement.classList.add(Jl),this.isNested=!0);var i=a.AR.info.name,r=i==="msie"?"e-ie":i==="edge"?"e-edge":i==="safari"?"e-safari":"";(0,a.V7)(this.element,{width:(0,a.Ac)(this.width),height:(0,a.Ac)(this.height)}),this.setCssClass(this.element,this.cssClass,!0),(0,a.Y4)(this.element,{role:"tablist","aria-disabled":"false","aria-activedescendant":"","aria-owns":this.element.id+"_tab_header_items"}),this.setCssClass(this.element,r,!0),this.updatePopAnimationConfig()},t.prototype.render=function(){this.btnCls=this.createElement("span",{className:vu+" "+gu,attrs:{title:this.title}}),this.tabId=this.element.id.length>0?"-"+this.element.id:(0,a.wm)(),this.renderContainer(),this.wireEvents(),this.initRender=!1},t.prototype.renderContainer=function(){var e=this.element;if(this.items.forEach(function(l,h){(0,a.le)(l.id)&&!(0,a.le)(l.setProperties)&&l.setProperties({id:Mf+h.toString()},!0)}),this.items.length>0&&e.children.length===0)e.appendChild(this.createElement("div",{className:Ut})),this.setOrientation(this.headerPlacement,this.createElement("div",{className:nr})),this.isTemplate=!1;else if(this.element.children.length>0){this.isTemplate=!0,e.classList.add(pu);var i=e.querySelector("."+nr);i&&this.headerPlacement==="Bottom"&&this.setOrientation(this.headerPlacement,i)}if(!(0,a.le)((0,a.Ys)("."+nr,this.element))&&!(0,a.le)((0,a.Ys)("."+Ut,this.element))){if(this.renderHeader(),this.tbItems=(0,a.Ys)("."+nr+" ."+Or,this.element),(0,a.le)(this.tbItems)||(0,a.qx)(this.tbItems,{selector:".e-tab-wrap"}),this.renderContent(),(0,a.td)("."+jt,this.element).length>0){this.tbItems=(0,a.Ys)("."+nr+" ."+Or,this.element),this.bdrLine=this.createElement("div",{className:Fa+" "+vi+" "+If});var r=(0,a.Ys)("."+this.scrCntClass,this.tbItems);(0,a.le)(r)?this.tbItems.insertBefore(this.bdrLine,this.tbItems.firstChild):r.insertBefore(this.bdrLine,r.firstChild),this.setContentHeight(!0),this.select(this.selectedItem)}if(!(0,a.le)(this.tbItem))for(var n=0;n<this.items.length;n++){var s=this.items[n].id;this.tbItem[n].setAttribute("data-id",s)}this.setRTL(this.enableRtl)}},t.prototype.serverItemsChanged=function(){if(this.enableAnimation=!1,this.setActive(this.selectedItem,!0),this.loadOn!=="Dynamic"&&!(0,a.le)(this.cntEle)){var e=[].slice.call(this.cntEle.children),i=Ut+this.tabId+"_"+this.selectedItem;e.forEach(function(r){r.classList.contains(Qt)&&r.id!==i&&r.classList.remove(Qt),r.id===i&&r.classList.add(Qt)}),this.prevIndex=this.selectedItem,this.triggerAnimation(Wi+this.tabId+"_"+this.selectedItem,!1)}this.enableAnimation=!0},t.prototype.headerReady=function(){if(this.initRender=!0,this.hdrEle=this.getTabHeader(),this.setOrientation(this.headerPlacement,this.hdrEle),(0,a.le)(this.hdrEle)||(this.tbObj=this.hdrEle&&this.hdrEle.ej2_instances[0]),this.tbObj.clicked=this.clickHandler.bind(this),this.tbObj.on("onItemsChanged",this.serverItemsChanged.bind(this)),this.tbItems=(0,a.Ys)("."+nr+" ."+Or,this.element),(0,a.le)(this.tbItems)||(0,a.qx)(this.tbItems,{selector:".e-tab-wrap"}),(0,a.td)("."+jt,this.element).length>0){this.bdrLine=(0,a.Ys)("."+Fa+"."+If,this.element);var e=(0,a.Ys)("."+this.scrCntClass,this.tbItems);(0,a.le)(e)?this.tbItems.insertBefore(this.bdrLine,this.tbItems.firstElementChild):e.insertBefore(this.bdrLine,e.firstElementChild),this.select(this.selectedItem)}if(this.cntEle=(0,a.Ys)("."+zn+" > ."+Ut,this.element),(0,a.le)(this.cntEle)||(this.touchModule=new a.Xh(this.cntEle,{swipe:this.swipeHandler.bind(this)})),this.loadOn==="Demand"){var i=this.setActiveContent();this.triggerAnimation(i,!1)}this.initRender=!1,this.renderComplete()},t.prototype.setActiveContent=function(){var e=Wi+this.tabId+"_"+this.selectedItem,i=this.getTrgContent(this.cntEle,this.extIndex(e));return(0,a.le)(i)||i.classList.add(Qt),e},t.prototype.renderHeader=function(){var e=this,i=this.headerPlacement,r=[];if(this.hdrEle=this.getTabHeader(),this.addVerticalClass(),!this.isTemplate)r=this.parseObject(this.items,0);else{this.element.children.length>1&&this.element.children[1].classList.contains(nr)&&this.setProperties({headerPlacement:"Bottom"},!0);for(var n=this.hdrEle.children.length,s=[],l=0;l<n;l++)s.push(this.hdrEle.children.item(l).innerHTML);if(n>0){for(;this.hdrEle.firstElementChild;)(0,a.og)(this.hdrEle.firstElementChild);var h=this.createElement("div",{className:my});this.hdrEle.appendChild(h),s.forEach(function(u,p){e.lastIndex=p;var f={className:Wi,id:Wi+e.tabId+"_"+p,attrs:{role:"tab","aria-controls":Ut+e.tabId+"_"+p,"aria-selected":"false"}},g=e.createElement("span",{className:th,innerHTML:u,attrs:{role:"presentation"}}).outerHTML,C=e.createElement("div",{className:ih,innerHTML:g+e.btnCls.outerHTML}).outerHTML,L=e.createElement("div",{className:Jr,innerHTML:C,attrs:{tabIndex:"-1"}});h.appendChild(e.createElement("div",f)),(0,a.td)("."+Wi,h)[p].appendChild(L)})}}this.tbObj=new Ho({width:i==="Left"||i==="Right"?"auto":"100%",height:i==="Left"||i==="Right"?"100%":"auto",overflowMode:this.overflowMode,items:r.length!==0?r:[],clicked:this.clickHandler.bind(this),scrollStep:this.scrollStep,enableHtmlSanitizer:this.enableHtmlSanitizer}),this.tbObj.isStringTemplate=!0,this.tbObj.createElement=this.createElement,this.tbObj.appendTo(this.hdrEle),(0,a.Y4)(this.hdrEle,{"aria-label":"tab-header"}),this.updateOrientationAttribute(),this.setCloseButton(this.showCloseButton);var c=this.tbObj.element.querySelector("."+Or);(0,a.le)(c)||(c.id=this.element.id+"_tab_header_items")},t.prototype.renderContent=function(){this.cntEle=(0,a.Ys)("."+Ut,this.element);var e=(0,a.td)("."+jt,this.element);if(this.isTemplate){this.cnt=this.cntEle.children.length>0?this.cntEle.innerHTML:"";for(var i=this.cntEle.children,r=0;r<e.length;r++)i.length-1>=r&&((0,a.cn)([i.item(r)],Wi),(0,a.Y4)(i.item(r),{role:"tabpanel","aria-labelledby":Wi+this.tabId+"_"+r}),i.item(r).id=Ut+this.tabId+"_"+r)}},t.prototype.reRenderItems=function(){this.renderContainer(),(0,a.le)(this.cntEle)||(this.touchModule=new a.Xh(this.cntEle,{swipe:this.swipeHandler.bind(this)}))},t.prototype.parseObject=function(e,i){var r=this,n=(0,a.td)(".e-tab-header ."+jt,this.element),s=this.lastIndex;if(!this.isReplace&&n.length>0){var l=[];n.forEach(function(f){l.push(parseInt(f.id.slice(f.id.indexOf("_")+1),10))}),s=Math.max.apply(Math,l)}var h=[],c,u=[],p=0;return e.forEach(function(f,g){var C=(0,a.le)(f.header)||(0,a.le)(f.header.iconPosition)?"":f.header.iconPosition,L=(0,a.le)(f.header)||(0,a.le)(f.header.iconCss)?"":f.header.iconCss;if((0,a.le)(f.headerTemplate)&&((0,a.le)(f.header)||(0,a.le)(f.header.text)||f.header.text.length===0&&L==="")){u.push(g);return}var D=f.headerTemplate||f.header.text;typeof D=="string"&&r.enableHtmlSanitizer&&(D=a.pJ.sanitize(D));var R;if(r.isReplace&&!(0,a.le)(r.tbId)&&r.tbId!==""){var B=r.tbId.indexOf("_");R=parseInt(r.tbId.substring(B+1),10),r.tbId=""}else R=i+g;r.lastIndex=n.length===0?g:r.isReplace?R:s+1+g;var H=f.disabled?" "+ys+" "+yu:"",j=f.visible===!1?" "+vi:"";c=r.createElement("div",{className:th,attrs:{role:"presentation"}});var W=D instanceof Object?D.outerHTML:D,ne=!(0,a.le)(W)&&W!=="";(0,a.le)(D.tagName)?r.headerTextCompile(c,D,g):c.appendChild(D);var ie,me=r.createElement("span",{className:vu+" "+Lf+" "+mu+"-"+C+" "+L}),ve=r.createElement("div",{className:ih});ve.appendChild(c),D!==""&&D!==void 0&&L!==""?(C==="left"||C==="top"?ve.insertBefore(me,ve.firstElementChild):ve.appendChild(me),ie=c,r.isIconAlone=!1):(ie=L===""?c:me,ie===me&&((0,a.og)(c),ve.appendChild(me),r.isIconAlone=!0));var Ee=f.disabled?{}:{tabIndex:"-1"};ve.appendChild(r.btnCls.cloneNode(!0));var le=r.createElement("div",{className:Jr,attrs:Ee});le.appendChild(ve),r.itemIndexArray===[]?r.itemIndexArray.push(Wi+r.tabId+"_"+r.lastIndex):r.itemIndexArray.splice(i+g,0,Wi+r.tabId+"_"+r.lastIndex);var de={id:Wi+r.tabId+"_"+r.lastIndex,role:"tab","aria-selected":"false"},fe={htmlAttributes:de,template:le};fe.cssClass=(f.cssClass!==void 0?f.cssClass:" ")+" "+H+" "+j+" "+(L!==""?"e-i"+C:"")+" "+(ne?"":mu),(C==="top"||C==="bottom")&&r.element.classList.add("e-vertical-icon"),h.push(fe),g++}),this.isAdd||u.forEach(function(f){r.items.splice(f,1)}),this.isIconAlone?this.element.classList.add(Tf):this.element.classList.remove(Tf),h},t.prototype.removeActiveClass=function(){var e=this.getTabHeader();if(e){var i=(0,a.td)("."+jt+"."+Qt,e);[].slice.call(i).forEach(function(r){return r.classList.remove(Qt)})}},t.prototype.checkPopupOverflow=function(e){this.tbPop=(0,a.Ys)("."+kf,this.element);var i=(0,a.Ys)(".e-hor-nav",this.element),r=(0,a.Ys)("."+Or,this.element),n=r.lastChild,s=!1;return(!this.isVertical()&&(this.enableRtl&&i.offsetLeft+i.offsetWidth>r.offsetLeft||!this.enableRtl&&i.offsetLeft<r.offsetWidth)||this.isVertical()&&i.offsetTop<n.offsetTop+n.offsetHeight)&&(s=!0),s&&(e.classList.add(_n),this.tbPop.insertBefore(e,(0,a.td)("."+_n,this.tbPop)[0])),!0},t.prototype.popupHandler=function(e){var i=e.querySelector(".e-ripple-element");(0,a.le)(i)||(i.outerHTML="",e.querySelector("."+Jr).classList.remove("e-ripple")),this.tbItem=(0,a.td)("."+Or+" ."+jt,this.hdrEle);var r=this.tbItem[this.tbItem.length-1];if(this.tbItem.length!==0){if(e.classList.remove(_n),e.removeAttribute("style"),this.tbItems.appendChild(e),this.actEleId=e.id,this.checkPopupOverflow(r)){var n=this.tbItems.lastChild.previousElementSibling;this.checkPopupOverflow(n)}this.isPopup=!0}return(0,a.td)("."+jt,this.tbItems).length-1},t.prototype.updateOrientationAttribute=function(){(0,a.Y4)(this.element,{"aria-orientation":this.isVertical()?"vertical":"horizontal"})},t.prototype.setCloseButton=function(e){var i=(0,a.Ys)("."+nr,this.element);e===!0?i.classList.add(eh):i.classList.remove(eh),this.tbObj.refreshOverflow(),this.refreshActiveTabBorder()},t.prototype.prevCtnAnimation=function(e,i){var r,n=this.enableRtl||this.element.classList.contains(du);return this.isPopup||e<=i?this.animation.previous.effect==="SlideLeftIn"?r={name:"SlideLeftOut",duration:this.animation.previous.duration,timingFunction:this.animation.previous.easing}:r=null:this.animation.next.effect==="SlideRightIn"?r={name:"SlideRightOut",duration:this.animation.next.duration,timingFunction:this.animation.next.easing}:r=null,r},t.prototype.triggerPrevAnimation=function(e,i){var r=this,n=this.prevCtnAnimation(i,this.selectedItem);(0,a.le)(n)?e.classList.remove(Qt):(n.begin=function(){(0,a.V7)(e,{position:"absolute"}),e.classList.add(rh),e.classList.add("e-view")},n.end=function(){e.style.display="none",e.classList.remove(Qt),e.classList.remove(rh),e.classList.remove("e-view"),(0,a.V7)(e,{display:"",position:""}),e.childNodes.length===0&&!r.isTemplate&&(0,a.og)(e)},new a.fw(n).animate(e))},t.prototype.triggerAnimation=function(e,i){var r=this,n=this.prevIndex,s,l=[].slice.call(this.element.querySelector("."+Ut).children);l.forEach(function(L){L.id===r.prevActiveEle&&(s=L)});var h=this.tbItem[n],c=this.getTrgContent(this.cntEle,this.extIndex(e));if((0,a.le)(s)&&!(0,a.le)(h)){var u=this.extIndex(h.id);s=this.getTrgContent(this.cntEle,u)}if((0,a.le)(c)||(this.prevActiveEle=c.id),this.initRender||i===!1||this.animation==={}||(0,a.le)(this.animation)){s&&s!==c&&s.classList.remove(Qt);return}var p=(0,a.Ys)("."+Ut,this.element),f;if(this.prevIndex>this.selectedItem&&!this.isPopup){var g=this.animation.previous.effect;f={name:g==="None"?"":g!=="SlideLeftIn"?g:"SlideLeftIn",duration:this.animation.previous.duration,timingFunction:this.animation.previous.easing}}else if(this.isPopup||this.prevIndex<this.selectedItem||this.prevIndex===this.selectedItem){var C=this.animation.next.effect;f={name:C==="None"?"":C!=="SlideRightIn"?C:"SlideRightIn",duration:this.animation.next.duration,timingFunction:this.animation.next.easing}}f.progress=function(){p.classList.add(rh),r.setActiveBorder()},f.end=function(){p.classList.remove(rh),c.classList.add(Qt)},!this.initRender&&!(0,a.le)(s)&&this.triggerPrevAnimation(s,n),this.isPopup=!1,f.name===""?c.classList.add(Qt):new a.fw(f).animate(c)},t.prototype.keyPressed=function(e){var i=(0,a.oq)(e,"."+nr+" ."+jt),r=this.getEleIndex(i);!(0,a.le)(this.popEle)&&e.classList.contains("e-hor-nav")?this.popEle.classList.contains(yy)?this.popObj.hide(this.hide):this.popObj.show(this.show):e.classList.contains("e-scroll-nav")?e.click():!(0,a.le)(i)&&i.classList.contains(Qt)===!1&&(this.selectTab(r,null,!0),(0,a.le)(this.popEle)||this.popObj.hide(this.hide))},t.prototype.getTabHeader=function(){if(!(0,a.le)(this.element)){var e=[].slice.call(this.element.children).filter(function(r){return r.classList.contains(nr)});if(e.length>0)return e[0];var i=[].slice.call(this.element.children).filter(function(r){return!r.classList.contains(vy)})[0];return i?[].slice.call(i.children).filter(function(r){return r.classList.contains(nr)})[0]:void 0}},t.prototype.getEleIndex=function(e){return Array.prototype.indexOf.call((0,a.td)("."+jt,this.getTabHeader()),e)},t.prototype.extIndex=function(e){return e.replace(Wi+this.tabId+"_","")},t.prototype.expTemplateContent=function(){var e=this;this.templateEle.forEach(function(i){(0,a.le)(e.element.querySelector(i))||(document.body.appendChild(e.element.querySelector(i)).style.display="none")})},t.prototype.templateCompile=function(e,i,r){var n=this.createElement("div");this.compileElement(n,i,"content",r),n.childNodes.length!==0&&e.appendChild(n),this.isReact&&this.renderReactTemplates()},t.prototype.compileElement=function(e,i,r,n){var s;typeof i=="string"?(i=i.trim(),this.isVue?s=(0,a.MY)(a.pJ.sanitize(i)):e.innerHTML=a.pJ.sanitize(i)):s=(0,a.MY)(i);var l;(0,a.le)(s)||(l=s({},this,r)),!(0,a.le)(s)&&l.length>0&&[].slice.call(l).forEach(function(h){e.appendChild(h)})},t.prototype.headerTextCompile=function(e,i,r){this.compileElement(e,i,"headerTemplate",r)},t.prototype.getContent=function(e,i,r,n){var s;if(i=(0,a.le)(i)?"":i,typeof i=="string"||(0,a.le)(i.innerHTML))if(typeof i=="string"&&this.enableHtmlSanitizer&&(i=a.pJ.sanitize(i)),i[0]==="."||i[0]==="#")if(document.querySelectorAll(i).length){var l=document.querySelector(i);s=l.outerHTML.trim(),r==="clone"?e.appendChild(l.cloneNode(!0)):(e.appendChild(l),l.style.display="")}else this.templateCompile(e,i,n);else this.templateCompile(e,i,n);else e.appendChild(i);(0,a.le)(s)||this.templateEle.indexOf(i.toString())===-1&&this.templateEle.push(i.toString())},t.prototype.getTrgContent=function(e,i){var r;return this.element.classList.contains(Jl)?r=(0,a.Ys)("."+Jl+"> ."+Ut+" > #"+Ut+this.tabId+"_"+i,this.element):r=this.findEle(e.children,Ut+this.tabId+"_"+i),r},t.prototype.findEle=function(e,i){for(var r,n=0;n<e.length;n++)if(e[n].id===i){r=e[n];break}return r},t.prototype.isVertical=function(){var e=this.headerPlacement==="Left"||this.headerPlacement==="Right";return this.scrCntClass=e?Sy:Cy,e},t.prototype.addVerticalClass=function(){if(this.isVertical()){var e=this.headerPlacement==="Left"?Df:Of;(0,a.cn)([this.hdrEle],[Cu,e]),this.element.classList.contains(Jl)?(0,a.cn)([this.hdrEle],[bu,e]):(0,a.cn)([this.element],[bu,e])}this.headerPlacement==="Bottom"&&(0,a.cn)([this.hdrEle],[Rf])},t.prototype.updatePopAnimationConfig=function(){this.show={name:this.isVertical()?"FadeIn":"SlideDown",duration:100},this.hide={name:this.isVertical()?"FadeOut":"SlideUp",duration:100}},t.prototype.changeOrientation=function(e){this.setOrientation(e,this.hdrEle);var i=this.hdrEle.querySelector("."+Qt),r=!!this.hdrEle.classList.contains(Cu);(0,a.IV)([this.element],[bu]),(0,a.IV)([this.hdrEle],[Cu,Df,Of]),r!==this.isVertical()&&(this.changeToolbarOrientation(),!(0,a.le)(i)&&i.classList.contains(_n)&&this.popupHandler(i)),this.addVerticalClass(),this.updateOrientationAttribute(),this.setActiveBorder(),this.focusItem()},t.prototype.focusItem=function(){var e=(0,a.Ys)(" #"+Wi+this.tabId+"_"+this.selectedItem,this.hdrEle);(0,a.le)(e)||e.firstElementChild.focus()},t.prototype.changeToolbarOrientation=function(){this.tbObj.setProperties({height:this.isVertical()?"100%":"auto",width:this.isVertical()?"auto":"100%"},!0),this.tbObj.changeOrientation(),this.updatePopAnimationConfig()},t.prototype.setOrientation=function(e,i){var r=Array.prototype.indexOf.call(this.element.children,i),n=Array.prototype.indexOf.call(this.element.children,this.element.querySelector("."+Ut));e==="Bottom"&&n>r?this.element.appendChild(i):((0,a.IV)([i],[Rf]),this.element.insertBefore(i,(0,a.Ys)("."+Ut,this.element)))},t.prototype.setCssClass=function(e,i,r){if(i!=="")for(var n=i.split(" "),s=0;s<n.length;s++)r?e.classList.add(n[s]):e.classList.remove(n[s])},t.prototype.setContentHeight=function(e){if(this.element.classList.contains(Su)&&(0,a.IV)([this.element],[Su]),!(0,a.le)(this.cntEle)){var i=this.getTabHeader();if(this.heightAdjustMode==="None"){if(this.height==="auto")return;this.isVertical()||(0,a.V7)(this.cntEle,{height:this.element.offsetHeight-i.offsetHeight+"px"})}else if(this.heightAdjustMode==="Fill")(0,a.cn)([this.element],[Su]),(0,a.V7)(this.element,{height:"100%"}),(0,a.V7)(this.cntEle,{height:this.element.offsetHeight-i.offsetHeight+"px"});else if(this.heightAdjustMode==="Auto"){if(this.isTemplate===!0)for(var r=(0,a.td)("."+Ut+" > ."+Wi,this.element),n=0;n<r.length;n++)r[n].setAttribute("style","display:block; visibility: visible"),this.maxHeight=Math.max(this.maxHeight,this.getHeight(r[n])),r[n].style.removeProperty("display"),r[n].style.removeProperty("visibility");else{this.cntEle=(0,a.Ys)("."+Ut,this.element),e===!0&&this.cntEle.appendChild(this.createElement("div",{id:Ut+this.tabId+"_"+0,className:Wi+" "+Qt,attrs:{role:"tabpanel","aria-labelledby":Wi+this.tabId+"_"+0}}));for(var s=this.cntEle.children.item(0),n=0;n<this.items.length;n++)for(this.getContent(s,this.items[n].content,"clone",n),this.maxHeight=Math.max(this.maxHeight,this.getHeight(s));s.firstChild;)s.removeChild(s.firstChild);this.isReact&&this.clearTemplate(["content"]),this.templateEle=[],this.getContent(s,this.items[0].content,"render",0),this.prevIndex!==this.selectedItem&&s.classList.remove(Qt)}(0,a.V7)(this.cntEle,{height:this.maxHeight+"px"})}else(0,a.V7)(this.cntEle,{height:"auto"})}},t.prototype.getHeight=function(e){var i=window.getComputedStyle(e);return e.offsetHeight+parseFloat(i.getPropertyValue("padding-top"))+parseFloat(i.getPropertyValue("padding-bottom"))+parseFloat(i.getPropertyValue("margin-top"))+parseFloat(i.getPropertyValue("margin-bottom"))},t.prototype.setActiveBorder=function(){var e=this.getTabHeader(),i=(0,a.Ys)("."+jt+"."+Qt,e);if(!(0,a.le)(i)){this.reorderActiveTab?e&&e.classList.remove(wu):(i.classList.contains(_n)&&!this.bdrLine.classList.contains(vi)&&this.bdrLine.classList.add(vi),e&&!e.classList.contains(wu)&&e.classList.add(wu));var r=(0,a.oq)(i,"."+zn);if(this.element===r){this.tbItems=(0,a.Ys)("."+Or,e);var n=(0,a.Ys)("."+Fa,e),s=(0,a.Ys)("."+Or+" ."+this.scrCntClass,e);if(this.isVertical()){(0,a.V7)(n,{left:"",right:""});var l=(0,a.le)(s)?this.tbItems.offsetHeight:s.offsetHeight;l!==0?(0,a.V7)(n,{top:i.offsetTop+"px",height:i.offsetHeight+"px"}):(0,a.V7)(n,{top:0,height:0})}else{if(this.overflowMode==="MultiRow"){var h=(0,a.Ys)("."+Fa,this.element);(0,a.V7)(h,{top:i.offsetHeight+i.offsetTop+"px",height:""})}else(0,a.V7)(n,{top:"",height:""});var c=(0,a.le)(s)?this.tbItems.offsetWidth:s.offsetWidth;c!==0?(0,a.V7)(n,{left:i.offsetLeft+"px",right:c-(i.offsetLeft+i.offsetWidth)+"px"}):(0,a.V7)(n,{left:"auto",right:"auto"})}!(0,a.le)(this.bdrLine)&&!i.classList.contains(_n)&&this.bdrLine.classList.remove(vi)}}},t.prototype.setActive=function(e,i,r){i===void 0&&(i=!1),r===void 0&&(r=!1),this.tbItem=(0,a.td)("."+jt,this.getTabHeader());var n=this.tbItem[e];if(!(e<0||isNaN(e)||this.tbItem.length===0)){if(e>=0&&!i&&(this.allowServerDataBinding=!1,this.setProperties({selectedItem:e},!0),this.allowServerDataBinding=!0,this.initRender||this.serverDataBind()),n.classList.contains(Qt)){this.setActiveBorder();return}if(!this.isTemplate){var s=this.tbItem[this.prevIndex];(0,a.le)(s)||s.removeAttribute("aria-controls"),(0,a.Y4)(n,{"aria-controls":Ut+this.tabId+"_"+e})}var l=n.id;this.removeActiveClass(),n.classList.add(Qt),this.tbItem[this.prevIndex].setAttribute("aria-selected","false"),n.setAttribute("aria-selected","true");var h=Number(this.extIndex(l));if((0,a.le)(this.prevActiveEle)&&(this.prevActiveEle=Ut+this.tabId+"_"+h),(0,a.Y4)(this.element,{"aria-activedescendant":l}),this.isTemplate){if((0,a.Ys)("."+Ut,this.element).children.length>0){var c=this.findEle((0,a.Ys)("."+Ut,this.element).children,Ut+this.tabId+"_"+h);(0,a.le)(c)||c.classList.add(Qt),this.triggerAnimation(l,this.enableAnimation)}}else{this.cntEle=(0,a.Ys)("."+zn+" > ."+Ut,this.element);var u=this.getTrgContent(this.cntEle,this.extIndex(l));if((0,a.le)(u)){this.cntEle.appendChild(this.createElement("div",{id:Ut+this.tabId+"_"+this.extIndex(l),className:Wi+" "+Qt,attrs:{role:"tabpanel","aria-labelledby":Wi+this.tabId+"_"+this.extIndex(l)}}));var p=this.getTrgContent(this.cntEle,this.extIndex(l)),f=Array.prototype.indexOf.call(this.itemIndexArray,l);this.getContent(p,this.items[f].content,"render",f)}else u.classList.add(Qt);this.triggerAnimation(l,this.enableAnimation)}if(this.setActiveBorder(),this.refreshItemVisibility(n),!this.initRender&&!i){n.firstElementChild.focus();var g={previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:n,selectedIndex:e,selectedContent:(0,a.Ys)("#"+Ut+this.tabId+"_"+this.selectingID,this.content),isSwiped:this.isSwipeed,isInteracted:r};this.trigger("selected",g)}}},t.prototype.contentReady=function(){var e=this.setActiveContent();this.triggerAnimation(e,this.enableAnimation)},t.prototype.setItems=function(e){this.isReplace=!0,this.tbItems=(0,a.Ys)("."+Or,this.getTabHeader()),this.tbObj.items=this.parseObject(e,0),this.tbObj.dataBind(),this.isReplace=!1},t.prototype.setRTL=function(e){this.tbObj.enableRtl=e,this.tbObj.dataBind(),this.setCssClass(this.element,du,e),this.refreshActiveBorder()},t.prototype.refreshActiveBorder=function(){(0,a.le)(this.bdrLine)||this.bdrLine.classList.add(vi),this.setActiveBorder()},t.prototype.showPopup=function(e){var i=(0,a.Ys)(".e-popup.e-toolbar-pop",this.hdrEle);if(i.classList.contains("e-popup-close")){var r=i&&i.ej2_instances[0];r.position.X=this.headerPlacement==="Left"?"left":"right",r.dataBind(),r.show(e)}},t.prototype.bindDraggable=function(){var e=this;if(this.allowDragAndDrop){var i=this.element.querySelector("."+nr);if(i){var r=i.querySelectorAll("."+jt);r.forEach(function(n){e.initializeDrag(n)})}}},t.prototype.wireEvents=function(){this.bindDraggable(),window.addEventListener("resize",this.resizeContext),a.bi.add(this.element,"mouseover",this.hoverHandler,this),a.bi.add(this.element,"keydown",this.spaceKeyDown,this),(0,a.le)(this.cntEle)||(this.touchModule=new a.Xh(this.cntEle,{swipe:this.swipeHandler.bind(this)})),this.keyModule=new a.nv(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:this.keyConfigs}),this.tabKeyModule=new a.nv(this.element,{keyAction:this.keyHandler.bind(this),keyConfigs:{openPopup:"shift+f10",tab:"tab",shiftTab:"shift+tab"},eventName:"keydown"})},t.prototype.unWireEvents=function(){(0,a.le)(this.keyModule)||this.keyModule.destroy(),(0,a.le)(this.tabKeyModule)||this.tabKeyModule.destroy(),!(0,a.le)(this.cntEle)&&!(0,a.le)(this.touchModule)&&(this.touchModule.destroy(),this.touchModule=null),window.removeEventListener("resize",this.resizeContext),a.bi.remove(this.element,"mouseover",this.hoverHandler),a.bi.remove(this.element,"keydown",this.spaceKeyDown),this.element.classList.remove(du),this.element.classList.remove(fu)},t.prototype.clickHandler=function(e){this.element.classList.remove(fu);var i=e.originalEvent.target,r=(0,a.oq)(i,"."+jt),n=this.getEleIndex(r);i.classList.contains(gu)?this.removeTab(n):this.isVertical()&&(0,a.oq)(i,"."+gy)?this.showPopup(this.show):(this.isPopup=!1,!(0,a.le)(r)&&(n!==this.selectedItem||n!==this.prevIndex)&&this.selectTab(n,e.originalEvent,!0))},t.prototype.swipeHandler=function(e){if(!(e.velocity<3&&(0,a.le)(e.originalEvent.changedTouches))){this.isNested&&this.element.setAttribute("data-swipe","true");var i=this.element.querySelector('[data-swipe="true"]');if(i){i.removeAttribute("data-swipe");return}if(this.isSwipeed=!0,e.swipeDirection==="Right"&&this.selectedItem!==0){for(var r=this.selectedItem-1;r>=0;r--)if(!this.tbItem[r].classList.contains(vi)){this.selectTab(r,null,!0);break}}else if(e.swipeDirection==="Left"&&this.selectedItem!==(0,a.td)("."+jt,this.element).length-1){for(var n=this.selectedItem+1;n<this.tbItem.length;n++)if(!this.tbItem[n].classList.contains(vi)){this.selectTab(n,null,!0);break}}this.isSwipeed=!1}},t.prototype.spaceKeyDown=function(e){if(e.keyCode===32&&e.which===32||e.keyCode===35&&e.which===35){var i=(0,a.oq)(e.target,"."+nr);(0,a.le)(i)||e.preventDefault()}},t.prototype.keyHandler=function(e){if(!this.element.classList.contains(ys)){this.element.classList.add(fu);var i=e.target,r=this.getTabHeader(),n=(0,a.Ys)("."+Qt,r);this.popEle=(0,a.Ys)("."+kf,r),(0,a.le)(this.popEle)||(this.popObj=this.popEle.ej2_instances[0]);var s=(0,a.oq)(document.activeElement,"."+jt),l=(0,a.oq)(i,"."+jt);switch(e.action){case"space":case"enter":if(i.parentElement.classList.contains(ys))return;if(e.action==="enter"&&i.classList.contains("e-hor-nav")){this.showPopup(this.show);break}this.keyPressed(i);break;case"tab":case"shiftTab":i.classList.contains(Jr)&&(0,a.oq)(i,"."+jt).classList.contains(Qt)===!1&&i.setAttribute("tabindex","-1"),this.popObj&&(0,a.pn)(this.popObj.element)&&this.popObj.hide(this.hide),n.children.item(0).setAttribute("tabindex","0");break;case"moveLeft":case"moveRight":(0,a.le)(s)||this.refreshItemVisibility(s);break;case"openPopup":e.preventDefault(),!(0,a.le)(this.popEle)&&this.popEle.classList.contains(by)&&this.popObj.show(this.show);break;case"delete":if(this.showCloseButton===!0&&!(0,a.le)(l)){var h=l.nextSibling;!(0,a.le)(h)&&h.classList.contains(jt)&&h.firstElementChild.focus(),this.removeTab(this.getEleIndex(l))}this.setActiveBorder();break}}},t.prototype.refreshActiveTabBorder=function(){var e=(0,a.Ys)("."+jt+"."+_n+"."+Qt,this.element);!(0,a.le)(e)&&this.reorderActiveTab&&this.select(this.getEleIndex(e)),this.refreshActiveBorder()},t.prototype.refreshItemVisibility=function(e){var i=(0,a.Ys)("."+this.scrCntClass,this.tbItems);if(!this.isVertical()&&!(0,a.le)(i)){var r=(0,a.Ys)(".e-hscroll-bar",this.tbItems),n=r.scrollLeft,s=n+r.offsetWidth,l=e.offsetLeft,h=e.offsetWidth,c=e.offsetLeft+e.offsetWidth;if(n<l&&s<c){var u=s-l;r.scrollLeft=n+(h-u)}else if(n>l&&s>c){var u=c-n;r.scrollLeft=n-(h-u)}}else return},t.prototype.hoverHandler=function(e){var i=e.target;!(0,a.le)(i.classList)&&i.classList.contains(gu)&&i.setAttribute("title",new a.E7("tab",{closeButtonTitle:this.title},this.locale).getConstant("closeButtonTitle"))},t.prototype.evalOnPropertyChangeItems=function(e,i){if(e.items instanceof Array&&i.items instanceof Array)if(this.lastIndex=0,(0,a.le)(this.tbObj))this.reRenderItems();else{(this.isReact||this.isAngular)&&this.clearTemplate(),this.setItems(e.items),this.templateEle.length>0&&this.expTemplateContent(),this.templateEle=[];for(var ne=(0,a.Ys)("."+zn+" > ."+Ut,this.element);ne.firstElementChild;)(0,a.og)(ne.firstElementChild);this.select(this.selectedItem),this.draggableItems=[],this.bindDraggable()}else for(var r=Object.keys(e.items),n=0;n<r.length;n++)for(var s=parseInt(Object.keys(e.items)[n],10),l=Object.keys(e.items[s]),h=0;h<l.length;h++){var c=Object(i.items[s])[l[h]],u=Object(e.items[s])[l[h]],p=this.element.querySelectorAll("."+jt)[s],f=void 0;if(p&&!(0,a.le)(p.id)&&p.id!==""){var g=p.id.lastIndexOf("_");f=parseInt(p.id.substring(g+1),10)}else f=s;var C=(0,a.Ys)("."+Or+" #"+Wi+this.tabId+"_"+f,this.element),L=(0,a.Ys)("."+Ut+" #"+Ut+this.tabId+"_"+f,this.element);if(l[h]==="header"||l[h]==="headerTemplate"){var D=(0,a.le)(this.items[s].header)||(0,a.le)(this.items[s].header.iconCss)?"":this.items[s].header.iconCss,R=this.items[s].headerTemplate||this.items[s].header.text;if(R===""&&D==="")this.removeTab(s);else{this.tbId=p.id;var B=[];B.push(this.items[s]),this.items.splice(s,1),this.itemIndexArray.splice(s,1),this.tbObj.items.splice(s,1);var H=C.classList.contains(vi);(0,a.og)(C),this.isReplace=!0,this.addTab(B,s),H&&this.hideTab(s),this.isReplace=!1}}if(l[h]==="content"&&!(0,a.le)(L)){var j=typeof u=="string"||(0,a.le)(u.innerHTML);if(j&&(u[0]==="."||u[0]==="#")&&u.length){var W=document.querySelector(u);L.appendChild(W),W.style.display=""}else u===""&&c[0]==="#"?(document.body.appendChild(this.element.querySelector(c)).style.display="none",L.innerHTML=u):this.isReact?(L.innerHTML="",this.templateCompile(L,u,s)):typeof u!="function"&&(L.innerHTML=u)}l[h]==="cssClass"&&((0,a.le)(C)||(C.classList.remove(c),C.classList.add(u)),(0,a.le)(L)||(L.classList.remove(c),L.classList.add(u))),l[h]==="disabled"&&this.enableTab(s,u!==!0),l[h]==="visible"&&this.hideTab(s,u!==!0)}},t.prototype.initializeDrag=function(e){var i=this,r=new a._l(e,{dragArea:this.dragArea,dragTarget:"."+jt,clone:!0,helper:this.helper.bind(this),dragStart:this.itemDragStart.bind(this),drag:function(n){var s=i.getEleIndex(i.dragItem),l,h,c={draggedItem:i.dragItem,event:n.event,target:n.target,droppedItem:n.target.closest("."+jt),clonedElement:i.cloneElement,index:s};if(!(0,a.le)(n.target.closest("."+zn))&&!n.target.closest("."+zn).isEqualNode(i.element)&&i.dragArea!=="."+nr)i.trigger("dragging",c);else{if(!n.target.closest(i.dragArea)&&i.overflowMode!=="Popup"?(document.body.style.cursor="not-allowed",(0,a.cn)([i.cloneElement],vi),i.dragItem.classList.contains(vi)&&(0,a.IV)([i.dragItem],vi),i.dragItem.querySelector("."+Jr).style.visibility="visible"):(document.body.style.cursor="",i.dragItem.querySelector("."+Jr).style.visibility="hidden",i.cloneElement.classList.contains(vi)&&(0,a.IV)([i.cloneElement],vi)),i.overflowMode==="Scrollable"&&!(0,a.le)(i.element.querySelector(".e-hscroll"))){var u=i.element.querySelector(".e-scroll-right-nav"),p=i.element.querySelector(".e-scroll-left-nav"),f=i.element.querySelector(".e-hscroll-bar");!(0,a.le)(u)&&Math.abs(u.offsetWidth/2+u.offsetLeft)>i.cloneElement.offsetLeft+i.cloneElement.offsetWidth&&(f.scrollLeft-=10),!(0,a.le)(p)&&Math.abs(p.offsetLeft+p.offsetWidth-i.cloneElement.offsetLeft)>p.offsetWidth/2&&(f.scrollLeft+=10)}i.cloneElement.style.pointerEvents="none",h=(0,a.oq)(n.target,"."+jt+".e-draggable");var g=0;i.overflowMode==="Scrollable"&&!(0,a.le)(i.element.querySelector(".e-hscroll"))&&(g=i.element.querySelector(".e-hscroll-content").offsetWidth),h!=null&&!h.isSameNode(i.dragItem)&&h.closest("."+zn).isSameNode(i.dragItem.closest("."+zn))&&(l=i.getEleIndex(h),l<s&&Math.abs(h.offsetLeft+h.offsetWidth-i.cloneElement.offsetLeft)>h.offsetWidth/2&&i.dragAction(h,s,l),l>s&&Math.abs(h.offsetWidth/2)+h.offsetLeft-g<i.cloneElement.offsetLeft+i.cloneElement.offsetWidth&&i.dragAction(h,s,l)),i.droppedIndex=i.getEleIndex(i.dragItem),i.trigger("dragging",c)}},dragStop:this.itemDragStop.bind(this)});this.draggableItems.push(r)},t.prototype.helper=function(e){return this.cloneElement=this.createElement("div"),e.element&&(this.cloneElement=e.element.cloneNode(!0),(0,a.cn)([this.cloneElement],"e-tab-clone-element"),this.element.querySelector("."+nr).classList.contains(eh)&&(0,a.cn)([this.cloneElement],eh),(0,a.IV)([this.cloneElement.querySelector("."+Jr)],"e-ripple"),(0,a.le)(this.cloneElement.querySelector(".e-ripple-element"))||(0,a.Od)(this.cloneElement.querySelector(".e-ripple-element")),document.body.appendChild(this.cloneElement)),this.cloneElement},t.prototype.itemDragStart=function(e){var i=this;this.draggingItems=this.items.map(function(n){return n}),this.dragItem=e.element;var r={draggedItem:e.element,event:e.event,target:e.target,droppedItem:null,index:this.getEleIndex(this.dragItem),clonedElement:this.cloneElement,cancel:!1};this.trigger("onDragStart",r,function(n){n.cancel?(0,a.og)(i.cloneElement):(i.removeActiveClass(),(0,a.cn)([i.tbItems.querySelector("."+Fa)],vi),i.dragItem.querySelector("."+Jr).style.visibility="hidden")})},t.prototype.dragAction=function(e,i,r){if(this.items.length>0){var n=this.draggingItems[i];this.draggingItems.splice(i,1),this.draggingItems.splice(r,0,n)}if(this.overflowMode==="MultiRow"&&e.parentNode.insertBefore(this.dragItem,e.nextElementSibling),i>r)if(this.dragItem.parentElement.isSameNode(e.parentElement))this.dragItem.parentNode.insertBefore(this.dragItem,e);else if(this.overflowMode==="Extended")if(e.isSameNode(e.parentElement.lastChild)){var s=this.dragItem.parentNode;e.parentNode.insertBefore(this.dragItem,e),s.insertBefore(e.parentElement.lastChild,s.childNodes[0])}else this.dragItem.parentNode.insertBefore(e.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),e.parentNode.insertBefore(this.dragItem,e);else{var l=e.parentElement.lastChild;if(e.isSameNode(l)){var s=this.dragItem.parentNode;e.parentNode.insertBefore(this.dragItem,e),s.insertBefore(l,s.childNodes[0])}else this.dragItem.parentNode.insertBefore(e.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),e.parentNode.insertBefore(this.dragItem,e)}i<r&&(this.dragItem.parentElement.isSameNode(e.parentElement)?this.dragItem.parentNode.insertBefore(e,this.dragItem):this.overflowMode==="Extended"?(this.dragItem.parentElement.appendChild(e.parentElement.firstElementChild),e.parentNode.insertBefore(this.dragItem,e.nextSibling)):(this.dragItem.parentNode.insertBefore(e.parentElement.lastChild,this.dragItem.parentElement.childNodes[0]),e.parentNode.insertBefore(this.dragItem,e)))},t.prototype.itemDragStop=function(e){var i=this;(0,a.og)(this.cloneElement),this.cloneElement=null,this.dragItem.querySelector("."+Jr).style.visibility="visible",document.body.style.cursor="";var r={draggedItem:this.dragItem,event:e.event,target:e.target,droppedItem:this.tbItem[this.droppedIndex],clonedElement:null,index:this.droppedIndex,cancel:!1};this.trigger("dragged",r,function(n){n.cancel?i.refresh():i.items.length>0&&i.draggingItems.length>0?(i.items=i.draggingItems,i.selectedItem=i.droppedIndex,i.refresh()):(i.dragItem.querySelector("."+Jr).style.visibility="",(0,a.IV)([i.tbItems.querySelector("."+Fa)],vi),i.selectTab(i.droppedIndex,null,!0))}),this.dragItem=null},t.prototype.enableTab=function(e,i){var r=(0,a.td)("."+jt,this.element)[e];(0,a.le)(r)||(i===!0?(r.classList.remove(ys,yu),r.firstElementChild.setAttribute("tabindex","-1")):(r.classList.add(ys,yu),r.firstElementChild.removeAttribute("tabindex"),r.classList.contains(Qt)&&this.select(e+1)),(0,a.le)(this.items[e])||(this.items[e].disabled=!i,this.dataBind()),r.setAttribute("aria-disabled",i===!0?"false":"true"))},t.prototype.addTab=function(e,i){var r=this,n={addedItems:e,cancel:!1};this.isReplace?this.addingTabContent(e,i):this.trigger("adding",n,function(s){s.cancel||r.addingTabContent(e,i)}),this.isReact&&this.renderReactTemplates()},t.prototype.addingTabContent=function(e,i){var r=this,n=0;if(this.hdrEle=(0,a.Ys)("."+nr,this.element),(0,a.le)(this.hdrEle))this.items=e,this.reRenderItems(),this.bindDraggable();else{var s=(0,a.td)(".e-tab-header ."+jt,this.element).length;if(s!==0&&(n=this.lastIndex+1),(0,a.le)(i)&&(i=s-1),s<i||i<0||isNaN(i))return;s===0&&!(0,a.le)(this.hdrEle)&&(this.hdrEle.style.display=""),(0,a.le)(this.bdrLine)||this.bdrLine.classList.add(vi),this.tbItems=(0,a.Ys)("."+Or,this.getTabHeader()),this.isAdd=!0;var l=this.parseObject(e,i);this.isAdd=!1;var h=0,c;e.forEach(function(u,p){if(c=u.headerTemplate||u.header.text,(0,a.le)(u.headerTemplate||u.header)||(0,a.le)(c)||c.length===0&&!(0,a.le)(u.header)&&(0,a.le)(u.header.iconCss)||(l[p]&&((0,a.le)(u.id)&&(u.id=Mf+(n+p).toString()),l[p].htmlAttributes["data-id"]=u.id),r.items.splice(i+h,0,u),h++),r.isTemplate&&!(0,a.le)(u.header)&&!(0,a.le)(u.header.text)){var f=n+p,g=r.createElement("div",{id:Ut+r.tabId+"_"+f,className:Wi,attrs:{role:"tabpanel","aria-labelledby":Wi+"_"+f}});r.cntEle.insertBefore(g,r.cntEle.children[i+p]);var C=r.getTrgContent(r.cntEle,f.toString());r.getContent(C,u.content,"render",i)}}),this.tbObj.addItems(l,i),this.isReplace||this.trigger("added",{addedItems:e}),this.selectedItem===i?this.select(i):(this.setActiveBorder(),this.tbItem=(0,a.td)("."+jt,this.getTabHeader())),this.bindDraggable()}},t.prototype.removeTab=function(e){var i=this,r=(0,a.td)("."+jt,this.element)[e];if(!(0,a.le)(r)){var n={removedItem:r,removedIndex:e,cancel:!1};this.trigger("removing",n,function(s){if(!s.cancel){i.tbObj.removeItems(e),i.allowDragAndDrop&&e!==Array.prototype.indexOf.call(i.itemIndexArray,r.id)&&(e=Array.prototype.indexOf.call(i.itemIndexArray,r.id)),i.items.splice(e,1),i.itemIndexArray.splice(e,1),i.refreshActiveBorder();var l=(0,a.Ys)("#"+Ut+i.tabId+"_"+i.extIndex(r.id),(0,a.Ys)("."+Ut,i.element));(0,a.le)(l)||(0,a.og)(l),i.trigger("removed",s),i.draggableItems&&i.draggableItems.length>0&&(i.draggableItems[e].destroy(),i.draggableItems[e]=null,i.draggableItems.splice(e,1)),r.classList.contains(Qt)?(e=e>(0,a.td)("."+jt+":not(."+_n+")",i.element).length-1?e-1:e,i.enableAnimation=!1,i.selectedItem=e,i.select(e)):e!==i.selectedItem&&(e<i.selectedItem&&(e=i.itemIndexArray.indexOf(i.tbItem[i.selectedItem].id),i.setProperties({selectedItem:e>-1?e:i.selectedItem},!0),i.prevIndex=i.selectedItem),i.tbItem=(0,a.td)("."+jt,i.getTabHeader())),(0,a.td)("."+jt,i.element).length===0&&(i.hdrEle.style.display="none"),i.enableAnimation=!0}})}},t.prototype.hideTab=function(e,i){var r,n=(0,a.td)("."+jt,this.element)[e];if(!(0,a.le)(n)){if((0,a.le)(i)&&(i=!0),this.bdrLine.classList.add(vi),i===!0)if(n.classList.add(vi),r=(0,a.td)("."+jt+":not(."+vi+")",this.tbItems),r.length!==0&&n.classList.contains(Qt)){if(e!==0)for(var s=e-1;s>=0;s--)if(this.tbItem[s].classList.contains(vi)){if(s===0){for(var l=e+1;l<this.tbItem.length;l++)if(!this.tbItem[l].classList.contains(vi)){this.select(l);break}}}else{this.select(s);break}else for(var l=e+1;l<this.tbItem.length;l++)if(!this.tbItem[l].classList.contains(vi)){this.select(l);break}}else r.length===0&&this.element.classList.add(vi);else this.element.classList.remove(vi),r=(0,a.td)("."+jt+":not(."+vi+")",this.tbItems),n.classList.remove(vi),r.length===0&&this.select(e);this.setActiveBorder(),n.setAttribute("aria-hidden",""+i),this.overflowMode==="Popup"&&this.tbObj&&this.tbObj.refreshOverflow()}},t.prototype.selectTab=function(e,i,r){i===void 0&&(i=null),r===void 0&&(r=!1),this.isInteracted=r,this.select(e,i)},t.prototype.select=function(e,i){var r=this,n=this.getTabHeader();this.tbItems=(0,a.Ys)("."+Or,n),this.tbItem=(0,a.td)("."+jt,n),this.content=(0,a.Ys)("."+Ut,this.element),this.prevItem=this.tbItem[this.prevIndex],(0,a.le)(this.selectedItem)||this.selectedItem<0||this.tbItem.length<=this.selectedItem||isNaN(this.selectedItem)?this.selectedItem=0:this.selectedID=this.extIndex(this.tbItem[this.selectedItem].id);var s=this.tbItem[e];(0,a.le)(s)?this.selectedID="0":this.selectingID=this.extIndex(s.id),!(0,a.le)(this.prevItem)&&!this.prevItem.classList.contains(ys)&&this.prevItem.children.item(0).setAttribute("tabindex","-1");var l={event:i,previousItem:this.prevItem,previousIndex:this.prevIndex,selectedItem:this.tbItem[this.selectedItem],selectedIndex:this.selectedItem,selectedContent:(0,a.le)(this.content)?null:(0,a.Ys)("#"+Ut+this.tabId+"_"+this.selectedID,this.content),selectingItem:s,selectingIndex:e,selectingContent:(0,a.le)(this.content)?null:(0,a.Ys)("#"+Ut+this.tabId+"_"+this.selectingID,this.content),isSwiped:this.isSwipeed,isInteracted:this.isInteracted,cancel:!1};this.initRender?this.selectingContent(e,this.isInteracted):this.trigger("selecting",l,function(h){h.cancel||r.selectingContent(e,r.isInteracted)}),this.isInteracted=!1},t.prototype.selectingContent=function(e,i){if(typeof e=="number"){if(!(0,a.le)(this.tbItem[e])&&(this.tbItem[e].classList.contains(ys)||this.tbItem[e].classList.contains(vi)))for(var r=e+1;r<this.items.length;r++)if(this.items[r].disabled===!1&&this.items[r].visible===!0){e=r;break}else e=0;if(this.tbItem.length>e&&e>=0&&!isNaN(e))if(this.prevIndex=this.selectedItem,this.prevItem=this.tbItem[this.prevIndex],this.tbItem[e].classList.contains(_n)&&this.reorderActiveTab){if(this.setActive(this.popupHandler(this.tbItem[e]),null,i),!(0,a.le)(this.items)&&this.items.length>0&&this.allowDragAndDrop){this.tbItem=(0,a.td)("."+Or+" ."+jt,this.hdrEle);var n=this.items[e];this.items.splice(e,1),this.items.splice(this.tbItem.length-1,0,n)}}else this.setActive(e,null,i);else this.setActive(0,null,i)}else e instanceof HTMLElement&&this.setActive(this.getEleIndex(e),null,i)},t.prototype.getItemIndex=function(e){for(var i,r=0;r<this.tbItem.length;r++){var n=this.tbItem[r].getAttribute("data-id");if(e===n){i=r;break}}return i},t.prototype.disable=function(e){this.setCssClass(this.element,ys,e),this.element.setAttribute("aria-disabled",""+e)},t.prototype.getPersistData=function(){return this.addOnPersist(["selectedItem","actEleId"])},t.prototype.getModuleName=function(){return"tab"},t.prototype.onPropertyChanged=function(e,i){for(var r=this,n=0,s=Object.keys(e);n<s.length;n++){var l=s[n];switch(l){case"width":(0,a.V7)(this.element,{width:(0,a.Ac)(e.width)});break;case"height":(0,a.V7)(this.element,{height:(0,a.Ac)(e.height)}),this.setContentHeight(!1);break;case"cssClass":i.cssClass!==""&&!(0,a.le)(i.cssClass)?(this.setCssClass(this.element,i.cssClass,!1),this.setCssClass(this.element,e.cssClass,!0)):this.setCssClass(this.element,e.cssClass,!0);break;case"items":this.evalOnPropertyChangeItems(e,i);break;case"showCloseButton":this.setCloseButton(e.showCloseButton);break;case"reorderActiveTab":this.refreshActiveTabBorder();break;case"selectedItem":this.selectedItem=i.selectedItem,this.select(e.selectedItem);break;case"headerPlacement":this.changeOrientation(e.headerPlacement);break;case"enableRtl":this.setRTL(e.enableRtl);break;case"overflowMode":this.tbObj.overflowMode=e.overflowMode,this.tbObj.dataBind(),this.refreshActiveTabBorder();break;case"heightAdjustMode":this.setContentHeight(!1),this.select(this.selectedItem);break;case"scrollStep":this.tbObj&&(this.tbObj.scrollStep=this.scrollStep);break;case"allowDragAndDrop":this.bindDraggable();break;case"dragArea":this.allowDragAndDrop&&(this.draggableItems.forEach(function(h){h.dragArea=r.dragArea}),this.refresh());break}}},t.prototype.refreshActiveTab=function(){if(this.isReact&&this.clearTemplate(),this.isTemplate){var D=this.element.querySelector("."+Or),R=this.element.querySelector("."+jt+"."+Qt),B=R.id,H=B.indexOf("_"),j=parseInt(B.substring(H+1),10),W=R.innerText,ne=this.element.querySelector("."+Ut).querySelector("."+Qt).children[0],ie=ne.innerHTML;(0,a.og)(R),(0,a.og)(ne);var me={className:jt+" "+pu+" "+Qt,id:Wi+this.tabId+"_"+j,attrs:{role:"tab","aria-controls":Ut+this.tabId+"_"+j,"aria-disabled":"false","aria-selected":"true"}},ve=this.createElement("span",{className:th,innerHTML:W,attrs:{role:"presentation"}}).outerHTML,Ee=this.createElement("div",{className:ih,innerHTML:ve+this.btnCls.outerHTML}).outerHTML,le=this.createElement("div",{className:Jr,innerHTML:Ee,attrs:{tabIndex:"-1"}});D.insertBefore(this.createElement("div",me),D.children[j+1]),this.element.querySelector("."+jt+"."+Qt).appendChild(le);var f=this.createElement("div",{innerHTML:ie});this.element.querySelector("."+Ut).querySelector("."+Qt).appendChild(f)}else if(this.element.querySelector("."+jt+"."+Qt)){(0,a.og)(this.element.querySelector("."+jt+"."+Qt).children[0]),(0,a.og)(this.element.querySelector("."+Ut).querySelector("."+Qt).children[0]);var e=this.items[this.selectedItem],i=(0,a.le)(e.header)||(0,a.le)(e.header.iconPosition)?"":e.header.iconPosition,r=(0,a.le)(e.header)||(0,a.le)(e.header.iconCss)?"":e.header.iconCss,n=e.headerTemplate||e.header.text,s=this.createElement("div",{className:th,attrs:{role:"presentation"}});(0,a.le)(n.tagName)?this.headerTextCompile(s,n,this.selectedItem):s.appendChild(n);var l=void 0,h=this.createElement("span",{className:vu+" "+Lf+" "+mu+"-"+i+" "+r}),c=this.createElement("div",{className:ih});c.appendChild(s),n!==""&&n!==void 0&&r!==""?(i==="left"||i==="top"?c.insertBefore(h,c.firstElementChild):c.appendChild(h),l=s,this.isIconAlone=!1):(l=r===""?s:h,l===h&&((0,a.og)(s),c.appendChild(h),this.isIconAlone=!0));var u=e.disabled?{}:{tabIndex:"-1"};c.appendChild(this.btnCls.cloneNode(!0));var p=this.createElement("div",{className:Jr,attrs:u});p.appendChild(c),(i==="top"||i==="bottom")&&this.element.classList.add("e-vertical-icon"),this.element.querySelector("."+jt+"."+Qt).appendChild(p);var f=this.createElement("div"),g=e.content,C=void 0;if(typeof g=="string"||(0,a.le)(g.innerHTML))if(typeof g=="string"&&this.enableHtmlSanitizer&&(g=a.pJ.sanitize(g)),g[0]==="."||g[0]==="#")if(document.querySelectorAll(g).length){var L=document.querySelector(g);C=L.outerHTML.trim(),f.appendChild(L),L.style.display=""}else this.compileElement(f,g,"content",this.selectedItem);else this.compileElement(f,g,"content",this.selectedItem);else f.appendChild(g);(0,a.le)(C)||this.templateEle.indexOf(g.toString())===-1&&this.templateEle.push(g.toString()),this.element.querySelector("."+Wi+"."+Qt).appendChild(f)}this.isReact&&this.renderReactTemplates()},Ht([(0,a.FE)([],Ey)],t.prototype,"items",void 0),Ht([(0,a.Z9)("100%")],t.prototype,"width",void 0),Ht([(0,a.Z9)("auto")],t.prototype,"height",void 0),Ht([(0,a.Z9)("")],t.prototype,"cssClass",void 0),Ht([(0,a.Z9)(0)],t.prototype,"selectedItem",void 0),Ht([(0,a.Z9)("Top")],t.prototype,"headerPlacement",void 0),Ht([(0,a.Z9)("Content")],t.prototype,"heightAdjustMode",void 0),Ht([(0,a.Z9)("Scrollable")],t.prototype,"overflowMode",void 0),Ht([(0,a.Z9)("Dynamic")],t.prototype,"loadOn",void 0),Ht([(0,a.Z9)(!1)],t.prototype,"enablePersistence",void 0),Ht([(0,a.Z9)(!1)],t.prototype,"enableHtmlSanitizer",void 0),Ht([(0,a.Z9)(!1)],t.prototype,"showCloseButton",void 0),Ht([(0,a.Z9)(!0)],t.prototype,"reorderActiveTab",void 0),Ht([(0,a.Z9)()],t.prototype,"scrollStep",void 0),Ht([(0,a.Z9)()],t.prototype,"dragArea",void 0),Ht([(0,a.Z9)(!1)],t.prototype,"allowDragAndDrop",void 0),Ht([(0,a.Zz)({},wy)],t.prototype,"animation",void 0),Ht([(0,a.ju)()],t.prototype,"created",void 0),Ht([(0,a.ju)()],t.prototype,"adding",void 0),Ht([(0,a.ju)()],t.prototype,"added",void 0),Ht([(0,a.ju)()],t.prototype,"selecting",void 0),Ht([(0,a.ju)()],t.prototype,"selected",void 0),Ht([(0,a.ju)()],t.prototype,"removing",void 0),Ht([(0,a.ju)()],t.prototype,"removed",void 0),Ht([(0,a.ju)()],t.prototype,"onDragStart",void 0),Ht([(0,a.ju)()],t.prototype,"dragging",void 0),Ht([(0,a.ju)()],t.prototype,"dragged",void 0),Ht([(0,a.ju)()],t.prototype,"destroyed",void 0),t=Ht([a.Zl],t),t}(a.wA),yt=ae(15002),Jt={li:"e-list-item",ul:"e-list-parent e-ul",group:"e-list-group-item",icon:"e-list-icon",text:"e-list-text",check:"e-list-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-list-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-list-img",iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"},Mt;(function(o){o.defaultMappedFields={id:"id",text:"text",url:"url",value:"value",isChecked:"isChecked",enabled:"enabled",expanded:"expanded",selected:"selected",iconCss:"iconCss",child:"child",isVisible:"isVisible",hasChildren:"hasChildren",tooltip:"tooltip",htmlAttributes:"htmlAttributes",urlAttributes:"urlAttributes",imageAttributes:"imageAttributes",imageUrl:"imageUrl",groupBy:null,sortBy:null};var t={level:1,listRole:"presentation",itemRole:"presentation",groupItemRole:"group",itemText:"list-item",wrapperRole:"presentation"},e={showCheckBox:!1,showIcon:!1,enableHtmlSanitizer:!1,expandCollapse:!1,fields:o.defaultMappedFields,ariaAttributes:t,listClass:"",itemClass:"",processSubChild:!1,sortOrder:"None",template:null,groupTemplate:null,headerTemplate:null,expandIconClass:"e-icon-collapsible",moduleName:"list",expandIconPosition:"Right",itemNavigable:!1};function i(le,de,fe,Le,ke){var Me=(0,a.l7)({},e,fe),De=(0,a.l7)({},t,Me.ariaAttributes),Fe=C(de).typeof;return Fe==="string"||Fe==="number"?r(le,de,Le,fe,ke):l(le,de,fe,De.level,Le,ke)}o.createList=i;function r(le,de,fe,Le,ke){var Me=n(le,de,fe,Le,ke);return ve(le,Me,null,Le)}o.createListFromArray=r;function n(le,de,fe,Le,ke){var Me=[],De=(0,a.l7)({},e,Le);Jt=ne(De.moduleName);for(var Fe=H(),Pe=0;Pe<de.length;Pe++)if(!(0,a.le)(de[Pe])){var Ye=void 0;if(De.itemCreating&&typeof De.itemCreating=="function"){var Ze={dataSource:de,curData:de[Pe],text:de[Pe],options:De};De.itemCreating(Ze)}if(fe?Ye=W(le,de[Pe],void 0,null,null,[],null,Fe,Pe,Le):Ye=me(le,de[Pe],void 0,null,null,Le,ke),De.itemCreated&&typeof De.itemCreated=="function"){var Ze={dataSource:de,curData:de[Pe],text:de[Pe],item:Ye,options:De};De.itemCreated(Ze)}Me.push(Ye)}return Me}o.createListItemFromArray=n;function s(le,de,fe,Le,ke,Me){var De=(0,a.l7)({},e,fe);Jt=ne(De.moduleName);var Fe=Me&&(Me.getModuleName()==="listview"||Me.getModuleName()==="multiselect")?De.fields:(0,a.l7)({},o.defaultMappedFields,De.fields),Pe=(0,a.l7)({},t,De.ariaAttributes),Ye,Ze=[];Le&&(Pe.level=Le);var nt=[],it,et;de&&de.length&&!(0,a.le)(C(de).item)&&!C(de).item.hasOwnProperty(Fe.id)&&(Ye=H());for(var at=0;at<de.length;at++){var Ge=tr(de[at],Fe);if(!(0,a.le)(de[at])){if(De.itemCreating&&typeof De.itemCreating=="function"){var gt={dataSource:de,curData:de[at],text:Ge[Fe.text],options:De,fields:Fe};De.itemCreating(gt)}var ge=de[at];De.itemCreating&&typeof De.itemCreating=="function"&&(Ge=tr(de[at],Fe)),Ge.hasOwnProperty(Fe.id)&&!(0,a.le)(Ge[Fe.id])&&(Ye=Ge[Fe.id]);var xe=[];if(De.showCheckBox&&(De.itemNavigable&&(Ge[Fe.url]||Ge[Fe.urlAttributes])?Ze.push(le("input",{className:Jt.check,attrs:{type:"checkbox"}})):xe.push(le("input",{className:Jt.check,attrs:{type:"checkbox"}}))),ke===!0)De.showIcon&&Ge.hasOwnProperty(Fe.iconCss)&&!(0,a.le)(Ge[Fe.iconCss])&&xe.push(le("span",{className:Jt.icon+" "+Ge[Fe.iconCss]})),it=W(le,ge,Ge,Fe,De.itemClass,xe,!!(ge.hasOwnProperty("isHeader")&&ge.isHeader),Ye,at,fe),et=it.querySelector("."+Jt.anchorWrap),De.itemNavigable&&Ze.length&&(0,a.Ce)(Ze,it.firstElementChild);else{if(it=me(le,ge,Ge,Fe,De.itemClass,fe,Me),it.classList.add(Jt.level+"-"+Pe.level),it.setAttribute("aria-level",Pe.level.toString()),et=it.querySelector("."+Jt.anchorWrap),Ge.hasOwnProperty(Fe.tooltip)&&it.setAttribute("title",Ge[Fe.tooltip]),Ge.hasOwnProperty(Fe.htmlAttributes)&&Ge[Fe.htmlAttributes]&&L(it,Ge[Fe.htmlAttributes]),Ge.hasOwnProperty(Fe.enabled)&&Ge[Fe.enabled]===!1&&it.classList.add(Jt.disabled),Ge.hasOwnProperty(Fe.isVisible)&&Ge[Fe.isVisible]===!1&&(it.style.display="none"),Ge.hasOwnProperty(Fe.imageUrl)&&!(0,a.le)(Ge[Fe.imageUrl])&&!De.template){var je={src:Ge[Fe.imageUrl]};(0,a.TS)(je,Ge[Fe.imageAttributes]);var Je=le("img",{className:Jt.image,attrs:je});et?et.insertAdjacentElement("afterbegin",Je):(0,a.Ce)([Je],it.firstElementChild)}if(De.showIcon&&Ge.hasOwnProperty(Fe.iconCss)&&!(0,a.le)(Ge[Fe.iconCss])&&!De.template){var lt=le("div",{className:Jt.icon+" "+Ge[Fe.iconCss]});et?et.insertAdjacentElement("afterbegin",lt):(0,a.Ce)([lt],it.firstElementChild)}xe.length&&(0,a.Ce)(xe,it.firstElementChild),De.itemNavigable&&Ze.length&&(0,a.Ce)(Ze,it.firstElementChild),j(le,Ge,Fe,de,De,it,Pe.level)}if(et&&(0,a.cn)([it],[Jt.navigable]),De.itemCreated&&typeof De.itemCreated=="function"){var gt={dataSource:de,curData:de[at],text:Ge[Fe.text],item:it,options:De,fields:Fe};De.itemCreated(gt)}Ze=[],nt.push(it)}}return nt}o.createListItemFromJson=s;function l(le,de,fe,Le,ke,Me){var De=(0,a.l7)({},e,fe),Fe=s(le,de,fe,Le,ke,Me);return ve(le,Fe,De.listClass,fe)}o.createListFromJson=l;function h(le,de,fe){if(Jt=ne(e.moduleName),!(!le||!le.length)){var Le,ke,Me=Array.prototype.slice.call(le);for(de?ke=c(de,Me):ke=fe===!0?Me.length:-1,Le=Me[ke+(fe===!0?-1:1)];Le&&(!(0,a.pn)(Le)||Le.classList.contains(Jt.disabled));)ke=ke+(fe===!0?-1:1),Le=Me[ke];return Le}}o.getSiblingLI=h;function c(le,de){if(!(!de||!le)){var fe=de;return fe=Array.prototype.slice.call(de),fe.indexOf(le)}}o.indexOf=c;function u(le,de,fe){fe===void 0&&(fe="None");var Le=(0,a.l7)({},o.defaultMappedFields,de),ke=new yt.A().group(Le.groupBy);ke=p(fe,"key",ke);var Me=f(le,ke);le=[];for(var De=0;De<Me.length;De++){var Fe=Me[De].items,Pe={},Ye="isHeader";Pe[Le.text]=Me[De].key,Pe[Ye]=!0;var Ze=Le.text;Ze==="id"&&(Ze="text",Pe[Ze]=Me[De].key),Pe._id="group-list-item-"+(Me[De].key?Me[De].key.toString().trim():"undefined"),Pe.items=Fe,le.push(Pe);for(var nt=0;nt<Fe.length;nt++)le.push(Fe[nt])}return le}o.groupDataSource=u;function p(le,de,fe){if(fe===void 0&&(fe=new yt.A),le==="Ascending")fe.sortBy(de,"ascending",!0);else if(le==="Descending")fe.sortBy(de,"descending",!0);else for(var Le=0;Le<fe.queries.length;Le++)fe.queries[Le].fn==="onSortBy"&&fe.queries.splice(Le,1);return fe}o.addSorting=p;function f(le,de){return new Oe.h(le).executeLocal(de)}o.getDataSource=f;function g(le,de){var fe=(0,a.l7)({},e,de),Le=(0,a.l7)({},o.defaultMappedFields,fe.fields),ke=le.cloneNode(!0),Me=[];ke.classList.add("json-parent");var De=ke.querySelectorAll(".json-parent>li");ke.classList.remove("json-parent");for(var Fe=0;Fe<De.length;Fe++){for(var Pe=De[Fe],Ye=Pe.querySelector("a"),Ze=Pe.querySelector("ul"),nt={},it=Ye?Ye.childNodes:Pe.childNodes,et=Object.keys(it),at=0;at<it.length;at++)it[Number(et[at])].hasChildNodes()||(nt[Le.text]=it[Number(et[at])].textContent);var Ge=D(Pe);Ge.id?(nt[Le.id]=Ge.id,delete Ge.id):nt[Le.id]=H(),Object.keys(Ge).length&&(nt[Le.htmlAttributes]=Ge),Ye&&(Ge=D(Ye),Object.keys(Ge).length&&(nt[Le.urlAttributes]=Ge)),Ze&&(nt[Le.child]=g(Ze,de)),Me.push(nt)}return Me}o.createJsonFromElement=g;function C(le){for(var de={typeof:null,item:null},fe=0;fe<le.length;fe++)if(!(0,a.le)(le[fe]))return de={typeof:typeof le[fe],item:le[fe]};return de}function L(le,de){var fe={};(0,a.TS)(fe,de),fe.class&&((0,a.cn)([le],fe.class.split(" ")),delete fe.class),(0,a.Y4)(le,fe)}function D(le){for(var de={},fe=le.attributes,Le=0;Le<fe.length;Le++)de[fe[Le].nodeName]=fe[Le].nodeValue;return de}function R(le,de,fe,Le,ke,Me){Jt=ne(e.moduleName);for(var De=le("ul",{className:Jt.ul,attrs:{role:"presentation"}}),Fe=(0,a.l7)({},e,ke),Pe=(0,a.l7)({},o.defaultMappedFields,Le),Ye=nh(de),Ze=[],nt,it=H(),et=0;et<fe.length;et++){var at=tr(fe[et],Pe),Ge=fe[et],gt=Ge.isHeader;if(typeof fe[et]=="string"||typeof fe[et]=="number"?nt=Ge:nt=at[Pe.value],Fe.itemCreating&&typeof Fe.itemCreating=="function"){var ge={dataSource:fe,curData:Ge,text:nt,options:Fe,fields:Pe};Fe.itemCreating(ge)}Fe.itemCreating&&typeof Fe.itemCreating=="function"&&(at=tr(fe[et],Pe),typeof fe[et]=="string"||typeof fe[et]=="number"?nt=Ge:nt=at[Pe.value]);var xe=le("li",{id:it+"-"+et,className:gt?Jt.group:Jt.li,attrs:{role:"presentation"}});if(gt)typeof fe[et]=="string"||typeof fe[et]=="number"?xe.innerText=Ge:xe.innerText=at[Pe.text];else{var je=gt?Fe.groupTemplateID:Fe.templateID;if(gt)if(Me&&Me.getModuleName()!="listview"){var Je=Ye(Ge,Me,"headerTemplate",je,!!Fe.isStringTemplate,null,xe);Je&&(0,a.R3)(Je,xe)}else(0,a.R3)(Ye(Ge,Me,"headerTemplate",je,!!Fe.isStringTemplate),xe);else if(Me&&Me.getModuleName()!=="listview"){var Je=Ye(Ge,Me,"template",je,!!Fe.isStringTemplate,null,xe);Je&&(0,a.R3)(Je,xe)}else(0,a.R3)(Ye(Ge,Me,"template",je,!!Fe.isStringTemplate),xe);xe.setAttribute("data-value",(0,a.le)(nt)?"null":nt),xe.setAttribute("role","option")}if(Fe.itemCreated&&typeof Fe.itemCreated=="function"){var ge={dataSource:fe,curData:Ge,text:nt,item:xe,options:Fe,fields:Pe};Fe.itemCreated(ge)}Ze.push(xe)}return(0,a.R3)(Ze,De),De}o.renderContentTemplate=R;function B(le,de,fe,Le,ke,Me){for(var De=nh(le),Fe=(0,a.l7)({},o.defaultMappedFields,fe),Pe=(0,a.l7)({},e,ke),Ye=Fe.groupBy,Ze=0,nt=Le;Ze<nt.length;Ze++){var it=nt[Ze],et={};if(et[Ye]=it.textContent,it.innerHTML="",Me&&Me.getModuleName()!=="listview"){var at=De(et,Me,"groupTemplate",Pe.groupTemplateID,!!Pe.isStringTemplate,null,it);at&&(0,a.R3)(at,it)}else(0,a.R3)(De(et,Me,"groupTemplate",Pe.groupTemplateID,!!Pe.isStringTemplate),it)}return Le}o.renderGroupTemplate=B;function H(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}o.generateId=H;function j(le,de,fe,Le,ke,Me,De){var Fe=de[fe.child]||[],Pe=de[fe.hasChildren];if(Fe.length&&(Pe=!0,Me.classList.add(Jt.hasChild),ke.processSubChild)){var Ye=l(le,Fe,ke,++De);Me.appendChild(Ye)}if(!!ke.expandCollapse&&Pe&&!ke.template){Me.firstElementChild.classList.add(Jt.iconWrapper);var Ze=ke.expandIconPosition==="Left"?a.Ce:a.R3;Ze([le("div",{className:"e-icons "+ke.expandIconClass})],Me.querySelector("."+Jt.textContent))}}function W(le,de,fe,Le,ke,Me,De,Fe,Pe,Ye){var Ze=(0,a.l7)({},e,Ye),nt=(0,a.l7)({},t,Ze.ariaAttributes),it=de,et=de,at;typeof de!="string"&&typeof de!="number"&&typeof de!="boolean"&&(at=de,it=typeof fe[Le.text]=="boolean"||typeof fe[Le.text]=="number"?fe[Le.text]:fe[Le.text]||"",et=fe[Le.value]);var Ge;!(0,a.le)(at)&&!(0,a.le)(fe[Le.id])&&fe[Le.id]!==""?Ge=Fe:Ge=Fe+"-"+Pe;var gt=le("li",{className:(De===!0?Jt.group:Jt.li)+" "+((0,a.le)(ke)?"":ke),id:Ge,attrs:nt.groupItemRole!==""&&nt.itemRole!==""?{role:De===!0?nt.groupItemRole:nt.itemRole}:{}});return at&&fe.hasOwnProperty(Le.enabled)&&fe[Le.enabled].toString()==="false"&&gt.classList.add(Jt.disabled),De?gt.innerText=it:(gt.setAttribute("data-value",(0,a.le)(et)?"null":et),gt.setAttribute("role","option"),at&&fe.hasOwnProperty(Le.htmlAttributes)&&fe[Le.htmlAttributes]&&L(gt,fe[Le.htmlAttributes]),Me.length&&!Ze.itemNavigable&&(0,a.R3)(Me,gt),at&&(fe[Le.url]||fe[Le.urlAttributes]&&fe[Le.urlAttributes].href)?gt.appendChild(ie(le,at,Le,it,Me,Ze.itemNavigable)):(Me.length&&Ze.itemNavigable&&(0,a.R3)(Me,gt),gt.appendChild(document.createTextNode(it)))),gt}function ne(le){var de;return de={li:"e-"+le+"-item",ul:"e-"+le+"-parent e-ul",group:"e-"+le+"-group-item",icon:"e-"+le+"-icon",text:"e-"+le+"-text",check:"e-"+le+"-check",checked:"e-checked",selected:"e-selected",expanded:"e-expanded",textContent:"e-text-content",hasChild:"e-has-child",level:"e-level",url:"e-"+le+"-url",collapsible:"e-icon-collapsible",disabled:"e-disabled",image:"e-"+le+"-img",iconWrapper:"e-icon-wrapper",anchorWrap:"e-anchor-wrap",navigable:"e-navigable"}}function ie(le,de,fe,Le,ke,Me){var De=tr(de,fe),Fe={href:De[fe.url]};De.hasOwnProperty(fe.urlAttributes)&&De[fe.urlAttributes]&&((0,a.TS)(Fe,De[fe.urlAttributes]),Fe.href=De[fe.url]?De[fe.url]:De[fe.urlAttributes].href);var Pe;if(!Me)Pe=le("a",{className:Jt.text+" "+Jt.url,innerHTML:Le});else{Pe=le("a",{className:Jt.text+" "+Jt.url});var Ye=le("div",{className:Jt.anchorWrap});ke&&ke.length&&(0,a.R3)(ke,Ye),Ye.appendChild(document.createTextNode(Le)),(0,a.R3)([Ye],Pe)}return L(Pe,Fe),Pe}function me(le,de,fe,Le,ke,Me,De){var Fe=(0,a.l7)({},e,Me),Pe=(0,a.l7)({},t,Fe.ariaAttributes),Ye=de,Ze,nt,it;typeof de!="string"&&typeof de!="number"&&(it=de,Ye=fe[Le.text]||"",Ze=(0,a.le)(fe._id)?fe[Le.id]:fe._id,nt=!!(de.hasOwnProperty("isHeader")&&de.isHeader)),Me&&Me.enableHtmlSanitizer&&(Ye=Ye);var et=le("li",{className:(nt===!0?Jt.group:Jt.li)+" "+((0,a.le)(ke)?"":ke),attrs:Pe.groupItemRole!==""&&Pe.itemRole!==""?{role:nt===!0?Pe.groupItemRole:Pe.itemRole}:{}});if((0,a.le)(Ze)?et.setAttribute("data-uid",H()):et.setAttribute("data-uid",Ze),nt&&Me&&Me.groupTemplate){var at=nh(Me.groupTemplate);if(De&&De.getModuleName()!=="listview"){var Ge=at(de,De,"groupTemplate",Fe.groupTemplateID,!!Fe.isStringTemplate,null,et);Ge&&(0,a.R3)(Ge,et)}else(0,a.R3)(at(de,De,"groupTemplate",Fe.groupTemplateID,!!Fe.isStringTemplate),et)}else if(!nt&&Me&&Me.template){var at=nh(Me.template);if(De&&De.getModuleName()!=="listview"){var Ge=at(de,De,"template",Fe.templateID,!!Fe.isStringTemplate,null,et);Ge&&(0,a.R3)(Ge,et)}else(0,a.R3)(at(de,De,"template",Fe.templateID,!!Fe.isStringTemplate),et)}else{var gt=le("div",{className:Jt.textContent,attrs:Pe.wrapperRole!==""?{role:Pe.wrapperRole}:{}});if(it&&(fe[Le.url]||fe[Le.urlAttributes]&&fe[Le.urlAttributes].href))gt.appendChild(ie(le,it,Le,Ye,null,Fe.itemNavigable));else{var ge=le("span",{className:Jt.text,attrs:Pe.itemText!==""?{role:Pe.itemText}:{}});Me&&Me.enableHtmlSanitizer?ge.innerText=Ye:ge.innerHTML=Ye,gt.appendChild(ge)}et.appendChild(gt)}return et}function ve(le,de,fe,Le){var ke=(0,a.l7)({},e,Le),Me=(0,a.l7)({},t,ke.ariaAttributes);Jt=ne(ke.moduleName);var De=le("ul",{className:Jt.ul+" "+((0,a.le)(fe)?"":fe),attrs:Me.listRole!==""?{role:Me.listRole}:{}});return(0,a.R3)(de,De),De}o.generateUL=ve;function Ee(le,de,fe,Le){var ke=(0,a.l7)({},e,Le);Jt=ne(ke.moduleName);var Me=ke.expandIconPosition==="Left"?a.Ce:a.R3;return Me([le("div",{className:"e-icons "+ke.expandIconClass+" "+((0,a.le)(fe)?"":fe)})],de.querySelector("."+Jt.textContent)),de}o.generateIcon=Ee})(Mt||(Mt={}));function tr(o,t){var e={};if((0,a.le)(o)||typeof o=="string"||typeof o=="number"||!(0,a.le)(o.isHeader))return o;for(var i=0,r=Object.keys(t);i<r.length;i++){var n=r[i],s=t[n],l=!(0,a.le)(s)&&typeof s=="string"?(0,a.NA)(s,o):void 0;(0,a.le)(l)||(e[s]=l)}return e}function nh(o){if(o)try{return document.querySelector(o)?(0,a.MY)(document.querySelector(o).innerHTML.trim()):(0,a.MY)(o)}catch(t){return(0,a.MY)(o)}}var dt={RTL:"e-rtl",DISABLE:"e-disabled",INPUT:"e-input",TEXTAREA:"e-multi-line-input",INPUTGROUP:"e-input-group",FLOATINPUT:"e-float-input",FLOATLINE:"e-float-line",FLOATTEXT:"e-float-text",CLEARICON:"e-clear-icon",CLEARICONHIDE:"e-clear-icon-hide",LABELTOP:"e-label-top",LABELBOTTOM:"e-label-bottom",NOFLOATLABEL:"e-no-float-label",INPUTCUSTOMTAG:"e-input-custom-tag",FLOATCUSTOMTAG:"e-float-custom-tag"},Ue;(function(o){var t={container:null,buttons:[],clearButton:null},e,i=!0;function r(ge,xe){var je=(0,a.le)(xe)?a.az:xe,Je={container:null,buttons:[],clearButton:null};if(e=ge.floatLabelType,i=ge.bindClearAction,(0,a.le)(ge.floatLabelType)||ge.floatLabelType==="Never"?(Je.container=j(ge,dt.INPUTGROUP,dt.INPUTCUSTOMTAG,"span",je),ge.element.parentNode.insertBefore(Je.container,ge.element),(0,a.cn)([ge.element],dt.INPUT),Je.container.appendChild(ge.element)):p(ge,Je,je),n(ge),!(0,a.le)(ge.properties)&&!(0,a.le)(ge.properties.showClearButton)&&ge.properties.showClearButton&&ge.element.tagName!=="TEXTAREA"&&(fe(ge.properties.showClearButton,ge.element,Je,!0,je),Je.clearButton.setAttribute("role","button"),Je.container.classList.contains(dt.FLOATINPUT)&&(0,a.cn)([Je.container],dt.INPUTGROUP)),!(0,a.le)(ge.buttons)&&ge.element.tagName!=="TEXTAREA")for(var lt=0;lt<ge.buttons.length;lt++)Je.buttons.push(Ge(ge.buttons[lt],Je.container,je));return!(0,a.le)(ge.element)&&ge.element.tagName==="TEXTAREA"&&(0,a.cn)([Je.container],dt.TEXTAREA),gt(Je.container,ge.element),Je=g(ge,Je),t=Je,Je}o.createInput=r;function n(ge){s(ge.floatLabelType,ge.element),ge.element.addEventListener("focus",function(){var xe=D(this);(xe.classList.contains("e-input-group")||xe.classList.contains("e-outline")||xe.classList.contains("e-filled"))&&xe.classList.add("e-input-focus")}),ge.element.addEventListener("blur",function(){var xe=D(this);(xe.classList.contains("e-input-group")||xe.classList.contains("e-outline")||xe.classList.contains("e-filled"))&&xe.classList.remove("e-input-focus")}),ge.element.addEventListener("input",function(){s(e,ge.element)})}o.bindInitialEvent=n;function s(ge,xe){var je=xe.value;je!==""&&!(0,a.le)(je)&&xe.parentElement?xe.parentElement.classList.add("e-valid-input"):ge!=="Always"&&xe.parentElement&&xe.parentElement.classList.remove("e-valid-input")}function l(){var ge=D(this).getElementsByClassName("e-float-text")[0];(0,a.le)(ge)||((0,a.cn)([ge],dt.LABELTOP),ge.classList.contains(dt.LABELBOTTOM)&&(0,a.IV)([ge],dt.LABELBOTTOM))}function h(){var ge=D(this);if(ge.getElementsByTagName("textarea")[0]?ge.getElementsByTagName("textarea")[0].value==="":ge.getElementsByTagName("input")[0].value===""){var xe=ge.getElementsByClassName("e-float-text")[0];(0,a.le)(xe)||(xe.classList.contains(dt.LABELTOP)&&(0,a.IV)([xe],dt.LABELTOP),(0,a.cn)([xe],dt.LABELBOTTOM))}}function c(ge){ge.addEventListener("focus",l),ge.addEventListener("blur",h)}o.wireFloatingEvents=c;function u(ge){ge.removeEventListener("focus",l),ge.removeEventListener("blur",h)}function p(ge,xe,je){var Je=(0,a.le)(je)?a.az:je;ge.floatLabelType==="Auto"&&c(ge.element),(0,a.le)(xe.container)?(xe.container=j(ge,dt.FLOATINPUT,dt.FLOATCUSTOMTAG,"div",Je),ge.element.parentNode&&ge.element.parentNode.insertBefore(xe.container,ge.element)):((0,a.le)(ge.customTag)||xe.container.classList.add(dt.FLOATCUSTOMTAG),xe.container.classList.add(dt.FLOATINPUT));var lt=Je("span",{className:dt.FLOATLINE}),Qe=Je("label",{className:dt.FLOATTEXT});if(!(0,a.le)(ge.element.id)&&ge.element.id!==""&&(Qe.id="label_"+ge.element.id.replace(/ /g,"_"),(0,a.Y4)(ge.element,{"aria-labelledby":Qe.id})),!(0,a.le)(ge.element.placeholder)&&ge.element.placeholder!==""&&(Qe.innerText=W(ge.element.placeholder),ge.element.removeAttribute("placeholder")),!(0,a.le)(ge.properties)&&!(0,a.le)(ge.properties.placeholder)&&ge.properties.placeholder!==""&&(Qe.innerText=W(ge.properties.placeholder)),Qe.innerText||xe.container.classList.add(dt.NOFLOATLABEL),xe.container.classList.contains("e-float-icon-left")){var Bt=xe.container.querySelector(".e-input-in-wrap");Bt.appendChild(ge.element),Bt.appendChild(lt),Bt.appendChild(Qe)}else xe.container.appendChild(ge.element),xe.container.appendChild(lt),xe.container.appendChild(Qe);L(ge.element.value,Qe),ge.floatLabelType==="Always"&&(Qe.classList.contains(dt.LABELBOTTOM)&&(0,a.IV)([Qe],dt.LABELBOTTOM),(0,a.cn)([Qe],dt.LABELTOP)),ge.floatLabelType==="Auto"&&(ge.element.addEventListener("input",function(pi){L(ge.element.value,Qe,ge.element)}),ge.element.addEventListener("blur",function(pi){L(ge.element.value,Qe)})),(0,a.le)(ge.element.getAttribute("id"))||Qe.setAttribute("for",ge.element.getAttribute("id"))}function f(ge,xe){ge==="Always"&&xe.classList.contains("e-outline")&&xe.classList.add("e-valid-input")}function g(ge,xe){if(!(0,a.le)(ge.properties))for(var je=0,Je=Object.keys(ge.properties);je<Je.length;je++){var lt=Je[je];switch(lt){case"cssClass":ie(ge.properties.cssClass,[xe.container]),f(ge.floatLabelType,xe.container);break;case"enabled":de(ge.properties.enabled,ge.element,ge.floatLabelType,xe.container);break;case"enableRtl":le(ge.properties.enableRtl,[xe.container]);break;case"placeholder":ve(ge.properties.placeholder,ge.element);break;case"readonly":Ee(ge.properties.readonly,ge.element);break}}return xe}function C(ge,xe,je){ge&&!je?(0,a.IV)([xe],dt.CLEARICONHIDE):(0,a.cn)([xe],dt.CLEARICONHIDE)}function L(ge,xe,je){if(je===void 0&&(je=null),ge)(0,a.cn)([xe],dt.LABELTOP),xe.classList.contains(dt.LABELBOTTOM)&&(0,a.IV)([xe],dt.LABELBOTTOM);else{var Je=je!=null?je!==document.activeElement:!0;Je&&(xe.classList.contains(dt.LABELTOP)&&(0,a.IV)([xe],dt.LABELTOP),(0,a.cn)([xe],dt.LABELBOTTOM))}}function D(ge){var xe=(0,a.le)(ge.parentNode)?ge:ge.parentNode;return xe&&xe.classList.contains("e-input-in-wrap")&&(xe=xe.parentNode),xe}function R(ge,xe,je,Je){var lt=(0,a.le)(Je)?a.az:Je,Qe=lt("span",{className:dt.CLEARICON}),Bt=xe.container;if(!(0,a.le)(je))Bt.appendChild(Qe);else{var pi=xe.container.classList.contains(dt.FLOATINPUT)?xe.container.querySelector("."+dt.FLOATTEXT):ge;pi.insertAdjacentElement("afterend",Qe)}return!(0,a.le)(Bt)&&Bt.classList.contains(dt.FLOATINPUT)&&(0,a.cn)([Bt],dt.INPUTGROUP),(0,a.cn)([Qe],dt.CLEARICONHIDE),B(ge,Qe,Bt),Qe.setAttribute("aria-label","close"),Qe}function B(ge,xe,je){(i==null||i)&&xe.addEventListener("click",function(Je){ge.classList.contains(dt.DISABLE)||ge.readOnly||(Je.preventDefault(),ge!==document.activeElement&&ge.focus(),ge.value="",(0,a.cn)([xe],dt.CLEARICONHIDE))}),ge.addEventListener("input",function(Je){C(ge.value,xe)}),ge.addEventListener("focus",function(Je){C(ge.value,xe,ge.readOnly)}),ge.addEventListener("blur",function(Je){setTimeout(function(){(0,a.cn)([xe],dt.CLEARICONHIDE)},200)})}o.wireClearBtnEvents=B;function H(ge,xe){var je=D(ge);if(je.classList.contains(dt.FLOATINPUT)&&xe==="Auto"){var Je=D(ge).getElementsByClassName("e-float-text")[0];L(ge.value,Je,ge)}}function j(ge,xe,je,Je,lt){var Qe=(0,a.le)(lt)?a.az:lt,Bt;return(0,a.le)(ge.customTag)?Bt=Qe(Je,{className:xe}):(Bt=Qe(ge.customTag,{className:xe}),Bt.classList.add(je)),Bt.classList.add("e-control-wrapper"),Bt}function W(ge){var xe="";if(!(0,a.le)(ge)&&ge!==""){var je=document.createElement("span");je.innerHTML='<input  placeholder="'+ge+'"/>';var Je=je.children[0];xe=Je.placeholder}return xe}function ne(ge,xe,je,Je){if(xe.value=ge,!(0,a.le)(je)&&je==="Auto"&&H(xe,je),!(0,a.le)(Je)&&Je){var lt=D(xe);if(!(0,a.le)(lt)){var Qe=lt.getElementsByClassName(dt.CLEARICON)[0];(0,a.le)(Qe)||(xe.value&&lt.classList.contains("e-input-focus")?(0,a.IV)([Qe],dt.CLEARICONHIDE):(0,a.cn)([Qe],dt.CLEARICONHIDE))}}s(je,xe)}o.setValue=ne;function ie(ge,xe,je){!(0,a.le)(je)&&je!==""&&(0,a.IV)(xe,je.split(" ")),!(0,a.le)(ge)&&ge!==""&&(0,a.cn)(xe,ge.split(" "))}o.setCssClass=ie;function me(ge,xe){typeof ge=="number"?xe.style.width=(0,a.Ac)(ge):typeof ge=="string"&&(xe.style.width=ge.match(/px|%|em/)?ge:(0,a.Ac)(ge))}o.setWidth=me;function ve(ge,xe){ge=W(ge);var je=D(xe);je.classList.contains(dt.FLOATINPUT)?!(0,a.le)(ge)&&ge!==""?(je.getElementsByClassName(dt.FLOATTEXT)[0].textContent=ge,je.classList.remove(dt.NOFLOATLABEL),xe.removeAttribute("placeholder")):(je.classList.add(dt.NOFLOATLABEL),je.getElementsByClassName(dt.FLOATTEXT)[0].textContent=""):!(0,a.le)(ge)&&ge!==""?(0,a.Y4)(xe,{placeholder:ge,"aria-placeholder":ge}):(xe.removeAttribute("placeholder"),xe.removeAttribute("aria-placeholder"))}o.setPlaceholder=ve;function Ee(ge,xe,je){ge?(0,a.Y4)(xe,{readonly:""}):xe.removeAttribute("readonly"),(0,a.le)(je)||H(xe,je)}o.setReadonly=Ee;function le(ge,xe){ge?(0,a.cn)(xe,dt.RTL):(0,a.IV)(xe,dt.RTL)}o.setEnableRtl=le;function de(ge,xe,je,Je){var lt={disabled:"disabled","aria-disabled":"true"},Qe=!(0,a.le)(Je);ge?(xe.classList.remove(dt.DISABLE),Le(lt,xe),Qe&&(0,a.IV)([Je],dt.DISABLE)):(xe.classList.add(dt.DISABLE),ke(lt,xe),Qe&&(0,a.cn)([Je],dt.DISABLE)),(0,a.le)(je)||H(xe,je)}o.setEnabled=de;function fe(ge,xe,je,Je,lt){var Qe=(0,a.le)(lt)?a.az:lt;ge?je.clearButton=R(xe,je,Je,Qe):((0,a.Od)(je.clearButton),je.clearButton=null)}o.setClearButton=fe;function Le(ge,xe){for(var je=0,Je=Object.keys(ge);je<Je.length;je++){var lt=Je[je],Qe=D(xe);lt==="disabled"&&xe.classList.remove(dt.DISABLE),lt==="disabled"&&Qe.classList.contains(dt.INPUTGROUP)&&Qe.classList.remove(dt.DISABLE),lt==="placeholder"&&Qe.classList.contains(dt.FLOATINPUT)?Qe.getElementsByClassName(dt.FLOATTEXT)[0].textContent="":xe.removeAttribute(lt)}}o.removeAttributes=Le;function ke(ge,xe){for(var je=0,Je=Object.keys(ge);je<Je.length;je++){var lt=Je[je],Qe=D(xe);lt==="disabled"&&xe.classList.add(dt.DISABLE),lt==="disabled"&&Qe.classList.contains(dt.INPUTGROUP)&&Qe.classList.add(dt.DISABLE),lt==="placeholder"&&Qe.classList.contains(dt.FLOATINPUT)?Qe.getElementsByClassName(dt.FLOATTEXT)[0].textContent=ge[lt]:xe.setAttribute(lt,ge[lt])}}o.addAttributes=ke;function Me(ge){var xe=ge.container;if(!(0,a.le)(xe)&&xe.classList.contains(dt.FLOATINPUT)){var je=xe.querySelector("textarea")?xe.querySelector("textarea"):xe.querySelector("input"),Je=xe.querySelector("."+dt.FLOATTEXT).textContent,lt=xe.querySelector(".e-clear-icon")!==null;(0,a.og)(xe.querySelector("."+dt.FLOATLINE)),(0,a.og)(xe.querySelector("."+dt.FLOATTEXT)),(0,a.s1)(xe,[dt.INPUTGROUP],[dt.FLOATINPUT]),u(je),(0,a.Y4)(je,{placeholder:Je}),je.classList.add(dt.INPUT),!lt&&je.tagName==="INPUT"&&je.removeAttribute("required")}}o.removeFloating=Me;function De(ge,xe,je,Je){var lt=(0,a.le)(Je)?a.az:Je,Qe=(0,a.oq)(ge,"."+dt.INPUTGROUP);if(e=xe,xe!=="Never"){var Bt=Qe.tagName;Bt=Bt!=="DIV"&&Bt!=="SPAN"?Bt:null;var pi={element:ge,floatLabelType:xe,customTag:Bt,properties:{placeholder:je}},si=Qe.querySelector(".e-clear-icon"),Gt={container:Qe};ge.classList.remove(dt.INPUT),p(pi,Gt,lt);var Pi=Qe.classList.contains("e-float-icon-left");if((0,a.le)(si))if(Pi){var Gr=Qe.querySelector(".e-input-in-wrap");si=Gr.querySelector(".e-input-group-icon")}else si=Qe.querySelector(".e-input-group-icon");if((0,a.le)(si))Pi&&(si=Qe.querySelector(".e-input-group-icon")),(0,a.le)(si)&&Qe.classList.remove(dt.INPUTGROUP);else{var Kr=Qe.querySelector("."+dt.FLOATLINE),as=Qe.querySelector("."+dt.FLOATTEXT),Xr=Pi?Qe.querySelector(".e-input-in-wrap"):Qe;Xr.insertBefore(ge,si),Xr.insertBefore(Kr,si),Xr.insertBefore(as,si)}}f(xe,ge.parentElement)}o.addFloating=De;function Fe(ge,xe){for(var je=0;je<xe.length;je++)Pe(ge,xe[je].container)}o.setRipple=Fe;function Pe(ge,xe,je){var Je=[];Je.push(je);var lt=(0,a.le)(je)?xe.querySelectorAll(".e-input-group-icon"):Je;if(ge&&lt.length>0)for(var Qe=0;Qe<lt.length;Qe++)lt[Qe].addEventListener("mousedown",Ze,!1),lt[Qe].addEventListener("mouseup",nt,!1);else if(lt.length>0)for(var Qe=0;Qe<lt.length;Qe++)lt[Qe].removeEventListener("mousedown",Ze,this),lt[Qe].removeEventListener("mouseup",nt,this)}function Ye(ge,xe){!ge.classList.contains("e-disabled")&&!ge.querySelector("input").readOnly&&xe.classList.add("e-input-btn-ripple")}function Ze(){for(var ge=this,xe=this.parentElement;!xe.classList.contains("e-input-group");)xe=xe.parentElement;Ye(xe,ge)}function nt(){var ge=this;setTimeout(function(){ge.classList.remove("e-input-btn-ripple")},500)}function it(ge,xe){var je=xe("span",{className:ge});return je.classList.add("e-input-group-icon"),je}function et(ge,xe,je,Je,lt){var Qe=typeof xe=="string"?xe.split(","):xe;if(ge.toLowerCase()==="append")for(var Bt=0,pi=Qe;Bt<pi.length;Bt++){var si=pi[Bt];Ge(si,je,lt)}else for(var Gt=0,Pi=Qe;Gt<Pi.length;Gt++){var si=Pi[Gt];at(si,je,Je,lt)}}o.addIcon=et;function at(ge,xe,je,Je){var lt=(0,a.le)(Je)?a.az:Je,Qe=it(ge,lt);xe.classList.add("e-float-icon-left");var Bt=xe.querySelector(".e-input-in-wrap");if((0,a.le)(Bt)){Bt=lt("span",{className:"e-input-in-wrap"}),je.parentNode.insertBefore(Bt,je);var pi=xe.querySelectorAll(je.tagName+" ~ *");Bt.appendChild(je);for(var si=0;si<pi.length;si++)Bt.appendChild(pi[si])}return Bt.parentNode.insertBefore(Qe,Bt),xe.classList.contains(dt.INPUTGROUP)||xe.classList.add(dt.INPUTGROUP),Pe(!0,xe,Qe),Qe}o.prependSpan=at;function Ge(ge,xe,je){var Je=(0,a.le)(je)?a.az:je,lt=it(ge,Je);xe.classList.contains(dt.INPUTGROUP)||xe.classList.add(dt.INPUTGROUP);var Qe=xe.classList.contains("e-float-icon-left")?xe.querySelector(".e-input-in-wrap"):xe;return Qe.appendChild(lt),Pe(!0,xe,lt),lt}o.appendSpan=Ge;function gt(ge,xe){xe.type==="hidden"?ge.classList.add("e-hidden"):ge.classList.contains("e-hidden")&&ge.classList.remove("e-hidden")}o.validateInputType=gt})(Ue||(Ue={}));var ir={},Ay=30,Nf=30,Ty=30,DA=24,Ly=30,ky=36,Iy=36,zo="e-spin-show",_o="e-spin-hide",Bf="e-spin-material",Ff="e-spin-fabric",Hf="e-spin-fluent",Vf="e-spin-tailwind",Dy="e-spin-bootstrap",zf="e-spin-bootstrap4",_f="e-spin-bootstrap5",jf="e-spin-high-contrast",sh="e-spinner-pane",Eu="e-spinner-inner",ah="e-path-circle",Oy="e-path-arc",Ry="e-spin-label",oh="e-spin-template",lh=null,Au=null;function OA(o,t,e,i){switch(o){case"Create":var r=document.querySelector(t.target),n={type:i,target:r,cssClass:t.cssClass,label:t.label,width:t.width};Ha(n);break;case"Show":jn(document.querySelector(e));break;case"Hide":Cs(document.querySelector(e));break;case"Set":var s={cssClass:t.cssClass,type:i};nb(s);break}}function Ha(o,t){if(!!o.target){var e,i=(0,a.le)(t)?a.az:t,r=$y(o.target,i);if((0,a.le)(o.cssClass)||r.wrap.classList.add(o.cssClass),!(0,a.le)(o.template)||!(0,a.le)(lh)){var n=(0,a.le)(o.template)?lh:o.template;r.wrap.classList.add(oh),Gy(r.wrap,n,Au)}else{var s=(0,a.le)(o.type)?jy(r.wrap):o.type,l=(0,a.le)(o.width)?void 0:o.width;e=Ky(l,s),Wf(s,r.wrap,e,i),(0,a.le)(o.label)||My(r.inner_wrap,o.label,i)}r.wrap.classList.add(_o),r=null}}function My(o,t,e){var i=e("div",{});return i.classList.add(Ry),i.innerHTML=t,o.appendChild(i),i}function Py(o,t,e){var i=bs();ir[i]={timeOut:0,type:"Material",radius:t},Tu(o,i,e,Bf),Lu(t,o,"Material",Bf)}function Ny(o,t,e){var i=bs();ir[i]={timeOut:0,type:"Bootstrap4",radius:t},Tu(o,i,e,zf),Lu(t,o,"Bootstrap4",zf)}function By(o,t,e){var i=bs();ir[i]={timeOut:0,type:"Bootstrap5",radius:t},Tu(o,i,e,_f),Lu(t,o,"Bootstrap5",_f)}function Fy(o,t,e){var i={},r=0;ir[t].timeOut=0,i[t]=Xy(t,e,0,0);var n={uniqueID:t,container:o,globalInfo:i,timeOutVar:r};Uf(n)}function Hy(o,t,e){var i=bs();ir[i]={timeOut:0,type:"Fabric",radius:t},hh(o,i,Ff,e),ch(t,o,Ff)}function Vy(o,t,e){var i=bs();ir[i]={timeOut:0,type:"Fluent",radius:t},hh(o,i,Hf,e),ch(t,o,Hf)}function zy(o,t,e){var i=bs();ir[i]={timeOut:0,type:"Tailwind",radius:t},hh(o,i,Vf,e),ch(t,o,Vf)}function _y(o,t,e){var i=bs();ir[i]={timeOut:0,type:"HighContrast",radius:t},hh(o,i,jf,e),ch(t,o,jf)}function jy(o){var t=window.getComputedStyle(o,":after").getPropertyValue("content");return t.replace(/['"]+/g,"")}function Wf(o,t,e,i){var r=t.querySelector("."+Eu),n=r.querySelector("svg");switch((0,a.le)(n)||r.removeChild(n),o){case"Material":Py(r,e,i);break;case"Fabric":Hy(r,e,i);break;case"Fluent":Vy(r,e,i);break;case"Bootstrap":Wy(r,e,i);break;case"HighContrast":_y(r,e,i);break;case"Bootstrap4":Ny(r,e,i);break;case"Bootstrap5":By(r,e,i);break;case"Tailwind":case"Tailwind-dark":zy(r,e,i);break}}function Wy(o,t,e){var i=bs();ir[i]={timeOut:0,type:"Bootstrap",radius:t},Uy(o,i,e),qy(o,t)}function Uy(o,t,e){var i=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=64,n=32,s=2;i.setAttribute("id",t),i.setAttribute("class",Dy),i.setAttribute("viewBox","0 0 "+r+" "+r),o.insertBefore(i,o.firstChild);for(var l=0;l<=7;l++){var h=document.createElementNS("http://www.w3.org/2000/svg","circle");h.setAttribute("class",ah+"_"+l),h.setAttribute("r",s+""),h.setAttribute("transform","translate("+n+","+n+")"),i.appendChild(h)}}function qy(o,t){var e=o.querySelector("svg.e-spin-bootstrap"),i=0,r=0,n=24;e.style.width=e.style.height=t+"px";for(var s=90,l=0;l<=7;l++){var h=ku(i,r,n,s),c=e.querySelector("."+ah+"_"+l);c.setAttribute("cx",h.x+""),c.setAttribute("cy",h.y+""),s=s>=360?0:s,s=s+45}}function Zy(o,t){var e=[],i=o,r=t,n=!1,s=1;l(i);function l(h){e.push(h),(h!==r||s===1)&&(h<=i&&h>1&&!n?h=parseFloat((h-.2).toFixed(2)):h===1?(h=7,h=parseFloat((h+.2).toFixed(2)),n=!0):h<8&&n?(h=parseFloat((h+.2).toFixed(2)),h===8&&(n=!1)):h<=8&&!n&&(h=parseFloat((h-.2).toFixed(2))),++s,l(h))}return e}function Yy(o){for(var t=o.querySelector("svg.e-spin-bootstrap"),e=t.getAttribute("id"),i=1;i<=8;i++){var r=o.getElementsByClassName("e-path-circle_"+(i===8?0:i))[0];n(r,i,i,Zy(i,i),e)}function n(s,l,h,c,u){var p=0;f(l);function f(g){ir[u].isAnimate&&(++p,s.setAttribute("r",g+""),p>=c.length&&(p=0),ir[u].timeOut=setTimeout(f.bind(null,c[p]),18))}}}function Gy(o,t,e){(0,a.le)(e)||o.classList.add(e);var i=o.querySelector(".e-spinner-inner");i.innerHTML=t}function Ky(o,t){var e;switch(t){case"Material":e=Ay;break;case"Fabric":e=Nf;break;case"Tailwind":case"Tailwind-dark":e=Nf;break;case"Fluent":e=Ty;break;case"Bootstrap4":e=ky;break;case"Bootstrap5":e=Iy;break;default:e=Ly}return o=o?parseFloat(o+""):e,t==="Bootstrap"?o:o/2}function Xy(o,t,e,i){return{radius:t,count:e,previousId:i}}function bs(){for(var o="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=0;e<5;e++)o+=t.charAt(Math.floor(Math.random()*t.length));return o}function hh(o,t,e,i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("id",t),r.setAttribute("class",e);var n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("class",ah);var s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("class",Oy),o.insertBefore(r,o.firstChild),r.appendChild(n),r.appendChild(s)}function Tu(o,t,e,i){var r=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("class",i),r.setAttribute("id",t),n.setAttribute("class",ah),o.insertBefore(r,o.firstChild),r.appendChild(n)}function $y(o,t){var e=t("div",{}),i=t("div",{});return e.classList.add(sh),i.classList.add(Eu),o.appendChild(e),e.appendChild(i),{wrap:e,inner_wrap:i}}function Uf(o){var t=1,e=149,i=1333,r=75;Qy(t,e,tb,i,o.globalInfo[o.uniqueID].count,r,o),o.globalInfo[o.uniqueID].count=++o.globalInfo[o.uniqueID].count%4}function Qy(o,t,e,i,r,n,s){var l=++s.globalInfo[s.uniqueID].previousId,h=new Date().getTime(),c=t-o,u=Jy(s.globalInfo[s.uniqueID].radius*2+""),p=qf(u),f=-90*(s.globalInfo[s.uniqueID].count||0);g(s);function g(L){var D=Math.max(0,Math.min(new Date().getTime()-h,i));C(e(D,o,c,i),L.container),l===L.globalInfo[L.uniqueID].previousId&&D<i?ir[L.uniqueID].timeOut=setTimeout(g.bind(null,L),1):Uf(L)}function C(L,D){if(!(0,a.le)(D.querySelector("svg.e-spin-material"))&&!(0,a.le)(D.querySelector("svg.e-spin-material").querySelector("path.e-path-circle"))){var R=D.querySelector("svg.e-spin-material"),B=R.querySelector("path.e-path-circle");B.setAttribute("stroke-dashoffset",Zf(u,p,L,n)+""),B.setAttribute("transform","rotate("+f+" "+u/2+" "+u/2+")")}}}function Lu(o,t,e,i){var r=o*2,n=t.querySelector("svg."+i),s=n.querySelector("path.e-path-circle"),l=qf(r),h=r/2+"px";n.setAttribute("viewBox","0 0 "+r+" "+r),n.style.width=n.style.height=r+"px",n.style.transformOrigin=h+" "+h+" "+h,s.setAttribute("d",eb(r,l)),e==="Material"&&(s.setAttribute("stroke-width",l+""),s.setAttribute("stroke-dasharray",(r-l)*Math.PI*.75+""),s.setAttribute("stroke-dashoffset",Zf(r,l,1,75)+""))}function Jy(o){var t=parseFloat(o);return t}function eb(o,t){var e=o/2,i=t/2;return"M"+e+","+i+"A"+(e-i)+","+(e-i)+" 0 1 1 "+i+","+e}function qf(o){return 10/100*o}function Zf(o,t,e,i){return(o-t)*Math.PI*(3*i/100-e/100)}function tb(o,t,e,i){var r=(o/=i)*o,n=r*o;return t+e*(6*n*r+-15*r*r+10*n)}function ch(o,t,e){var i=o,r=o,n=o*2,s=315,l=45,h=t.querySelector("."+e),c=h.querySelector(".e-path-circle"),u=h.querySelector(".e-path-arc"),p=n/2+"px";c.setAttribute("d",rb(i,r,o)),u.setAttribute("d",ib(i,r,o,s,l)),h.setAttribute("viewBox","0 0 "+n+" "+n),h.style.transformOrigin=p+" "+p+" "+p,h.style.width=h.style.height=n+"px"}function ku(o,t,e,i){var r=(i-90)*Math.PI/180;return{x:o+e*Math.cos(r),y:t+e*Math.sin(r)}}function ib(o,t,e,i,r){var n=ku(o,t,e,r),s=ku(o,t,e,i),l=["M",n.x,n.y,"A",e,e,0,0,0,s.x,s.y].join(" ");return l}function rb(o,t,e){var i=["M",o,t,"m",-e,0,"a",e,e,0,1,0,e*2,0,"a",e,e,0,1,0,-e*2,0].join(" ");return i}function jn(o){Yf(o,!1),o=null}function Yf(o,t){var e;if(o&&(e=o.classList.contains(sh)?o:o.querySelector("."+sh)),o&&e){var i=e.querySelector("."+Eu),r=void 0;if(r=t?!e.classList.contains(oh)&&!e.classList.contains(_o):!e.classList.contains(oh)&&!e.classList.contains(zo),r){var n=e.querySelector("svg");if((0,a.le)(n))return;var s=n.getAttribute("id");switch(ir[s].isAnimate=!t,ir[s].type){case"Material":t?clearTimeout(ir[s].timeOut):Fy(i,s,ir[s].radius);break;case"Bootstrap":t?clearTimeout(ir[s].timeOut):Yy(i);break}}t?(0,a.s1)(e,[_o],[zo]):(0,a.s1)(e,[zo],[_o]),o=null}}function Cs(o){Yf(o,!0),o=null}function nb(o,t){var e=isNullOrUndefined(t)?createElement:t;o.template!==void 0&&(lh=o.template,o.template!==void 0&&(Au=o.cssClass));for(var i=document.querySelectorAll("."+sh),r=0;r<i.length;r++)sb(o.template,i[r],o.type,o.cssClass,e)}function sb(o,t,e,i,r){isNullOrUndefined(o)&&!t.classList.contains(oh)?(ab(t,e,i,r),t.classList.contains(zo)?(t.classList.remove(zo),jn(t)):(t.classList.remove(_o),Cs(t))):(lh=o,isNullOrUndefined(i)||(Au=i))}function ab(o,t,e,i){isNullOrUndefined(e)||o.classList.add(e);var r=o.querySelector("svg"),n=t==="Bootstrap"?parseFloat(r.style.height):parseFloat(r.style.height)/2,s=r.getAttribute("class"),l=s.split(/\s/);if(l.indexOf("e-spin-material")>=0){var h=r.getAttribute("id");clearTimeout(ir[h].timeOut)}Wf(t,o,n,i)}var uh=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ct=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},fn="e-treeview",Gf="e-control",Ji="e-icon-collapsible",di="e-icon-expandable",kt="e-list-item",ia="e-list-text",ob="e-text-wrap",lb="e-ie-wrap",qt="e-list-parent",An="e-hover",Rr="e-active",Iu="e-icons-spinner",Wn="e-process",Ui="e-icons",Yi="e-text-content",ph="e-input",Kf="e-input-group",dh="e-tree-input",Du="e-editing",Xf="e-rtl",$f="e-interaction",hb="e-drag-item",Qf="e-droppable",Ou="e-dragging",jo="e-sibling",fh="e-drop-in",Wo="e-drop-next",Ru="e-drop-out",Mu="e-no-drop",cb="e-fullrow-wrap",Un="e-fullrow",Va="e-selected",vh="e-expanded",Jf="e-node-collapsed",ev="e-disable",ub="e-drop-count",sr="e-check",en="e-stop",_r="e-checkbox-wrapper",qn="e-frame",pb="e-ripple-container",tv="e-ripple",db="e-ripple-element",za="e-node-focus",iv="e-list-img",fb="e-bigger",vb="e-small",mb="e-has-child",mh="e-animation-active",rv="e-disabled",nv={treeRole:"tree",itemRole:"treeitem",listRole:"group",itemText:"",wrapperRole:""},gb=function(o){uh(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ct([(0,a.Z9)("child")],t.prototype,"child",void 0),Ct([(0,a.Z9)([])],t.prototype,"dataSource",void 0),Ct([(0,a.Z9)("expanded")],t.prototype,"expanded",void 0),Ct([(0,a.Z9)("hasChildren")],t.prototype,"hasChildren",void 0),Ct([(0,a.Z9)("htmlAttributes")],t.prototype,"htmlAttributes",void 0),Ct([(0,a.Z9)("iconCss")],t.prototype,"iconCss",void 0),Ct([(0,a.Z9)("id")],t.prototype,"id",void 0),Ct([(0,a.Z9)("imageUrl")],t.prototype,"imageUrl",void 0),Ct([(0,a.Z9)("isChecked")],t.prototype,"isChecked",void 0),Ct([(0,a.Z9)("parentID")],t.prototype,"parentID",void 0),Ct([(0,a.Z9)(null)],t.prototype,"query",void 0),Ct([(0,a.Z9)("selected")],t.prototype,"selected",void 0),Ct([(0,a.Z9)(null)],t.prototype,"tableName",void 0),Ct([(0,a.Z9)("text")],t.prototype,"text",void 0),Ct([(0,a.Z9)("tooltip")],t.prototype,"tooltip",void 0),Ct([(0,a.Z9)("navigateUrl")],t.prototype,"navigateUrl",void 0),t}(a.rt),sv=function(o){uh(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ct([(0,a.Z9)("SlideDown")],t.prototype,"effect",void 0),Ct([(0,a.Z9)(400)],t.prototype,"duration",void 0),Ct([(0,a.Z9)("linear")],t.prototype,"easing",void 0),t}(a.rt),yb=function(o){uh(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ct([(0,a.Zz)({effect:"SlideUp",duration:400,easing:"linear"},sv)],t.prototype,"collapse",void 0),Ct([(0,a.Zz)({effect:"SlideDown",duration:400,easing:"linear"},sv)],t.prototype,"expand",void 0),t}(a.rt),av=function(o){uh(t,o);function t(i,r){var n=o.call(this,i,r)||this;return n.isRefreshed=!1,n.preventExpand=!1,n.checkedElement=[],n.disableNode=[],n.validArr=[],n.validNodes=[],n.expandChildren=[],n.isFieldChange=!1,n.changeDataSource=!1,n.hasTemplate=!1,n.isFirstRender=!1,n.mouseDownStatus=!1,n}e=t,t.prototype.getModuleName=function(){return"treeview"},t.prototype.preRender=function(){var i=this;this.checkActionNodes=[],this.parentNodeCheck=[],this.dragStartAction=!1,this.isAnimate=!1,this.keyConfigs={escape:"escape",end:"end",enter:"enter",f2:"f2",home:"home",moveDown:"downarrow",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",ctrlDown:"ctrl+downarrow",ctrlUp:"ctrl+uparrow",ctrlEnter:"ctrl+enter",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",ctrlA:"ctrl+A",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftEnter:"shift+enter",shiftHome:"shift+home",shiftEnd:"shift+end",csDown:"ctrl+shift+downarrow",csUp:"ctrl+shift+uparrow",csEnter:"ctrl+shift+enter",csHome:"ctrl+shift+home",csEnd:"ctrl+shift+end",space:"space"},this.listBaseOption={expandCollapse:!0,showIcon:!0,expandIconClass:di,ariaAttributes:nv,expandIconPosition:"Left",itemCreated:function(r){i.beforeNodeCreate(r)},enableHtmlSanitizer:this.enableHtmlSanitizer,itemNavigable:this.fullRowNavigable},this.updateListProp(this.fields),this.aniObj=new a.fw({}),this.treeList=[],this.isLoaded=!1,this.isInitalExpand=!1,this.expandChildren=[],this.index=0,this.setTouchClass(),(0,a.le)(this.selectedNodes)&&this.setProperties({selectedNodes:[]},!0),(0,a.le)(this.checkedNodes)&&this.setProperties({checkedNodes:[]},!0),(0,a.le)(this.expandedNodes)?this.setProperties({expandedNodes:[]},!0):this.isInitalExpand=!0},t.prototype.getPersistData=function(){var i=["selectedNodes","checkedNodes","expandedNodes"];return this.addOnPersist(i)},t.prototype.render=function(){this.initialRender=!0,this.initialize(),this.setDataBinding(!1),this.setDisabledMode(),this.setExpandOnType(),this.disabled||this.setRipple(),this.wireEditingEvents(this.allowEditing),this.setDragAndDrop(this.allowDragAndDrop),this.disabled||this.wireEvents(),this.initialRender=!1,this.renderComplete()},t.prototype.initialize=function(){this.element.setAttribute("role","tree"),this.element.setAttribute("tabindex","0"),this.element.setAttribute("aria-activedescendant",this.element.id+"_active"),this.setCssClass(null,this.cssClass),this.setEnableRtl(),this.setFullRow(this.fullRowSelect),this.setTextWrap(),this.nodeTemplateFn=this.templateComplier(this.nodeTemplate)},t.prototype.setDisabledMode=function(){this.disabled?this.element.classList.add(rv):this.element.classList.remove(rv)},t.prototype.setEnableRtl=function(){(this.enableRtl?a.cn:a.IV)([this.element],Xf)},t.prototype.setRipple=function(){var i="."+Un+",."+Yi,r={selector:i,ignore:"."+Yi+" > ."+Ui+",."+Kf+",."+ph+", ."+_r};this.rippleFn=(0,a.qx)(this.element,r);var n={selector:"."+Yi+" > ."+Ui,isCenterRipple:!0};this.rippleIconFn=(0,a.qx)(this.element,n)},t.prototype.setFullRow=function(i){(i?a.cn:a.IV)([this.element],cb)},t.prototype.setMultiSelect=function(i){var r=(0,a.Ys)("."+qt,this.element);i?r.setAttribute("aria-multiselectable","true"):r.removeAttribute("aria-multiselectable")},t.prototype.templateComplier=function(i){if(i){this.hasTemplate=!0;var r=void 0;this.element.classList.add($f);try{return document.querySelectorAll(i).length?(0,a.MY)(document.querySelector(i).innerHTML.trim()):(0,a.MY)(i)}catch(n){return(0,a.MY)(i)}}this.element.classList.remove($f)},t.prototype.setDataBinding=function(i){var r=this;this.treeList.push("false"),this.fields.dataSource instanceof Oe.h?(this.isOffline=this.fields.dataSource.dataSource.offline,this.fields.dataSource.ready?this.fields.dataSource.ready.then(function(n){r.isOffline=r.fields.dataSource.dataSource.offline,r.fields.dataSource instanceof Oe.h&&r.isOffline&&(r.treeList.pop(),r.treeData=n.result,r.isNumberTypeId=r.getType(),r.setRootData(),r.renderItems(!0),r.treeList.length===0&&!r.isLoaded&&r.finalize())}).catch(function(n){r.trigger("actionFailure",{error:n})}):this.fields.dataSource.executeQuery(this.getQuery(this.fields)).then(function(n){r.treeList.pop(),r.treeData=n.result,r.isNumberTypeId=r.getType(),r.setRootData(),i&&(r.changeDataSource=!0),r.renderItems(!0),r.changeDataSource=!1,r.treeList.length===0&&!r.isLoaded&&r.finalize()}).catch(function(n){r.trigger("actionFailure",{error:n})})):(this.treeList.pop(),(0,a.le)(this.fields.dataSource)?this.rootData=this.treeData=[]:(this.treeData=JSON.parse(JSON.stringify(this.fields.dataSource)),this.setRootData()),this.isNumberTypeId=this.getType(),this.renderItems(!1)),this.treeList.length===0&&!this.isLoaded&&this.finalize()},t.prototype.getQuery=function(i,r){r===void 0&&(r=null);var n=[],s;if(i.query)s=i.query.clone();else{s=new yt.A;for(var l=this.getActualProperties(i),h=0,c=Object.keys(l);h<c.length;h++){var u=c[h];u!=="dataSource"&&u!=="tableName"&&u!=="child"&&!!i[u]&&u!=="url"&&n.indexOf(i[u])===-1&&n.push(i[u])}s.select(n),l.hasOwnProperty("tableName")&&s.from(i.tableName)}return Mt.addSorting(this.sortOrder,i.text,s),!(0,a.le)(r)&&!(0,a.le)(i.parentID)&&s.where(i.parentID,"equal",this.isNumberTypeId?parseFloat(r):r),s},t.prototype.getType=function(){return this.treeData[0]?typeof(0,a.NA)(this.fields.id,this.treeData[0])=="number":!1},t.prototype.setRootData=function(){if(this.dataType=this.getDataType(this.treeData,this.fields),this.dataType===1){this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID);var i=this.getChildNodes(this.treeData,void 0,!0);(0,a.le)(i)?this.rootData=[]:this.rootData=i}else this.rootData=this.treeData},t.prototype.renderItems=function(i){this.listBaseOption.ariaAttributes.level=1;var r=this.getSortedData(this.rootData);this.ulElement=Mt.createList(this.createElement,i?this.rootData:r,this.listBaseOption),this.element.appendChild(this.ulElement);var n=this.ulElement.querySelectorAll(".e-list-item");if(this.loadOnDemand===!1)for(var s=0;s<n.length;)this.renderChildNodes(n[s],!0,null,!0),s++;var l=(0,a.td)("."+qt,this.element);(l.length===1&&n&&n.length!==0||this.loadOnDemand)&&this.finalizeNode(this.element),this.parentNodeCheck=[],this.parentCheckData=[],this.updateCheckedStateFromDS(),this.autoCheck&&this.showCheckBox&&!this.isLoaded&&this.updateParentCheckState()},t.prototype.updateCheckedStateFromDS=function(i){if(this.validNodes=[],this.treeData&&this.showCheckBox){if(this.dataType===1){for(var r=this.fields,n=new Oe.h(this.treeData).executeLocal(new yt.A().where(r.isChecked,"equal",!0,!1)),s=0;s<n.length;s++){var l=n[s][this.fields.id]?n[s][this.fields.id].toString():null,h=n[s][this.fields.parentID]?n[s][this.fields.parentID].toString():null;if(this.checkedNodes.indexOf(l)===-1&&!this.isLoaded&&this.checkedNodes.push(l),n[s][this.fields.hasChildren])for(var c=n[s][this.fields.id],u=new Oe.h(this.treeData).executeLocal(new yt.A().where(r.parentID,"equal",c,!1)),p=0;p<u.length;p++){var f=u[p][this.fields.id]?u[p][this.fields.id].toString():null;this.checkedNodes.indexOf(f)===-1&&this.autoCheck&&this.checkedNodes.push(f)}}for(var s=0;s<this.checkedNodes.length;s++){var g=this.fields,C=new Oe.h(this.treeData).executeLocal(new yt.A().where(g.id,"equal",this.checkedNodes[s],!0));if(C[0]&&this.autoCheck&&(this.getCheckedNodeDetails(g,C),this.checkIndeterminateState(C[0])),C.length>0){var L=C[0][this.fields.id]?C[0][this.fields.id].toString():null;this.checkedNodes.indexOf(L)>-1&&this.validNodes.indexOf(L)===-1&&this.validNodes.push(L)}for(var D=new Oe.h(this.treeData).executeLocal(new yt.A().where(g.parentID,"equal",this.checkedNodes[s],!0)),R=0;R<D.length;R++){var L=D[R][this.fields.id]?D[R][this.fields.id].toString():null;this.checkedNodes.indexOf(L)===-1&&this.autoCheck&&this.checkedNodes.push(L),this.checkedNodes.indexOf(L)>-1&&this.validNodes.indexOf(L)===-1&&this.validNodes.push(L)}}}else if(this.dataType===2||this.fields.dataSource instanceof Oe.h&&this.isOffline)for(var R=0;R<this.treeData.length;R++){var B=this.treeData[R][this.fields.id]?this.treeData[R][this.fields.id].toString():"";this.treeData[R][this.fields.isChecked]&&!this.isLoaded&&this.checkedNodes.indexOf(B)===-1&&this.checkedNodes.push(B),this.checkedNodes.indexOf(B)>-1&&this.validNodes.indexOf(B)===-1&&this.validNodes.push(B);var H=(0,a.NA)(this.fields.child.toString(),this.treeData[R]);H&&this.updateChildCheckState(H,this.treeData[R])}this.setProperties({checkedNodes:this.validNodes},!0)}},t.prototype.getCheckedNodeDetails=function(i,r){var n=r[0][this.fields.parentID]?r[0][this.fields.parentID].toString():null,s=0,l=this.element.querySelector('[data-uid="'+r[0][this.fields.id]+'"]'),h=this.element.querySelector('[data-uid="'+r[0][this.fields.parentID]+'"]');if(!l&&!h){var c=this.parentNodeCheck.length;this.parentNodeCheck.indexOf(n)===-1&&this.parentNodeCheck.push(n);for(var u=this.getChildNodes(this.treeData,n),p=0;p<u.length;p++){var f=u[p][this.fields.id]?u[p][this.fields.id].toString():null;this.checkedNodes.indexOf(f)!==-1&&s++,s===u.length&&this.checkedNodes.indexOf(n)===-1&&this.checkedNodes.push(n)}var g=new Oe.h(this.treeData).executeLocal(new yt.A().where(i.id,"equal",n,!0));this.getCheckedNodeDetails(i,g)}else if(h){var C=(0,a.Ys)("."+sr,h);C||this.changeState(h,"indeterminate",null,!0,!0)}},t.prototype.updateParentCheckState=function(){for(var i=(0,a.td)("."+en,this.element),r,n=0;n<i.length;n++){var s=(0,a.oq)(i[n],"."+kt),l=s.getAttribute("data-uid").toString();this.dataType===1?r=new Oe.h(this.treeData).executeLocal(new yt.A().where(this.fields.parentID,"equal",l,!0)):r=this.getChildNodes(this.treeData,l);var h=0;if(r){for(var c=0;c<r.length;c++){var u=r[c][this.fields.id].toString();this.checkedNodes.indexOf(u)!==-1&&h++}if(h===r.length){var p=s.getAttribute("data-uid");this.checkedNodes.indexOf(p)===-1&&this.checkedNodes.push(p),this.changeState(s,"check",null,!0,!0)}else h===0&&this.checkedNodes.length===0&&this.changeState(s,"uncheck",null,!0,!0)}}},t.prototype.checkIndeterminateState=function(i){var r;if(this.dataType===1?r=this.element.querySelector('[data-uid="'+i[this.fields.parentID]+'"]'):r=this.element.querySelector('[data-uid="'+i[this.fields.id]+'"]'),r){var n=r.querySelector("."+_r).getAttribute("aria-checked");n!=="true"&&this.changeState(r,"indeterminate",null,!0,!0)}else if(this.dataType===2){var s=this.parentNodeCheck.length;this.parentNodeCheck.indexOf(i[this.fields.id].toString())===-1&&this.parentNodeCheck.push(i[this.fields.id].toString())}},t.prototype.updateChildCheckState=function(i,r){for(var n=0,s=r[this.fields.id]?r[this.fields.id].toString():"",l=0;l<i.length;l++){var h=i[l][this.fields.id]?i[l][this.fields.id].toString():"";i[l][this.fields.isChecked]&&!this.isLoaded&&this.checkedNodes.indexOf(h)===-1&&this.checkedNodes.push(h),this.checkedNodes.indexOf(s)!==-1&&this.checkedNodes.indexOf(h)===-1&&this.autoCheck&&this.checkedNodes.push(h),this.checkedNodes.indexOf(h)!==-1&&this.autoCheck&&n++,this.checkedNodes.indexOf(h)>-1&&this.validNodes.indexOf(h)===-1&&this.validNodes.push(h);var c=(0,a.NA)(this.fields.child.toString(),i[l]);c&&c.length&&(this.parentCheckData.indexOf(r)===-1&&this.parentCheckData.push(r),this.updateChildCheckState(c,i[l])),n===i.length&&this.autoCheck&&this.checkedNodes.indexOf(s)===-1&&this.checkedNodes.push(s)}if(n!==0&&this.autoCheck){this.checkIndeterminateState(r);for(var u=0;u<this.parentCheckData.length;u++)r!==this.parentCheckData[u]&&this.parentCheckData[u]&&this.checkIndeterminateState(this.parentCheckData[u])}},t.prototype.beforeNodeCreate=function(i){if(this.showCheckBox){var r=os(this.createElement,!0,{cssClass:this.touchClass});r.setAttribute("role","checkbox");var n=(0,a.Ys)("div."+Ui,i.item),s=i.item.getAttribute("data-uid");i.item.childNodes[0].insertBefore(r,i.item.childNodes[0].childNodes[(0,a.le)(n)?0:1]);var l=(0,a.NA)(i.fields.isChecked,i.curData);this.checkedNodes.indexOf(s)>-1?((0,a.Ys)("."+qn,r).classList.add(sr),r.setAttribute("aria-checked","true"),this.addCheck(i.item)):!(0,a.le)(l)&&l.toString()==="true"?((0,a.Ys)("."+qn,r).classList.add(sr),r.setAttribute("aria-checked","true"),this.addCheck(i.item)):r.setAttribute("aria-checked","false");var h=(0,a.Ys)("."+qn,r);a.bi.add(h,"mousedown",this.frameMouseHandler,this),a.bi.add(h,"mouseup",this.frameMouseHandler,this)}this.fullRowSelect&&this.createFullRow(i.item),this.allowMultiSelection&&!i.item.classList.contains(Va)&&i.item.setAttribute("aria-selected","false");var c=i.fields;if(this.addActionClass(i,c.selected,Va),this.addActionClass(i,c.expanded,vh),!(0,a.le)(this.nodeTemplateFn)){var u=i.item.querySelector("."+ia),p=i.item.getAttribute("data-uid");u.innerHTML="",this.renderNodeTemplate(i.curData,u,p)}var f={node:i.item,nodeData:i.curData,text:i.text};this.isRefreshed||this.trigger("drawNode",f)},t.prototype.frameMouseHandler=function(i){var r=(0,a.Ys)("."+pb,i.target.parentElement);ls(i,r)},t.prototype.addActionClass=function(i,r,n){var s=i.curData,l=(0,a.NA)(r,s);!(0,a.le)(l)&&l.toString()!=="false"&&i.item.classList.add(n)},t.prototype.getDataType=function(i,r){if(this.fields.dataSource instanceof Oe.h){for(var n=0;n<i.length;n++)if(this.isOffline){if(typeof r.child=="string"&&(0,a.le)((0,a.NA)(r.child,i[n]))&&!(0,a.le)((0,a.NA)(r.parentID,i[n])))return 1}else if(typeof r.child=="string"&&(0,a.le)((0,a.NA)(r.child,i[n])))return 1;return 2}for(var n=0,s=i.length;n<s;n++){if(typeof r.child=="string"&&!(0,a.le)((0,a.NA)(r.child,i[n])))return 2;if(!(0,a.le)((0,a.NA)(r.parentID,i[n]))||!(0,a.le)((0,a.NA)(r.hasChildren,i[n])))return 1}return 1},t.prototype.getGroupedData=function(i,r){for(var n=new yt.A().group(r),s=Mt.getDataSource(i,n),l=[],h=0;h<s.length;h++){var c=s[h].items;l.push(c)}return l},t.prototype.getSortedData=function(i){return i&&this.sortOrder!=="None"&&(i=Mt.getDataSource(i,Mt.addSorting(this.sortOrder,this.fields.text))),i},t.prototype.finalizeNode=function(i){for(var r=(0,a.td)("."+iv,i),n=0;n<r.length;n++)r[n].setAttribute("alt",iv);if(this.isLoaded){for(var s=(0,a.td)("."+Va,i),l=0;l<s.length;l++){this.selectNode(s[l],null);break}(0,a.IV)(s,Va)}for(var h=(0,a.td)("."+kt+":not(."+vh+")",i),c=0;c<h.length;c++){var u=(0,a.Ys)("div."+Ui,h[c]);u&&u.classList.contains(di)&&this.disableExpandAttr(h[c])}var p=(0,a.td)("."+vh,i);if(!this.isInitalExpand)for(var l=0;l<p.length;l++)this.renderChildNodes(p[l]);(0,a.IV)(p,vh),this.updateList(),this.isLoaded&&this.updateCheckedProp()},t.prototype.updateCheckedProp=function(){if(this.showCheckBox){var i=[].concat([],this.checkedNodes);this.setProperties({checkedNodes:i},!0)}},t.prototype.ensureIndeterminate=function(){if(this.autoCheck)for(var i=(0,a.td)("li",this.element),r=void 0,n=0;n<i.length;n++)i[n].classList.contains(kt)&&(r=(0,a.Ys)("."+qt,i[n]),r?this.ensureParentCheckState(i[n]):this.ensureChildCheckState(i[n]));else for(var s=(0,a.td)("."+en,this.element),n=0;n<s.length;n++)s[n].classList.remove(en)},t.prototype.ensureParentCheckState=function(i){if(!(0,a.le)(i)){if(i.classList.contains(fn))return;var r=i;i.classList.contains(kt)&&(r=(0,a.Ys)("."+qt,i));var n=(0,a.td)("."+sr,r),s=(0,a.td)("."+en,r),l=(0,a.td)("."+kt,r),h=i.getElementsByClassName(_r)[0];l.length===n.length?this.changeState(h,"check",null,!0,!0):n.length>0||s.length>0?this.changeState(h,"indeterminate",null,!0,!0):n.length===0&&this.changeState(h,"uncheck",null,!0,!0);var c=(0,a.oq)(i,"."+qt);if(!(0,a.le)(c)){var u=(0,a.oq)(c,"."+kt);this.ensureParentCheckState(u)}}},t.prototype.ensureChildCheckState=function(i,r){if(!(0,a.le)(i)){var n=(0,a.Ys)("."+qt,i),s=void 0;if(!(0,a.le)(n)){s=(0,a.td)("."+_r,n);for(var l=i.getElementsByClassName(qn)[0].classList.contains(sr),h=i.getElementsByClassName(qn)[0].classList.contains(en),c=n.querySelectorAll("li"),u=n.parentElement.getAttribute("aria-expanded"),p=void 0,f=0;f<s.length;f++){var g=c[f].getAttribute("data-uid");if(!(0,a.le)(this.currentLoadData)&&!(0,a.le)((0,a.NA)(this.fields.isChecked,this.currentLoadData[f])))p=(0,a.NA)(this.fields.isChecked,this.currentLoadData[f])?"check":"uncheck",this.ele!==-1&&(p=l?"check":"uncheck"),p==="uncheck"&&!(0,a.o8)(this.parentNodeCheck)&&this.autoCheck&&this.parentNodeCheck.indexOf(g)!==-1&&(this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(g),1),p="indeterminate");else{var C=s[f].getElementsByClassName(qn)[0].classList.contains(sr);l||C&&!this.isLoaded||this.checkedNodes.indexOf(g)!==-1&&this.isLoaded&&(h||l)?p="check":c[f].classList.contains(mb)&&!(0,a.o8)(this.parentNodeCheck)&&this.autoCheck&&(l||h)&&this.parentNodeCheck.indexOf(g)!==-1?(p="indeterminate",this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(g),1)):this.dataType===1&&!(0,a.o8)(this.parentNodeCheck)&&this.autoCheck&&(l||h)&&this.parentNodeCheck.indexOf(g)!==-1?(p="indeterminate",this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(g),1)):p="uncheck"}this.changeState(s[f],p,r,!0,!0)}}this.autoCheck&&this.isLoaded&&this.updateParentCheckState()}},t.prototype.doCheckBoxAction=function(i,r){var n=(0,a.td)("."+kt,this.element);if((0,a.le)(i)){var C=(0,a.td)("."+_r,this.element);if(this.loadOnDemand)for(var L=0;L<C.length;L++)this.updateFieldChecked(C[L],r),this.changeState(C[L],r?"check":"uncheck",null,null,null,r);else for(var L=0;L<C.length;L++)this.updateFieldChecked(C[L],r),this.changeState(C[L],r?"check":"uncheck")}else for(var s=i.length;s>=0;s--){var l=void 0;if(i.length===1?l=this.getElement(i[s-1]):l=this.getElement(i[s]),(0,a.le)(l)){var h=void 0;if(h=i[s-i.length]?i[s-i.length].toString():i[s]?i[s].toString():null,h!==""&&r&&h)this.setValidCheckedNode(h),this.dynamicCheckState(h,r);else if(this.checkedNodes.indexOf(h)!==-1&&h!==""&&!r){this.checkedNodes.splice(this.checkedNodes.indexOf(h),1);var c=this.getChildNodes(this.treeData,h);if(c){for(var u=0;u<c.length;u++){var p=c[u][this.fields.id]?c[u][this.fields.id].toString():null;if(this.checkedNodes.indexOf(p)!==-1){this.checkedNodes.splice(this.checkedNodes.indexOf(p),1);var f=this.element.querySelector('[data-uid="'+p+'"]');f&&this.changeState(f,"uncheck",null)}}this.parentNodeCheck.indexOf(h)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(h),1)}h&&this.dynamicCheckState(h,r),this.updateField(this.treeData,this.fields,h,"isChecked",null)}continue}var g=(0,a.Ys)("."+qt+" ."+_r,l);this.validateCheckNode(g,!r,l,null)}if(i)for(var D=0;D<i.length;D++){var h=i[D]?i[D].toString():"";r||this.updateField(this.treeData,this.fields,h,"isChecked",null)}this.autoCheck&&this.updateParentCheckState()},t.prototype.updateFieldChecked=function(i,r){var n=(0,a.oq)(i,"."+kt),s=n.getAttribute("data-uid"),l=this.getNodeData(n);l.isChecked==="true"&&!r&&this.updateField(this.treeData,this.fields,s,"isChecked",null)},t.prototype.dynamicCheckState=function(i,r){if(this.dataType===1){var n=0,s=new Oe.h(this.treeData).executeLocal(new yt.A().where(this.fields.id,"equal",i,!0));if(s[0]){var l=s[0][this.fields.id]?s[0][this.fields.id].toString():null,h=s[0][this.fields.parentID]?s[0][this.fields.parentID].toString():null,c=this.element.querySelector('[data-uid="'+h+'"]'),u=c?(0,a.Ys)("."+en,c):null,p=c?(0,a.Ys)("."+sr,c):null,f=this.element.querySelector('[data-uid="'+l+'"]'),g=this.getChildNodes(this.treeData,h);if(g)for(var C=0;C<g.length;C++){var L=g[C][this.fields.id]?g[C][this.fields.id].toString():null;this.checkedNodes.indexOf(L)!==-1&&n++}this.checkedNodes.indexOf(i)!==-1&&c&&l===i&&this.autoCheck?this.changeState(c,"indeterminate",null):this.checkedNodes.indexOf(i)===-1&&f&&l===i&&!r?this.changeState(f,"uncheck",null):this.checkedNodes.indexOf(i)!==-1&&f&&l===i&&r?this.changeState(f,"check",null):this.checkedNodes.indexOf(i)===-1&&!f&&c&&l===i&&this.autoCheck&&n!==0?this.changeState(c,"indeterminate",null):this.checkedNodes.indexOf(i)===-1&&!f&&c&&l===i&&this.autoCheck&&n===0?this.changeState(c,"uncheck",null):!f&&!c&&l===i&&this.autoCheck&&this.updateIndeterminate(i,r)}}else if(this.dataType===2||this.fields.dataSource instanceof Oe.h&&this.isOffline)for(var l=void 0,c=void 0,p=void 0,C=0;C<this.treeData.length;C++){l=this.treeData[C][this.fields.id]?this.treeData[C][this.fields.id].toString():"",c=this.element.querySelector('[data-uid="'+l+'"]'),p=c?(0,a.Ys)("."+sr,c):null,this.checkedNodes.indexOf(l)===-1&&c&&p&&!r&&this.changeState(c,"uncheck",null);var D=(0,a.NA)(this.fields.child.toString(),this.treeData[C]);D&&this.updateChildIndeterminate(D,l,i,r,l)}},t.prototype.updateIndeterminate=function(i,r){var n=this.getTreeData(i),s=0,l;this.dataType===1&&(l=n[0][this.fields.parentID]?n[0][this.fields.parentID].toString():null);var h=this.getChildNodes(this.treeData,l);if(h)for(var c=0;c<h.length;c++){var u=h[c][this.fields.id]?h[c][this.fields.id].toString():null;this.checkedNodes.indexOf(u)!==-1&&s++}var p=this.element.querySelector('[data-uid="'+l+'"]');p&&r?this.changeState(p,"indeterminate",null):!r&&p&&this.parentNodeCheck.indexOf(l)===-1&&s!==0?this.changeState(p,"indeterminate",null):!r&&p&&this.parentNodeCheck.indexOf(l)===-1&&s===0?this.changeState(p,"uncheck",null):p||(!r&&this.checkedNodes.indexOf(l)===-1&&this.parentNodeCheck.indexOf(l)!==-1?this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(l),1):r&&this.checkedNodes.indexOf(l)===-1&&this.parentNodeCheck.indexOf(l)===-1?this.parentNodeCheck.push(l):!r&&this.checkedNodes.indexOf(l)!==-1&&this.parentNodeCheck.indexOf(l)===-1&&s!==0&&this.parentNodeCheck.push(l),this.updateIndeterminate(l,r),this.checkedNodes.indexOf(l)!==-1&&!r&&this.checkedNodes.splice(this.checkedNodes.indexOf(l),1))},t.prototype.updateChildIndeterminate=function(i,r,n,s,l){for(var h=0,c=0;c<i.length;c++){var u=i[c][this.fields.id]?i[c][this.fields.id].toString():"";this.checkedNodes.indexOf(u)!==-1&&h++;var p=this.element.querySelector('[data-uid="'+r+'"]'),f=p?(0,a.Ys)("."+en,p):null,g=p?(0,a.Ys)("."+sr,p):null,C=this.element.querySelector('[data-uid="'+u+'"]'),L=C?(0,a.Ys)("."+sr,C):null;if(this.checkedNodes.indexOf(n)!==-1&&p&&u===n&&this.autoCheck)this.changeState(p,"indeterminate",null);else if(this.checkedNodes.indexOf(n)===-1&&p&&!C&&u===n&&!s)this.autoCheck?this.changeState(p,"uncheck",null):h!==0?this.changeState(p,"indeterminate",null):this.changeState(p,"uncheck",null);else if(this.checkedNodes.indexOf(n)===-1&&C&&u===n&&!s)this.changeState(C,"uncheck",null);else if(this.checkedNodes.indexOf(n)===-1&&f&&u===n&&this.autoCheck&&h===0&&!s)f.classList.remove(en);else if(this.checkedNodes.indexOf(n)===-1&&!C&&g&&u===n&&h===0)this.changeState(p,"uncheck",null);else if(this.checkedNodes.indexOf(u)===-1&&C&&L&&h===0)this.changeState(C,"uncheck",null);else if(!C&&!p&&u===n||this.parentNodeCheck.indexOf(r)!==-1&&this.autoCheck){var D=this.element.querySelector('[data-uid="'+l+'"]');s&&h!==0?this.changeState(D,"indeterminate",null):s&&h===i.length&&this.checkedNodes.indexOf(r)===-1?this.checkedNodes.push(r):!s&&h===0&&this.parentNodeCheck.indexOf(r)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(r)),this.parentNodeCheck.indexOf(r)===-1&&this.parentNodeCheck.push(r)}var R=(0,a.NA)(this.fields.child.toString(),i[c]);R&&this.updateChildIndeterminate(R,u,n,s,l)}},t.prototype.changeState=function(i,r,n,s,l,h){var c=this,u,p=(0,a.oq)(i,"."+kt);i===p&&(i=(0,a.Ys)("."+_r,p)),s?this.nodeCheckAction(i,r,p,u,n,s,l,h):(this.checkActionNodes=[],u=this.getCheckEvent(p,r,n),this.trigger("nodeChecking",u,function(f){f.cancel||c.nodeCheckAction(i,r,p,f,n,s,l,h)}))},t.prototype.nodeCheckAction=function(i,r,n,s,l,h,c,u){var p,f=i.getElementsByClassName(qn)[0];if(r==="check"&&!f.classList.contains(sr)?(f.classList.remove(en),f.classList.add(sr),this.addCheck(n),p="true"):r==="uncheck"&&(f.classList.contains(sr)||f.classList.contains(en))?((0,a.IV)([f],[sr,en]),this.removeCheck(n),p="false"):r==="indeterminate"&&this.autoCheck&&(f.classList.remove(sr),f.classList.add(en),this.removeCheck(n),p="mixed"),p=r==="check"?"true":r==="uncheck"?"false":p,(0,a.le)(p)||i.setAttribute("aria-checked",p),c){var g=[].concat([],this.checkActionNodes);s=this.getCheckEvent(n,r,l),(0,a.o8)(h)&&(s.data=g)}u!==void 0&&this.ensureStateChange(n,u),h||(0,a.le)(p)||(i.setAttribute("aria-checked",p),s.data[0].checked=p,this.trigger("nodeChecked",s),this.checkActionNodes=[])},t.prototype.addCheck=function(i){var r=i.getAttribute("data-uid");!(0,a.le)(r)&&this.checkedNodes.indexOf(r)===-1&&this.checkedNodes.push(r)},t.prototype.removeCheck=function(i){var r=this.checkedNodes.indexOf(i.getAttribute("data-uid"));r>-1&&this.checkedNodes.splice(r,1)},t.prototype.getCheckEvent=function(i,r,n){this.checkActionNodes.push(this.getNodeData(i));var s=this.checkActionNodes;return{action:r,cancel:!1,isInteracted:!(0,a.le)(n),node:i,data:s}},t.prototype.finalize=function(){var i=(0,a.Ys)("."+qt,this.element);if(!(0,a.le)(i)){i.setAttribute("role",nv.treeRole),this.setMultiSelect(this.allowMultiSelection);var r=(0,a.Ys)("."+kt,this.element);r&&((0,a.cn)([r],za),this.updateIdAttr(null,r)),this.allowTextWrap&&this.updateWrap(),this.renderReactTemplates(),this.hasPid=this.rootData[0]?this.rootData[0].hasOwnProperty(this.fields.parentID):!1,this.doExpandAction()}},t.prototype.setTextWrap=function(){(this.allowTextWrap?a.cn:a.IV)([this.element],ob),a.AR.isIE&&(this.allowTextWrap?a.cn:a.IV)([this.element],lb)},t.prototype.updateWrap=function(i){if(!!this.fullRowSelect)for(var r=i?(0,a.td)("."+kt,i):this.liList,n=r.length,s=0;s<n;s++)this.calculateWrap(r[s])},t.prototype.calculateWrap=function(i){var r=(0,a.Ys)("."+Un,i);r&&r.nextElementSibling&&(r.style.height=this.allowTextWrap?r.nextElementSibling.offsetHeight+"px":"")},t.prototype.doExpandAction=function(){var i=this.expandedNodes;if(this.isInitalExpand&&i.length>0)if(this.setProperties({expandedNodes:[]},!0),this.fields.dataSource instanceof Oe.h)this.expandGivenNodes(i);else{for(var r=0;r<i.length;r++){var n=(0,a.Ys)('[data-uid="'+i[r]+'"]',this.element);if((0,a.le)(n)){i[r]&&this.expandChildren.indexOf(i[r])===-1&&this.expandChildren.push(i[r].toString());continue}else{var s=(0,a.Ys)("."+di,(0,a.Ys)("."+Yi,n));(0,a.le)(s)||this.expandAction(n,s,null)}}this.afterFinalized()}else this.afterFinalized()},t.prototype.expandGivenNodes=function(i){var r=this;this.expandCallback(i[this.index],function(){r.index++,r.index<i.length?r.expandGivenNodes(i):r.afterFinalized()})},t.prototype.expandCallback=function(i,r){var n=(0,a.Ys)('[data-uid="'+i+'"]',this.element);if((0,a.le)(n))r();else{var s=(0,a.Ys)("."+di,(0,a.Ys)("."+Yi,n));(0,a.le)(s)?r():this.expandAction(n,s,null,!1,r)}},t.prototype.afterFinalized=function(){if(this.doSelectionAction(),this.updateCheckedProp(),this.isAnimate=!0,this.isInitalExpand=!1,!this.isLoaded||this.isFieldChange){var i={data:this.treeData};this.trigger("dataBound",i)}this.isLoaded=!0},t.prototype.doSelectionAction=function(){var i=(0,a.td)("."+Va,this.element),r=this.selectedNodes;if(r.length>0){this.setProperties({selectedNodes:[]},!0);for(var n=0;n<r.length;n++){var s=(0,a.Ys)('[data-uid="'+r[n]+'"]',this.element);if(s&&!s.classList.contains("e-active")?this.selectNode(s,null,!0):this.selectedNodes.push(r[n]),!this.allowMultiSelection)break}}else this.selectGivenNodes(i);(0,a.IV)(i,Va)},t.prototype.selectGivenNodes=function(i){for(var r=0;r<i.length&&(i[r].classList.contains("e-disable")||this.selectNode(i[r],null,!0),!!this.allowMultiSelection);r++);},t.prototype.clickHandler=function(i){var r=i.originalEvent.target;if(a.bi.remove(this.element,"contextmenu",this.preventContextMenu),!(!r||this.dragStartAction)){var n=r.classList,s=(0,a.oq)(r,"."+kt);if(s){if(i.originalEvent.which!==3){var l=(0,a.Ys)("."+db,s),h=(0,a.Ys)("."+Ui,s);if(this.removeHover(),this.setFocusElement(s),this.showCheckBox&&!s.classList.contains("e-disable")){var c=(0,a.oq)(r,"."+_r);if(!(0,a.le)(c)){var u=(0,a.Ys)("."+qn,c);this.validateCheckNode(c,u.classList.contains(sr),s,i.originalEvent),this.triggerClickEvent(i.originalEvent,s);return}}n.contains(di)?this.expandAction(s,r,i):n.contains(Ji)?this.collapseNode(s,r,i):l&&h?h.classList.contains(tv)&&h.classList.contains(di)?this.expandAction(s,h,i):h.classList.contains(tv)&&h.classList.contains(Ji)?this.collapseNode(s,h,i):!n.contains(qt)&&!n.contains(kt)&&this.toggleSelect(s,i.originalEvent,!1):!n.contains(qt)&&!n.contains(kt)&&this.toggleSelect(s,i.originalEvent,!1)}}else return;this.triggerClickEvent(i.originalEvent,s)}},t.prototype.nodeCheckedEvent=function(i,r,n){var s=(0,a.oq)(i,"."+kt),l=this.getCheckEvent(i,r?"uncheck":"check",n);l.data=l.data.splice(0,l.data.length-1),this.trigger("nodeChecked",l)},t.prototype.triggerClickEvent=function(i,r){var n={event:i,node:r};this.trigger("nodeClicked",n)},t.prototype.expandNode=function(i,r,n){var s=this;if(this.renderReactTemplates(),r.classList.contains(Iu)&&this.hideSpinner(r),this.initialRender||r.classList.add("interaction"),n!==!0||n===!0&&i.classList.contains("e-expanded")){if(this.preventExpand!==!0){(0,a.IV)([r],di),(0,a.cn)([r],Ji);var l=0,h=0,c=this,u=(0,a.Ys)("."+qt,i),p=i;this.setHeight(p,u);var f=(0,a.Ys)("."+kt+"."+Rr,i);this.isAnimate&&!this.isRefreshed?this.aniObj.animate(u,{name:this.animation.expand.effect,duration:this.animation.expand.duration,timingFunction:this.animation.expand.easing,begin:function(C){p.style.overflow="hidden",!(0,a.le)(f)&&f instanceof HTMLElement&&f.classList.add(mh),l=p.offsetHeight,h=(0,a.Ys)("."+Yi,i).offsetHeight},progress:function(C){C.element.style.display="block",c.animateHeight(C,l,h)},end:function(C){C.element.style.display="block",!(0,a.le)(f)&&f instanceof HTMLElement&&f.classList.remove(mh),s.expandedNode(p,u,r)}}):this.expandedNode(p,u,r)}}else{var g=(0,a.Ys)("."+qt,i);g.style.display="none",this.fields.dataSource instanceof Oe.h&&(this.preventExpand=!1)}this.initialRender&&r.classList.add("interaction")},t.prototype.expandedNode=function(i,r,n){r.style.display="block",i.style.display="block",i.style.overflow="",i.style.height="",(0,a.IV)([n],Wn),this.addExpand(i),this.allowTextWrap&&this.isLoaded&&this.isFirstRender&&(this.updateWrap(i),this.isFirstRender=!1),this.isLoaded&&this.expandArgs&&!this.isRefreshed&&(this.expandArgs=this.getExpandEvent(i,null),this.trigger("nodeExpanded",this.expandArgs))},t.prototype.addExpand=function(i){i.setAttribute("aria-expanded","true"),(0,a.IV)([i],Jf);var r=i.getAttribute("data-uid");!(0,a.le)(r)&&this.expandedNodes.indexOf(r)===-1&&this.expandedNodes.push(r)},t.prototype.collapseNode=function(i,r,n){var s=this;if(!r.classList.contains(Wn)){(0,a.cn)([r],Wn);var l;this.isLoaded?(l=this.getExpandEvent(i,n),this.trigger("nodeCollapsing",l,function(h){h.cancel?(0,a.IV)([r],Wn):s.nodeCollapseAction(i,r,h)})):this.nodeCollapseAction(i,r,l)}},t.prototype.nodeCollapseAction=function(i,r,n){var s=this;(0,a.IV)([r],Ji),(0,a.cn)([r],di);var l=0,h=0,c=this,u=(0,a.Ys)("."+qt,i),p=i,f=(0,a.Ys)("."+kt+"."+Rr,i);this.isAnimate?this.aniObj.animate(u,{name:this.animation.collapse.effect,duration:this.animation.collapse.duration,timingFunction:this.animation.collapse.easing,begin:function(g){p.style.overflow="hidden",!(0,a.le)(f)&&f instanceof HTMLElement&&f.classList.add(mh),l=(0,a.Ys)("."+Yi,i).offsetHeight,h=p.offsetHeight},progress:function(g){c.animateHeight(g,l,h)},end:function(g){g.element.style.display="none",!(0,a.le)(f)&&f instanceof HTMLElement&&f.classList.remove(mh),s.collapsedNode(p,u,r,n)}}):this.collapsedNode(p,u,r,n)},t.prototype.collapsedNode=function(i,r,n,s){r.style.display="none",i.style.overflow="",i.style.height="",(0,a.IV)([n],Wn),this.removeExpand(i),this.isLoaded&&(s=this.getExpandEvent(i,null),this.trigger("nodeCollapsed",s))},t.prototype.removeExpand=function(i,r){r?i.removeAttribute("aria-expanded"):this.disableExpandAttr(i);var n=this.expandedNodes.indexOf(i.getAttribute("data-uid"));n>-1&&this.expandedNodes.splice(n,1)},t.prototype.disableExpandAttr=function(i){i.setAttribute("aria-expanded","false"),(0,a.cn)([i],Jf)},t.prototype.setHeight=function(i,r){r.style.display="block",r.style.visibility="hidden",i.style.height=i.offsetHeight+"px",r.style.display="none",r.style.visibility=""},t.prototype.animateHeight=function(i,r,n){var s=(i.duration-i.timeStamp)/i.duration,l=(n-r)*s+r;i.element.parentElement.style.height=l+"px"},t.prototype.renderChildNodes=function(i,r,n,s){var l=this,h=(0,a.Ys)("div."+Ui,i);if(!(0,a.le)(h)){this.showSpinner(h);var c;if(this.fields.dataSource instanceof Oe.h){var u=this.parents(i,"."+qt).length,p=this.getChildFields(this.fields,u,1);if((0,a.le)(p)||(0,a.le)(p.dataSource)){(0,a.og)(h),this.removeExpand(i,!0);return}this.treeList.push("false"),this.fields.dataSource instanceof Oe.h&&this.isOffline?(this.treeList.pop(),c=this.getChildNodes(this.treeData,i.getAttribute("data-uid")),this.loadChild(c,p,h,i,r,n,s)):p.dataSource.executeQuery(this.getQuery(p,i.getAttribute("data-uid"))).then(function(f){l.treeList.pop(),c=f.result,l.dataType===1&&(l.dataType=2),l.loadChild(c,p,h,i,r,n,s)}).catch(function(f){l.trigger("actionFailure",{error:f})})}else if(c=this.getChildNodes(this.treeData,i.getAttribute("data-uid")),this.currentLoadData=this.getSortedData(c),(0,a.le)(c)||c.length===0){(0,a.og)(h),this.removeExpand(i,!0);return}else this.listBaseOption.ariaAttributes.level=parseFloat(i.getAttribute("aria-level"))+1,i.appendChild(Mt.createList(this.createElement,this.currentLoadData,this.listBaseOption)),this.expandNode(i,h,s),this.setSelectionForChildNodes(c),this.ensureCheckNode(i),this.finalizeNode(i),this.disableTreeNodes(c),this.renderSubChild(i,r,s)}},t.prototype.loadChild=function(i,r,n,s,l,h,c){if(this.currentLoadData=i,(0,a.le)(i)||i.length===0)(0,a.og)(n),this.removeExpand(s,!0);else{if(this.updateListProp(r),this.fields.dataSource instanceof Oe.h&&!this.isOffline){var u=s.getAttribute("data-uid"),p=this.getNodeObject(u);(0,a.sO)("child",i,p)}this.listBaseOption.ariaAttributes.level=parseFloat(s.getAttribute("aria-level"))+1,s.appendChild(Mt.createList(this.createElement,i,this.listBaseOption)),this.expandNode(s,n,c),this.setSelectionForChildNodes(i),this.ensureCheckNode(s),this.finalizeNode(s),this.disableTreeNodes(i),this.renderSubChild(s,l,c)}h&&h(),this.treeList.length===0&&!this.isLoaded&&this.finalize()},t.prototype.disableTreeNodes=function(i){for(var r=0;r<i.length;){var n=i[r][this.fields.id]?i[r][this.fields.id].toString():null;this.disableNode!==void 0&&this.disableNode.indexOf(n)!==-1&&this.doDisableAction([n]),r++}},t.prototype.setSelectionForChildNodes=function(i){var r;for(r=0;r<i.length;r++){var n=i[r][this.fields.id]?i[r][this.fields.id].toString():null;this.selectedNodes!==void 0&&this.selectedNodes.indexOf(n)!==-1&&this.doSelectionAction()}},t.prototype.ensureCheckNode=function(i){this.showCheckBox&&(this.ele=this.checkedElement?this.checkedElement.indexOf(i.getAttribute("data-uid")):null,this.autoCheck&&(this.ensureChildCheckState(i),this.ensureParentCheckState(i))),this.currentLoadData=null},t.prototype.getFields=function(i,r,n){return r===n?i:this.getFields(this.getChildMapper(i),r,n+1)},t.prototype.getChildFields=function(i,r,n){var s;return r===n?this.getChildMapper(i):this.getChildFields(this.getChildMapper(i),r,n+1)},t.prototype.getChildMapper=function(i){return typeof i.child=="string"||(0,a.le)(i.child)?i:i.child},t.prototype.getChildNodes=function(i,r,n){n===void 0&&(n=!1);var s;if((0,a.le)(i))return s;if(this.dataType===1)return this.getChildGroup(this.groupedData,r,n);if(typeof this.fields.child=="string")for(var l=0,h=i.length;l<h;l++){var c=(0,a.NA)(this.fields.id,i[l]);if(c&&c.toString()===r)return(0,a.NA)(this.fields.child,i[l]);if(!(0,a.le)((0,a.NA)(this.fields.child,i[l]))&&(s=this.getChildNodes((0,a.NA)(this.fields.child,i[l]),r),s!==void 0))break}return s},t.prototype.getChildGroup=function(i,r,n){var s;if((0,a.le)(i))return s;for(var l=0,h=i.length;l<h;l++)if(!(0,a.le)(i[l][0])&&!(0,a.le)((0,a.NA)(this.fields.parentID,i[l][0]))){if((0,a.NA)(this.fields.parentID,i[l][0]).toString()===r)return i[l]}else return n?i[l]:[];return s},t.prototype.renderSubChild=function(i,r,n){if(r)for(var s=(0,a.td)("."+di,i),l=0,h=s.length;l<h;l++){var c=s[l];if(i.querySelector(".e-icons")!==s[l]){var u=(0,a.oq)(c,"."+kt);this.expandArgs=this.getExpandEvent(u,null),n!==!0&&this.trigger("nodeExpanding",this.expandArgs),this.renderChildNodes(u,r,null,n)}}},t.prototype.toggleSelect=function(i,r,n){i.classList.contains("e-disable")||(this.allowMultiSelection&&(r&&r.ctrlKey||n)&&this.isActive(i)?this.unselectNode(i,r):this.selectNode(i,r,n))},t.prototype.isActive=function(i){return!!i.classList.contains(Rr)},t.prototype.selectNode=function(i,r,n){var s=this;if((0,a.le)(i)||!this.allowMultiSelection&&this.isActive(i)&&!(0,a.le)(r)){this.setFocusElement(i);return}var l;this.isLoaded?(l=this.getSelectEvent(i,"select",r),this.trigger("nodeSelecting",l,function(h){h.cancel||s.nodeSelectAction(i,r,h,n)})):this.nodeSelectAction(i,r,l,n)},t.prototype.nodeSelectAction=function(i,r,n,s){if((!this.allowMultiSelection||!s&&(!r||r&&!r.ctrlKey))&&this.removeSelectAll(),this.allowMultiSelection&&r&&r.shiftKey){this.startNode||(this.startNode=i);var l=this.liList.indexOf(this.startNode),h=this.liList.indexOf(i);if(l>h){var c=l;l=h,h=c}for(var u=l;u<=h;u++){var p=this.liList[u];(0,a.pn)(p)&&!p.classList.contains("e-disable")&&this.addSelect(p)}}else this.startNode=i,this.addSelect(i);this.setFocusElement(i),this.isLoaded&&(n.nodeData=this.getNodeData(i),this.trigger("nodeSelected",n))},t.prototype.unselectNode=function(i,r){var n=this,s;this.isLoaded?(s=this.getSelectEvent(i,"un-select",r),this.trigger("nodeSelecting",s,function(l){l.cancel||n.nodeUnselectAction(i,l)})):this.nodeUnselectAction(i,s)},t.prototype.nodeUnselectAction=function(i,r){this.removeSelect(i),this.setFocusElement(i),this.isLoaded&&(r.nodeData=this.getNodeData(i),this.trigger("nodeSelected",r))},t.prototype.setFocusElement=function(i){if(!(0,a.le)(i)){var r=this.getFocusedNode();r&&(0,a.IV)([r],za),(0,a.cn)([i],za),this.updateIdAttr(r,i)}},t.prototype.addSelect=function(i){i.setAttribute("aria-selected","true"),(0,a.cn)([i],Rr);var r=i.getAttribute("data-uid");!(0,a.le)(r)&&this.selectedNodes.indexOf(r)===-1&&this.selectedNodes.push(r)},t.prototype.removeSelect=function(i){this.allowMultiSelection?i.setAttribute("aria-selected","false"):i.removeAttribute("aria-selected"),(0,a.IV)([i],Rr);var r=this.selectedNodes.indexOf(i.getAttribute("data-uid"));r>-1&&this.selectedNodes.splice(r,1)},t.prototype.removeSelectAll=function(){for(var i=this.element.querySelectorAll("."+Rr),r=0,n=i;r<n.length;r++){var s=n[r];this.allowMultiSelection?s.setAttribute("aria-selected","false"):s.removeAttribute("aria-selected")}(0,a.IV)(i,Rr),this.setProperties({selectedNodes:[]},!0)},t.prototype.getSelectEvent=function(i,r,n){var s=this.getNodeData(i);return{action:r,cancel:!1,isInteracted:!(0,a.le)(n),node:i,nodeData:s}},t.prototype.setExpandOnType=function(){this.expandOnType=this.expandOn==="Auto"?a.AR.isDevice?"Click":"DblClick":this.expandOn},t.prototype.expandHandler=function(i){var r=i.originalEvent.target;!r||r.classList.contains(ph)||r.classList.contains(fn)||r.classList.contains(qt)||r.classList.contains(kt)||r.classList.contains(Ui)||this.showCheckBox&&(0,a.oq)(r,"."+_r)||this.expandCollapseAction((0,a.oq)(r,"."+kt),i)},t.prototype.expandCollapseAction=function(i,r){var n=(0,a.Ys)("div."+Ui,i);if(!(!n||n.classList.contains(Wn))){var s=n.classList;s.contains(di)?this.expandAction(i,n,r):s.contains(Ji)&&this.collapseNode(i,n,r)}},t.prototype.expandAction=function(i,r,n,s,l){var h=this;r.classList.contains(Wn)||((0,a.cn)([r],Wn),this.isLoaded&&!this.isRefreshed?(this.expandArgs=this.getExpandEvent(i,n),this.trigger("nodeExpanding",this.expandArgs,function(c){c.cancel?(0,a.IV)([r],Wn):h.nodeExpandAction(i,r,s,l)})):this.nodeExpandAction(i,r,s,l))},t.prototype.nodeExpandAction=function(i,r,n,s){var l=(0,a.Ys)("."+qt,i);if(l&&l.nodeName==="UL")this.expandNode(i,r);else{this.isFirstRender=!0,this.renderChildNodes(i,n,s);for(var h=(0,a.td)("."+kt,i),c=0;c<h.length;c++){var u=this.getId(h[c]);if(this.expandChildren.indexOf(u)!==-1&&this.expandChildren!==void 0){var p=(0,a.Ys)("."+di,(0,a.Ys)("."+Yi,h[c]));(0,a.le)(p)||this.expandAction(h[c],p,null),this.expandChildren.splice(this.expandChildren.indexOf(u),1)}}}},t.prototype.keyActionHandler=function(i){var r=this,n=i.target,s=this.getFocusedNode();if(n&&n.classList.contains(ph)){var l=n;i.action==="enter"?(l.blur(),this.element.focus(),(0,a.cn)([s],An)):i.action==="escape"&&(l.value=this.oldText,l.blur(),this.element.focus(),(0,a.cn)([s],An));return}i.preventDefault();var h={cancel:!1,event:i,node:s};this.trigger("keyPress",h,function(c){if(!c.cancel)switch(i.action){case"space":r.showCheckBox&&r.checkNode(i);break;case"moveRight":r.openNode(!r.enableRtl,i);break;case"moveLeft":r.openNode(!!r.enableRtl,i);break;case"shiftDown":r.shiftKeySelect(!0,i);break;case"moveDown":case"ctrlDown":case"csDown":r.navigateNode(!0);break;case"shiftUp":r.shiftKeySelect(!1,i);break;case"moveUp":case"ctrlUp":case"csUp":r.navigateNode(!1);break;case"home":case"shiftHome":case"ctrlHome":case"csHome":r.navigateRootNode(!0);break;case"end":case"shiftEnd":case"ctrlEnd":case"csEnd":r.navigateRootNode(!1);break;case"enter":case"ctrlEnter":case"shiftEnter":case"csEnter":r.toggleSelect(s,i);break;case"f2":r.allowEditing&&!s.classList.contains("e-disable")&&r.createTextbox(s,i);break;case"ctrlA":if(r.allowMultiSelection){var u=(0,a.td)("."+kt+":not(."+Rr+")",r.element);r.selectGivenNodes(u)}break}})},t.prototype.navigateToFocus=function(i){var r=this.getFocusedNode().querySelector("."+Yi),n=r.getBoundingClientRect(),s=this.getScrollParent(this.element);if(!(0,a.le)(s)){var l=s.getBoundingClientRect();n.bottom>l.bottom?s.scrollTop+=n.bottom-l.bottom:n.top<l.top&&(s.scrollTop-=l.top-n.top)}var h=this.isVisibleInViewport(r);h||r.scrollIntoView(i)},t.prototype.isVisibleInViewport=function(i){var r=i.getBoundingClientRect();return r.top>=0&&r.left>=0&&r.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&r.right<=(window.innerWidth||document.documentElement.clientWidth)},t.prototype.getScrollParent=function(i){return(0,a.le)(i)?null:i.scrollHeight>i.clientHeight?i:this.getScrollParent(i.parentElement)},t.prototype.shiftKeySelect=function(i,r){if(this.allowMultiSelection){var n=this.getFocusedNode(),s=i?this.getNextNode(n):this.getPrevNode(n);this.removeHover(),this.setFocusElement(s),this.toggleSelect(s,r,!1),this.navigateToFocus(!i)}else this.navigateNode(i)},t.prototype.checkNode=function(i){var r=this.getFocusedNode(),n=(0,a.Ys)("."+_r,r),s=(0,a.Ys)(" ."+qn,n).classList.contains(sr);r.classList.contains("e-disable")||r.getElementsByClassName("e-checkbox-disabled").length==0&&this.validateCheckNode(n,s,r,i)},t.prototype.validateCheckNode=function(i,r,n,s){var l=this,h=(0,a.oq)(i,"."+kt);this.checkActionNodes=[];var c=r?"false":"true";(0,a.le)(c)||i.setAttribute("aria-checked",c);var u=this.getCheckEvent(h,r?"uncheck":"check",s);this.trigger("nodeChecking",u,function(p){p.cancel||l.nodeCheckingAction(i,r,n,p,s)})},t.prototype.nodeCheckingAction=function(i,r,n,s,l){if(this.checkedElement.indexOf(n.getAttribute("data-uid"))===-1&&(this.checkedElement.push(n.getAttribute("data-uid")),this.autoCheck)){var h=this.getChildNodes(this.treeData,n.getAttribute("data-uid"));h!==null?this.allCheckNode(h,this.checkedElement,null,null,!1):h=null}if(this.changeState(i,r?"uncheck":"check",l,!0),this.autoCheck){this.ensureChildCheckState(n),this.ensureParentCheckState((0,a.oq)((0,a.oq)(n,"."+qt),"."+kt));var c=void 0;s.action==="check"?c=!0:s.action==="uncheck"&&(c=!1),this.ensureStateChange(n,c)}this.nodeCheckedEvent(i,r,l)},t.prototype.ensureStateChange=function(i,r){var n=(0,a.Ys)("."+qt,i),s=i.getAttribute("data-uid"),l=this.fields;if(this.dataType===1&&this.autoCheck)for(var h=new Oe.h(this.treeData).executeLocal(new yt.A().where(l.parentID,"equal",s,!0)),c=0;c<h.length;c++){var u=h[c][this.fields.id]?h[c][this.fields.id].toString():null,p=h[c][this.fields.isChecked]?h[c][this.fields.isChecked].toString():null;if(this.checkedNodes.indexOf(s)!==-1&&this.checkedNodes.indexOf(u)===-1){this.checkedNodes.push(u);var f=this.getChildNodes(this.treeData,u);this.getChildItems(f,r),this.parentNodeCheck.indexOf(u)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(u),1)}else if(this.checkedNodes.indexOf(s)===-1&&n===null&&this.checkedNodes.indexOf(u)!==-1){if(this.checkedNodes.splice(this.checkedNodes.indexOf(u),1),p==="true"&&this.updateField(this.treeData,this.fields,u,"isChecked",null),this.checkedNodes.indexOf(s)===-1&&n===null||this.parentNodeCheck.indexOf(u)!==-1){var g=this.getChildNodes(this.treeData,u);this.getChildItems(g,r),this.parentNodeCheck.indexOf(u)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(u),1)}}else{var f=this.getChildNodes(this.treeData,u);this.getChildItems(f,r)}}else if(this.dataType===1&&!this.autoCheck)if(r)for(var c=0;c<this.treeData.length;c++){var D=this.treeData[c][this.fields.id]?this.treeData[c][this.fields.id].toString():null;this.checkedNodes.indexOf(D)===-1&&this.checkedNodes.push(D)}else{for(var C=new Oe.h(this.treeData).executeLocal(new yt.A().where(l.isChecked,"equal",!0,!1)),c=0;c<C.length;c++){var L=C[c][this.fields.id]?C[c][this.fields.id].toString():null;this.checkedNodes.indexOf(L)!==-1&&this.checkedNodes.splice(this.checkedNodes.indexOf(L),1),this.updateField(this.treeData,this.fields,L,"isChecked",null)}this.checkedNodes=[]}else{var f=this.getChildNodes(this.treeData,s);f&&this.childStateChange(f,s,n,r)}},t.prototype.getChildItems=function(i,r){for(var n=0;n<i.length;n++){var s=i[n][this.fields.id]?i[n][this.fields.id].toString():null,l=i[n][this.fields.isChecked]?i[n][this.fields.isChecked].toString():null;this.checkedNodes.indexOf(s)!==-1&&!r&&this.checkedNodes.splice(this.checkedNodes.indexOf(s),1),this.checkedNodes.indexOf(s)===-1&&r&&this.checkedNodes.push(s),l==="true"&&!r&&this.updateField(this.treeData,this.fields,s,"isChecked",null);var h=this.getChildNodes(this.treeData,s);h.length>0&&this.getChildItems(h,r)}},t.prototype.childStateChange=function(i,r,n,s){for(var l=0;l<i.length;l++){var h=i[l][this.fields.id]?i[l][this.fields.id].toString():"",c=i[l][this.fields.isChecked]?i[l][this.fields.isChecked].toString():null;this.autoCheck?this.checkedNodes.indexOf(r)!==-1&&this.checkedNodes.indexOf(h)===-1?(this.checkedNodes.push(h),this.parentNodeCheck.indexOf(h)!==-1&&this.parentNodeCheck.splice(this.parentNodeCheck.indexOf(h),1)):this.checkedNodes.indexOf(r)===-1&&this.checkedNodes.indexOf(h)!==-1&&!s&&(this.checkedNodes.splice(this.checkedNodes.indexOf(h),1),c==="true"&&this.updateField(this.treeData,this.fields,h,"isChecked",null)):this.autoCheck||(s?this.checkedNodes.indexOf(h)===-1&&this.checkedNodes.push(h):(this.checkedNodes.indexOf(h)!==-1&&this.checkedNodes.splice(this.checkedNodes.indexOf(h),1),this.updateField(this.treeData,this.fields,h,"isChecked",null),this.checkedNodes=[]));var u=this.getChildNodes([i[l]],h);u&&this.childStateChange(u,r,n,s)}},t.prototype.allCheckNode=function(i,r,n,s,l){if(i)for(var h=0;h<i.length;h++){var c=(0,a.NA)(this.fields.id,i[h]),u=this.element.querySelector('[data-uid="'+c+'"]');l!==!1&&this.checkedElement.indexOf(c.toString())===-1&&(u===null&&!(0,a.le)(i[h][this.fields.isChecked])&&r.indexOf(c.toString())===-1||s===0||n===2)&&(i[h][this.fields.isChecked]!==!1||n===2?r.push(c.toString()):s=null,s=i[h][this.fields.isChecked]!==!1||n===2?0:null),r.indexOf(c.toString())===-1&&(0,a.le)(n)&&r.push(c.toString());var p=(0,a.NA)(this.fields.child.toString(),i[h]);if((0,a.NA)(this.fields.hasChildren,i[h])===!0||p){var f=(0,a.NA)(this.fields.id,i[h]),g=void 0;this.dataType===1?g=this.getChildNodes(this.treeData,f.toString()):g=p,g&&((0,a.le)(l)?this.allCheckNode(g,r,n,s):this.allCheckNode(g,r,n,s,l),s=null)}s=null}},t.prototype.openNode=function(i,r){var n=this.getFocusedNode(),s=(0,a.Ys)("div."+Ui,n);if(i)if(s)s.classList.contains(di)?this.expandAction(n,s,r):this.focusNextNode(n,!0);else return;else if(s&&s.classList.contains(Ji))this.collapseNode(n,s,r);else{var l=(0,a.oq)((0,a.oq)(n,"."+qt),"."+kt);if(l)l.classList.contains("e-disable")||(this.setFocus(n,l),this.navigateToFocus(!0));else return}},t.prototype.navigateNode=function(i){var r=this.getFocusedNode();this.focusNextNode(r,i)},t.prototype.navigateRootNode=function(i){var r=this.getFocusedNode(),n=i?this.getRootNode():this.getEndNode();n.classList.contains("e-disable")||(this.setFocus(r,n),this.navigateToFocus(i))},t.prototype.getFocusedNode=function(){var i,r=(0,a.Ys)("."+kt+"."+za,this.element);return(0,a.le)(r)&&(i=(0,a.Ys)("."+kt,this.element)),(0,a.le)(r)?(0,a.le)(i)?this.element.firstElementChild:i:r},t.prototype.focusNextNode=function(i,r){var n=r?this.getNextNode(i):this.getPrevNode(i);if(this.setFocus(i,n),this.navigateToFocus(!r),n.classList.contains("e-disable")){var s=n.lastChild;n.previousSibling==null&&n.classList.contains("e-level-1")?this.focusNextNode(n,!0):n.nextSibling==null&&n.classList.contains("e-node-collapsed")?this.focusNextNode(n,!1):n.nextSibling==null&&s.classList.contains(Yi)?this.focusNextNode(n,!1):this.focusNextNode(n,r)}},t.prototype.getNextNode=function(i){var r=this.liList.indexOf(i),n;do if(r++,n=this.liList[r],(0,a.le)(n))return i;while(!(0,a.pn)(n));return n},t.prototype.getPrevNode=function(i){var r=this.liList.indexOf(i),n;do if(r--,n=this.liList[r],(0,a.le)(n))return i;while(!(0,a.pn)(n));return n},t.prototype.getRootNode=function(){var i=0,r;do r=this.liList[i],i++;while(!(0,a.pn)(r));return r},t.prototype.getEndNode=function(){var i=this.liList.length-1,r;do r=this.liList[i],i--;while(!(0,a.pn)(r));return r},t.prototype.setFocus=function(i,r){(0,a.IV)([i],[An,za]),r.classList.contains("e-disable")||((0,a.cn)([r],[An,za]),this.updateIdAttr(i,r))},t.prototype.updateIdAttr=function(i,r){this.element.removeAttribute("aria-activedescendant"),i&&i.removeAttribute("id"),r.setAttribute("id",this.element.id+"_active"),this.element.setAttribute("aria-activedescendant",this.element.id+"_active")},t.prototype.focusIn=function(){this.mouseDownStatus||(0,a.cn)([this.getFocusedNode()],An),this.mouseDownStatus=!1},t.prototype.focusOut=function(){(0,a.IV)([this.getFocusedNode()],An)},t.prototype.onMouseOver=function(i){var r=i.target,n=r.classList,s=(0,a.oq)(r,"."+kt);if(!s||n.contains(qt)||n.contains(kt)){this.removeHover();return}else s&&!s.classList.contains("e-disable")&&this.setHover(s)},t.prototype.setHover=function(i){i.classList.contains(An)||(this.removeHover(),(0,a.cn)([i],An))},t.prototype.onMouseLeave=function(i){this.removeHover()},t.prototype.removeHover=function(){var i=(0,a.td)("."+An,this.element);i&&i.length&&(0,a.IV)(i,An)},t.prototype.getNodeData=function(i,r){if(!(0,a.le)(i)&&i.classList.contains(kt)&&!(0,a.le)((0,a.oq)(i,"."+Gf))&&(0,a.oq)(i,"."+Gf).classList.contains(fn)){var n=i.getAttribute("data-uid"),s=this.getText(i,r),l=(0,a.oq)(i.parentNode,"."+kt),h=l?l.getAttribute("data-uid"):null,c=i.classList.contains(Rr),u=i.getAttribute("aria-expanded")==="true",p=i.getAttribute("aria-expanded")!==null?!0:((0,a.Ys)("."+di,i)||(0,a.Ys)("."+Ji,i))!=null,f=null;return this.showCheckBox&&(f=(0,a.Ys)("."+_r,i).getAttribute("aria-checked")),{id:n,text:s,parentID:h,selected:c,expanded:u,isChecked:f,hasChildren:p}}return{id:"",text:"",parentID:"",selected:!1,expanded:!1,isChecked:"",hasChildren:!1}},t.prototype.getText=function(i,r){if(r){var n=this.getNodeObject(i.getAttribute("data-uid")),s=parseFloat(i.getAttribute("aria-level")),l=this.getFields(this.fields,s,1);return(0,a.NA)(l.text,n)}return(0,a.Ys)("."+ia,i).textContent},t.prototype.getExpandEvent=function(i,r){var n=this.getNodeData(i);return{cancel:!1,isInteracted:!(0,a.le)(r),node:i,nodeData:n,event:r}},t.prototype.renderNodeTemplate=function(i,r,n){var s=this.nodeTemplateFn(i,this,"nodeTemplate"+n,this.element.id+"nodeTemplate",this.isStringTemplate,void 0,r,this.root);s&&(s=Array.prototype.slice.call(s),(0,a.R3)(s,r))},t.prototype.destroyTemplate=function(i){this.clearTemplate(["nodeTemplate"+i.getAttribute("data-uid")])},t.prototype.reRenderNodes=function(){this.updateListProp(this.fields),a.AR.isIE?(this.ulElement=this.element.querySelector(".e-list-parent.e-ul"),this.ulElement.parentElement.removeChild(this.ulElement)):this.element.innerHTML="",(0,a.le)(this.nodeTemplateFn)||this.clearTemplate(),this.setTouchClass(),this.setProperties({selectedNodes:[],checkedNodes:[],expandedNodes:[]},!0),this.checkedElement=[],this.isLoaded=!1,this.setDataBinding(!0)},t.prototype.setCssClass=function(i,r){!(0,a.le)(i)&&i!==""&&(0,a.IV)([this.element],i.split(" ")),!(0,a.le)(r)&&r!==""&&(0,a.cn)([this.element],r.split(" "))},t.prototype.editingHandler=function(i){var r=i.target;if(!(!r||r.classList.contains(fn)||r.classList.contains(qt)||r.classList.contains(kt)||r.classList.contains(Ui)||r.classList.contains(ph)||r.classList.contains(Kf))){var n=(0,a.oq)(r,"."+kt);this.createTextbox(n,i)}},t.prototype.createTextbox=function(i,r){var n=this,s=(0,a.Ys)("."+dh,this.element);s&&s.blur();var l=(0,a.Ys)("."+ia,i);this.updateOldText(i);var h=this.createElement("input",{className:dh,attrs:{value:this.oldText}}),c=this.getEditEvent(i,null,h.outerHTML);this.trigger("nodeEditing",c,function(u){if(!u.cancel){var p=l.offsetWidth+5,f="width:"+p+"px";(0,a.cn)([i],Du),(0,a.le)(n.nodeTemplateFn)||n.destroyTemplate(i),l.innerHTML=c.innerHtml;var g=(0,a.Ys)("."+dh,l);n.inputObj=Ue.createInput({element:g,properties:{enableRtl:n.enableRtl}},n.createElement),n.inputObj.container.setAttribute("style",f),g.focus();var C=g;C.setSelectionRange(0,C.value.length),n.wireInputEvents(g)}})},t.prototype.updateOldText=function(i){var r=i.getAttribute("data-uid");this.editData=this.getNodeObject(r);var n=parseFloat(i.getAttribute("aria-level"));this.editFields=this.getFields(this.fields,n,1),this.oldText=(0,a.NA)(this.editFields.text,this.editData)},t.prototype.inputFocusOut=function(i){if(!!(0,a.Ys)("."+dh,this.element)){var r=i.target,n=r.value,s=(0,a.oq)(r,"."+ia),l=(0,a.oq)(r,"."+kt);(0,a.og)(this.inputObj.container),this.fields.dataSource instanceof Oe.h&&!this.isOffline?this.crudOperation("update",null,l,n,null,null,!0):this.appendNewText(l,s,n,!0)}},t.prototype.appendNewText=function(i,r,n,s){var l=this,h=this.getEditEvent(i,n,null);this.trigger("nodeEdited",h,function(c){n=c.cancel?c.oldText:c.newText,l.updateText(i,r,n,s),c.oldText!==n&&l.triggerEvent()})},t.prototype.updateText=function(i,r,n,s){var l=(0,a.sO)(this.editFields.text,n,this.editData);if((0,a.le)(this.nodeTemplateFn))r.innerText=n;else{r.innerText="";var h=i.getAttribute("data-uid");this.renderNodeTemplate(l,r,h),this.renderReactTemplates()}s&&((0,a.IV)([i],Du),r.focus()),this.allowTextWrap&&this.calculateWrap(i)},t.prototype.getElement=function(i){return(0,a.le)(i)?null:typeof i=="string"?this.element.querySelector('[data-uid="'+i+'"]'):typeof i=="object"?(0,a.sb)(i):null},t.prototype.getId=function(i){return(0,a.le)(i)?null:typeof i=="string"?i:typeof i=="object"?(0,a.sb)(i).getAttribute("data-uid"):null},t.prototype.getEditEvent=function(i,r,n){var s=this.getNodeData(i);return{cancel:!1,newText:r,node:i,nodeData:s,oldText:this.oldText,innerHtml:n}},t.prototype.getNodeObject=function(i){var r;if((0,a.le)(i))return r;if(this.dataType===1)for(var n=0,s=this.treeData.length;n<s;n++){var l=(0,a.NA)(this.fields.id,this.treeData[n]);if(!(0,a.le)(this.treeData[n])&&!(0,a.le)(l)&&l.toString()===i)return this.treeData[n]}else return this.getChildNodeObject(this.treeData,this.fields,i);return r},t.prototype.getChildNodeObject=function(i,r,n){var s;if((0,a.le)(i))return s;for(var l=0,h=i.length;l<h;l++){var c=(0,a.NA)(r.id,i[l]);if(i[l]&&c&&c.toString()===n)return i[l];if(typeof r.child=="string"&&!(0,a.le)((0,a.NA)(r.child,i[l]))){var u=(0,a.NA)(r.child,i[l]);if(s=this.getChildNodeObject(u,this.getChildMapper(r),n),s!==void 0)break}else if(this.fields.dataSource instanceof Oe.h&&!(0,a.le)((0,a.NA)("child",i[l]))){var p="child";if(s=this.getChildNodeObject((0,a.NA)(p,i[l]),this.getChildMapper(r),n),s!==void 0)break}}return s},t.prototype.setDragAndDrop=function(i){i&&!this.disabled?this.initializeDrag():this.destroyDrag()},t.prototype.initializeDrag=function(){var i=this,r,n=this;this.dragObj=new a._l(this.element,{enableTailMode:!0,enableAutoScroll:!0,dragArea:this.dragArea,dragTarget:"."+Yi,helper:function(s){i.dragTarget=s.sender.target;var l=(0,a.oq)(i.dragTarget,"."+fn),h=(0,a.oq)(i.dragTarget,"."+Yi);if(i.dragLi=(0,a.oq)(i.dragTarget,"."+kt),i.fullRowSelect&&!h&&i.dragTarget.classList.contains(Un)&&(h=i.dragTarget.nextElementSibling),!i.dragTarget||!s.element.isSameNode(l)||!h||i.dragTarget.classList.contains(fn)||i.dragTarget.classList.contains(qt)||i.dragTarget.classList.contains(kt)||i.dragLi.classList.contains("e-disable"))return!1;var c=h.cloneNode(!0);if((0,a.le)((0,a.Ys)("div."+Ui,c))){var u=n.createElement("div",{className:Ui+" "+di});c.insertBefore(u,c.children[0])}var p=hb+" "+fn+" "+i.cssClass+" "+(i.enableRtl?Xf:"");r=n.createElement("div",{className:p}),r.appendChild(c);var f=i.selectedNodes.length;if(f>1&&i.allowMultiSelection&&i.dragLi.classList.contains(Rr)){var g=n.createElement("span",{className:ub,innerHTML:""+f});r.appendChild(g)}return document.body.appendChild(r),document.body.style.cursor="",i.dragData=i.getNodeData(i.dragLi),r},dragStart:function(s){(0,a.cn)([i.element],Ou);var l=(0,a.oq)(s.target,".e-list-item"),h;l&&(h=parseInt(l.getAttribute("aria-level"),10));var c=i.getDragEvent(s.event,i,null,s.target,null,r,h);c.draggedNode.classList.contains(Du)?(i.dragObj.intDestroy(s.event),i.dragCancelAction(r)):i.trigger("nodeDragStart",c,function(u){u.cancel?(i.dragObj.intDestroy(s.event),i.dragCancelAction(r)):i.dragStartAction=!0})},drag:function(s){i.dragObj.setProperties({cursorAt:{top:!(0,a.le)(s.event.targetTouches)||a.AR.isDevice?60:-20}}),i.dragAction(s,r)},dragStop:function(s){(0,a.IV)([i.element],Ou),i.removeVirtualEle();var l=s.target,h=!1,c=(0,a.oq)(l,"."+Qf),u=!0;(!l||!c)&&((0,a.og)(s.helper),document.body.style.cursor="",u=!1);var p=(0,a.oq)(l,".e-list-item"),f;p&&(f=parseInt(p.getAttribute("aria-level"),10));var g=i.getDragEvent(s.event,i,l,l,null,s.helper,f);g.preventTargetExpand=h,i.trigger("nodeDragStop",g,function(C){i.dragParent=C.draggedParentNode,i.preventExpand=C.preventTargetExpand,C.cancel&&(s.helper.parentNode&&(0,a.og)(s.helper),document.body.style.cursor="",u=!1),i.dragStartAction=!1})}}),this.dropObj=new a.bK(this.element,{out:function(s){!(0,a.le)(s)&&!s.target.classList.contains(jo)&&(document.body.style.cursor="not-allowed")},over:function(s){document.body.style.cursor=""},drop:function(s){i.dropAction(s)}})},t.prototype.dragCancelAction=function(i){(0,a.og)(i),(0,a.IV)([this.element],Ou),this.dragStartAction=!1},t.prototype.dragAction=function(i,r){var n=(0,a.oq)(i.target,"."+Qf),s=(0,a.oq)(i.target,"."+Yi),l=(0,a.Ys)("div."+Ui,r);(0,a.IV)([l],[fh,Wo,Ru,Mu]),this.removeVirtualEle(),document.body.style.cursor="";var h=i.target.classList;if(this.fullRowSelect&&!s&&!(0,a.le)(h)&&h.contains(Un)&&(s=i.target.nextElementSibling),n){var c=(0,a.oq)(i.target,"."+kt),u=(0,a.oq)(i.target,"."+_r),p=(0,a.oq)(i.target,"."+Ji),f=(0,a.oq)(i.target,"."+di);if(!n.classList.contains(fn)||s&&!c.isSameNode(this.dragLi)&&!this.isDescendant(this.dragLi,c))if(this.hasTemplate&&c){var g=(0,a.Ys)(this.fullRowSelect?"."+Un:"."+Yi,c);if(i&&!f&&!p&&i.event.offsetY<7&&!u||f&&i.event.offsetY<5||p&&i.event.offsetX<3){var C=this.fullRowSelect?1:0;this.appendIndicator(c,l,C)}else if(i&&!f&&!p&&!u&&g&&i.event.offsetY>g.offsetHeight-10||f&&i.event.offsetY>19||p&&i.event.offsetX>19){var C=this.fullRowSelect?2:1;this.appendIndicator(c,l,C)}else(0,a.cn)([l],fh)}else if(c&&i&&!f&&!p&&i.event.offsetY<7&&!u||f&&i.event.offsetY<5||p&&i.event.offsetX<3){var C=this.fullRowSelect?1:0;this.appendIndicator(c,l,C)}else if(c&&i&&!f&&!p&&i.target.offsetHeight>0&&i.event.offsetY>i.target.offsetHeight-10&&!u||f&&i.event.offsetY>19||p&&i.event.offsetX>19){var C=this.fullRowSelect?2:1;this.appendIndicator(c,l,C)}else(0,a.cn)([l],fh);else i.target.nodeName==="LI"&&!c.isSameNode(this.dragLi)&&!this.isDescendant(this.dragLi,c)?((0,a.cn)([l],Wo),this.renderVirtualEle(i)):i.target.classList.contains(jo)?(0,a.cn)([l],Wo):(0,a.cn)([l],Ru)}else(0,a.cn)([l],Mu),document.body.style.cursor="not-allowed";var L=(0,a.oq)(i.target,".e-list-item"),D;L&&(D=parseInt(L.getAttribute("aria-level"),10));var R=this.getDragEvent(i.event,this,i.target,i.target,null,r,D);R.dropIndicator&&(0,a.IV)([l],R.dropIndicator),this.trigger("nodeDragging",R),R.dropIndicator&&(0,a.cn)([l],R.dropIndicator)},t.prototype.appendIndicator=function(i,r,n){(0,a.cn)([r],Wo);var s=this.createElement("div",{className:jo});i.insertBefore(s,i.children[n])},t.prototype.dropAction=function(i){var r=i.event.offsetY,n=i.target,s,l,h=!1,c;c=i.dragData.draggable;for(var u=0;u<c.ej2_instances.length;u++)if(c.ej2_instances[u]instanceof e){s=c.ej2_instances[u];break}if(s&&s.dragTarget){var p=s.dragTarget,f=(0,a.oq)(p,"."+kt),g=(0,a.oq)(n,"."+kt);if(g==null&&n.classList.contains(fn)&&(g=n.firstElementChild),(0,a.og)(i.droppedElement),document.body.style.cursor="",!g||g.isSameNode(f)||this.isDescendant(f,g)){this.fields.dataSource instanceof Oe.h||(this.preventExpand=!1);return}if(s.allowMultiSelection&&f.classList.contains(Rr)){var C=(0,a.td)("."+Rr,s.element);if(i.target.offsetHeight<=33&&r>i.target.offsetHeight-10&&r>6)for(var u=C.length-1;u>=0;u--)g.isSameNode(C[u])||this.isDescendant(C[u],g)||this.appendNode(n,C[u],g,i,s,r);else for(var u=0;u<C.length;u++)g.isSameNode(C[u])||this.isDescendant(C[u],g)||this.appendNode(n,C[u],g,i,s,r)}else this.appendNode(n,f,g,i,s,r);l=parseInt(f.getAttribute("aria-level"),10),h=!0}this.fields.dataSource instanceof Oe.h||(this.preventExpand=!1),this.trigger("nodeDropped",this.getDragEvent(i.event,s,n,i.target,i.dragData.draggedElement,null,l,h)),s.element.id!==this.element.id&&s.triggerEvent(),this.triggerEvent()},t.prototype.appendNode=function(i,r,n,s,l,h){var c=(0,a.oq)(i,"."+_r),u=(0,a.oq)(s.target,"."+Ji),p=(0,a.oq)(s.target,"."+di);!r.classList.contains("e-disable")&&!c&&(p&&s.event.offsetY<5||u&&s.event.offsetX<3||p&&s.event.offsetY>19||u&&s.event.offsetX>19||!p&&!u)?i.nodeName==="LI"?this.dropAsSiblingNode(r,n,s,l):i.firstElementChild&&i.classList.contains(fn)?i.firstElementChild.nodeName==="UL"&&this.dropAsSiblingNode(r,n,s,l):i.classList.contains("e-icon-collapsible")||i.classList.contains("e-icon-expandable")?this.dropAsSiblingNode(r,n,s,l):this.dropAsChildNode(r,n,l,null,s,h):this.dropAsChildNode(r,n,l,null,s,h,!0)},t.prototype.dropAsSiblingNode=function(i,r,n,s){var l=(0,a.oq)(r,"."+qt),h=(0,a.oq)(i,"."+qt),c=(0,a.oq)(h,"."+kt),u;if(n.target.offsetHeight>0&&n.event.offsetY>n.target.offsetHeight-2?u=!1:n.event.offsetY<2?u=!0:(n.target.classList.contains("e-icon-expandable")||n.target.classList.contains("e-icon-collapsible"))&&(n.event.offsetY<5||n.event.offsetX<3?u=!0:(n.event.offsetY>15||n.event.offsetX>17)&&(u=!1)),n.target.classList.contains("e-icon-expandable")||n.target.classList.contains("e-icon-collapsible")){var p=n.target.closest("li");l.insertBefore(i,u?p:p.nextElementSibling)}else l.insertBefore(i,u?n.target:n.target.nextElementSibling);this.moveData(i,r,l,u,s),this.updateElement(h,c),this.updateAriaLevel(i),s.element.id===this.element.id?this.updateList():(s.updateInstance(),this.updateInstance())},t.prototype.dropAsChildNode=function(i,r,n,s,l,h,c){var u=(0,a.oq)(i,"."+qt),p=(0,a.oq)(u,"."+kt),f=(0,a.oq)(r,"."+qt),g;if(l&&l.target&&(g=(0,a.Ys)(this.fullRowSelect?"."+Un:"."+Yi,r)),l&&h<7&&!c)f.insertBefore(i,r),this.moveData(i,r,f,!0,n);else if(l&&l.target.offsetHeight>0&&h>l.target.offsetHeight-10&&!c&&!this.hasTemplate)f.insertBefore(i,r.nextElementSibling),this.moveData(i,r,f,!1,n);else if(this.hasTemplate&&g&&h>g.offsetHeight-10&&!c)f.insertBefore(i,r.nextElementSibling),this.moveData(i,r,f,!1,n);else{var C=this.expandParent(r),L=C.childNodes[s];C.insertBefore(i,L),this.moveData(i,L,C,!0,n)}this.updateElement(u,p),this.updateAriaLevel(i),n.element.id===this.element.id?this.updateList():(n.updateInstance(),this.updateInstance())},t.prototype.moveData=function(i,r,n,s,l){var h=(0,a.oq)(n,"."+kt),c=this.getId(i),u=l.updateChildField(l.treeData,l.fields,c,null,null,!0),p=this.getId(r),f=this.getDataPos(this.treeData,this.fields,p),g=this.getId(h);if(this.dataType===1){this.updateField(this.treeData,this.fields,g,"hasChildren",!0);var C=(0,a.le)(f)?this.treeData.length:s?f:f+1;if((0,a.le)(g)&&!this.hasPid)delete u[0][this.fields.parentID];else{var L=this.isNumberTypeId?parseFloat(g):g;(0,a.sO)(this.fields.parentID,L,u[0])}if(this.treeData.splice(C,0,u[0]),l.element.id!==this.element.id){var D=l.removeChildNodes(c);C++;for(var R=0,B=D.length;R<B;R++)this.treeData.splice(C,0,D[R]),C++;l.groupedData=l.getGroupedData(l.treeData,l.fields.parentID)}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}else this.addChildData(this.treeData,this.fields,g,u,s?f:f+1)},t.prototype.expandParent=function(i){var r=(0,a.Ys)("div."+Ui,i);r&&r.classList.contains(di)&&this.preventExpand!==!0&&this.expandAction(i,r,null);var n=(0,a.Ys)("."+qt,i);if(this.preventExpand===!0&&!n&&r&&this.renderChildNodes(i),n=(0,a.Ys)("."+qt,i),!(0,a.le)(n)&&this.preventExpand===!0&&(n.style.display="none"),!(0,a.le)(n)&&this.preventExpand===!1&&(n.style.display="block"),(0,a.le)(n)&&this.preventExpand===!0){(0,a.le)(r)&&Mt.generateIcon(this.createElement,i,di,this.listBaseOption);var s=(0,a.Ys)("div."+Ui,i);s&&s.classList.add("e-icon-expandable"),n=Mt.generateUL(this.createElement,[],null,this.listBaseOption),i.appendChild(n),s?(0,a.IV)([s],Ji):Mt.generateIcon(this.createElement,i,di,this.listBaseOption),i.setAttribute("aria-expanded","false"),n.style.display="none"}if((0,a.le)(n)){this.trigger("nodeExpanding",this.getExpandEvent(i,null)),(0,a.le)(r)&&Mt.generateIcon(this.createElement,i,Ji,this.listBaseOption);var s=(0,a.Ys)("div."+Ui,i);s?(0,a.IV)([s],di):(Mt.generateIcon(this.createElement,i,Ji,this.listBaseOption),s=(0,a.Ys)("div."+Ui,i),(0,a.IV)([s],di)),n=Mt.generateUL(this.createElement,[],null,this.listBaseOption),i.appendChild(n),this.addExpand(i),this.trigger("nodeExpanded",this.getExpandEvent(i,null))}return n},t.prototype.updateElement=function(i,r){if(r&&i.childElementCount===0){var n=(0,a.Ys)("div."+Ui,r);(0,a.og)(i),(0,a.og)(n);var s=this.getId(r);this.updateField(this.treeData,this.fields,s,"hasChildren",!1),this.removeExpand(r,!0)}},t.prototype.updateAriaLevel=function(i){var r=this.parents(i,"."+qt).length;i.setAttribute("aria-level",""+r),this.updateChildAriaLevel((0,a.Ys)("."+qt,i),r+1)},t.prototype.updateChildAriaLevel=function(i,r){if(!(0,a.le)(i))for(var n=i.childNodes,s=0,l=n.length;s<l;s++){var h=n[s];h.setAttribute("aria-level",""+r),this.updateChildAriaLevel((0,a.Ys)("."+qt,h),r+1)}},t.prototype.renderVirtualEle=function(i){var r;i.event.offsetY>i.target.offsetHeight-2?r=!1:i.event.offsetY<2&&(r=!0);var n=this.createElement("div",{className:jo}),s=this.fullRowSelect?r?1:2:r?0:1;i.target.insertBefore(n,i.target.children[s])},t.prototype.removeVirtualEle=function(){var i=(0,a.Ys)("."+jo);i&&(0,a.og)(i)},t.prototype.destroyDrag=function(){this.dragObj&&this.dropObj&&(this.dragObj.destroy(),this.dropObj.destroy())},t.prototype.getDragEvent=function(i,r,n,s,l,h,c,u){var p=n?(0,a.oq)(n,"."+kt):null,f=p?this.getNodeData(p):null,g=r?r.dragLi:l,C=r?r.dragData:null,L=n?this.parents(n,"."+kt):null,D=r.dragLi.parentElement,R=r.dragLi?(0,a.oq)(D,"."+kt):null,B=null,H=null,j=[Wo,fh,Ru,Mu],W=null,ne=u===!0?g:p,ie=ne?(0,a.oq)(ne,".e-list-parent"):null,me=0,ve=null;if(R=r.dragLi&&R===null?(0,a.oq)(D,"."+fn):R,R=u===!0?this.dragParent:R,h)for(;me<4;){if((0,a.Ys)("."+Ui,h).classList.contains(j[me])){W=j[me];break}me++}if(ie){var Ee=0;for(me=0;me<ie.childElementCount;me++)if(Ee=u!==!0&&ie.children[me]===g&&p!==g?++Ee:Ee,u!==!0&&ie.children[me].classList.contains("e-hover")){H=i.offsetY>=23?me+1:me;break}else if(ie.children[me]===ne){H=(i.offsetY>=23,me);break}H=Ee!==0?--H:H,ve=W=="e-drop-in"?"Inside":i.offsetY<7?"Before":"After"}if(n&&(L.length===0?B=null:n.classList.contains(kt)?B=L[0]:B=L[1]),p===g&&(B=p),n&&s.offsetHeight<=33&&i.offsetY<s.offsetHeight-10&&i.offsetY>6&&(B=p,u!==!0)){c=++c;var le=B?(0,a.Ys)(".e-list-parent",B):null;if(H=le?le.children.length:0,!(this.fields.dataSource instanceof Oe.h)&&le===null&&B){var de=B.hasAttribute("data-uid")?this.getChildNodes(this.fields.dataSource,B.getAttribute("data-uid").toString()):null;H=de?de.length:0}}return{cancel:!1,clonedNode:h,event:i,draggedNode:g,draggedNodeData:C,droppedNode:p,droppedNodeData:f,dropIndex:H,dropLevel:c,draggedParentNode:R,dropTarget:B,dropIndicator:W,target:s,position:ve}},t.prototype.addFullRow=function(i){var r=this.liList.length;if(i)for(var n=0;n<r;n++)this.createFullRow(this.liList[n]);else for(var n=0;n<r;n++){var s=(0,a.Ys)("."+Un,this.liList[n]);(0,a.og)(s)}},t.prototype.createFullRow=function(i){var r=this.createElement("div",{className:Un});i.insertBefore(r,i.childNodes[0])},t.prototype.addMultiSelect=function(i){if(i)for(var r=(0,a.td)("."+kt+':not([aria-selected="true"])',this.element),n=0,s=r;n<s.length;n++){var l=s[n];l.setAttribute("aria-selected","false")}else for(var r=(0,a.td)("."+kt+'[aria-selected="false"]',this.element),h=0,c=r;h<c.length;h++){var l=c[h];l.removeAttribute("aria-selected")}},t.prototype.collapseByLevel=function(i,r,n){if(r>0&&!(0,a.le)(i))for(var s=this.getVisibleNodes(n,i.childNodes),l=0,h=s.length;l<h;l++){var c=s[l],u=(0,a.Ys)("."+Ji,(0,a.Ys)("."+Yi,c));(0,a.le)(u)||this.collapseNode(c,u,null),this.collapseByLevel((0,a.Ys)("."+qt,c),r-1,n)}},t.prototype.collapseAllNodes=function(i){for(var r=this.getVisibleNodes(i,(0,a.td)("."+Ji,this.element)),n=0,s=r.length;n<s;n++){var l=r[n],h=(0,a.oq)(l,"."+kt);this.collapseNode(h,l,null)}},t.prototype.expandByLevel=function(i,r,n){if(r>0&&!(0,a.le)(i))for(var s=this.getVisibleNodes(n,i.childNodes),l=0,h=s.length;l<h;l++){var c=s[l],u=(0,a.Ys)("."+di,(0,a.Ys)("."+Yi,c));(0,a.le)(u)||this.expandAction(c,u,null),this.expandByLevel((0,a.Ys)("."+qt,c),r-1,n)}},t.prototype.expandAllNodes=function(i){for(var r=this.getVisibleNodes(i,(0,a.td)("."+di,this.element)),n=0,s=r.length;n<s;n++){var l=r[n],h=(0,a.oq)(l,"."+kt);this.expandAction(h,l,null,!0)}},t.prototype.getVisibleNodes=function(i,r){var n=Array.prototype.slice.call(r);if(i)for(var s=0;s<n.length;s++)(0,a.pn)(n[s])||(n.splice(s,1),s--);return n},t.prototype.removeNode=function(i){var r=(0,a.oq)(i,"."+qt),n=(0,a.oq)(r,"."+kt);(0,a.le)(this.nodeTemplateFn)||this.destroyTemplate(i),(0,a.og)(i),this.updateElement(r,n),this.removeData(i)},t.prototype.updateInstance=function(){this.updateList(),this.updateSelectedNodes(),this.updateExpandedNodes()},t.prototype.updateList=function(){this.liList=Array.prototype.slice.call((0,a.td)("."+kt,this.element))},t.prototype.updateSelectedNodes=function(){this.setProperties({selectedNodes:[]},!0);var i=(0,a.td)("."+Rr,this.element);this.selectGivenNodes(i)},t.prototype.updateExpandedNodes=function(){this.setProperties({expandedNodes:[]},!0);for(var i=(0,a.td)('[aria-expanded="true"]',this.element),r=0,n=i.length;r<n;r++)this.addExpand(i[r])},t.prototype.removeData=function(i){if(this.dataType===1){var r=new Oe.h(this.treeData),n=this.getId(i),s={},l=this.isNumberTypeId?parseFloat(n):n;s[this.fields.id]=l,r.remove(this.fields.id,s),this.removeChildNodes(n)}else{var n=this.getId(i);this.updateChildField(this.treeData,this.fields,n,null,null,!0)}},t.prototype.removeChildNodes=function(i){var r=this.getChildGroup(this.groupedData,i,!1),n=[];if(r)for(var s=0,l=r.length;s<l;s++){var h=new Oe.h(this.treeData),c=(0,a.NA)(this.fields.id,r[s]).toString(),u={},p=this.isNumberTypeId?parseFloat(c):c;u[this.fields.id]=p;var f=h.remove(this.fields.id,u);n.push(f[0]),this.removeChildNodes(c)}return n},t.prototype.doGivenAction=function(i,r,n){for(var s=0,l=i.length;s<l;s++){var h=this.getElement(i[s]);if(!(0,a.le)(h)){var c=(0,a.Ys)("."+r,(0,a.Ys)("."+Yi,h));(0,a.le)(c)||(n?this.expandAction(h,c,null):this.collapseNode(h,c,null))}}},t.prototype.addGivenNodes=function(i,r,n,s,l){if(i.length!==0){var h=this.getSortedData(i),c=r?parseFloat(r.getAttribute("aria-level"))+1:1;s&&this.updateMapper(c);var u=Mt.createListItemFromJson(this.createElement,h,this.listBaseOption,c),p;l?p=l:p=r?this.expandParent(r):(0,a.Ys)("."+qt,this.element);var f=p.childNodes[n];if(f||this.sortOrder==="None")for(var g=0;g<u.length;g++)p.insertBefore(u[g],f);if(!f&&(this.sortOrder==="Ascending"||this.sortOrder==="Descending"))for(var C=p.childNodes,g=0;g<u.length;g++)for(var L=0;L<C.length;L++){var D=this.sortOrder==="Ascending"?C[L].textContent.toUpperCase()>u[g].innerText.toUpperCase():C[L].textContent.toUpperCase()<u[g].innerText.toUpperCase();if(D){p.insertBefore(u[g],C[L]);break}p.insertBefore(u[g],C[C.length])}var R=this.getId(r);if(this.dataType===1){this.updateField(this.treeData,this.fields,R,"hasChildren",!0);for(var B=this.getId(f),H=(0,a.le)(B)?this.treeData.length:this.getDataPos(this.treeData,this.fields,B),L=0;L<i.length;L++){if(!(0,a.le)(R)){var j=this.isNumberTypeId?parseFloat(R):R;(0,a.sO)(this.fields.parentID,j,i[L])}this.treeData.splice(H,0,i[L]),H++}}else this.addChildData(this.treeData,this.fields,R,i,n);this.finalizeNode(p)}},t.prototype.updateMapper=function(i){var r=i===1?this.fields:this.getChildFields(this.fields,i-1,1);this.updateListProp(r)},t.prototype.updateListProp=function(i){var r=this.getActualProperties(i);this.listBaseOption.fields=r,this.listBaseOption.fields.url=r.hasOwnProperty("navigateUrl")?r.navigateUrl:"navigateUrl"},t.prototype.getDataPos=function(i,r,n){for(var s=null,l=0,h=i.length;l<h;l++){var c=(0,a.NA)(r.id,i[l]);if(i[l]&&c&&c.toString()===n)return l;if(typeof r.child=="string"&&!(0,a.le)((0,a.NA)(r.child,i[l]))){var u=(0,a.NA)(r.child,i[l]);if(s=this.getDataPos(u,this.getChildMapper(r),n),s!==null)break}else if(this.fields.dataSource instanceof Oe.h&&!(0,a.le)((0,a.NA)("child",i[l]))){var p=(0,a.NA)("child",i[l]);if(s=this.getDataPos(p,this.getChildMapper(r),n),s!==null)break}}return s},t.prototype.addChildData=function(i,r,n,s,l){var h;if((0,a.le)(n)){l=(0,a.le)(l)?i.length:l;for(var c=0,u=s.length;c<u;c++)i.splice(l,0,s[c]),l++;return h}for(var p=0,f=i.length;p<f;p++){var g=(0,a.NA)(r.id,i[p]);if(i[p]&&g&&g.toString()===n){if(typeof r.child=="string"&&i[p].hasOwnProperty(r.child)&&i[p][r.child]!==null||this.fields.dataSource instanceof Oe.h&&i[p].hasOwnProperty("child")){var C=typeof r.child=="string"?r.child:"child",L=(0,a.NA)(C,i[p]);(0,a.le)(L)&&(L=[]),l=(0,a.le)(l)?L.length:l;for(var c=0,u=s.length;c<u;c++)L.splice(l,0,s[c]),l++}else{var C=typeof r.child=="string"?r.child:"child";i[p][C]=s}return!0}else if(typeof r.child=="string"&&!(0,a.le)((0,a.NA)(r.child,i[p]))){var D=(0,a.NA)(r.child,i[p]);if(h=this.addChildData(D,this.getChildMapper(r),n,s,l),h!==void 0)break}else if(this.fields.dataSource instanceof Oe.h&&!(0,a.le)((0,a.NA)("child",i[p]))){var L=(0,a.NA)("child",i[p]);if(h=this.addChildData(L,this.getChildMapper(r),n,s,l),h!==void 0)break}}return h},t.prototype.doDisableAction=function(i){var r=this.nodeType(i),n=this.checkValidId(r);this.validArr=[];for(var s=0,l=n.length;s<l;s++){var h=n[s][this.fields.id].toString();h&&this.disableNode.indexOf(h)===-1&&this.disableNode.push(h);var c=this.getElement(h);c&&(c.setAttribute("aria-disabled","true"),(0,a.cn)([c],ev))}},t.prototype.doEnableAction=function(i){for(var r=this.nodeType(i),n=0,s=r.length;n<s;n++){var l=this.getElement(r[n]),h=r[n];h&&this.disableNode.indexOf(h)!==-1&&this.disableNode.splice(this.disableNode.indexOf(h),1),l&&(l.removeAttribute("aria-disabled"),(0,a.IV)([l],ev))}},t.prototype.nodeType=function(i){for(var r=[],n=0,s=i.length;n<s;n++){var l=void 0;typeof i[n]=="string"?l=i[n]?i[n].toString():null:typeof i[n]=="object"&&(l=i[n]?i[n].getAttribute("data-uid").toString():null),r.indexOf(l)==-1&&r.push(l)}return r},t.prototype.checkValidId=function(i){var r=this;if(this.dataType===1)this.validArr=this.treeData.filter(function(h){return i.indexOf(h[r.fields.id]?h[r.fields.id].toString():null)!==-1});else if(this.dataType===2)for(var n=0;n<this.treeData.length;n++){var s=this.treeData[n][this.fields.id]?this.treeData[n][this.fields.id].toString():null;i.indexOf(s)!==-1&&this.validArr.push(this.treeData[n]);var l=(0,a.NA)(this.fields.child.toString(),this.treeData[n]);l&&this.filterNestedChild(l,i)}return this.validArr},t.prototype.filterNestedChild=function(i,r){for(var n=0;n<i.length;n++){var s=i[n][this.fields.id]?i[n][this.fields.id].toString():null;r.indexOf(s)!==-1&&this.validArr.push(i[n]);var l=(0,a.NA)(this.fields.child.toString(),i[n]);l&&this.filterNestedChild(l,r)}},t.prototype.setTouchClass=function(){var i=(0,a.oq)(this.element,"."+fb);this.touchClass=(0,a.le)(i)?"":vb},t.prototype.updatePersistProp=function(){this.removeField(this.treeData,this.fields,["selected","expanded"]);for(var i=this.selectedNodes,r=0,n=i.length;r<n;r++)this.updateField(this.treeData,this.fields,i[r],"selected",!0);for(var s=this.expandedNodes,l=0,h=s.length;l<h;l++)this.updateField(this.treeData,this.fields,s[l],"expanded",!0);if(this.showCheckBox){this.removeField(this.treeData,this.fields,["isChecked"]);for(var c=this.checkedNodes,u=0,h=c.length;u<h;u++)this.updateField(this.treeData,this.fields,c[u],"isChecked",!0)}},t.prototype.removeField=function(i,r,n){if(!((0,a.le)(i)||(0,a.le)(r)))for(var s=0,l=i.length;s<l;s++){for(var h=0;h<n.length;h++){var c=this.getMapperProp(r,n[h]);(0,a.le)(i[s][c])||delete i[s][c]}typeof r.child=="string"&&!(0,a.le)((0,a.NA)(r.child,i[s]))?this.removeField((0,a.NA)(r.child,i[s]),this.getChildMapper(r),n):this.fields.dataSource instanceof Oe.h&&!(0,a.le)((0,a.NA)("child",i[s]))&&this.removeField((0,a.NA)("child",i[s]),this.getChildMapper(r),n)}},t.prototype.getMapperProp=function(i,r){switch(r){case"selected":return(0,a.le)(i.selected)?"selected":i.selected;case"expanded":return(0,a.le)(i.expanded)?"expanded":i.expanded;case"isChecked":return(0,a.le)(i.isChecked)?"isChecked":i.isChecked;case"hasChildren":return(0,a.le)(i.hasChildren)?"hasChildren":i.hasChildren;default:return r}},t.prototype.updateField=function(i,r,n,s,l){var h;if(!(0,a.le)(n))if(this.dataType===1){var c=this.isNumberTypeId?parseFloat(n):n,u=new Oe.h(this.treeData).executeLocal(new yt.A().where(r.id,"equal",c,!1));(0,a.sO)(this.getMapperProp(r,s),l,u[0])}else this.updateChildField(i,r,n,s,l)},t.prototype.updateChildField=function(i,r,n,s,l,h){var c;if((0,a.le)(i))return c;for(var u=0,p=i.length;u<p;u++){var f=(0,a.NA)(r.id,i[u]);if(i[u]&&f&&f.toString()===n)return h?c=i.splice(u,1):((0,a.sO)(this.getMapperProp(r,s),l,i[u]),c=[]),c;if(typeof r.child=="string"&&!(0,a.le)((0,a.NA)(r.child,i[u]))){var g=(0,a.NA)(r.child,i[u]);if(c=this.updateChildField(g,this.getChildMapper(r),n,s,l,h),c!==void 0)break}else if(this.fields.dataSource instanceof Oe.h&&!(0,a.le)((0,a.NA)("child",i[u]))){var C=(0,a.NA)("child",i[u]);if(c=this.updateChildField(C,this.getChildMapper(r),n,s,l,h),c!==void 0)break}}return c},t.prototype.triggerEvent=function(){this.renderReactTemplates();var i={data:this.treeData};this.trigger("dataSourceChanged",i)},t.prototype.wireInputEvents=function(i){a.bi.add(i,"blur",this.inputFocusOut,this)},t.prototype.wireEditingEvents=function(i){var r=this;if(i&&!this.disabled){var n=this;this.touchEditObj=new a.Xh(this.element,{tap:function(s){r.isDoubleTapped(s)&&s.tapCount===2&&(s.originalEvent.preventDefault(),n.editingHandler(s.originalEvent))}})}else this.touchEditObj&&this.touchEditObj.destroy()},t.prototype.wireClickEvent=function(i){if(i){var r=this;this.touchClickObj=new a.Xh(this.element,{tap:function(n){r.clickHandler(n)}})}else this.touchClickObj&&this.touchClickObj.destroy()},t.prototype.wireExpandOnEvent=function(i){var r=this;if(i){var n=this;this.touchExpandObj=new a.Xh(this.element,{tap:function(s){(r.expandOnType==="Click"||r.expandOnType==="DblClick"&&r.isDoubleTapped(s)&&s.tapCount===2)&&s.originalEvent.which!==3&&n.expandHandler(s)}})}else this.touchExpandObj&&this.touchExpandObj.destroy()},t.prototype.mouseDownHandler=function(i){this.mouseDownStatus=!0,(i.shiftKey||i.ctrlKey)&&i.preventDefault(),i.ctrlKey&&this.allowMultiSelection&&a.bi.add(this.element,"contextmenu",this.preventContextMenu,this)},t.prototype.preventContextMenu=function(i){i.preventDefault()},t.prototype.wireEvents=function(){a.bi.add(this.element,"mousedown",this.mouseDownHandler,this),this.wireClickEvent(!0),this.expandOnType!=="None"&&this.wireExpandOnEvent(!0),a.bi.add(this.element,"focus",this.focusIn,this),a.bi.add(this.element,"blur",this.focusOut,this),a.bi.add(this.element,"mouseover",this.onMouseOver,this),a.bi.add(this.element,"mouseout",this.onMouseLeave,this),this.keyboardModule=new a.nv(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},t.prototype.unWireEvents=function(){a.bi.remove(this.element,"mousedown",this.mouseDownHandler),this.wireClickEvent(!1),this.wireExpandOnEvent(!1),a.bi.remove(this.element,"focus",this.focusIn),a.bi.remove(this.element,"blur",this.focusOut),a.bi.remove(this.element,"mouseover",this.onMouseOver),a.bi.remove(this.element,"mouseout",this.onMouseLeave),this.disabled||this.keyboardModule.destroy()},t.prototype.parents=function(i,r){for(var n=[],s=i.parentNode;!(0,a.le)(s);)(0,a.wB)(s,r)&&n.push(s),s=s.parentNode;return n},t.prototype.isDoubleTapped=function(i){var r=i.originalEvent.target,n;return r&&i.tapCount&&(i.tapCount===1?this.firstTap=(0,a.oq)(r,"."+kt):i.tapCount===2&&(n=(0,a.oq)(r,"."+kt))),this.firstTap===n},t.prototype.isDescendant=function(i,r){for(var n=r.parentNode;!(0,a.le)(n);){if(n===i)return!0;n=n.parentNode}return!1},t.prototype.showSpinner=function(i){(0,a.cn)([i],Iu),Ha({target:i,width:a.AR.isDevice?16:14},this.createElement),jn(i)},t.prototype.hideSpinner=function(i){Cs(i),i.innerHTML="",(0,a.IV)([i],Iu)},t.prototype.setCheckedNodes=function(i){i=JSON.parse(JSON.stringify(i)),this.uncheckAll(this.checkedNodes),this.setIndeterminate(i),i.length>0&&this.checkAll(i)},t.prototype.setValidCheckedNode=function(i){if(this.dataType===1){var r=this.fields,n=new Oe.h(this.treeData).executeLocal(new yt.A().where(r.id,"equal",i,!0));if(n[0]&&(this.setChildCheckState(n,i,n[0]),this.autoCheck)){for(var s=n[0][this.fields.parentID]?n[0][this.fields.parentID].toString():null,l=this.getChildNodes(this.treeData,s),h=0,c=0;c<l.length;c++){var u=l[c][this.fields.id].toString();this.checkedNodes.indexOf(u)!==-1&&h++}h===l.length&&this.checkedNodes.indexOf(s)===-1&&s&&this.checkedNodes.push(s)}}else if(this.dataType===2)for(var p=0;p<this.treeData.length;p++){var f=this.treeData[p][this.fields.id]?this.treeData[p][this.fields.id].toString():"";if(f===i&&this.checkedNodes.indexOf(i)===-1){this.checkedNodes.push(i);break}var g=(0,a.NA)(this.fields.child.toString(),this.treeData[p]);g&&this.setChildCheckState(g,i,this.treeData[p])}},t.prototype.setChildCheckState=function(i,r,n){var s,l=0;if(this.dataType===1){n&&(s=n[this.fields.id]?n[this.fields.id].toString():null);for(var h=0;h<i.length;h++){var c=i[h][this.fields.id]?i[h][this.fields.id].toString():null;n&&s&&this.autoCheck&&this.checkedNodes.indexOf(s)!==-1&&this.checkedNodes.indexOf(c)===-1&&this.checkedNodes.push(c),c===r&&this.checkedNodes.indexOf(r)===-1&&this.checkedNodes.push(r);var u=this.getChildNodes(this.treeData,c);u&&this.setChildCheckState(u,r,n)}}else{n&&(s=n[this.fields.id]?n[this.fields.id].toString():"");for(var h=0;h<i.length;h++){var p=i[h][this.fields.id]?i[h][this.fields.id].toString():"";n&&s&&this.autoCheck&&this.checkedNodes.indexOf(s)!==-1&&this.checkedNodes.indexOf(p)===-1&&this.checkedNodes.push(p),p===r&&this.checkedNodes.indexOf(r)===-1&&this.checkedNodes.push(r);var u=(0,a.NA)(this.fields.child.toString(),i[h]);u&&this.setChildCheckState(u,r,i[h]),this.checkedNodes.indexOf(p)!==-1&&this.autoCheck&&l++,l===i.length&&this.checkedNodes.indexOf(s)===-1&&this.autoCheck&&this.checkedNodes.push(s)}}},t.prototype.setIndeterminate=function(i){for(var r=0;r<i.length;r++)this.setValidCheckedNode(i[r])},t.prototype.updatePosition=function(i,r,n,s){if(this.dataType===1){var l=this.getDataPos(this.treeData,this.fields,i);if(this.treeData.splice(l,1,r),n){this.removeChildNodes(i);for(var h=0;h<s.length;h++)this.treeData.splice(l,0,s[h]),l++}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}else this.updateChildPosition(this.treeData,this.fields,i,[r],void 0)},t.prototype.updateChildPosition=function(i,r,n,s,l){for(var h,c=0,u=i.length;c<u;c++){var p=(0,a.NA)(r.id,i[c]);if(i[c]&&p&&p.toString()===n)return i[c]=s[0],!0;if(typeof r.child=="string"&&!(0,a.le)((0,a.NA)(r.child,i[c]))){var f=(0,a.NA)(r.child,i[c]);if(h=this.updateChildPosition(f,this.getChildMapper(r),n,s,l),h!==void 0)break}else if(this.fields.dataSource instanceof Oe.h&&!(0,a.le)((0,a.NA)("child",i[c]))){var g=(0,a.NA)("child",i[c]);if(h=this.updateChildPosition(g,this.getChildMapper(r),n,s,l),h!==void 0)break}}return h},t.prototype.dynamicState=function(){this.setDragAndDrop(this.allowDragAndDrop),this.wireEditingEvents(this.allowEditing),this.disabled?(this.unWireEvents(),this.rippleFn(),this.rippleIconFn()):(this.wireEvents(),this.setRipple())},t.prototype.crudOperation=function(i,r,n,s,l,h,c){var u=this,p=this.fields.dataSource,f=[],g=this.getQuery(this.fields),C=this.fields.id,L,D={addedRecords:[],deletedRecords:[],changedRecords:[]},R=[];r?R=this.nodeType(r):n&&(typeof n=="string"?R[0]=n.toString():typeof n=="object"&&(R[0]=n.getAttribute("data-uid").toString()));for(var B=0,H=R.length;B<H;B++){var j=this.getElement(R[B]);if(!(0,a.le)(j)){var W=this.getNodeObject(R[B]);f.push(W)}}switch(i){case"delete":r.length==1?L=p.remove(C,f[0],g.fromTable,g):(D.deletedRecords=f,L=p.saveChanges(D,C,g.fromTable,g)),L.then(function(ie){return u.deleteSuccess(R)}).catch(function(ie){return u.dmFailure(ie)});break;case"update":f[0][this.fields.text]=s,L=p.update(C,f[0],g.fromTable,g),L.then(function(ie){return u.editSucess(n,s,c)}).catch(function(ie){return u.dmFailure(ie,n,c)});break;case"insert":if(l.length==1)L=p.insert(l[0],g.fromTable,g);else{for(var ne=[],B=0,H=l.length;B<H;B++)ne.push(l[B]);D.addedRecords=ne,L=p.saveChanges(D,C,g.fromTable,g)}L.then(function(ie){var me=u.getElement(n);u.addSuccess(l,me,h),u.preventExpand=!1}).catch(function(ie){return u.dmFailure(ie)});break}},t.prototype.deleteSuccess=function(i){for(var r=0,n=i.length;r<n;r++){var s=this.getElement(i[r]);(0,a.le)(s)||this.removeNode(s)}this.updateInstance(),this.dataType===1&&(this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)),this.triggerEvent()},t.prototype.editSucess=function(i,r,n){var s=this.getElement(i),l=(0,a.Ys)("."+ia,s);this.appendNewText(s,l,r,n)},t.prototype.addSuccess=function(i,r,n){var s,l=r?r.querySelector("."+Ui):null,h=this;r&&l&&l.classList.contains(di)&&r.querySelector("."+qt)===null?h.renderChildNodes(r,null,function(){s=r.querySelector("."+qt),h.addGivenNodes(i,r,n,!0,s),h.triggerEvent()}):(this.addGivenNodes(i,r,n,!0),this.triggerEvent())},t.prototype.dmFailure=function(i,r,n){r&&this.updatePreviousText(r,n),this.trigger("actionFailure",{error:i})},t.prototype.updatePreviousText=function(i,r){var n=this.getElement(i),s=(0,a.Ys)("."+ia,n);this.updateText(n,s,this.oldText,r)},t.prototype.onPropertyChanged=function(i,r){for(var n=0,s=Object.keys(i);n<s.length;n++){var l=s[n];switch(l){case"allowDragAndDrop":this.setDragAndDrop(this.allowDragAndDrop);break;case"dragArea":this.allowDragAndDrop&&(this.dragObj.dragArea=this.dragArea);break;case"allowEditing":this.wireEditingEvents(this.allowEditing);break;case"allowMultiSelection":if(this.selectedNodes.length>1){var h=this.getElement(this.selectedNodes[0]);this.isLoaded=!1,this.removeSelectAll(),this.selectNode(h,null),this.isLoaded=!0}this.setMultiSelect(this.allowMultiSelection),this.addMultiSelect(this.allowMultiSelection);break;case"allowTextWrap":this.setTextWrap(),this.updateWrap();break;case"checkedNodes":this.showCheckBox&&(this.checkedNodes=r.checkedNodes,this.setCheckedNodes(i.checkedNodes));break;case"autoCheck":this.showCheckBox&&(this.autoCheck=i.autoCheck,this.ensureIndeterminate());break;case"cssClass":this.setCssClass(r.cssClass,i.cssClass);break;case"enableRtl":this.setEnableRtl();break;case"expandedNodes":this.isAnimate=!1,this.setProperties({expandedNodes:[]},!0),this.collapseAll(),this.isInitalExpand=!0,this.setProperties({expandedNodes:(0,a.le)(i.expandedNodes)?[]:i.expandedNodes},!0),this.doExpandAction(),this.isInitalExpand=!1,this.isAnimate=!0;break;case"expandOn":this.wireExpandOnEvent(!1),this.setExpandOnType(),this.expandOnType!=="None"&&!this.disabled&&this.wireExpandOnEvent(!0);break;case"disabled":this.setDisabledMode(),this.dynamicState();break;case"fields":this.isAnimate=!1,this.isFieldChange=!0,this.initialRender=!0,this.reRenderNodes(),this.initialRender=!1,this.isAnimate=!0,this.isFieldChange=!1;break;case"fullRowSelect":this.setFullRow(this.fullRowSelect),this.addFullRow(this.fullRowSelect),this.allowTextWrap&&(this.setTextWrap(),this.updateWrap());break;case"loadOnDemand":if(this.loadOnDemand===!1&&!this.onLoaded){for(var c=this.element.querySelectorAll("li"),u=0;u<c.length;)c[u].getAttribute("aria-expanded")!=="true"&&this.renderChildNodes(c[u],!0,null,!0),u++;this.onLoaded=!0}break;case"nodeTemplate":this.hasTemplate=!1,this.nodeTemplateFn=this.templateComplier(this.nodeTemplate),this.reRenderNodes();break;case"selectedNodes":this.removeSelectAll(),this.setProperties({selectedNodes:i.selectedNodes},!0),this.doSelectionAction();break;case"showCheckBox":this.reRenderNodes();break;case"sortOrder":this.reRenderNodes();break;case"fullRowNavigable":this.setProperties({fullRowNavigable:i.fullRowNavigable},!0),this.listBaseOption.itemNavigable=i.fullRowNavigable,this.reRenderNodes();break}}},t.prototype.destroy=function(){this.clearTemplate(),this.element.removeAttribute("aria-activedescendant"),this.element.removeAttribute("tabindex"),this.unWireEvents(),this.wireEditingEvents(!1),this.disabled||(this.rippleFn(),this.rippleIconFn()),this.setCssClass(this.cssClass,null),this.setDragAndDrop(!1),this.setFullRow(!1),this.ulElement&&this.ulElement.parentElement&&this.ulElement.parentElement.removeChild(this.ulElement),o.prototype.destroy.call(this)},t.prototype.addNodes=function(i,r,n,s){if(!(0,a.le)(i)){i=JSON.parse(JSON.stringify(i));var l=this.getElement(r);if(this.preventExpand=s,this.fields.dataSource instanceof Oe.h)this.isOffline?this.addSuccess(i,l,n):this.crudOperation("insert",null,r,null,i,n,this.preventExpand);else if(this.dataType===2)this.addGivenNodes(i,l,n);else{if(l)this.addGivenNodes(i,l,n);else{i=this.getSortedData(i);for(var h=0;h<i.length;h++){var c=(0,a.NA)(this.fields.parentID,i[h]);l=c&&this.getElement(c.toString()),this.addGivenNodes([i[h]],l,n)}}this.groupedData=this.getGroupedData(this.treeData,this.fields.parentID)}this.updateCheckedStateFromDS(),this.showCheckBox&&l&&this.ensureParentCheckState(l),this.fields.dataSource instanceof Oe.h||(this.preventExpand=!1,this.triggerEvent())}},t.prototype.beginEdit=function(i){var r=this.getElement(i);(0,a.le)(r)||this.disabled||this.createTextbox(r,null)},t.prototype.checkAll=function(i){this.showCheckBox&&this.doCheckBoxAction(i,!0)},t.prototype.collapseAll=function(i,r,n){(0,a.le)(i)?r>0?this.collapseByLevel((0,a.Ys)("."+qt,this.element),r,n):this.collapseAllNodes(n):this.doGivenAction(i,Ji,!1)},t.prototype.disableNodes=function(i){(0,a.le)(i)||this.doDisableAction(i)},t.prototype.enableNodes=function(i){(0,a.le)(i)||this.doEnableAction(i)},t.prototype.ensureVisible=function(i){var r=this.getElement(i);if(!(0,a.le)(r)){var n=this.parents(r,"."+kt);this.expandAll(n),setTimeout(function(){r.scrollIntoView(!0)},450)}},t.prototype.expandAll=function(i,r,n){(0,a.le)(i)?r>0?this.expandByLevel((0,a.Ys)("."+qt,this.element),r,n):this.expandAllNodes(n):this.doGivenAction(i,di,!0)},t.prototype.getAllCheckedNodes=function(){var i=this.checkedNodes;return i},t.prototype.getDisabledNodes=function(){var i=this.disableNode;return i},t.prototype.getNode=function(i){var r=this.getElement(i);return this.getNodeData(r,!0)},t.prototype.getTreeData=function(i){var r=this.getId(i);if(this.updatePersistProp(),(0,a.le)(r))return this.treeData;var n=this.getNodeObject(r);return(0,a.le)(n)?[]:[n]},t.prototype.moveNodes=function(i,r,n,s){var l=this.getElement(r);if(!(0,a.le)(l)){for(var h=0;h<i.length;h++){var c=this.getElement(i[h]);(0,a.le)(c)||l.isSameNode(c)||this.isDescendant(c,l)||(this.preventExpand=s,this.dropAsChildNode(c,l,this,n))}this.fields.dataSource instanceof Oe.h||(this.preventExpand=!1),this.triggerEvent()}},t.prototype.refreshNode=function(i,r){if(!((0,a.le)(i)||(0,a.le)(r))){var n,s=!1;if(this.dataType==1&&r.length>1)s=!0;else if(this.dataType==2&&r.length===1){var l=(0,a.NA)(this.fields.child.toString(),r[0]);(0,a.le)(l)||(s=!0)}var h=this.getElement(i);n=h?h.getAttribute("data-uid"):i?i.toString():null,this.refreshData=this.getNodeObject(n),r=JSON.parse(JSON.stringify(r));var c,u;if(this.dataType==1&&s){for(var p=0;p<r.length;p++)if((0,a.le)(r[p][this.fields.parentID])){u=r[p],r.splice(p,1);break}c=(0,a.l7)({},this.refreshData,u)}else c=(0,a.l7)({},this.refreshData,r[0]);if((0,a.le)(h)){this.updatePosition(n,c,s,r);return}this.isRefreshed=!0;var f=parseFloat(h.getAttribute("aria-level")),g=Mt.createListItemFromJson(this.createElement,[c],this.listBaseOption,f),C=(0,a.Ys)("."+qt,h),L=(0,a.NA)(this.fields.child.toString(),c);if(s&&C||s&&!(0,a.le)(L)){var D=h.parentElement,R=Array.prototype.indexOf.call(D.childNodes,h);(0,a.Od)(h),D.insertBefore(g[0],D.childNodes[R]),this.updatePosition(n,c,s,r),s&&C&&this.expandAll([n])}else{var B=(0,a.Ys)("."+Yi,h),H=(0,a.Ys)("."+Yi,g[0]),j=(0,a.Ys)("div."+Ui,B),W=(0,a.Ys)("div."+Ui,H);j&&W&&(W.classList.contains(di)&&j.classList.contains(Ji)?((0,a.IV)([W],di),(0,a.cn)([W],Ji)):W.classList.contains(Ji)&&j.classList.contains(di)?((0,a.IV)([W],Ji),(0,a.cn)([W],di)):j.classList.contains("interaction")&&(0,a.cn)([W],"interaction")),(0,a.Od)(B);var ne=(0,a.Ys)("."+Un,h);ne.parentNode.insertBefore(H,ne.nextSibling),this.updatePosition(n,c,s,r)}if(h=this.getElement(i),c[this.fields.tooltip]&&h.setAttribute("title",c[this.fields.tooltip]),c.hasOwnProperty(this.fields.htmlAttributes)&&c[this.fields.htmlAttributes]){var ie={};(0,a.TS)(ie,c[this.fields.htmlAttributes]),ie.class?((0,a.cn)([h],ie.class.split(" ")),delete ie.class):(0,a.Y4)(h,ie)}this.selectedNodes.indexOf(n)!==-1&&(h.setAttribute("aria-selected","true"),(0,a.cn)([h],Rr)),this.isRefreshed=!1,this.triggerEvent()}},t.prototype.removeNodes=function(i){(0,a.le)(i)||(this.fields.dataSource instanceof Oe.h&&!this.isOffline?this.crudOperation("delete",i):this.deleteSuccess(i))},t.prototype.updateNode=function(i,r){var n=this;if(!((0,a.le)(i)||(0,a.le)(r)||!this.allowEditing)){var s=this.getElement(i);if(!(0,a.le)(s)){var l=(0,a.Ys)("."+ia,s);this.updateOldText(s);var h=this.getEditEvent(s,null,null);this.trigger("nodeEditing",h,function(c){c.cancel||(n.fields.dataSource instanceof Oe.h&&!n.isOffline?n.crudOperation("update",null,i,r,null,null,!1):n.appendNewText(s,l,r,!1))})}}},t.prototype.uncheckAll=function(i){this.showCheckBox&&this.doCheckBoxAction(i,!1)};var e;return Ct([(0,a.Z9)(!1)],t.prototype,"allowDragAndDrop",void 0),Ct([(0,a.Z9)(!1)],t.prototype,"allowEditing",void 0),Ct([(0,a.Z9)(!1)],t.prototype,"allowMultiSelection",void 0),Ct([(0,a.Z9)(!1)],t.prototype,"allowTextWrap",void 0),Ct([(0,a.Zz)({},yb)],t.prototype,"animation",void 0),Ct([(0,a.Z9)()],t.prototype,"checkedNodes",void 0),Ct([(0,a.Z9)("")],t.prototype,"cssClass",void 0),Ct([(0,a.Z9)(!1)],t.prototype,"disabled",void 0),Ct([(0,a.Z9)(null)],t.prototype,"dragArea",void 0),Ct([(0,a.Z9)(!1)],t.prototype,"enableHtmlSanitizer",void 0),Ct([(0,a.Z9)(!1)],t.prototype,"enablePersistence",void 0),Ct([(0,a.Z9)()],t.prototype,"expandedNodes",void 0),Ct([(0,a.Z9)("Auto")],t.prototype,"expandOn",void 0),Ct([(0,a.Zz)({},gb)],t.prototype,"fields",void 0),Ct([(0,a.Z9)(!0)],t.prototype,"fullRowSelect",void 0),Ct([(0,a.Z9)(!0)],t.prototype,"loadOnDemand",void 0),Ct([(0,a.Z9)()],t.prototype,"locale",void 0),Ct([(0,a.Z9)()],t.prototype,"nodeTemplate",void 0),Ct([(0,a.Z9)()],t.prototype,"selectedNodes",void 0),Ct([(0,a.Z9)("None")],t.prototype,"sortOrder",void 0),Ct([(0,a.Z9)(!1)],t.prototype,"showCheckBox",void 0),Ct([(0,a.Z9)(!0)],t.prototype,"autoCheck",void 0),Ct([(0,a.Z9)(!1)],t.prototype,"fullRowNavigable",void 0),Ct([(0,a.ju)()],t.prototype,"actionFailure",void 0),Ct([(0,a.ju)()],t.prototype,"created",void 0),Ct([(0,a.ju)()],t.prototype,"dataBound",void 0),Ct([(0,a.ju)()],t.prototype,"dataSourceChanged",void 0),Ct([(0,a.ju)()],t.prototype,"drawNode",void 0),Ct([(0,a.ju)()],t.prototype,"destroyed",void 0),Ct([(0,a.ju)()],t.prototype,"keyPress",void 0),Ct([(0,a.ju)()],t.prototype,"nodeChecked",void 0),Ct([(0,a.ju)()],t.prototype,"nodeChecking",void 0),Ct([(0,a.ju)()],t.prototype,"nodeClicked",void 0),Ct([(0,a.ju)()],t.prototype,"nodeCollapsed",void 0),Ct([(0,a.ju)()],t.prototype,"nodeCollapsing",void 0),Ct([(0,a.ju)()],t.prototype,"nodeDragging",void 0),Ct([(0,a.ju)()],t.prototype,"nodeDragStart",void 0),Ct([(0,a.ju)()],t.prototype,"nodeDragStop",void 0),Ct([(0,a.ju)()],t.prototype,"nodeDropped",void 0),Ct([(0,a.ju)()],t.prototype,"nodeEdited",void 0),Ct([(0,a.ju)()],t.prototype,"nodeEditing",void 0),Ct([(0,a.ju)()],t.prototype,"nodeExpanded",void 0),Ct([(0,a.ju)()],t.prototype,"nodeExpanding",void 0),Ct([(0,a.ju)()],t.prototype,"nodeSelected",void 0),Ct([(0,a.ju)()],t.prototype,"nodeSelecting",void 0),t=e=Ct([a.Zl],t),t}(a.wA),Pu=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(E.tW,this.initiateHyperlinkHandler,this),this.parent.on(E.qP,this.editHyperlinkHandler,this),this.parent.on(E.IO,this.openHyperlinkHandler,this),this.parent.on(E.V4,this.hyperlinkClickHandler,this),this.parent.on(E.Lu,this.createHyperlinkElementHandler,this),this.parent.on(E.yR,this.keyUpHandler,this),this.parent.on(ot.M3,this.removeHyperlink,this),this.parent.on(E.Th,this.removeHyperlinkHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.tW,this.initiateHyperlinkHandler),this.parent.off(E.qP,this.editHyperlinkHandler),this.parent.off(E.IO,this.openHyperlinkHandler),this.parent.off(E.V4,this.hyperlinkClickHandler),this.parent.off(E.Lu,this.createHyperlinkElementHandler),this.parent.off(E.yR,this.keyUpHandler),this.parent.off(ot.M3,this.removeHyperlink),this.parent.off(E.Th,this.removeHyperlinkHandler))},o.prototype.getModuleName=function(){return"spreadsheetHyperlink"},o.prototype.keyUpHandler=function(t){var e=t.target;if((0,a.oq)(e,".e-document")){var i=document.querySelector(".e-hyp-text"),r=this.parent.element.querySelector(".e-hyperlink-alert-span"),n=(0,a.oq)(e,".e-hyperlink-dlg")||(0,a.oq)(e,".e-edithyperlink-dlg"),s=n.getElementsByClassName("e-footer-content")[0],l=s.firstChild;i&&i.value&&((0,w.qhV)(i.value.toUpperCase())?r&&(r.remove(),l.removeAttribute("disabled")):(this.showDialog(),l.setAttribute("disabled","true")))}if(e.classList.contains("e-text")&&(0,a.oq)(e,".e-cont")&&(0,a.oq)(e,".e-webpage")&&(0,a.oq)(e,".e-webpage").getElementsByClassName("e-cont")[1]===e.parentElement){var h=(0,a.oq)(e,".e-hyperlink-dlg")||(0,a.oq)(e,".e-edithyperlink-dlg"),c=h.getElementsByClassName("e-footer-content")[0],l=c.firstChild;if(e.value!=="")l.removeAttribute("disabled");else{var u=(0,a.oq)(e,".e-link-dialog"),p=u.querySelector(".e-webpage"),f=!!p.querySelectorAll(".e-cont")[1].querySelector(".e-text").value;f||l.setAttribute("disabled","true")}}},o.prototype.initiateHyperlinkHandler=function(){var t=this,e=this.parent.serviceLocator.getService(Ve),i=this.parent.getActiveSheet();if(i.isProtected&&!i.protectSettings.insertLink){this.parent.notify(E.Gn,null);return}if(!this.parent.element.querySelector(".e-hyperlink-dlg")){var r=this.parent.serviceLocator.getService(Yt);r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-hyperlink-dlg",header:e.getConstant("InsertLink"),beforeOpen:function(n){var s={dialogName:"InsertLinkDialog",element:n.element,target:n.target,cancel:n.cancel};t.parent.trigger("dialogBeforeOpen",s),s.cancel&&(n.cancel=!0),r.dialogInstance.content=t.hyperlinkContent(),r.dialogInstance.dataBind(),we(t.parent.element)},open:function(){setTimeout(function(){we(r.dialogInstance.element.querySelectorAll(".e-webpage input")[1])})},buttons:[{buttonModel:{content:e.getConstant("Insert"),isPrimary:!0,disabled:!0},click:function(){t.dlgClickHandler(),r.hide()}}]})}},o.prototype.dlgClickHandler=function(){var t,e,i=this.parent.getActiveSheet(),r=i.name+"!"+i.activeCell,n=this.parent.element.querySelector(".e-link-dialog").getElementsByClassName("e-content")[0].querySelector(".e-item.e-active");if(n)if(n.querySelector(".e-webpage")){t=n.getElementsByClassName("e-cont")[0].querySelector(".e-text").value,e=n.getElementsByClassName("e-cont")[1].querySelector(".e-text").value;var s={address:e};this.parent.insertHyperlink(s,r,t,!1)}else{t=n.getElementsByClassName("e-cont")[0].querySelector(".e-text").value,e=n.getElementsByClassName("e-cont")[1].querySelector(".e-text").value;var l=n.getElementsByClassName("e-cont")[2];if(l.getElementsByClassName("e-list-item")[0].querySelector(".e-active")){var h=n.getElementsByClassName("e-cont")[2].querySelector(".e-active").textContent;e=h+"!"+e.toUpperCase();var s={address:e};this.parent.insertHyperlink(s,r,t,!1)}else if(l.querySelector(".e-active")){for(var c=n.getElementsByClassName("e-cont")[2].querySelector(".e-active").textContent,u=0;u<this.parent.definedNames.length;u++)if(this.parent.definedNames[u].name===c){var s={address:this.parent.definedNames[u].name};this.parent.insertHyperlink(s,r,t,!1)}}}},o.prototype.showDialog=function(){this.parent.element.querySelector(".e-hyperlink-alert-span")&&this.parent.element.querySelector(".e-hyperlink-alert-span").remove();var t=this.parent.serviceLocator.getService(Ve),e=this.parent.createElement("span",{className:"e-hyperlink-alert-span",innerHTML:t.getConstant("HyperlinkAlert")}),i=this.parent.element.querySelector(".e-hyperlink-dlg")||this.parent.element.querySelector(".e-edithyperlink-dlg");i.querySelector(".e-dlg-content").appendChild(e)},o.prototype.editHyperlinkHandler=function(){var t=this,e=this.parent.serviceLocator.getService(Ve),i=this.parent.serviceLocator.getService(Yt);i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-edithyperlink-dlg",header:e.getConstant("EditLink"),beforeOpen:function(r){var n={dialogName:"EditLinkDialog",element:r.element,target:r.target,cancel:r.cancel};t.parent.trigger("dialogBeforeOpen",n),n.cancel&&(r.cancel=!0),i.dialogInstance.content=t.hyperEditContent(),i.dialogInstance.dataBind(),we(t.parent.element)},open:function(){setTimeout(function(){i.dialogInstance.element.querySelector(".e-webpage")?we(i.dialogInstance.element.querySelectorAll(".e-webpage input")[1]):we(i.dialogInstance.element.querySelectorAll(".e-document input")[1])})},buttons:[{buttonModel:{content:e.getConstant("Update"),isPrimary:!0},click:function(){t.dlgClickHandler(),i.hide()}}]})},o.prototype.openHyperlinkHandler=function(){var t=(0,Ke.n5)(this.parent.getActiveSheet().activeCell),e=this.parent.getCell(t[0],t[1]);e.getElementsByClassName("e-hyperlink")[0]&&(e=e.querySelector(".e-hyperlink")),this.hlOpenHandler(e)},o.prototype.hlOpenHandler=function(t){var e=this;if(t.classList.contains("e-hyperlink")){var i=["",""],r=void 0,n=!0;t.style.color="#551A8B",(0,a.oq)(t,".e-cell")&&((0,a.oq)(t,".e-cell").style.color="#551A8B");var s=this.parent.getActiveSheet(),l=parseInt(t.parentElement.getAttribute("aria-colindex"),10)-1,h=parseInt(t.parentElement.parentElement.getAttribute("aria-rowindex"),10)-1,c=s.rows[h].cells[l].hyperlink,u=void 0,p={hyperlink:c,address:s.activeCell,target:"_blank",cancel:!1};if(this.parent.trigger(ot.TU,p),p.cancel)return;c=p.hyperlink;var f={hyperlink:c,address:s.activeCell};typeof c=="string"&&(u=c),typeof c=="object"&&(u=c.address);var g=u;if(u.indexOf("http://")===-1&&u.indexOf("https://")===-1&&u.indexOf("ftp://")===-1){if(!(0,a.le)(u)){if(this.parent.definedNames){for(var C=0;C<this.parent.definedNames.length;C++)if(this.parent.definedNames[C].name===u){u=this.parent.definedNames[C].refersTo,u=u.slice(1);break}}u.indexOf("!")!==-1?(i=u.split("!"),i[0].indexOf(" ")!==-1&&(i[0]=i[0].slice(1,i[0].length-1))):(i[0]=this.parent.getActiveSheet().name,i[1]=u);for(var L,C=0;C<this.parent.sheets.length;C++)this.parent.sheets[C].name===i[0]&&(L=C);if(s=this.parent.sheets[L],i[1].indexOf(":")!==-1){var D=i[1].indexOf(":"),R=i[1].substr(0,D),B=i[1].substr(D+1,i[1].length);R=R.replace("$",""),B=B.replace("$",""),B.match(/\D/g)&&!B.match(/[0-9]/g)&&R.match(/\D/g)&&!R.match(/[0-9]/g)?(R=R+"1",B=B+s.rowCount,i[1]=R+":"+B):!B.match(/\D/g)&&B.match(/[0-9]/g)&&!R.match(/\D/g)&&R.match(/[0-9]/g)&&(r=[parseInt(R,10)-1,0,parseInt(B,10)-1,s.colCount-1],n=!1)}var H=void 0,j=this.parent.definedNames;if(!(0,a.le)(j)){for(var C=0;C<j.length;C++)if(j[C].name===g){H=!0;break}}if((0,w.qhV)(i[1])||H){if(r=n?(0,Ke.dK)(i[1]):r,this.parent.scrollSettings.enableVirtualization&&(r[0]=r[0]>=this.parent.viewport.topIndex?r[0]-this.parent.viewport.topIndex:r[0],r[1]=r[1]>=this.parent.viewport.leftIndex?r[1]-this.parent.viewport.leftIndex:r[1]),!(0,a.le)(s)){var W=(0,Ke.i0)(r);if(s===this.parent.getActiveSheet())$(function(){e.parent.goTo(W)});else{if(W.indexOf(":")>=0){var ne=W.split(":");W=ne[0]===ne[1]?ne[0]:W}$(function(){e.parent.goTo(e.parent.sheets[L].name+"!"+W)})}}}else this.showInvalidHyperlinkDialog()}}else this.isValidUrl(u)?window.open(u,p.target):this.showInvalidHyperlinkDialog();this.parent.trigger(ot.gy,f)}},o.prototype.isValidUrl=function(t){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(t)},o.prototype.showInvalidHyperlinkDialog=function(){var t=this.parent.serviceLocator.getService(Yt),e=this.parent.serviceLocator.getService(Ve);t.show({width:323,isModal:!0,showCloseIcon:!0,header:e.getConstant("Hyperlink"),content:e.getConstant("InvalidHyperlinkAlert"),buttons:[{buttonModel:{content:e.getConstant("Ok"),isPrimary:!0},click:function(){t.hide()}}]},!1)},o.prototype.hyperlinkClickHandler=function(t){var e=t.target;if((0,a.oq)(e,".e-link-dialog")&&(0,a.oq)(e,".e-toolbar-item")){var i=(0,a.oq)(e,".e-hyperlink-dlg")||(0,a.oq)(e,".e-edithyperlink-dlg"),r=i.getElementsByClassName("e-footer-content")[0],n=r.firstChild,s=i.querySelector(".e-document"),l=i.querySelector(".e-webpage"),h=l?l.querySelectorAll(".e-cont")[0].querySelector(".e-text").value:s.querySelectorAll(".e-cont")[0].querySelector(".e-text").value,c=s?s.querySelectorAll(".e-cont")[0].querySelector(".e-text").value:h,u=(0,a.oq)(e,".e-toolbar-items");if(u.getElementsByClassName("e-toolbar-item")[1].classList.contains("e-active")){var p=s.querySelectorAll(".e-cont")[2].querySelector(".e-active");s.querySelectorAll(".e-cont")[0].querySelector(".e-text").value=h,(0,a.oq)(p,".e-list-item").classList.contains("e-level-2")&&n.hasAttribute("disabled")?n.removeAttribute("disabled"):(0,a.oq)(p,".e-list-item").classList.contains("e-level-1")&&!n.hasAttribute("disabled")&&n.setAttribute("disabled","true")}else{var f=!l.querySelectorAll(".e-cont")[1].querySelector(".e-text").value;l.querySelectorAll(".e-cont")[0].querySelector(".e-text").value=c,f&&!n.hasAttribute("disabled")?n.setAttribute("disabled","true"):!f&&n.hasAttribute("disabled")&&n.removeAttribute("disabled")}}if((0,a.oq)(e,".e-list-item")&&e.classList.contains("e-fullrow")){var g=this.parent.element.getElementsByClassName("e-link-dialog")[0];if(g)g=g.getElementsByClassName("e-content")[0].getElementsByClassName("e-active")[0];else return;var C=g.getElementsByClassName("e-cont")[1].getElementsByClassName("e-text")[0],i=(0,a.oq)(e,".e-hyperlink-dlg")||(0,a.oq)(e,".e-edithyperlink-dlg"),r=i.getElementsByClassName("e-footer-content")[0],n=r.firstChild;(0,a.oq)(e,".e-list-item").classList.contains("e-level-2")?((0,a.oq)(e,".e-list-item").getAttribute("data-uid")==="defName"?!C.classList.contains("e-disabled")&&!C.hasAttribute("readonly")&&(C.setAttribute("readonly","true"),C.classList.add("e-disabled"),C.setAttribute("disabled","true")):(0,a.oq)(e,".e-list-item").getAttribute("data-uid")==="sheet"&&C.classList.contains("e-disabled")&&C.hasAttribute("readonly")&&(C.removeAttribute("readonly"),C.classList.remove("e-disabled"),C.removeAttribute("disabled")),n.hasAttribute("disabled")&&n.removeAttribute("disabled")):(0,a.oq)(e,".e-list-item").classList.contains("e-level-1")&&n.setAttribute("disabled","true")}else this.hlOpenHandler(e)},o.prototype.createHyperlinkElementHandler=function(t){var e=t.cell,i=t.td,r=this.parent.createElement("a",{className:"e-hyperlink e-hyperlink-style"});if(r.style.color="#00e",(0,a.le)(e.hyperlink))i.querySelector("a")&&e.hyperlink&&typeof e.hyperlink=="string"&&i.querySelector("a").setAttribute("href",e.hyperlink);else{var n=e.hyperlink;typeof n=="string"?(n.indexOf("http://")===-1&&n.indexOf("https://")===-1&&n.indexOf("ftp://")===-1&&n.indexOf("www.")!==-1&&(n="http://"+n),n.indexOf("http://")===0||n.indexOf("https://")===0||n.indexOf("ftp://")===0?(r.setAttribute("href",n),r.setAttribute("target","_blank")):(n.includes("=")||n.includes("!"))&&r.setAttribute("ref",n),r.innerText=i.innerText!==""?i.innerText:n,i.textContent="",i.innerText="",i.appendChild(r)):typeof n=="object"&&(n.address.indexOf("http://")===0||n.address.indexOf("https://")===0||n.address.indexOf("ftp://")===0?(r.setAttribute("href",n.address),r.setAttribute("target","_blank")):(n.address.includes("=")||n.address.includes("!"))&&r.setAttribute("ref",n.address),(0,w.K2R)(e.format)==="Accounting"?r.innerHTML=i.innerHTML:r.innerText=i.innerText!==""?i.innerText:n.address,i.textContent="",i.innerText="",i.appendChild(r))}},o.prototype.hyperEditContent=function(){var t=!0,e=this.hyperlinkContent(),i=(0,Ke.dK)(this.parent.getActiveSheet().activeCell),r=this.parent.sheets[this.parent.getActiveSheet().id-1].rows[i[0]].cells[i[1]];this.parent.scrollSettings.enableVirtualization&&(i[0]=i[0]-this.parent.viewport.topIndex,i[1]=i[1]-this.parent.viewport.leftIndex);var n=this.parent.getDisplayText(r),s,l=r.hyperlink;typeof l=="string"?(s=l,n=n||s,s.indexOf("http://")===-1&&s.indexOf("https://")===-1&&s.indexOf("ftp://")===-1&&(t=!1)):typeof l=="object"&&(s=l.address,n=n||s,s.indexOf("http://")===-1&&s.indexOf("https://")===-1&&s.indexOf("ftp://")===-1&&(t=!1));for(var h=0,c=0,u=this.parent.definedNames,p=this.parent.sheets,f=0,g=u.length;f<g;f++)u[f].name===s&&h++;for(var f=0,g=p.length;f<g;f++)s.includes(p[f].name)&&c++;h===0&&c===0&&(t=!0);var C=e.querySelector(".e-content");if(t){var L=C.querySelector(".e-webpage");if(L.getElementsByClassName("e-cont")[0].getElementsByClassName("e-text")[0].setAttribute("value",n),typeof l=="string")L.getElementsByClassName("e-cont")[1].querySelector(".e-text").setAttribute("value",l);else{var D=L.getElementsByClassName("e-cont")[1].querySelector(".e-text");D.setAttribute("value",l.address)}}else{var R=void 0,B=C.querySelector(".e-document");B.getElementsByClassName("e-cont")[0].getElementsByClassName("e-text")[0].setAttribute("value",n);var H=void 0;if(this.parent.definedNames){for(var f=0;f<this.parent.definedNames.length;f++)if(this.parent.definedNames[f].name===s){R=!0;break}}if(R){var j=B.getElementsByClassName("e-cont")[1].getElementsByClassName("e-text")[0];j.setAttribute("readonly","true"),j.classList.add("e-disabled"),j.setAttribute("disabled","true");for(var W=B.getElementsByClassName("e-cont")[2],ne=W.querySelectorAll(".e-list-item.e-level-1")[1],f=0;f<ne.getElementsByTagName("li").length;f++)ne.getElementsByTagName("li")[f].innerText===s&&ne.getElementsByTagName("li")[f].classList.add("e-active")}else{s&&s.indexOf("!")!==-1&&(H=s.split("!"));var ie=H[0];B.getElementsByClassName("e-cont")[1].querySelector(".e-text").setAttribute("value",H[1]);for(var W=B.getElementsByClassName("e-cont")[2],ne=W.querySelectorAll(".e-list-item.e-level-1")[0],f=0;f<ne.getElementsByTagName("li").length;f++)if(ne.getElementsByTagName("li")[f].innerText===ie){if(ne.getElementsByTagName("li")[f].classList.contains("e-active"))break;ne.getElementsByTagName("li")[f].classList.add("e-active")}else ne.getElementsByTagName("li")[f].classList.contains("e-active")&&ne.getElementsByTagName("li")[f].classList.remove("e-active")}}return e},o.prototype.hyperlinkContent=function(){var t=this.parent.serviceLocator.getService(Ve),e=0,i=0,r=!0,n,s=!0,l,h=(0,Ke.dK)(this.parent.getActiveSheet().activeCell),c=this.parent.getActiveSheet(),u=(0,w.$Su)(h[0],h[1],c),p=!0;if(u){u.value&&typeof u.value=="string"&&u.value.match("[A-Za-z]+")!==null||u.value===""||(0,a.le)(u.value)?p=!0:p=!1;var f=u.hyperlink;if(typeof f=="string"){var g=f;g.indexOf("http://")===-1&&g.indexOf("https://")===-1&&g.indexOf("ftp://")===-1&&(l=f,r=!1)}else if(typeof f=="object"){var g=f.address;g.indexOf("http://")===-1&&g.indexOf("https://")===-1&&g.indexOf("ftp://")===-1&&(l=f.address,r=!1)}if(l){for(var C=0,L=0,D=this.parent.definedNames,R=this.parent.sheets,B=0,H=R.length;B<H;B++)l.includes(R[B].name)&&L++;for(var j=0,H=D.length;j<H;j++)D[j].name===l&&C++;C===0&&L===0&&(r=!0)}if(r?i=0:i=1,this.parent.definedNames){for(var W=0;W<this.parent.definedNames.length;W++)if(this.parent.definedNames[W].name===l){n=!0,s=!1;break}}}var ne=this.parent.createElement("div",{className:"e-link-dialog"}),ie=this.parent.createElement("div",{className:"e-webpage"}),me=this.parent.createElement("div",{className:"e-document"}),ve=new xu({selectedItem:i,items:[{header:{text:t.getConstant("WebPage")},content:ie},{header:{text:t.getConstant("ThisDocument")},content:me}]});ve.appendTo(ne),r?ne.querySelector(".e-toolbar-items").querySelector(".e-indicator").setAttribute("style","left: 0; right: 136px"):ne.querySelector(".e-toolbar-items").querySelector(".e-indicator").setAttribute("style","left: 136px; right: 0");var Ee=this.parent.createElement("div",{className:"e-cont"}),le=this.parent.createElement("div",{className:"e-cont"}),de=this.parent.createElement("div",{className:"e-header",innerHTML:t.getConstant("DisplayText")}),fe=this.parent.createElement("div",{className:"e-header",innerHTML:t.getConstant("Url")}),Le=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"Text"}});p||(Le.classList.add("e-disabled"),Le.setAttribute("readonly","true"),Le.setAttribute("disabled","true")),u&&(0,a.le)(u.hyperlink)&&Le.setAttribute("value",this.parent.getDisplayText(u));var ke=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"Text"}});Le.setAttribute("placeholder",t.getConstant("EnterTheTextToDisplay")),ke.setAttribute("placeholder",t.getConstant("EnterTheUrl")),Ee.appendChild(Le),Ee.insertBefore(de,Le),le.appendChild(ke),le.insertBefore(fe,ke),ie.appendChild(le),ie.insertBefore(Ee,le);var Me=[],De=[],Fe=this.parent.sheets;for(e;e<this.parent.sheets.length;e++){var Pe=this.parent.sheets[e].name;this.parent.sheets[e].state==="Visible"&&(Fe[e]===this.parent.getActiveSheet()?Me.push({nodeId:"sheet",nodeText:Pe.indexOf(" ")!==-1?"'"+Pe+"'":Pe,selected:!0}):Me.push({nodeId:"sheet",nodeText:Pe.indexOf(" ")!==-1?"'"+Pe+"'":Pe}))}for(e=0;e<this.parent.definedNames.length;e++)De.push({nodeId:"defName",nodeText:this.parent.definedNames[e].name});var Ye=[{nodeId:"01",nodeText:t.getConstant("CellReference"),expanded:s,nodeChild:Me},{nodeId:"02",nodeText:t.getConstant("DefinedNames"),expanded:n,nodeChild:De}],Ze=new av({fields:{dataSource:Ye,id:"nodeId",text:"nodeText",child:"nodeChild"}}),nt=this.parent.createElement("div",{className:"e-cont"}),it=this.parent.createElement("div",{className:"e-header",innerHTML:t.getConstant("CellReference")}),et=this.parent.createElement("input",{className:"e-input e-text e-hyp-text",attrs:{type:"Text"}});et.setAttribute("value","A1"),nt.appendChild(et),nt.insertBefore(it,et);var at=this.parent.createElement("div",{className:"e-cont"}),Ge=this.parent.createElement("div",{className:"e-header",innerHTML:t.getConstant("DisplayText")}),gt=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"Text"}});p||(gt.classList.add("e-disabled"),gt.setAttribute("readonly","true"),gt.setAttribute("disabled","true")),u&&(0,a.le)(u.hyperlink)&&gt.setAttribute("value",this.parent.getDisplayText(u)),gt.setAttribute("placeholder",t.getConstant("EnterTheTextToDisplay")),at.appendChild(gt),at.insertBefore(Ge,gt);var ge=this.parent.createElement("div",{className:"e-cont"}),xe=this.parent.createElement("div",{className:"e-header",innerHTML:t.getConstant("Sheet")}),je=this.parent.createElement("div",{className:"e-refcont"});return ge.appendChild(je),ge.insertBefore(xe,je),me.appendChild(nt),me.insertBefore(at,nt),Ze.appendTo(je),me.appendChild(ge),ne},o.prototype.removeHyperlink=function(t){var e=(0,w.$Su)(t.rowIdx,t.colIdx,t.sheet);e&&e.hyperlink&&(typeof e.hyperlink=="string"?e.value=e.value?e.value:e.hyperlink:e.value=e.value?e.value:e.hyperlink.address,delete e.hyperlink,e.style&&(delete e.style.textDecoration,delete e.style.color),e.validation&&e.validation.isHighlighted&&e.style.backgroundColor&&(e.style.color="#ff0000"),t.sheet===this.parent.getActiveSheet()&&(e.style&&this.parent.notify(ot.bU,null),t.preventRefresh||this.parent.serviceLocator.getService("cell").refreshRange([t.rowIdx,t.colIdx,t.rowIdx,t.colIdx])))},o.prototype.removeHyperlinkHandler=function(t){var e=t.range,i,r=this.parent.getActiveSheet(),n;if(!t.preventEventTrigger){var s={address:e.indexOf("!")===-1?r.name+"!"+e:e,cancel:!1};if(this.parent.notify(ot.y,{action:"removeHyperlink",eventArgs:s}),s.cancel)return}if(e&&e.indexOf("!")!==-1){i=e.split("!");for(var l=this.parent.sheets,h=0;h<l.length;h++)l[h].name===i[0]&&(n=h);r=this.parent.sheets[n],e=i[1]}for(var c=e?(0,Ke.dK)(e):(0,Ke.dK)(r.activeCell),u=c[0];u<=c[2];u++)for(var p=c[1];p<=c[3];p++)if(r&&r.rows[u]&&r.rows[u].cells[p]){for(var f=this.parent.getCell(u,p),g=[],C=0;C<f.classList.length;C++)g.push(f.classList[C]);this.parent.notify(ot.M3,{sheet:r,rowIdx:u,colIdx:p});for(var C=0;C<g.length;C++)this.parent.getCell(u,p).classList.contains(g[C])||this.parent.getCell(u,p).classList.add(g[C])}t.preventEventTrigger||this.parent.notify(E.Av,{action:"removeHyperlink",eventArgs:{address:e.indexOf("!")===-1?r.name+"!"+e:e}})},o}(),Nu=function(){return Nu=Object.assign||function(o){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(o[r]=t[r])}return o},Nu.apply(this,arguments)},Bu=function(){function o(t){this.undoCollection=[],this.redoCollection=[],this.isUndo=!1,this.undoRedoStep=100,this.parent=t,this.addEventListener()}return o.prototype.setActionData=function(t){var e=this.parent.getActiveSheet(),i,r=[],n=[],s=t.args,l=s.eventArgs,h={};switch(s.action){case"format":i=(0,w.dK5)(s.eventArgs.range);break;case"clipboard":h=l.copiedInfo,i=(0,w.dK5)((0,w.VBe)(l.pastedRange)),h&&h.isCut&&(n=this.getCellDetails(h.range,(0,w.zfV)(this.parent,(0,w.PmP)(this.parent,h.sId)),"clipboard"));break;case"beforeSort":i=(0,w.dK5)(s.eventArgs.range),i[0]===i[2]&&i[2]-i[0]==0&&(i[0]=0,i[1]=0,i[2]=e.usedRange.rowIndex,i[3]=e.usedRange.colIndex);break;case"beforeCellSave":case"cellDelete":case"cellSave":i=(0,w.dK5)(l.address);break;case"beforeWrap":case"beforeReplace":case"chartDesign":i=this.parent.getAddressInfo(l.address).indices;break;case"beforeClear":i=(0,w.dK5)(l.range);break;case"beforeInsertImage":i=(0,w.dK5)(l.range);break;case"deleteImage":i=(0,w.dK5)(l.address);break;case"beforeInsertChart":i=(0,w.dK5)(l.range);break;case"filter":i=(0,w.dK5)(l.range);break;case"autofill":i=(0,w.dK5)(l.fillRange);break;case"removeValidation":i=(0,w.dK5)(l.range);break;case"hyperlink":case"removeHyperlink":i=(0,w.dK5)(l.address);break}r=this.getCellDetails(i,e,s.action),this.beforeActionData={cellDetails:r,cutCellDetails:n}},o.prototype.getBeforeActionData=function(t){t.beforeDetails=this.beforeActionData},o.prototype.performUndoRedo=function(t){var e;t.isFromUpdateAction?e=t:e=t.isUndo?this.undoCollection.pop():this.redoCollection.pop(),this.isUndo=t.isUndo;var i;if(e){var r=void 0,n={};if(!t.isPublic){var s=e.eventArgs.beforeActionData;if(delete e.eventArgs.beforeActionData,r={action:e.action,eventArgs:{}},(0,a.l7)(r.eventArgs,e.eventArgs,null,!0),e.eventArgs.beforeActionData=s,r.eventArgs.cancel=!1,e.preventAction=r.preventAction=!0,t.isUndo?r.isUndo=!0:r.isRedo=!0,t.isFromUpdateAction||this.parent.notify(w.ya2,r),r.eventArgs.cancel){this.updateUndoRedoIcons();return}delete r.eventArgs.cancel}switch(e.action){case"cellSave":case"format":case"sorting":case"wrap":case"cellDelete":case"autofill":case"removeValidation":case"hyperlink":case"removeHyperlink":e=this.performOperation(e,t.preventEvt,t.preventReSelect,t.isPublic);break;case"clipboard":e=this.undoForClipboard(e,t.isUndo,r),i=!0;break;case"resize":case"resizeToFit":e=this.undoForResize(e);break;case"hideShow":We(e,this.parent,!t.isUndo);break;case"replace":e=this.performOperation(e);break;case"replaceAll":e.eventArgs.isAction=!1,t.isUndo&&(n.value=e.eventArgs.replaceValue,n.replaceValue=e.eventArgs.value),this.parent.notify(w.kon,Nu({},e.eventArgs,n));break;case"insert":case"filter":We(e,this.parent,!t.isUndo,null,r),i=e.action==="filter";break;case"delete":We(e,this.parent,!t.isUndo);break;case"validation":case"addHighlight":case"removeHighlight":We(e,this.parent,!t.isUndo);break;case"merge":e.eventArgs.merge=e.isFromUpdateAction?e.eventArgs.merge:!e.eventArgs.merge,We(e,this.parent,!1);break;case"clear":e=this.performOperation(e);break;case"conditionalFormat":We(e,this.parent,!t.isUndo,this.undoCollection);break;case"clearCF":We(e,this.parent,!t.isUndo);break;case"insertImage":case"deleteImage":We(e,this.parent,!t.isUndo);break;case"imageRefresh":We(e,this.parent,!t.isUndo);break;case"insertChart":case"deleteChart":We(e,this.parent,!t.isUndo);break;case"chartRefresh":We(e,this.parent,!t.isUndo);break;case"chartDesign":e.eventArgs.isUndo=t.isUndo,this.parent.notify(E.o,e.eventArgs);break;case"addDefinedName":We(e,this.parent,!t.isUndo);break}t.isFromUpdateAction||(t.isUndo?this.redoCollection.push(e):this.undoCollection.push(e),this.undoCollection.length>this.undoRedoStep&&this.undoCollection.splice(0,1),this.redoCollection.length>this.undoRedoStep&&this.redoCollection.splice(0,1),this.updateUndoRedoIcons(),!t.isPublic&&!i&&this.parent.notify(E.Av,(0,a.l7)({isUndoRedo:!0,isUndo:t.isUndo},e))),this.parent.notify(w.bUq,null)}},o.prototype.updateUndoRedoCollection=function(t){var e=["clipboard","format","sorting","cellSave","resize","resizeToFit","wrap","hideShow","replace","validation","merge","clear","conditionalFormat","clearCF","insertImage","imageRefresh","insertChart","deleteChart","chartRefresh","filter","cellDelete","autofill","addDefinedName","removeValidation","removeHighlight","addHighlight","hyperlink","removeHyperlink","deleteImage","chartDesign","replaceAll"];(t.args.action==="insert"||t.args.action==="delete")&&t.args.eventArgs.modelType!=="Sheet"&&e.push(t.args.action);var i=t.args.action;if(!(e.indexOf(i)===-1&&!t.isPublic)){var r=t.args.eventArgs;if(i==="clipboard"||i==="sorting"||i==="format"||i==="cellSave"||i==="wrap"||i==="replace"||i==="validation"||i==="clear"||i==="conditionalFormat"||i==="clearCF"||i==="insertImage"||i==="imageRefresh"||i==="insertChart"||i==="chartRefresh"||i==="filter"||i==="cellDelete"||i==="autofill"||i==="removeValidation"||i==="addDefinedName"||i==="hyperlink"||i==="removeHyperlink"||i==="deleteImage"||i==="chartDesign"){var n={beforeDetails:{cellDetails:[]}};this.parent.notify(E.Ay,n),r.beforeActionData=n.beforeDetails}if(i==="clipboard"&&r.copiedInfo&&r.copiedInfo.isExternal){var s=this.parent.getAddressInfo(r.pastedRange);r.copiedInfo.cellDetails=this.getCellDetails(s.indices,(0,w.zfV)(this.parent,s.sheetIndex),i)}this.undoCollection.push(t.args),this.redoCollection=[],this.undoCollection.length>this.undoRedoStep&&this.undoCollection.splice(0,1),this.updateUndoRedoIcons()}},o.prototype.clearUndoRedoCollection=function(){this.undoCollection=[],this.redoCollection=[],this.updateUndoRedoIcons()},o.prototype.updateUndoRedoIcons=function(){var t=this.parent.serviceLocator.getService(Ve);this.parent.notify(E.y3,[{tab:t.getConstant("Home"),items:[this.parent.element.id+"_undo"],enable:this.undoCollection.length>0}]),this.parent.notify(E.y3,[{tab:t.getConstant("Home"),items:[this.parent.element.id+"_redo"],enable:this.redoCollection.length>0}])},o.prototype.undoForClipboard=function(t,e,i){var r=this,n=t.eventArgs,s=n.pastedRange.split("!"),l=(0,w.dK5)(s[1]),h=(0,w.Q8D)(this.parent,s[0]),c=(0,w.zfV)(this.parent,h),u=n.copiedInfo,p=n.beforeActionData,f=t.isFromUpdateAction,g=this.checkRefreshNeeded(h,f),C;if(i&&(i.isUndoRedo=!0,i.eventArgs.beforeActionData=p),t.eventArgs.requestType==="imagePaste"){var L=n.copiedShapeInfo;e?(C=L.pictureElem,L.isCut?(this.parent.notify(E.ao,{id:C.id,sheetIdx:n.pasteSheetIndex+1}),this.parent.notify(E.oE,{options:{src:C.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:L.height,width:L.width,imageId:C.id},range:L.copiedRange,isPublic:!1,isUndoRedo:!0})):this.parent.notify(E.ao,{id:n.pastedPictureElement.id,sheetIdx:n.pasteSheetIndex+1})):L.isCut?(C=L.pictureElem,this.parent.notify(E.ao,{id:C.id,sheetIdx:L.sId}),this.parent.notify(E.oE,{options:{src:C.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:L.height,width:L.width,imageId:C.id},range:L.pastedRange,isPublic:!1,isUndoRedo:!0})):(C=n.pastedPictureElement,this.parent.notify(E.oE,{options:{src:C.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2"),height:C.offsetHeight,width:C.offsetWidth,imageId:C.id},range:L.pastedRange,isPublic:!1,isUndoRedo:!0}))}else{if(e){if(u.isCut){var D=p.cutCellDetails;this.updateCellDetails(D,(0,w.zfV)(this.parent,(0,w.PmP)(this.parent,u.sId)),(0,w.gaE)(u.range),g,t)}p&&this.updateCellDetails(p.cellDetails,c,l,g,t),Ne(c,l[0],l[1],(0,w.NEZ)(c,l[0]));var R=Te(c,l[0]);tt(this.parent,c,R,l[0]),n.mergeCollection.forEach(function(j){j.merge=!j.merge,r.parent.notify(w.mtj,j),j.merge=!j.merge}),i&&!f&&this.parent.notify(E.Av,i)}else if(u.isExternal){var B=this.parent.getAddressInfo(n.pastedRange);this.updateCellDetails(u.cellDetails,(0,w.zfV)(this.parent,B.sheetIndex),B.indices,!0,t),i&&!f&&this.parent.notify(E.Av,i)}else{var H=new Promise(function(W){W(function(){}())}),B=this.parent.getAddressInfo(n.copiedRange);this.parent.notify(n.copiedInfo.isCut?E.z7:E.JG,{range:B.indices,sId:(0,w.zfV)(this.parent,B.sheetIndex).id,promise:H,invokeCopy:!0,isPublic:!0,isFromUpdateAction:f}),H.then(function(){r.parent.notify(E.v,{range:s&&(0,w.IRR)(n.pastedRange),sIdx:s&&(0,w.Q8D)(r.parent,(0,w.HAf)(n.pastedRange)),type:n.type,isAction:!1,isInternal:!0,isFromUpdateAction:f}),i&&!f&&r.parent.notify(E.Av,i)})}g&&!f&&(this.parent.notify(E.Y0,{address:s[1]}),this.parent.notify(E.uv,{}))}return t},o.prototype.undoForResize=function(t){var e=t.eventArgs;if(e.hide===void 0)if(e.isCol){var i=e.oldWidth;e.oldWidth=e.width,e.width=i}else{var i=e.oldHeight;e.oldHeight=e.height,e.height=i}else e.hide=!e.hide;We(t,this.parent,!1);var r=this.parent.getActiveSheet(),n=(0,w.dK5)(r.activeCell),s=(0,w.$Su)(n[0],n[1],r);if(s&&s.rowSpan){var l=this.parent.getCell(n[0],n[1]);this.parent.element.querySelector(".e-active-cell").style.height=l.offsetHeight+"px"}else if(s&&s.colSpan){var l=this.parent.getCell(n[0],n[1]);this.parent.element.querySelector(".e-active-cell").style.width=l.offsetWidth+"px"}return t},o.prototype.performOperation=function(t,e,i,r){var n=this,s=t.eventArgs,l=[];t.action==="autofill"?l=s.fillRange.split("!"):l=t.action==="cellSave"||t.action==="wrap"||t.action==="replace"||t.action==="cellDelete"||t.action==="hyperlink"||t.action==="removeHyperlink"?s.address.split("!"):s.range.split("!");var h=(0,w.gaE)((0,w.dK5)(l[1])),c=h,u=(0,w.Q8D)(this.parent,l[0]),p=(0,w.zfV)(this.parent,u),f=s.beforeActionData,g=t.isFromUpdateAction,C=this.checkRefreshNeeded(u,g),L={cellIdx:[h[0],h[1]],isUnique:!1,uniqueRange:""};this.parent.notify(w.Azt,L);var D=function(Pe,Ye){if(u===n.parent.activeSheetIndex){var Ze=n.parent.getCell(h[0]-1,n.parent.sortCollection[Pe].columnIndex);Ze&&(Ze=(0,a.Ys)(".e-filter-icon",Ze),Ze&&(Ye?Ze.classList.add("e-sort"+(n.parent.sortCollection[Pe].order==="Ascending"?"asc":"desc")+"-filter"):Ze.classList.remove("e-sort"+(n.parent.sortCollection[Pe].order==="Ascending"?"asc":"desc")+"-filter")))}};if(this.isUndo){if(L.isUnique&&s.formula&&s.formula.indexOf("UNIQUE")>-1){var R=(0,w.dK5)(L.uniqueRange);if((0,w.$Su)(R[0],R[1],this.parent.getActiveSheet()).value!=="#SPILL!")for(var B=R[0];B<=R[2];B++)for(var H=R[1];H<=R[3];H++)B===R[0]&&H===R[1]&&(H=H+1),this.parent.updateCell({value:""},(0,w.i0K)([B,H]))}if(this.updateCellDetails(f.cellDetails,p,h,C,t,e),L.isUnique&&t.action==="cellDelete"&&s.isSpill){for(var R=(0,w.dK5)(L.uniqueRange),j=(0,w.$Su)(R[0],R[1],this.parent.getActiveSheet()),W=R[0];W<=R[2];W++)for(var B=R[1];B<=R[3];B++)for(var H=h[0];H<=h[2];H++)for(var ne=h[1];ne<=h[3];ne++)(W!==H||B!==ne)&&this.parent.updateCell({value:""},(0,w.qkm)(W,B));j.value="#SPILL!",this.parent.updateCell(j,(0,w.qkm)(R[0],R[1]))}if(!s.isSpill&&L.uniqueRange!==""){for(var ie=(0,w.dK5)(L.uniqueRange),B=ie[0];B<=ie[2];B++)for(var H=ie[1];H<=ie[3];H++)B===ie[0]&&H===ie[1]&&(H=H+1),this.parent.updateCell({value:""},(0,w.i0K)([B,H]));this.parent.notify(w.C4_,null)}if(t.action==="sorting"&&this.parent.sortCollection&&s.previousSort){for(var W=0;W<this.parent.sortCollection.length;W++)if(this.parent.sortCollection[W].sheetIndex===u){D(W,!1),this.parent.sortCollection.splice(W,1),s.previousSort.order?(this.parent.sortCollection.splice(W,0,s.previousSort),D(W,!0)):this.parent.sortCollection.length||(this.parent.sortCollection=void 0);break}}}else{var me=t.eventArgs,ve=(0,w.dK5)(p.activeCell),Ee=this.parent.getCellStyleValue(["textDecoration"],ve).textDecoration;if(me&&me.style&&me.style.textDecoration){var le=me.style.textDecoration,de=le,fe=void 0,Le=!1;Ee==="underline"?de=le==="underline"?"none":"underline line-through":Ee==="line-through"?de=le==="line-through"?"none":"underline line-through":Ee==="underline line-through"&&(de=le==="underline"?"line-through":"underline",Le=!0),de==="none"&&(Le=!0),me.style.textDecoration=de,t.eventArgs=me,this.parent.notify(w.vbl,{style:{textDecoration:de},range:ve,refreshRibbon:!0,onActionUpdate:!0});for(var W=c[0];W<=c[2];W++)for(var B=c[1];B<=c[3];B++)if(!(W===ve[0]&&B===ve[1])){if(fe={},Ee=this.parent.getCellStyleValue(["textDecoration"],[W,B]).textDecoration,Ee==="none"){if(Le)continue;fe.textDecoration=le}else if(Ee==="underline"||Ee==="line-through")if(Le)if(le===Ee)fe.textDecoration="none";else continue;else fe.textDecoration=le!==Ee?"underline line-through":le;else if(Ee==="underline line-through")if(Le)fe.textDecoration=le==="underline"?"line-through":"underline";else continue;this.parent.notify(w.vbl,{style:{textDecoration:fe.textDecoration},range:[W,B,W,B],refreshRibbon:!0,onActionUpdate:!0})}me.style.textDecoration=le,t.eventArgs=me}else{if(!(0,a.le)(s.oldValue)&&s.oldValue!==s.value&&L.isUnique){var ke=(0,w.dK5)(L.uniqueRange);if((0,w.$Su)(ke[0],ke[1],this.parent.getActiveSheet()).value!=="#SPILL!")for(var B=ke[0];B<=ke[2];B++)for(var H=ke[1];H<=ke[3];H++)B===ke[0]&&H===ke[1]&&(this.parent.updateCell({value:"#SPILL!"},(0,w.i0K)([ke[0],ke[1]])),H=H+1),this.parent.updateCell({value:""},(0,w.i0K)([B,H]))}if(We(t,this.parent,!0),L.isUnique&&t.action==="cellDelete"&&s.isSpill){for(var Me=(0,w.dK5)(L.uniqueRange),De=!1,W=Me[0];W<=Me[1];W++)for(var B=Me[1];B<=Me[3];B++)W===Me[0]&&B===Me[1]&&B++,(0,w.$Su)(W,B,p)&&!(0,a.le)((0,w.$Su)(W,B,p).value)&&(0,w.$Su)(W,B,p).value!==""&&(De=!0);if(!De){var j=(0,w.$Su)(Me[0],Me[1],this.parent.getActiveSheet());j.value="",this.parent.updateCell(j,(0,w.qkm)(Me[0],Me[1])),this.parent.notify(w.C4_,null)}}}if(t.action==="sorting"&&s.previousSort){var Fe=void 0;if(this.parent.sortCollection){for(var W=0;W<this.parent.sortCollection.length;W++)if(this.parent.sortCollection[W].sheetIndex===u){D(W,!1),Fe=W,this.parent.sortCollection.splice(W,1);break}}else this.parent.sortCollection=[],Fe=0;this.parent.sortCollection.splice(Fe,0,{sortRange:l[1],sheetIndex:u,columnIndex:(0,w.ugT)(s.sortOptions.sortDescriptors.field),order:s.sortOptions.sortDescriptors.order}),D(Fe,!0)}}return t.action==="autofill"&&(l[1]=this.isUndo?t.eventArgs.dataRange:t.eventArgs.selectedRange),C&&!i&&!g&&this.parent.notify(E.Y0,{address:l[1]}),this.parent.notify(E.I4,{}),t},o.prototype.getCellDetails=function(t,e,i){var r=[],n,s=i==="cellDelete";t=(0,w.gaE)(t);for(var l=t[0];l<=t[2];l++)if(!(s&&(0,w.wDH)(e,l)))for(var h=t[1];h<=t[3];h++)n=(0,w.$Su)(l,h,e),r.push({rowIndex:l,colIndex:h,format:n?n.format:null,isLocked:n?n.isLocked:null,style:n&&n.style?Object.assign({},n.style):null,value:n?n.value:"",formula:n?n.formula:"",wrap:n&&n.wrap,rowSpan:n&&n.rowSpan,colSpan:n&&n.colSpan,hyperlink:n&&((0,a.Kn)(n.hyperlink)?(0,a.l7)({},n.hyperlink):n.hyperlink),image:n&&n.image,chart:n&&n.chart&&JSON.parse(JSON.stringify(n.chart)),validation:n&&n.validation});return r},o.prototype.updateCellDetails=function(t,e,i,r,n,s){for(var l=this,h=t.length,c=n&&!s&&(n.action==="cellSave"||n.action==="cellDelete"||n.action==="autofill"||n.action==="clipboard"),u,p,f,g=0;g<h;g++){if(p=(0,w.$Su)(t[g].rowIndex,t[g].colIndex,e,!1,!0),p.style&&n&&(n.action==="format"||n.action==="clipboard")&&(p.style.borderTop&&(!t[g].style||!t[g].style.borderTop)&&this.parent.setBorder({borderTop:""},e.name+"!"+(0,w.qkm)(t[g].rowIndex,t[g].colIndex)),p.style.borderLeft&&(!t[g].style||!t[g].style.borderLeft)&&this.parent.setBorder({borderLeft:""},e.name+"!"+(0,w.qkm)(t[g].rowIndex,t[g].colIndex)),p.style.fontSize&&(!t[g].style||!t[g].style.fontSize)&&(p.style.fontSize="11pt",f=!0,this.parent.notify(w.nJk,{style:{fontSize:"11pt"},rowIdx:t[g].rowIndex,colIdx:t[g].colIndex,lastCell:!0,isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:!0})),p.style.fontFamily&&(!t[g].style||!t[g].style.fontFamily)&&(f=!0,p.style.fontFamily="Calibri",this.parent.notify(w.nJk,{style:{fontFamily:"Calibri"},rowIdx:t[g].rowIndex,colIdx:t[g].colIndex,lastCell:!0,isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:!0}))),(0,w.Jxt)(t[g].rowIndex,t[g].colIndex,e,{value:t[g].value,format:t[g].format,isLocked:t[g].isLocked,style:t[g].style&&Object.assign({},t[g].style),formula:t[g].formula,wrap:t[g].wrap,rowSpan:t[g].rowSpan,colSpan:t[g].colSpan,hyperlink:t[g].hyperlink}),this.parent.notify(w.BbZ,{action:"updateCellValue",address:[t[g].rowIndex,t[g].colIndex,t[g].rowIndex,t[g].colIndex],value:t[g].formula?t[g].formula:t[g].value,sheetIndex:(0,w.Q8D)(this.parent,e.name)}),(n&&n.action==="wrap"&&n.eventArgs.wrap||p.wrap&&!t[g].wrap)&&this.parent.notify(w.agw,{range:[t[g].rowIndex,t[g].colIndex,t[g].rowIndex,t[g].colIndex],wrap:!1,sheet:e}),n&&n.action==="removeValidation"&&t[g].validation){var C={type:t[g].validation.type,operator:t[g].validation.operator,value1:t[g].validation.value1,value2:t[g].validation.value2,ignoreBlank:t[g].validation.ignoreBlank,inCellDropDown:t[g].validation.inCellDropDown};this.parent.notify(w.dKh,{rules:C,range:n.eventArgs.range})}n&&t[g].hyperlink&&n.action==="clear"&&(n.eventArgs.range=e.name+"!"+(0,w.i0K)([t[g].rowIndex,t[g].colIndex,t[g].rowIndex,t[g].colIndex]),u=this.parent.getCell(t[g].rowIndex,t[g].colIndex),n.eventArgs.type==="Clear All"||n.eventArgs.type==="Clear Hyperlinks"?this.parent.addHyperlink(t[g].hyperlink,n.eventArgs.range):n.eventArgs.type==="Clear Formats"&&(0,a.cn)(u.querySelectorAll(".e-hyperlink"),"e-hyperlink-style")),c&&t[g].value!==p.value&&this.parent.trigger("cellSave",{element:null,value:t[g].value,oldValue:p.value,formula:t[g].formula,cancel:!1,address:e.name+"!"+(0,w.qkm)(t[g].rowIndex,t[g].colIndex),displayText:this.parent.getDisplayText(t[g])})}r&&(this.parent.serviceLocator.getService("cell").refreshRange(i,!1,!1,!0),f&&$(function(){return l.parent.selectRange(e.selectedRange)}))},o.prototype.checkRefreshNeeded=function(t,e){var i=!0;return t!==this.parent.activeSheetIndex&&(e||(this.parent.activeSheetIndex=t,this.parent.dataBind()),i=!1),i},o.prototype.addEventListener=function(){this.parent.on(E.Y5,this.performUndoRedo,this),this.parent.on(E.dW,this.updateUndoRedoCollection,this),this.parent.on(E.e9,this.setActionData,this),this.parent.on(E.Ay,this.getBeforeActionData,this),this.parent.on(E.V9,this.clearUndoRedoCollection,this),this.parent.on(E.Ev,this.updateUndoRedoIcons,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.Y5,this.performUndoRedo),this.parent.off(E.dW,this.updateUndoRedoCollection),this.parent.off(E.e9,this.setActionData),this.parent.off(E.Ay,this.getBeforeActionData),this.parent.off(E.V9,this.clearUndoRedoCollection),this.parent.off(E.Ev,this.updateUndoRedoIcons))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"undoredo"},o}(),Fu=function(){function o(t){this.parent=t,this.wrapCell=this.parent.createElement("span",{className:"e-wrap-content"}),this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(E.hU,this.ribbonClickHandler,this),this.parent.on(w.agw,this.wrapTextHandler,this),this.parent.on(E.QK,this.rowHeightChangedHandler,this),this.parent.on(E.N2,this.colWidthChanged,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.hU,this.ribbonClickHandler),this.parent.off(w.agw,this.wrapTextHandler),this.parent.off(E.QK,this.rowHeightChangedHandler),this.parent.off(E.N2,this.colWidthChanged))},o.prototype.wrapTextHandler=function(t){if(t.initial||O(this.parent,t.range,!0)){for(var e=void 0,i=void 0,r=void 0,n=void 0,s=void 0,l=void 0,h=void 0,c=void 0,u=t.range[0];u<=t.range[2];u++){n=0,h=(0,w.dMx)(t.sheet,u).customHeight,l=h||t.isCustomHgt;for(var p=t.range[1];p<=t.range[3];p++)if(i=(0,w.$Su)(u,p,t.sheet,null,!0),!(i.rowSpan<0||i.colSpan<0)){var f=i.rowSpan>1||i.colSpan>1;if(e=t.initial?t.td:this.parent.getCell(u,p),e?(t.wrap?(c=st(i.style&&i.style.fontFamily?i.style:this.parent.cellStyle),e.classList.add(j0)):(e.classList.remove(j0),c=null),(l||f)&&this.updateWrapCell(u,p,t.sheet,e)):c=null,a.AR.isIE&&e.classList.add("e-ie-wrap"),!(l||f)){r=ce(t.sheet,u,p,i.colSpan>1?p+i.colSpan-1:p);var g=this.parent.getDisplayText(i).toString();if(g.indexOf(`
`)<0){var C=this.parent.element.querySelector(".e-spreadsheet-edit");C&&C.textContent.indexOf(`
`)>-1&&(g=C.textContent)}if(g)if(t.wrap){e&&e.classList.contains("e-alt-unwrap")&&e.classList.remove("e-alt-unwrap");var L=void 0,D=0,R=void 0;if(g.indexOf(`
`)>-1){var B=g.split(`
`),H=B.length;for(R=0;R<H;R++)L=rt(B[R],r,i.style,this.parent.cellStyle),L===0&&(L=1),D=D+L;L=D}else L=rt(g,r,i.style,this.parent.cellStyle);if(s=ee(this.parent,u,p,t.sheet,i.style||this.parent.cellStyle,L,c),n=Math.max(n,s),i.rowSpan>1){var j=(0,w.EB_)(t.sheet,u,u+(i.rowSpan-1));if(j>=n)return;s=n=(0,w.NEZ)(t.sheet,u)+(n-j)}Ne(t.sheet,u,p,s)}else g.indexOf(`
`)>-1&&e.classList.add("e-alt-unwrap"),s=ee(this.parent,u,p,t.sheet,i.style||this.parent.cellStyle,1,c),Ne(t.sheet,u,p,s),n=Math.max(Te(t.sheet,u),20);else(!t.wrap||!g)&&(Ne(t.sheet,u,p,20),n=Math.max(Te(t.sheet,u),20));p===t.range[3]&&(t.wrap&&n>20&&Te(t.sheet,u)<=n||(!t.wrap||!g)&&Te(t.sheet,u)<(0,w.NEZ)(t.sheet,u)&&(0,w.NEZ)(t.sheet,u)>20)&&tt(this.parent,t.sheet,n,u,t.row,t.hRow)}if(l&&!f){var g=this.parent.getDisplayText(i);t.wrap?e&&e.classList.contains("e-alt-unwrap")&&e.classList.remove("e-alt-unwrap"):g.indexOf(`
`)>-1&&e.classList.add("e-alt-unwrap")}t.wrap&&e?h?e.style.lineHeight&&(e.style.lineHeight=""):e.style.lineHeight=parseFloat(i.style&&i.style.fontSize||this.parent.cellStyle.fontSize)*c+"pt":e&&(e.style.lineHeight="")}}t.initial||this.parent.notify(E.uv,null)}},o.prototype.ribbonClickHandler=function(t){var e=(0,a.oq)(t.originalEvent.target,".e-btn");if(e&&e.id===this.parent.element.id+"_wrap"){var i=e.classList.contains("e-active"),r=(0,w.CP8)(this.parent.getActiveSheet()),n={address:r,wrap:i,cancel:!1};this.parent.notify(w.ya2,{action:"beforeWrap",eventArgs:n}),n.cancel||((0,w.reQ)(this.parent.getActiveSheet().selectedRange,i,this.parent),this.parent.notify(E.Av,{action:"wrap",eventArgs:{address:r,wrap:i}}))}},o.prototype.rowHeightChangedHandler=function(t){if(t.isCustomHgt)for(var e=this.parent.getActiveSheet(),i=void 0,r=this.parent.viewport.leftIndex,n=this.parent.viewport.rightIndex;r<=n;r++)(0,w.$Su)(t.rowIdx,r,e,!1,!0).wrap&&(i=this.parent.getCell(t.rowIdx,r),this.updateWrapCell(t.rowIdx,r,e,i),i.style.lineHeight&&(i.style.lineHeight=""))},o.prototype.colWidthChanged=function(t){if(t.checkWrapCell)for(var e=this.parent.getActiveSheet(),i=this.parent.viewport.topIndex,r=this.parent.viewport.bottomIndex;i<=r;i++)(0,w.$Su)(i,t.colIdx,e,!1,!0).wrap&&this.updateWrapCell(i,t.colIdx,e,this.parent.getCell(i,t.colIdx))},o.prototype.updateWrapCell=function(t,e,i,r){if(r&&!r.querySelector(".e-wrap-content")){for(var n=this.wrapCell.cloneNode(),s=r.querySelector(".e-filter-btn");r.childElementCount;)n.appendChild(r.firstElementChild);if(s&&(r.firstChild?r.insertBefore(s,r.firstChild):r.appendChild(s)),!(0,w.$Su)(t,e,i,!1,!0).hyperlink){var l=r.lastChild;l&&l.nodeType===3?(n.appendChild(document.createTextNode(l.textContent)),l.textContent=""):(n.appendChild(document.createTextNode(r.textContent)),r.textContent="")}r.appendChild(n)}},o.prototype.getModuleName=function(){return"wrapText"},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o}(),Hu=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.insert=function(t){var e=t.eventArgs;this.parent.notify(w.x2y,e);var i=(0,w.zfV)(this.parent,e.activeSheetIndex);switch(e.modelType){case"Sheet":this.parent.notify(E.CX,{startIdx:e.index,endIdx:e.index+(e.model.length-1),preventUpdate:!e.isAction}),this.parent.renderModule.refreshSheet(!1,!1,!0,!0);break;case"Row":if(e.activeSheetIndex===this.parent.activeSheetIndex){var r=this.parent.frozenRowCount(i);if(!this.parent.scrollSettings.enableVirtualization||e.index<=this.parent.viewport.bottomIndex)if(e.freezePane)this.parent.renderModule.refreshSheet(!1,!1,!0,!0);else if(this.parent.scrollSettings.enableVirtualization){var n=this.parent.frozenColCount(i);if(e.index>=this.parent.viewport.topIndex+r){var s=[],l=void 0;n?(l=(0,w.n53)(i.topLeftCell)[1],s.push(r),s.push(this.parent.viewport.leftIndex+n)):l=this.parent.viewport.leftIndex;var h=this.parent.viewport.leftIndex;this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,colIndex:l,refresh:"Row",frozenIndexes:s,skipUpdateOnFirst:this.parent.viewport.topIndex+r===(0,w.Sxm)(i,r,!0)}),n&&(this.parent.viewport.leftIndex=h)}var c=(0,w.n53)(i.paneTopLeftCell)[0];e.index<c&&(this.parent.notify(E.qN,{scrollTop:(0,w.EB_)(i,r,c-1,!0)}),this.parent.goTo((0,w.qkm)(e.index,(0,w.Sxm)(i,n,!0,"columns")))),this.parent.selectRange(i.selectedRange)}else this.parent.renderModule.refreshUI({skipUpdateOnFirst:!0,rowIndex:this.parent.viewport.topIndex,colIndex:0,refresh:"Row"}),this.parent.selectRange(i.selectedRange);else this.parent.scrollSettings.isFinite&&(this.parent.viewport.topIndex+r===(0,w.Sxm)(i,0,!0)||this.parent.viewport.bottomIndex===(0,w.Sxm)(i,i.rowCount-e.model.length-1,!1))&&this.parent.renderModule.refreshSheet(!1,!1,!0,!0)}break;case"Column":if(e.activeSheetIndex===this.parent.activeSheetIndex){var n=this.parent.frozenColCount(i);if(!this.parent.scrollSettings.enableVirtualization||e.index<=this.parent.viewport.rightIndex)if(e.freezePane)this.parent.renderModule.refreshSheet(!1,!1,!0,!0);else if(this.parent.scrollSettings.enableVirtualization){var r=this.parent.frozenRowCount(i);if(e.index>=this.parent.viewport.leftIndex+n){var s=[];r&&(s=[r+this.parent.viewport.topIndex,n]);var u=r?(0,w.n53)(i.topLeftCell)[0]:this.parent.viewport.topIndex,p=this.parent.viewport.topIndex;this.parent.renderModule.refreshUI({skipUpdateOnFirst:this.parent.viewport.leftIndex+n===(0,w.Sxm)(i,n,!0,"columns"),rowIndex:u,colIndex:this.parent.viewport.leftIndex,refresh:"Column",frozenIndexes:s}),r&&(this.parent.viewport.topIndex=p)}var f=(0,w.n53)(i.paneTopLeftCell)[1];e.index<f&&(this.parent.notify(E.qN,{scrollLeft:(0,w.pGm)(i,0,f-1,!0)}),this.parent.goTo((0,w.qkm)((0,w.Sxm)(i,r,!0),e.index))),this.parent.selectRange(i.selectedRange)}else this.parent.renderModule.refreshUI({skipUpdateOnFirst:!0,rowIndex:0,colIndex:this.parent.viewport.leftIndex,refresh:"Column"}),this.parent.selectRange(i.selectedRange);else this.parent.scrollSettings.isFinite&&(this.parent.viewport.leftIndex+n===(0,w.Sxm)(i,0,!0,"columns")||this.parent.viewport.rightIndex===(0,w.Sxm)(i,i.colCount-e.model.length-1,!1,"columns"))&&this.parent.renderModule.refreshSheet(!1,!1,!0,!0)}break}this.refreshImgElement(e.model.length,this.parent.activeSheetIndex,e.modelType,e.index),e.isAction?(delete e.isAction,this.parent.notify(E.Av,t)):e.isUndoRedo||(e.isMethod=!0,this.parent.notify(w.sQc,t))},o.prototype.refreshImgElement=function(t,e,i,r){for(var n=this.parent.sheets[e],s,l=[0,0,n.usedRange.rowIndex,n.usedRange.colIndex],h=0;h<=l[2];h++)for(var c=l[1];c<=l[3];c++)s=(0,w.$Su)(h,c,n),s&&s.image&&s.image.length>0&&(i==="Row"&&h>=r||i==="Column"&&c>=r)&&this.parent.notify(E.z0,{rowIdx:h,colIdx:c,sheetIdx:e,type:i,count:t,status:"insert"})},o.prototype.addEventListener=function(){this.parent.on(w.$Tr,this.insert,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(w.$Tr,this.insert)},o.prototype.getModuleName=function(){return"insert"},o}(),Vu=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.delete=function(t){var e=t.eventArgs;if(e.modelType==="Sheet"){var i=e.activeSheetIndex>=e.startIndex&&e.activeSheetIndex<=e.endIndex;i&&this.parent.setProperties({activeSheetIndex:this.parent.skipHiddenSheets(e.startIndex<this.parent.sheets.length?e.startIndex:e.startIndex?e.startIndex-1:0)},!0),this.parent.notify(E.$c,null),i&&this.parent.renderModule.refreshSheet(!1,!1,!0,!0)}else if(e.activeSheetIndex===this.parent.activeSheetIndex){var r=this.parent.getActiveSheet();if(e.modelType==="Row"){if(!this.parent.scrollSettings.enableVirtualization||e.startIndex<=this.parent.viewport.bottomIndex)if(this.parent.scrollSettings.enableVirtualization){var n=this.parent.frozenRowCount(r);if(e.startIndex<(0,w.n53)(r.paneTopLeftCell)[0])this.parent.updateTopLeftCell((0,pe.Sxm)(r,e.startIndex-1<n?n:e.startIndex-1,!0)-n,null,"col"),this.parent.renderModule.refreshSheet(!1,!1,!0,!0);else if(e.freezePane)this.parent.renderModule.refreshSheet(!1,!1,!0,!0);else{var s=[],l=this.parent.frozenColCount(r),h=void 0,c=this.parent.viewport.leftIndex;l?(s.push(n),s.push(c+l),h=(0,w.n53)(r.topLeftCell)[1]):h=c,this.parent.renderModule.refreshUI({rowIndex:this.parent.viewport.topIndex,refresh:"Row",colIndex:h,skipUpdateOnFirst:this.parent.viewport.topIndex+n===(0,pe.Sxm)(r,n,!0),frozenIndexes:s}),l&&(this.parent.viewport.leftIndex=c),this.parent.selectRange(r.selectedRange)}}else this.parent.renderModule.refreshUI({skipUpdateOnFirst:!0,refresh:"Row",rowIndex:this.parent.viewport.topIndex,colIndex:0}),this.parent.selectRange(r.selectedRange)}else{if(e.refreshSheet!==!1&&(!this.parent.scrollSettings.enableVirtualization||e.startIndex<=this.parent.viewport.rightIndex)){var l=this.parent.frozenColCount(r);if(this.parent.scrollSettings.enableVirtualization)if(e.startIndex<(0,w.n53)(r.paneTopLeftCell)[1])this.parent.updateTopLeftCell(null,(0,pe.Sxm)(r,e.startIndex-1<l?l:e.startIndex-1,!0,"columns")-l,"row"),this.parent.renderModule.refreshSheet(!1,!1,!0,!0);else if(e.freezePane||e.refreshSheet===!0)this.parent.renderModule.refreshSheet(!1,!1,!0,!0);else{var n=this.parent.frozenRowCount(r),s=[],u=this.parent.viewport.topIndex,p=n?(0,w.n53)(r.topLeftCell)[0]:u;n&&(s=[n+u,l]),this.parent.renderModule.refreshUI({rowIndex:p,refresh:"Column",colIndex:this.parent.viewport.leftIndex,insertDelete:!0,skipUpdateOnFirst:this.parent.viewport.leftIndex+l===(0,pe.Sxm)(r,l,!0,"columns"),frozenIndexes:s}),n&&(this.parent.viewport.topIndex=u),this.parent.selectRange(r.selectedRange)}else this.parent.renderModule.refreshUI({skipUpdateOnFirst:!0,refresh:"Column",rowIndex:0,colIndex:this.parent.viewport.leftIndex,insertDelete:!0}),this.parent.selectRange(r.selectedRange)}delete e.refreshSheet}}this.refreshImgElement(e.deletedModel.length,this.parent.activeSheetIndex,e.modelType,e.startIndex),e.isAction?(delete e.isAction,this.parent.notify(E.Av,t)):e.isUndoRedo||(e.isMethod=!0,this.parent.notify(pe.sQc,t))},o.prototype.addEventListener=function(){this.parent.on(pe.mnp,this.delete,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(pe.mnp,this.delete)},o.prototype.getModuleName=function(){return"delete"},o.prototype.refreshImgElement=function(t,e,i,r){for(var n=this.parent.sheets[e],s,l=[0,0,n.usedRange.rowIndex,n.usedRange.colIndex],h=0;h<=l[2];h++)for(var c=l[1];c<=l[3];c++)s=(0,w.$Su)(h,c,n),s&&s.image&&s.image.length>0&&(i==="Row"&&h>=r||i==="Column"&&c>=r)&&this.parent.notify(E.z0,{rowIdx:h,colIdx:c,sheetIdx:e,type:i,count:t,status:"delete"})},o}(),bb=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),wi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Cb="e-control-wrapper e-numeric",zu="e-input-group-icon",_u="e-spin-up",Sb="e-spin-down",ju="e-error",_a="increment",Uo="decrement",wb=new RegExp("^(-)?(\\d*)$"),xb=".",Eb="e-numerictextbox",Ab="e-control",ov="e-input-focus",Tb="e-numeric-hidden",lv=["title","style","class"],Zn=function(o){bb(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.isVue=!1,r.preventChange=!1,r.isAngular=!1,r.isDynamicChange=!1,r.numericOptions=e,r}return t.prototype.preRender=function(){this.isPrevFocused=!1,this.decimalSeparator=".",this.intRegExp=new RegExp("/^(-)?(d*)$/"),this.isCalled=!1;var e=(0,a.NA)("ej2_instances",this.element);if(this.cloneElement=this.element.cloneNode(!0),(0,a.IV)([this.cloneElement],[Ab,Eb,"e-lib"]),this.angularTagName=null,this.formEle=(0,a.oq)(this.element,"form"),this.element.tagName==="EJS-NUMERICTEXTBOX"){this.angularTagName=this.element.tagName;var i=this.createElement("input"),r=0;for(r;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;n!=="id"&&n!=="class"?(i.setAttribute(this.element.attributes[r].nodeName,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML):n==="class"&&i.setAttribute(n,this.element.className.split(" ").filter(function(l){return l.indexOf("ng-")!==0}).join(" "))}this.element.hasAttribute("name")&&this.element.removeAttribute("name"),this.element.classList.remove("e-control","e-numerictextbox"),this.element.appendChild(i),this.element=i,(0,a.sO)("ej2_instances",e,this.element)}(0,a.Y4)(this.element,{role:"spinbutton",tabindex:"0",autocomplete:"off","aria-live":"assertive"});var s={incrementTitle:"Increment value",decrementTitle:"Decrement value",placeholder:this.placeholder};this.l10n=new a.E7("numerictextbox",s,this.locale),this.l10n.getConstant("placeholder")!==""&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",(0,a.QI)("numerictextbox")),this.isValidState=!0,this.inputStyle=null,this.inputName=null,this.cultureInfo={},this.initCultureInfo(),this.initCultureFunc(),this.prevValue=this.value,this.updateHTMLAttrToElement(),this.checkAttributes(!1),this.formEle&&(this.inputEleValue=this.value),this.validateMinMax(),this.validateStep(),this.placeholder===null&&this.updatePlaceholder()},t.prototype.render=function(){this.element.tagName.toLowerCase()==="input"&&(this.createWrapper(),this.showSpinButton&&this.spinBtnCreation(),this.setElementWidth(this.width),this.container.classList.contains("e-input-group")||this.container.classList.add("e-input-group"),this.changeValue(this.value===null||isNaN(this.value)?null:this.strictMode?this.trimValue(this.value):this.value),this.wireEvents(),this.value!==null&&!isNaN(this.value)&&this.decimals&&this.setProperties({value:this.roundNumber(this.value,this.decimals)},!0),(this.element.getAttribute("value")||this.value)&&(this.element.setAttribute("value",this.element.value),this.hiddenInput.setAttribute("value",this.hiddenInput.value)),this.elementPrevValue=this.element.value,this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false"),this.renderComplete())},t.prototype.checkAttributes=function(e){for(var i=e?(0,a.le)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","step","disabled","readonly","style","name","placeholder"],r=0,n=i;r<n.length;r++){var s=n[r];if(!(0,a.le)(this.element.getAttribute(s)))switch(s){case"disabled":if((0,a.le)(this.numericOptions)||this.numericOptions.enabled===void 0||e){var l=!(this.element.getAttribute(s)==="disabled"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true");this.setProperties({enabled:l},!e)}break;case"readonly":if((0,a.le)(this.numericOptions)||this.numericOptions.readonly===void 0||e){var h=this.element.getAttribute(s)==="readonly"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true";this.setProperties({readonly:h},!e)}break;case"placeholder":((0,a.le)(this.numericOptions)||this.numericOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.element.placeholder},!e);break;case"value":if((0,a.le)(this.numericOptions)||this.numericOptions.value===void 0||e){var c=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));this.setProperties((0,a.sO)(s,c,{}),!e)}break;case"min":if((0,a.le)(this.numericOptions)||this.numericOptions.min===void 0||e){var u=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));u!==null&&!isNaN(u)&&this.setProperties((0,a.sO)(s,u,{}),!e)}break;case"max":if((0,a.le)(this.numericOptions)||this.numericOptions.max===void 0||e){var p=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));p!==null&&!isNaN(p)&&this.setProperties((0,a.sO)(s,p,{}),!e)}break;case"step":if((0,a.le)(this.numericOptions)||this.numericOptions.step===void 0||e){var f=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));f!==null&&!isNaN(f)&&this.setProperties((0,a.sO)(s,f,{}),!e)}break;case"style":this.inputStyle=this.element.getAttribute(s);break;case"name":this.inputName=this.element.getAttribute(s);break;default:{var g=this.instance.getNumberParser({format:"n"})(this.element.getAttribute(s));(g!==null&&!isNaN(g)||s==="value")&&this.setProperties((0,a.sO)(s,g,{}),!0)}break}}},t.prototype.updatePlaceholder=function(){this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0)},t.prototype.initCultureFunc=function(){this.instance=new a.eC(this.locale)},t.prototype.initCultureInfo=function(){this.cultureInfo.format=this.format,(0,a.NA)("currency",this)!==null&&((0,a.sO)("currency",this.currency,this.cultureInfo),this.setProperties({currencyCode:this.currency},!0))},t.prototype.createWrapper=function(){var e=this.cssClass;!(0,a.le)(this.cssClass)&&this.cssClass!==""&&(e=this.getNumericValidClassList(this.cssClass));var i=Ue.createInput({element:this.element,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:e,enableRtl:this.enableRtl,showClearButton:this.showClearButton,enabled:this.enabled}},this.createElement);this.inputWrapper=i,this.container=i.container,this.container.setAttribute("class",Cb+" "+this.container.getAttribute("class")),this.updateHTMLAttrToWrapper(),this.readonly&&(0,a.Y4)(this.element,{"aria-readonly":"true"}),this.hiddenInput=this.createElement("input",{attrs:{type:"text",validateHidden:"true",class:Tb}}),this.inputName=this.inputName!==null?this.inputName:this.element.id,this.element.removeAttribute("name"),(0,a.Y4)(this.hiddenInput,{name:this.inputName}),this.container.insertBefore(this.hiddenInput,this.container.childNodes[1]),this.updateDataAttribute(!1),this.inputStyle!==null&&(0,a.Y4)(this.container,{style:this.inputStyle})},t.prototype.updateDataAttribute=function(e){var i={};if(e)i=this.htmlAttributes;else for(var r=0;r<this.element.attributes.length;r++)i[this.element.attributes[r].name]=this.element.getAttribute(this.element.attributes[r].name);for(var n=0,s=Object.keys(i);n<s.length;n++){var l=s[n];l.indexOf("data")===0&&this.hiddenInput.setAttribute(l,i[l])}},t.prototype.updateHTMLAttrToElement=function(){if(!(0,a.le)(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];lv.indexOf(r)<0&&this.element.setAttribute(r,this.htmlAttributes[r])}},t.prototype.updateCssClass=function(e,i){Ue.setCssClass(this.getNumericValidClassList(e),[this.container],this.getNumericValidClassList(i))},t.prototype.getNumericValidClassList=function(e){var i=e;return!(0,a.le)(e)&&e!==""&&(i=e.replace(/\s+/g," ").trim()),i},t.prototype.updateHTMLAttrToWrapper=function(){if(!(0,a.le)(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(lv.indexOf(r)>-1)if(r==="class"){var n=this.getNumericValidClassList(this.htmlAttributes[r]);n!==""&&(0,a.cn)([this.container],n.split(" "))}else if(r==="style"){var s=this.container.getAttribute(r);s=(0,a.le)(s)?this.htmlAttributes[r]:s+this.htmlAttributes[r],this.container.setAttribute(r,s)}else this.container.setAttribute(r,this.htmlAttributes[r])}},t.prototype.setElementWidth=function(e){(0,a.le)(e)||(typeof e=="number"?this.container.style.width=(0,a.Ac)(e):typeof e=="string"&&(this.container.style.width=e.match(/px|%|em/)?e:(0,a.Ac)(e)))},t.prototype.spinBtnCreation=function(){this.spinDown=Ue.appendSpan(zu+" "+Sb,this.container,this.createElement),(0,a.Y4)(this.spinDown,{title:this.l10n.getConstant("decrementTitle"),"aria-label":this.l10n.getConstant("decrementTitle")}),this.spinUp=Ue.appendSpan(zu+" "+_u,this.container,this.createElement),(0,a.Y4)(this.spinUp,{title:this.l10n.getConstant("incrementTitle"),"aria-label":this.l10n.getConstant("incrementTitle")}),this.wireSpinBtnEvents()},t.prototype.validateMinMax=function(){typeof this.min=="number"&&!isNaN(this.min)||this.setProperties({min:-Number.MAX_VALUE},!0),typeof this.max=="number"&&!isNaN(this.max)||this.setProperties({max:Number.MAX_VALUE},!0),this.decimals!==null&&(this.min!==-Number.MAX_VALUE&&this.setProperties({min:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.min))},!0),this.max!==Number.MAX_VALUE&&this.setProperties({max:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.max))},!0)),this.setProperties({min:this.min>this.max?this.max:this.min},!0),(0,a.Y4)(this.element,{"aria-valuemin":this.min.toString(),"aria-valuemax":this.max.toString()})},t.prototype.formattedValue=function(e,i){return this.instance.getNumberFormat({maximumFractionDigits:e,minimumFractionDigits:e,useGrouping:!1})(i)},t.prototype.validateStep=function(){this.decimals!==null&&this.setProperties({step:this.instance.getNumberParser({format:"n"})(this.formattedValue(this.decimals,this.step))},!0)},t.prototype.action=function(e,i){this.isInteract=!0;var r=this.isFocused?this.instance.getNumberParser({format:"n"})(this.element.value):this.value;this.changeValue(this.performAction(r,this.step,e)),this.raiseChangeEvent(i)},t.prototype.checkErrorClass=function(){this.isValidState?(0,a.IV)([this.container],ju):(0,a.cn)([this.container],ju),(0,a.Y4)(this.element,{"aria-invalid":this.isValidState?"false":"true"})},t.prototype.bindClearEvent=function(){this.showClearButton&&a.bi.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)},t.prototype.resetHandler=function(e){e.preventDefault(),(!this.inputWrapper.clearButton.classList.contains("e-clear-icon-hide")||this.inputWrapper.container.classList.contains("e-static-clear"))&&this.clear(e),this.isInteract=!0,this.raiseChangeEvent(e)},t.prototype.clear=function(e){this.setProperties({value:null},!0),this.setElementValue(""),this.hiddenInput.value="";var i=(0,a.oq)(this.element,"form");if(i){var r=this.element.nextElementSibling,n=document.createEvent("KeyboardEvent");n.initEvent("keyup",!1,!0),r.dispatchEvent(n)}},t.prototype.resetFormHandler=function(){this.element.tagName==="EJS-NUMERICTEXTBOX"?this.updateValue(null):this.updateValue(this.inputEleValue)},t.prototype.setSpinButton=function(){(0,a.le)(this.spinDown)||(0,a.Y4)(this.spinDown,{title:this.l10n.getConstant("decrementTitle"),"aria-label":this.l10n.getConstant("decrementTitle")}),(0,a.le)(this.spinUp)||(0,a.Y4)(this.spinUp,{title:this.l10n.getConstant("incrementTitle"),"aria-label":this.l10n.getConstant("incrementTitle")})},t.prototype.wireEvents=function(){a.bi.add(this.element,"focus",this.focusHandler,this),a.bi.add(this.element,"blur",this.focusOutHandler,this),a.bi.add(this.element,"keydown",this.keyDownHandler,this),a.bi.add(this.element,"keyup",this.keyUpHandler,this),a.bi.add(this.element,"input",this.inputHandler,this),a.bi.add(this.element,"keypress",this.keyPressHandler,this),a.bi.add(this.element,"change",this.changeHandler,this),a.bi.add(this.element,"paste",this.pasteHandler,this),this.enabled&&(this.bindClearEvent(),this.formEle&&a.bi.add(this.formEle,"reset",this.resetFormHandler,this))},t.prototype.wireSpinBtnEvents=function(){a.bi.add(this.spinUp,a.AR.touchStartEvent,this.mouseDownOnSpinner,this),a.bi.add(this.spinDown,a.AR.touchStartEvent,this.mouseDownOnSpinner,this),a.bi.add(this.spinUp,a.AR.touchEndEvent,this.mouseUpOnSpinner,this),a.bi.add(this.spinDown,a.AR.touchEndEvent,this.mouseUpOnSpinner,this),a.bi.add(this.spinUp,a.AR.touchMoveEvent,this.touchMoveOnSpinner,this),a.bi.add(this.spinDown,a.AR.touchMoveEvent,this.touchMoveOnSpinner,this)},t.prototype.unwireEvents=function(){a.bi.remove(this.element,"focus",this.focusHandler),a.bi.remove(this.element,"blur",this.focusOutHandler),a.bi.remove(this.element,"keyup",this.keyUpHandler),a.bi.remove(this.element,"input",this.inputHandler),a.bi.remove(this.element,"keydown",this.keyDownHandler),a.bi.remove(this.element,"keypress",this.keyPressHandler),a.bi.remove(this.element,"change",this.changeHandler),a.bi.remove(this.element,"paste",this.pasteHandler),this.formEle&&a.bi.remove(this.formEle,"reset",this.resetFormHandler)},t.prototype.unwireSpinBtnEvents=function(){a.bi.remove(this.spinUp,a.AR.touchStartEvent,this.mouseDownOnSpinner),a.bi.remove(this.spinDown,a.AR.touchStartEvent,this.mouseDownOnSpinner),a.bi.remove(this.spinUp,a.AR.touchEndEvent,this.mouseUpOnSpinner),a.bi.remove(this.spinDown,a.AR.touchEndEvent,this.mouseUpOnSpinner),a.bi.remove(this.spinUp,a.AR.touchMoveEvent,this.touchMoveOnSpinner),a.bi.remove(this.spinDown,a.AR.touchMoveEvent,this.touchMoveOnSpinner)},t.prototype.changeHandler=function(e){e.stopPropagation(),this.element.value.length||this.setProperties({value:null},!0);var i=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(i,e)},t.prototype.raiseChangeEvent=function(e){if(this.prevValue!==this.value){var i={};this.changeEventArgs={value:this.value,previousValue:this.prevValue,isInteracted:this.isInteract,isInteraction:this.isInteract,event:e},e&&(this.changeEventArgs.event=e),this.changeEventArgs.event===void 0&&(this.changeEventArgs.isInteracted=!1,this.changeEventArgs.isInteraction=!1),(0,a.TS)(i,this.changeEventArgs),this.prevValue=this.value,this.isInteract=!1,this.elementPrevValue=this.element.value,this.preventChange=!1,this.trigger("change",i)}},t.prototype.pasteHandler=function(){var e=this;if(!(!this.enabled||this.readonly)){var i=this.element.value;setTimeout(function(){e.numericRegex().test(e.element.value)||e.setElementValue(i)})}},t.prototype.preventHandler=function(){var e=this,i=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);setTimeout(function(){if(e.element.selectionStart>0){var r=e.element.selectionStart,n=e.element.selectionStart-1,s=0,l=e.element.value.split(""),h=(0,a.NE)(e.locale),c=(0,a.NA)("decimal",h),u=c.charCodeAt(0);e.element.value[n]===" "&&e.element.selectionStart>0&&!i?((0,a.le)(e.prevVal)?e.element.value=e.element.value.trim():n!==0?e.element.value=e.prevVal:n===0&&(e.element.value=e.element.value.trim()),e.element.setSelectionRange(n,n)):isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&e.element.value[e.element.selectionStart-1].charCodeAt(0)!==45?(l.indexOf(e.element.value[e.element.selectionStart-1])!==l.lastIndexOf(e.element.value[e.element.selectionStart-1])&&e.element.value[e.element.selectionStart-1].charCodeAt(0)===u||e.element.value[e.element.selectionStart-1].charCodeAt(0)!==u)&&(e.element.value=e.element.value.substring(0,n)+e.element.value.substring(r,e.element.value.length),e.element.setSelectionRange(n,n),isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&e.element.selectionStart>0&&e.element.value.length&&e.preventHandler()):isNaN(parseFloat(e.element.value[e.element.selectionStart-2]))&&e.element.selectionStart>1&&e.element.value[e.element.selectionStart-2].charCodeAt(0)!==45&&(l.indexOf(e.element.value[e.element.selectionStart-2])!==l.lastIndexOf(e.element.value[e.element.selectionStart-2])&&e.element.value[e.element.selectionStart-2].charCodeAt(0)===u||e.element.value[e.element.selectionStart-2].charCodeAt(0)!==u)&&(e.element.setSelectionRange(n,n),e.nextEle=e.element.value[e.element.selectionStart],e.cursorPosChanged=!0,e.preventHandler()),e.cursorPosChanged===!0&&e.element.value[e.element.selectionStart]===e.nextEle&&isNaN(parseFloat(e.element.value[e.element.selectionStart-1]))&&(e.element.setSelectionRange(e.element.selectionStart+1,e.element.selectionStart+1),e.cursorPosChanged=!1,e.nextEle=null),e.element.value.trim()===""&&e.element.setSelectionRange(s,s),e.element.selectionStart>0&&(e.element.value[e.element.selectionStart-1].charCodeAt(0)===45&&e.element.selectionStart>1&&((0,a.le)(e.prevVal)?e.element.value=e.element.value:e.element.value=e.prevVal,e.element.setSelectionRange(e.element.selectionStart,e.element.selectionStart)),e.element.value[e.element.selectionStart-1]===c&&e.decimals===0&&e.validateDecimalOnType&&(e.element.value=e.element.value.substring(0,n)+e.element.value.substring(r,e.element.value.length))),e.prevVal=e.element.value}})},t.prototype.keyUpHandler=function(){if(!(!this.enabled||this.readonly)){var e=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);!e&&a.AR.isDevice&&this.preventHandler();var i=this.instance.getNumberParser({format:"n"})(this.element.value);i=i===null||isNaN(i)?null:i,this.hiddenInput.value=i||i===0?i.toString():null;var r=(0,a.oq)(this.element,"form");if(r){var n=this.element.nextElementSibling,s=document.createEvent("KeyboardEvent");s.initEvent("keyup",!1,!0),n.dispatchEvent(s)}}},t.prototype.inputHandler=function(e){var i=this;if(!(!this.enabled||this.readonly)){var r=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform),n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if((n||r)&&a.AR.isDevice&&this.preventHandler(),this.isAngular&&this.element.value!==(0,a.NA)("decimal",(0,a.NE)(this.locale))&&this.element.value!==(0,a.NA)("minusSign",(0,a.NE)(this.locale))){var s=this.instance.getNumberParser({format:"n"})(this.element.value);s=isNaN(s)?null:s,i.localChange({value:s}),this.preventChange=!0}if(this.isVue){var l=this.instance.getNumberParser({format:"n"})(this.element.value),h=this.instance.getNumberParser({format:"n"})(this.elementPrevValue),c=new RegExp("[^1-9]+$");c.test(this.element.value)&&(l=this.value);var u={event:e,value:l===null||isNaN(l)?null:l,previousValue:h===null||isNaN(h)?null:h};this.preventChange=!0,this.elementPrevValue=this.element.value,this.trigger("input",u)}}},t.prototype.keyDownHandler=function(e){if(!this.readonly)switch(e.keyCode){case 38:e.preventDefault(),this.action(_a,e);break;case 40:e.preventDefault(),this.action(Uo,e);break;default:break}},t.prototype.performAction=function(e,i,r){(e===null||isNaN(e))&&(e=0);var n=r===_a?e+i:e-i;return n=this.correctRounding(e,i,n),this.strictMode?this.trimValue(n):n},t.prototype.correctRounding=function(e,i,r){var n=new RegExp("[,.](.*)"),s=n.test(e.toString()),l=n.test(i.toString());if(s||l){var h=s?n.exec(e.toString())[0].length:0,c=l?n.exec(i.toString())[0].length:0,u=Math.max(h,c);return e=this.roundValue(r,u)}return r},t.prototype.roundValue=function(e,i){i=i||0;var r=Math.pow(10,i);return e*=r,e=Math.round(e)/r},t.prototype.updateValue=function(e,i){i&&(this.isInteract=!0),e!==null&&!isNaN(e)&&this.decimals&&(e=this.roundNumber(e,this.decimals)),this.changeValue(e===null||isNaN(e)?null:this.strictMode?this.trimValue(e):e),this.isDynamicChange||this.raiseChangeEvent(i)},t.prototype.updateCurrency=function(e,i){(0,a.sO)(e,i,this.cultureInfo),this.updateValue(this.value)},t.prototype.changeValue=function(e){if(!(e||e===0))e=null,this.setProperties({value:e},!0);else{var i=this.getNumberOfDecimals(e);this.setProperties({value:this.roundNumber(e,i)},!0)}this.modifyText(),this.strictMode||this.validateState()},t.prototype.modifyText=function(){if(this.value||this.value===0){var e=this.formatNumber(),i=this.isFocused?e:this.instance.getNumberFormat(this.cultureInfo)(this.value);this.setElementValue(i),(0,a.Y4)(this.element,{"aria-valuenow":e}),this.hiddenInput.value=this.value.toString(),this.value!==null&&this.serverDecimalSeparator&&(this.hiddenInput.value=this.hiddenInput.value.replace(".",this.serverDecimalSeparator))}else this.setElementValue(""),this.element.removeAttribute("aria-valuenow"),this.hiddenInput.value=null},t.prototype.setElementValue=function(e,i){Ue.setValue(e,i||this.element,this.floatLabelType,this.showClearButton)},t.prototype.validateState=function(){this.isValidState=!0,(this.value||this.value===0)&&(this.isValidState=!(this.value>this.max||this.value<this.min)),this.checkErrorClass()},t.prototype.getNumberOfDecimals=function(e){var i,r=new RegExp("[eE][-+]?([0-9]+)"),n=e.toString();if(r.test(n)){var s=r.exec(n);(0,a.le)(s)||(n=e.toFixed(Math.min(parseInt(s[1],10),20)))}var l=n.split(".")[1];return i=!l||!l.length?0:l.length,this.decimals!==null&&(i=i<this.decimals?i:this.decimals),i},t.prototype.formatNumber=function(){var e=this.getNumberOfDecimals(this.value);return this.instance.getNumberFormat({maximumFractionDigits:e,minimumFractionDigits:e,useGrouping:!1})(this.value)},t.prototype.trimValue=function(e){return e>this.max?this.max:e<this.min?this.min:e},t.prototype.roundNumber=function(e,i){var r=e,n=i||0,s=r.toString().split("e");r=Math.round(Number(s[0]+"e"+(s[1]?Number(s[1])+n:n)));var l=r.toString().split("e");return r=Number(l[0]+"e"+(l[1]?Number(l[1])-n:-n)),Number(r.toFixed(n))},t.prototype.cancelEvent=function(e){return e.preventDefault(),!1},t.prototype.keyPressHandler=function(e){if(!this.enabled||this.readonly)return!0;if(!a.AR.isDevice&&a.AR.info.version==="11.0"&&e.keyCode===13){var i=this.instance.getNumberParser({format:"n"})(this.element.value);return this.updateValue(i,e),!0}if(e.which===0||e.metaKey||e.ctrlKey||e.keyCode===8||e.keyCode===13)return!0;var r=String.fromCharCode(e.which),n=(0,a.NA)("decimal",(0,a.NE)(this.locale)),s=e.code==="NumpadDecimal"&&r!==n;s&&(r=n);var l=this.element.value;if(l=l.substring(0,this.element.selectionStart)+r+l.substring(this.element.selectionEnd),this.numericRegex().test(l)){if(s){var h=this.element.selectionStart+1;this.element.value=l,this.element.setSelectionRange(h,h),e.preventDefault(),e.stopPropagation()}return!0}else return e.preventDefault(),e.stopPropagation(),!1},t.prototype.numericRegex=function(){var e=(0,a.NE)(this.locale),i=(0,a.NA)("decimal",e),r="*";return i===xb&&(i="\\"+i),this.decimals===0&&this.validateDecimalOnType?wb:(this.decimals&&this.validateDecimalOnType&&(r="{0,"+this.decimals+"}"),new RegExp("^(-)?(((\\d+("+i+"\\d"+r+")?)|("+i+"\\d"+r+")))?$"))},t.prototype.mouseWheel=function(e){e.preventDefault();var i,r=e;r.wheelDelta?i=r.wheelDelta/120:r.detail&&(i=-r.detail/3),i>0?this.action(_a,e):i<0&&this.action(Uo,e),this.cancelEvent(e)},t.prototype.focusHandler=function(e){var i=this;if(this.focusEventArgs={event:e,value:this.value,container:this.container},this.trigger("focus",this.focusEventArgs),!(!this.enabled||this.readonly)){if(this.isFocused=!0,(0,a.IV)([this.container],ju),this.prevValue=this.value,this.value||this.value===0){var r=this.formatNumber();if(this.setElementValue(r),!this.isPrevFocused)if(!a.AR.isDevice&&a.AR.info.version==="11.0")this.element.setSelectionRange(0,r.length);else{var n=a.AR.isDevice&&a.AR.isIos?600:0;setTimeout(function(){i.element.setSelectionRange(0,r.length)},n)}}a.AR.isDevice||a.bi.add(this.element,"mousewheel DOMMouseScroll",this.mouseWheel,this)}},t.prototype.focusOutHandler=function(e){var i=this;if(this.blurEventArgs={event:e,value:this.value,container:this.container},this.trigger("blur",this.blurEventArgs),!(!this.enabled||this.readonly)){if(this.isPrevFocused){if(e.preventDefault(),a.AR.isDevice){var r=this.element.value;this.element.focus(),this.isPrevFocused=!1;var n=this.element;setTimeout(function(){i.setElementValue(r,n)},200)}}else{this.isFocused=!1,this.element.value.length||this.setProperties({value:null},!0);var s=this.instance.getNumberParser({format:"n"})(this.element.value);this.updateValue(s),a.AR.isDevice||a.bi.remove(this.element,"mousewheel DOMMouseScroll",this.mouseWheel)}var l=(0,a.oq)(this.element,"form");if(l){var h=this.element.nextElementSibling,c=document.createEvent("FocusEvent");c.initEvent("focusout",!1,!0),h.dispatchEvent(c)}}},t.prototype.mouseDownOnSpinner=function(e){var i=this;if(this.isFocused&&(this.isPrevFocused=!0,e.preventDefault()),!!this.getElementData(e)){var r=this.getElementData(e),n=e.currentTarget,s=n.classList.contains(_u)?_a:Uo;a.bi.add(n,"mouseleave",this.mouseUpClick,this),this.timeOut=setInterval(function(){i.isCalled=!0,i.action(s,e)},150),a.bi.add(document,"mouseup",this.mouseUpClick,this)}},t.prototype.touchMoveOnSpinner=function(e){var i;if(e.type==="touchmove"){var r=e.touches;i=r.length&&document.elementFromPoint(r[0].pageX,r[0].pageY)}else i=document.elementFromPoint(e.clientX,e.clientY);i.classList.contains(zu)||clearInterval(this.timeOut)},t.prototype.mouseUpOnSpinner=function(e){if(this.prevValue=this.value,this.isPrevFocused&&(this.element.focus(),a.AR.isDevice||(this.isPrevFocused=!1)),a.AR.isDevice||e.preventDefault(),!!this.getElementData(e)){var i=e.currentTarget,r=i.classList.contains(_u)?_a:Uo;a.bi.remove(i,"mouseleave",this.mouseUpClick),this.isCalled||this.action(r,e),this.isCalled=!1,a.bi.remove(document,"mouseup",this.mouseUpClick);var n=(0,a.oq)(this.element,"form");if(n){var s=this.element.nextElementSibling,l=document.createEvent("KeyboardEvent");l.initEvent("keyup",!1,!0),s.dispatchEvent(l)}}},t.prototype.getElementData=function(e){return e.which&&e.which===3||e.button&&e.button===2||!this.enabled||this.readonly?!1:(clearInterval(this.timeOut),!0)},t.prototype.floatLabelTypeUpdate=function(){Ue.removeFloating(this.inputWrapper);var e=this.hiddenInput;this.hiddenInput.remove(),Ue.addFloating(this.element,this.floatLabelType,this.placeholder,this.createElement),this.container.insertBefore(e,this.container.childNodes[1])},t.prototype.mouseUpClick=function(e){e.stopPropagation(),clearInterval(this.timeOut),this.isCalled=!1,a.bi.remove(this.spinUp,"mouseleave",this.mouseUpClick),a.bi.remove(this.spinDown,"mouseleave",this.mouseUpClick)},t.prototype.increment=function(e){e===void 0&&(e=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,e,_a)),this.raiseChangeEvent()},t.prototype.decrement=function(e){e===void 0&&(e=this.step),this.isInteract=!1,this.changeValue(this.performAction(this.value,e,Uo)),this.raiseChangeEvent()},t.prototype.destroy=function(){this.unwireEvents(),(0,a.og)(this.hiddenInput),this.showSpinButton&&(this.unwireSpinBtnEvents(),(0,a.og)(this.spinUp),(0,a.og)(this.spinDown));for(var e=["aria-labelledby","role","autocomplete","aria-readonly","autocorrect","aria-disabled","aria-placeholder","autocapitalize","spellcheck","aria-autocomplete","tabindex","aria-valuemin","aria-valuemax","aria-live","aria-valuenow","aria-invalid"],i=0;i<e.length;i++)this.element.removeAttribute(e[i]);this.element.classList.remove("e-input"),this.container.insertAdjacentElement("afterend",this.element),(0,a.og)(this.container),o.prototype.destroy.call(this)},t.prototype.getText=function(){return this.element.value},t.prototype.focusIn=function(){document.activeElement!==this.element&&this.enabled&&(this.element.focus(),(0,a.cn)([this.container],[ov]))},t.prototype.focusOut=function(){document.activeElement===this.element&&this.enabled&&(this.element.blur(),(0,a.IV)([this.container],[ov]))},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"width":this.setElementWidth(e.width);break;case"cssClass":this.updateCssClass(e.cssClass,i.cssClass);break;case"enabled":Ue.setEnabled(e.enabled,this.element);break;case"enableRtl":Ue.setEnableRtl(e.enableRtl,[this.container]);break;case"readonly":Ue.setReadonly(e.readonly,this.element),this.readonly?(0,a.Y4)(this.element,{"aria-readonly":"true"}):this.element.removeAttribute("aria-readonly");break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.updateDataAttribute(!0),this.checkAttributes(!0),Ue.validateInputType(this.container,this.element);break;case"placeholder":Ue.setPlaceholder(e.placeholder,this.element);break;case"step":this.step=e.step,this.validateStep();break;case"showSpinButton":this.updateSpinButton(e);break;case"showClearButton":this.updateClearButton(e);break;case"floatLabelType":this.floatLabelType=e.floatLabelType,this.floatLabelTypeUpdate();break;case"value":this.isDynamicChange=(this.isAngular||this.isVue)&&this.preventChange,this.updateValue(e.value),this.isDynamicChange&&(this.preventChange=!1,this.isDynamicChange=!1);break;case"min":case"max":(0,a.sO)(s,(0,a.NA)(s,e),this),this.validateMinMax(),this.updateValue(this.value);break;case"strictMode":this.strictMode=e.strictMode,this.updateValue(this.value),this.validateState();break;case"locale":this.initCultureFunc(),this.l10n.setLocale(this.locale),this.setSpinButton(),this.updatePlaceholder(),Ue.setPlaceholder(this.placeholder,this.element),this.updateValue(this.value);break;case"currency":{var l=(0,a.NA)(s,e);this.setProperties({currencyCode:l},!0),this.updateCurrency(s,l)}break;case"currencyCode":{var h=(0,a.NA)(s,e);this.setProperties({currency:h},!0),this.updateCurrency("currency",h)}break;case"format":(0,a.sO)(s,(0,a.NA)(s,e),this),this.initCultureInfo(),this.updateValue(this.value);break;case"decimals":this.decimals=e.decimals,this.updateValue(this.value)}}},t.prototype.updateClearButton=function(e){Ue.setClearButton(e.showClearButton,this.element,this.inputWrapper,void 0,this.createElement),this.bindClearEvent()},t.prototype.updateSpinButton=function(e){e.showSpinButton?this.spinBtnCreation():((0,a.og)(this.spinUp),(0,a.og)(this.spinDown))},t.prototype.getModuleName=function(){return"numerictextbox"},wi([(0,a.Z9)("")],t.prototype,"cssClass",void 0),wi([(0,a.Z9)(null)],t.prototype,"value",void 0),wi([(0,a.Z9)(-Number.MAX_VALUE)],t.prototype,"min",void 0),wi([(0,a.Z9)(Number.MAX_VALUE)],t.prototype,"max",void 0),wi([(0,a.Z9)(1)],t.prototype,"step",void 0),wi([(0,a.Z9)(null)],t.prototype,"width",void 0),wi([(0,a.Z9)(null)],t.prototype,"placeholder",void 0),wi([(0,a.Z9)({})],t.prototype,"htmlAttributes",void 0),wi([(0,a.Z9)(!0)],t.prototype,"showSpinButton",void 0),wi([(0,a.Z9)(!1)],t.prototype,"readonly",void 0),wi([(0,a.Z9)(!0)],t.prototype,"enabled",void 0),wi([(0,a.Z9)(!1)],t.prototype,"showClearButton",void 0),wi([(0,a.Z9)(!1)],t.prototype,"enablePersistence",void 0),wi([(0,a.Z9)("n2")],t.prototype,"format",void 0),wi([(0,a.Z9)(null)],t.prototype,"decimals",void 0),wi([(0,a.Z9)(null)],t.prototype,"currency",void 0),wi([(0,a.Z9)(null)],t.prototype,"currencyCode",void 0),wi([(0,a.Z9)(!0)],t.prototype,"strictMode",void 0),wi([(0,a.Z9)(!1)],t.prototype,"validateDecimalOnType",void 0),wi([(0,a.Z9)("Never")],t.prototype,"floatLabelType",void 0),wi([(0,a.ju)()],t.prototype,"created",void 0),wi([(0,a.ju)()],t.prototype,"destroyed",void 0),wi([(0,a.ju)()],t.prototype,"change",void 0),wi([(0,a.ju)()],t.prototype,"focus",void 0),wi([(0,a.ju)()],t.prototype,"blur",void 0),t=wi([a.Zl],t),t}(a.wA),Lb=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ar=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},ja={EMAIL:new RegExp("^[A-Za-z0-9._%+-]{1,}@[A-Za-z0-9._%+-]{1,}([.]{1}[a-zA-Z0-9]{2,}|[.]{1}[a-zA-Z0-9]{2,4}[.]{1}[a-zA-Z0-9]{2,4})$"),URL:/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/m,DATE_ISO:new RegExp("^([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$"),DIGITS:new RegExp("^[0-9]*$"),PHONE:new RegExp("^[+]?[0-9]{9,13}$"),CREDITCARD:new RegExp("^\\d{13,16}$")},gh;(function(o){o[o.Message=0]="Message",o[o.Label=1]="Label"})(gh||(gh={}));var kb=function(o){Lb(t,o);function t(i,r){var n=o.call(this,r,i)||this;if(n.validated=[],n.errorRules=[],n.allowSubmit=!1,n.required="required",n.infoElement=null,n.inputElement=null,n.selectQuery="input:not([type=reset]):not([type=button]), select, textarea",n.localyMessage={},n.defaultMessages={required:"This field is required.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateIso:"Please enter a valid date ( ISO ).",creditcard:"Please enter valid card number",number:"Please enter a valid number.",digits:"Please enter only digits.",maxLength:"Please enter no more than {0} characters.",minLength:"Please enter at least {0} characters.",rangeLength:"Please enter a value between {0} and {1} characters long.",range:"Please enter a value between {0} and {1}.",max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}.",regex:"Please enter a correct value.",tel:"Please enter a valid phone number.",pattern:"Please enter a correct pattern value.",equalTo:"Please enter the valid match text"},typeof n.rules=="undefined"&&(n.rules={}),n.l10n=new a.E7("formValidator",n.defaultMessages,n.locale),n.locale&&n.localeFunc(),a.VD.on("notifyExternalChange",n.afterLocalization,n),i=typeof i=="string"?(0,a.Ys)(i,document):i,n.element!=null)n.element.setAttribute("novalidate",""),n.inputElements=(0,a.td)(n.selectQuery,n.element),n.createHTML5Rules(),n.wireEvents();else return;return n}e=t,t.prototype.addRules=function(i,r){i&&(this.rules.hasOwnProperty(i)?(0,a.l7)(this.rules[i],r,{}):this.rules[i]=r)},t.prototype.removeRules=function(i,r){if(!i&&!r)this.rules={};else if(this.rules[i]&&!r)delete this.rules[i];else{if((0,a.le)(this.rules[i]&&r))return;for(var n=0;n<r.length;n++)delete this.rules[i][r[n]]}},t.prototype.validate=function(i){var r=Object.keys(this.rules);if(i&&r.length)return this.validateRules(i),r.indexOf(i)!==-1&&this.errorRules.filter(function(h){return h.name===i}).length===0;this.errorRules=[];for(var n=0,s=r;n<s.length;n++){var l=s[n];this.validateRules(l)}return this.errorRules.length===0},t.prototype.reset=function(){this.element.reset(),this.clearForm()},t.prototype.getInputElement=function(i){return this.inputElement=(0,a.Ys)('[name="'+i+'"]',this.element),this.inputElement},t.prototype.destroy=function(){this.reset(),this.unwireEvents(),this.rules={};for(var i=(0,a.td)("."+this.errorClass+", ."+this.validClass,this.element),r=0,n=i;r<n.length;r++){var s=n[r];(0,a.og)(s)}o.prototype.destroy.call(this),a.VD.off("notifyExternalChange",this.afterLocalization)},t.prototype.onPropertyChanged=function(i,r){for(var n=0,s=Object.keys(i);n<s.length;n++){var l=s[n];switch(l){case"locale":this.localeFunc();break}}},t.prototype.localeFunc=function(){for(var i=0,r=Object.keys(this.defaultMessages);i<r.length;i++){var n=r[i];this.l10n.setLocale(this.locale);var s=this.l10n.getConstant(n);this.localyMessage[n]=s}},t.prototype.getModuleName=function(){return"formValidator"},t.prototype.afterLocalization=function(i){this.locale=i.locale,this.localeFunc()},t.prototype.refresh=function(){this.unwireEvents(),this.inputElements=(0,a.td)(this.selectQuery,this.element),this.wireEvents()},t.prototype.clearForm=function(){this.errorRules=[],this.validated=[];for(var i=(0,a.td)(this.selectQuery,this.element),r=0,n=i;r<n.length;r++){var s=n[r],l=s;l.removeAttribute("aria-invalid"),l.classList.remove(this.errorClass),l.name.length>0&&(this.getInputElement(l.name),this.getErrorElement(l.name),this.hideMessage(l.name)),l.classList.remove(this.validClass)}},t.prototype.createHTML5Rules=function(){for(var i=["required","validateHidden","regex","rangeLength","maxLength","minLength","dateIso","digits","pattern","data-val-required","type","data-validation","min","max","range","equalTo","data-val-minlength-min","data-val-equalto-other","data-val-maxlength-max","data-val-range-min","data-val-regex-pattern","data-val-length-max","data-val-creditcard","data-val-phone"],r=["hidden","email","url","date","number","tel"],n=0,s=this.inputElements;n<s.length;n++){for(var l=s[n],h={},c=0,u=i;c<u.length;c++){var p=u[c];if(l.getAttribute(p)!==null)switch(p){case"required":this.defRule(l,h,p,l.required);break;case"data-validation":p=l.getAttribute(p),this.defRule(l,h,p,!0);break;case"type":r.indexOf(l.type)!==-1&&this.defRule(l,h,l.type,!0);break;case"rangeLength":case"range":this.defRule(l,h,p,JSON.parse(l.getAttribute(p)));break;case"equalTo":{var f=l.getAttribute(p);this.defRule(l,h,p,f)}break;default:l.getAttribute("data-val")==="true"?this.annotationRule(l,h,p,l.getAttribute(p)):this.defRule(l,h,p,l.getAttribute(p))}}Object.keys(h).length!==0&&this.addRules(l.name,h)}},t.prototype.annotationRule=function(i,r,n,s){var l=n.split("-"),h=["required","creditcard","phone","maxlength","minlength","range","regex","equalto"],c=l[l.length-1],u=l[l.length-2];if(h.indexOf(c)!==-1)switch(c){case"required":this.defRule(i,r,"required",s);break;case"creditcard":this.defRule(i,r,"creditcard",s);break;case"phone":this.defRule(i,r,"tel",s);break}else if(h.indexOf(u)!==-1)switch(u){case"maxlength":this.defRule(i,r,"maxLength",s);break;case"minlength":this.defRule(i,r,"minLength",s);break;case"range":{var p=i.getAttribute("data-val-range-min"),f=i.getAttribute("data-val-range-max");this.defRule(i,r,"range",[p,f])}break;case"equalto":{var g=i.getAttribute(n).split(".");this.defRule(i,r,"equalTo",g[g.length-1])}break;case"regex":this.defRule(i,r,"regex",s);break}},t.prototype.defRule=function(i,r,n,s){var l=i.getAttribute("data-"+n+"-message"),h=i.getAttribute("data-val-"+n),c;this.rules[i.name]&&n!=="validateHidden"&&n!=="hidden"&&(this.getInputElement(i.name),c=this.getErrorMessage(this.rules[i.name][n],n)),l?s=[s,l]:h?s=[s,h]:c&&(s=[s,c]),r[n]=s},t.prototype.wireEvents=function(){for(var i=0,r=this.inputElements;i<r.length;i++){var n=r[i];e.isCheckable(n)?a.bi.add(n,"click",this.clickHandler,this):n.tagName==="SELECT"?a.bi.add(n,"change",this.changeHandler,this):(a.bi.add(n,"focusout",this.focusOutHandler,this),a.bi.add(n,"keyup",this.keyUpHandler,this))}a.bi.add(this.element,"submit",this.submitHandler,this),a.bi.add(this.element,"reset",this.resetHandler,this)},t.prototype.unwireEvents=function(){for(var i=0,r=this.inputElements;i<r.length;i++){var n=r[i];a.bi.clearEvents(n)}a.bi.remove(this.element,"submit",this.submitHandler),a.bi.remove(this.element,"reset",this.resetHandler)},t.prototype.focusOutHandler=function(i){this.trigger("focusout",i);var r=i.target;this.rules[r.name]&&(this.rules[r.name][this.required]||r.value.length>0?this.validate(r.name):this.validated.indexOf(r.name)===-1&&this.validated.push(r.name))},t.prototype.keyUpHandler=function(i){this.trigger("keyup",i);var r=i.target,n=[16,17,18,20,35,36,37,38,39,40,45,144,225];i.which===9&&(!this.rules[r.name]||this.rules[r.name]&&!this.rules[r.name][this.required])||this.validated.indexOf(r.name)!==-1&&this.rules[r.name]&&n.indexOf(i.which)===-1&&this.validate(r.name)},t.prototype.clickHandler=function(i){this.trigger("click",i);var r=i.target;r.type!=="submit"?this.validate(r.name):r.getAttribute("formnovalidate")!==null&&(this.allowSubmit=!0)},t.prototype.changeHandler=function(i){this.trigger("change",i);var r=i.target;this.validate(r.name)},t.prototype.submitHandler=function(i){this.trigger("submit",i),!this.allowSubmit&&!this.validate()?i.preventDefault():this.allowSubmit=!1},t.prototype.resetHandler=function(){this.clearForm()},t.prototype.validateRules=function(i){if(!!this.rules[i]){var r=Object.keys(this.rules[i]),n=!1,s=!1,l=r.indexOf("validateHidden"),h=r.indexOf("hidden");if(this.getInputElement(i),h!==-1&&(n=!0),l!==-1&&(s=!0),!n||n&&s){l!==-1&&r.splice(l,1),h!==-1&&r.splice(h-1,1),this.getErrorElement(i);for(var c=0,u=r;c<u.length;c++){var p=u[c],f=this.getErrorMessage(this.rules[i][p],p),g={name:i,message:f},C={inputName:i,element:this.inputElement,message:f};if(!this.isValid(i,p)&&!this.inputElement.classList.contains(this.ignore)){this.removeErrorRules(i),this.errorRules.push(g),this.inputElement.setAttribute("aria-invalid","true"),this.inputElement.setAttribute("aria-describedby",this.inputElement.id+"-info"),this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass),this.infoElement?this.showMessage(g):this.createErrorElement(i,g.message,this.inputElement),C.errorElement=this.infoElement,C.status="failure",this.inputElement.classList.add(this.errorClass),this.inputElement.classList.remove(this.validClass),this.optionalValidationStatus(i,C),this.trigger("validationComplete",C),p==="required"&&this.inputElement.setAttribute("aria-required","true");break}else this.hideMessage(i),C.status="success",this.trigger("validationComplete",C)}}else return}},t.prototype.optionalValidationStatus=function(i,r){!this.rules[i][this.required]&&!this.inputElement.value.length&&!(0,a.le)(this.infoElement)&&(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),r.status="",this.hideMessage(i))},t.prototype.isValid=function(i,r){var n=this.rules[i][r],s=n instanceof Array&&typeof n[1]=="string"?n[0]:n,l=this.rules[i][r],h={value:this.inputElement.value,param:s,element:this.inputElement,formElement:this.element};if(this.trigger("validationBegin",h),!h.param&&r==="required")return!0;if(l&&typeof l[0]=="function"){var c=l[0];return c.call(this,{element:this.inputElement,value:this.inputElement.value})}else return e.isCheckable(this.inputElement)?r!=="required"?!0:(0,a.td)('input[name="'+i+'"]:checked',this.element).length>0:e.checkValidator[r](h)},t.prototype.getErrorMessage=function(i,r){var n=this.inputElement.getAttribute("data-"+r+"-message")?this.inputElement.getAttribute("data-"+r+"-message"):i instanceof Array&&typeof i[1]=="string"?i[1]:Object.keys(this.localyMessage).length!==0?this.localyMessage[r]:this.defaultMessages[r],s=n.match(/{(\d)}/g);if(!(0,a.le)(s))for(var l=0;l<s.length;l++){var h=i instanceof Array?i[l]:i;n=n.replace(s[l],h)}return n},t.prototype.createErrorElement=function(i,r,n){var s=(0,a.az)(this.errorElement,{className:this.errorClass,innerHTML:r,attrs:{for:i}});if(this.errorOption===gh.Message&&(s.classList.remove(this.errorClass),s.classList.add("e-message"),s=(0,a.az)(this.errorContainer,{className:this.errorClass,innerHTML:s.outerHTML})),s.id=this.inputElement.name+"-info",this.element.querySelector('[data-valmsg-for="'+n.id+'"]'))this.element.querySelector('[data-valmsg-for="'+n.id+'"]').appendChild(s);else if(n.hasAttribute("data-msg-containerid")===!0){var l=n.getAttribute("data-msg-containerid"),h=(0,a.Ys)("#"+l,this.element);h.appendChild(s)}else this.customPlacement!=null?this.customPlacement.call(this,this.inputElement,s):this.inputElement.parentNode.insertBefore(s,this.inputElement.nextSibling);s.style.display="block",this.getErrorElement(i),this.validated.push(i),this.checkRequired(i)},t.prototype.getErrorElement=function(i){return this.infoElement=(0,a.Ys)(this.errorElement+"."+this.errorClass,this.inputElement.parentElement),this.infoElement||(this.infoElement=(0,a.Ys)(this.errorElement+"."+this.errorClass+'[for="'+i+'"]',this.element)),this.infoElement},t.prototype.removeErrorRules=function(i){for(var r=0;r<this.errorRules.length;r++){var n=this.errorRules[r];n.name===i&&this.errorRules.splice(r,1)}},t.prototype.showMessage=function(i){this.infoElement.style.display="block",this.infoElement.innerHTML=i.message,this.checkRequired(i.name)},t.prototype.hideMessage=function(i){this.infoElement&&(this.infoElement.style.display="none",this.removeErrorRules(i),this.inputElement.classList.add(this.validClass),this.inputElement.classList.remove(this.errorClass),this.inputElement.setAttribute("aria-invalid","false"))},t.prototype.checkRequired=function(i){!this.rules[i][this.required]&&!this.inputElement.value.length&&!(0,a.le)(this.infoElement)&&(this.infoElement.innerHTML=this.inputElement.value,this.infoElement.setAttribute("aria-invalid","false"),this.hideMessage(i))},t.isCheckable=function(i){var r=i.getAttribute("type");return r&&(r==="checkbox"||r==="radio"||r==="submit")};var e;return t.checkValidator={required:function(i){return isNaN(Date.parse(i.value))?i.value.toString().length>0:!isNaN(new Date(i.value).getTime())},email:function(i){return ja.EMAIL.test(i.value)},url:function(i){return ja.URL.test(i.value)},dateIso:function(i){return ja.DATE_ISO.test(i.value)},tel:function(i){return ja.PHONE.test(i.value)},creditcard:function(i){return ja.CREDITCARD.test(i.value)},number:function(i){return!isNaN(Number(i.value))&&i.value.indexOf(" ")===-1},digits:function(i){return ja.DIGITS.test(i.value)},maxLength:function(i){return i.value.length<=i.param},minLength:function(i){return i.value.length>=i.param},rangeLength:function(i){var r=i.param;return i.value.length>=r[0]&&i.value.length<=r[1]},range:function(i){var r=i.param;return!isNaN(Number(i.value))&&Number(i.value)>=r[0]&&Number(i.value)<=r[1]},date:function(i){return!isNaN(new Date(i.value).getTime())},max:function(i){return isNaN(Number(i.value))?new Date(i.value).getTime()<=new Date(JSON.parse(JSON.stringify(i.param))).getTime():+i.value<=i.param},min:function(i){if(isNaN(Number(i.value)))if(i.value.indexOf(",")!==-1){var r=i.value.replace(/,/g,"");return parseFloat(r)>=i.param}else return new Date(i.value).getTime()>=new Date(JSON.parse(JSON.stringify(i.param))).getTime();else return+i.value>=i.param},regex:function(i){return new RegExp(i.param).test(i.value)},equalTo:function(i){var r=i.formElement.querySelector("#"+i.param);return i.param=r.value,i.param===i.value}},ar([(0,a.Z9)("")],t.prototype,"locale",void 0),ar([(0,a.Z9)("e-hidden")],t.prototype,"ignore",void 0),ar([(0,a.Z9)()],t.prototype,"rules",void 0),ar([(0,a.Z9)("e-error")],t.prototype,"errorClass",void 0),ar([(0,a.Z9)("e-valid")],t.prototype,"validClass",void 0),ar([(0,a.Z9)("label")],t.prototype,"errorElement",void 0),ar([(0,a.Z9)("div")],t.prototype,"errorContainer",void 0),ar([(0,a.Z9)(gh.Label)],t.prototype,"errorOption",void 0),ar([(0,a.ju)()],t.prototype,"focusout",void 0),ar([(0,a.ju)()],t.prototype,"keyup",void 0),ar([(0,a.ju)()],t.prototype,"click",void 0),ar([(0,a.ju)()],t.prototype,"change",void 0),ar([(0,a.ju)()],t.prototype,"submit",void 0),ar([(0,a.ju)()],t.prototype,"validationBegin",void 0),ar([(0,a.ju)()],t.prototype,"validationComplete",void 0),ar([(0,a.ju)()],t.prototype,"customPlacement",void 0),t=e=ar([a.Zl],t),t}(a.XY),Ib=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),jr=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Wu="e-check",hv="e-checkbox-disabled",qo="e-frame",Uu="e-stop",qu="e-label",yh="e-ripple-container",Zu="e-ripple-check",Yu="e-ripple-stop",Gu="e-rtl",Ku="e-checkbox-wrapper",Db=["title","class","style","disabled","readonly","name","value"],Yn=function(o){Ib(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.isFocused=!1,r.isMouseClick=!1,r.clickTriggered=!1,r.validCheck=!0,r}return t.prototype.changeState=function(e){var i,r,n=this.getWrapper().getElementsByClassName(qo)[0];a.re&&(r=this.getWrapper().getElementsByClassName(yh)[0]),e==="check"?(n.classList.remove(Uu),n.classList.add(Wu),r&&(r.classList.remove(Yu),r.classList.add(Zu)),i="true",this.element.checked=!0,this.element.required&&this.validCheck?(this.element.checked=!1,this.validCheck=!1):this.element.required&&(this.validCheck=!0)):e==="uncheck"?((0,a.IV)([n],[Wu,Uu]),r&&(0,a.IV)([r],[Zu,Yu]),i="false",this.element.checked=!1,this.element.required&&this.validCheck?(this.element.checked=!0,this.validCheck=!1):this.element.required&&(this.validCheck=!0)):(n.classList.remove(Wu),n.classList.add(Uu),r&&(r.classList.remove(Zu),r.classList.add(Yu)),i="mixed",this.element.indeterminate=!0)},t.prototype.clickHandler=function(e){if(e.target.tagName==="INPUT"&&this.clickTriggered){this.clickTriggered=!1;return}(e.target.tagName==="SPAN"||e.target.tagName==="LABEL")&&(this.clickTriggered=!0),this.isMouseClick&&(this.focusOutHandler(),this.isMouseClick=!1),this.indeterminate?(this.changeState(this.checked?"check":"uncheck"),this.indeterminate=!1,this.element.indeterminate=!1):this.checked?(this.changeState("uncheck"),this.checked=!1):(this.changeState("check"),this.checked=!0);var i={checked:this.updateVueArrayModel(!1),event:e};this.trigger("change",i),e.stopPropagation()},t.prototype.destroy=function(){var e=this,i=this.getWrapper();o.prototype.destroy.call(this),this.wrapper&&(i=this.wrapper,this.disabled||this.unWireEvents(),this.tagName==="INPUT"?(this.getWrapper()&&i.parentNode&&i.parentNode.insertBefore(this.element,i),(0,a.og)(i),this.element.checked=!1,this.indeterminate&&(this.element.indeterminate=!1),["name","value","disabled"].forEach(function(r){e.element.removeAttribute(r)})):(["class"].forEach(function(r){i.removeAttribute(r)}),i.innerHTML=""))},t.prototype.focusHandler=function(){this.isFocused=!0},t.prototype.focusOutHandler=function(){var e=this.getWrapper();e&&e.classList.remove("e-focus"),this.isFocused=!1},t.prototype.getModuleName=function(){return"checkbox"},t.prototype.getPersistData=function(){return this.addOnPersist(["checked","indeterminate"])},t.prototype.getWrapper=function(){return this.element&&this.element.parentElement?this.element.parentElement.parentElement:null},t.prototype.initialize=function(){(0,a.le)(this.initialCheckedValue)&&(this.initialCheckedValue=this.checked),this.name&&this.element.setAttribute("name",this.name),this.value&&(this.element.setAttribute("value",this.value),this.isVue&&typeof this.value=="boolean"&&this.value===!0&&this.setProperties({checked:!0},!0)),this.checked&&this.changeState("check"),this.indeterminate&&this.changeState(),this.disabled&&this.setDisabled()},t.prototype.initWrapper=function(){var e=this.element.parentElement;e.classList.contains(Ku)||(e=this.createElement("div",{className:Ku}),this.element.parentNode.insertBefore(e,this.element));var i=this.createElement("label",{attrs:{for:this.element.id}}),r=this.createElement("span",{className:"e-icons "+qo});if(e.classList.add("e-wrapper"),this.enableRtl&&e.classList.add(Gu),this.cssClass&&(0,a.cn)([e],this.cssClass.split(" ")),e.appendChild(i),i.appendChild(this.element),po(this,i),i.appendChild(r),a.re){var n=this.createElement("span",{className:yh});this.labelPosition==="Before"?i.appendChild(n):i.insertBefore(n,r),(0,a.qx)(n,{duration:400,isCenterRipple:!0})}this.label&&this.setText(this.label)},t.prototype.keyUpHandler=function(){this.isFocused&&this.getWrapper().classList.add("e-focus")},t.prototype.labelMouseDownHandler=function(e){this.isMouseClick=!0;var i=this.getWrapper().getElementsByClassName(yh)[0];ls(e,i)},t.prototype.labelMouseUpHandler=function(e){this.isMouseClick=!0;var i=this.getWrapper().getElementsByClassName(yh)[0];if(i){for(var r=i.querySelectorAll(".e-ripple-element"),n=0;n<r.length-1;n++)i.removeChild(i.childNodes[n]);ls(e,i)}},t.prototype.onPropertyChanged=function(e,i){for(var r=this.getWrapper(),n=0,s=Object.keys(e);n<s.length;n++){var l=s[n];switch(l){case"checked":this.indeterminate=!1,this.element.indeterminate=!1,this.changeState(e.checked?"check":"uncheck");break;case"indeterminate":e.indeterminate?this.changeState():(this.element.indeterminate=!1,this.changeState(this.checked?"check":"uncheck"));break;case"disabled":e.disabled?(this.setDisabled(),this.wrapper=this.getWrapper(),this.unWireEvents()):(this.element.disabled=!1,r.classList.remove(hv),r.setAttribute("aria-disabled","false"),this.wireEvents());break;case"cssClass":i.cssClass&&(0,a.IV)([r],i.cssClass.split(" ")),e.cssClass&&(0,a.cn)([r],e.cssClass.split(" "));break;case"enableRtl":e.enableRtl?r.classList.add(Gu):r.classList.remove(Gu);break;case"label":this.setText(e.label);break;case"labelPosition":{var h=r.getElementsByClassName(qu)[0],c=r.getElementsByTagName("label")[0];(0,a.og)(h),e.labelPosition==="After"?c.appendChild(h):c.insertBefore(h,r.getElementsByClassName(qo)[0]);break}case"name":this.element.setAttribute("name",e.name);break;case"value":if(this.isVue&&typeof e.value=="object")break;this.element.setAttribute("value",e.value);break;case"htmlAttributes":this.updateHtmlAttributeToWrapper();break}}},t.prototype.preRender=function(){var e=this.element;this.tagName=this.element.tagName,e=on(this.createElement,"EJS-CHECKBOX","checkbox",e,Ku,"checkbox"),this.element=e,this.element.getAttribute("type")!=="checkbox"&&this.element.setAttribute("type","checkbox"),this.element.id||(this.element.id=(0,a.QI)("e-"+this.getModuleName()))},t.prototype.render=function(){this.initWrapper(),this.initialize(),this.disabled||this.wireEvents(),this.updateHtmlAttributeToWrapper(),this.updateVueArrayModel(!0),this.renderComplete(),this.wrapper=this.getWrapper()},t.prototype.setDisabled=function(){var e=this.getWrapper();this.element.disabled=!0,e.classList.add(hv),e.setAttribute("aria-disabled","true")},t.prototype.setText=function(e){var i=this.getWrapper();if(!!i){var r=i.getElementsByClassName(qu)[0];if(r)r.textContent=e;else{e=this.enableHtmlSanitizer?a.pJ.sanitize(e):e,r=this.createElement("span",{className:qu,innerHTML:e});var n=i.getElementsByTagName("label")[0];this.labelPosition==="Before"?n.insertBefore(r,i.getElementsByClassName(qo)[0]):n.appendChild(r)}}},t.prototype.changeHandler=function(e){e.stopPropagation()},t.prototype.formResetHandler=function(){this.checked=this.initialCheckedValue,this.element.checked=this.initialCheckedValue},t.prototype.unWireEvents=function(){var e=this.wrapper;a.bi.remove(e,"click",this.clickHandler),a.bi.remove(this.element,"keyup",this.keyUpHandler),a.bi.remove(this.element,"focus",this.focusHandler),a.bi.remove(this.element,"focusout",this.focusOutHandler);var i=e.getElementsByTagName("label")[0];a.bi.remove(i,"mousedown",this.labelMouseDownHandler),a.bi.remove(i,"mouseup",this.labelMouseUpHandler);var r=(0,a.oq)(this.element,"form");r&&a.bi.remove(r,"reset",this.formResetHandler),this.tagName==="EJS-CHECKBOX"&&a.bi.remove(this.element,"change",this.changeHandler)},t.prototype.wireEvents=function(){var e=this.getWrapper();a.bi.add(e,"click",this.clickHandler,this),a.bi.add(this.element,"keyup",this.keyUpHandler,this),a.bi.add(this.element,"focus",this.focusHandler,this),a.bi.add(this.element,"focusout",this.focusOutHandler,this);var i=e.getElementsByTagName("label")[0];a.bi.add(i,"mousedown",this.labelMouseDownHandler,this),a.bi.add(i,"mouseup",this.labelMouseUpHandler,this);var r=(0,a.oq)(this.element,"form");r&&a.bi.add(r,"reset",this.formResetHandler,this),this.tagName==="EJS-CHECKBOX"&&a.bi.add(this.element,"change",this.changeHandler,this)},t.prototype.updateVueArrayModel=function(e){if(this.isVue&&typeof this.value=="object"){var i=this.element.value;if(i&&this.value)if(e)for(var r=0;r<this.value.length;r++)i===this.value[r]&&(this.changeState("check"),this.setProperties({checked:!0},!0));else{var n=this.value.indexOf(i);return this.checked?n<0&&this.value.push(i):n>-1&&this.value.splice(n,1),this.value}}return this.validCheck?this.element.checked:!this.element.checked},t.prototype.updateHtmlAttributeToWrapper=function(){if(!(0,a.le)(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(Db.indexOf(r)>-1){var n=this.getWrapper();if(r==="class")(0,a.cn)([n],this.htmlAttributes[r].split(" "));else if(r==="title")n.setAttribute(r,this.htmlAttributes[r]);else if(r==="style"){var s=this.getWrapper().getElementsByClassName(qo)[0];s.setAttribute(r,this.htmlAttributes[r])}else this.element.setAttribute(r,this.htmlAttributes[r])}}},t.prototype.click=function(){this.element.click()},t.prototype.focusIn=function(){this.element.focus()},jr([(0,a.ju)()],t.prototype,"change",void 0),jr([(0,a.ju)()],t.prototype,"created",void 0),jr([(0,a.Z9)(!1)],t.prototype,"checked",void 0),jr([(0,a.Z9)("")],t.prototype,"cssClass",void 0),jr([(0,a.Z9)(!1)],t.prototype,"disabled",void 0),jr([(0,a.Z9)(!1)],t.prototype,"indeterminate",void 0),jr([(0,a.Z9)("")],t.prototype,"label",void 0),jr([(0,a.Z9)("After")],t.prototype,"labelPosition",void 0),jr([(0,a.Z9)("")],t.prototype,"name",void 0),jr([(0,a.Z9)("")],t.prototype,"value",void 0),jr([(0,a.Z9)(!1)],t.prototype,"enableHtmlSanitizer",void 0),jr([(0,a.Z9)({})],t.prototype,"htmlAttributes",void 0),t=jr([a.Zl],t),t}(a.wA),Tn="",Xu="",Gn=[],Ob="e-active",bh="";function Rb(o,t,e,i,r){Tn+=String.fromCharCode(o),setTimeout(function(){Tn=""},1e3);var n;if(Tn=i?Tn.toLowerCase():Tn,bh===r&&Xu===Tn){for(var s=0;s<Gn.length;s++)if(Gn[s].classList.contains(Ob)){n=s;break}return n=n+1,Gn[n]?Gn[n]:Gn[0]}else{var l=t,h=Tn.length,c=void 0,u=void 0;e=e?e+1:0;var s=e;Gn=[];do s===l.length&&(s=-1),s===-1?n=0:n=s,u=l[n],c=i?u.innerText.toLowerCase():u.innerText,c.substr(0,h)===Tn&&Gn.push(l[n]),s++;while(s!==e);return Xu=Tn,bh=r,Gn[0]}}function Ch(o,t,e,i){var r=t;i=i!=null?i:!0;var n={item:null,index:null};if(o&&o.length){var s=o.length,l=i?o.toLocaleLowerCase():o;l=Mb(l);for(var h=0,c=r;h<c.length;h++){var u=c[h],p=(i?u.textContent.toLocaleLowerCase():u.textContent).replace(/^\s+|\s+$/g,"");if(e==="Equal"&&p===l||e==="StartsWith"&&p.substr(0,s)===l||e==="EndsWith"&&p.substr(p.length-l.length)===l||e==="Contains"&&new RegExp(l,"g").test(p))return n.item=u,n.index=h,{item:u,index:h}}return n}return n}function Mb(o){return o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Pb(o){bh===o&&(bh="",Xu="",Tn="",Gn=[])}var vn=ae(30620),cv=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),mi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},uv=function(o){cv(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return mi([(0,a.Z9)()],t.prototype,"text",void 0),mi([(0,a.Z9)()],t.prototype,"value",void 0),mi([(0,a.Z9)()],t.prototype,"iconCss",void 0),mi([(0,a.Z9)()],t.prototype,"groupBy",void 0),mi([(0,a.Z9)()],t.prototype,"htmlAttributes",void 0),t}(a.rt),At={root:"e-dropdownbase",rtl:"e-rtl",content:"e-content",selected:"e-active",hover:"e-hover",noData:"e-nodata",fixedHead:"e-fixed-head",focus:"e-item-focus",li:"e-list-item",group:"e-list-group-item",disabled:"e-disabled",grouping:"e-dd-group"},Nb="ItemTemplate",Bb="ValueTemplate",Fb="GroupTemplate",Hb="HeaderTemplate",Vb="FooterTemplate",zb="NoRecordsTemplate",_b="ActionFailureTemplate",jb="e-hide-group-header",Wb=function(o){cv(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.preventChange=!1,r.isAngular=!1,r.isPreventChange=!1,r.isDynamicDataChange=!1,r}return t.prototype.getPropObject=function(e,i,r){var n=new Object,s=new Object,l=function(c){return c};n[l(e)]=i[l(e)],s[l(e)]=r[l(e)];var h=new Object;return h.newProperty=n,h.oldProperty=s,h},t.prototype.getValueByText=function(e,i,r){var n=null;return(0,a.le)(this.listData)||(i?n=this.checkValueCase(e,!0,r):n=this.checkValueCase(e,!1,r)),n},t.prototype.checkValueCase=function(e,i,r,n){var s=this,l=null;n&&(l=e);var h=this.listData,c=this.fields,u=this.typeOfData(h).typeof;if(u==="string"||u==="number"||u==="boolean")for(var p=0,f=h;p<f.length;p++){var g=f[p];(0,a.le)(g)||(r?l=this.checkingAccent(String(g),e,i):i?this.checkIgnoreCase(String(g),e)&&(l=this.getItemValue(String(g),e,i)):this.checkNonIgnoreCase(String(g),e)&&(l=this.getItemValue(String(g),e,i,n)))}else if(i)h.filter(function(L){var D=(0,a.NA)(c.value,L);!(0,a.le)(D)&&s.checkIgnoreCase((0,a.NA)(c.text,L).toString(),e)&&(l=(0,a.NA)(c.value,L))});else if(n){var C=null;C=l,h.filter(function(L){var D=(0,a.NA)(c.value,L);!(0,a.le)(D)&&!(0,a.le)(l)&&D.toString()===C.toString()&&(l=(0,a.NA)(c.text,L))})}else h.filter(function(L){s.checkNonIgnoreCase((0,a.NA)(c.text,L),e)&&(l=(0,a.NA)(c.value,L))});return l},t.prototype.checkingAccent=function(e,i,r){var n=vn.j.ignoreDiacritics(String(e)),s=vn.j.ignoreDiacritics(i.toString()),l=null;return r?this.checkIgnoreCase(n,s)&&(l=this.getItemValue(String(e),i,r)):this.checkNonIgnoreCase(String(e),i)&&(l=this.getItemValue(String(e),i,r)),l},t.prototype.checkIgnoreCase=function(e,i){return String(e).toLowerCase()===i.toString().toLowerCase()},t.prototype.checkNonIgnoreCase=function(e,i){return String(e)===i.toString()},t.prototype.getItemValue=function(e,i,r,n){var s=null,l=this.listData,h=this.typeOfData(l).typeof;return n?s=e.toString():r?s=h==="string"?String(e):this.getFormattedValue(String(e)):s=h==="string"?i:this.getFormattedValue(i),s},t.prototype.templateCompiler=function(e){var i=!1;if(e)try{i=!!(0,a.td)(e,document).length}catch(r){i=!1}return i},t.prototype.l10nUpdate=function(e){var i=this.getModuleName()==="listbox"?this.ulElement:this.list;if(this.noRecordsTemplate!=="No records found"||this.actionFailureTemplate!=="Request failed"){var r=e?this.actionFailureTemplate:this.noRecordsTemplate,n=void 0,s=e?this.actionFailureTemplateId:this.noRecordsTemplateId;i.innerHTML="";var l=this.templateCompiler(r);l?n=(0,a.MY)((0,a.Ys)(r,document).innerHTML.trim()):n=(0,a.MY)(r);var h=e?"actionFailureTemplate":"noRecordsTemplate",c=n({},this,h,s,this.isStringTemplate,null,i);if(c&&c.length>0)for(var u=0;u<c.length;u++)i.appendChild(c[u]);this.renderReactTemplates()}else{var p={noRecordsTemplate:"No records found",actionFailureTemplate:"Request failed"},f=new a.E7(this.getLocaleName(),{},this.locale);f.getConstant("actionFailureTemplate")!==""?this.l10n=f:this.l10n=new a.E7(this.getModuleName()==="listbox"?"listbox":"dropdowns",p,this.locale);var g=e?this.l10n.getConstant("actionFailureTemplate"):this.l10n.getConstant("noRecordsTemplate");if(this.getModuleName()==="listbox"){var C=this.createElement("li");C.textContent=g,i.appendChild(C),C.classList.add("e-list-nrt")}else i.innerHTML=g}},t.prototype.getLocaleName=function(){return"drop-down-base"},t.prototype.getTextByValue=function(e){var i=this.checkValueCase(e,!1,!1,!0);return i},t.prototype.getFormattedValue=function(e){if(this.listData&&this.listData.length){var i=this.typeOfData(this.listData);if(typeof(0,a.NA)(this.fields.value?this.fields.value:"value",i.item)=="number"||i.typeof==="number")return parseFloat(e);if(typeof(0,a.NA)(this.fields.value?this.fields.value:"value",i.item)=="boolean"||i.typeof==="boolean")return e==="true"||""+e=="true"}return e},t.prototype.setEnableRtl=function(){this.list&&this.enableRtlElements.push(this.list),this.enableRtl?(0,a.cn)(this.enableRtlElements,At.rtl):(0,a.IV)(this.enableRtlElements,At.rtl)},t.prototype.initialize=function(){if(this.bindEvent=!0,this.actionFailureTemplateId=""+this.element.id+_b,this.element.tagName==="UL"){var e=Mt.createJsonFromElement(this.element);this.setProperties({fields:{text:"text",value:"text"}},!0),this.resetList(e,this.fields)}else if(this.element.tagName==="SELECT"){var i=this.dataSource instanceof Array?this.dataSource.length>0:!(0,a.le)(this.dataSource);i?this.isDynamicDataChange&&this.setListData(this.dataSource,this.fields,this.query):this.renderItemsBySelect()}else this.setListData(this.dataSource,this.fields,this.query)},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.setEnabled=function(){this.element.setAttribute("aria-disabled",this.enabled?"false":"true")},t.prototype.updateDataAttribute=function(e){for(var i=["class","style","id","type"],r={},n=0;n<this.element.attributes.length;n++)i.indexOf(this.element.attributes[n].name)===-1&&!(this.getModuleName()==="dropdownlist"&&this.element.attributes[n].name==="readonly")&&(r[this.element.attributes[n].name]=this.element.getAttribute(this.element.attributes[n].name));(0,a.l7)(r,e,r),this.setProperties({htmlAttributes:r},!0)},t.prototype.renderItemsBySelect=function(){var e=this.element,i={value:"value",text:"text"},r=[],n=e.querySelectorAll("select>optgroup"),s=e.querySelectorAll("select>option");if(this.getJSONfromOption(r,s,i),n.length){for(var l=0;l<n.length;l++){var h=n[l],c={};c[i.text]=h.label,c.isHeader=!0;var u=h.querySelectorAll("option");r.push(c),this.getJSONfromOption(r,u,i)}e.querySelectorAll("select>option")}this.updateFields(i.text,i.value,this.fields.groupBy,this.fields.htmlAttributes,this.fields.iconCss),this.resetList(r,i)},t.prototype.updateFields=function(e,i,r,n,s){var l={fields:{text:e,value:i,groupBy:(0,a.le)(r)?this.fields&&this.fields.groupBy:r,htmlAttributes:(0,a.le)(n)?this.fields&&this.fields.htmlAttributes:n,iconCss:(0,a.le)(s)?this.fields&&this.fields.iconCss:s}};this.setProperties(l,!0)},t.prototype.getJSONfromOption=function(e,i,r){for(var n=0,s=i;n<s.length;n++){var l=s[n],h={};h[r.text]=l.innerText,h[r.value]=(0,a.le)(l.getAttribute(r.value))?l.innerText:l.getAttribute(r.value),e.push(h)}},t.prototype.preRender=function(){this.scrollTimer=-1,this.enableRtlElements=[],this.isRequested=!1,this.isDataFetched=!1,this.itemTemplateId=""+this.element.id+Nb,this.valueTemplateId=""+this.element.id+Bb,this.groupTemplateId=""+this.element.id+Fb,this.headerTemplateId=""+this.element.id+Hb,this.footerTemplateId=""+this.element.id+Vb,this.noRecordsTemplateId=""+this.element.id+zb},t.prototype.setListData=function(e,i,r){var n=this;i=i||this.fields;var s;this.isActive=!0;var l={cancel:!1,data:e,query:r};this.isPreventChange=this.isAngular&&this.preventChange?!0:this.isPreventChange,this.trigger("actionBegin",l,function(h){if(!h.cancel)if(n.showSpinner(),e instanceof Oe.h){if(n.isRequested=!0,n.isDataFetched){n.emptyDataRequest(i);return}h.data.executeQuery(n.getQuery(h.query)).then(function(f){n.isPreventChange=n.isAngular&&n.preventChange?!0:n.isPreventChange,n.trigger("actionComplete",f,function(g){if(!g.cancel){var C=g.result;C.length===0&&(n.isDataFetched=!0),s=n.renderItems(C,i),n.groupTemplate&&n.renderGroupTemplate(s),n.onActionComplete(s,C,g),n.isRequested=!1,n.bindChildItems(C,s,i,g)}})}).catch(function(f){n.isRequested=!1,n.onActionFailure(f),n.hideSpinner()})}else{var c=new Oe.h(h.data),u=n.getQuery(h.query).executeLocal(c),p={cancel:!1,result:u};n.isPreventChange=n.isAngular&&n.preventChange?!0:n.isPreventChange,n.trigger("actionComplete",p,function(f){f.cancel||(s=n.renderItems(f.result,i),n.onActionComplete(s,f.result),n.groupTemplate&&n.renderGroupTemplate(s),n.bindChildItems(f.result,s,i),setTimeout(function(){n.getModuleName()==="multiselect"&&n.itemTemplate!=null&&s.childElementCount>0&&(s.children[0].childElementCount>0||n.fields.groupBy&&s.children[1]&&s.children[1].childElementCount>0)&&n.updateDataList()}))})}})},t.prototype.bindChildItems=function(e,i,r,n){var s=this;e.length>=100&&this.getModuleName()==="autocomplete"?setTimeout(function(){var l=s.remainingItems(s.sortedData,r);(0,a.R3)(l,i),s.liCollections=s.list.querySelectorAll("."+At.li),s.updateListValues(),s.raiseDataBound(e,n)},0):this.raiseDataBound(e,n)},t.prototype.updateListValues=function(){},t.prototype.findListElement=function(e,i,r,n){var s=null;if(e){for(var l=[].slice.call(e.querySelectorAll(i)),h=0;h<l.length;h++)if(l[h].getAttribute(r)===n+""){s=l[h];break}}return s},t.prototype.raiseDataBound=function(e,i){this.hideSpinner();var r={items:e,e:i};this.trigger("dataBound",r)},t.prototype.remainingItems=function(e,i){var r=new Oe.h(e).executeLocal(new yt.A().skip(100));if(this.itemTemplate){var n=this.templateListItem(r,i);return[].slice.call(n.childNodes)}var s=this.typeOfData(r).typeof;return s==="string"||s==="number"||s==="boolean"?Mt.createListItemFromArray(this.createElement,r,!0,this.listOption(r,i),this):Mt.createListItemFromJson(this.createElement,r,this.listOption(r,i),1,!0,this)},t.prototype.emptyDataRequest=function(e){var i=[];this.onActionComplete(this.renderItems(i,e),i),this.isRequested=!1,this.hideSpinner()},t.prototype.showSpinner=function(){},t.prototype.hideSpinner=function(){},t.prototype.onActionFailure=function(e){this.liCollections=[],this.trigger("actionFailure",e),this.l10nUpdate(!0),(0,a.cn)([this.list],At.noData)},t.prototype.onActionComplete=function(e,i,r){if(this.listData=i,this.isReact&&this.clearTemplate(["itemTemplate","groupTemplate","actionFailureTemplate","noRecordsTemplate"]),this.fixedHeaderElement=(0,a.le)(this.fixedHeaderElement)?this.fixedHeaderElement:null,this.getModuleName()==="multiselect"&&this.properties.allowCustomValue&&this.fields.groupBy)for(var n=0;n<e.childElementCount;n++)e.children[n].classList.contains("e-list-group-item")&&((0,a.le)(e.children[n].innerHTML)||e.children[n].innerHTML==="")&&(0,a.cn)([e.children[n]],jb);(0,a.le)(this.list)||(this.list.innerHTML="",this.list.appendChild(e),this.liCollections=this.list.querySelectorAll("."+At.li),this.ulElement=this.list.querySelector("ul"),this.postRender(this.list,i,this.bindEvent))},t.prototype.postRender=function(e,i,r){var n=e.querySelector("."+At.li),s=e.querySelector("."+At.selected);n&&!s&&n.classList.add(At.focus),i.length<=0?(this.l10nUpdate(),(0,a.cn)([e],At.noData)):e.classList.remove(At.noData)},t.prototype.getQuery=function(e){return e||(this.query?this.query:new yt.A)},t.prototype.renderGroupTemplate=function(e){if(this.fields.groupBy!==null&&this.dataSource||this.element.querySelector("."+At.group)){var i=this.dataSource,r={groupTemplateID:this.groupTemplateId,isStringTemplate:this.isStringTemplate},n=e.querySelectorAll("."+At.group),s=this.templateCompiler(this.groupTemplate);if(s){var l=(0,a.Ys)(this.groupTemplate,document).innerHTML.trim(),h=Mt.renderGroupTemplate(l,i,this.fields.properties,n,r,this);if(this.isGroupChecking)for(var c=0;c<h.length;c++)this.notify("addItem",{module:"CheckBoxSelection",item:h[c]})}else{var h=Mt.renderGroupTemplate(this.groupTemplate,i,this.fields.properties,n,r,this);if(this.isGroupChecking)for(var c=0;c<h.length;c++)this.notify("addItem",{module:"CheckBoxSelection",item:h[c]})}this.renderReactTemplates()}},t.prototype.createListItems=function(e,i){e&&i.groupBy||this.element.querySelector("optgroup")?(i.groupBy&&(this.sortOrder!=="None"&&(e=this.getSortedDataSource(e)),e=Mt.groupDataSource(e,i.properties,this.sortOrder)),(0,a.cn)([this.list],At.grouping)):e=this.getSortedDataSource(e);var r=this.listOption(e,i),n=e.length>100?new Oe.h(e).executeLocal(new yt.A().take(100)):e;return this.sortedData=e,Mt.createList(this.createElement,this.getModuleName()==="autocomplete"?n:e,r,!0,this)},t.prototype.listOption=function(e,i){var r=!(0,a.le)(i.iconCss),n=(0,a.le)(i.properties)?i:i.properties,s=i.text!==null||i.value!==null?{fields:n,showIcon:r,ariaAttributes:{groupItemRole:"presentation"}}:{fields:{value:"text"}};return(0,a.l7)({},s,i,!0)},t.prototype.setFloatingHeader=function(e){(0,a.le)(this.fixedHeaderElement)&&(this.fixedHeaderElement=this.createElement("div",{className:At.fixedHead}),this.list.querySelector("li").classList.contains(At.group)||(this.fixedHeaderElement.style.display="none"),(0,a.Ce)([this.fixedHeaderElement],this.list),this.setFixedHeader()),!(0,a.le)(this.fixedHeaderElement)&&this.fixedHeaderElement.style.zIndex==="0"&&this.setFixedHeader(),this.scrollStop(e)},t.prototype.scrollStop=function(e){for(var i=(0,a.le)(e)?this.list:e.target,r=parseInt(getComputedStyle(this.getValidLi(),null).getPropertyValue("height"),10),n=Math.round(i.scrollTop/r),s=this.list.querySelectorAll("li:not(.e-hide-listitem)"),l=n;l>-1;l--)if(!(0,a.le)(s[l])&&s[l].classList.contains(At.group)){var h=s[l];this.fixedHeaderElement.innerHTML=h.innerHTML,this.fixedHeaderElement.style.top=i.scrollTop+"px",this.fixedHeaderElement.style.display="block";break}else this.fixedHeaderElement.style.display="none",this.fixedHeaderElement.style.top="none"},t.prototype.getValidLi=function(){return this.liCollections[0]},t.prototype.renderItems=function(e,i){var r;if(this.itemTemplate&&e){var n=e;n&&i.groupBy?(this.sortOrder!=="None"&&(n=this.getSortedDataSource(n)),n=Mt.groupDataSource(n,i.properties,this.sortOrder)):n=this.getSortedDataSource(n),this.sortedData=n;var s=n.length>100?new Oe.h(n).executeLocal(new yt.A().take(100)):n;r=this.templateListItem(this.getModuleName()==="autocomplete"?s:n,i)}else r=this.createListItems(e,i);return r},t.prototype.templateListItem=function(e,i){var r=this.listOption(e,i);r.templateID=this.itemTemplateId,r.isStringTemplate=this.isStringTemplate;var n=this.templateCompiler(this.itemTemplate);if(n){var s=(0,a.Ys)(this.itemTemplate,document).innerHTML.trim();return Mt.renderContentTemplate(this.createElement,s,e,i.properties,r,this)}else return Mt.renderContentTemplate(this.createElement,this.itemTemplate,e,i.properties,r,this)},t.prototype.typeOfData=function(e){for(var i={typeof:null,item:null},r=0;!(0,a.le)(e)&&r<e.length;r++)if(!(0,a.le)(e[r])){var n=typeof e[r]=="string"||typeof e[r]=="number"||typeof e[r]=="boolean",s=n?(0,a.le)(e[r]):(0,a.le)((0,a.NA)(this.fields.value?this.fields.value:"value",e[r]));if(!s)return i={typeof:typeof e[r],item:e[r]}}return i},t.prototype.setFixedHeader=function(){this.list.parentElement.style.display="block";var e=0;if(this.list&&this.list.parentElement&&(e=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-width"),10),isNaN(e))){var i=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-top-width"),10),r=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-bottom-width"),10),n=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-left-width"),10),s=parseInt(document.defaultView.getComputedStyle(this.list.parentElement,null).getPropertyValue("border-right-width"),10);e=i+r+n+s}var l=this.getValidLi().offsetWidth-e;this.fixedHeaderElement.style.width=l.toString()+"px",(0,a.V7)(this.fixedHeaderElement,{zIndex:10});var h=this.ulElement.querySelector("."+At.group+":not(.e-hide-listitem)");this.fixedHeaderElement.innerHTML=h.innerHTML},t.prototype.getSortedDataSource=function(e){if(e&&this.sortOrder!=="None"){var i=this.fields.text?this.fields.text:"text";(this.typeOfData(e).typeof==="string"||this.typeOfData(e).typeof==="number"||this.typeOfData(e).typeof==="boolean")&&(i=""),e=Mt.getDataSource(e,Mt.addSorting(this.sortOrder,i))}return e},t.prototype.getIndexByValue=function(e){for(var i,r=this.getItems(),n=0;n<r.length;n++)if(!(0,a.le)(e)&&r[n].getAttribute("data-value")===e.toString()){i=n;break}return i},t.prototype.dispatchEvent=function(e,i){var r=document.createEvent("HTMLEvents");r.initEvent(i,!1,!0),e.dispatchEvent(r)},t.prototype.setFields=function(){this.fields.value&&!this.fields.text?this.updateFields(this.fields.value,this.fields.value):!this.fields.value&&this.fields.text?this.updateFields(this.fields.text,this.fields.text):!this.fields.value&&!this.fields.text&&this.updateFields("text","text")},t.prototype.resetList=function(e,i,r){if(this.list){if(this.element.tagName==="SELECT"&&this.element.options.length>0||this.element.tagName==="UL"&&this.element.childNodes.length>0){var n=e instanceof Array?e.length>0:!(0,a.le)(e);!n&&this.selectData&&this.selectData.length>0&&(e=this.selectData)}e=this.getModuleName()==="combobox"&&this.selectData&&e instanceof Array&&e.length<this.selectData.length?this.selectData:e,this.setListData(e,i,r)}},t.prototype.updateSelectElementData=function(e){e&&(0,a.le)(this.selectData)&&this.listData&&this.listData.length>0&&(this.selectData=this.listData)},t.prototype.updateSelection=function(){},t.prototype.renderList=function(){this.render()},t.prototype.updateDataSource=function(e){this.resetList(this.dataSource)},t.prototype.setUpdateInitial=function(e,i){this.isDataFetched=!1;for(var r={},n=0;e.length>n;n++)i[e[n]]&&e[n]==="fields"?(this.setFields(),r[e[n]]=i[e[n]]):i[e[n]]&&(r[e[n]]=i[e[n]]);Object.keys(r).length>0&&(Object.keys(r).indexOf("dataSource")===-1&&(r.dataSource=this.dataSource),this.updateDataSource(r))},t.prototype.onPropertyChanged=function(e,i){this.getModuleName()==="dropdownbase"&&this.setUpdateInitial(["fields","query","dataSource"],e),this.setUpdateInitial(["sortOrder","itemTemplate"],e);for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"query":case"sortOrder":case"dataSource":case"itemTemplate":break;case"enableRtl":this.setEnableRtl();break;case"enabled":this.setEnabled();break;case"groupTemplate":if(this.renderGroupTemplate(this.list),this.ulElement&&this.fixedHeaderElement){var l=this.ulElement.querySelector("."+At.group);this.fixedHeaderElement.innerHTML=l.innerHTML}break;case"locale":this.list&&!(0,a.le)(this.liCollections)&&this.liCollections.length===0&&this.l10nUpdate();break;case"zIndex":this.setProperties({zIndex:e.zIndex},!0),this.setZIndex();break}}},t.prototype.render=function(e){this.list=this.createElement("div",{className:At.content,attrs:{tabindex:"0"}}),this.list.classList.add(At.root),this.setFields();var i={duration:300,selector:"."+At.li};this.rippleFun=(0,a.qx)(this.list,i);var r=this.element.querySelector("select>optgroup");if((this.fields.groupBy||!(0,a.le)(r))&&!this.isGroupChecking&&a.bi.add(this.list,"scroll",this.setFloatingHeader,this),this.getModuleName()==="dropdownbase"){this.element.getAttribute("tabindex")&&this.list.setAttribute("tabindex",this.element.getAttribute("tabindex")),(0,a.IV)([this.element],At.root),this.element.style.display="none";var n=this.createElement("div");this.element.parentElement.insertBefore(n,this.element),n.appendChild(this.element),n.appendChild(this.list)}this.setEnableRtl(),this.setEnabled(),e||this.initialize()},t.prototype.getModuleName=function(){return"dropdownbase"},t.prototype.getItems=function(){return this.ulElement.querySelectorAll("."+At.li)},t.prototype.addItem=function(e,i){if((!this.list||this.list.textContent===this.noRecordsTemplate&&this.getModuleName()!=="listbox")&&this.renderList(),this.sortOrder!=="None"&&(0,a.le)(i)){var r=[].slice.call(this.listData);r.push(e),r=this.getSortedDataSource(r),this.fields.groupBy&&(r=Mt.groupDataSource(r,this.fields.properties,this.sortOrder)),i=r.indexOf(e)}var n=this.getItems().length,s=this.list.querySelector("."+At.selected);e=e instanceof Array?e:[e];var l;l=(0,a.le)(i)||i<0||i>n-1?n:i;var h=this.fields;e&&h.groupBy&&(e=Mt.groupDataSource(e,h.properties));for(var c=[],u=0;u<e.length;u++){var p=e[u],f=p.isHeader,g=this.createElement("li",{className:f?At.group:At.li,id:"option-add-"+u}),C=p instanceof Object?(0,a.NA)(h.text,p):p;if(f&&(g.innerText=C),this.itemTemplate&&!f){var L=this.templateCompiler(this.itemTemplate),D=L?(0,a.MY)((0,a.Ys)(this.itemTemplate,document).innerHTML.trim()):(0,a.MY)(this.itemTemplate),R=D(p,this,"itemTemplate",this.itemTemplateId,this.isStringTemplate,null,g);R&&(0,a.R3)(R,g)}else f||g.appendChild(document.createTextNode(C));g.setAttribute("data-value",p instanceof Object?(0,a.NA)(h.value,p):p),g.setAttribute("role","option"),this.notify("addItem",{module:"CheckBoxSelection",item:g}),c.push(g),this.listData.push(p),this.sortOrder==="None"&&(0,a.le)(i)&&l===0&&(l=null),this.updateActionCompleteData(g,p,l),this.trigger("beforeItemRender",{element:g,item:p})}if(n===0&&(0,a.le)(this.list.querySelector("ul")))this.list.innerHTML="",this.list.classList.remove(At.noData),this.list.appendChild(this.ulElement),this.liCollections=c,(0,a.R3)(c,this.ulElement),this.updateAddItemList(this.list,n);else{this.getModuleName()==="listbox"&&n===0&&(this.ulElement.innerHTML="");for(var B=[],u=0;u<e.length;u++){for(var H=this.ulElement.querySelectorAll(".e-list-group-item"),j=0;j<H.length;j++)B[j]=H[j].innerText;if(B.indexOf(c[u].innerText)>-1&&h.groupBy){for(var j=0;j<H.length;j++)if(B[j]===c[u].innerText){this.sortOrder==="None"?this.ulElement.insertBefore(c[u+1],H[j+1]):this.ulElement.insertBefore(c[u+1],this.ulElement.childNodes[i]),u=u+1;break}}else this.liCollections[l]?this.liCollections[l].parentNode.insertBefore(c[u],this.liCollections[l]):this.ulElement.appendChild(c[u]);var W=[].slice.call(this.liCollections);W.splice(l,0,c[u]),this.liCollections=W,l+=1,this.getModuleName()==="multiselect"&&this.updateDataList()}}(s||i===0)&&this.updateSelection()},t.prototype.validationAttribute=function(e,i){var r=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("id");i.setAttribute("name",r),e.removeAttribute("name");for(var n=["required","aria-required","form"],s=0;s<n.length;s++)if(!!e.getAttribute(n[s])){var l=e.getAttribute(n[s]);i.setAttribute(n[s],l),e.removeAttribute(n[s])}},t.prototype.setZIndex=function(){},t.prototype.updateActionCompleteData=function(e,i,r){},t.prototype.updateAddItemList=function(e,i){},t.prototype.updateDataList=function(){},t.prototype.getDataByValue=function(e){if(!(0,a.le)(this.listData)){var i=this.typeOfData(this.listData).typeof;if(i==="string"||i==="number"||i==="boolean")for(var r=0,n=this.listData;r<n.length;r++){var s=n[r];if(!(0,a.le)(s)&&s===e)return s}else for(var l=0,h=this.listData;l<h.length;l++){var s=h[l];if(!(0,a.le)(s)&&(0,a.NA)(this.fields.value?this.fields.value:"value",s)===e)return s}}return null},t.prototype.destroy=function(){document.body.contains(this.list)&&(a.bi.remove(this.list,"scroll",this.setFloatingHeader),(0,a.le)(this.rippleFun)||this.rippleFun(),(0,a.og)(this.list)),o.prototype.destroy.call(this)},mi([(0,a.Zz)({text:null,value:null,iconCss:null,groupBy:null},uv)],t.prototype,"fields",void 0),mi([(0,a.Z9)(!1)],t.prototype,"enablePersistence",void 0),mi([(0,a.Z9)(null)],t.prototype,"itemTemplate",void 0),mi([(0,a.Z9)(null)],t.prototype,"groupTemplate",void 0),mi([(0,a.Z9)("No records found")],t.prototype,"noRecordsTemplate",void 0),mi([(0,a.Z9)("Request failed")],t.prototype,"actionFailureTemplate",void 0),mi([(0,a.Z9)("None")],t.prototype,"sortOrder",void 0),mi([(0,a.Z9)(!0)],t.prototype,"enabled",void 0),mi([(0,a.Z9)([])],t.prototype,"dataSource",void 0),mi([(0,a.Z9)(null)],t.prototype,"query",void 0),mi([(0,a.Z9)("StartsWith")],t.prototype,"filterType",void 0),mi([(0,a.Z9)(!0)],t.prototype,"ignoreCase",void 0),mi([(0,a.Z9)(1e3)],t.prototype,"zIndex",void 0),mi([(0,a.Z9)(!1)],t.prototype,"ignoreAccent",void 0),mi([(0,a.Z9)()],t.prototype,"locale",void 0),mi([(0,a.ju)()],t.prototype,"actionBegin",void 0),mi([(0,a.ju)()],t.prototype,"actionComplete",void 0),mi([(0,a.ju)()],t.prototype,"actionFailure",void 0),mi([(0,a.ju)()],t.prototype,"select",void 0),mi([(0,a.ju)()],t.prototype,"dataBound",void 0),mi([(0,a.ju)()],t.prototype,"created",void 0),mi([(0,a.ju)()],t.prototype,"destroyed",void 0),t=mi([a.Zl],t),t}(a.wA),Ub=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),xi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},mt={root:"e-dropdownlist",hover:At.hover,selected:At.selected,rtl:At.rtl,li:At.li,disable:At.disabled,base:At.root,focus:At.focus,input:"e-input-group",inputFocus:"e-input-focus",icon:"e-input-group-icon e-ddl-icon",iconAnimation:"e-icon-anim",value:"e-input-value",device:"e-ddl-device",backIcon:"e-input-group-icon e-back-icon e-icons",filterBarClearIcon:"e-input-group-icon e-clear-icon e-icons",filterInput:"e-input-filter",filterParent:"e-filter-parent",mobileFilter:"e-ddl-device-filter",footer:"e-ddl-footer",header:"e-ddl-header",clearIcon:"e-clear-icon",clearIconHide:"e-clear-icon-hide",popupFullScreen:"e-popup-full-page",disableIcon:"e-ddl-disable-icon",hiddenElement:"e-ddl-hidden"},qb={container:null,buttons:[]},mn=function(o){Ub(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.isListSearched=!1,r.preventChange=!1,r.isAngular=!1,r}return t.prototype.preRender=function(){this.valueTempElement=null,this.element.style.opacity="0",this.initializeData(),o.prototype.preRender.call(this),this.activeIndex=this.index,this.queryString=""},t.prototype.initializeData=function(){this.isPopupOpen=!1,this.isDocumentClick=!1,this.isInteracted=!1,this.isFilterFocus=!1,this.beforePopupOpen=!1,this.initial=!0,this.initRemoteRender=!1,this.isNotSearchList=!1,this.isTyped=!1,this.isSelected=!1,this.preventFocus=!1,this.preventAutoFill=!1,this.isValidKey=!1,this.typedString="",this.isEscapeKey=!1,this.isPreventBlur=!1,this.isTabKey=!1,this.actionCompleteData={isUpdated:!1},this.actionData={isUpdated:!1},this.prevSelectPoints={},this.isSelectCustom=!1,this.isDropDownClick=!1,this.preventAltUp=!1,this.isCustomFilter=!1,this.isSecondClick=!1,this.previousValue=null,this.keyConfigure={tab:"tab",enter:"13",escape:"27",end:"35",home:"36",down:"40",up:"38",pageUp:"33",pageDown:"34",open:"alt+40",close:"shift+tab",hide:"alt+38",space:"32"}},t.prototype.setZIndex=function(){this.popupObj&&this.popupObj.setProperties({zIndex:this.zIndex})},t.prototype.renderList=function(e){o.prototype.render.call(this,e),this.unWireListEvents(),this.wireListEvents()},t.prototype.floatLabelChange=function(){if(this.getModuleName()==="dropdownlist"&&this.floatLabelType==="Auto"){var e=this.inputWrapper.container.querySelector(".e-float-text");this.inputElement.value!==""||this.isInteracted?(0,a.s1)(e,["e-label-top"],["e-label-bottom"]):(0,a.s1)(e,["e-label-bottom"],["e-label-top"])}},t.prototype.resetHandler=function(e){e.preventDefault(),this.clearAll(e)},t.prototype.resetFocusElement=function(){if(this.removeHover(),this.removeSelection(),this.removeFocus(),this.list.scrollTop=0,this.getModuleName()!=="autocomplete"&&!(0,a.le)(this.ulElement)){var e=this.ulElement.querySelector("."+mt.li);e&&e.classList.add(mt.focus)}},t.prototype.clearAll=function(e,i){((0,a.le)(i)||!(0,a.le)(i)&&((0,a.le)(i.dataSource)||!(i.dataSource instanceof Oe.h)&&i.dataSource.length===0))&&(this.isActive=!0,this.resetSelection(i));var r=this.getItemData();this.previousValue!==r.value&&this.onChangeEvent(e)},t.prototype.resetSelection=function(e){this.list&&(!(0,a.le)(e)&&((0,a.le)(e.dataSource)||!(e.dataSource instanceof Oe.h)&&e.dataSource.length===0)?(this.selectedLI=null,this.actionCompleteData.isUpdated=!1,this.actionCompleteData.ulElement=null,this.actionCompleteData.list=null,this.resetList(e.dataSource)):(this.allowFiltering&&this.getModuleName()!=="autocomplete"&&!(0,a.le)(this.actionCompleteData.ulElement)&&!(0,a.le)(this.actionCompleteData.list)&&this.onActionComplete(this.actionCompleteData.ulElement.cloneNode(!0),this.actionCompleteData.list),this.resetFocusElement())),this.hiddenElement.innerHTML="",this.inputElement.value="",this.value=null,this.itemData=null,this.text=null,this.index=null,this.activeIndex=null,this.item=null,this.queryString="",this.valueTempElement&&((0,a.og)(this.valueTempElement),this.inputElement.style.display="block",this.valueTempElement=null),this.setSelection(null,null),this.isSelectCustom=!1,this.updateIconState(),this.cloneElements()},t.prototype.setHTMLAttributes=function(){if(Object.keys(this.htmlAttributes).length)for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(r==="class"){var n=this.htmlAttributes[r].replace(/\s+/g," ").trim();n!==""&&(0,a.cn)([this.inputWrapper.container],n.split(" "))}else if(r==="disabled"&&this.htmlAttributes[r]==="disabled")this.enabled=!1,this.setEnable();else if(r==="readonly"&&!(0,a.le)(this.htmlAttributes[r]))this.readonly=!0,this.dataBind();else if(r==="style")this.inputWrapper.container.setAttribute("style",this.htmlAttributes[r]);else{var s=["title","id","placeholder","aria-placeholder","role","autocorrect","autocomplete","autocapitalize","spellcheck","minlength","maxlength"],l=["name","required"];(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&s.push("tabindex"),l.indexOf(r)>-1||r.indexOf("data")===0?this.hiddenElement.setAttribute(r,this.htmlAttributes[r]):s.indexOf(r)>-1?r==="placeholder"?Ue.setPlaceholder(this.htmlAttributes[r],this.inputElement):this.inputElement.setAttribute(r,this.htmlAttributes[r]):this.inputWrapper.container.setAttribute(r,this.htmlAttributes[r])}}(this.getModuleName()==="autocomplete"||this.getModuleName()==="combobox")&&this.inputWrapper.container.removeAttribute("tabindex")},t.prototype.getAriaAttributes=function(){return{"aria-disabled":"false","aria-owns":this.element.id+"_options",role:"listbox","aria-haspopup":"true","aria-expanded":"false","aria-activedescendant":"null","aria-live":"polite","aria-labelledby":this.hiddenElement.id}},t.prototype.setEnableRtl=function(){Ue.setEnableRtl(this.enableRtl,[this.inputElement.parentElement]),this.popupObj&&(this.popupObj.enableRtl=this.enableRtl,this.popupObj.dataBind())},t.prototype.setEnable=function(){Ue.setEnabled(this.enabled,this.inputElement),this.enabled?((0,a.IV)([this.inputWrapper.container],mt.disable),this.inputElement.setAttribute("aria-disabled","false"),this.targetElement().setAttribute("tabindex",this.tabIndex)):(this.hidePopup(),(0,a.cn)([this.inputWrapper.container],mt.disable),this.inputElement.setAttribute("aria-disabled","true"),this.targetElement().tabIndex=-1)},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.getLocaleName=function(){return"drop-down-list"},t.prototype.preventTabIndex=function(e){this.getModuleName()==="dropdownlist"&&(e.tabIndex=-1)},t.prototype.targetElement=function(){return this.inputWrapper.container},t.prototype.getNgDirective=function(){return"EJS-DROPDOWNLIST"},t.prototype.getElementByText=function(e){return this.getElementByValue(this.getValueByText(e))},t.prototype.getElementByValue=function(e){for(var i,r=this.getItems(),n=0,s=r;n<s.length;n++){var l=s[n];if(this.getFormattedValue(l.getAttribute("data-value"))===e){i=l;break}}return i},t.prototype.initValue=function(){this.renderList(),this.dataSource instanceof Oe.h?this.initRemoteRender=!0:this.updateValues()},t.prototype.updateValues=function(){if(!(0,a.le)(this.value))this.setSelection(this.getElementByValue(this.value),null);else if(this.text&&(0,a.le)(this.value)){var e=this.getElementByText(this.text);if((0,a.le)(e)){this.setProperties({text:null});return}else this.setSelection(e,null)}else this.setSelection(this.liCollections[this.activeIndex],null);this.setHiddenValue(),Ue.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},t.prototype.onBlurHandler=function(e){if(!!this.enabled){var i=e.relatedTarget,r=e.target,n=this.isPreventBlur;if(this.isPreventBlur=!1,n&&!this.isDocumentClick&&this.isPopupOpen&&(!(0,a.le)(r)||!this.isFilterLayout()&&(0,a.le)(i))){this.getModuleName()==="dropdownlist"&&this.allowFiltering&&this.isPopupOpen?this.filterInput.focus():this.targetElement().focus();return}if(this.isDocumentClick||!(0,a.le)(this.popupObj)&&document.body.contains(this.popupObj.element)&&this.popupObj.element.classList.contains(mt.mobileFilter)){this.beforePopupOpen||(this.isDocumentClick=!1);return}(this.getModuleName()==="dropdownlist"&&!this.isFilterFocus&&i!==this.inputElement&&(document.activeElement!==i||document.activeElement===i&&r.classList.contains(mt.inputFocus))||(0,a.le)(i)&&this.getModuleName()==="dropdownlist"&&this.allowFiltering&&r!==this.inputWrapper.container||this.getModuleName()!=="dropdownlist"&&!this.inputWrapper.container.contains(i)||this.isTabKey)&&(this.isDocumentClick=!!this.isPopupOpen,this.focusOutAction(e),this.isTabKey=!1),this.isRequested&&!this.isPopupOpen&&!this.isPreventBlur&&(this.isActive=!1,this.beforePopupOpen=!1)}},t.prototype.focusOutAction=function(e){this.isInteracted=!1,this.focusOut(e),this.onFocusOut()},t.prototype.onFocusOut=function(){!this.enabled||(this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(null)),this.floatLabelChange(),this.dispatchEvent(this.hiddenElement,"change"),this.getModuleName()==="dropdownlist"&&this.element.tagName!=="INPUT"&&this.dispatchEvent(this.inputElement,"blur"),this.inputWrapper.clearButton&&(0,a.cn)([this.inputWrapper.clearButton],mt.clearIconHide),this.trigger("blur"))},t.prototype.onFocus=function(e){if(!this.isInteracted){this.isInteracted=!0;var i={isInteracted:!!e,event:e};this.trigger("focus",i)}this.updateIconState()},t.prototype.resetValueHandler=function(e){var i=(0,a.oq)(this.inputElement,"form");if(i&&e.target===i){var r=this.element.tagName===this.getNgDirective()?null:this.inputElement.getAttribute("value");this.text=r}},t.prototype.wireEvent=function(){a.bi.add(this.inputWrapper.container,"mousedown",this.dropDownClick,this),a.bi.add(this.inputWrapper.container,"focus",this.focusIn,this),a.bi.add(this.inputWrapper.container,"keypress",this.onSearch,this),this.bindCommonEvent()},t.prototype.bindCommonEvent=function(){a.bi.add(this.targetElement(),"blur",this.onBlurHandler,this);var e=(0,a.oq)(this.inputElement,"form");e&&a.bi.add(e,"reset",this.resetValueHandler,this),a.AR.isDevice?this.keyboardModule=new a.nv(this.targetElement(),{keyAction:this.mobileKeyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}):this.keyboardModule=new a.nv(this.targetElement(),{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),this.bindClearEvent()},t.prototype.bindClearEvent=function(){this.showClearButton&&a.bi.add(this.inputWrapper.clearButton,"mousedown",this.resetHandler,this)},t.prototype.unBindCommonEvent=function(){this.targetElement()&&a.bi.remove(this.targetElement(),"blur",this.onBlurHandler);var e=this.inputElement&&(0,a.oq)(this.inputElement,"form");e&&a.bi.remove(e,"reset",this.resetValueHandler),a.AR.isDevice||this.keyboardModule.destroy(),this.showClearButton&&a.bi.remove(this.inputWrapper.clearButton,"mousedown",this.resetHandler)},t.prototype.updateIconState=function(){this.showClearButton&&(this.inputElement.value!==""&&!this.readonly?(0,a.IV)([this.inputWrapper.clearButton],mt.clearIconHide):(0,a.cn)([this.inputWrapper.clearButton],mt.clearIconHide))},t.prototype.wireListEvents=function(){a.bi.add(this.list,"click",this.onMouseClick,this),a.bi.add(this.list,"mouseover",this.onMouseOver,this),a.bi.add(this.list,"mouseout",this.onMouseLeave,this)},t.prototype.onSearch=function(e){e.charCode!==32&&e.charCode!==13&&(this.list===void 0&&this.renderList(),this.searchKeyEvent=e,this.onServerIncrementalSearch(e))},t.prototype.onServerIncrementalSearch=function(e){!this.isRequested&&!(0,a.le)(this.list)&&!(0,a.le)(this.list.querySelector("li"))&&this.enabled&&!this.readonly&&this.incrementalSearch(e)},t.prototype.onMouseClick=function(e){var i=e.target,r=(0,a.oq)(i,"."+At.li);if(!!this.isValidLI(r))if(this.setSelection(r,e),a.AR.isDevice&&this.isFilterLayout())history.back();else{var n=100;this.closePopup(n)}},t.prototype.onMouseOver=function(e){var i=(0,a.oq)(e.target,"."+At.li);this.setHover(i)},t.prototype.setHover=function(e){this.enabled&&this.isValidLI(e)&&!e.classList.contains(At.hover)&&(this.removeHover(),(0,a.cn)([e],At.hover))},t.prototype.onMouseLeave=function(){this.removeHover()},t.prototype.removeHover=function(){if(this.list){var e=this.list.querySelectorAll("."+At.hover);e&&e.length&&(0,a.IV)(e,At.hover)}},t.prototype.isValidLI=function(e){return e&&e.hasAttribute("role")&&e.getAttribute("role")==="option"},t.prototype.incrementalSearch=function(e){if(this.liCollections.length>0){var i=Rb(e.charCode,this.liCollections,this.activeIndex,!0,this.element.id);(0,a.le)(i)||(this.setSelection(i,e),this.setScrollPosition())}},t.prototype.hideSpinner=function(){(0,a.le)(this.spinnerElement)||(Cs(this.spinnerElement),(0,a.IV)([this.spinnerElement],mt.disableIcon),this.spinnerElement.innerHTML="",this.spinnerElement=null)},t.prototype.showSpinner=function(){(0,a.le)(this.spinnerElement)&&(this.spinnerElement=a.AR.isDevice&&!(0,a.le)(this.filterInputObj)&&this.filterInputObj.buttons[1]||!(0,a.le)(this.filterInputObj)&&this.filterInputObj.buttons[0]||this.inputWrapper.buttons[0],(0,a.cn)([this.spinnerElement],mt.disableIcon),Ha({target:this.spinnerElement,width:a.AR.isDevice?"16px":"14px"},this.createElement),jn(this.spinnerElement))},t.prototype.keyActionHandler=function(e){if(!!this.enabled){var i=e.action==="pageUp"||e.action==="pageDown",r=this.getModuleName()!=="dropdownlist"&&(e.action==="home"||e.action==="end");this.isEscapeKey=e.action==="escape",this.isTabKey=!this.isPopupOpen&&e.action==="tab";var n=e.action==="down"||e.action==="up"||e.action==="home"||e.action==="end",s=e.action==="down"||e.action==="up"||e.action==="pageUp"||e.action==="pageDown"||e.action==="home"||e.action==="end";if(!((this.isEditTextBox()||i||r)&&!this.isPopupOpen)&&!this.readonly){var l=e.action==="tab"||e.action==="close";if(this.list===void 0&&!this.isRequested&&!l&&e.action!=="escape"&&(this.searchKeyEvent=e,this.renderList()),(0,a.le)(this.list)||!(0,a.le)(this.liCollections)&&s&&this.liCollections.length===0||this.isRequested)return;switch((l&&this.getModuleName()!=="autocomplete"&&this.isPopupOpen||e.action==="escape")&&e.preventDefault(),this.isSelected=e.action==="escape"?!1:this.isSelected,this.isTyped=s||e.action==="escape"?!1:this.isTyped,e.action){case"down":case"up":this.updateUpDownAction(e);break;case"pageUp":this.pageUpSelection(this.activeIndex-this.getPageCount(),e),e.preventDefault();break;case"pageDown":this.pageDownSelection(this.activeIndex+this.getPageCount(),e),e.preventDefault();break;case"home":this.updateHomeEndAction(e);break;case"end":this.updateHomeEndAction(e);break;case"space":this.getModuleName()==="dropdownlist"&&(this.beforePopupOpen||this.showPopup());break;case"open":this.showPopup();break;case"hide":this.preventAltUp=this.isPopupOpen,this.hidePopup(e),this.focusDropDown(e);break;case"enter":this.selectCurrentItem(e);break;case"tab":this.selectCurrentValueOnTab(e);break;case"escape":case"close":this.isPopupOpen&&(this.hidePopup(e),this.focusDropDown(e));break}}}},t.prototype.updateUpDownAction=function(e){var i=this.list.querySelector("."+mt.focus);if(this.isSelectFocusItem(i))this.setSelection(i,e);else if(!(0,a.le)(this.liCollections)){var r=e.action==="down"?this.activeIndex+1:this.activeIndex-1,n=0;this.getModuleName()==="autocomplete"&&(n=e.action==="down"&&(0,a.le)(this.activeIndex)?0:this.liCollections.length-1,r=r<0?this.liCollections.length-1:r===this.liCollections.length?0:r);var s=(0,a.le)(this.activeIndex)?this.liCollections[n]:this.liCollections[r];(0,a.le)(s)||this.setSelection(s,e)}e.preventDefault()},t.prototype.updateHomeEndAction=function(e){if(this.getModuleName()==="dropdownlist"){var i=0;if(e.action==="home"?i=0:i=this.getItems().length-1,e.preventDefault(),this.activeIndex===i)return;this.setSelection(this.liCollections[i],e)}},t.prototype.selectCurrentValueOnTab=function(e){this.getModuleName()==="autocomplete"?this.selectCurrentItem(e):this.isPopupOpen&&(this.hidePopup(e),this.focusDropDown(e))},t.prototype.mobileKeyActionHandler=function(e){if(!!this.enabled&&!(this.isEditTextBox()&&!this.isPopupOpen)&&!this.readonly){if(this.list===void 0&&!this.isRequested&&(this.searchKeyEvent=e,this.renderList()),(0,a.le)(this.list)||!(0,a.le)(this.liCollections)&&this.liCollections.length===0||this.isRequested)return;e.action==="enter"&&this.selectCurrentItem(e)}},t.prototype.selectCurrentItem=function(e){if(this.isPopupOpen){var i=this.list.querySelector("."+mt.focus);i&&(this.setSelection(i,e),this.isTyped=!1),this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(e)),this.hidePopup(),this.focusDropDown(e)}else this.showPopup()},t.prototype.isSelectFocusItem=function(e){return!(0,a.le)(e)},t.prototype.getPageCount=function(){var e=this.list.classList.contains(At.noData)?null:getComputedStyle(this.getItems()[0],null).getPropertyValue("height");return Math.round(this.list.getBoundingClientRect().height/parseInt(e,10))},t.prototype.pageUpSelection=function(e,i){var r=e>=0?this.liCollections[e+1]:this.liCollections[0];this.setSelection(r,i)},t.prototype.pageDownSelection=function(e,i){var r=this.getItems(),n=e<=r.length?this.liCollections[e-1]:this.liCollections[r.length-1];this.setSelection(n,i)},t.prototype.unWireEvent=function(){a.bi.remove(this.inputWrapper.container,"mousedown",this.dropDownClick),a.bi.remove(this.inputWrapper.container,"keypress",this.onSearch),a.bi.remove(this.inputWrapper.container,"focus",this.focusIn),this.unBindCommonEvent()},t.prototype.unWireListEvents=function(){a.bi.remove(this.list,"click",this.onMouseClick),a.bi.remove(this.list,"mouseover",this.onMouseOver),a.bi.remove(this.list,"mouseout",this.onMouseLeave)},t.prototype.checkSelector=function(e){return'[id="'+e.replace(/(:|\.|\[|\]|,|=|@|\\|\/|#)/g,"\\$1")+'"]'},t.prototype.onDocumentClick=function(e){var i=e.target;if(!(!(0,a.le)(this.popupObj)&&(0,a.oq)(i,this.checkSelector(this.popupObj.element.id)))&&!this.inputWrapper.container.contains(e.target)){if(this.inputWrapper.container.classList.contains(mt.inputFocus)||this.isPopupOpen){this.isDocumentClick=!0;var r=this.isRequested;this.isInteracted=!1,this.hidePopup(e),r||(this.onFocusOut(),this.inputWrapper.container.classList.remove(mt.inputFocus))}}else i!==this.inputElement&&!(this.allowFiltering&&i===this.filterInput)&&!(this.getModuleName()==="combobox"&&!this.allowFiltering&&a.AR.isDevice&&i===this.inputWrapper.buttons[0])&&(this.isPreventBlur=(a.AR.isIE||a.AR.info.name==="edge")&&(document.activeElement===this.targetElement()||document.activeElement===this.filterInput),e.preventDefault())},t.prototype.activeStateChange=function(){this.isDocumentClick&&(this.hidePopup(),this.onFocusOut(),this.inputWrapper.container.classList.remove(mt.inputFocus))},t.prototype.focusDropDown=function(e){!this.initial&&this.isFilterLayout()&&this.focusIn(e)},t.prototype.dropDownClick=function(e){if(!(e.which===3||e.button===2)&&!(this.targetElement().classList.contains(mt.disable)||this.inputWrapper.clearButton===e.target)){var i=e.target;if(i!==this.inputElement&&!(this.allowFiltering&&i===this.filterInput)&&this.getModuleName()!=="combobox"&&e.preventDefault(),this.readonly)this.focusIn(e);else{this.isPopupOpen?(this.hidePopup(),this.isFilterLayout()&&this.focusDropDown(e)):(this.focusIn(e),this.floatLabelChange(),this.queryString=this.inputElement.value.trim()===""?null:this.inputElement.value,this.isDropDownClick=!0,this.showPopup());var r=this,n=this.element.tagName===this.getNgDirective()&&this.itemTemplate?500:100;this.isSecondClick||setTimeout(function(){r.cloneElements(),r.isSecondClick=!0},n)}}},t.prototype.cloneElements=function(){if(this.list){var e=this.list.querySelector("ul");e&&(e=e.cloneNode?e.cloneNode(!0):e,this.actionCompleteData.ulElement=e)}},t.prototype.updateSelectedItem=function(e,i,r,n){var s=this;this.removeSelection(),e.classList.add(At.selected),this.removeHover();var l=this.getFormattedValue(e.getAttribute("data-value")),h=this.getDataByValue(l);if(!this.initial&&!r&&!(0,a.le)(i)){var c=this.detachChanges(h);this.isSelected=!0;var u={e:i,item:e,itemData:c,isInteracted:!!i,cancel:!1};this.trigger("select",u,function(p){p.cancel?e.classList.remove(At.selected):(s.selectEventCallback(e,i,r,h,l),n&&s.setSelectOptions(e,i))})}else this.selectEventCallback(e,i,r,h,l),n&&this.setSelectOptions(e,i)},t.prototype.selectEventCallback=function(e,i,r,n,s){this.previousItemData=(0,a.le)(this.itemData)?null:this.itemData,this.item=e,this.itemData=n;var l=this.list.querySelector("."+At.focus);l&&(0,a.IV)([l],At.focus),e.setAttribute("aria-selected","true"),this.activeIndex=this.getIndexByValue(s)},t.prototype.activeItem=function(e){this.isValidLI(e)&&!e.classList.contains(At.selected)&&(this.removeSelection(),e.classList.add(At.selected),this.removeHover(),e.setAttribute("aria-selected","true"))},t.prototype.setValue=function(e){var i=this.getItemData();i.value===null?Ue.setValue(null,this.inputElement,this.floatLabelType,this.showClearButton):Ue.setValue(i.text,this.inputElement,this.floatLabelType,this.showClearButton),this.valueTemplate&&this.itemData!==null?this.setValueTemplate():!(0,a.le)(this.valueTempElement)&&this.inputElement.previousSibling===this.valueTempElement&&((0,a.og)(this.valueTempElement),this.inputElement.style.display="block");var r=mt.clearIcon,n=this.isFiltering()&&this.filterInput&&this.getModuleName()==="combobox",s=n&&this.filterInput.parentElement.querySelector("."+r);return this.isFiltering()&&s&&s.style.removeProperty("visibility"),this.previousValue===i.value?(this.isSelected=!1,!0):(this.isSelected=!this.initial,this.isSelectCustom=!1,this.getModuleName()==="dropdownlist"&&this.updateIconState(),!1)},t.prototype.setSelection=function(e,i){this.isValidLI(e)&&(!e.classList.contains(At.selected)||this.isPopupOpen&&this.isSelected&&e.classList.contains(At.selected))?this.updateSelectedItem(e,i,!1,!0):this.setSelectOptions(e,i)},t.prototype.setSelectOptions=function(e,i){this.list&&this.removeHover(),this.previousSelectedLI=(0,a.le)(this.selectedLI)?null:this.selectedLI,this.selectedLI=e,!this.setValue(i)&&((0,a.Y4)(this.targetElement(),{"aria-activedescendant":this.selectedLI?this.selectedLI.id:null}),this.isFilterLayout()&&this.filterInput&&(0,a.Y4)(this.filterInput,{"aria-activedescendant":this.selectedLI?this.selectedLI.id:null}),(!this.isPopupOpen&&!(0,a.le)(e)||this.isPopupOpen&&!(0,a.le)(i)&&(i.type!=="keydown"||i.type==="keydown"&&i.action==="enter"))&&(this.isSelectCustom=!1,this.onChangeEvent(i)),this.isPopupOpen&&!(0,a.le)(this.selectedLI)&&this.itemData!==null&&(!i||i.type!=="click")&&this.setScrollPosition(i),a.AR.info.name!=="mozilla"&&((0,a.Y4)(this.inputElement,{"aria-label":this.inputElement.value}),(0,a.Y4)(this.targetElement(),{"aria-describedby":this.inputElement.id}),this.targetElement().removeAttribute("aria-live")))},t.prototype.dropdownCompiler=function(e){var i=!1;if(e)try{i=!!document.querySelectorAll(e).length}catch(r){i=!1}return i},t.prototype.setValueTemplate=function(){var e;this.isReact&&(this.clearTemplate(["valueTemplate"]),this.valueTempElement&&((0,a.og)(this.valueTempElement),this.inputElement.style.display="block",this.valueTempElement=null)),this.valueTempElement||(this.valueTempElement=this.createElement("span",{className:mt.value}),this.inputElement.parentElement.insertBefore(this.valueTempElement,this.inputElement),this.inputElement.style.display="none"),this.isReact||(this.valueTempElement.innerHTML="");var i=this.dropdownCompiler(this.valueTemplate);i?e=(0,a.MY)(document.querySelector(this.valueTemplate).innerHTML.trim()):e=(0,a.MY)(this.valueTemplate);var r=e(this.itemData,this,"valueTemplate",this.valueTemplateId,this.isStringTemplate,null,this.valueTempElement);if(r&&r.length>0)for(var n=0;n<r.length;n++)this.valueTempElement.appendChild(r[n]);this.renderReactTemplates()},t.prototype.removeSelection=function(){if(this.list){var e=this.list.querySelectorAll("."+At.selected);e.length&&((0,a.IV)(e,At.selected),e[0].removeAttribute("aria-selected"))}},t.prototype.getItemData=function(){var e=this.fields,i=null;i=this.itemData;var r,n;(0,a.le)(i)||(r=(0,a.NA)(e.value,i),n=(0,a.NA)(e.text,i));var s=!(0,a.le)(i)&&!(0,a.o8)(r)?r:i,l=!(0,a.le)(i)&&!(0,a.o8)(r)?n:i;return{value:s,text:l}},t.prototype.onChangeEvent=function(e){var i=this.getItemData(),r=this.isSelectCustom?null:this.activeIndex;this.setProperties({index:r,text:i.text,value:i.value},!0),this.detachChangeEvent(e)},t.prototype.detachChanges=function(e){var i;return typeof e=="string"||typeof e=="boolean"||typeof e=="number"?i=Object.defineProperties({},{value:{value:e,enumerable:!0},text:{value:e,enumerable:!0}}):i=e,i},t.prototype.detachChangeEvent=function(e){if(this.isSelected=!1,this.previousValue=this.value,this.activeIndex=this.index,this.typedString=(0,a.le)(this.text)?"":this.text,!this.initial){var i=this.detachChanges(this.itemData),r=void 0;typeof this.previousItemData=="string"||typeof this.previousItemData=="boolean"||typeof this.previousItemData=="number"?r=Object.defineProperties({},{value:{value:this.previousItemData,enumerable:!0},text:{value:this.previousItemData,enumerable:!0}}):r=this.previousItemData,this.setHiddenValue();var n={e,item:this.item,itemData:i,previousItem:this.previousSelectedLI,previousItemData:r,isInteracted:!!e,value:this.value,element:this.element,event:e};this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",n)}((0,a.le)(this.value)||this.value==="")&&this.floatLabelType!=="Always"&&(0,a.IV)([this.inputWrapper.container],"e-valid-input")},t.prototype.setHiddenValue=function(){if((0,a.le)(this.value))this.hiddenElement.innerHTML="";else if(this.hiddenElement.querySelector("option")){var e=this.hiddenElement.querySelector("option");e.textContent=this.text,e.setAttribute("value",this.value.toString())}else{this.hiddenElement.innerHTML="<option selected>"+this.text+"</option>";var e=this.hiddenElement.querySelector("option");e.setAttribute("value",this.value.toString())}},t.prototype.onFilterUp=function(e){if(!(e.ctrlKey&&e.keyCode===86)&&(this.isValidKey||e.keyCode===40||e.keyCode===38))switch(this.isValidKey=!1,e.keyCode){case 38:case 40:this.getModuleName()==="autocomplete"&&!this.isPopupOpen&&!this.preventAltUp&&!this.isRequested?(this.preventAutoFill=!0,this.searchLists(e)):this.preventAutoFill=!1,this.preventAltUp=!1,e.preventDefault();break;case 46:case 8:this.typedString=this.filterInput.value,!this.isPopupOpen&&this.typedString!==""||this.isPopupOpen&&this.queryString.length>0?(this.preventAutoFill=!0,this.searchLists(e)):this.typedString===""&&this.queryString===""&&this.getModuleName()!=="autocomplete"?(this.preventAutoFill=!0,this.searchLists(e)):this.typedString===""&&(this.list&&this.resetFocusElement(),this.activeIndex=null,this.getModuleName()!=="dropdownlist"&&(this.preventAutoFill=!0,this.searchLists(e),this.getModuleName()==="autocomplete"&&this.hidePopup())),e.preventDefault();break;default:this.typedString=this.filterInput.value,this.preventAutoFill=!1,this.searchLists(e);break}else this.isValidKey=!1},t.prototype.onFilterDown=function(e){switch(e.keyCode){case 13:break;case 40:case 38:this.queryString=this.filterInput.value,e.preventDefault();break;case 9:this.isPopupOpen&&this.getModuleName()!=="autocomplete"&&e.preventDefault();break;default:this.prevSelectPoints=this.getSelectionPoints(),this.queryString=this.filterInput.value;break}},t.prototype.removeFillSelection=function(){if(this.isInteracted){var e=this.getSelectionPoints();this.inputElement.setSelectionRange(e.end,e.end)}},t.prototype.getQuery=function(e){var i;if(!this.isCustomFilter&&this.allowFiltering&&this.filterInput){i=e?e.clone():this.query?this.query.clone():new yt.A;var r=this.typedString===""?"contains":this.filterType,n=this.typeOfData(this.dataSource).typeof;if(!(this.dataSource instanceof Oe.h)&&n==="string"||n==="number")i.where("",r,this.typedString,this.ignoreCase,this.ignoreAccent);else{var s=this.fields.text?this.fields.text:"";i.where(s,r,this.typedString,this.ignoreCase,this.ignoreAccent)}}else i=e?e.clone():this.query?this.query.clone():new yt.A;return i},t.prototype.getSelectionPoints=function(){var e=this.inputElement;return{start:Math.abs(e.selectionStart),end:Math.abs(e.selectionEnd)}},t.prototype.searchLists=function(e){var i=this;if(this.isTyped=!0,this.activeIndex=null,this.isListSearched=!0,this.filterInput.parentElement.querySelector("."+mt.clearIcon)){var r=this.filterInput.parentElement.querySelector("."+mt.clearIcon);r.style.visibility=this.filterInput.value===""?"hidden":"visible"}if(this.isDataFetched=!1,this.isFiltering()){var n={preventDefaultAction:!1,text:this.filterInput.value,updateData:function(s,l,h){n.cancel||(i.isCustomFilter=!0,i.filteringAction(s,l,h))},baseEventArgs:e,cancel:!1};this.trigger("filtering",n,function(s){!s.cancel&&!i.isCustomFilter&&!s.preventDefaultAction&&i.filteringAction(i.dataSource,null,i.fields)})}},t.prototype.filter=function(e,i,r){this.isCustomFilter=!0,this.filteringAction(e,i,r)},t.prototype.filteringAction=function(e,i,r){(0,a.le)(this.filterInput)||(this.beforePopupOpen=!(!this.isPopupOpen&&this.getModuleName()==="combobox"&&this.filterInput.value===""),this.filterInput.value.trim()===""&&!this.itemTemplate?(this.actionCompleteData.isUpdated=!1,this.isTyped=!1,!(0,a.le)(this.actionCompleteData.ulElement)&&!(0,a.le)(this.actionCompleteData.list)&&this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list),this.isTyped=!0,!(0,a.le)(this.itemData)&&this.getModuleName()==="dropdownlist"&&(this.focusIndexItem(),this.setScrollPosition()),this.isNotSearchList=!0):(this.isNotSearchList=!1,i=this.filterInput.value.trim()===""?null:i,this.resetList(e,r,i)),this.renderReactTemplates())},t.prototype.setSearchBox=function(e){if(this.isFiltering()){var i=e.querySelector("."+mt.filterParent)?e.querySelector("."+mt.filterParent):this.createElement("span",{className:mt.filterParent});this.filterInput=this.createElement("input",{attrs:{type:"text"},className:mt.filterInput}),this.element.parentNode.insertBefore(this.filterInput,this.element);var r=!1;return a.AR.isDevice&&(r=!0),this.filterInputObj=Ue.createInput({element:this.filterInput,buttons:r?[mt.backIcon,mt.filterBarClearIcon]:[mt.filterBarClearIcon],properties:{placeholder:this.filterBarPlaceholder}},this.createElement),(0,a.le)(this.cssClass)||(this.cssClass.split(" ").indexOf("e-outline")!==-1?(0,a.cn)([this.filterInputObj.container],"e-outline"):this.cssClass.split(" ").indexOf("e-filled")!==-1&&(0,a.cn)([this.filterInputObj.container],"e-filled")),(0,a.R3)([this.filterInputObj.container],i),(0,a.Ce)([i],e),(0,a.Y4)(this.filterInput,{"aria-disabled":"false","aria-owns":this.element.id+"_options",role:"listbox","aria-activedescendant":this.selectedLI?this.selectedLI.id:null,autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}),this.clearIconElement=this.filterInput.parentElement.querySelector("."+mt.clearIcon),!a.AR.isDevice&&this.clearIconElement&&(a.bi.add(this.clearIconElement,"click",this.clearText,this),this.clearIconElement.style.visibility="hidden"),a.AR.isDevice?this.searchKeyModule=new a.nv(this.filterInput,{keyAction:this.mobileKeyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}):this.searchKeyModule=new a.nv(this.filterInput,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),a.bi.add(this.filterInput,"input",this.onInput,this),a.bi.add(this.filterInput,"keyup",this.onFilterUp,this),a.bi.add(this.filterInput,"keydown",this.onFilterDown,this),a.bi.add(this.filterInput,"blur",this.onBlurHandler,this),a.bi.add(this.filterInput,"paste",this.pasteHandler,this),this.filterInputObj}else return qb},t.prototype.onInput=function(e){this.isValidKey=!0,a.AR.isDevice&&a.AR.info.name==="mozilla"&&(this.typedString=this.filterInput.value,this.preventAutoFill=!0,this.searchLists(e))},t.prototype.pasteHandler=function(e){var i=this;setTimeout(function(){i.typedString=i.filterInput.value,i.searchLists(e)})},t.prototype.onActionFailure=function(e){o.prototype.onActionFailure.call(this,e),this.beforePopupOpen&&this.renderPopup()},t.prototype.onActionComplete=function(e,i,r,n){var s=this;if(this.isNotSearchList){this.isNotSearchList=!1;return}if(this.isActive){var l=this.selectedLI?this.selectedLI.cloneNode(!0):null;if(o.prototype.onActionComplete.call(this,e,i,r),this.updateSelectElementData(this.allowFiltering),this.isRequested&&!(0,a.le)(this.searchKeyEvent)&&this.searchKeyEvent.type==="keydown"&&(this.isRequested=!1,this.keyActionHandler(this.searchKeyEvent),this.searchKeyEvent=null),this.isRequested&&!(0,a.le)(this.searchKeyEvent)&&(this.incrementalSearch(this.searchKeyEvent),this.searchKeyEvent=null),this.list.scrollTop=0,(0,a.le)(e)||(0,a.Y4)(e,{id:this.element.id+"_options",role:"listbox","aria-hidden":"false"}),this.initRemoteRender)if(this.initial=!0,this.activeIndex=this.index,this.initRemoteRender=!1,this.initial=!1,this.value&&this.dataSource instanceof Oe.h){var h=(0,a.le)(this.fields.value)?this.fields.text:this.fields.value,c=i.some(function(u){return u[h]===s.value});c?this.updateValues():this.dataSource.executeQuery(this.getQuery(this.query).where(new yt.$(h,"equal",this.value))).then(function(u){u.result.length>0&&s.addItem(u.result,i.length),s.updateValues()})}else this.updateValues();this.getModuleName()!=="autocomplete"&&this.isFiltering()&&!this.isTyped&&((!this.actionCompleteData.isUpdated||!this.isCustomFilter&&!this.isFilterFocus||(0,a.le)(this.itemData)&&this.allowFiltering&&(this.dataSource instanceof Oe.h||!(0,a.le)(this.dataSource)&&!(0,a.le)(this.dataSource.length)&&this.dataSource.length!==0))&&(this.itemTemplate&&this.element.tagName==="EJS-COMBOBOX"&&this.allowFiltering?setTimeout(function(){s.updateActionCompleteDataValues(e,i)},0):this.updateActionCompleteDataValues(e,i)),this.addNewItem(i,l),(0,a.le)(this.itemData)||this.focusIndexItem()),this.beforePopupOpen&&this.renderPopup()}},t.prototype.updateActionCompleteDataValues=function(e,i){this.actionCompleteData={ulElement:e.cloneNode(!0),list:i,isUpdated:!0},this.actionData.list!==this.actionCompleteData.list&&this.actionCompleteData.ulElement&&this.actionCompleteData.list&&(this.actionData=this.actionCompleteData)},t.prototype.addNewItem=function(e,i){var r=this;if(!(0,a.le)(this.itemData)&&!(0,a.le)(i)){var n=this.getItemData().value,s=e.some(function(l){return(typeof l=="string"||typeof l=="number")&&l===n||(0,a.NA)(r.fields.value,l)===n});s||this.addItem(this.itemData)}},t.prototype.updateActionCompleteData=function(e,i,r){var n=this;this.getModuleName()!=="autocomplete"&&this.actionCompleteData.ulElement&&(this.itemTemplate&&this.element.tagName==="EJS-COMBOBOX"&&this.allowFiltering?setTimeout(function(){n.actionCompleteDataUpdate(e,i,r)},0):this.actionCompleteDataUpdate(e,i,r))},t.prototype.actionCompleteDataUpdate=function(e,i,r){r!=null?this.actionCompleteData.ulElement.insertBefore(e.cloneNode(!0),this.actionCompleteData.ulElement.childNodes[r]):this.actionCompleteData.ulElement.appendChild(e.cloneNode(!0)),this.isFiltering()&&this.actionCompleteData.list.indexOf(i)<0&&this.actionCompleteData.list.push(i)},t.prototype.focusIndexItem=function(){var e=this.getItemData().value;this.activeIndex=this.getIndexByValue(e);var i=this.findListElement(this.list,"li","data-value",e);this.selectedLI=i,this.activeItem(i),this.removeFocus()},t.prototype.updateSelection=function(){var e=this.list.querySelector("."+At.selected);e?(this.setProperties({index:this.getIndexByValue(e.getAttribute("data-value"))}),this.activeIndex=this.index):(this.removeFocus(),this.list.querySelector("."+At.li).classList.add(mt.focus))},t.prototype.removeFocus=function(){var e=this.list.querySelectorAll("."+mt.focus);e&&e.length&&(0,a.IV)(e,mt.focus)},t.prototype.renderPopup=function(){var e=this;if(this.popupObj&&document.body.contains(this.popupObj.element)){this.refreshPopup();return}var i={cancel:!1};this.trigger("beforeOpen",i,function(r){if(r.cancel)e.beforePopupOpen=!1;else{var n=e.createElement("div",{id:e.element.id+"_popup",className:"e-ddl e-popup "+(e.cssClass!=null?e.cssClass:"")}),s=e.setSearchBox(n);if(e.listHeight=(0,a.Ac)(e.popupHeight),e.headerTemplate&&e.setHeaderTemplate(n),(0,a.R3)([e.list],n),e.footerTemplate&&e.setFooterTemplate(n),document.body.appendChild(n),n.style.visibility="hidden",e.popupHeight!=="auto"){if(e.searchBoxHeight=0,(0,a.le)(s.container)||(e.searchBoxHeight=s.container.parentElement.getBoundingClientRect().height,e.listHeight=(parseInt(e.listHeight,10)-e.searchBoxHeight).toString()+"px"),e.headerTemplate){e.header=e.header?e.header:n.querySelector(".e-ddl-header");var l=Math.round(e.header.getBoundingClientRect().height);e.listHeight=(parseInt(e.listHeight,10)-(l+e.searchBoxHeight)).toString()+"px"}if(e.footerTemplate){e.footer=e.footer?e.footer:n.querySelector(".e-ddl-footer");var l=Math.round(e.footer.getBoundingClientRect().height);e.listHeight=(parseInt(e.listHeight,10)-(l+e.searchBoxHeight)).toString()+"px"}e.list.style.maxHeight=(parseInt(e.listHeight,10)-2).toString()+"px",n.style.maxHeight=(0,a.Ac)(e.popupHeight)}else n.style.height="auto";var h=0,c=void 0;if(!(0,a.le)(e.selectedLI)&&!(0,a.le)(e.activeIndex)&&e.activeIndex>=0?e.setScrollPosition():e.list.scrollTop=0,a.AR.isDevice&&!e.allowFiltering&&(e.getModuleName()==="dropdownlist"||e.isDropDownClick&&e.getModuleName()==="combobox")){h=e.getOffsetValue(n);var u=e.isEmptyList()?e.list:e.liCollections[0];c=-(parseInt(getComputedStyle(u).textIndent,10)-parseInt(getComputedStyle(e.inputElement).paddingLeft,10)+parseInt(getComputedStyle(e.inputElement.parentElement).borderLeftWidth,10))}e.getFocusElement(),e.createPopup(n,h,c),e.checkCollision(n),a.AR.isDevice&&(e.popupObj.element.classList.add(mt.device),(e.getModuleName()==="dropdownlist"||e.getModuleName()==="combobox"&&!e.allowFiltering&&e.isDropDownClick)&&(e.popupObj.collision={X:"fit",Y:"fit"}),e.isFilterLayout()&&(e.popupObj.element.classList.add(mt.mobileFilter),e.popupObj.position={X:0,Y:0},e.popupObj.dataBind(),(0,a.Y4)(e.popupObj.element,{style:"left:0px;right:0px;top:0px;bottom:0px;"}),(0,a.cn)([document.body,e.popupObj.element],mt.popupFullScreen),e.setSearchBoxPosition(),e.backIconElement=s.container.querySelector(".e-back-icon"),e.clearIconElement=s.container.querySelector("."+mt.clearIcon),a.bi.add(e.backIconElement,"click",e.clickOnBackIcon,e),a.bi.add(e.clearIconElement,"click",e.clearText,e))),n.style.visibility="visible",(0,a.cn)([n],"e-popup-close");for(var p=e.popupObj.getScrollableParent(e.inputWrapper.container),f=0,g=p;f<g.length;f++){var C=g[f];a.bi.add(C,"scroll",e.scrollHandler,e)}a.AR.isDevice&&e.isFilterLayout()&&a.bi.add(e.list,"scroll",e.listScroll,e),(0,a.le)(e.list)||(e.unWireListEvents(),e.wireListEvents()),(0,a.Y4)(e.targetElement(),{"aria-expanded":"true"});var L=e.isFiltering()?e.filterInput.parentElement:e.inputWrapper.container;(0,a.cn)([L],[mt.inputFocus]);var D={name:"FadeIn",duration:100};e.beforePopupOpen=!0;var R=e.popupObj,B={popup:R,cancel:!1,animation:D};e.trigger("open",B,function(H){H.cancel?(e.beforePopupOpen=!1,e.destroyPopup()):((0,a.cn)([e.inputWrapper.container],[mt.iconAnimation]),e.renderReactTemplates(),e.popupObj.show(new a.fw(H.animation),e.zIndex===1e3?e.element:null))})}})},t.prototype.checkCollision=function(e){if(!a.AR.isDevice||a.AR.isDevice&&!(this.getModuleName()==="dropdownlist"||this.isDropDownClick)){var i=Vr(e);i.length>0&&(e.style.marginTop=-parseInt(getComputedStyle(e).marginTop,10)+"px"),this.popupObj.resolveCollision()}},t.prototype.getOffsetValue=function(e){var i=getComputedStyle(e),r=parseInt(i.borderTopWidth,10),n=parseInt(i.borderBottomWidth,10);return this.setPopupPosition(r+n)},t.prototype.createPopup=function(e,i,r){var n=this;this.popupObj=new br(e,{width:this.setWidth(),targetType:"relative",relateTo:this.inputWrapper.container,collision:{X:"flip",Y:"flip"},offsetY:i,enableRtl:this.enableRtl,offsetX:r,position:{X:"left",Y:"bottom"},zIndex:this.zIndex,close:function(){n.isDocumentClick||n.focusDropDown(),n.isReact&&n.clearTemplate(["headerTemplate","footerTemplate"]);var s=n.getModuleName()==="autocomplete";n.isNotSearchList=!1,n.isDocumentClick=!1,n.destroyPopup(),n.isFiltering()&&n.actionCompleteData.list&&n.actionCompleteData.list[0]&&(n.isActive=!0,n.onActionComplete(n.actionCompleteData.ulElement,n.actionCompleteData.list,null,!0))},open:function(){a.bi.add(document,"mousedown",n.onDocumentClick,n),n.isPopupOpen=!0;var s=n.actionCompleteData&&n.actionCompleteData.ulElement&&n.actionCompleteData.ulElement.querySelector("li"),l=n.list.querySelector("ul li");n.isFiltering()&&n.itemTemplate&&n.element.tagName===n.getNgDirective()&&s&&l&&s.textContent!==l.textContent&&n.element.tagName!=="EJS-COMBOBOX"&&n.cloneElements(),n.isFilterLayout()&&((0,a.IV)([n.inputWrapper.container],[mt.inputFocus]),n.isFilterFocus=!0,n.filterInput.focus(),n.inputWrapper.clearButton&&(0,a.cn)([n.inputWrapper.clearButton],mt.clearIconHide)),n.activeStateChange()},targetExitViewport:function(){a.AR.isDevice||n.hidePopup()}})},t.prototype.isEmptyList=function(){return!(0,a.le)(this.liCollections)&&this.liCollections.length===0},t.prototype.getFocusElement=function(){},t.prototype.isFilterLayout=function(){return this.getModuleName()==="dropdownlist"&&this.allowFiltering},t.prototype.scrollHandler=function(){a.AR.isDevice&&(this.getModuleName()==="dropdownlist"&&!this.isFilterLayout()||this.getModuleName()==="combobox"&&!this.allowFiltering&&this.isDropDownClick)&&this.hidePopup()},t.prototype.setSearchBoxPosition=function(){var e=this.filterInput.parentElement.getBoundingClientRect().height;this.popupObj.element.style.maxHeight="100%",this.popupObj.element.style.width="100%",this.list.style.maxHeight=window.innerHeight-e+"px",this.list.style.height=window.innerHeight-e+"px";var i=this.filterInput.parentElement.querySelector("."+mt.clearIcon);(0,a.og)(this.filterInput),i.parentElement.insertBefore(this.filterInput,i)},t.prototype.setPopupPosition=function(e){var i,r=e,n=this.list.querySelector("."+mt.focus)||this.selectedLI,s=this.isEmptyList()?this.list:this.liCollections[0],l=this.isEmptyList()?this.list:this.liCollections[this.getItems().length-1],h=s.getBoundingClientRect().height,c=this.list.offsetHeight/2,u=(0,a.le)(n)?s.offsetTop:n.offsetTop,p=l.offsetTop;if(p-c<u&&!(0,a.le)(this.liCollections)&&this.liCollections.length>0&&!(0,a.le)(n)){var f=this.list.offsetHeight/h,g=parseInt(getComputedStyle(this.list).paddingBottom,10);i=(f-(this.liCollections.length-this.activeIndex))*h-r+g,this.list.scrollTop=n.offsetTop}else u>c?(i=c-h/2,this.list.scrollTop=u-c+h/2):i=u;var C=this.inputWrapper.container.offsetHeight;return i=i+h+r-(h-C)/2,-i},t.prototype.setWidth=function(){var e=(0,a.Ac)(this.popupWidth);if(e.indexOf("%")>-1){var i=this.inputWrapper.container.offsetWidth*parseFloat(e)/100;e=i.toString()+"px"}if(a.AR.isDevice&&!this.allowFiltering&&(this.getModuleName()==="dropdownlist"||this.isDropDownClick&&this.getModuleName()==="combobox")){var r=this.isEmptyList()?this.list:this.liCollections[0];e=parseInt(e,10)+(parseInt(getComputedStyle(r).textIndent,10)-parseInt(getComputedStyle(this.inputElement).paddingLeft,10)+parseInt(getComputedStyle(this.inputElement.parentElement).borderLeftWidth,10))*2+"px"}return e},t.prototype.scrollBottom=function(e){if(!(0,a.le)(this.selectedLI)){var i=this.list.offsetHeight,r=this.selectedLI.offsetTop+this.selectedLI.offsetHeight-this.list.scrollTop,n=this.list.scrollTop+r-i;n=e?n+parseInt(getComputedStyle(this.list).paddingTop,10)*2:n;var s=this.selectedLI.offsetTop+this.selectedLI.offsetHeight-this.list.scrollTop;s=this.fields.groupBy&&!(0,a.le)(this.fixedHeaderElement)?s-this.fixedHeaderElement.offsetHeight:s,this.activeIndex===0?this.list.scrollTop=0:(r>i||!(s>0&&this.list.offsetHeight>s))&&(this.list.scrollTop=n)}},t.prototype.scrollTop=function(){if(!(0,a.le)(this.selectedLI)){var e=this.selectedLI.offsetTop-this.list.scrollTop;e=this.fields.groupBy&&!(0,a.le)(this.fixedHeaderElement)?e-this.fixedHeaderElement.offsetHeight:e;var i=this.selectedLI.offsetTop+this.selectedLI.offsetHeight-this.list.scrollTop;this.activeIndex===0?this.list.scrollTop=0:e<0?this.list.scrollTop=this.list.scrollTop+e:i>0&&this.list.offsetHeight>i||(this.list.scrollTop=this.selectedLI.offsetTop-(this.fields.groupBy&&!(0,a.le)(this.fixedHeaderElement)?this.fixedHeaderElement.offsetHeight:0))}},t.prototype.isEditTextBox=function(){return!1},t.prototype.isFiltering=function(){return this.allowFiltering},t.prototype.isPopupButton=function(){return!0},t.prototype.setScrollPosition=function(e){if((0,a.le)(e))this.scrollBottom(!0);else switch(e.action){case"pageDown":case"down":case"end":this.scrollBottom();break;default:this.scrollTop();break}},t.prototype.clearText=function(){this.filterInput.value=this.typedString="",this.searchLists(null)},t.prototype.listScroll=function(){this.filterInput.blur()},t.prototype.setEleWidth=function(e){(0,a.le)(e)||(typeof e=="number"?this.inputWrapper.container.style.width=(0,a.Ac)(e):typeof e=="string"&&(this.inputWrapper.container.style.width=e.match(/px|%|em/)?e:(0,a.Ac)(e)))},t.prototype.closePopup=function(e){var i=this;if(this.isTyped=!1,!!(this.popupObj&&document.body.contains(this.popupObj.element)&&this.beforePopupOpen)){a.bi.remove(document,"mousedown",this.onDocumentClick),this.isActive=!1,this.filterInputObj=null,this.isDropDownClick=!1,this.preventAutoFill=!1;for(var r=this.popupObj.getScrollableParent(this.inputWrapper.container),n=0,s=r;n<s.length;n++){var l=s[n];a.bi.remove(l,"scroll",this.scrollHandler)}a.AR.isDevice&&this.isFilterLayout()&&((0,a.IV)([document.body,this.popupObj.element],mt.popupFullScreen),a.bi.remove(this.list,"scroll",this.listScroll)),this.isFilterLayout()&&(a.AR.isDevice||(this.searchKeyModule.destroy(),this.clearIconElement&&a.bi.remove(this.clearIconElement,"click",this.clearText)),this.backIconElement&&(a.bi.remove(this.backIconElement,"click",this.clickOnBackIcon),a.bi.remove(this.clearIconElement,"click",this.clearText)),a.bi.remove(this.filterInput,"input",this.onInput),a.bi.remove(this.filterInput,"keyup",this.onFilterUp),a.bi.remove(this.filterInput,"keydown",this.onFilterDown),a.bi.remove(this.filterInput,"blur",this.onBlurHandler),a.bi.remove(this.filterInput,"paste",this.pasteHandler),this.filterInput=null),(0,a.Y4)(this.targetElement(),{"aria-expanded":"false"}),this.inputWrapper.container.classList.remove(mt.iconAnimation),this.isFiltering()&&(this.actionCompleteData.isUpdated=!1),this.beforePopupOpen=!1;var h={name:"FadeOut",duration:100,delay:e||0},c=this.popupObj,u={popup:c,cancel:!1,animation:h};this.trigger("close",u,function(p){if(!(0,a.le)(i.popupObj)&&!(0,a.le)(i.popupObj.element.querySelector(".e-fixed-head"))){var f=i.popupObj.element.querySelector(".e-fixed-head");f.parentNode.removeChild(f),i.fixedHeaderElement=null}p.cancel||(i.getModuleName()==="autocomplete"&&i.rippleFun(),i.isPopupOpen?i.popupObj.hide(new a.fw(p.animation)):i.destroyPopup())})}},t.prototype.destroyPopup=function(){this.isPopupOpen=!1,this.isFilterFocus=!1,this.popupObj.destroy(),(0,a.og)(this.popupObj.element)},t.prototype.clickOnBackIcon=function(){this.hidePopup(),this.focusIn()},t.prototype.render=function(){this.element.tagName==="INPUT"?(this.inputElement=this.element,(0,a.le)(this.inputElement.getAttribute("role"))&&this.inputElement.setAttribute("role","textbox"),(0,a.le)(this.inputElement.getAttribute("type"))&&this.inputElement.setAttribute("type","text")):(this.inputElement=this.createElement("input",{attrs:{role:"textbox",type:"text"}}),this.element.tagName!==this.getNgDirective()&&(this.element.style.display="none"),this.element.parentElement.insertBefore(this.inputElement,this.element),this.preventTabIndex(this.inputElement));var e=this.cssClass;!(0,a.le)(this.cssClass)&&this.cssClass!==""&&(e=this.cssClass.replace(/\s+/g," ").trim()),this.inputWrapper=Ue.createInput({element:this.inputElement,buttons:this.isPopupButton()?[mt.icon]:null,floatLabelType:this.floatLabelType,properties:{readonly:this.getModuleName()==="dropdownlist"?!0:this.readonly,placeholder:this.placeholder,cssClass:e,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton}},this.createElement),this.element.tagName===this.getNgDirective()?this.element.appendChild(this.inputWrapper.container):this.inputElement.parentElement.insertBefore(this.element,this.inputElement),this.hiddenElement=this.createElement("select",{attrs:{"aria-hidden":"true",tabindex:"-1",class:mt.hiddenElement}}),(0,a.Ce)([this.hiddenElement],this.inputWrapper.container),this.validationAttribute(this.element,this.hiddenElement),this.setReadOnly(),this.setFields(),this.inputWrapper.container.style.width=(0,a.Ac)(this.width),this.inputWrapper.container.classList.add("e-ddl"),this.wireEvent(),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex");var i=this.element.getAttribute("id")?this.element.getAttribute("id"):(0,a.QI)("ej2_dropdownlist");if(this.element.id=i,this.hiddenElement.id=i+"_hidden",this.targetElement().setAttribute("tabindex",this.tabIndex),(0,a.Y4)(this.targetElement(),this.getAriaAttributes()),this.updateDataAttribute(this.htmlAttributes),this.setHTMLAttributes(),this.value!==null||this.activeIndex!==null||this.text!==null)this.initValue();else if(this.element.tagName==="SELECT"&&this.element.options[0]){var r=this.element;this.value=r.options[r.selectedIndex].value,this.text=(0,a.le)(this.value)?null:r.options[r.selectedIndex].textContent,this.initValue()}this.preventTabIndex(this.element),this.enabled||(this.targetElement().tabIndex=-1),this.initial=!1,this.element.style.opacity="",this.inputElement.onselect=function(n){n.stopImmediatePropagation()},this.inputElement.onchange=function(n){n.stopImmediatePropagation()},this.element.hasAttribute("autofocus")&&this.focusIn(),(0,a.le)(this.text)||this.inputElement.setAttribute("value",this.text),this.element.hasAttribute("data-val")&&this.element.setAttribute("data-val","false"),this.renderComplete()},t.prototype.setFooterTemplate=function(e){var i;this.footer?this.footer.innerHTML="":(this.footer=this.createElement("div"),(0,a.cn)([this.footer],mt.footer));var r=this.dropdownCompiler(this.footerTemplate);r?i=(0,a.MY)((0,a.Ys)(this.footerTemplate,document).innerHTML.trim()):i=(0,a.MY)(this.footerTemplate);var n=i({},this,"footerTemplate",this.footerTemplateId,this.isStringTemplate,null,this.footer);if(n&&n.length>0)for(var s=0;s<n.length;s++)this.footer.appendChild(n[s]);(0,a.R3)([this.footer],e)},t.prototype.setHeaderTemplate=function(e){var i;this.header?this.header.innerHTML="":(this.header=this.createElement("div"),(0,a.cn)([this.header],mt.header));var r=this.dropdownCompiler(this.headerTemplate);r?i=(0,a.MY)((0,a.Ys)(this.headerTemplate,document).innerHTML.trim()):i=(0,a.MY)(this.headerTemplate);var n=i({},this,"headerTemplate",this.headerTemplateId,this.isStringTemplate,null,this.header);if(n&&n.length)for(var s=0;s<n.length;s++)this.header.appendChild(n[s]);var l=e.querySelector("div.e-content");e.insertBefore(this.header,l)},t.prototype.setOldText=function(e){this.text=e},t.prototype.setOldValue=function(e){this.value=e},t.prototype.refreshPopup=function(){!(0,a.le)(this.popupObj)&&document.body.contains(this.popupObj.element)&&(this.allowFiltering&&!(a.AR.isDevice&&this.isFilterLayout())||this.getModuleName()==="autocomplete")&&((0,a.IV)([this.popupObj.element],"e-popup-close"),this.popupObj.refreshPosition(this.inputWrapper.container),this.popupObj.resolveCollision())},t.prototype.checkData=function(e){e.dataSource&&!(0,a.le)(Object.keys(e.dataSource))&&this.itemTemplate&&this.allowFiltering&&!(this.isListSearched&&e.dataSource instanceof Oe.h)&&(this.list=null,this.actionCompleteData={ulElement:null,list:null,isUpdated:!1}),this.isListSearched=!1;var i=Object.keys(e).indexOf("value")!==-1&&(0,a.le)(e.value),r=Object.keys(e).indexOf("text")!==-1&&(0,a.le)(e.text);this.getModuleName()!=="autocomplete"&&this.allowFiltering&&(i||r)&&(this.itemData=null),this.allowFiltering&&e.dataSource&&!(0,a.le)(Object.keys(e.dataSource))?(this.actionCompleteData={ulElement:null,list:null,isUpdated:!1},this.actionData=this.actionCompleteData):this.allowFiltering&&e.query&&!(0,a.le)(Object.keys(e.query))&&(this.actionCompleteData=this.getModuleName()==="combobox"?{ulElement:null,list:null,isUpdated:!1}:this.actionCompleteData,this.actionData=this.actionCompleteData)},t.prototype.updateDataSource=function(e){(this.inputElement.value!==""||!(0,a.le)(e)&&((0,a.le)(e.dataSource)||!(e.dataSource instanceof Oe.h)&&e.dataSource.length===0))&&this.clearAll(null,e),this.fields.groupBy&&e.fields&&!this.isGroupChecking&&this.list&&(a.bi.remove(this.list,"scroll",this.setFloatingHeader),a.bi.add(this.list,"scroll",this.setFloatingHeader,this)),(!(!(0,a.le)(e)&&((0,a.le)(e.dataSource)||!(e.dataSource instanceof Oe.h)&&e.dataSource.length===0))||e.dataSource!==[])&&(this.typedString="",this.resetList(this.dataSource)),!this.isCustomFilter&&!this.isFilterFocus&&document.activeElement!==this.filterInput&&this.checkCustomValue()},t.prototype.checkCustomValue=function(){this.itemData=this.getDataByValue(this.value);var e=this.getItemData();this.setProperties({text:e.text,value:e.value})},t.prototype.updateInputFields=function(){this.getModuleName()==="dropdownlist"&&Ue.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},t.prototype.onPropertyChanged=function(e,i){var r=this;this.getModuleName()==="dropdownlist"&&(this.checkData(e),this.setUpdateInitial(["fields","query","dataSource"],e));for(var n=function(u){switch(u){case"query":case"dataSource":break;case"htmlAttributes":s.setHTMLAttributes();break;case"width":s.setEleWidth(e.width);break;case"placeholder":Ue.setPlaceholder(e.placeholder,s.inputElement);break;case"filterBarPlaceholder":s.filterInput&&Ue.setPlaceholder(e.filterBarPlaceholder,s.filterInput);break;case"readonly":s.getModuleName()!=="dropdownlist"&&Ue.setReadonly(e.readonly,s.inputElement),s.setReadOnly();break;case"cssClass":s.setCssClass(e.cssClass,i.cssClass);break;case"enableRtl":s.setEnableRtl();break;case"enabled":s.setEnable();break;case"text":if(e.text===null){s.clearAll();break}if(s.list||(s.dataSource instanceof Oe.h&&(s.initRemoteRender=!0),s.renderList()),!s.initRemoteRender){var p=s.getElementByText(e.text);if(!s.checkValidLi(p))if(s.liCollections&&s.liCollections.length===100&&s.getModuleName()==="autocomplete"&&s.listData.length>100)s.setSelectionData(e.text,i.text,"text");else if(e.text&&s.dataSource instanceof Oe.h){var f=s.getItems().length,g=(0,a.le)(s.fields.text)?s.fields.value:s.fields.text;s.typedString="",s.dataSource.executeQuery(s.getQuery(s.query).where(new yt.$(g,"equal",e.text))).then(function(B){B.result.length>0?(r.addItem(B.result,f),r.updateValues()):r.setOldText(i.text)})}else s.setOldText(i.text);s.updateInputFields()}break;case"value":if(e.value===null){s.clearAll();break}if(s.notify("beforeValueChange",{newProp:e}),s.list||(s.dataSource instanceof Oe.h&&(s.initRemoteRender=!0),s.renderList()),!s.initRemoteRender){var C=s.getElementByValue(e.value);if(!s.checkValidLi(C))if(s.liCollections&&s.liCollections.length===100&&s.getModuleName()==="autocomplete"&&s.listData.length>100)s.setSelectionData(e.value,i.value,"value");else if(e.value&&s.dataSource instanceof Oe.h){var L=s.getItems().length,g=(0,a.le)(s.fields.value)?s.fields.text:s.fields.value;s.typedString="",s.dataSource.executeQuery(s.getQuery(s.query).where(new yt.$(g,"equal",e.value))).then(function(H){H.result.length>0?(r.addItem(H.result,L),r.updateValues()):r.setOldValue(i.value)})}else s.setOldValue(i.value);s.updateInputFields(),s.preventChange=s.isAngular&&s.preventChange?!s.preventChange:s.preventChange}break;case"index":if(e.index===null){s.clearAll();break}if(s.list||(s.dataSource instanceof Oe.h&&(s.initRemoteRender=!0),s.renderList()),!s.initRemoteRender&&s.liCollections){var D=s.liCollections[e.index];s.checkValidLi(D)||(s.liCollections&&s.liCollections.length===100&&s.getModuleName()==="autocomplete"&&s.listData.length>100?s.setSelectionData(e.index,i.index,"index"):s.index=i.index),s.updateInputFields()}break;case"footerTemplate":s.popupObj&&s.setFooterTemplate(s.popupObj.element);break;case"headerTemplate":s.popupObj&&s.setHeaderTemplate(s.popupObj.element);break;case"valueTemplate":!(0,a.le)(s.itemData)&&s.valueTemplate!=null&&s.setValueTemplate();break;case"allowFiltering":s.allowFiltering&&(s.actionCompleteData={ulElement:s.ulElement,list:s.listData,isUpdated:!0},s.actionData=s.actionCompleteData,s.updateSelectElementData(s.allowFiltering));break;case"floatLabelType":Ue.removeFloating(s.inputWrapper),Ue.addFloating(s.inputElement,e.floatLabelType,s.placeholder,s.createElement);break;case"showClearButton":Ue.setClearButton(e.showClearButton,s.inputElement,s.inputWrapper,null,s.createElement),s.bindClearEvent();break;default:{var R=s.getPropObject(u,e,i);o.prototype.onPropertyChanged.call(s,R.newProperty,R.oldProperty)}break}},s=this,l=0,h=Object.keys(e);l<h.length;l++){var c=h[l];n(c)}},t.prototype.checkValidLi=function(e){return this.isValidLI(e)?(this.setSelection(e,null),!0):!1},t.prototype.setSelectionData=function(e,i,r){var n=this,s;this.updateListValues=function(){r==="text"?(s=n.getElementByText(e),n.checkValidLi(s)||n.setOldText(i)):r==="value"?(s=n.getElementByValue(e),n.checkValidLi(s)||n.setOldValue(i)):r==="index"&&(s=n.liCollections[e],n.checkValidLi(s)||(n.index=i))}},t.prototype.setReadOnly=function(){this.readonly?(0,a.cn)([this.inputWrapper.container],["e-readonly"]):(0,a.IV)([this.inputWrapper.container],["e-readonly"])},t.prototype.setCssClass=function(e,i){(0,a.le)(i)||(i=i.replace(/\s+/g," ").trim()),(0,a.le)(e)||(e=e.replace(/\s+/g," ").trim()),Ue.setCssClass(e,[this.inputWrapper.container],i),this.popupObj&&Ue.setCssClass(e,[this.popupObj.element],i)},t.prototype.getModuleName=function(){return"dropdownlist"},t.prototype.showPopup=function(){if(!!this.enabled){if(this.isFiltering()&&this.dataSource instanceof Oe.h&&this.actionData.list!==this.actionCompleteData.list&&this.actionData.list&&this.actionData.ulElement&&(this.actionCompleteData=this.actionData,this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list,null,!0)),this.beforePopupOpen){this.refreshPopup();return}this.beforePopupOpen=!0,this.isFiltering()&&!this.isActive&&this.actionCompleteData.list&&this.actionCompleteData.list[0]?(this.isActive=!0,this.onActionComplete(this.actionCompleteData.ulElement,this.actionCompleteData.list,null,!0)):((0,a.le)(this.list)||!(0,a.o8)(this.list)&&(this.list.classList.contains(At.noData)||this.list.querySelectorAll("."+At.li).length<=0))&&this.renderList(),this.invokeRenderPopup()}},t.prototype.invokeRenderPopup=function(){if(a.AR.isDevice&&this.isFilterLayout()){var e=this;window.onpopstate=function(){e.hidePopup()},history.pushState({},"")}(!(0,a.le)(this.list.children[0])||this.list.classList.contains(At.noData))&&this.renderPopup(),(0,a.Y4)(this.targetElement(),{"aria-activedescendant":this.selectedLI?this.selectedLI.id:null})},t.prototype.renderHightSearch=function(){},t.prototype.hidePopup=function(e){if(this.isEscapeKey&&this.getModuleName()==="dropdownlist")if(Ue.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.isEscapeKey=!1,(0,a.le)(this.index))this.resetSelection();else{var i=this.findListElement(this.ulElement,"li","data-value",this.value);this.selectedLI=this.liCollections[this.index]||i,this.selectedLI&&(this.updateSelectedItem(this.selectedLI,null,!0),this.valueTemplate&&this.itemData!==null&&this.setValueTemplate())}this.closePopup();var r=this.getItemData(),n=!(0,a.le)(this.selectedLI);this.inputElement&&this.inputElement.value.trim()===""&&!this.isInteracted&&(this.isSelectCustom||n&&this.inputElement.value!==r.text)&&(this.isSelectCustom=!1,this.clearAll(e))},t.prototype.focusIn=function(e){if(!!this.enabled&&!this.targetElement().classList.contains(mt.disable)){var i=!1;this.preventFocus&&a.AR.isDevice&&(this.inputWrapper.container.tabIndex=1,this.inputWrapper.container.focus(),this.preventFocus=!1,i=!0),i||this.targetElement().focus(),(0,a.cn)([this.inputWrapper.container],[mt.inputFocus]),this.onFocus(e)}},t.prototype.focusOut=function(e){!this.enabled||(this.isTyped=!0,this.hidePopup(e),this.targetElement()&&this.targetElement().blur(),(0,a.IV)([this.inputWrapper.container],[mt.inputFocus]))},t.prototype.destroy=function(){if(this.isActive=!1,Pb(this.element.id),this.isReact&&this.clearTemplate(),this.hidePopup(),this.unWireEvent(),this.list&&this.unWireListEvents(),!(this.element&&!this.element.classList.contains("e-"+this.getModuleName()))){if(this.inputElement){for(var e=["readonly","aria-disabled","aria-placeholder","placeholder","aria-owns","aria-labelledby","aria-haspopup","aria-expanded","aria-activedescendant","autocomplete","aria-readonly","autocorrect","autocapitalize","spellcheck","aria-autocomplete","aria-live","aria-describedby","aria-label"],i=0;i<e.length;i++)this.inputElement.removeAttribute(e[i]);this.inputElement.setAttribute("tabindex",this.tabIndex),this.inputElement.classList.remove("e-input"),Ue.setValue("",this.inputElement,this.floatLabelType,this.showClearButton)}this.element.style.display="block",this.inputWrapper.container.parentElement.tagName===this.getNgDirective()?(0,a.og)(this.inputWrapper.container):(this.inputWrapper.container.parentElement.insertBefore(this.element,this.inputWrapper.container),(0,a.og)(this.inputWrapper.container)),o.prototype.destroy.call(this)}},t.prototype.getItems=function(){return this.list||(this.dataSource instanceof Oe.h&&(this.initRemoteRender=!0),this.renderList()),this.ulElement?o.prototype.getItems.call(this):[]},t.prototype.getDataByValue=function(e){return o.prototype.getDataByValue.call(this,e)},t.prototype.clear=function(){this.value=null},xi([(0,a.Z9)(null)],t.prototype,"cssClass",void 0),xi([(0,a.Z9)("100%")],t.prototype,"width",void 0),xi([(0,a.Z9)("300px")],t.prototype,"popupHeight",void 0),xi([(0,a.Z9)("100%")],t.prototype,"popupWidth",void 0),xi([(0,a.Z9)(null)],t.prototype,"placeholder",void 0),xi([(0,a.Z9)(null)],t.prototype,"filterBarPlaceholder",void 0),xi([(0,a.Z9)({})],t.prototype,"htmlAttributes",void 0),xi([(0,a.Z9)(null)],t.prototype,"query",void 0),xi([(0,a.Z9)(null)],t.prototype,"valueTemplate",void 0),xi([(0,a.Z9)(null)],t.prototype,"headerTemplate",void 0),xi([(0,a.Z9)(null)],t.prototype,"footerTemplate",void 0),xi([(0,a.Z9)(!1)],t.prototype,"allowFiltering",void 0),xi([(0,a.Z9)(!1)],t.prototype,"readonly",void 0),xi([(0,a.Z9)(null)],t.prototype,"text",void 0),xi([(0,a.Z9)(null)],t.prototype,"value",void 0),xi([(0,a.Z9)(null)],t.prototype,"index",void 0),xi([(0,a.Z9)("Never")],t.prototype,"floatLabelType",void 0),xi([(0,a.Z9)(!1)],t.prototype,"showClearButton",void 0),xi([(0,a.ju)()],t.prototype,"filtering",void 0),xi([(0,a.ju)()],t.prototype,"change",void 0),xi([(0,a.ju)()],t.prototype,"beforeOpen",void 0),xi([(0,a.ju)()],t.prototype,"open",void 0),xi([(0,a.ju)()],t.prototype,"close",void 0),xi([(0,a.ju)()],t.prototype,"blur",void 0),xi([(0,a.ju)()],t.prototype,"focus",void 0),t=xi([a.Zl],t),t}(Wb),$u=function(){function o(t){this.data=[],this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener();var t=(0,a.Ys)("#"+this.parent.element.id+"_datavalidation-popup");t&&t.remove(),this.parent=null},o.prototype.addEventListener=function(){a.bi.add(this.parent.element,"dblclick",this.listOpen,this),this.parent.on(E.Z4,this.initiateDataValidationHandler,this),this.parent.on(E.QG,this.invalidDataHandler,this),this.parent.on(ot.tr,this.checkDataValidation,this),this.parent.on(ot.q6,this.listHandler,this),this.parent.on(E.yR,this.keyUpHandler,this),this.parent.on(E.hu,this.removeValidationHandler,this),this.parent.on(w.F5$,this.InvalidElementHandler,this)},o.prototype.removeEventListener=function(){a.bi.remove(this.parent.element,"dblclick",this.listOpen),this.parent.isDestroyed||(this.parent.off(E.Z4,this.initiateDataValidationHandler),this.parent.off(E.QG,this.invalidDataHandler),this.parent.off(ot.tr,this.checkDataValidation),this.parent.off(ot.q6,this.listHandler),this.parent.off(E.yR,this.keyUpHandler),this.parent.off(E.hu,this.removeValidationHandler),this.parent.off(w.F5$,this.InvalidElementHandler))},o.prototype.removeValidationHandler=function(t){var e,i;if(t.range&&t.range.includes("!")){if(i=t.range,e=(0,w.zfV)(this.parent,(0,w.Q8D)(this.parent,i.split("!")[0])),!e)return}else e=this.parent.getActiveSheet(),i=e.name+"!"+(t.range||this.getRange(e.selectedRange));var r={range:i,cancel:!1};if(t.isAction&&this.parent.notify(w.ya2,{eventArgs:r,action:"removeValidation"}),!r.cancel){var n=void 0,s=void 0,l=(0,pe.dK5)(e.activeCell);if(e.name===this.parent.getActiveSheet().name){var h=(0,w.gaE)((0,pe.dK5)(i));l[0]>=h[0]&&l[1]>=h[1]&&l[0]<=h[2]&&l[1]<=h[3]&&(s=(0,zr.$S)(l[0],l[1],e,!1,!0),n=s.validation&&s.validation.type==="List")}if(this.parent.notify(pe.dKh,{range:i,isRemoveValidation:!0}),n&&!s.validation){var c=this.parent.getCell(l[0],l[1]);c&&c.getElementsByClassName("e-validation-list")[0]&&(this.listObj.destroy(),c.removeChild(c.getElementsByClassName("e-validation-list")[0]))}t.isAction&&(delete r.cancel,this.parent.notify(E.Av,{eventArgs:r,action:"removeValidation"}))}},o.prototype.keyUpHandler=function(t){var e=t.target,i=this.parent.element.querySelector(".e-datavalidation-dlg");if((0,a.oq)(e,".e-values")&&i&&t.keyCode!==13){var r=i.querySelector(".e-values"),n=r.querySelector(".e-dlg-error"),s=i.querySelector(".e-footer-content"),l=s.querySelector(".e-primary");l.hasAttribute("disabled")&&l.removeAttribute("disabled"),n&&r.removeChild(n)}},o.prototype.listOpen=function(t){var e=t.target;this.listObj&&e.classList.contains("e-cell")&&e.querySelector(".e-validation-list")&&this.listObj.showPopup()},o.prototype.invalidDataHandler=function(t){var e={range:t.range||this.parent.dataValidationRange,cancel:!1};if(!!e.range){var i;!t.isPublic&&(i={eventArgs:e,action:t.isRemoveHighlight?"removeHighlight":"addHighlight"},this.parent.notify(w.ya2,i),e.cancel)||(t.isRemoveHighlight?this.parent.removeInvalidHighlight(e.range):this.parent.addInvalidHighlight(e.range),t.isPublic||this.parent.notify(E.Av,i))}},o.prototype.listHandler=function(){var t=this;if(this.parent.allowDataValidation){var e=this.parent.getActiveSheet(),i=(0,pe.n53)(e.activeCell),r=(0,zr.$S)(i[0],i[1],e),n=this.parent.getCell(i[0],i[1]);if(!n)return;document.getElementsByClassName("e-validation-list")[0]&&((0,a.Od)(document.getElementsByClassName("e-validation-list")[0]),this.data=[]);var s=r&&r.validation||e.columns&&e.columns[i[1]]&&e.columns[i[1]].validation;if(s&&s.type==="List"){if(s.address&&!(0,pe.ZsD)(s.address,i[0],i[1]))return;if(s.ignoreBlank=(0,a.le)(s.ignoreBlank)?!0:s.ignoreBlank,s.inCellDropDown=(0,a.le)(s.inCellDropDown)?!0:s.inCellDropDown,s.inCellDropDown){var l=this.parent.createElement("div",{className:"e-validation-list"}),h=this.parent.createElement("input",{id:this.parent.element.id+"listValid"});l.appendChild(h),s.inCellDropDown||(l.style.display="none");var c=n.getElementsByClassName("e-wrap-content")[0]||n;c.insertBefore(l,c.firstChild);var u=this.updateDataSource(r,s);this.listObj=new mn({index:this.setDropDownListIndex(u,r),dataSource:u,fields:{text:"text",value:"id"},width:"0px",popupHeight:"200px",change:function(){return t.listValueChange(t.listObj.text)},open:function(p){if(p.popup.offsetX=-(n.offsetWidth-20)+4,p.popup.offsetY=-13,p.popup.element.style.width=n.offsetWidth-1+"px",a.AR.isDevice&&t.parent.scrollModule){var f=t.parent.scrollModule.offset,g=t.parent.viewport;p.popup.offsetY+=g.topIndex?f.top.size-(0,w.EB_)(e,g.topIndex+1,f.top.idx,!0):0,p.popup.offsetX+=g.leftIndex?f.left.size-(0,w.pGm)(e,g.leftIndex+1,f.left.idx,!0):0,p.popup.refresh()}},close:function(){return we(t.parent.element)}}),this.listObj.appendTo("#"+this.parent.element.id+"listValid")}}r&&r.validation&&(r.validation=s)}},o.prototype.setDropDownListIndex=function(t,e){if(e&&e.value){for(var i=0,r=t.length;i<r;i++)if(t[i].text===e.value.toString())return i}return null},o.prototype.updateDataSource=function(t,e){var i=this;this.data=[];var r=0,n=this.parent.definedNames,s=e.value1,l=s.indexOf("=")!==-1;if(n.length>0&&l){for(var h=s.split("=")[1],c=0,u=n.length;c<u;c++)if(n[c].name===h){for(var p=n[c].refersTo;p.includes("'");)p=p.replace("'","");s=p}}if(l){var f=s.indexOf("!")>-1?(0,w.zfV)(this.parent,(0,w.Q8D)(this.parent,s.split("=")[1].split("!")[0])):this.parent.getActiveSheet(),g=s.indexOf("!")>-1?s.split("!")[1]:s.split("=")[1],C=this.parent.getActiveSheet();if(f.name!==C.name){var L,D=(0,pe.dK5)(C.selectedRange);f.ranges.forEach(function(me){if(!me.info||!me.info.loadedRange||!me.info.loadedRange.length){L=!0;return}}),L&&(this.parent.showSpinner(),(0,w.YuF)(this.parent,f.name+"!"+g).then(function(){if(i.parent.hideSpinner(),C.name===i.parent.getActiveSheet().name){var me=(0,pe.dK5)(i.parent.getActiveSheet().selectedRange);me[0]===D[0]&&me[1]===D[1]&&(i.listObj.dataSource=i.updateDataSource(t,e),i.listObj.dataBind())}}))}var R=void 0,B=g.split(":");if(B[0].match(/[a-z]+$/ig)&&B[1].match(/[a-z]+$/ig)||B[0].match(/^[0-9]/g)&&B[1].match(/^[0-9]/g)){var H=this.parent.getIndexes(g);H.isCol?R=[0,H.startIdx,f.usedRange.rowIndex,H.startIdx]:R=[H.startIdx,0,H.startIdx,f.usedRange.colIndex]}else R=(0,pe.dK5)(g);for(var j=R[0];j<=R[2];j++){f.rows[j]||(0,w.ZG6)(f,j,{});for(var W=R[1];W<=R[3];W++){f.rows[j].cells||(0,zr.Jx)(j,W,f,{}),r+=1,t=f.rows[j].cells[W];var ne=this.parent.getDisplayText(t)||"";this.data.push({text:ne,id:"list-"+r})}}}else for(var ie=s.split(","),c=0;c<ie.length;c++)r+=1,this.data.push({text:ie[c],id:"list-"+r});return this.data},o.prototype.listValueChange=function(t){this.parent.notify(E.GN,{action:"refreshFormulabar",value:t});var e=this.parent.getActiveSheet(),i=(0,pe.IRR)(e.activeCell),r=Object.assign({},(0,zr.$S)(i[0],i[1],e));e.isProtected&&(0,w.p1d)(r,(0,w.wDo)(e,i[1]))?this.parent.notify(E.Gn,null):((0,pe.wWT)(this.parent,e,{cell:{value:t},rowIdx:i[0],colIdx:i[1],valChange:!0,lastCell:!0,uiRefresh:!0,checkCf:!0}),this.parent.notify(E.Av,{action:"cellSave",eventArgs:{value:t,oldValue:r.value,address:e.name+"!"+e.activeCell}}))},o.prototype.getRange=function(t){var e=(0,pe.dK5)(t),i=this.parent.getActiveSheet(),r=i.rowCount,n=i.colCount;return e[2]===r-1&&e[0]===0?t=t.replace(/[0-9]/g,""):e[3]===n-1&&e[2]===0&&(t=t.replace(/\D/g,"")),t},o.prototype.initiateDataValidationHandler=function(t,e){var i=this,r=this.parent.serviceLocator.getService(Ve),n,s,l,h,c=!0,u=!0,p=!0,f=this.parent.getActiveSheet(),g,C=f.selectedRange,L=(0,w.gaE)((0,pe.dK5)(C));C=this.getRange(C);var D=this.validateRange(L,f);if(!D.extendValidation&&!D.moreValidation||t){for(var R=L[0];R<=L[2];R++)if(f.rows[R])for(var B=L[1];B<=L[3];B++)f.rows[R].cells&&f.rows[R].cells[B]&&(g=f.rows[R].cells[B],g.validation&&(p=!1,n=g.validation.type,s=g.validation.operator,l=g.validation.value1,h=g.validation.value2,c=(0,a.le)(g.validation.ignoreBlank)?c:g.validation.ignoreBlank,u=(0,a.le)(g.validation.inCellDropDown)?u:g.validation.inCellDropDown));if(p)for(var H=L[1];H<=L[3];H++){var j=(0,w.wDo)(f,H);j&&j.validation&&(p=!1,n=j.validation.type,s=j.validation.operator,l=j.validation.value1,h=j.validation.value2,c=(0,a.le)(j.validation.ignoreBlank)?c:j.validation.ignoreBlank,u=(0,a.le)(j.validation.inCellDropDown)?u:j.validation.inCellDropDown)}if(!this.parent.element.querySelector(".e-datavalidation-dlg")){var W=this.parent.serviceLocator.getService(Yt);W.show({width:375,showCloseIcon:!0,isModal:!0,cssClass:"e-datavalidation-dlg",header:r.getConstant("DataValidation"),target:document.querySelector(".e-control.e-spreadsheet"),beforeOpen:function(ne){var ie={dialogName:"ValidationDialog",element:ne.element,target:ne.target,cancel:ne.cancel};i.parent.trigger("dialogBeforeOpen",ie),ie.cancel&&(ne.cancel=!0),e&&(p=!0),W.dialogInstance.content=i.dataValidationContent(p,n,s,l,h,c,u,C),W.dialogInstance.dataBind(),we(i.parent.element)},buttons:[{buttonModel:{content:r.getConstant("CLEARALL"),cssClass:"e-btn e-clearall-btn e-flat"},click:function(){W.dialogInstance.content=i.dataValidationContent(!0,n,s,l,h,c,u,C),W.dialogInstance.dataBind(),we(i.parent.element)}},{buttonModel:{content:r.getConstant("APPLY"),isPrimary:!0},click:function(){i.dlgClickHandler(W)}}]}),W.dialogInstance.refresh()}}else D.moreValidation&&this.moreValidationDlg(),D.extendValidation&&this.extendValidationDlg()},o.prototype.dataValidationContent=function(t,e,i,r,n,s,l,h){var c=this,u=this.parent.serviceLocator.getService(Ve),p=t?"0":r,f=t?"0":n,g=this.parent.createElement("div",{className:"e-validation-dlg"}),C=this.parent.createElement("div",{className:"e-cellrange"}),L=this.parent.createElement("div",{className:"e-allowdata"}),D=this.parent.createElement("div",{className:"e-values"}),R=this.parent.createElement("div",{className:"e-ignoreblank"});g.appendChild(C),g.appendChild(L),g.appendChild(D),g.appendChild(R);var B=this.parent.createElement("span",{className:"e-header",innerHTML:u.getConstant("CellRange")}),H=this.parent.createElement("input",{className:"e-input",attrs:{value:h}});C.appendChild(B),C.appendChild(H);var j=this.parent.createElement("div",{className:"e-allow"}),W=this.parent.createElement("div",{className:"e-data"});L.appendChild(j),L.appendChild(W);var ne=this.parent.createElement("span",{className:"e-header",innerHTML:u.getConstant("Allow")});this.typeData=[{text:u.getConstant("WholeNumber"),id:"type-1"},{text:u.getConstant("Decimal"),id:"type-2"},{text:u.getConstant("Date"),id:"type-3"},{text:u.getConstant("Time"),id:"type-4"},{text:u.getConstant("TextLength"),id:"type-5"},{text:u.getConstant("List"),id:"type-6"}],this.operatorData=[{text:u.getConstant("Between"),id:"operator-1"},{text:u.getConstant("NotBetween"),id:"operator-2"},{text:u.getConstant("EqualTo"),id:"operator-3"},{text:u.getConstant("NotEqualTo"),id:"operator-4"},{text:u.getConstant("Greaterthan"),id:"operator-5"},{text:u.getConstant("Lessthan"),id:"operator-6"},{text:u.getConstant("GreaterThanOrEqualTo"),id:"operator-7"},{text:u.getConstant("LessThanOrEqualTo"),id:"operator-8"}];var ie=this.parent.createElement("input",{className:"e-select"}),me=0;if(!t){for(var ve=0;ve<this.typeData.length;ve++)if(e===this.typeData[ve].text.replace(" ","")){me=ve;break}}if(t||e!=="List"){var Ee=0,le=this.parent.createElement("span",{className:"e-header",innerHTML:u.getConstant("Data")}),de=this.parent.createElement("input",{className:"e-select"});if(!t){for(var ve=0;ve<this.operatorData.length;ve++)if(i===this.FormattedValue(this.operatorData[ve].text)){Ee=ve;break}}W.appendChild(le),W.appendChild(de),this.dataList=new mn({dataSource:this.operatorData,index:Ee,popupHeight:"200px",change:function(){c.userInput(ke,c.dataList)}}),this.dataList.appendTo(de)}else{var fe=this.parent.createElement("input",{className:"e-checkbox"});W.appendChild(fe);var Le=new Yn({label:u.getConstant("InCellDropDown"),checked:l});Le.appendTo(fe)}j.appendChild(ne),j.appendChild(ie);var ke=new mn({dataSource:this.typeData,index:me,popupHeight:"200px",change:function(){c.userInput(ke,c.dataList)}});if(ke.appendTo(ie),t||ke.value!=="List"&&(this.dataList.value==="Between"||this.dataList.value==="Not between")){var Me=this.parent.createElement("div",{className:"e-minimum"}),De=this.parent.createElement("div",{className:"e-maximum"});D.appendChild(Me),D.appendChild(De);var Fe=this.parent.createElement("span",{className:"e-header",innerHTML:u.getConstant("Minimum")}),Pe=this.parent.createElement("span",{className:"e-header",innerHTML:u.getConstant("Maximum")}),Ye=this.parent.createElement("input",{id:"minvalue",className:"e-input",attrs:{value:p}}),Ze=this.parent.createElement("input",{id:"maxvalue",className:"e-input",attrs:{value:f}});Me.appendChild(Fe),Me.appendChild(Ye),De.appendChild(Pe),De.appendChild(Ze);var nt=new Zn({value:0});nt.appendTo("#minvalue");var it=new Zn({value:0});it.appendTo("#maxvalue")}else if(!t&&e===" List"){var et=this.parent.createElement("span",{className:"e-header",innerHTML:u.getConstant("Sources")}),at=this.parent.createElement("input",{className:"e-input",attrs:{value:p}});D.appendChild(et),D.appendChild(at)}else{var et=this.parent.createElement("span",{className:"e-header",innerHTML:u.getConstant("Value")}),at=this.parent.createElement("input",{className:"e-input",attrs:{value:p}});D.appendChild(et),D.appendChild(at)}var Ge=s,gt=this.parent.createElement("input",{className:"e-checkbox"});R.appendChild(gt);var ge=new Yn({label:u.getConstant("IgnoreBlank"),checked:Ge});return ge.appendTo(gt),g},o.prototype.validateRange=function(t,e){for(var i=!1,r=!1,n=[],s=[],l=[],h=[],c=t[0];c<=t[2];c++)if(e.rows[c]){for(var u=t[1];u<=t[3];u++)if(e.rows[c].cells&&e.rows[c].cells[u]){var p=e.rows[c].cells[u];p.validation&&(n.push(p.validation.type),s.push(p.validation.operator),l.push(p.validation.value1),h.push(p.validation.value2))}}for(var f=t[1];f<=t[3];f++){var g=(0,w.wDo)(e,f);g&&g.validation&&(n.push(g.validation.type),s.push(g.validation.operator),l.push(g.validation.value1),h.push(g.validation.value2))}for(var C=[],f=0;f<n.length;f++)C.indexOf(n[f])===-1&&C.push(n[f]);if(C.length>1&&(i=!0),!i){C=[];for(var L=0;L<s.length;L++)C.indexOf(s[L])===-1&&C.push(s[L]);C.length>1&&(i=!0)}if(!i){C=[];for(var L=0;L<l.length;L++)C.indexOf(l[L])===-1&&C.push(l[L]);C.length>1&&(i=!0)}if(!i){C=[];for(var L=0;L<h.length;L++)C.indexOf(h[L])===-1&&C.push(h[L]);C.length>1&&(i=!0)}if(!i){for(var D=0,R=0,B=t[0];B<=t[2];B++)if(e.rows[B]){for(var u=t[1];u<=t[3];u++)if(e.rows[B].cells&&e.rows[B].cells[u]){var p=e.rows[B].cells[u];R++,p.validation&&D++}}if(D===0)for(var f=t[1];f<=t[3];f++){var g=(0,w.wDo)(e,f);g&&g.validation&&D++}D>0&&R>1&&D!==R&&(r=!0)}return{moreValidation:i,extendValidation:r}},o.prototype.moreValidationDlg=function(){var t=this,e=this.parent.serviceLocator.getService(Ve),i=this.parent.serviceLocator.getService(Yt),r=!1,n={width:350,isModal:!0,showCloseIcon:!0,cssClass:"e-goto-dlg",header:e.getConstant("Spreadsheet"),beforeOpen:function(s){var l={dialogName:"MoreValidation",element:s.element,target:s.target,cancel:s.cancel};t.parent.trigger("dialogBeforeOpen",l),l.cancel&&(s.cancel=!0),i.dialogInstance.content=e.getConstant("MoreValidation"),i.dialogInstance.dataBind(),we(t.parent.element)},buttons:[{buttonModel:{content:e.getConstant("Ok"),isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){i.hide(),r=!0}}],close:function(){r?(t.initiateDataValidationHandler(!0),r=!1):i.hide()}};i.show(n)},o.prototype.extendValidationDlg=function(){var t=this,e=this.parent.serviceLocator.getService(Ve),i=this.parent.serviceLocator.getService(Yt),r=!1,n=!1,s={width:550,isModal:!0,showCloseIcon:!0,cssClass:"e-goto-dlg",header:e.getConstant("Spreadsheet"),beforeOpen:function(l){var h={dialogName:"ExtendValidation",element:l.element,target:l.target,cancel:l.cancel};t.parent.trigger("dialogBeforeOpen",h),h.cancel&&(l.cancel=!0),i.dialogInstance.content=e.getConstant("ExtendValidation"),i.dialogInstance.dataBind(),we(t.parent.element)},buttons:[{buttonModel:{content:e.getConstant("Yes"),isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){i.hide(),r=!0}},{buttonModel:{content:e.getConstant("No"),isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){i.hide(),r=!0,n=!0}}],close:function(){r?(t.initiateDataValidationHandler(!0,n),r=!1):i.hide()}};i.show(s)},o.prototype.userInput=function(t,e){for(var i=this.parent.element.querySelector(".e-datavalidation-dlg"),r=i.querySelector(".e-validation-dlg"),n=r.querySelector(".e-allowdata"),s=r.querySelector(".e-values"),l=this.parent.serviceLocator.getService(Ve),h=n.querySelector(".e-data");s.lastChild;)s.removeChild(s.lastChild);if(t.value==="List"){for(;h.lastChild;)h.removeChild(h.lastChild);var c=this.parent.createElement("input",{className:"e-checkbox"});h.appendChild(c);var u=new Yn({label:l.getConstant("InCellDropDown"),checked:!0});u.appendTo(c)}else if(h.getElementsByClassName("e-checkbox-wrapper")[0]){for(;h.lastChild;)h.removeChild(h.lastChild);var p=this.parent.createElement("span",{className:"e-header",innerHTML:"Data"}),f=this.parent.createElement("input",{className:"e-select"});h.appendChild(p),h.appendChild(f),e.appendTo(f)}if(t.value!=="List"&&(e.value==="Between"||e.value==="Not between")){var g=this.parent.createElement("div",{className:"e-minimum"}),C=this.parent.createElement("div",{className:"e-maximum"});s.appendChild(g),s.appendChild(C);var L=this.parent.createElement("span",{className:"e-header",innerHTML:l.getConstant("Minimum")}),D=this.parent.createElement("span",{className:"e-header",innerHTML:l.getConstant("Maximum")}),R=this.parent.createElement("input",{id:"min",className:"e-input",attrs:{value:"0"}}),B=this.parent.createElement("input",{id:"max",className:"e-input",attrs:{value:"0"}}),H=new Zn({value:0});H.appendTo("min");var j=new Zn({value:0});j.appendTo("max"),g.appendChild(L),g.appendChild(R),C.appendChild(D),C.appendChild(B)}else{var W=t.value==="List"?l.getConstant("Sources"):l.getConstant("Value"),ne=this.parent.createElement("span",{className:"e-header",innerHTML:W}),ie=t.value==="List"?this.parent.createElement("input",{className:"e-input",attrs:{placeholder:"Enter value"}}):this.parent.createElement("input",{className:"e-input",attrs:{value:"0"}});s.appendChild(ne),s.appendChild(ie)}},o.prototype.dlgClickHandler=function(t){var e=this.parent.serviceLocator.getService(Ve),i,r=this.parent.element.querySelector(".e-datavalidation-dlg"),n=r.querySelector(".e-footer-content"),s=r.getElementsByClassName("e-dlg-content")[0].getElementsByClassName("e-validation-dlg")[0],l=s.getElementsByClassName("e-allowdata")[0],h=l.getElementsByClassName("e-allow")[0].getElementsByTagName("input")[0],c=l.getElementsByClassName("e-data")[0].getElementsByTagName("input")[0],u=s.getElementsByClassName("e-values")[0],p=u.getElementsByTagName("input")[0].value,f=u.getElementsByTagName("input")[1]?u.getElementsByTagName("input")[1].value:"",g=s.querySelector(".e-ignoreblank .e-checkbox").checked,C=l.querySelector(".e-data").querySelector(".e-checkbox-wrapper")?!!l.querySelector(".e-data").querySelector(".e-checkbox-wrapper").querySelector(".e-check"):null,L=s.querySelector(".e-cellrange").getElementsByTagName("input")[0].value,D,R=h.value;c&&(D=c.value,D=this.FormattedValue(D)),R&&(R=R.replace(" ",""));var B=[],H=[];p!==""&&H.push(p),f!==""&&H.push(f);var j=!0;if(R==="List")if(p.indexOf("=")!==-1){if(p.indexOf(":")!==-1){var W=p.indexOf("!")>-1?p.split("!")[1]:p.split("=")[1],ne=p.indexOf("!")>-1?(0,w.Q8D)(this.parent,p.split("=")[1].split("!")[0])>-1:!0;B=W.split(":");var ie=W.match(/[a-z]/gi)?B[0].replace(/[0-9]/g,"")===B[1].replace(/[0-9]/g,""):!1,me=W.match(/\d/g)?B[0].replace(/\D/g,"")===B[1].replace(/\D/g,""):!1;j=ne?ie?!0:!!me:!1,j||(i=e.getConstant("DialogError"))}}else p.length>256&&(j=!1,i=e.getConstant("ListLengthError"));if(j){var ve=this.parent.getActiveSheet(),Ee=R,le=this.isDialogValidator(H,Ee,D);if(D==="Between"&&!isNaN(parseFloat(p))&&!isNaN(parseFloat(f))&&parseFloat(p)>parseFloat(f)&&(le.isValidate=!1,le.errorMsg=e.getConstant("MinMaxError")),i=le.errorMsg,j=le.isValidate,j){var de=(0,pe.n53)(ve.activeCell),fe=(0,zr.$S)(de[0],de[1],ve,!1,!0),Le=fe.validation&&fe.validation.type==="List",ke={range:ve.name+"!"+L,value1:p,value2:f,ignoreBlank:g,type:R,operator:D,inCellDropDown:C,cancel:!1};if(this.parent.notify(w.ya2,{eventArgs:ke,action:"validation"}),!ke.cancel){if(this.parent.notify(pe.dKh,{rules:{type:ke.type,operator:ke.operator,value1:ke.value1,value2:f,ignoreBlank:ke.ignoreBlank,inCellDropDown:ke.inCellDropDown},range:ke.range}),fe=(0,zr.$S)(de[0],de[1],ve,!1,!0),fe.validation){if(Le){var Me=this.parent.getCell(de[0],de[1]);Me&&Me.getElementsByClassName("e-validation-list")[0]&&(this.listObj.destroy(),Me.removeChild(Me.getElementsByClassName("e-validation-list")[0]))}fe.validation.type==="List"&&this.listHandler()}delete ke.cancel,this.parent.notify(E.Av,{eventArgs:ke,action:"validation"}),document.getElementsByClassName("e-validationerror-dlg")[0]||(t.dialogInstance?t.dialogInstance.hide():t.hide())}}}if(!j){var De=this.parent.createElement("div",{className:"e-dlg-error",id:"e-invalid",innerHTML:i});u.appendChild(De),n.querySelector(".e-primary").setAttribute("disabled","true")}},o.prototype.FormattedValue=function(t){switch(t){case"Between":t="Between";break;case"Not between":t="NotBetween";break;case"Equal to":t="EqualTo";break;case"Not equal to":t="NotEqualTo";break;case"Greater than":t="GreaterThan";break;case"Less than":t="LessThan";break;case"Greater than or equal to":t="GreaterThanOrEqualTo";break;case"Less than or equal to":t="LessThanOrEqualTo";break;default:t="Between";break}return t},o.prototype.isDialogValidator=function(t,e,i){var r=this.parent.serviceLocator.getService(Ve),n=0,s=!1,l;if(e==="List"?s=!(t.length>0):i==="Between"||i==="NotBetween"?s=t.length!==2:s=!(t.length>0),s)l={isValidate:!1,errorMsg:r.getConstant("EmptyError")};else{for(var h=0;h<t.length;h++){var c=(0,w.C2M)(t[h])?this.parent.computeExpression(t[h]).toString():t[h];if(l=this.formatValidation(c,e),l.isValidate)n=n+1;else break}l.isValidate=n===t.length}return{isValidate:l.isValidate,errorMsg:l.errorMsg}},o.prototype.isValidationHandler=function(t){var e=this.parent.serviceLocator.getService(Ve);t.value=t.value?t.value:"";var i,r,n=t.value,s=this.parent.sheets[t.sheetIdx],l,h=(0,zr.$S)(t.range[0],t.range[1],s),c=(0,w.wDo)(s,t.range[1]);if(h&&h.validation?l=h.validation:(0,w.ekG)(c,t.range[0],t.range[1])&&(l=c.validation),l){var u=l.value1,p=l.value2;(0,w.C2M)(u)&&l.type!=="List"&&(u=this.parent.computeExpression(u).toString()),(0,w.C2M)(p)&&l.type!=="List"&&(p=this.parent.computeExpression(p).toString()),(0,w.C2M)(t.value)&&l.type!=="List"&&(t.value=this.parent.computeExpression(t.value).toString());var f=t.value,g=l.operator||"Between",C=l.type||"WholeNumber",L=(0,a.le)(l.ignoreBlank)?!0:l.ignoreBlank,D=this.formatValidation(t.value,C);if(i=D.isValidate,r=D.errorMsg,i){if(i=!1,C==="Date"||C==="Time"){t.value=t.value.toString().slice(t.value.toString().indexOf(" ")+1,t.value.length);for(var R=0;R<3;R++){t.value=R===0?t.value:R===1?u:p;var B={value:t.value,rowIndex:t.range[0],colIndex:t.range[1],sheetIndex:t.sheetIdx,updatedVal:""};t.value!==""&&this.parent.notify(ot.w0,B);var H=B.updatedVal;R===0&&H===""?f=t.value:R===0?f=H:R===1?u=H:p=H}}else if(l.type==="TextLength"){var B={value:t.value,rowIndex:t.range[0],colIndex:t.range[1],sheetIndex:t.sheetIdx,updatedVal:""};this.parent.notify(ot.w0,B);var H=B.updatedVal;H!==""?f=H.toString().length.toString():f=t.value.toString().length.toString()}if(C==="List")if(u.indexOf("=")!==-1)for(var R=0;R<this.data.length;R++)t.value.toString()===this.data[R].text&&(i=!0);else for(var j=u.split(","),R=0;R<j.length;R++)t.value.toString()===j[R]&&(i=!0);else switch(C==="Decimal"||C==="Time"?(f=parseFloat(f.toString()),u=parseFloat(u.toString()),p=p?parseFloat(p.toString()):null):(f=parseInt(f.toString(),10),u=parseInt(u.toString(),10),p=p?parseInt(p.toString(),10):null),g){case"EqualTo":f===u||L&&n===""?i=!0:i=!1;break;case"NotEqualTo":f!==u||L&&n===""?i=!0:i=!1;break;case"Between":f>=u&&f<=p||L&&n===""?i=!0:i=!1;break;case"NotBetween":f>=u&&f<=p?i=!1:i=!0;break;case"GreaterThan":f>u||L&&n===""?i=!0:i=!1;break;case"LessThan":f<u||L&&n===""?i=!0:i=!1;break;case"GreaterThanOrEqualTo":f>=u||L&&n===""?i=!0:i=!1;break;case"LessThanOrEqualTo":f<=u||L&&n===""?i=!0:i=!1;break;default:break}}}if(r=e.getConstant("ValidationError"),i&&h&&h.validation&&h.validation.isHighlighted){var W=this.parent.getCellStyleValue(["backgroundColor","color"],[t.range[0],t.range[1]]);(0,w.gSQ)(s,t.range[0])||this.parent.notify(ot.nJ,{style:W,rowIdx:t.range[0],colIdx:t.range[1],isHeightCheckNeeded:!0,manualUpdate:!0,onActionUpdate:!0,cell:t.td})}return{isValidate:i,errorMsg:r}},o.prototype.checkDataValidation=function(t){var e=(0,zr.$S)(t.range[0],t.range[1],this.parent.getActiveSheet());t.td=t.td||this.parent.getCell(t.range[0],t.range[1]),t.sheetIdx=t.sheetIdx||this.parent.activeSheetIndex;var i={skip:!1,value:""};if(e&&e.validation){if((0,w.C2M)(e.validation.value1)&&!(0,w.qhV)(e.validation.value1.substring(1,e.validation.value1.length))&&e.validation.value1.indexOf("(")>-1){var r=e.validation.value1;r=r.substring(r.indexOf("=")+1,r.indexOf("(")),i.value=r.toUpperCase(),this.parent.notify(w.AVn,i)}if(!i.skip&&(0,w.C2M)(e.validation.value2)&&!(0,w.qhV)(e.validation.value2.substring(1,e.validation.value2.length))&&e.validation.value1.indexOf("(")>-1){var n=e.validation.value2;n=n.substring(n.indexOf("=")+1,n.indexOf("(")),i.value=n.toUpperCase(),this.parent.notify(w.AVn,i)}}if(!i.skip){var s=this.isValidationHandler({value:t.value,range:t.range,sheetIdx:t.sheetIdx,td:t.td});!s.isValidate&&t.isCell&&this.validationErrorHandler(s.errorMsg),t.isValid=s.isValidate}},o.prototype.formatValidation=function(t,e){var i=this.parent.element.getElementsByClassName("e-sheet-panel")[0],r,n=this.parent.createElement("form",{id:"formId",className:"form-horizontal"}),s=this.parent.createElement("input",{id:"e-validation",innerHTML:t});s.setAttribute("name","validation"),s.setAttribute("type","text"),s.setAttribute("value",t),n.appendChild(s),i.appendChild(n);var l;switch(e){case"Date":l={rules:{validation:{date:!0}},customPlacement:function(u,p){r=p.innerText}};break;case"Decimal":l={rules:{validation:{number:!0}},customPlacement:function(u,p){r=p.innerText}};break;case"WholeNumber":l={rules:{validation:{regex:/^\d*\.?[0]*$/}},customPlacement:function(u,p){r=p.innerText}};break;default:break}var h=new kb("#formId",l),c=h.validate();return i.removeChild(i.getElementsByClassName("form-horizontal")[0]),{isValidate:c,errorMsg:r}},o.prototype.InvalidElementHandler=function(t){var e=t.rowIdx,i=t.colIdx,r=t.isRemoveHighlightedData;if(!r)this.parent.notify(ot.nJ,{style:{backgroundColor:"#ffff00",color:"#ff0000"},rowIdx:e,colIdx:i,cell:t.td});else if(r){var n=this.parent.getCellStyleValue(["backgroundColor","color"],[e,i]);this.parent.notify(ot.nJ,{style:n,rowIdx:e,colIdx:i,cell:t.td})}},o.prototype.validationErrorHandler=function(t){var e=this,i=document.getElementsByClassName("e-spreadsheet-edit")[0],r=this.parent.serviceLocator.getService(Ve);if(!this.parent.element.querySelector(".e-validationerror-dlg")){var n=this.parent.serviceLocator.getService(Yt),s=!1,l={width:400,height:200,isModal:!0,showCloseIcon:!0,cssClass:"e-validationerror-dlg",target:document.querySelector(".e-control.e-spreadsheet"),beforeOpen:function(h){var c={dialogName:"ValidationErrorDialog",element:h.element,target:h.target,cancel:h.cancel,content:t};e.parent.trigger("dialogBeforeOpen",c),c.cancel&&(e.errorDlgHandler(n,"Cancel"),h.cancel=!0),i.focus(),n.dialogInstance.content=c.content,n.dialogInstance.dataBind()},buttons:[{buttonModel:{content:r.getConstant("Retry"),isPrimary:!0},click:function(){e.errorDlgHandler(n,"Retry")}},{buttonModel:{content:r.getConstant("Cancel")},click:function(){e.errorDlgHandler(n,"Cancel")}}]};n.show(l,s)}},o.prototype.errorDlgHandler=function(t,e){if(e==="Retry"){var i=document.getElementsByClassName("e-spreadsheet-edit")[0];t.hide(),i.innerText&&(window.getSelection().selectAllChildren(i),this.listObj&&this.listObj.showPopup())}else{var r=(0,pe.n53)(this.parent.getActiveSheet().activeCell),n=(0,zr.$S)(r[0],r[1],this.parent.getActiveSheet()),s=n?this.parent.getDisplayText(n):"";this.parent.notify(E.vJ,{action:"cancelEdit",value:s,refreshFormulaBar:!0,refreshEditorElem:!0,isAppend:!1,trigEvent:!0}),t.hide()}},o.prototype.getModuleName=function(){return"dataValidation"},o}(),pv=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ei=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},dv={None:[],SlideLeft:["SlideRightOut","SlideLeftOut","SlideLeftIn","SlideRightIn"],SlideDown:["SlideTopOut","SlideBottomOut","SlideBottomIn","SlideTopIn"],Zoom:["FadeOut","FadeZoomOut","FadeZoomIn","FadeIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},Zb={None:[],SlideLeft:["SlideLeftOut","SlideRightOut","SlideRightIn","SlideLeftIn"],SlideDown:["SlideBottomOut","SlideTopOut","SlideTopIn","SlideBottomIn"],Zoom:["FadeZoomOut","FadeOut","FadeIn","FadeZoomIn"],Fade:["FadeOut","FadeOut","FadeIn","FadeIn"]},Be={root:"e-listview",hover:"e-hover",selected:"e-active",focused:"e-focused",parentItem:"e-list-parent",listItem:"e-list-item",listIcon:"e-list-icon",textContent:"e-text-content",listItemText:"e-list-text",groupListItem:"e-list-group-item",hasChild:"e-has-child",view:"e-view",header:"e-list-header",headerText:"e-headertext",headerTemplateText:"e-headertemplate-text",text:"e-text",disable:"e-disabled",content:"e-content",icon:"e-icons",backIcon:"e-icon-back",backButton:"e-back-button",checkboxWrapper:"e-checkbox-wrapper",checkbox:"e-checkbox",checked:"e-check",checklist:"e-checklist",checkboxIcon:"e-frame",checkboxRight:"e-checkbox-right",checkboxLeft:"e-checkbox-left",listviewCheckbox:"e-listview-checkbox",itemCheckList:"e-checklist",virtualElementContainer:"e-list-virtualcontainer"},fv="Template",vv="GroupTemplate",Yb="HeaderTemplate",Gb=.5,Kb=function(o){pv(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ei([(0,a.Z9)("id")],t.prototype,"id",void 0),ei([(0,a.Z9)("text")],t.prototype,"text",void 0),ei([(0,a.Z9)("isChecked")],t.prototype,"isChecked",void 0),ei([(0,a.Z9)("isVisible")],t.prototype,"isVisible",void 0),ei([(0,a.Z9)("enabled")],t.prototype,"enabled",void 0),ei([(0,a.Z9)("iconCss")],t.prototype,"iconCss",void 0),ei([(0,a.Z9)("child")],t.prototype,"child",void 0),ei([(0,a.Z9)("tooltip")],t.prototype,"tooltip",void 0),ei([(0,a.Z9)("groupBy")],t.prototype,"groupBy",void 0),ei([(0,a.Z9)("text")],t.prototype,"sortBy",void 0),ei([(0,a.Z9)("htmlAttributes")],t.prototype,"htmlAttributes",void 0),ei([(0,a.Z9)("tableName")],t.prototype,"tableName",void 0),t}(a.rt),Sh=function(o){pv(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.previousSelectedItems=[],r.hiddenItems=[],r.enabledItems=[],r.disabledItems=[],r}return t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"htmlAttributes":this.setHTMLAttribute();break;case"cssClass":this.setCSSClass(i.cssClass);break;case"enable":this.setEnable();break;case"width":case"height":this.setSize();break;case"enableRtl":this.setEnableRTL();break;case"fields":this.listBaseOption.fields=this.fields.properties,this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"headerTitle":this.curDSLevel.length||this.header(this.headerTitle,!1,"header");break;case"query":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"showHeader":this.header(this.headerTitle,!1,"header");break;case"enableVirtualization":(0,a.le)(this.contentContainer)||(0,a.og)(this.contentContainer),this.refresh();break;case"showCheckBox":case"checkBoxPosition":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.setCheckbox();break;case"dataSource":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():this.reRender();break;case"sortOrder":case"template":this.enableVirtualization||this.refresh();break;case"showIcon":this.enableVirtualization?this.virtualizationModule.reRenderUiVirtualization():(this.listBaseOption.showIcon=this.showIcon,this.curViewDS=this.getSubDS(),this.resetCurrentList());break;default:break}}},t.prototype.setHTMLAttribute=function(){Object.keys(this.htmlAttributes).length&&(0,a.Y4)(this.element,this.htmlAttributes)},t.prototype.setCSSClass=function(e){this.cssClass&&(0,a.cn)([this.element],this.cssClass.split(" ").filter(function(i){return i})),e&&(0,a.IV)([this.element],e.split(" ").filter(function(i){return i}))},t.prototype.setSize=function(){this.element.style.height=(0,a.Ac)(this.height),this.element.style.width=(0,a.Ac)(this.width),this.isWindow=!this.element.clientHeight},t.prototype.setEnable=function(){this.enableElement(this.element,this.enable)},t.prototype.setEnableRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},t.prototype.enableElement=function(e,i){i?e.classList.remove(Be.disable):e.classList.add(Be.disable)},t.prototype.header=function(e,i,r){if(this.headerEle===void 0&&this.showHeader){this.enableHtmlSanitizer&&this.setProperties({headerTitle:a.pJ.sanitize(this.headerTitle)},!0),this.headerEle=this.createElement("div",{className:Be.header});var n=this.createElement("span",{className:Be.headerText,innerHTML:this.headerTitle}),s=this.createElement("div",{className:Be.text,innerHTML:n.outerHTML}),l=this.createElement("div",{className:Be.icon+" "+Be.backIcon+" "+Be.backButton,attrs:{style:"display:none;"}});if(this.headerEle.appendChild(l),this.headerEle.appendChild(s),this.headerTemplate){var h=(0,a.MY)(this.headerTemplate),c=this.createElement("div",{className:Be.headerTemplateText}),u=h({},this,r,this.LISTVIEW_HEADERTEMPLATE_ID,null,null,this.headerEle);u&&(0,a.R3)(u,c),(0,a.R3)([c],this.headerEle),this.isReact&&this.renderReactTemplates()}this.headerTemplate&&this.headerTitle&&s.classList.add("header"),this.element.classList.add("e-has-header"),(0,a.Ce)([this.headerEle],this.element)}else if(this.headerEle)if(this.showHeader){this.headerEle.style.display="";var s=this.headerEle.querySelector("."+Be.headerText),l=this.headerEle.querySelector("."+Be.backIcon);this.enableHtmlSanitizer&&(e=a.pJ.sanitize(e)),s.innerHTML=e,this.headerTemplate&&i&&(s.parentElement.classList.remove("header"),this.headerEle.querySelector("."+Be.headerTemplateText).classList.add("nested-header")),this.headerTemplate&&!i&&(s.parentElement.classList.add("header"),this.headerEle.querySelector("."+Be.headerTemplateText).classList.remove("nested-header"),this.headerEle.querySelector("."+Be.headerTemplateText).classList.add("header")),i===!0?l.style.display="":l.style.display="none"}else this.headerEle.style.display="none"},t.prototype.switchView=function(e,i,r){var n=this;if(e&&i){var s=e.style.position,l=this.element.style.overflow!=="hidden"?this.element.style.overflow:"";e.style.position="absolute",e.classList.add("e-view");var h=void 0,c=this.animation.duration;if(this.animation.effect)h=this.enableRtl?Zb[this.animation.effect]:dv[this.animation.effect];else{var u="SlideLeft";h=dv[u],r=this.enableRtl,c=0}this.element.style.overflow="hidden",this.aniObj.animate(e,{name:r===!0?h[0]:h[1],duration:c,timingFunction:this.animation.easing,end:function(p){e.style.display="none",n.element.style.overflow=l,e.style.position=s,e.classList.remove("e-view")}}),i.style.display="",this.aniObj.animate(i,{name:r===!0?h[2]:h[3],duration:c,timingFunction:this.animation.easing,end:function(){n.trigger("actionComplete")}}),this.curUL=i}},t.prototype.preRender=function(){if(this.template)try{document.querySelectorAll(this.template).length&&this.setProperties({template:document.querySelector(this.template).innerHTML.trim()},!0)}catch(e){(0,a.MY)(this.template)}this.listBaseOption={template:this.template,headerTemplate:this.headerTemplate,groupTemplate:this.groupTemplate,expandCollapse:!0,listClass:"",ariaAttributes:{itemRole:"option",listRole:"presentation",itemText:"",groupItemRole:"option",wrapperRole:"presentation"},fields:this.fields.properties,sortOrder:this.sortOrder,showIcon:this.showIcon,itemCreated:this.renderCheckbox.bind(this),templateID:""+this.element.id+fv,groupTemplateID:""+this.element.id+vv,enableHtmlSanitizer:this.enableHtmlSanitizer},this.initialization()},t.prototype.initialization=function(){this.curDSLevel=[],this.animateOptions={},this.curViewDS=[],this.currentLiElements=[],this.isNestedList=!1,this.selectedData=[],this.selectedId=[],this.LISTVIEW_TEMPLATE_ID=""+this.element.id+fv,this.LISTVIEW_GROUPTEMPLATE_ID=""+this.element.id+vv,this.LISTVIEW_HEADERTEMPLATE_ID=""+this.element.id+Yb,this.aniObj=new a.fw(this.animateOptions),this.removeElement(this.curUL),this.removeElement(this.ulElement),this.removeElement(this.headerEle),this.removeElement(this.contentContainer),this.curUL=this.ulElement=this.liCollection=this.headerEle=this.contentContainer=void 0},t.prototype.renderCheckbox=function(e){if(e.item.classList.contains(Be.hasChild)&&(this.isNestedList=!0),this.showCheckBox&&this.isValidLI(e.item)){var i=void 0,r=void 0;i=os(this.createElement,!1,{checked:!1,enableRtl:this.enableRtl,cssClass:Be.listviewCheckbox}),i.setAttribute("role","checkbox");var n=i.querySelector("."+Be.checkboxIcon);e.item.classList.add(Be.itemCheckList),e.item.firstElementChild.classList.add(Be.checkbox),typeof this.dataSource[0]!="string"&&typeof this.dataSource[0]!="number"?(r=tr(e.curData,this.listBaseOption.fields),r[this.listBaseOption.fields.isChecked]&&this.checkInternally(e,i)):(typeof this.dataSource[0]=="string"||typeof this.dataSource[0]=="number")&&this.selectedData.indexOf(e.text)!==-1&&this.checkInternally(e,i),i.setAttribute("aria-checked",n.classList.contains(Be.checked)?"true":"false"),this.checkBoxPosition==="Left"?(i.classList.add(Be.checkboxLeft),e.item.firstElementChild.classList.add(Be.checkboxLeft),e.item.firstElementChild.insertBefore(i,e.item.firstElementChild.childNodes[0])):(i.classList.add(Be.checkboxRight),e.item.firstElementChild.classList.add(Be.checkboxRight),e.item.firstElementChild.appendChild(i)),this.currentLiElements.push(e.item),this.checkBoxPosition==="Left"?this.virtualCheckBox=e.item.firstElementChild.children[0]:this.virtualCheckBox=e.item.firstElementChild.lastElementChild}},t.prototype.checkInternally=function(e,i){e.item.classList.add(Be.selected),e.item.setAttribute("aria-selected","true"),i.querySelector("."+Be.checkboxIcon).classList.add(Be.checked),i.setAttribute("aria-checked","true")},t.prototype.checkItem=function(e){this.toggleCheckBase(e,!0)},t.prototype.toggleCheckBase=function(e,i){if(this.showCheckBox){var r=e;if(e instanceof Object&&e.constructor!==HTMLLIElement&&(r=this.getLiFromObjOrElement(e)),!(0,a.le)(r)){var n=r.querySelector("."+Be.checkboxIcon);i===!0?r.classList.add(Be.selected):r.classList.remove(Be.selected),r.setAttribute("aria-selected",i?"true":"false"),i===!0?n.classList.add(Be.checked):n.classList.remove(Be.checked),n.parentElement.setAttribute("aria-checked",i?"true":"false")}this.setSelectedItemData(r)}},t.prototype.uncheckItem=function(e){this.toggleCheckBase(e,!1)},t.prototype.checkAllItems=function(){this.toggleAllCheckBase(!0)},t.prototype.uncheckAllItems=function(){this.toggleAllCheckBase(!1)},t.prototype.toggleAllCheckBase=function(e){if(this.showCheckBox){for(var i=0;i<this.liCollection.length;i++){var r=this.liCollection[i].querySelector("."+Be.checkboxIcon);r&&(e?r.classList.contains(Be.checked)||this.checkItem(this.liCollection[i]):r.classList.contains(Be.checked)&&this.uncheckItem(this.liCollection[i]))}this.enableVirtualization&&this.virtualizationModule.checkedItem(e)}},t.prototype.setCheckbox=function(){if(this.showCheckBox)for(var e=Array.prototype.slice.call(this.element.querySelectorAll("."+Be.listItem)),i={item:void 0,curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:""},r=0;r<e.length;r++){var n=e[r];i.item=n,i.curData=this.getItemData(n),n.querySelector("."+Be.checkboxWrapper)&&this.removeElement(n.querySelector("."+Be.checkboxWrapper)),this.renderCheckbox(i),i.item.classList.contains(Be.selected)&&this.checkInternally(i,i.item.querySelector("."+Be.checkboxWrapper))}else{for(var e=Array.prototype.slice.call(this.element.querySelectorAll("."+Be.itemCheckList)),r=0;r<e.length;r++){var n=e[r];n.classList.remove(Be.selected),n.firstElementChild.classList.remove(Be.checkbox),this.removeElement(n.querySelector("."+Be.checkboxWrapper))}this.selectedItems&&this.selectedItems.item.classList.add(Be.selected)}},t.prototype.refreshItemHeight=function(){this.virtualizationModule&&this.virtualizationModule.refreshItemHeight()},t.prototype.clickHandler=function(e){var i=e.target,r=i.classList,n;if(r.contains(Be.backIcon)||r.contains(Be.headerText))this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back();else{var s=(0,a.oq)(i.parentNode,"."+Be.listItem);if(s===null&&(s=i),this.removeFocus(),this.enable&&this.showCheckBox&&this.isValidLI(s))if(e.target.classList.contains(Be.checkboxIcon)){if(s.classList.add(Be.focused),(0,a.le)(s.querySelector("."+Be.checked))){var l={curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:void 0,item:s};this.checkInternally(l,l.item.querySelector("."+Be.checkboxWrapper))}else this.uncheckItem(s),s.classList.add(Be.focused);if(this.enableVirtualization&&this.virtualizationModule.setCheckboxLI(s,e),e){var h=this.selectEventData(s,e),c=s.querySelector("."+Be.checkboxIcon);(0,a.TS)(h,{isChecked:c.classList.contains(Be.checked)}),this.trigger("select",h)}}else s.classList.contains(Be.hasChild)?(this.removeHover(),this.removeSelect(),this.removeSelect(s),this.setSelectLI(s,e),s.classList.remove(Be.selected)):this.setCheckboxLI(s,e);else this.setSelectLI(s,e),this.element.focus();n=(0,a.oq)(e.target,"li"),(0,a.le)(n)||n.classList.contains("e-has-child")&&!e.target.parentElement.classList.contains("e-listview-checkbox")&&n.classList.add(Be.disable)}},t.prototype.removeElement=function(e){return e&&e.parentNode&&e.parentNode.removeChild(e)},t.prototype.hoverHandler=function(e){var i=(0,a.oq)(e.target.parentNode,"."+Be.listItem);this.setHoverLI(i)},t.prototype.leaveHandler=function(e){this.removeHover()},t.prototype.homeKeyHandler=function(e,i){if(e.preventDefault(),Object.keys(this.dataSource).length&&this.curUL){this.selectedItems&&this.selectedItems.item.setAttribute("aria-selected","false");var r=this.curUL.querySelectorAll("."+Be.listItem),n=this.curUL.querySelector("."+Be.focused)||this.curUL.querySelector("."+Be.selected);n&&(n.classList.remove(Be.focused),this.showCheckBox||n.classList.remove(Be.selected));var s=i?r.length-1:0;r[s].classList.contains(Be.hasChild)||this.showCheckBox?r[s].classList.add(Be.focused):this.setSelectLI(r[s],e),r[s]?this.element.setAttribute("aria-activedescendant",r[s].id.toString()):this.element.removeAttribute("aria-activedescendant")}},t.prototype.onArrowKeyDown=function(e,i){var r,n,s=!(0,a.le)(this.curUL.querySelector("."+Be.hasChild));return s||this.showCheckBox?(n=this.curUL.querySelector("."+Be.focused)||this.curUL.querySelector("."+Be.selected),r=Mt.getSiblingLI(this.curUL.querySelectorAll("."+Be.listItem),n,i),(0,a.le)(r)||(n&&(n.classList.remove(Be.focused),this.showCheckBox||n.classList.remove(Be.selected)),r.classList.contains(Be.hasChild)||this.showCheckBox?r.classList.add(Be.focused):this.setSelectLI(r,e))):(n=this.curUL.querySelector("."+Be.selected),r=Mt.getSiblingLI(this.curUL.querySelectorAll("."+Be.listItem),n,i),this.setSelectLI(r,e)),r?this.element.setAttribute("aria-activedescendant",r.id.toString()):this.element.removeAttribute("aria-activedescendant"),r},t.prototype.arrowKeyHandler=function(e,i){var r=this;if(e.preventDefault(),Object.keys(this.dataSource).length&&this.curUL){var n=this.onArrowKeyDown(e,i),s=this.element.getBoundingClientRect().top,l=this.element.getBoundingClientRect().height,h=this.curUL.querySelector("."+Be.listItem).getBoundingClientRect(),c=void 0,u=void 0;if(this.fields.groupBy&&(u=this.curUL.querySelector("."+Be.groupListItem).getBoundingClientRect()),n){var p=n.getBoundingClientRect().top,f=n.getBoundingClientRect().height;if(i)c=this.isWindow?p:p-s,c<0&&(this.isWindow===!0?window.scroll(0,pageYOffset+c):this.element.scrollTop=this.element.scrollTop+c);else{var g=this.isWindow?window.innerHeight:l;c=this.isWindow?p+f:p-s+f,c>g&&(this.isWindow===!0?window.scroll(0,pageYOffset+(c-g)):this.element.scrollTop=this.element.scrollTop+(c-g))}}else if(this.enableVirtualization&&i&&this.virtualizationModule.uiFirstIndex)this.onUIScrolled=function(){r.onArrowKeyDown(e,i),r.onUIScrolled=void 0},c=this.virtualizationModule.listItemHeight,this.isWindow===!0?window.scroll(0,pageYOffset-c):this.element.scrollTop=this.element.scrollTop-c;else if(i)if(this.showHeader&&this.headerEle){var C=u?u.top:h.top,L=this.headerEle.getBoundingClientRect();c=L.top<0?L.height-C:0,this.isWindow===!0?window.scroll(0,pageYOffset-c):this.element.scrollTop=0}else this.fields.groupBy&&(c=this.isWindow?u.top<0?u.top:0:s-h.top+u.height,this.isWindow===!0?window.scroll(0,pageYOffset+c):this.element.scrollTop=this.element.scrollTop-c)}},t.prototype.enterKeyHandler=function(e){if(Object.keys(this.dataSource).length&&this.curUL){var i=!(0,a.le)(this.curUL.querySelector("."+Be.hasChild)),r=this.curUL.querySelector("."+Be.focused);i&&r&&(r.classList.remove(Be.focused),this.showCheckBox&&(this.removeSelect(),this.removeSelect(r),this.removeHover()),this.setSelectLI(r,e))}},t.prototype.spaceKeyHandler=function(e){if(e.preventDefault(),this.enable&&this.showCheckBox&&Object.keys(this.dataSource).length&&this.curUL){var i=this.curUL.querySelector("."+Be.focused),r=void 0,n=void 0;if(!(0,a.le)(i)&&(0,a.le)(i.querySelector("."+Be.checked))){var s={curData:void 0,dataSource:void 0,fields:void 0,options:void 0,text:void 0,item:i};r=s.item.querySelector("."+Be.checkboxWrapper),this.checkInternally(s,r),n=r.querySelector("."+Be.checkboxIcon+"."+Be.icon)}else this.uncheckItem(i);var l=this.selectEventData(i,e);(0,a.TS)(l,{isChecked:n?n.classList.contains(Be.checked):!1}),this.trigger("select",l)}},t.prototype.keyActionHandler=function(e){switch(e.keyCode){case 36:this.homeKeyHandler(e);break;case 35:this.homeKeyHandler(e,!0);break;case 40:this.arrowKeyHandler(e);break;case 38:this.arrowKeyHandler(e,!0);break;case 13:this.enterKeyHandler(e);break;case 8:this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back();break;case 32:this.spaceKeyHandler(e);break}},t.prototype.swipeActionHandler=function(e){e.swipeDirection==="Right"&&e.velocity>Gb&&e.originalEvent.type==="touchend"&&(this.showCheckBox&&this.curDSLevel[this.curDSLevel.length-1]&&this.uncheckAllItems(),this.back())},t.prototype.focusout=function(){if(Object.keys(this.dataSource).length&&this.curUL){var e=this.curUL.querySelector("."+Be.focused),i=this.curUL.querySelector("[aria-selected = true]");e&&(e.classList.remove(Be.focused),i&&!this.showCheckBox&&i.classList.add(Be.selected))}},t.prototype.wireEvents=function(){a.bi.add(this.element,"keydown",this.keyActionHandler,this),a.bi.add(this.element,"click",this.clickHandler,this),a.bi.add(this.element,"mouseover",this.hoverHandler,this),a.bi.add(this.element,"mouseout",this.leaveHandler,this),a.bi.add(this.element,"focusout",this.focusout,this),this.touchModule=new a.Xh(this.element,{swipe:this.swipeActionHandler.bind(this)})},t.prototype.unWireEvents=function(){a.bi.remove(this.element,"click",this.clickHandler),a.bi.remove(this.element,"mouseover",this.hoverHandler),a.bi.remove(this.element,"mouseout",this.leaveHandler),a.bi.remove(this.element,"mouseover",this.hoverHandler),a.bi.remove(this.element,"mouseout",this.leaveHandler),this.touchModule.destroy()},t.prototype.removeFocus=function(){for(var e=this.element.querySelectorAll("."+Be.focused),i=0,r=e;i<r.length;i++){var n=r[i];n.classList.remove(Be.focused)}},t.prototype.removeHover=function(){var e=this.element.querySelector("."+Be.hover);e&&e.classList.remove(Be.hover)},t.prototype.removeSelect=function(e){if((0,a.le)(e))for(var i=this.element.querySelectorAll("."+Be.selected),r=0,n=i;r<n.length;r++){var s=n[r];this.showCheckBox&&s.querySelector("."+Be.checked)||(s.setAttribute("aria-selected","false"),s.classList.remove(Be.selected))}else e.classList.remove(Be.selected),e.setAttribute("aria-selected","false")},t.prototype.isValidLI=function(e){return e&&e.classList.contains(Be.listItem)&&!e.classList.contains(Be.groupListItem)&&!e.classList.contains(Be.disable)},t.prototype.setCheckboxLI=function(e,i){if(this.isValidLI(e)&&this.enable&&this.showCheckBox){this.curUL.querySelector("."+Be.focused)&&this.curUL.querySelector("."+Be.focused).classList.remove(Be.focused),e.classList.add(Be.focused);var r=e.querySelector("."+Be.checkboxWrapper),n=r.querySelector("."+Be.checkboxIcon+"."+Be.icon);this.removeHover(),n.classList.contains(Be.checked)?(n.classList.remove(Be.checked),e.classList.remove(Be.selected),e.setAttribute("aria-selected","false")):(n.classList.add(Be.checked),e.classList.add(Be.selected),e.setAttribute("aria-selected","true")),r.setAttribute("aria-checked",n.classList.contains(Be.checked)?"true":"false");var s=this.selectEventData(e,i);(0,a.TS)(s,{isChecked:n.classList.contains(Be.checked)}),this.enableVirtualization&&this.virtualizationModule.setCheckboxLI(e,i),this.trigger("select",s),this.setSelectedItemData(e),this.renderSubList(e)}},t.prototype.selectEventData=function(e,i){var r=this.getItemData(e),n=tr(r,this.listBaseOption.fields),s;!(0,a.le)(r)&&typeof this.dataSource[0]=="string"||typeof this.dataSource[0]=="number"?s={item:e,text:e&&e.innerText.trim(),data:this.dataSource}:s={item:e,text:n&&n[this.listBaseOption.fields.text],data:r};var l={};return(0,a.TS)(l,s),i&&(0,a.TS)(l,{isInteracted:!0,event:i,index:this.curUL&&Array.prototype.indexOf.call(this.curUL.children,e)}),l},t.prototype.setSelectedItemData=function(e){var i=this.getItemData(e),r=tr(i,this.listBaseOption.fields);!(0,a.le)(i)&&(typeof this.dataSource[0]=="string"||typeof this.dataSource[0]=="number")?this.selectedItems={item:e,text:e&&e.innerText.trim(),data:this.dataSource}:this.selectedItems={item:e,text:r&&r[this.listBaseOption.fields.text],data:i}},t.prototype.setSelectLI=function(e,i){if(this.isValidLI(e)&&!e.classList.contains(Be.selected)&&this.enable){this.showCheckBox||this.removeSelect(),e.classList.add(Be.selected),e.setAttribute("aria-selected","true"),this.removeHover(),this.setSelectedItemData(e),this.enableVirtualization&&this.virtualizationModule.setSelectLI(e,i);var r=this.selectEventData(e,i);this.trigger("select",r),this.selectedLI=e,this.renderSubList(e)}},t.prototype.setHoverLI=function(e){if(this.isValidLI(e)&&!e.classList.contains(Be.hover)&&this.enable){var i=this.element.querySelectorAll("."+Be.hover);i&&i.length&&(0,a.IV)(i,Be.hover),(!e.classList.contains(Be.selected)||this.showCheckBox)&&e.classList.add(Be.hover)}},t.prototype.getSubDS=function(){var e=this.curDSLevel;if(e.length){for(var i=this.localData,r=0,n=e;r<n.length;r++){var s=n[r],l={};l[this.fields.id]=s,this.curDSJSON=this.findItemFromDS(i,l);var h=tr(this.curDSJSON,this.listBaseOption.fields);i=this.curDSJSON?h[this.fields.child]:i}return i}return this.localData},t.prototype.getItemData=function(e){var i=this.dataSource instanceof Oe.h?this.localData:this.dataSource,r=this.getElementUID(e),n;return(0,a.le)(this.element.querySelector("."+Be.hasChild))&&this.fields.groupBy?n=this.curViewDS:n=i,this.findItemFromDS(n,r)},t.prototype.findItemFromDS=function(e,i,r){var n=this,s;return e&&e.length&&i?e.some(function(l){var h=tr(l,n.listBaseOption.fields);if((i[n.fields.id]||i[n.fields.text])&&(!i[n.fields.id]||(!(0,a.le)(h[n.fields.id])&&h[n.fields.id].toString())===i[n.fields.id].toString())&&(!i[n.fields.text]||h[n.fields.text]===i[n.fields.text]))s=r?e:l;else if(typeof l!="object"&&e.indexOf(l)!==-1)s=r?e:l;else if(!(0,a.le)(i[n.fields.id])&&(0,a.le)(h[n.fields.id])){var c=n.element.querySelector('[data-uid="'+i[n.fields.id]+'"]');c&&c.innerText.trim()===h[n.fields.text]&&(s=l)}else h.hasOwnProperty(n.fields.child)&&h[n.fields.child].length&&(s=n.findItemFromDS(h[n.fields.child],i,r));return!!s}):s=e,s},t.prototype.getQuery=function(){var e=[],i=this.query?this.query:new yt.A;if(!this.query){for(var r=0,n=Object.keys(this.fields.properties);r<n.length;r++){var s=n[r];s!=="tableName"&&!!this.fields[s]&&this.fields[s]!==Mt.defaultMappedFields[s]&&e.indexOf(this.fields[s])===-1&&e.push(this.fields[s])}i.select(e),this.fields.properties.hasOwnProperty("tableName")&&i.from(this.fields.tableName)}return i},t.prototype.setViewDataSource=function(e){e===void 0&&(e=this.localData);var i=(0,a.le)(this.fields.sortBy)?this.fields.text:this.fields.sortBy,r=Mt.addSorting(this.sortOrder,i);e&&this.fields.groupBy?this.sortOrder!=="None"?this.curViewDS=Mt.groupDataSource(Mt.getDataSource(e,r),this.listBaseOption.fields,this.sortOrder):this.curViewDS=Mt.groupDataSource(e,this.listBaseOption.fields,this.sortOrder):e&&this.sortOrder!=="None"?this.curViewDS=Mt.getDataSource(e,r):this.curViewDS=e},t.prototype.isInAnimation=function(){return this.curUL.classList.contains(".e-animate")},t.prototype.renderRemoteLists=function(e,i){this.isDestroyed||(this.localData=e.result,i.removeElement(i.contentContainer),this.renderList(),this.trigger("actionComplete",e))},t.prototype.triggerActionFailure=function(e){this.isDestroyed||this.trigger("actionFailure",e)},t.prototype.setLocalData=function(){var e=this;this.trigger("actionBegin");var i=this;if(this.dataSource instanceof Oe.h)this.dataSource.ready?this.dataSource.ready.then(function(n){e.isOffline=e.dataSource.dataSource.offline,e.dataSource instanceof Oe.h&&e.isOffline&&e.renderRemoteLists(n,i)}).catch(function(n){e.triggerActionFailure(n)}):this.dataSource.executeQuery(this.getQuery()).then(function(n){e.renderRemoteLists(n,i)}).catch(function(n){e.triggerActionFailure(n)});else if(!this.dataSource||!this.dataSource.length){var r=this.element.querySelector("ul");r&&((0,a.Od)(r),this.setProperties({dataSource:Mt.createJsonFromElement(r)},!0),this.localData=this.dataSource,this.renderList(),this.trigger("actionComplete",{data:this.localData}))}else this.localData=this.dataSource,this.renderList(),this.trigger("actionComplete",{data:this.localData})},t.prototype.reRender=function(){this.removeElement(this.headerEle),this.removeElement(this.ulElement),this.removeElement(this.contentContainer),this.isReact&&this.clearTemplate(),Object.keys(window).indexOf("ejsInterop")===-1&&(this.element.innerHTML=""),this.headerEle=this.ulElement=this.liCollection=void 0,this.header(),this.setLocalData()},t.prototype.resetCurrentList=function(){this.setViewDataSource(this.curViewDS),this.contentContainer.innerHTML="",this.createList(),this.renderIntoDom(this.curUL)},t.prototype.setAttributes=function(e){for(var i=0;i<e.length;i++){var r=e[i];r.classList.contains("e-list-item")&&(r.setAttribute("id",this.element.id+"_"+r.getAttribute("data-uid")),r.setAttribute("aria-selected","false"),r.setAttribute("tabindex","-1"))}},t.prototype.createList=function(){this.currentLiElements=[],this.isNestedList=!1,this.ulElement=this.curUL=Mt.createList(this.createElement,this.curViewDS,this.listBaseOption,null,this),this.liCollection=this.curUL.querySelectorAll("."+Be.listItem),this.setAttributes(this.liCollection)},t.prototype.exceptionEvent=function(e){this.trigger("actionFailure",e)},t.prototype.UpdateCurrentUL=function(){this.ulElement=this.curUL=this.element.querySelector("."+Be.parentItem),this.curUL&&(this.liCollection=this.curUL.querySelectorAll("."+Be.listItem))},t.prototype.renderSubList=function(e){this.liElement=e;var i=e.getAttribute("data-uid");if(e.classList.contains(Be.hasChild)&&i){var r=(0,a.oq)(e.parentNode,"."+Be.parentItem),n=this.element.querySelector("[pid='"+i+"']");if(this.curDSLevel.push(i),this.setViewDataSource(this.getSubDS()),!n){var s=this.curViewDS;n=Mt.createListFromJson(this.createElement,s,this.listBaseOption,this.curDSLevel.length,null,this),this.isReact&&this.renderReactTemplates();var l=n.querySelectorAll("."+Be.listItem);this.setAttributes(l),n.setAttribute("pID",i),n.style.display="none",this.renderIntoDom(n)}if(this.switchView(r,n),this.liCollection=this.curUL.querySelectorAll("."+Be.listItem),this.selectedItems){var h=tr(this.selectedItems.data,this.listBaseOption.fields);this.header(h[this.listBaseOption.fields.text],!0,"header")}this.selectedLI=void 0}},t.prototype.renderIntoDom=function(e){this.contentContainer.appendChild(e)},t.prototype.renderList=function(e){this.setViewDataSource(e),this.enableVirtualization?(Object.keys(this.dataSource).length&&(this.template||this.groupTemplate)&&!this.virtualizationModule.isNgTemplate()&&(this.isReact?(typeof this.template=="string"&&(this.listBaseOption.template=null),typeof this.groupTemplate=="string"&&(this.listBaseOption.groupTemplate=null)):(this.listBaseOption.template=null,this.listBaseOption.groupTemplate=null),this.listBaseOption.itemCreated=this.virtualizationModule.createUIItem.bind(this.virtualizationModule)),this.virtualizationModule.uiVirtualization()):(this.createList(),this.contentContainer=this.createElement("div",{className:Be.content}),this.element.appendChild(this.contentContainer),this.renderIntoDom(this.ulElement),this.isReact&&this.renderReactTemplates())},t.prototype.getElementUID=function(e){var i={};return e instanceof Element?i[this.fields.id]=e.getAttribute("data-uid"):i=e,i},t.prototype.render=function(){this.element.classList.add(Be.root),(0,a.Y4)(this.element,{role:"list",tabindex:"0"}),this.setCSSClass(),this.setEnableRTL(),this.setEnable(),this.setSize(),this.wireEvents(),this.header(),this.setLocalData(),this.setHTMLAttribute(),this.rippleFn=(0,a.qx)(this.element,{selector:"."+Be.listItem}),this.renderComplete()},t.prototype.destroy=function(){this.isReact&&this.clearTemplate(),this.unWireEvents();var e=[Be.root,Be.disable,"e-rtl","e-has-header","e-lib"].concat(this.cssClass.split(" ").filter(function(i){return i}));(0,a.IV)([this.element],e),this.element.removeAttribute("role"),this.element.removeAttribute("tabindex"),this.curUL=this.ulElement=this.liCollection=this.headerEle=void 0,this.element.innerHTML="",o.prototype.destroy.call(this)},t.prototype.back=function(){var e=this.curDSLevel[this.curDSLevel.length-1];if(!(e===void 0||this.isInAnimation())){this.curDSLevel.pop(),this.setViewDataSource(this.getSubDS());var i=this.element.querySelector("[data-uid='"+e+"']"),r=this.curUL;i?i=i.parentElement:(this.createList(),this.renderIntoDom(this.ulElement),i=this.curUL);var n=tr(this.curDSJSON,this.listBaseOption.fields),s=n[this.fields.text];this.switchView(r,i,!0),this.removeFocus();var l=this.element.querySelector("[data-uid='"+e+"']");l.classList.remove(Be.disable),l.classList.add(Be.focused),this.showCheckBox&&l.querySelector("."+Be.checkboxIcon).classList.contains(Be.checked)?l.setAttribute("aria-selected","true"):(l.classList.remove(Be.selected),l.setAttribute("aria-selected","false")),this.liCollection=this.curUL.querySelectorAll("."+Be.listItem),this.enableHtmlSanitizer&&this.setProperties({headerTitle:a.pJ.sanitize(this.headerTitle)},!0),this.header(this.curDSLevel.length?s:this.headerTitle,!!this.curDSLevel.length,"header")}},t.prototype.selectItem=function(e){this.enableVirtualization?this.virtualizationModule.selectItem(e):this.showCheckBox?this.setCheckboxLI(this.getLiFromObjOrElement(e)):(0,a.le)(e)===!0?this.removeSelect():this.setSelectLI(this.getLiFromObjOrElement(e))},t.prototype.getLiFromObjOrElement=function(e){var i,r=this.dataSource instanceof Oe.h?this.localData:this.dataSource;if(!(0,a.le)(e))if(typeof r[0]=="string"||typeof r[0]=="number")if(e instanceof Element){for(var n=e.getAttribute("data-uid").toString(),s=0;s<this.liCollection.length;s++)if(this.liCollection[s].getAttribute("data-uid").toString()===n){i=this.liCollection[s];break}}else Array.prototype.some.call(this.curUL.querySelectorAll("."+Be.listItem),function(u){return u.innerText.trim()===e.toString()?(i=u,!0):!1});else{var l=this.getItemData(e),h=tr(l,this.listBaseOption.fields);if(l&&(i=this.element.querySelector('[data-uid="'+h[this.fields.id]+'"]'),!this.enableVirtualization&&(0,a.le)(i)))for(var c=this.element.querySelectorAll("."+Be.listItem),s=0;s<c.length;s++)c[s].innerText.trim()===h[this.fields.text]&&(i=c[s])}return i},t.prototype.selectMultipleItems=function(e){if(!(0,a.le)(e))for(var i=0;i<e.length;i++)(0,a.le)(e[i])||this.selectItem(e[i])},t.prototype.getParentId=function(){var e=[];if(this.isNestedList)for(var i=this.curDSLevel.length-1;i>=0;i--)e.push(this.curDSLevel[i]);return e},t.prototype.getSelectedItems=function(){var e,i=!1;this.selectedId=[];var r=this.dataSource instanceof Oe.h?this.localData:this.dataSource;if(this.enableVirtualization&&!i)e=this.virtualizationModule.getSelectedItems(),i=!0;else if(this.showCheckBox&&!i){var n=this.curUL.getElementsByClassName(Be.selected),s=[],l=[];this.selectedId=[];for(var h=[],c=0;c<n.length;c++)if(typeof r[0]=="string"||typeof r[0]=="number")s.push(n[c].innerText.trim());else{var u=this.getItemData(n[c]),p=tr(u,this.listBaseOption.fields);this.isNestedList?h.push({data:u,parentId:this.getParentId()}):l.push(u),p?(s.push(p[this.listBaseOption.fields.text]),this.selectedId.push(p[this.listBaseOption.fields.id])):(s.push(void 0),this.selectedId.push(void 0))}(typeof r[0]=="string"||typeof r[0]=="number")&&!i&&(e={item:n,data:r,text:s},i=!0),this.isNestedList&&!i?(e={item:n,data:h,text:s},i=!0):i||(e={item:n,data:l,text:s},i=!0)}else if(!i){var f=this.element.getElementsByClassName(Be.selected)[0],p=tr(this.getItemData(f),this.listBaseOption.fields);(typeof r[0]=="string"||typeof r[0]=="number")&&!i?(e=(0,a.le)(f)?void 0:{item:f,data:r,text:f.innerText.trim()},i=!0):i||((0,a.le)(p)||(0,a.le)(f)?(e=void 0,i=!0):(this.selectedId.push(p[this.listBaseOption.fields.id]),e={text:p[this.listBaseOption.fields.text],item:f,data:this.getItemData(f)},i=!0))}return e},t.prototype.findItem=function(e){return this.getItemData(e)},t.prototype.enableItem=function(e){this.setItemState(e,!0),this.enableVirtualization&&this.virtualizationModule.enableItem(e)},t.prototype.disableItem=function(e){this.setItemState(e,!1),this.enableVirtualization&&this.virtualizationModule.disableItem(e)},t.prototype.setItemState=function(e,i){var r=this.getItemData(e),n=tr(r,this.listBaseOption.fields);if(r){var s=this.element.querySelector('[data-uid="'+n[this.fields.id]+'"]');i?(s&&s.classList.remove(Be.disable),delete r[this.fields.enabled]):i||(s&&s.classList.add(Be.disable),r[this.fields.enabled]=!1)}},t.prototype.showItem=function(e){this.showHideItem(e,!1,""),this.enableVirtualization&&this.virtualizationModule.showItem(e)},t.prototype.hideItem=function(e){this.showHideItem(e,!0,"none"),this.enableVirtualization&&this.virtualizationModule.hideItem(e)},t.prototype.showHideItem=function(e,i,r){var n=this.getItemData(e),s=tr(n,this.listBaseOption.fields);if(n){var l=this.element.querySelector('[data-uid="'+s[this.fields.id]+'"]');l&&(l.style.display=r),i?n[this.fields.isVisible]=!1:delete n[this.fields.isVisible]}},t.prototype.addItem=function(e,i){i===void 0&&(i=void 0);var r=this.dataSource instanceof Oe.h?this.localData:this.dataSource;this.addItemInternally(e,i,r)},t.prototype.addItemInternally=function(e,i,r){if(e instanceof Array)if(this.enableVirtualization)this.virtualizationModule.addItem(e,i,r);else{var n=this.findItemFromDS(r,i),s=void 0;if(n){var l=tr(n,this.listBaseOption.fields);s=l[this.fields.child],s||(s=[]),s=s.concat(e)}if(n instanceof Array){for(var h=0;h<e.length;h++){r.push(e[h]),this.setViewDataSource(r);var c=this.contentContainer?this.contentContainer.children[0]:null;this.contentContainer&&c?this.addItemIntoDom(e[h],c,this.curViewDS):this.reRender()}this.liCollection=this.curUL.querySelectorAll("."+Be.listItem)}else n&&(n[this.fields.child]=s,this.addItemInNestedList(n,e))}},t.prototype.addItemInNestedList=function(e,i){var r=e[this.fields.id],n=e[this.fields.child],s=this.element.querySelector("[pid='"+r+"']"),l=this.element.querySelector("[data-uid='"+r+"']"),h=s||(l?(0,a.oq)(l,"ul"):null),c=s?n:[e],u=l?!l.classList.contains(Be.hasChild):!1,p=!1;if(u){var f=Mt.createListItemFromJson(this.createElement,c,this.listBaseOption,null,null,this);this.setAttributes(f),h.insertBefore(f[0],l),(0,a.og)(l),p=!0}if(s&&i){for(var g=0;g<i.length;g++)c.push(i[g]),this.addItemIntoDom(i[g],h,c);p=!0}},t.prototype.addItemIntoDom=function(e,i,r){var n=r.indexOf(e);this.addListItem(e,n,i,r);var s=r[n-1];s&&s.isHeader&&s.items.length===1&&this.addListItem(s,n-1,i,r)},t.prototype.addListItem=function(e,i,r,n){var s=this.getLiFromObjOrElement(n[i+1])||this.getLiFromObjOrElement(n[i+2])||null,l=Mt.createListItemFromJson(this.createElement,[e],this.listBaseOption,null,null,this);if(this.setAttributes(l),this.template&&this.isReact&&this.renderReactTemplates(),this.fields.groupBy&&n[i+1]&&n[i+1].isHeader){var h=this.getLiFromObjOrElement(n[i-1]);h&&(s=h.nextElementSibling)}r.insertBefore(l[0],s)},t.prototype.removeItem=function(e){var i=this.dataSource instanceof Oe.h?this.localData:this.dataSource;this.enableVirtualization?this.virtualizationModule.removeItem(e):this.removeItemFromList(e,i)},t.prototype.removeItemFromList=function(e,i){var r=this,n=this.curViewDS,s=e instanceof Element?this.getElementUID(e):e,l;if(l=this.findItemFromDS(i,s,!0),l){var h;h=this.findItemFromDS(l,s);var c=n.indexOf(h),u=this.getLiFromObjOrElement(e),p=void 0;this.validateNestedView(u),this.fields.groupBy&&this.curViewDS[c-1]&&n[c-1].isHeader&&n[c-1].items.length===1&&u&&u.previousElementSibling.classList.contains(Be.groupListItem)&&((0,a.le)(u.nextElementSibling)||u.nextElementSibling&&u.nextElementSibling.classList.contains(Be.groupListItem))&&(p=u.previousElementSibling),u&&(0,a.og)(u),p&&(0,a.og)(p);var f=l.length-1<=0?this.findParent(this.localData,this.fields.id,function(D){return D===h[r.fields.id]},null):null,g=l.indexOf(h);if(l.splice(g,1),this.setViewDataSource(i),f&&f.parent&&Array.isArray(f.parent[this.fields.child])&&f.parent[this.fields.child].length<=0){var C=this.getLiFromObjOrElement(f.parent);if(C){var L=Mt.createListItemFromJson(this.createElement,[f.parent],this.listBaseOption,null,null,this);this.setAttributes(L),C.parentElement.insertBefore(L[0],C),C.parentElement.removeChild(C)}}l.length<=0&&this.back(),this.liCollection=Array.prototype.slice.call(this.element.querySelectorAll("."+Be.listItem))}},t.prototype.validateNestedView=function(e){var i=e?e.getAttribute("data-uid").toString().toLowerCase():null;if(i&&this.curDSLevel&&this.curDSLevel.length>0)for(;this.curDSLevel.some(function(r){return r.toString().toLowerCase()===i});)this.back()},t.prototype.removeMultipleItems=function(e){if(e.length)for(var i=0;i<e.length;i++)this.removeItem(e[i])},t.prototype.findParent=function(e,i,r,n){if(e.hasOwnProperty(i)&&r(e[i])===!0)return(0,a.l7)({},e);for(var s=0;s<Object.keys(e).length;s++)if(e[Object.keys(e)[s]]&&typeof e[Object.keys(e)[s]]=="object"){var l=this.findParent(e[Object.keys(e)[s]],i,r,e);if(l!=null)return l.parent||(l.parent=n),l}return null},t.prototype.getModuleName=function(){return"listview"},t.prototype.requiredModules=function(){var e=[];return this.enableVirtualization&&e.push({args:[this],member:"virtualization"}),e},t.prototype.getPersistData=function(){return this.addOnPersist(["cssClass","enableRtl","htmlAttributes","enable","fields","animation","headerTitle","sortOrder","showIcon","height","width","showCheckBox","checkBoxPosition"])},ei([(0,a.Z9)("")],t.prototype,"cssClass",void 0),ei([(0,a.Z9)(!1)],t.prototype,"enableVirtualization",void 0),ei([(0,a.Z9)({})],t.prototype,"htmlAttributes",void 0),ei([(0,a.Z9)(!0)],t.prototype,"enable",void 0),ei([(0,a.Z9)([])],t.prototype,"dataSource",void 0),ei([(0,a.Z9)()],t.prototype,"query",void 0),ei([(0,a.Zz)(Mt.defaultMappedFields,Kb)],t.prototype,"fields",void 0),ei([(0,a.Z9)({effect:"SlideLeft",duration:400,easing:"ease"})],t.prototype,"animation",void 0),ei([(0,a.Z9)("None")],t.prototype,"sortOrder",void 0),ei([(0,a.Z9)(!1)],t.prototype,"showIcon",void 0),ei([(0,a.Z9)(!1)],t.prototype,"showCheckBox",void 0),ei([(0,a.Z9)("Left")],t.prototype,"checkBoxPosition",void 0),ei([(0,a.Z9)("")],t.prototype,"headerTitle",void 0),ei([(0,a.Z9)(!1)],t.prototype,"showHeader",void 0),ei([(0,a.Z9)(!1)],t.prototype,"enableHtmlSanitizer",void 0),ei([(0,a.Z9)("")],t.prototype,"height",void 0),ei([(0,a.Z9)("")],t.prototype,"width",void 0),ei([(0,a.Z9)(null)],t.prototype,"template",void 0),ei([(0,a.Z9)(null)],t.prototype,"headerTemplate",void 0),ei([(0,a.Z9)(null)],t.prototype,"groupTemplate",void 0),ei([(0,a.ju)()],t.prototype,"select",void 0),ei([(0,a.ju)()],t.prototype,"actionBegin",void 0),ei([(0,a.ju)()],t.prototype,"actionComplete",void 0),ei([(0,a.ju)()],t.prototype,"actionFailure",void 0),t=ei([a.Zl],t),t}(a.wA),Qu=function(){function o(t){this.password="",this.parent=t,this.init()}return o.prototype.init=function(){this.addEventListener()},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(E.Oj,this.protect,this),this.parent.on(E.Vm,this.protectSheetHandler,this),this.parent.on(E.Gn,this.editProtectedAlert,this),this.parent.on(E.du,this.protectWorkbook,this),this.parent.on(E.yR,this.KeyUpHandler,this),this.parent.on(E.xY,this.unProtectWorkbook,this),this.parent.on(E.z1,this.unProtectsheet,this),this.parent.on(E.z2,this.unProtectSheetPassword,this),this.parent.on(E.VM,this.getPassWord,this),this.parent.on(E.wq,this.importProtectWorkbook,this),this.parent.on(E.eF,this.protectWorkbookHandler,this),this.parent.on(E.e,this.removeWorkbookProtection,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.Oj,this.protect),this.parent.off(E.Vm,this.protectSheetHandler),this.parent.off(E.Gn,this.editProtectedAlert),this.parent.off(E.du,this.protectWorkbook),this.parent.off(E.yR,this.KeyUpHandler),this.parent.off(E.xY,this.unProtectWorkbook),this.parent.off(E.z1,this.unProtectsheet),this.parent.off(E.z2,this.unProtectSheetPassword),this.parent.off(E.VM,this.getPassWord),this.parent.off(E.wq,this.importProtectWorkbook),this.parent.off(E.eF,this.protectWorkbookHandler),this.parent.off(E.e,this.removeWorkbookProtection))},o.prototype.protect=function(t){this.parent.notify(E.EP,null),t.isActive?(this.parent.setSheetPropertyOnMute((0,w.zfV)(this.parent,t.sheetIndex),"isProtected",!1),this.parent.notify(E.IE,{props:"Protect"}),this.parent.notify(E.Vm,t),this.parent.notify(E.KR,null)):this.createDialogue()},o.prototype.createDialogue=function(){var t=this,e=this.parent.serviceLocator.getService(Ve),i=[{text:e.getConstant("SelectCells"),id:"1"},{text:e.getConstant("SelectUnLockedCells"),id:"6"},{text:e.getConstant("FormatCells"),id:"2"},{text:e.getConstant("FormatRows"),id:"3"},{text:e.getConstant("FormatColumns"),id:"4"},{text:e.getConstant("InsertLinks"),id:"5"}];this.optionList=new Sh({width:"250px",dataSource:i,showCheckBox:!0,select:this.dialogOpen.bind(this)});var r=this.parent.createElement("div",{className:"e-sheet-password-dialog"}),n=this.parent.createElement("div",{className:"e-sheet-password-content"}),s=this.parent.createElement("div",{className:"e-header",innerHTML:e.getConstant("SheetPassword")}),l=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});l.setAttribute("placeholder",e.getConstant("EnterThePassword")),n.appendChild(l),n.insertBefore(s,l),r.appendChild(n);var h=this.parent.createElement("div",{className:"e-protect-content",innerHTML:e.getConstant("ProtectAllowUser")});this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(),"isProtected",!1);var c=new Yn({checked:!0,label:e.getConstant("ProtectContent"),cssClass:"e-protect-checkbox"}),u=this.parent.createElement("div",{className:"e-protect-option-list",id:this.parent.element.id+"_option_list"}),p=this.parent.createElement("div",{className:"e-header-content",innerHTML:e.getConstant("ProtectSheet")}),f=this.parent.createElement("input",{id:this.parent.element.id+"_protect_check",attrs:{type:"checkbox"}});this.dialog=this.parent.serviceLocator.getService("dialog"),this.dialog.show({header:p.outerHTML,content:r.outerHTML+f.outerHTML+h.outerHTML+u.outerHTML,showCloseIcon:!0,isModal:!0,cssClass:"e-protect-dlg",beforeOpen:function(g){var C={dialogName:"ProtectSheetDialog",element:g.element,target:g.target,cancel:g.cancel};t.parent.trigger("dialogBeforeOpen",C),C.cancel&&(g.cancel=!0),we(t.parent.element)},open:function(){t.okBtnFocus()},beforeClose:function(){var g=document.getElementById(t.parent.element.id+"_protect_check");a.bi.remove(g,"focus",t.okBtnFocus),a.bi.remove(c.element,"click",t.checkBoxClickHandler),we(t.parent.element)},buttons:[{click:this.selectOption.bind(this,this.dialog,this),buttonModel:{content:e.getConstant("Ok"),isPrimary:!0}},{click:this.cancelClick.bind(this,this.dialog,this),buttonModel:{content:e.getConstant("Cancel")}}]},!1),c.appendTo("#"+this.parent.element.id+"_protect_check"),this.optionList.appendTo("#"+this.parent.element.id+"_option_list"),this.optionList.selectMultipleItems([{id:"1"},{id:"6"}]),a.bi.add(c.element,"click",this.checkBoxClickHandler,this)},o.prototype.okBtnFocus=function(){var t=this,e=document.getElementById(this.parent.element.id+"_protect_check");e.addEventListener("focus",function(){t.dialog.dialogInstance.element.getElementsByClassName("e-footer-content")[0].querySelector("button").focus()})},o.prototype.cancelClick=function(){var t=document.querySelector(".e-protect-dlg"),e=(0,a.Xr)(t,"dialog");e.destroy()},o.prototype.checkBoxClickHandler=function(){var t=document.getElementById(this.parent.element.id+"_protect_check");t.checked===!1?this.dialog.dialogInstance.element.getElementsByClassName("e-footer-content")[0].querySelector("button").disabled=!0:(this.dialog.dialogInstance.element.getElementsByClassName("e-footer-content")[0].querySelector("button").disabled=!1,this.dialog.dialogInstance.element.getElementsByClassName("e-footer-content")[0].querySelector("button").focus())},o.prototype.dialogOpen=function(t){var e=this.parent.serviceLocator.getService(Ve);t.text===e.getConstant("SelectCells")&&t.isChecked&&t.isInteracted&&this.optionList.checkItem({id:"6"}),t.text===e.getConstant("SelectUnLockedCells")&&!t.isChecked&&t.isInteracted&&this.optionList.uncheckItem({id:"1"}),this.dialog.dialogInstance.element.getElementsByClassName("e-footer-content")[0].querySelector("button").focus()},o.prototype.selectOption=function(){var t=this.parent.getActiveSheet(),e=this.parent.element.querySelector(".e-sheet-password-dialog").getElementsByClassName("e-sheet-password-content")[0].querySelector(".e-input");e.value.length===0?(this.parent.setSheetPropertyOnMute(t,"isProtected",!0),this.parent.setSheetPropertyOnMute(t,"password",e.value),this.updateProtectSheet(e.value),this.dialog.hide(),!t.protectSettings.selectCells&&!t.protectSettings.selectUnLockedCells?this.parent.notify(E.Qu,null):t.protectSettings.selectUnLockedCells&&ct(this.parent,(0,w.dK5)(t.selectedRange))&&this.parent.notify(E.Qu,null)):this.reEnterSheetPassword()},o.prototype.selectSheetPassword=function(){var t=this.parent.serviceLocator.getService(Ve),e=this.parent.getActiveSheet(),i=this.parent.element.querySelector(".e-sheet-password-dialog").getElementsByClassName("e-sheet-password-content")[0].querySelector(".e-input"),r=this.parent.element.querySelector(".e-reenterpwd-dialog").getElementsByClassName("e-reenterpwd-content")[0].querySelector(".e-input"),n=this.parent.createElement("span",{className:"e-reenterpwd-alert-span"});if(i.value===r.value){this.parent.setSheetPropertyOnMute(e,"isProtected",!0),this.parent.setSheetPropertyOnMute(e,"password",i.value),this.updateProtectSheet(i.value),this.dialog.hide();var s=document.querySelector(".e-protect-dlg"),l=(0,a.Xr)(s,"dialog");l.destroy(),!e.protectSettings.selectCells&&!e.protectSettings.selectUnLockedCells&&this.parent.notify(E.Qu,null)}else i.value===""?n.textContent=t.getConstant("PasswordAlertMsg"):r.value===""?n.textContent=t.getConstant("ConfirmPasswordAlertMsg"):i.value!==r.value&&(n.textContent=t.getConstant("PasswordAlert")),this.parent.element.querySelector(".e-reenterpwd-dlg").querySelector(".e-reenterpwd-dialog").appendChild(n)},o.prototype.updateProtectSheet=function(t){var e=this.parent.serviceLocator.getService(Ve),i=this.optionList.getSelectedItems(),r={selectCells:i.text.indexOf(e.getConstant("SelectCells"))>-1,formatCells:i.text.indexOf(e.getConstant("FormatCells"))>-1,formatRows:i.text.indexOf(e.getConstant("FormatRows"))>-1,formatColumns:i.text.indexOf(e.getConstant("FormatColumns"))>-1,insertLink:i.text.indexOf(e.getConstant("InsertLinks"))>-1,selectUnLockedCells:i.text.indexOf(e.getConstant("SelectUnLockedCells"))>-1};this.parent.notify(w.tVr,{protectSettings:r,password:t,triggerEvent:!0}),this.parent.notify(E.KR,null),this.parent.notify(E.V9,null)},o.prototype.protectSheetHandler=function(t){var e=(0,a.le)(t&&t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex,i=(0,w.zfV)(this.parent,e),r=this.parent.element.id,n=[r+"_undo",r+"_redo",r+"_cut",r+"_copy",r+"_paste",r+"_number_format",r+"_font_name",r+"_font_size",r+"_bold",r+"_italic",r+"_line-through",r+"_underline",r+"_font_color_picker",r+"_fill_color_picker",r+"_borders",r+"_merge_cells",r+"_text_align",r+"_vertical_align",r+"_wrap",r+"_sorting",r+"_clear",r+"_conditionalformatting"],s=[r+"_cut",r+"_copy",r+"_number_format",r+"_font_name",r+"_font_size",r+"_bold",r+"_italic",r+"_line-through",r+"_underline",r+"_font_color_picker",r+"_fill_color_picker",r+"_borders",r+"_text_align",r+"_vertical_align",r+"_wrap",r+"_sorting",r+"_clear",r+"_conditionalformatting"],l=[r+"_insert_function"],h=[r+"_hyperlink",r+"_",r+"_chart"],c=[r+"_image"],u=[r+"_find"],p=[r+"_datavalidation"],f=[r+"_chart"],g=document.getElementById(this.parent.element.id+"_sheet_panel");g&&(i.isProtected&&(i.protectSettings.selectCells||i.protectSettings.selectUnLockedCells&&!ct(this.parent,(0,w.dK5)(i.selectedRange)))?g.classList.remove("e-protected"):g.classList.add("e-protected"),i.isProtected||g.classList.remove("e-protected")),this.parent.dataBind(),this.parent.notify(E.qo,{disableHomeBtnId:n,enableHomeBtnId:s,enableFrmlaBtnId:l,enableInsertBtnId:h,findBtnId:u,dataValidationBtnId:p,imageBtnId:c,chartBtnId:f}),this.parent.notify(E.HP,null),i.isProtected&&this.parent.notify(E.IE,{props:"Protect"}),t&&t.triggerEvent&&this.parent.notify(E.Av,{action:"protectSheet",eventArgs:{sheetIndex:e,isProtected:i.isProtected,password:i.password,protectSettings:i.protectSettings.properties||i.protectSettings}})},o.prototype.editProtectedAlert=function(){var t=this,e=this.parent.serviceLocator.getService(Ve);this.dialog=this.parent.serviceLocator.getService("dialog"),this.dialog.show({content:e.getConstant("EditAlert"),isModal:!0,closeOnEscape:!0,showCloseIcon:!0,width:"400px",cssClass:"e-editAlert-dlg",beforeOpen:function(i){var r={dialogName:"EditAlertDialog",content:e.getConstant("EditAlert"),element:i.element,target:i.target,cancel:i.cancel};t.parent.trigger("dialogBeforeOpen",r),r.cancel&&(i.cancel=!0,$(function(){return t.dialog.destroyDialog()})),t.dialog.dialogInstance.content=r.content,we(t.parent.element)},close:function(){return we(t.parent.element)}})},o.prototype.protectWorkbook=function(){var t=this,e=this.parent.serviceLocator.getService(Ve),i=this.parent.serviceLocator.getService(Yt);i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-protectworkbook-dlg",header:e.getConstant("ProtectWorkbook"),beforeOpen:function(r){var n={dialogName:"ProtectWorkbook",element:r.element,target:r.target,cancel:r.cancel};t.parent.trigger("dialogBeforeOpen",n),n.cancel&&(r.cancel=!0),i.dialogInstance.content=t.passwordProtectContent(),i.dialogInstance.dataBind(),t.parent.element.focus()},buttons:[{buttonModel:{content:e.getConstant("Ok"),isPrimary:!0},click:function(){t.alertMessage(),t.dlgClickHandler(i)}}]})},o.prototype.passwordProtectContent=function(){var t=this.parent.serviceLocator.getService(Ve),e=this.parent.createElement("div",{className:"e-password-dialog"}),i=this.parent.createElement("div",{className:"e-password-content"}),r=this.parent.createElement("div",{className:"e-password-content"}),n=this.parent.createElement("div",{className:"e-header",innerHTML:t.getConstant("Password")}),s=this.parent.createElement("div",{className:"e-header",innerHTML:t.getConstant("ConfirmPassword")}),l=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}}),h=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return l.setAttribute("placeholder",t.getConstant("EnterThePassword")),h.setAttribute("placeholder",t.getConstant("EnterTheConfirmPassword")),i.appendChild(l),i.insertBefore(n,l),r.appendChild(h),r.insertBefore(s,h),e.appendChild(r),e.insertBefore(i,r),e},o.prototype.KeyUpHandler=function(t){var e=t.target;if(e.classList.contains("e-text")&&(0,a.oq)(e,".e-password-content")&&(0,a.oq)(e,".e-password-dialog")&&(0,a.oq)(e,".e-password-dialog").getElementsByClassName("e-password-content")[1]===e.parentElement){var i=(0,a.oq)(e,".e-protectworkbook-dlg"),r=i.getElementsByClassName("e-footer-content")[0],n=r.firstChild;e.value!==""?n.removeAttribute("disabled"):n.setAttribute("disabled","true")}if(e.classList.contains("e-text")&&(0,a.oq)(e,".e-unprotectpwd-content")&&(0,a.oq)(e,".e-unprotectpwd-dialog")&&(0,a.oq)(e,".e-unprotectpwd-dialog").getElementsByClassName("e-unprotectpwd-content")[0]===e.parentElement){var s=(0,a.oq)(e,".e-unprotectworkbook-dlg"),l=s.getElementsByClassName("e-footer-content")[0],h=l.firstChild;e.value!==""?h.removeAttribute("disabled"):h.setAttribute("disabled","true")}if(e.classList.contains("e-text")&&(0,a.oq)(e,".e-reenterpwd-content")&&(0,a.oq)(e,".e-reenterpwd-dialog")&&(0,a.oq)(e,".e-reenterpwd-dialog").getElementsByClassName("e-reenterpwd-content")[0]===e.parentElement){var c=(0,a.oq)(e,".e-reenterpwd-dlg"),u=c.getElementsByClassName("e-footer-content")[0],p=u.firstChild;e.value!==""?p.removeAttribute("disabled"):p.setAttribute("disabled","true")}if(e.classList.contains("e-text")&&(0,a.oq)(e,".e-unprotectsheetpwd-content")&&(0,a.oq)(e,".e-unprotectsheetpwd-dialog")&&(0,a.oq)(e,".e-unprotectsheetpwd-dialog").getElementsByClassName("e-unprotectsheetpwd-content")[0]===e.parentElement){var f=(0,a.oq)(e,".e-unprotectworksheet-dlg"),g=f.getElementsByClassName("e-footer-content")[0],C=g.firstChild;e.value!==""?C.removeAttribute("disabled"):C.setAttribute("disabled","true")}if(e.classList.contains("e-text")&&(0,a.oq)(e,".e-importprotectpwd-content")&&(0,a.oq)(e,".e-importprotectpwd-dialog")&&(0,a.oq)(e,".e-importprotectpwd-dialog").getElementsByClassName("e-importprotectpwd-content")[0]===e.parentElement){var L=(0,a.oq)(e,".e-importprotectworkbook-dlg"),D=L.getElementsByClassName("e-footer-content")[0],C=D.firstChild;e.value!==""?C.removeAttribute("disabled"):C.setAttribute("disabled","true")}},o.prototype.alertMessage=function(){var t=this.parent.element.querySelector(".e-pwd-alert-span"),e=this.parent.element.querySelector(".e-unprotectpwd-alert-span"),i=this.parent.element.querySelector(".e-importprotectpwd-alert-span"),r=this.parent.element.querySelector(".e-reenterpwd-alert-span"),n=this.parent.element.querySelector(".e-unprotectsheetpwd-alert-span");t&&t.remove(),e&&e.remove(),i&&i.remove(),r&&r.remove(),n&&n.remove()},o.prototype.dlgClickHandler=function(t){var e=this.parent.serviceLocator.getService(Ve),i=this.parent.element.querySelector(".e-password-dialog").getElementsByClassName("e-password-content")[0].querySelector(".e-input"),r=this.parent.element.querySelector(".e-password-dialog").getElementsByClassName("e-password-content")[1].querySelector(".e-input"),n=this.parent.createElement("span",{className:"e-pwd-alert-span"});i.value===r.value?(t.hide(),this.parent.notify(E.IE,{props:"Protectworkbook"}),this.protectWorkbookHandler({password:i.value}),this.parent.notify(E.Av,{action:"protectWorkbook",eventArgs:{isProtected:!0,password:i.value}})):i.value===""?n.textContent=e.getConstant("PasswordAlertMsg"):r.value===""?n.textContent=e.getConstant("ConfirmPasswordAlertMsg"):i.value!==r.value&&(n.textContent=e.getConstant("PasswordAlert")),this.parent.element.querySelector(".e-protectworkbook-dlg").querySelector(".e-dlg-content").appendChild(n)},o.prototype.protectWorkbookHandler=function(t){this.parent.password=t.password,this.parent.isProtected=!0,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.parent.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled")),this.parent.notify(E.IE,{props:"Protectworkbook"})},o.prototype.unProtectWorkbook=function(){var t=this,e=this.parent.serviceLocator.getService(Ve),i=this.parent.serviceLocator.getService(Yt);i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-unprotectworkbook-dlg",header:e.getConstant("UnProtectWorkbook"),beforeOpen:function(r){var n={dialogName:"UnProtectWorkbook",element:r.element,target:r.target,cancel:r.cancel};t.parent.trigger("dialogBeforeOpen",n),n.cancel&&(r.cancel=!0),i.dialogInstance.content=t.unProtectPasswordContent(),i.dialogInstance.dataBind(),t.parent.element.focus()},buttons:[{buttonModel:{content:e.getConstant("Ok"),isPrimary:!0,disabled:!0},click:function(){t.alertMessage(),t.unprotectdlgOkClick(i)}}]})},o.prototype.unProtectsheet=function(t){var e=this,i=this.parent.serviceLocator.getService(Ve),r=this.parent.serviceLocator.getService(Yt);r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-unprotectworksheet-dlg",header:i.getConstant("UnProtectWorksheet"),beforeOpen:function(n){var s={dialogName:"UnProtectSheet",element:n.element,target:n.target,cancel:n.cancel};e.parent.trigger("dialogBeforeOpen",s),s.cancel&&(n.cancel=!0),r.dialogInstance.content=e.unProtectSheetPasswordContent(),r.dialogInstance.dataBind(),e.parent.element.focus()},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0,disabled:!(this.parent.openModule.isImportedFile&&this.parent.openModule.unProtectSheetIdx.indexOf(this.parent.activeSheetIndex)===-1)},click:function(){e.alertMessage(),e.unprotectSheetdlgOkClick(r,t&&t.isImportedSheet)}}]})},o.prototype.reEnterSheetPassword=function(){var t=this,e=this.parent.serviceLocator.getService(Ve),i=this.parent.serviceLocator.getService(Yt);i.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-reenterpwd-dlg",header:e.getConstant("ConfirmPassword"),beforeOpen:function(r){var n={dialogName:"Re-enterPassword",element:r.element,target:r.target,cancel:r.cancel};t.parent.trigger("dialogBeforeOpen",n),n.cancel&&(r.cancel=!0),i.dialogInstance.content=t.reEnterSheetPasswordContent(),i.dialogInstance.dataBind(),t.parent.element.focus()},buttons:[{buttonModel:{content:e.getConstant("Ok"),isPrimary:!0,disabled:!0},click:function(){t.alertMessage(),t.selectSheetPassword()}}]})},o.prototype.unProtectPasswordContent=function(){var t=this.parent.serviceLocator.getService(Ve),e=this.parent.createElement("div",{className:"e-unprotectpwd-dialog"}),i=this.parent.createElement("div",{className:"e-unprotectpwd-content"}),r=this.parent.createElement("div",{className:"e-header",innerHTML:t.getConstant("EnterThePassword")}),n=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return i.appendChild(n),i.insertBefore(r,n),e.appendChild(i),e},o.prototype.reEnterSheetPasswordContent=function(){var t=this.parent.serviceLocator.getService(Ve),e=this.parent.createElement("div",{className:"e-reenterpwd-dialog"}),i=this.parent.createElement("div",{className:"e-reenterpwd-content"}),r=this.parent.createElement("div",{className:"e-header",innerHTML:t.getConstant("ReEnterPassword")}),n=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return i.appendChild(n),i.insertBefore(r,n),e.appendChild(i),e},o.prototype.unProtectSheetPasswordContent=function(){var t=this.parent.serviceLocator.getService(Ve),e=this.parent.createElement("div",{className:"e-unprotectsheetpwd-dialog"}),i=this.parent.createElement("div",{className:"e-unprotectsheetpwd-content"}),r=this.parent.createElement("div",{className:"e-header",innerHTML:t.getConstant("EnterThePassword")}),n=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return i.appendChild(n),i.insertBefore(r,n),e.appendChild(i),e},o.prototype.unprotectdlgOkClick=function(t){var e=this.parent.serviceLocator.getService(Ve),i=this.parent.element.querySelector(".e-unprotectpwd-dialog").getElementsByClassName("e-unprotectpwd-content")[0].querySelector(".e-input");if(this.parent.password===i.value)t.hide(),this.removeWorkbookProtection(),this.parent.notify(E.Av,{action:"protectWorkbook",eventArgs:{isProtected:!1}});else{var r=this.parent.createElement("span",{className:"e-unprotectpwd-alert-span",innerHTML:e.getConstant("UnProtectPasswordAlert")});this.parent.element.querySelector(".e-unprotectworkbook-dlg").querySelector(".e-dlg-content").appendChild(r)}},o.prototype.removeWorkbookProtection=function(){this.parent.password="",this.parent.isProtected=!1,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled"),this.parent.element.querySelector(".e-add-sheet-tab").classList.remove("e-disabled"));var t=document.getElementById(this.parent.element.id+"_protectworkbook");t&&t.classList.remove("e-active"),this.parent.notify(E.IE,{props:"Protectworkbook"})},o.prototype.unprotectSheetdlgOkClick=function(t,e){var i=this.parent.serviceLocator.getService(Ve),r=this.parent.getActiveSheet(),n=this.parent.element.querySelector(".e-unprotectsheetpwd-dialog").getElementsByClassName("e-unprotectsheetpwd-content")[0].querySelector(".e-input");if(e&&r.password.length===0){var s={sheetPassword:n.value,sheetIndex:this.parent.activeSheetIndex};this.parent.open(s)}else if(r.password===n.value)t.hide(),this.unProtectSheetPassword();else{var l=this.parent.createElement("span",{className:"e-unprotectsheetpwd-alert-span",innerHTML:i.getConstant("UnProtectPasswordAlert")});this.parent.element.querySelector(".e-unprotectworksheet-dlg").querySelector(".e-dlg-content").appendChild(l)}},o.prototype.unProtectSheetPassword=function(){var t=this.parent.getActiveSheet(),e=this.parent.activeSheetIndex;this.parent.setSheetPropertyOnMute(t,"isProtected",!t.isProtected),this.parent.setSheetPropertyOnMute(t,"password","");var i=!t.isProtected;this.parent.notify(E.Oj,{isActive:i,id:this.parent.element.id+"_protect",sheetIndex:e,triggerEvent:!0}),this.parent.openModule.isImportedFile&&this.parent.openModule.unProtectSheetIdx.indexOf(e)===-1&&this.parent.openModule.unProtectSheetIdx.push(e)},o.prototype.getPassWord=function(t){t.passWord=this.password},o.prototype.importProtectWorkbook=function(t){var e=this,i=this.parent.serviceLocator.getService(Ve),r=this.parent.serviceLocator.getService(Yt);r.show({width:323,isModal:!0,showCloseIcon:!0,cssClass:"e-importprotectworkbook-dlg",header:i.getConstant("UnProtectWorkbook"),beforeOpen:function(n){var s={dialogName:"ImportProtectWorkbook",element:n.element,target:n.target,cancel:n.cancel};e.parent.trigger("dialogBeforeOpen",s),s.cancel&&(n.cancel=!0),r.dialogInstance.content=e.importProtectPasswordContent(t),r.dialogInstance.dataBind(),e.parent.element.focus()},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0,disabled:!0},click:function(){e.alertMessage(),e.importOkClick(t)}}]})},o.prototype.importProtectPasswordContent=function(t){var e=this.parent.serviceLocator.getService(Ve),i=this.parent.createElement("div",{className:"e-importprotectpwd-dialog"}),r=this.parent.createElement("div",{className:"e-importprotectpwd-content"}),n=this.parent.createElement("span",{className:"e-header",innerHTML:'"'+t.file.name+'" '+e.getConstant("IsProtected")}),s=this.parent.createElement("input",{className:"e-input e-text",attrs:{type:"password"}});return s.setAttribute("placeholder",e.getConstant("EnterThePassword")),r.appendChild(n),r.appendChild(s),i.appendChild(r),i},o.prototype.importOkClick=function(t){var e=this.parent.element.querySelector(".e-importprotectpwd-dialog").getElementsByClassName("e-importprotectpwd-content")[0].querySelector(".e-input");this.parent.password=e.value;var i={file:t.file,password:e.value};this.parent.open(i)},o.prototype.getModuleName=function(){return"protectSheet"},o}(),Xb=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Gi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},$b="e-clear-icon-hide",mv="e-input-focus",Ju=["title","style","class"],ep=function(o){Xb(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.previousValue=null,r.isAngular=!1,r.isHiddenInput=!1,r.isForm=!1,r.inputPreviousValue=null,r.isVue=!1,r.textboxOptions=e,r}return t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"floatLabelType":Ue.removeFloating(this.textboxWrapper),Ue.addFloating(this.respectiveElement,this.floatLabelType,this.placeholder);break;case"enabled":Ue.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container),this.bindClearEvent();break;case"width":Ue.setWidth(e.width,this.textboxWrapper.container);break;case"value":{var l=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.isBlank(this.value)||(this.value=this.value.toString()),this.isProtectedOnChange=l,Ue.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.inputPreviousValue=this.respectiveElement.value,(this.isAngular||this.isVue)&&this.preventChange===!0?(this.previousValue=this.isAngular?this.value:this.previousValue,this.preventChange=!1):((0,a.le)(this.isAngular)||!this.isAngular||this.isAngular&&!this.preventChange||this.isAngular&&(0,a.le)(this.preventChange))&&this.raiseChangeEvent()}break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.checkAttributes(!0),Ue.validateInputType(this.textboxWrapper.container,this.element);break;case"readonly":Ue.setReadonly(this.readonly,this.respectiveElement);break;case"type":this.respectiveElement.tagName!=="TEXTAREA"&&(this.respectiveElement.setAttribute("type",this.type),Ue.validateInputType(this.textboxWrapper.container,this.element),this.raiseChangeEvent());break;case"showClearButton":this.respectiveElement.tagName!=="TEXTAREA"&&(Ue.setClearButton(this.showClearButton,this.respectiveElement,this.textboxWrapper),this.bindClearEvent());break;case"enableRtl":Ue.setEnableRtl(this.enableRtl,[this.textboxWrapper.container]);break;case"placeholder":Ue.setPlaceholder(this.placeholder,this.respectiveElement);break;case"autocomplete":this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:this.removeAttributes(["autocomplete"]);break;case"cssClass":this.updateCssClass(e.cssClass,i.cssClass);break;case"locale":this.globalize=new a.eC(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),Ue.setPlaceholder(this.placeholder,this.respectiveElement);break}}},t.prototype.getModuleName=function(){return"textbox"},t.prototype.isBlank=function(e){return!e||/^\s*$/.test(e)},t.prototype.preRender=function(){if(this.cloneElement=this.element.cloneNode(!0),this.formElement=(0,a.oq)(this.element,"form"),(0,a.le)(this.formElement)||(this.isForm=!0),this.element.tagName==="EJS-TEXTBOX"){var e=(0,a.NA)("ej2_instances",this.element),i=this.multiline?this.createElement("textarea"):this.createElement("input"),r=0;for(r;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;n!=="id"&&n!=="class"?(i.setAttribute(n,this.element.attributes[r].nodeValue),i.innerHTML=this.element.innerHTML,n==="name"&&this.element.removeAttribute("name")):n==="class"&&i.setAttribute(n,this.element.className.split(" ").filter(function(h){return h.indexOf("ng-")!==0}).join(" "))}this.element.appendChild(i),this.element=i,(0,a.sO)("ej2_instances",e,this.element)}this.updateHTMLAttrToElement(),this.checkAttributes(!1),((0,a.le)(this.textboxOptions)||this.textboxOptions.value===void 0)&&this.element.value!==""&&this.setProperties({value:this.element.value},!0),this.element.tagName!=="TEXTAREA"&&this.element.setAttribute("type",this.type),this.element.setAttribute("role","textbox"),this.globalize=new a.eC(this.locale);var s={placeholder:this.placeholder};if(this.l10n=new a.E7("textbox",s,this.locale),this.l10n.getConstant("placeholder")!==""&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",(0,a.QI)("textbox")),this.element.hasAttribute("name")||this.element.setAttribute("name",this.element.getAttribute("id")),this.element.tagName==="INPUT"&&this.multiline){this.isHiddenInput=!0,this.textarea=this.createElement("textarea"),this.element.parentNode.insertBefore(this.textarea,this.element),this.element.setAttribute("type","hidden"),this.textarea.setAttribute("name",this.element.getAttribute("name")),this.element.removeAttribute("name"),this.textarea.setAttribute("role",this.element.getAttribute("role")),this.element.removeAttribute("role"),this.textarea.setAttribute("id",(0,a.QI)("textarea"));for(var l=["placeholder","disabled","value","readonly","type","autocomplete"],r=0;r<this.element.attributes.length;r++){var n=this.element.attributes[r].nodeName;this.element.hasAttribute(n)&&Ju.indexOf(n)<0&&!(n==="id"||n==="type"||n==="e-mappinguid")&&(this.textarea.setAttribute(n,this.element.attributes[r].nodeValue),l.indexOf(n)<0&&(this.element.removeAttribute(n),r--))}}},t.prototype.checkAttributes=function(e){for(var i=e?(0,a.le)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["placeholder","disabled","value","readonly","type","autocomplete"],r=0,n=i;r<n.length;r++){var s=n[r];if(!(0,a.le)(this.element.getAttribute(s)))switch(s){case"disabled":if((0,a.le)(this.textboxOptions)||this.textboxOptions.enabled===void 0||e){var l=!(this.element.getAttribute(s)==="disabled"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true");this.setProperties({enabled:l},!e)}break;case"readonly":if((0,a.le)(this.textboxOptions)||this.textboxOptions.readonly===void 0||e){var h=this.element.getAttribute(s)==="readonly"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true";this.setProperties({readonly:h},!e)}break;case"placeholder":((0,a.le)(this.textboxOptions)||this.textboxOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.element.placeholder},!e);break;case"autocomplete":if((0,a.le)(this.textboxOptions)||this.textboxOptions.autocomplete===void 0||e){var c=this.element.autocomplete==="off"?"off":"on";this.setProperties({autocomplete:c},!e)}break;case"value":((0,a.le)(this.textboxOptions)||this.textboxOptions.value===void 0||e)&&this.setProperties({value:this.element.value},!e);break;case"type":((0,a.le)(this.textboxOptions)||this.textboxOptions.type===void 0||e)&&this.setProperties({type:this.element.type},!e);break}}},t.prototype.render=function(){var e=this.cssClass;!(0,a.le)(this.cssClass)&&this.cssClass!==""&&(e=this.getInputValidClassList(this.cssClass)),this.respectiveElement=this.isHiddenInput?this.textarea:this.element,this.textboxWrapper=Ue.createInput({element:this.respectiveElement,floatLabelType:this.floatLabelType,properties:{enabled:this.enabled,enableRtl:this.enableRtl,cssClass:e,readonly:this.readonly,placeholder:this.placeholder,showClearButton:this.showClearButton}}),this.updateHTMLAttrToWrapper(),this.isHiddenInput&&this.respectiveElement.parentNode.insertBefore(this.element,this.respectiveElement),this.wireEvents(),(0,a.le)(this.value)||(Ue.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value)),(0,a.le)(this.value)||(this.initialValue=this.value,this.setInitialValue()),this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:!(0,a.le)(this.textboxOptions)&&this.textboxOptions.autocomplete!==void 0&&this.removeAttributes(["autocomplete"]),this.previousValue=this.value,this.inputPreviousValue=this.value,this.respectiveElement.defaultValue=this.respectiveElement.value,Ue.setWidth(this.width,this.textboxWrapper.container),this.renderComplete()},t.prototype.updateHTMLAttrToWrapper=function(){if(!(0,a.le)(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(Ju.indexOf(r)>-1)if(r==="class"){var n=this.getInputValidClassList(this.htmlAttributes[r]);n!==""&&(0,a.cn)([this.textboxWrapper.container],n.split(" "))}else if(r==="style"){var s=this.textboxWrapper.container.getAttribute(r);s=(0,a.le)(s)?this.htmlAttributes[r]:s+this.htmlAttributes[r],this.textboxWrapper.container.setAttribute(r,s)}else this.textboxWrapper.container.setAttribute(r,this.htmlAttributes[r])}},t.prototype.updateHTMLAttrToElement=function(){if(!(0,a.le)(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];Ju.indexOf(r)<0&&this.element.setAttribute(r,this.htmlAttributes[r])}},t.prototype.updateCssClass=function(e,i){Ue.setCssClass(this.getInputValidClassList(e),[this.textboxWrapper.container],this.getInputValidClassList(i))},t.prototype.getInputValidClassList=function(e){var i=e;return!(0,a.le)(e)&&e!==""&&(i=e.replace(/\s+/g," ").trim()),i},t.prototype.setInitialValue=function(){this.isAngular||this.respectiveElement.setAttribute("value",this.initialValue)},t.prototype.wireEvents=function(){a.bi.add(this.respectiveElement,"focus",this.focusHandler,this),a.bi.add(this.respectiveElement,"blur",this.focusOutHandler,this),a.bi.add(this.respectiveElement,"input",this.inputHandler,this),a.bi.add(this.respectiveElement,"change",this.changeHandler,this),this.isForm&&a.bi.add(this.formElement,"reset",this.resetForm,this),this.bindClearEvent(),!(0,a.le)(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-autofill")&&this.textboxWrapper.container.classList.contains("e-outline")&&a.bi.add(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler,this)},t.prototype.animationHandler=function(){this.textboxWrapper.container.classList.add("e-valid-input");var e=this.textboxWrapper.container.querySelector(".e-float-text");(0,a.le)(e)||(e.classList.add("e-label-top"),e.classList.contains("e-label-bottom")&&e.classList.remove("e-label-bottom"))},t.prototype.resetValue=function(e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.value=e,this.isProtectedOnChange=i},t.prototype.resetForm=function(){if(this.isAngular?this.resetValue(""):this.resetValue(this.initialValue),!(0,a.le)(this.textboxWrapper)){var e=this.textboxWrapper.container.querySelector(".e-float-text");(0,a.le)(e)||((0,a.le)(this.initialValue)||this.initialValue===""?(e.classList.add("e-label-bottom"),e.classList.remove("e-label-top")):this.initialValue!==""&&(e.classList.add("e-label-top"),e.classList.remove("e-label-bottom")))}},t.prototype.focusHandler=function(e){var i={container:this.textboxWrapper.container,event:e,value:this.value};this.trigger("focus",i)},t.prototype.focusOutHandler=function(e){!(this.previousValue===null&&this.value===null&&this.respectiveElement.value==="")&&this.previousValue!==this.respectiveElement.value&&this.raiseChangeEvent(e,!0);var i={container:this.textboxWrapper.container,event:e,value:this.value};this.trigger("blur",i)},t.prototype.inputHandler=function(e){var i=this,r={event:e,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};this.inputPreviousValue=this.respectiveElement.value,this.isAngular&&(i.localChange({value:this.respectiveElement.value}),this.preventChange=!0),this.isVue&&(this.preventChange=!0),this.trigger("input",r),e.stopPropagation()},t.prototype.changeHandler=function(e){this.setProperties({value:this.respectiveElement.value},!0),this.raiseChangeEvent(e,!0),e.stopPropagation()},t.prototype.raiseChangeEvent=function(e,i){var r={event:e,value:this.value,previousValue:this.previousValue,container:this.textboxWrapper.container,isInteraction:i||!1,isInteracted:i||!1};this.preventChange=!1,this.trigger("change",r),this.previousValue=this.value,this.element.tagName==="INPUT"&&this.multiline&&a.AR.info.name==="mozilla"&&(this.element.value=this.respectiveElement.value)},t.prototype.bindClearEvent=function(){this.showClearButton&&this.respectiveElement.tagName!=="TEXTAREA"&&(this.enabled?a.bi.add(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler,this):a.bi.remove(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler))},t.prototype.resetInputHandler=function(e){if(e.preventDefault(),!this.textboxWrapper.clearButton.classList.contains($b)||this.textboxWrapper.container.classList.contains("e-static-clear")){Ue.setValue("",this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.setProperties({value:this.respectiveElement.value},!0);var i={event:e,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};this.trigger("input",i),this.inputPreviousValue=this.respectiveElement.value,this.raiseChangeEvent(e,!0)}},t.prototype.unWireEvents=function(){a.bi.remove(this.respectiveElement,"focus",this.focusHandler),a.bi.remove(this.respectiveElement,"blur",this.focusOutHandler),a.bi.remove(this.respectiveElement,"input",this.inputHandler),a.bi.remove(this.respectiveElement,"change",this.changeHandler),this.isForm&&a.bi.remove(this.formElement,"reset",this.resetForm),!(0,a.le)(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-outline")&&this.textboxWrapper.container.classList.contains("e-autofill")&&a.bi.remove(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler)},t.prototype.destroy=function(){this.unWireEvents(),this.element.tagName==="INPUT"&&this.multiline&&((0,a.og)(this.textboxWrapper.container.getElementsByTagName("textarea")[0]),this.respectiveElement=this.element,this.element.removeAttribute("type")),this.respectiveElement.value=this.respectiveElement.defaultValue,this.respectiveElement.classList.remove("e-input"),this.removeAttributes(["aria-placeholder","aria-disabled","aria-readonly","aria-labelledby"]),(0,a.le)(this.textboxWrapper)||(this.textboxWrapper.container.insertAdjacentElement("afterend",this.respectiveElement),(0,a.og)(this.textboxWrapper.container)),this.textboxWrapper=null,o.prototype.destroy.call(this)},t.prototype.addIcon=function(e,i){Ue.addIcon(e,i,this.textboxWrapper.container,this.respectiveElement,this.createElement)},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.addAttributes=function(e){for(var i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];n==="disabled"?(this.setProperties({enabled:!1},!0),Ue.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):n==="readonly"?(this.setProperties({readonly:!0},!0),Ue.setReadonly(this.readonly,this.respectiveElement)):n==="class"?this.respectiveElement.classList.add(e[n]):n==="placeholder"?(this.setProperties({placeholder:e[n]},!0),Ue.setPlaceholder(this.placeholder,this.respectiveElement)):n==="rows"&&this.respectiveElement.tagName==="TEXTAREA"?this.respectiveElement.setAttribute(n,e[n]):this.respectiveElement.setAttribute(n,e[n])}},t.prototype.removeAttributes=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];n==="disabled"?(this.setProperties({enabled:!0},!0),Ue.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):n==="readonly"?(this.setProperties({readonly:!1},!0),Ue.setReadonly(this.readonly,this.respectiveElement)):n==="placeholder"?(this.setProperties({placeholder:null},!0),Ue.setPlaceholder(this.placeholder,this.respectiveElement)):this.respectiveElement.removeAttribute(n)}},t.prototype.focusIn=function(){document.activeElement!==this.respectiveElement&&this.enabled&&(this.respectiveElement.focus(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&(0,a.cn)([this.textboxWrapper.container],[mv]))},t.prototype.focusOut=function(){document.activeElement===this.respectiveElement&&this.enabled&&(this.respectiveElement.blur(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&(0,a.IV)([this.textboxWrapper.container],[mv]))},Gi([(0,a.Z9)("text")],t.prototype,"type",void 0),Gi([(0,a.Z9)(!1)],t.prototype,"readonly",void 0),Gi([(0,a.Z9)(null)],t.prototype,"value",void 0),Gi([(0,a.Z9)("Never")],t.prototype,"floatLabelType",void 0),Gi([(0,a.Z9)("")],t.prototype,"cssClass",void 0),Gi([(0,a.Z9)(null)],t.prototype,"placeholder",void 0),Gi([(0,a.Z9)("on")],t.prototype,"autocomplete",void 0),Gi([(0,a.Z9)({})],t.prototype,"htmlAttributes",void 0),Gi([(0,a.Z9)(!1)],t.prototype,"multiline",void 0),Gi([(0,a.Z9)(!0)],t.prototype,"enabled",void 0),Gi([(0,a.Z9)(!1)],t.prototype,"showClearButton",void 0),Gi([(0,a.Z9)(!1)],t.prototype,"enablePersistence",void 0),Gi([(0,a.Z9)(null)],t.prototype,"width",void 0),Gi([(0,a.ju)()],t.prototype,"created",void 0),Gi([(0,a.ju)()],t.prototype,"destroyed",void 0),Gi([(0,a.ju)()],t.prototype,"change",void 0),Gi([(0,a.ju)()],t.prototype,"blur",void 0),Gi([(0,a.ju)()],t.prototype,"focus",void 0),Gi([(0,a.ju)()],t.prototype,"input",void 0),t=Gi([a.Zl],t),t}(a.wA),tp=function(){function o(t){this.shortValue="",this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(E.DK,this.renderFindDlg,this),this.parent.on(E.T7,this.renderGotoDlg,this),this.parent.on(w.E9X,this.gotoHandler,this),this.parent.on(E.nb,this.findHandler,this),this.parent.on(w.vCD,this.showDialog,this),this.parent.on(w.RDz,this.replaceAllDialog,this),this.parent.on(w.wzZ,this.findKeyUp,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.DK,this.renderFindDlg),this.parent.off(E.T7,this.renderGotoDlg),this.parent.off(w.E9X,this.gotoHandler),this.parent.off(E.nb,this.findHandler),this.parent.off(w.vCD,this.showDialog),this.parent.off(w.RDz,this.replaceAllDialog),this.parent.off(w.wzZ,this.findKeyUp))},o.prototype.renderFindDlg=function(){var t=this,e=this.parent.serviceLocator.getService(Yt);if(this.parent.element.querySelector(".e-find-dlg"))e.hide();else{var i=this.parent.serviceLocator.getService(Ve),r={isModal:!1,showCloseIcon:!0,cssClass:"e-find-dlg",allowDragging:!0,header:i.getConstant("FindAndReplace"),closeOnEscape:!1,beforeOpen:function(n){var s={dialogName:"FindAndReplaceDialog",element:n.element,target:n.target,cancel:n.cancel};t.parent.trigger("dialogBeforeOpen",s),s.cancel&&(n.cancel=!0),e.dialogInstance.content=t.findandreplaceContent(),e.dialogInstance.dataBind(),we(t.parent.element)},buttons:[{buttonModel:{content:i.getConstant("FindPreviousBtn"),isPrimary:!0,cssClass:"e-btn-findPrevious",disabled:!0},click:function(n){t.dialogMessage(),t.findHandler({findOption:n&&n.keyCode===13?"next":"prev"})}},{buttonModel:{content:i.getConstant("FindNextBtn"),isPrimary:!0,cssClass:"e-btn-findNext",disabled:!0},click:function(){t.dialogMessage(),t.findHandler({findOption:"next"})}},{buttonModel:{content:i.getConstant("ReplaceBtn"),isPrimary:!0,cssClass:"e-btn-replace",disabled:!0},click:function(){t.dialogMessage(),t.replaceHandler(w.gxs)}},{buttonModel:{content:i.getConstant("ReplaceAllBtn"),isPrimary:!0,cssClass:"e-btn-replaceAll",disabled:!0},click:function(){t.dialogMessage(),t.replaceHandler(w.kon)}}],open:function(){var n=t.parent.element.querySelector(".e-text-findNext").value;if(n){var s=t.parent.element.querySelector(".e-btn-findPrevious"),l=(0,a.Xr)(s,"btn");l.disabled=!1,(0,a.Xr)(t.parent.element.querySelector(".e-btn-findNext"),"btn").disabled=!1}},close:function(){e.hide()}};e.show(r)}},o.prototype.dialogMessage=function(){this.parent.element.querySelector(".e-replace-alert-span")?this.parent.element.querySelector(".e-replace-alert-span").remove():this.parent.element.querySelector(".e-find-alert-span")&&this.parent.element.querySelector(".e-find-alert-span").remove()},o.prototype.renderGotoDlg=function(){var t=this,e=this.parent.serviceLocator.getService(Ve),i=this.parent.serviceLocator.getService(Yt),r=!1;if((0,a.le)(this.parent.element.querySelector(".e-find-dlg"))){var n={width:300,isModal:!1,showCloseIcon:!0,cssClass:"e-goto-dlg",allowDragging:!0,header:e.getConstant("GotoHeader"),beforeOpen:function(s){var l={dialogName:"GoToDialog",element:s.element,target:s.target,cancel:s.cancel};t.parent.trigger("dialogBeforeOpen",l),l.cancel&&(s.cancel=!0),i.dialogInstance.content=t.GotoContent(),i.dialogInstance.dataBind(),we(t.parent.element)},buttons:[{buttonModel:{content:e.getConstant("Ok"),isPrimary:!0,cssClass:"e-btn-goto-ok"},click:function(){t.gotoHandler()}}],close:function(){i.hide()},open:function(){t.textFocus()}};i.show(n,r)}else i.hide()},o.prototype.textFocus=function(){var t=this,e=this.parent.element.querySelector(".e-text-goto");e.addEventListener("focus",function(){t.parent.element.querySelector(".e-goto-alert-span")&&t.parent.element.querySelector(".e-goto-alert-span").remove()})},o.prototype.findHandler=function(t){var e=this.parent.element.querySelector(".e-text-findNext");e||(e=this.parent.element.querySelector(".e-text-findNext-short"),e||this.gotoAlert());var i=e.value;if(e.value!==""){var r=this.parent.activeSheetIndex,n=this.parent.element.querySelector(".e-findnreplace-checkcase"),s=void 0;if(!n)s=!1;else{var l=(0,a.Xr)(n,"checkbox");s=l.checked}var h=this.parent.element.querySelector(".e-findnreplace-checkmatch"),c=void 0;if(!h)c=!1;else{var u=(0,a.Xr)(h,"checkbox");c=u.checked}var p=this.parent.element.querySelector(".e-findnreplace-searchby"),f=void 0;if(!p)f="By Row";else{var g=(0,a.Xr)(p,"dropdownlist");f=g.value.toString()}var C=this.parent.element.querySelector(".e-findnreplace-searchwithin"),L=void 0;if(!C)L="Sheet";else{var D=(0,a.Xr)(C,"dropdownlist");L=D.value.toString()}var R={value:i,sheetIndex:r,findOpt:t.findOption,mode:L,isCSen:s,isEMatch:c,searchBy:f,isAction:!0};this.parent.find(R)}},o.prototype.replaceHandler=function(t){var e=this.parent.element.querySelector(".e-find-dlg"),i=e.querySelector(".e-text-findNext").value,r=this.parent.element.querySelector(".e-text-replaceInp").value,n=this.parent.element.querySelector(".e-findnreplace-checkcase").checked,s=this.parent.element.querySelector(".e-findnreplace-checkmatch").checked,l=this.parent.element.querySelector(".e-search-within .e-ddl-hidden").value,h=this.parent.element.querySelector(".e-searchby .e-ddl-hidden").value;this.parent.notify(t,{value:i,mode:l,isCSen:n,isEMatch:s,searchBy:h,findOpt:"next",replaceValue:r,replaceBy:t,sheetIndex:this.parent.activeSheetIndex,isAction:!0})},o.prototype.gotoHandler=function(t){if(t)this.parent.goTo(t.address);else{var e=this.parent.element.querySelector(".e-text-goto"),i=e.value,r=i.split("");if(i===""||isNaN(parseInt(r[1],10))){this.gotoAlert();return}else{var n=i.toString().toUpperCase();this.parent.goTo(n)}}},o.prototype.gotoAlert=function(){var t=this.parent.serviceLocator.getService(Ve),e=this.parent.createElement("span",{className:"e-goto-alert-span",innerHTML:t.getConstant("InsertingEmptyValue")});this.parent.element.querySelector(".e-goto-alert-span")&&this.parent.element.querySelector(".e-goto-alert-span").remove(),this.parent.element.querySelector(".e-goto-dlg").querySelector(".e-dlg-content").appendChild(e)},o.prototype.showDialog=function(){this.parent.element.querySelector(".e-replace-alert-span")&&this.parent.element.querySelector(".e-replace-alert-span").remove();var t=this.parent.serviceLocator.getService(Ve),e=this.parent.createElement("span",{className:"e-find-alert-span",innerHTML:t.getConstant("NoElements")});this.parent.element.querySelector(".e-find-dlg")&&this.parent.element.querySelector(".e-find-dlg").querySelector(".e-dlg-content").appendChild(e)},o.prototype.replaceAllDialog=function(t){this.parent.element.querySelector(".e-find-alert-span")&&this.parent.element.querySelector(".e-find-alert-span").remove();var e=this.parent.serviceLocator.getService(Ve),i=this.parent.createElement("span",{className:"e-replace-alert-span",innerHTML:t.count+e.getConstant("ReplaceAllEnd")+t.replaceValue});this.parent.element.querySelector(".e-find-dlg")&&this.parent.element.querySelector(".e-find-dlg").querySelector(".e-dlg-content").appendChild(i)},o.prototype.findKeyUp=function(t){if(t.target.classList.contains("e-text-findNext")){var e=this.parent.element.querySelector(".e-text-findNext").value;if(!(0,a.le)(e)&&e!==""){var i=this.parent.element.querySelector(".e-btn-findPrevious"),r=(0,a.Xr)(i,"btn");r.disabled=!1,(0,a.Xr)(this.parent.element.querySelector(".e-btn-findNext"),"btn").disabled=!1}else(0,a.Xr)(this.parent.element.querySelector(".e-btn-findPrevious"),"btn").disabled=!0,(0,a.Xr)(this.parent.element.querySelector(".e-btn-findNext"),"btn").disabled=!0,this.dialogMessage()}var n=this.parent.element.querySelector(".e-text-findNext").value,s=this.parent.element.querySelector(".e-text-replaceInp").value;!(0,a.le)(n)&&!(0,a.le)(s)&&n!==""&&s!==""?this.parent.getActiveSheet().isProtected===!1&&((0,a.Xr)(this.parent.element.querySelector(".e-btn-replace"),"btn").disabled=!1,(0,a.Xr)(this.parent.element.querySelector(".e-btn-replaceAll"),"btn").disabled=!1):((0,a.Xr)(this.parent.element.querySelector(".e-btn-replace"),"btn").disabled=!0,(0,a.Xr)(this.parent.element.querySelector(".e-btn-replaceAll"),"btn").disabled=!0)},o.prototype.findandreplaceContent=function(){this.parent.element.querySelector(".e-text-findNext-short")&&(this.shortValue=this.parent.element.querySelector(".e-text-findNext-short").value);var t=this.parent.createElement("div",{className:"e-link-dialog"}),e=this.parent.createElement("div",{className:"e-find"}),i=this.parent.createElement("div",{className:"e-findCheck"}),r=this.parent.serviceLocator.getService(Ve);t.appendChild(e);var n=this.parent.createElement("div",{className:"e-cont"}),s=this.parent.createElement("p",{className:"e-header",innerHTML:r.getConstant("FindWhat")}),l=this.parent.createElement("input",{className:"e-input e-text-findNext",attrs:{type:"Text",placeholder:r.getConstant("FindValue"),value:this.shortValue}});n.appendChild(l),n.insertBefore(s,l),e.appendChild(n);var h=new ep({width:"70%"});h.createElement=this.parent.createElement,h.appendTo(l);var c=this.parent.createElement("div",{className:"e-cont"}),u=this.parent.createElement("p",{className:"e-header",innerHTML:r.getConstant("ReplaceWith")}),p=this.parent.createElement("input",{className:"e-input e-text-replaceInp",attrs:{type:"Text",placeholder:r.getConstant("ReplaceValue")}});c.appendChild(p),c.insertBefore(u,p),e.appendChild(c);var f=new ep({width:"70%"});f.createElement=this.parent.createElement,f.appendTo(p);var g=[{Id:"Sheet",Within:r.getConstant("Sheet")},{Id:"Workbook",Within:r.getConstant("Workbook")}],C=new mn({dataSource:g,cssClass:"e-search-within",fields:{value:"Id",text:"Within"},width:"50%",index:0}),L=this.parent.createElement("input",{className:"e-findnreplace-searchwithin",attrs:{type:"select",label:r.getConstant("SearchBy")}}),D=this.parent.createElement("p",{className:"e-header",innerHTML:r.getConstant("SearchWithin")});e.appendChild(D),e.appendChild(L),C.createElement=this.parent.createElement,C.appendTo(L);var R=[{Id:"By Row",Search:r.getConstant("ByRow")},{Id:"By Column",Search:r.getConstant("ByColumn")}],B=new mn({dataSource:R,cssClass:"e-searchby",fields:{value:"Id",text:"Search"},width:"50%",index:0}),H=this.parent.createElement("input",{className:"e-findnreplace-searchby",attrs:{type:"select",label:r.getConstant("SearchBy")}}),j=this.parent.createElement("p",{className:"e-header",innerHTML:r.getConstant("SearchBy")});e.appendChild(j),e.appendChild(H),B.createElement=this.parent.createElement,B.appendTo(H);var W=new Yn({label:r.getConstant("MatchCase"),checked:!1,cssClass:"e-findnreplace-casecheckbox"}),ne=this.parent.createElement("input",{className:"e-findnreplace-checkcase",attrs:{type:"checkbox"}});i.appendChild(ne),W.createElement=this.parent.createElement,W.appendTo(ne);var ie=new Yn({label:r.getConstant("MatchExactCellElements"),checked:!1,cssClass:"e-findnreplace-exactmatchcheckbox"}),me=this.parent.createElement("input",{className:"e-findnreplace-checkmatch",attrs:{type:"checkbox"}});return i.appendChild(me),ie.createElement=this.parent.createElement,ie.appendTo(me),e.appendChild(i),t},o.prototype.GotoContent=function(){var t=this.parent.serviceLocator.getService(Ve),e=this.parent.createElement("div",{className:"e-link-dialog"}),i=this.parent.createElement("div",{className:"e-goto"});e.appendChild(i);var r=this.parent.createElement("div",{className:"e-cont"}),n=this.parent.createElement("p",{className:"e-header",innerHTML:t.getConstant("Reference")}),s=new ep({placeholder:t.getConstant("EntercellAddress")}),l=this.parent.createElement("input",{className:"e-text-goto",attrs:{type:"Text"}});return r.appendChild(l),r.insertBefore(n,l),i.appendChild(r),s.createElement=this.parent.createElement,s.appendTo(l),e},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"findAndReplace"},o}(),ip=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.merge=function(t){var e=this;if(t.showDialog){this.parent.serviceLocator.getService(Yt).show({target:this.parent.element,height:180,width:400,isModal:!0,showCloseIcon:!0,content:this.parent.serviceLocator.getService(Ve).getConstant("PasteMergeAlert"),beforeOpen:function(i){var r={dialogName:"MergeDialog",element:i.element,target:i.target,cancel:i.cancel};e.parent.trigger("dialogBeforeOpen",r),r.cancel&&(i.cancel=!0),we(e.parent.element)}});return}this.parent.serviceLocator.getService("cell").refresh(t.rowIdx,t.colIdx,t.lastCell,t.element)},o.prototype.hideHandler=function(t){var e=this.parent.getActiveSheet(),i={range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]};this.parent.notify(pe.Zf5,i),i.range=i.range;var r=(0,w.$Su)(i.range[0],i.range[1],e)||{},n=t.model==="row"?i.range[0]:i.range[1],s=n+((r[t.model+"Span"]||1)-1);if(!(!t.isEnd&&(t.start===n||(0,w.NqJ)(e,n))||t.isEnd&&t.start>n&&!(0,w.NqJ)(e,n))&&r[t.model+"Span"]>1&&s>=t.start)if(t.model==="row"?(0,w.gSQ)(e,n):(0,w.NqJ)(e,n)){if(t.end<s&&(s-t.end>1||r.rowSpan>1)){var l=this.parent.getCell(t.rowIdx,t.end+1);if(l&&(s-t.end>1&&(l.colSpan=s-t.end),l.style.display=""),r.rowSpan>1){var h=r.rowSpan-this.parent.hiddenCount(t.rowIdx,t.rowIdx+(r.rowSpan-1));h>1&&(l.rowSpan=h)}}}else this.merge({rowIdx:i.range[0],colIdx:i.range[1]})},o.prototype.checkPrevMerge=function(t){var e,i=this.parent.getActiveSheet(),r,n;if(t.isRow){t.rowIdx-1>-1&&(0,w.gSQ)(i,t.rowIdx-1)&&(e=(0,w.$Su)(t.rowIdx-1,t.colIdx,i)||{},(e.rowSpan!==void 0||e.colSpan!==void 0)&&(e.colSpan===void 0||e.colSpan>1||t.colIdx-1>-1&&(0,w.NqJ)(i,t.colIdx-1))&&(r={range:[t.rowIdx-1,t.colIdx,t.rowIdx-1,t.colIdx]},this.parent.notify(pe.Zf5,r),r.range=r.range,(0,w.gSQ)(i,r.range[0])&&r.range[2]>=t.rowIdx&&(e=(0,w.$Su)(r.range[0],r.range[1],i)||{},e.rowSpan>1&&(n=r.range[2]-t.rowIdx+1-this.parent.hiddenCount(t.rowIdx,t.rowIdx+(r.range[2]-t.rowIdx)),n>1&&(t.td.rowSpan=n,t.td.style.display=""),e.colSpan>1&&!(t.colIdx-1>-1&&(0,w.NqJ)(i,t.colIdx-1))&&(n=e.colSpan-this.parent.hiddenCount(t.colIdx,t.colIdx+(e.colSpan-1),"columns"),n>1&&(t.td.colSpan=n,t.td.style.display=""))))));return}t.colIdx-1>-1&&(0,w.NqJ)(i,t.colIdx-1)&&(e=(0,w.$Su)(t.rowIdx,t.colIdx-1,i)||{},(e.colSpan!==void 0||e.rowSpan!==void 0)&&(e.rowSpan===void 0||e.rowSpan>1||t.rowIdx-1>-1&&(0,w.gSQ)(i,t.rowIdx-1))&&(r={range:[t.rowIdx,t.colIdx-1,t.rowIdx,t.colIdx-1]},this.parent.notify(pe.Zf5,r),r.range=r.range,(0,w.NqJ)(i,r.range[1])&&r.range[3]>=t.colIdx&&(e=(0,w.$Su)(r.range[0],r.range[1],i)||{},e.colSpan>1&&(n=r.range[3]-t.colIdx+1-this.parent.hiddenCount(t.colIdx,t.colIdx+(e.colSpan-1),"columns"),n>1&&(t.td.colSpan=n,t.td.style.display=""),e.rowSpan>1&&!(t.rowIdx-1>-1&&(0,w.gSQ)(i,t.rowIdx-1))&&(n=e.rowSpan-this.parent.hiddenCount(t.rowIdx,t.rowIdx+(e.rowSpan-1)),n>1&&(t.td.rowSpan=n,t.td.style.display=""))))))},o.prototype.checkMerge=function(t){var e=this.parent.getActiveSheet(),i=(0,w.$Su)(t.rowIdx,t.colIdx,e)||{};if(t.isRow){if(i.colSpan===void 0||(0,w.NqJ)(e,t.colIdx-1)){var r={range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]};if(r.range=r.range,this.parent.notify(pe.Zf5,r),(0,w.NqJ)(e,t.colIdx-1)&&!(0,w.NqJ)(e,r.range[1])||t.isFreezePane&&r.range[0]<this.parent.frozenRowCount(e)){t.insideFreezePane=r.range[0]<this.parent.frozenRowCount(e);return}i=(0,w.$Su)(r.range[0],r.range[1],e);var n=r.range[2]-t.rowIdx+1-this.parent.hiddenCount(t.rowIdx,r.range[2]);n>1&&(this.merge({rowIdx:r.range[0],colIdx:r.range[1],element:t.td}),t.td.rowSpan=n,t.td.style.display="")}}else if(i.rowSpan===void 0||(0,w.gSQ)(e,t.rowIdx-1)){var r={range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]};if(r.range=r.range,this.parent.notify(pe.Zf5,r),(0,w.gSQ)(e,t.rowIdx-1)&&!(0,w.gSQ)(e,r.range[0])||t.isFreezePane&&r.range[1]<this.parent.frozenColCount(e)){t.insideFreezePane=r.range[1]<this.parent.frozenColCount(e);return}i=(0,w.$Su)(r.range[0],r.range[1],e);var n=r.range[3]-t.colIdx+1-this.parent.hiddenCount(t.colIdx,r.range[3],"columns");n>1&&(this.merge({rowIdx:r.range[0],colIdx:r.range[1],element:t.td}),t.td.colSpan=n,t.td.style.display="")}},o.prototype.addEventListener=function(){this.parent.on(pe.i8F,this.merge,this),this.parent.on(E.$o,this.hideHandler,this),this.parent.on(E.y9,this.checkPrevMerge,this),this.parent.on(E.Sq,this.checkMerge,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(pe.i8F,this.merge),this.parent.off(E.$o,this.hideHandler),this.parent.off(E.y9,this.checkPrevMerge),this.parent.off(E.Sq,this.checkMerge))},o.prototype.getModuleName=function(){return"merge"},o}(),rp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener()},o.prototype.addEventListener=function(){this.parent.on(pe.uAN,this.cFInitialRender,this),this.parent.on(pe.wWe,this.cFInitialCheckHandler,this),this.parent.on(pe.xMH,this.checkConditionalFormatHandler,this),this.parent.on(E.h4,this.initiateCFHandler,this),this.parent.on(E.Nm,this.setCFHandler,this),this.parent.on(pe.bLA,this.clearCFHandler,this),this.parent.on(pe.eaW,this.addClearCFHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(pe.uAN,this.cFInitialRender),this.parent.off(pe.wWe,this.cFInitialCheckHandler),this.parent.off(pe.xMH,this.checkConditionalFormatHandler),this.parent.off(E.h4,this.initiateCFHandler),this.parent.off(E.Nm,this.setCFHandler),this.parent.off(pe.bLA,this.clearCFHandler))},o.prototype.setCF=function(t){t.range=t.range||this.parent.getActiveSheet().selectedRange,this.parent.notify(pe.axz,{conditionalFormat:t,isAction:!0})},o.prototype.addClearCFHandler=function(t){for(var e=this.parent.getActiveSheet(),i=t.conditionalFormats,r=t.oldRange,n=t.selectedRange,s=e.conditionalFormats,l=i.length-1;l>=0;l--){for(var h=!1,c=0;c<s.length;c++)if(s[c].type===i[l].type&&s[c].range===i[l].range){h=!0,s[c].range=r[l],e.conditionalFormats[c].range=r[l];for(var u=(0,pe.dK5)(n),p=r[l].split(","),f=0;f<p.length;f++)for(var g=(0,pe.dK5)(p[f]),C=g[0];C<=g[2];C++)for(var L=g[1];L<=g[3];L++)for(var D=u[0];D<=u[2];D++)for(var R=u[1];R<=u[3];R++)if(D===C&&R===L){var B=this.parent.getCell(C,L),H=e.rows[C]&&e.rows[C].cells[L]?e.rows[C].cells[L]:null;H&&this.cFInitialCheckHandler({rowIdx:C,colIdx:L,cell:H,td:B,conditionalFormat:s[c]})}}if(!h){var j=i[l];j.range=r[l],this.parent.notify(pe.axz,{conditionalFormat:j})}}},o.prototype.clearCFHandler=function(t){var e=this.parent.getActiveSheet(),i=this.parent.getCell(t.rIdx,t.cIdx),r=(0,He.$S)(t.rIdx,t.cIdx,e);if(!!i){if(i.classList.remove("e-redft"),i.classList.remove("e-yellowft"),i.classList.remove("e-greenft"),i.classList.remove("e-redf"),i.classList.remove("e-redt"),i.classList.remove("e-iconset"),i.style){if(i.style.backgroundColor){i.style.backgroundColor="";var n=this.parent.getCellStyleValue(["backgroundColor"],[t.rIdx,t.cIdx]);this.parent.notify(pe.nJk,{style:n,rowIdx:t.rIdx,colIdx:t.cIdx})}if(i.style.color){i.style.color="";var n=this.parent.getCellStyleValue(["color"],[t.rIdx,t.cIdx]);this.parent.notify(pe.nJk,{style:n,rowIdx:t.rIdx,colIdx:t.cIdx})}}i.querySelector(".e-cf-databar")&&(i.removeChild(i.querySelector(".e-cf-databar")),i.textContent=this.parent.getDisplayText(r)),i.querySelector(".e-iconsetspan")&&(i.removeChild(i.querySelector(".e-iconsetspan")),i.textContent=this.parent.getDisplayText(r))}},o.prototype.setCFHandler=function(t){t.action==="cf_databars"?this.setCF({type:t.id}):t.action==="cf_colorscales"?this.setCF({type:t.id}):t.action==="cf_iconsets"&&this.setCF({type:t.id})},o.prototype.initiateCFHandler=function(t){var e=this,i=this.parent.serviceLocator.getService(Ve),r=this.parent.serviceLocator.getService(Yt);r.show({width:375,showCloseIcon:!0,isModal:!0,cssClass:"e-conditionalformatting-dlg",header:t.action.replace("...",""),target:document.querySelector(".e-control.e-spreadsheet"),beforeOpen:function(){r.dialogInstance.content=e.cFDlgContent(t.action),r.dialogInstance.dataBind(),we(e.parent.element)},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0,cssClass:"e-btn e-clearall-btn e-flat"},click:function(){r.dialogInstance.element.getElementsByClassName("e-clearall-btn")[0].disabled||(e.dlgClickHandler(t.action),r.hide())}}]}),r.dialogInstance.refresh()},o.prototype.dlgClickHandler=function(t){var e="",i="",r=this.parent.element.querySelector(".e-conditionalformatting-dlg").getElementsByClassName("e-dlg-content")[0].querySelector(".e-cf-dlg"),n=r.querySelector(".e-cfmain");if(n){var s=n.getElementsByTagName("input")[0];s&&s.parentElement.classList.contains("e-cfmain")&&(e=n.getElementsByTagName("input")[0].value),i=n.getElementsByTagName("input")[1]?r.querySelector(".e-cfmain").getElementsByTagName("input")[1].value:"";var l=(0,a.o5)(this.parent.locale,"");e=e.split(l).join("").split(",").join(""),i=i.split(l).join("").split(",").join("")}var h=this.getCFColor(r.querySelector(".e-cfsub").getElementsByTagName("input")[0].value),c=t==="Duplicate Values..."?r.querySelector(".e-cfmain").getElementsByTagName("input")[0].value:this.getType(t);e!==""&&i!==""?this.setCF({type:c,cFColor:h,value:e+","+i}):e!==""?this.setCF({type:c,cFColor:h,value:e}):this.setCF({type:c,cFColor:h,value:i})},o.prototype.getType=function(t){var e=this.parent.serviceLocator.getService(Ve),i="";switch(t){case e.getConstant("GreaterThan")+"...":i="GreaterThan";break;case e.getConstant("LessThan")+"...":i="LessThan";break;case e.getConstant("Between")+"...":i="Between";break;case e.getConstant("CFEqualTo")+"...":i="EqualTo";break;case e.getConstant("TextThatContains")+"...":i="ContainsText";break;case e.getConstant("ADateOccuring")+"...":i="DateOccur";break;case e.getConstant("Top10Items")+"...":i="Top10Items";break;case e.getConstant("Bottom10Items")+"...":i="Bottom10Items";break;case e.getConstant("Top10")+" %...":i="Top10Percentage";break;case e.getConstant("Bottom10")+" %...":i="Bottom10Percentage";break;case e.getConstant("AboveAverage")+"...":i="AboveAverage";break;case e.getConstant("BelowAverage")+"...":i="BelowAverage";break}return i},o.prototype.getCFColor=function(t){var e=this.parent.serviceLocator.getService(Ve),i="RedFT";switch(t){case e.getConstant("LightRedFillWithDarkRedText"):i="RedFT";break;case e.getConstant("YellowFillWithDarkYellowText"):i="YellowFT";break;case e.getConstant("GreenFillWithDarkGreenText"):i="GreenFT";break;case e.getConstant("RedFill"):i="RedF";break;case e.getConstant("RedText"):i="RedT";break}return i},o.prototype.cFDlgContent=function(t){var e=this.getDlgText(t),i=this.parent.serviceLocator.getService(Ve),r=this.parent.createElement("div",{className:"e-cf-dlg"}),n=this.parent.createElement("div",{className:"e-cfmain"}),s=this.parent.createElement("div",{className:"e-cfsub"}),l=this.parent.createElement("span",{className:"e-header e-top-header",innerHTML:e}),h=this.parent.createElement("input",{className:"e-input",id:"valueInput",attrs:{type:"text"}}),c=this.parent.createElement("input",{className:"e-select"}),u=this.parent.createElement("span",{className:"e-header",innerHTML:i.getConstant("With")}),p=this.parent.createElement("input",{className:"e-select"});r.appendChild(n),r.appendChild(s),n.appendChild(l);var f;if(t!==i.getConstant("DuplicateValues")+"..."){if(t!==i.getConstant("AboveAverage")+"..."&&t!==i.getConstant("BelowAverage")+"..."){n.appendChild(h),f=!0;var g=t===i.getConstant("Top10")+" %..."||t===i.getConstant("Bottom10")+" %...";if(t===i.getConstant("Top10Items")+"..."||t===i.getConstant("Bottom10Items")+"..."||g){h.maxLength=g?3:4;var C=new Zn({value:10,min:1,max:g?100:1e3,format:"###"});C.appendTo(h)}}}else{n.appendChild(c);var L=[{text:i.getConstant("Duplicate"),id:"duplicate"},{text:i.getConstant("Unique"),id:"unique"}],D=new mn({dataSource:L,index:0,popupHeight:"200px"});D.appendTo(c)}if(t===i.getConstant("Between")+"..."){var R=this.parent.createElement("span",{className:"e-header e-header-2",innerHTML:i.getConstant("And")}),B=this.parent.createElement("input",{className:"e-input e-between"});n.appendChild(R),n.appendChild(B),B.addEventListener("input",this.validateCfInput.bind(this))}f&&(this.validateCfInput({target:h}),h.addEventListener("input",this.validateCfInput.bind(this))),s.appendChild(u),s.appendChild(p);var H=[{text:i.getConstant("LightRedFillWithDarkRedText"),value:"redft",id:"redft"},{text:i.getConstant("YellowFillWithDarkYellowText"),id:"yellowft"},{text:i.getConstant("GreenFillWithDarkGreenText"),id:"greenft"},{text:i.getConstant("RedFill"),id:"redf"},{text:i.getConstant("RedText"),id:"redt"}],j=new mn({dataSource:H,index:0,popupHeight:"200px"});return j.appendTo(p),r},o.prototype.validateCfInput=function(t){var e=this.parent.serviceLocator.getService(Yt),i=t.target.value,r=e.dialogInstance.element.getElementsByClassName("e-clearall-btn")[0];i&&(t.target.classList.contains("e-between")||t.target.parentElement.querySelector(".e-between"))&&(i=t.target.parentElement.querySelector(t.target.classList.contains("e-between")?".e-input":".e-between").value),r.disabled=!i.trim()},o.prototype.checkCellHandler=function(t,e,i){for(var r=!1,n=i.range.trim().split(","),s=0;s<n.length;s++){var l=n[s];l=l.indexOf(":")>-1?l:l+":"+l;var h=(0,pe.dK5)(l);if(t>=h[0]&&t<=h[2]&&e>=h[1]&&e<=h[3]){r=!0;break}}return r},o.prototype.getDlgText=function(t){var e=this.parent.serviceLocator.getService(Ve),i="";switch(t){case e.getConstant("GreaterThan")+"...":i=e.getConstant("FormatCellsGreaterThan");break;case e.getConstant("LessThan")+"...":i=e.getConstant("FormatCellsLessThan");break;case e.getConstant("Between")+"...":i=e.getConstant("FormatCellsBetween");break;case e.getConstant("CFEqualTo")+"...":i=e.getConstant("FormatCellsEqualTo");break;case e.getConstant("TextThatContains")+"...":i=e.getConstant("FormatCellsThatContainTheText");break;case e.getConstant("ADateOccuring")+"...":i=e.getConstant("FormatCellsThatContainADateOccurring");break;case e.getConstant("DuplicateValues")+"...":i=e.getConstant("FormatCellsDuplicate");break;case e.getConstant("Top10Items")+"...":i=e.getConstant("FormatCellsTop");break;case e.getConstant("Top10")+" %...":i=e.getConstant("FormatCellsTop");break;case e.getConstant("Bottom10Items")+"...":i=e.getConstant("FormatCellsBottom");break;case e.getConstant("Bottom10")+" %...":i=e.getConstant("FormatCellsBottom");break;case e.getConstant("AboveAverage")+"...":i=e.getConstant("FormatCellsAbove");break;case e.getConstant("BelowAverage")+"...":i=e.getConstant("FormatCellsBelow");break}return i},o.prototype.cFInitialRender=function(t){var e=this.parent.getActiveSheet().conditionalFormats;if(e)for(var i=0;i<e.length;i++){var r=!1;r=this.checkCellHandler(t.rowIdx,t.colIdx,e[i]),r&&this.cFInitialCheckHandler({rowIdx:t.rowIdx,colIdx:t.colIdx,cell:t.cell,td:t.td,conditionalFormat:e[i]})}},o.prototype.triggetConditionalFormatEvent=function(t,e){e&&(t.conditionalFormat.value||t.conditionalFormat.type==="AboveAverage"||t.conditionalFormat.type==="BelowAverage"||t.conditionalFormat.type==="Duplicate")&&this.parent.trigger("beforeConditionalFormat",t)},o.prototype.cFInitialCheckHandler=function(t){var e,i=!1,r=["e-redft","e-yellowft","e-greenft","e-redf","e-redt"],n=t.cell.value||"",s=t.td||this.parent.getCell(t.rowIdx,t.colIdx);if(!!s){var l=t.conditionalFormat;if(l.type=l.type||"GreaterThan",l.cFColor=l.cFColor||l.format?l.cFColor:"RedFT",i=this.cFRCheck(l,n,s,t.rowIdx,t.colIdx,!0),this.triggetConditionalFormatEvent({conditionalFormat:l,cell:t.cell,element:s,address:(0,pe.qkm)(t.rowIdx,t.colIdx),apply:i},t.isAction),i){for(var h=0;h<r.length;h++)if(s.classList.contains(r[h])){s.classList.remove(r[h]);break}l.format&&l.format.style&&(e=l.format.style);var c={};l.cFColor?(s.classList.add("e-"+l.cFColor.toLowerCase()),c=this.setFormat(c,l)):c=e,c.backgroundColor&&s.style.setProperty("background-color",c.backgroundColor),c.color&&s.style.setProperty("color",c.color),c.fontWeight&&s.style.setProperty("font-weight",c.fontWeight),c.fontStyle&&s.style.setProperty("font-style",c.fontStyle),c.textDecoration&&s.style.setProperty("text-decoration",c.textDecoration)}}},o.prototype.checkConditionalFormatHandler=function(t){if(!(t.preventIfSheetNotRendered&&!(0,a.oq)(this.parent.getMainContent(),".e-sheet"))){var e,i=!1,r=!1,n=this.parent.getActiveSheet(),s=t.cell,l=t.td||this.parent.getCell(t.rowIdx,t.colIdx),h=n.conditionalFormats,c=s?(0,a.le)(s.value)?"":s.value:"",u=["e-redft","e-yellowft","e-greenft","e-redf","e-redt"];if(!(!h||h.length<1))for(var p=h.length-1;p>=0;p--){for(var f=h[p].range.trim().split(","),g=0;g<f.length;g++){var C=f[g];if(C=C.indexOf(":")>-1?C:C+":"+C,e=(0,pe.dK5)(C),t.rowIdx>=e[0]&&t.colIdx>=e[1]&&t.rowIdx<=e[2]&&t.colIdx<=e[3]){r=!0;break}}if(r){if("GreaterThanLessThanEqualToBetweenContainsTextDateOccur".includes(n.conditionalFormats[p].type)){var L=(0,He.$S)(t.rowIdx,t.colIdx,n)&&(0,He.$S)(t.rowIdx,t.colIdx,n).value?(0,He.$S)(t.rowIdx,t.colIdx,n).value:"";(0,a.le)(L)&&L===""?i=!1:i=this.cFRCheck(n.conditionalFormats[p],L,l),this.setColor(l,t.rowIdx,t.colIdx,p,i,t.isAction)}else if("Top10ItemsBottom10ItemsTop10%Bottom10%AboveAverageBelowAverageDuplicateUnique".includes(n.conditionalFormats[p].type))for(var g=0;g<f.length;g++){var C=f[g];C=C.indexOf(":")>-1?C:C+":"+C,e=(0,pe.dK5)(C);for(var D=e[0];D<=e[2];D++){n.rows[D]||(0,He.ZG)(n,D,{});for(var R=e[1];R<=e[3];R++){(!n.rows[D].cells||!n.rows[D].cells[R])&&(0,He.Jx)(D,R,n,{});var L=(0,He.$S)(D,R,n)&&(0,He.$S)(D,R,n).value?(0,He.$S)(D,R,n).value:"";i=this.cFRCheck(n.conditionalFormats[p],L,l,D,R,!1),l=this.parent.getCell(D,R),this.setColor(l,D,R,p,i,t.isAction)}}}else if("BlueDataBarGreenDataBarRedDataBarOrangeDataBarLightBlueDataBarPurpleDataBarGYRColorScaleRYGColorScaleGWRColorScaleRWGColorScaleBWRColorScaleRWBColorScaleWRColorScaleRWColorScaleGWColorScaleWGColorScaleGYColorScaleYGColorScaleThreeArrowsThreeArrowsGrayFourArrowsGrayFourArrowsFiveArrowsGrayFiveArrowsThreeTrafficLights1ThreeTrafficLights2ThreeSignsFourTrafficLightsFourRedToBlackThreeSymbolsThreeSymbols2ThreeFlagsFourRatingFiveQuartersFiveRatingThreeTrianglesThreeStarsFiveBoxes".includes(n.conditionalFormats[p].type)){for(var B=0;B<u.length;B++)l.classList.contains(u[B])&&l.classList.remove(u[B]);i=this.cFRCheck(n.conditionalFormats[p],c,l,t.rowIdx,t.colIdx,!1)}r=!1}if(i)break}}},o.prototype.setColor=function(t,e,i,r,n,s){var l=this.parent.getActiveSheet(),h=l.conditionalFormats;this.triggetConditionalFormatEvent({conditionalFormat:h[r],cell:(0,He.$S)(e,i,l),element:t,address:(0,pe.qkm)(e,i),apply:n},s);var c=["e-redft","e-yellowft","e-greenft","e-redf","e-redt"],u=!1;if(h[r].cFColor)t&&t.classList.contains("e-"+h[r].cFColor.toLowerCase())&&(u=!0);else if(h[r].format.style.backgroundColor&&t.style.backgroundColor){var p=this.hexToRgb(h[r].format.style.backgroundColor);"rgb("+p.r+", "+p.g+", "+p.b+")"===t.style.backgroundColor&&(u=!0)}if(n){if(u){for(var f=0;f<c.length;f++)if(t.classList.contains(c[f])){t.classList.remove(c[f]);break}}var g={};h[r].cFColor?(t&&t.classList.add("e-"+h[r].cFColor.toLowerCase()),g=this.setFormat(g,h[r])):g=h[r].format.style,this.parent.notify(pe.nJk,{style:g,rowIdx:e,colIdx:i,lastCell:!0,isHeightCheckNeeded:!0,manualUpdate:!0})}else{if(u){for(var f=0;f<c.length;f++)if(t.classList.contains(c[f])){t.classList.remove(c[f]);break}t.removeAttribute("style")}var C=(0,He.$S)(e,i,this.parent.getActiveSheet(),null,!0),g=(0,a.l7)({},this.parent.commonCellStyle,C.style);this.parent.notify(pe.nJk,{style:g,rowIdx:e,colIdx:i})}},o.prototype.hexToRgb=function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},o.prototype.cFRCheck=function(t,e,i,r,n,s){var l="",h="",c=e.toString();if(t.value){var u=t.value.split(",").filter(function(D){return!!D.trim()});if(u.length>1)if(u[0].split("(").length>1){for(var p="",f=0;f<u.length;f++)p+=u[f]+",",p.split("(").length===p.split(")").length&&l===""&&(l=p.substring(0,p.length-1),p="");h=p.substring(0,p.length-1)}else{l=u[0];for(var f=1;f<u.length;f++)h+=f+1===u.length?u[f]:u[f]+","}else l=u.length===1?u[0]:t.value}var g=!1,C=t.type;"BlueDataBarGreenDataBarRedDataBarOrangeDataBarLightBlueDataBarPurpleDataBar".includes(C)&&(C="DataBar"),"GYRColorScaleRYGColorScaleGWRColorScaleRWGColorScaleBWRColorScaleRWBColorScaleWRColorScaleRWColorScaleGWColorScaleWGColorScaleGYColorScaleYGColorScale".includes(C)&&(C="ColorScale"),"ThreeArrowsThreeArrowsGrayFourArrowsGrayFourArrowsFiveArrowsGrayFiveArrowsThreeTrafficLights1ThreeTrafficLights2ThreeSignsFourTrafficLightsFourRedToBlackThreeSymbolsThreeSymbols2ThreeFlagsFourRatingFiveQuartersFiveRatingThreeTrianglesThreeStarsFiveBoxes".includes(C)&&(C="IconSet");var L={};switch(C){case"GreaterThan":g=this.isGreaterThanLessThan(t,c,l,!0);break;case"LessThan":g=this.isGreaterThanLessThan(t,c,l,!1);break;case"Between":g=this.isBetWeen(t,c,l,h);break;case"EqualTo":g=this.isEqualTo(t,c,l);break;case"ContainsText":g=this.isContainsText(c,l);break;case"DateOccur":L={value:l,rowIndex:0,colIndex:0,sheetIndex:0,updatedVal:""},this.parent.notify(pe.w0y,L),c===L.updatedVal&&(g=!0);break;case"Unique":case"Duplicate":g=this.isDuplicateUnique(c,t);break;case"Top10Items":g=this.isTopBottomTenValue(c,l,t,!0);break;case"Bottom10Items":g=this.isTopBottomTenValue(c,l,t,!1);break;case"Top10Percentage":g=this.isTopBottomTenPercentage(c,l,t,!0);break;case"Bottom10Percentage":g=this.isTopBottomTenPercentage(c,l,t,!1);break;case"AboveAverage":g=this.isAboveBelowAverage(c,l,t,!0);break;case"BelowAverage":g=this.isAboveBelowAverage(c,l,t,!1);break;case"DataBar":this.isDataBarColorScalesIconSets(C,c,t,i,r,n,s);break;case"ColorScale":this.isDataBarColorScalesIconSets(C,c,t,i,r,n,s);break;case"IconSet":this.isDataBarColorScalesIconSets(C,c,t,i,r,n,s);break}return g},o.prototype.isDataBarColorScalesIconSets=function(t,e,i,r,n,s,l){var h=this.parent.getActiveSheet();if(l)t==="DataBar"?this.applyDataBars(e,i,r,n,s):t==="ColorScale"?this.applyColorScale(e,i,r,n,s):this.applyIconSet(e,i,r,n,s);else{r=null;for(var c=i.range.split(","),u=0;u<c.length;u++)for(var p=(0,pe.dK5)(c[u]),f=p[0];f<=p[2];f++)for(var g=p[1];g<=p[3];g++)if((0,He.$S)(f,g,h)){var C=(0,He.$S)(f,g,h).value;r=this.parent.getCell(f,g),t==="DataBar"?this.applyDataBars(C,i,r,f,g):t==="ColorScale"?this.applyColorScale(C,i,r,f,g):this.applyIconSet(C,i,r,f,g)}}},o.prototype.applyIconSet=function(t,e,i,r,n){var s=parseInt(t,10),l=this.getIconList(e.type).split(","),h=[],c=this.parent.getActiveSheet(),u=c.rows[r]&&c.rows[r].cells[n]?c.rows[r].cells[n]:null;if(!!u){for(var p=i||this.parent.getMainContent().getElementsByClassName("e-row")[r].getElementsByClassName("e-cell")[n],f=e.range.split(","),g=0;g<f.length;g++){var C=(0,pe.dK5)(f[g]);h=this.getNumericArray(C,h)}h=h.sort(function(ve,Ee){return ve-Ee});var L=h[0],D=h[h.length-1],R;if(l.length===3){var B=L+.67*(D-L),H=L+.33*(D-L);R="e-"+(s>=B?l[0].trim():s>=H?l[1].trim():l[2].trim())}else if(l.length===4){var j=L+.25*(D-L),W=L+.5*(D-L),ne=L+.75*(D-L);R="e-"+(s>=ne?l[0].trim():s>=W?l[1].trim():s>=j?l[2].trim():l[3].trim())}else if(l.length===5){var j=L+.2*(D-L),W=L+.4*(D-L),ne=L+.6*(D-L),ie=L+.8*(D-L);R="e-"+(s>=ie?l[0].trim():s>=ne?l[1].trim():s>=W?l[2].trim():s>=j?l[3].trim():l[4].trim())}if(!(0,a.le)(u)){var me=this.parent.createElement("span",{className:"e-icon"});me.classList.add("e-iconsetspan"),me.classList.add(R),this.applyIconSetIcon({rowIndex:r,colIndex:n},me,p)}}},o.prototype.applyIconSetIcon=function(t,e,i){var r=this.parent.getActiveSheet(),n=t.rowIndex,s=t.colIndex,l=(0,He.$S)(n,s,r).value,h=i;h.classList.contains("e-iconset")&&h.querySelector(".e-iconsetspan")&&h.removeChild(h.querySelector(".e-iconsetspan")),(0,pe.hj$)(l)&&(h.insertBefore(e,h.childNodes[0]),h.classList.add("e-iconset"))},o.prototype.getIconList=function(t){var e="3arrows-1,3arrows-2,3arrows-3";switch(t){case"ThreeArrows":return"3arrows-1,3arrows-2,3arrows-3";case"ThreeArrowsGray":return"3arrowsgray-1,3arrowsgray-2,3arrowsgray-3";case"FourArrowsGray":return"4arrowsgray-1,4arrowsgray-2,4arrowsgray-3,4arrowsgray-4";case"FourArrows":return"4arrows-1,4arrows-2,4arrows-3,4arrows-4";case"FiveArrowsGray":return"5arrowsgray-1,5arrowsgray-2,5arrowsgray-3,5arrowsgray-4,5arrowsgray-5";case"FiveArrows":return"5arrows-1,5arrows-2,5arrows-3,5arrows-4,5arrows-5";case"ThreeTrafficLights1":return"3trafficlights-1,3trafficlights-2,3trafficlights-3";case"ThreeTrafficLights2":return"3rafficlights2-1,3rafficlights2-2,3rafficlights2-3";case"ThreeSigns":return"3signs-1,3signs-2,3signs-3";case"FourTrafficLights":return"4trafficlights-1,4trafficlights-2,4trafficlights-3,4trafficlights-4";case"FourRedToBlack":return"4redtoblack-1,4redtoblack-2,4redtoblack-3,4redtoblack-4";case"ThreeSymbols":return"3symbols-1,3symbols-2,3symbols-3";case"ThreeSymbols2":return"3symbols2-1,3symbols2-2,3symbols2-3";case"ThreeFlags":return"3flags-1,3flags-2,3flags-3";case"FourRating":return"4rating-1,4rating-2,4rating-3,4rating-4";case"FiveQuarters":return"5quarters-1,5quarters-2,5quarters-3,5quarters-4,5quarters-5";case"FiveRating":return"5rating-1,5rating-2,5rating-3,5rating-4,5rating-5";case"ThreeTriangles":return"3triangles-1,3triangles-2,3triangles-3";case"ThreeStars":return"3stars-1,3stars-2,3stars-3";case"FiveBoxes":return"5boxes-1,5boxes-2,5boxes-3,5boxes-4,5boxes-5"}return e},o.prototype.applyColorScale=function(t,e,i,r,n){var s=this.parent.getActiveSheet(),l=parseInt(t,10),h,c=[],u=this.getColor(e.type),p=s.rows[r]&&s.rows[r].cells[n]?s.rows[r].cells[n]:null;if(!!p){for(var f=e.range.split(","),g=i||this.parent.getMainContent().getElementsByClassName("e-row")[r].getElementsByClassName("e-cell")[n],C=0;C<f.length;C++){var L=(0,pe.dK5)(f[C]);c=this.getNumericArray(L,c)}c=c.sort(function(H,j){return H-j}).reverse();for(var D=0;D<c.length;D++)if(c[D]===l){h=D;break}var R=h===0?u[0]:h===c.length-1?u[u.length-1]:c.length===3&&h===1?u[1]:this.getGradient(h,u[0],u[1],u[2],c.length);if(!(0,a.le)(p)){var B={};(0,a.le)(h)?(B=this.parent.getCellStyleValue(["backgroundColor"],[r,n]),g.style.backgroundColor=B.backgroundColor):(B={backgroundColor:R},g.style.backgroundColor=R)}}},o.prototype.applyDataBars=function(t,e,i,r,n){var s=this.parent.getActiveSheet(),l={},h={},c="",u="",p=e.type,f=s.rows[r].cells&&s.rows[r].cells[n]?s.rows[r].cells[n]:null;if(!!f){for(var g=[],C=this.parent.getMainContent().getElementsByClassName("e-row")[r],L=i||this.parent.getMainContent().getElementsByClassName("e-row")[r].getElementsByClassName("e-cell")[n],D=C&&C.style?parseInt(C.style.height,10):20,R=[],B=[],H,j=0,W=(0,a.le)(t)?null:parseInt(t,10),ne=e.range.split(","),ie=0;ie<ne.length;ie++){var me=(0,pe.dK5)(ne[ie]);g=this.getNumericArray(me,g)}for(var ve=0;ve<g.length;ve++)for(var Ee=0;Ee<g.length;Ee++)g[Ee]>0?R.push(g[Ee]):B.push(g[Ee]);if(p=p==="BlueDataBar"?"B":p==="GreenDataBar"?"G":p==="RedDataBar"?"R":p==="OrangeDataBar"?"O":p==="LightBlueDataBar"?"LB":p==="PurpleDataBar"?"P":"",c=this.getColor(p)[0],u=this.getColor("R")[0],R=R.sort(function(Me,De){return Me-De}).reverse(),B=B.sort(function(Me,De){return Me-De}),B.length&&R.length?(H=R[0]+Math.abs(B[0]),j=Math.abs(B[0]/H*100)):(B.length||R.length)&&(H=B.length?B[0]:R[0]),L&&((0,a.le)(W)||t==="")&&L.getElementsByClassName("e-cf-databar")[0]&&L.removeChild(L.getElementsByClassName("e-cf-databar")[0]),(0,pe.hj$)(W)){var le=this.parent.createElement("div",{id:"spreadsheet-databar",className:"e-cf-databar"}),de=this.parent.createElement("span",{id:"spreadsheet-leftspan",className:"e-databar"}),fe=this.parent.createElement("span",{id:"spreadsheet-rightspan",className:"e-databar"}),Le=this.parent.createElement("span",{id:"spreadsheet-dataspan",className:"e-databar-value"}),ke=void 0;l=de.style,h=fe.style,le.appendChild(Le),le.insertBefore(fe,Le),le.insertBefore(de,fe),L.querySelector(".e-iconsetspan")&&(ke=L.querySelector(".e-iconsetspan")),L.textContent="",L.appendChild(le),ke&&L.insertBefore(ke,L.firstElementChild),Le.innerHTML=this.parent.getDisplayText(f),le.style.height=D-1+"px",Le.style.fontSize="11pt",B.length?R.length?W>-1?(l.width=j+"%",l.height=D-3+"px",l.backgroundColor="transparent",l.left="0px",h.width=""+Math.ceil(Math.abs(W/H*100))+"%",h.height=D-3+"px",h.backgroundColor=p=c,h.left=j+"%"):W<0&&(l.width=""+Math.ceil(Math.abs(W/H*100))+"%",l.height=D-3+"px",l.backgroundColor=u,l.width===j+"%"?l.left="0px":l.right=100-j+"%"):(h.width=""+Math.ceil(Math.abs(W/H*100))+"%",h.height=D-3+"px",h.backgroundColor=p=u,h.left="0px"):(h.width=""+Math.ceil(Math.abs(W/H*100))+"%",h.height=D-3+"px",h.backgroundColor=p=c,h.left="0px")}}},o.prototype.getNumericArray=function(t,e){for(var i=this.parent.getActiveSheet(),r=t[0];r<=t[2];r++)for(var n=t[1];n<=t[3];n++){var s=(0,He.$S)(r,n,i)&&(0,He.$S)(r,n,i).value?(0,He.$S)(r,n,i).value:"";if(!(!(0,a.le)(s)&&!(0,pe.hj$)(s)&&!(0,pe.v9)(s))){var l=parseInt(s,10);!(0,a.le)(s)&&s!==""&&e.push(l)}}return e},o.prototype.getColor=function(t){if(t==="LB")return["#008aef"];for(var e=t.split(""),i=[],r=0;r<e.length;r++)switch(e[r]){case"G":i.push("#63be7b");break;case"Y":i.push("#ffeb84");break;case"R":i.push("#f8696b");break;case"W":i.push("#ffffff");break;case"B":i.push("#5a8ac6");break;case"O":i.push("#ffb628");break;case"LB":i.push("#008aef");break;case"P":i.push("#d6007b");break}return i},o.prototype.getGradient=function(t,e,i,r,n){if((0,a.le)(r))return this.getLinear(e,i,t/n);var s=n/2;return t>=s?this.getLinear(i,r,Math.abs((t-s)/s)):this.getLinear(e,i,t/s)},o.prototype.getLinear=function(t,e,i){var r=this.byteLinear(t[1]+t[2],e[1]+e[2],i),n=this.byteLinear(t[3]+t[4],e[3]+e[4],i),s=this.byteLinear(t[5]+t[6],e[5]+e[6],i);return"#"+r+n+s},o.prototype.byteLinear=function(t,e,i){var r=parseInt(t,16)*(1-i)+parseInt(e,16)*i|0;return Math.abs(r).toString(16)},o.prototype.isGreaterThanLessThan=function(t,e,i,r){var n=new RegExp(/[^.-a-zA-Z 0-9]+/g),s=!1;if((0,pe.hj$)(e))if((0,pe.hj$)(i))s=r?parseFloat(e)>parseFloat(i.replace(n,"")):parseFloat(e)<parseFloat(i.replace(n,""));else{var l={value:i,rowIndex:0,colIndex:0,sheetIndex:0,isDate:!1,updatedVal:"",isTime:!1};this.parent.notify(pe.w0y,l),l.isDate||l.isTime?(s=r?e>l.updatedVal:e<l.updatedVal,t.value=l.updatedVal.toString()):s=r?e.toLowerCase()>i.toLowerCase():e.toLowerCase()<i.toLowerCase()}else e===""&&Number(i)>0&&!r&&(s=!0);return s},o.prototype.isBetWeen=function(t,e,i,r){var n=new RegExp(/[^.-a-zA-Z 0-9]+/g),s=!1;if(i=i.replace(n,""),r=r.replace(n,""),(0,pe.hj$)(e)){if((0,pe.hj$)(i))s=parseFloat(e)>=parseFloat(i)&&parseFloat(e)<=parseFloat(r);else if(i&&r){var l={value:i,rowIndex:0,colIndex:0,sheetIndex:0,isDate:!1,updatedVal:"",isTime:!1},h={value:r,rowIndex:0,colIndex:0,sheetIndex:0,isDate:!1,updatedVal:"",isTime:!1};this.parent.notify(pe.w0y,l),this.parent.notify(pe.w0y,h),(l.isDate||l.isTime)&&(h.isDate||h.isTime)?(s=e>=l.updatedVal&&e<=h.updatedVal,t.value=l.updatedVal.toString()+","+h.updatedVal.toString()):s=e.toLowerCase()>=i.toLowerCase()&&e.toLowerCase()<=r.toLowerCase()}}return s},o.prototype.isEqualTo=function(t,e,i){var r=new RegExp(/[^.-a-zA-Z 0-9]+/g),n=!1;if((0,pe.hj$)(e))if((0,pe.hj$)(i))n=parseFloat(e)===parseFloat(i.replace(r,""));else{var s={value:i,rowIndex:0,colIndex:0,sheetIndex:0,isDate:!1,updatedVal:"",isTime:!1};this.parent.notify(pe.w0y,s),s.isTime||s.isDate?(n=e===s.updatedVal,t.value=s.updatedVal.toString()):n=e.toLowerCase()===i.toLowerCase()}return n},o.prototype.isContainsText=function(t,e){var i=new RegExp(/[^.-a-zA-Z 0-9]+/g),r=!1;return(0,a.le)(t)||!t.length?r=!1:(0,pe.hj$)(e.replace(i,""))?(e=e.replace(i,""),(0,pe.v9)(t)&&(t=(0,pe.twf)(t).toString()),r=t.indexOf(e)>-1):(0,pe.v9)(e)?((0,pe.v9)(t)&&(t=(0,pe.twf)(t).toString()),r=t.indexOf((0,pe.twf)(e).toString())>-1):r=t.toLowerCase().indexOf(e.toLowerCase())>-1,r},o.prototype.isTopBottomTenValue=function(t,e,i,r){var n=this.parent.getActiveSheet(),s=new RegExp(/[^.-a-zA-Z 0-9]+/g),l=parseInt(t,10),h=parseInt(e,10),c=!1;if((0,pe.hj$)(e)){(0,pe.hj$)(t)?(l=parseFloat(t),h=parseFloat(e.replace(s,""))):(0,pe.v9)(t)&&(l=(0,pe.twf)(t),h=parseFloat(e));for(var u=[],p=void 0,f=i.range.split(","),g=0;g<f.length;g++)for(var C=(0,pe.dK5)(f[g]),L=C[0];L<=C[2];L++)for(var D=C[1];D<=C[3];D++)p=(0,He.$S)(L,D,n)&&(0,He.$S)(L,D,n).value?(0,He.$S)(L,D,n).value:"",p&&(0,pe.hj$)(p)&&(p=parseFloat(p),u.push(p));u=r?u.sort(function(R,B){return R-B}).reverse():u.sort(function(R,B){return R-B}),u=u.slice(0,h),c=u.indexOf(l)>-1}return c},o.prototype.isTopBottomTenPercentage=function(t,e,i,r){var n=this.parent.getActiveSheet(),s=new RegExp(/[^.-a-zA-Z 0-9]+/g),l=parseInt(t,10),h=parseInt(e,10),c=!1;if((0,pe.hj$)(e)){(0,pe.hj$)(t)?(l=parseFloat(t),h=parseFloat(e.replace(s,""))):(0,pe.v9)(t)&&(l=(0,pe.twf)(t),h=parseFloat(e));for(var u=[],p=void 0,f=0,g=void 0,C=i.range.split(","),L=0;L<C.length;L++)for(var D=(0,pe.dK5)(C[L]),R=D[0];R<=D[2];R++)for(var B=D[1];B<=D[3];B++)p=(0,He.$S)(R,B,n)&&(0,He.$S)(R,B,n).value?(0,He.$S)(R,B,n).value:"",p&&(0,pe.hj$)(p)&&(p=parseFloat(p),u.push(p)),f++;var H=100/f;g=h/H,g=Math.ceil(g),u=r?u.sort(function(j,W){return j-W}).reverse():u.sort(function(j,W){return j-W}),u=u.slice(0,g||1),c=u.indexOf(l)>-1}return c},o.prototype.isAboveBelowAverage=function(t,e,i,r){for(var n=this.parent.getActiveSheet(),s=parseFloat(t),l=i.range.split(","),h=!1,c=[],u,p=0,f=0;f<l.length;f++)for(var g=(0,pe.dK5)(l[f]),C=g[0];C<=g[2];C++)for(var L=g[1];L<=g[3];L++)u=(0,He.$S)(C,L,n)&&(0,He.$S)(C,L,n).value?(0,He.$S)(C,L,n).value:"",u&&(0,pe.hj$)(u)&&(u=parseFloat(u),c.push(u));for(var D=0;D<c.length;D++)p+=c[D];return p=p/c.length,h=r?s>p:s<p,h},o.prototype.isDuplicateUnique=function(t,e){var i=e.type,r=0,n=this.parent.getActiveSheet(),s=t,l=e.range.split(","),h;if((0,a.le)(s)||s==="")return!1;for(var c=0;c<l.length;c++)for(var u=(0,pe.dK5)(l[c]),p=u[0];p<=u[2];p++)for(var f=u[1];f<=u[3];f++)if(h=(0,He.$S)(p,f,n)&&(0,He.$S)(p,f,n).value?(0,He.$S)(p,f,n).value.toString():"",h&&h!==""&&(r=s.toLowerCase()===h.toLowerCase()?r+1:r,r===2))return i==="Duplicate";return i!=="Duplicate"},o.prototype.setFormat=function(t,e){switch(e.cFColor){case"RedFT":t.backgroundColor="#ffc7ce",t.color="#9c0055";break;case"YellowFT":t.backgroundColor="#ffeb9c",t.color="#9c6500";break;case"GreenFT":t.backgroundColor="#c6efce",t.color="#006100";break;case"RedF":t.backgroundColor="#ffc7ce";break;case"RedT":t.color="#9c0055";break}return t},o.prototype.getModuleName=function(){return"conditionalFormatting"},o}(),np=function(){function o(t){this.fillOptionIndex=0,this.parent=t,this.addEventListener()}return o.prototype.getfillItems=function(){var t=this.parent.serviceLocator.getService(Ve);return[{text:t.getConstant("CopyCells")},{text:t.getConstant("FillSeries")},{text:t.getConstant("FillFormattingOnly")},{text:t.getConstant("FillWithoutFormatting")}]},o.prototype.init=function(){this.createAutoFillElement()},o.prototype.createAutoFillElement=function(){var t=this.parent.getMainContent(),e=this.parent.createElement("div",{className:"e-autofill"});t.appendChild(e),this.autoFillElement=e,this.getautofillDDB({id:this.parent.element.id+"_autofilloptionbtn",appendElem:t})},o.prototype.getautofillDDB=function(t){var e=this,i=this.parent.createElement("button",{id:t.id,className:"e-filloption"});return i.appendChild(this.parent.createElement("span",{className:"e-tbar-btn-text"})),this.autoFillDropDown=new Bi({cssClass:"e-dragfill-ddb",iconCss:"e-icons e-dragfill-icon",items:this.getfillItems(),createPopupOnClick:!0,select:function(r){e.autoFillOptionClick({type:e.getFillType(r.item.text)})},beforeOpen:function(){return e.autoFillClick()}}),this.autoFillDropDown.createElement=this.parent.createElement,this.autoFillDropDown.appendTo(i),t.appendElem.appendChild(i),this.autoFillDropDown},o.prototype.getFillType=function(t){var e=this.parent.serviceLocator.getService(Ve),i;return t===e.getConstant("CopyCells")?i="CopyCells":t===e.getConstant("FillSeries")?i="FillSeries":t===e.getConstant("FillFormattingOnly")?i="FillFormattingOnly":i="FillWithoutFormatting",i},o.prototype.autoFillClick=function(){var t=this.parent.serviceLocator.getService(Ve),e={fillType:"FillSeries",disableItems:[""]};this.parent.notify(w.$uf,e),this.autoFillDropDown.setProperties({items:this.getfillItems()},!0),this.autoFillDropDown.removeItems(e.disableItems),this.refreshAutoFillOption(t.getConstant(e.fillType))},o.prototype.getFillRange=function(t,e,i,r){switch(r){case"Up":return[i.rowIndex,t.colIndex,t.rowIndex-1,e.colIndex];case"Right":return[t.rowIndex,e.colIndex+1,e.rowIndex,i.colIndex];case"Down":return[e.rowIndex+1,t.colIndex,i.rowIndex,e.colIndex];case"Left":return[t.rowIndex,i.colIndex,e.rowIndex,t.colIndex-1]}},o.prototype.autoFillOptionClick=function(t){var e=this.parent.serviceLocator.getService(Ve),i=this.parent.getActiveSheet(),r=(0,w.gaE)((0,w.dK5)(this.parent.selectionModule.dAutoFillCell)),n=(0,w.dK5)(i.selectedRange),s=r[0],l=r[1],h=r[2],c=r[3],u=this.getDirection({rowIndex:h,colIndex:c},{rowIndex:n[2],colIndex:n[3]}),p=[s,l,h,c],f=this.getFillRange({rowIndex:s,colIndex:l},{rowIndex:h,colIndex:c},{rowIndex:n[2],colIndex:n[3]},u);this.refreshAutoFillOption(e.getConstant(t.type)),this.parent.notify(E.Y5,{isUndo:!0,isPublic:!0,preventEvt:t.type==="FillWithoutFormatting",preventReSelect:!0});var g={dataRange:i.name+"!"+(0,w.i0K)(p),fillRange:i.name+"!"+(0,w.i0K)(f),direction:u,fillType:t.type,isFillOptClick:!0};this.isVerticalFill=g.direction==="Down"||g.direction==="Up",this.parent.notify(w.O$v,g),this.positionAutoFillElement({isautofill:!0});var C={dataRange:g.dataRange,fillRange:g.fillRange,fillType:g.fillType,direction:g.direction,selectedRange:i.name+"!"+(0,w.i0K)(n)};this.parent.notify(E.Av,{eventArgs:C,action:"autofill"}),this.parent.notify(E.I4,{}),this.autoFillClick()},o.prototype.refreshAutoFillOption=function(t){for(var e=0;e<this.autoFillDropDown.items.length;e++)this.autoFillDropDown.items[e].iconCss="";for(var e=0;e<this.autoFillDropDown.items.length;e++)this.autoFillDropDown.items[e].text===t&&(this.autoFillDropDown.items[e].iconCss="e-icons e-selected-icon");["Copy Cells","Fill Series","Fill Formatting Only","Fill Without Formatting"].indexOf(t)<0&&(this.autoFillDropDown.items[this.fillOptionIndex].iconCss=""),this.autoFillDropDown.dataBind()},o.prototype.positionAutoFillElement=function(t){var e=0,i=0,r=this.parent.getActiveSheet(),n=(0,w.gaE)((0,w.dK5)(r.selectedRange)),s=-5,l=-5,h=6,c=6,u=n[1]===0&&n[3]===r.colCount-1,p=n[0]===0&&n[2]===r.rowCount-1,f=n[2],g=n[3],C,L,D,R=this.parent.getCell(f,g);if((0,w.NqJ)(r,n[3])||(0,w.gSQ)(r,n[2])||R&&R.classList.contains("e-formularef-selection")||r.isProtected&&r.protectSettings.selectUnLockedCells&&ct(this.parent,n)){this.hideAutoFillElement();return}if(r.isProtected&&(r.protectSettings.selectCells||r.protectSettings.selectUnLockedCells)||!r.isProtected){if(u?(s=-5,l=-1,h=6,c=2,f=n[2],g=n[1]):p&&(l=-5,s=0,h=1,c=6,f=n[0],g=n[3]),r.frozenColumns||r.frozenRows){if(p||u?(M(this.parent,this.autoFillElement,n,"e-autofill",t&&t.preventAnimation),this.parent.autoFillSettings.showFillOptions&&t&&t.isautofill&&M(this.parent,this.autoFillDropDown.element,n,"e-filloption")):(M(this.parent,this.autoFillElement,[f,g,f,g],"e-autofill",t&&t.preventAnimation),this.parent.autoFillSettings.showFillOptions&&t&&t.isautofill&&M(this.parent,this.autoFillDropDown.element,[f,g,f,g],"e-filloption")),this.autoFillElement){this.autoFillCell={rowIndex:f,colIndex:g};var B=this.parent.element.querySelectorAll(".e-autofill")[0];if(B){var H=B.getBoundingClientRect();this.autoFillElementPosition={left:H.left,top:H.top}}}}else if(D=d(r,[f,g,f,g],this.parent.frozenRowCount(r),this.parent.frozenColCount(r),this.parent.viewport.beforeFreezeHeight,this.parent.viewport.beforeFreezeWidth,this.parent.sheetModule.colGroupWidth),C=(0,w.EB_)(r,f,f,!0),L=(0,w.pGm)(r,g,g,!0),p||(e+=C),u||(i+=L),e+=Math.round(D.top)+s,i+=Math.round(D.left)+l,this.autoFillElement){(0,a.IV)([this.autoFillElement],"e-hide"),this.autoFillElement.style.top=e+"px",this.autoFillElement.style.left=i+"px",this.autoFillCell={rowIndex:f,colIndex:g};var H=this.autoFillElement.getBoundingClientRect();this.autoFillElementPosition={left:H.left,top:H.top},this.parent.autoFillSettings.showFillOptions&&t&&t.isautofill&&((0,a.IV)([this.autoFillDropDown.element],"e-hide"),this.autoFillDropDown.element.style.top=e+h+"px",this.autoFillDropDown.element.style.left=i+c+"px")}}},o.prototype.hideAutoFillElement=function(){var t=this.parent.element;t.querySelectorAll(".e-autofill").forEach(function(e){t&&(0,a.cn)([e],"e-hide")})},o.prototype.hideAutoFillOptions=function(){var t=this.parent.element;t.querySelectorAll(".e-filloption").forEach(function(e){t&&(0,a.cn)([e],"e-hide")})},o.prototype.selectAutoFillRange=function(t){var e={clientY:_(t.e),target:t.e.target},i={clientX:V(t.e),target:t.e.target},r=this.parent.getActiveSheet();this.parent.notify(E.M7,e),this.parent.notify(E.oU,i);var n,s=this.getAutoFillRange({rowIndex:e.clientY,colIndex:i.clientX});return s&&s.fillRange?n=[s.startCell.rowIndex,s.startCell.colIndex,s.endCell.rowIndex,s.endCell.colIndex]:n=(0,w.dK5)(r.selectedRange),t.indexes=n,n},o.prototype.getAutoFillRange=function(t){var e=this.parent.getActiveSheet(),i=this.autoFillCell,r=(0,w.gaE)((0,w.dK5)(e.selectedRange)),n=r[0],s=r[1],l=r[2],h=r[3],c=(0,w.mhJ)(r,[t.rowIndex,t.colIndex,t.rowIndex,t.colIndex],!0),u={rowIndex:n,colIndex:s},p={rowIndex:r[0],colIndex:r[1]},f={rowIndex:r[2],colIndex:r[3]},g={rowIndex:l,colIndex:h},C=this.modifyRangeForMerge(t.rowIndex,t.colIndex,i.rowIndex,i.colIndex,r);return t.rowIndex<i.rowIndex?n-t.rowIndex>t.colIndex-h&&n-t.rowIndex>s-t.colIndex?c?{startCell:u,endCell:{rowIndex:t.rowIndex,colIndex:h}}:{startCell:g,endCell:{rowIndex:C.rowIndex,colIndex:s},fillRange:[C.rowIndex,s,n-1,h],direction:"Up"}:t.colIndex>i.colIndex?{startCell:u,endCell:{rowIndex:l,colIndex:t.colIndex},fillRange:[n,h+1,l,t.colIndex],direction:"Right"}:t.colIndex<i.colIndex?c?{startCell:u,endCell:g}:{startCell:g,endCell:{rowIndex:n,colIndex:t.colIndex},fillRange:[n,t.colIndex,l,s-1],direction:"Left"}:{startCell:p,endCell:f}:t.colIndex>i.colIndex?t.rowIndex-l>t.colIndex-h?{startCell:u,endCell:{rowIndex:t.rowIndex,colIndex:h},fillRange:[l+1,s,t.rowIndex,h],direction:"Down"}:{startCell:u,endCell:{rowIndex:l,colIndex:C.colIndex},fillRange:[n,h+1,l,C.colIndex],direction:"Right"}:t.colIndex<i.colIndex?t.rowIndex-l>h-t.colIndex||t.rowIndex-n>h-t.colIndex&&t.rowIndex!==l?{startCell:u,endCell:{rowIndex:t.rowIndex,colIndex:h},fillRange:[l+1,s,t.rowIndex,h],direction:"Down"}:c?{startCell:u,endCell:g}:{startCell:g,endCell:{rowIndex:n,colIndex:C.colIndex},fillRange:[n,C.colIndex,l,s-1],direction:"Left"}:t.rowIndex>i.rowIndex?{startCell:u,endCell:{rowIndex:C.rowIndex,colIndex:h},fillRange:[l+1,s,C.rowIndex,h],direction:"Down"}:t.rowIndex===i.rowIndex&&t.colIndex===i.colIndex?{startCell:p,endCell:f}:{startCell:p,endCell:f}},o.prototype.modifyRangeForMerge=function(t,e,i,r,n){var s={rowIndex:t,colIndex:e};if(this.isMergedRange(n)){var l=n[2]-n[0]+1,h=n[3]-n[1]+1,c=void 0;t<i?(c=(n[2]-t+1)%l,c&&t-(l-c)>=0&&(s.rowIndex=t-(l-c))):e>r?(c=(e-n[1]+1)%h,c&&(s.colIndex=e+(h-c))):e<r?(c=(n[3]-e+1)%h,c&&e-(h-c)>=0&&(s.colIndex=e-(h-c))):t>i&&(c=(t-n[0]+1)%l,c&&(s.rowIndex=t+(l-c)))}return s},o.prototype.performAutoFill=function(t){if(!(t.event.clientX>this.autoFillElementPosition.left&&t.event.clientX<this.autoFillElementPosition.left+10)||!(t.event.clientY>this.autoFillElementPosition.top&&t.event.clientY<this.autoFillElementPosition.top+10)){var e={clientY:_(t.event),target:t.event.target},i={clientX:V(t.event),target:t.event.target},r=this.parent.getActiveSheet();this.parent.notify(E.M7,e),this.parent.notify(E.oU,i);var n=this.getAutoFillRange({rowIndex:e.clientY,colIndex:i.clientX});if(n&&n.fillRange){var s={dataRange:r.name+"!"+t.dAutoFillCell,fillRange:r.name+"!"+(0,w.i0K)(n.fillRange),direction:n.direction,fillType:this.parent.autoFillSettings.fillType,cancel:!1};if(this.parent.notify(w.ya2,{eventArgs:s,action:"autofill"}),s.cancel)return;var l=ct(this.parent,n.fillRange);if(r.isProtected&&l){this.parent.notify(E.Gn,null);return}this.performAutoFillAction(s,n,l),this.isMergedRange((0,w.dK5)(s.dataRange))&&this.parent.renderModule.refreshSheet(),this.positionAutoFillElement({isautofill:!this.isMergedRange((0,w.dK5)(s.fillRange))})}}else this.positionAutoFillElement({isautofill:!1})},o.prototype.refreshCell=function(t){this.parent.serviceLocator.getService("cell").refreshRange([t.rowIndex,t.colIndex,t.rowIndex,t.colIndex])},o.prototype.isRange=function(t){return t&&(t[0]!==t[2]||t[1]!==t[3])},o.prototype.fillRange=function(t){var e={dataRange:"",fillRange:"",direction:"Down",fillType:"CopyCells"},i=this.parent.getActiveSheet(),r=(0,w.gaE)((0,w.dK5)(i.selectedRange)),n=r[0],s=r[1],l=r[2],h=r[3],c=this.getDirection({rowIndex:n,colIndex:s},{rowIndex:l,colIndex:h},t.verticalFill),u=t.verticalFill?c==="Down":c==="Right";if(this.isRange(r)&&u)t.verticalFill?(e.dataRange=i.name+"!"+(0,w.i0K)([n,s,n,h]),e.fillRange=i.name+"!"+(0,w.i0K)([n+1,s,l,h])):(e.dataRange=i.name+"!"+(0,w.i0K)([n,s,l,s]),e.fillRange=i.name+"!"+(0,w.i0K)([n,s+1,l,h]));else{if(t.verticalFill){if(!n)return;e.dataRange=i.name+"!"+(0,w.i0K)([n-1,s,n-1,h])}else{if(!s)return;e.dataRange=i.name+"!"+(0,w.i0K)([n,s-1,l,s-1])}e.fillRange=i.name+"!"+(0,w.i0K)(r)}e.direction=t.verticalFill?"Down":"Right",e.fillType="CopyCells",!i.isProtected&&this.performAutoFillAction(e)},o.prototype.getDirection=function(t,e,i){if(i=(0,a.le)(i)?this.isVerticalFill:i,i){if(e.rowIndex<t.rowIndex)return"Up";if(e.rowIndex>t.rowIndex)return"Down";if(e.colIndex>t.colIndex)return"Right";if(e.colIndex<t.colIndex)return"Left"}else{if(e.colIndex>t.colIndex)return"Right";if(e.colIndex<t.colIndex)return"Left";if(e.rowIndex<t.rowIndex)return"Up";if(e.rowIndex>t.rowIndex)return"Down"}return null},o.prototype.performAutoFillAction=function(t,e,i){var r=this,n=this.parent.getActiveSheet(),s=this.parent.serviceLocator.getService(Ve);if(this.isMergedRange((0,w.dK5)(t.fillRange))){var l=this.parent.serviceLocator.getService(Yt);l.show({target:this.parent.element,isModal:!0,showCloseIcon:!0,height:180,width:400,content:s.getConstant("AutoFillMergeAlertMsg"),buttons:[{buttonModel:{content:this.parent.serviceLocator.getService(Ve).getConstant("Ok"),isPrimary:!0},click:function(){l.hide(),r.parent.selectRange(t.dataRange)}}],close:function(){l.hide(),r.parent.selectRange(t.dataRange)}},!1);return}this.isVerticalFill=t.direction==="Down"||t.direction==="Up",this.parent.notify(w.O$v,{dataRange:t.dataRange,fillRange:t.fillRange,direction:t.direction,fillType:t.fillType,isLockedCell:i});var h=e?(0,w.i0K)([e.startCell.rowIndex,e.startCell.colIndex,e.endCell.rowIndex,e.endCell.colIndex]):n.selectedRange;(0,w.TmR)(this.parent,h,n);var c={dataRange:t.dataRange,fillRange:t.fillRange,fillType:t.fillType,direction:t.direction,selectedRange:h};this.parent.notify(E.Av,{eventArgs:c,action:"autofill"}),this.parent.notify(E.I4,{})},o.prototype.getRangeData=function(t){for(var e=[],i=this.parent.getActiveSheet(),r=t.range[0],n=t.range[1],s=t.range[2],l=t.range[3],h=n,c;r<=s;){if((0,w.gSQ)(i,r)){r++;continue}for(n=h;n<=l;){if((0,w.NqJ)(i,n)){n++;continue}c=(0,w.$Su)(r,n,i),e.push(c),n++}r++}return e},o.prototype.isMergedRange=function(t){var e=0,i=this.getRangeData({range:t,sheetIdx:this.parent.activeSheetIndex});for(e=0;e<i.length;e++)if(i[e]&&(i[e].rowSpan||i[e].colSpan))return!0;return!1},o.prototype.addEventListener=function(){this.parent.on(E.eT,this.init,this),this.parent.on(E.uv,this.positionAutoFillElement,this),this.parent.on(E.LC,this.hideAutoFillOptions,this),this.parent.on(E.Qu,this.hideAutoFillElement,this),this.parent.on(E.dt,this.performAutoFill,this),this.parent.on(E.mw,this.fillRange,this),this.parent.on(E.cQ,this.selectAutoFillRange,this),this.parent.on(w.VYm,this.refreshCell,this),this.parent.on(w.AH7,this.getautofillDDB,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.eT,this.init),this.parent.off(E.uv,this.positionAutoFillElement),this.parent.off(E.LC,this.hideAutoFillOptions),this.parent.off(E.Qu,this.hideAutoFillElement),this.parent.off(E.dt,this.performAutoFill),this.parent.off(E.mw,this.fillRange),this.parent.off(E.cQ,this.selectAutoFillRange),this.parent.off(w.VYm,this.refreshCell),this.parent.off(w.AH7,this.getautofillDDB))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"autofill"},o}();function ra(o,t,e,i,r,n){var s,l,h=t.parentElement;if(i==="vscroll"?(s=n||t.getBoundingClientRect().height,l=e.getBoundingClientRect().height):(s=t.getBoundingClientRect().width,l=e.getBoundingClientRect().width),s<l)return gv(o,t,e,i,r,n);if(h){var c=h.getBoundingClientRect().width;return c<s&&i==="hscroll"?(l=c,t.style.maxWidth=c+"px",gv(o,t,e,i,r,n)):e}else return e}function gv(o,t,e,i,r,n){var s=o("div",{className:"e-menu-"+i});t.appendChild(s),s.appendChild(e),n?(s.style.overflow="hidden",s.style.height=n+"px"):(s.style.maxHeight=t.style.maxHeight,t.style.overflow="hidden");var l;return i==="vscroll"?(l=new Ro({enableRtl:r},s),l.scrollStep=(0,a.Ys)(".e-"+i+"-bar",t).offsetHeight/2):(l=new iu({enableRtl:r},s),l.scrollStep=(0,a.Ys)(".e-"+i+"-bar",t).offsetWidth),s}function wh(o,t,e){if(o){var i=(0,a.Ys)(".e-menu-parent",t);i?(!e||e===i)&&(o.destroy(),t.parentElement.appendChild(i),(0,a.og)(t)):(o.destroy(),(0,a.og)(t))}}var xh=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ii=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Eh="enter",sp="escape",Hi="e-focused",Ah="e-menu-header",Li="e-selected",Th="e-separator",Zo="uparrow",Kn="downarrow",na="leftarrow",Xn="rightarrow",Yo="home",Lh="end",ap="tab",yv="e-caret",Wa="e-menu-item",op="e-disabled",Ua="e-menu-hide",bv="e-icons",Cv="e-rtl",Go="e-menu-popup",Qb="Template",Sv=function(o){xh(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ii([(0,a.Z9)("id")],t.prototype,"itemId",void 0),ii([(0,a.Z9)("parentId")],t.prototype,"parentId",void 0),ii([(0,a.Z9)("text")],t.prototype,"text",void 0),ii([(0,a.Z9)("iconCss")],t.prototype,"iconCss",void 0),ii([(0,a.Z9)("url")],t.prototype,"url",void 0),ii([(0,a.Z9)("separator")],t.prototype,"separator",void 0),ii([(0,a.Z9)("items")],t.prototype,"children",void 0),t}(a.rt),Ko=function(o){xh(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ii([(0,a.Z9)(null)],t.prototype,"iconCss",void 0),ii([(0,a.Z9)("")],t.prototype,"id",void 0),ii([(0,a.Z9)(!1)],t.prototype,"separator",void 0),ii([(0,a.FE)([],t)],t.prototype,"items",void 0),ii([(0,a.Z9)("")],t.prototype,"text",void 0),ii([(0,a.Z9)("")],t.prototype,"url",void 0),t}(a.rt),Jb=function(o){xh(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ii([(0,a.Z9)("SlideDown")],t.prototype,"effect",void 0),ii([(0,a.Z9)(400)],t.prototype,"duration",void 0),ii([(0,a.Z9)("ease")],t.prototype,"easing",void 0),t}(a.rt),wv=function(o){xh(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.navIdx=[],r.animation=new a.fw({}),r.isTapHold=!1,r.tempItem=[],r.showSubMenuOn="Auto",r}return t.prototype.preRender=function(){if(!this.isMenu){var e=void 0;if(this.element.tagName==="EJS-CONTEXTMENU"){e=this.createElement("ul",{id:(0,a.QI)(this.getModuleName()),className:"e-control e-lib e-"+this.getModuleName()});var i=(0,a.NA)("ej2_instances",this.element);(0,a.IV)([this.element],["e-control","e-lib","e-"+this.getModuleName()]),this.clonedElement=this.element,this.element=e,(0,a.sO)("ej2_instances",i,this.element)}else{e=this.createElement("ul",{id:(0,a.QI)(this.getModuleName())}),(0,a.R3)([].slice.call(this.element.cloneNode(!0).children),e);var r=this.element.nextElementSibling;r?this.element.parentElement.insertBefore(e,r):this.element.parentElement.appendChild(e),this.clonedElement=e}this.clonedElement.style.display="none"}if(this.element.tagName==="EJS-MENU"){for(var n=this.element,s=(0,a.NA)("ej2_instances",n),e=this.createElement("ul"),l=this.createElement("EJS-MENU",{className:"e-"+this.getModuleName()+"-wrapper"}),h=0,c=n.attributes.length;h<c;h++)e.setAttribute(n.attributes[h].nodeName,n.attributes[h].nodeValue);n.parentNode.insertBefore(l,n),(0,a.og)(n),n=e,l.appendChild(n),(0,a.sO)("ej2_instances",s,n),this.clonedElement=l,this.element=n,this.element.id||(this.element.id=(0,a.QI)(this.getModuleName()))}},t.prototype.render=function(){var e=this;this.initialize(),this.renderItems(),this.wireEvents(),this.renderComplete();var i=this.getWrapper();this.template&&this.enableScrolling&&(this.isReact||this.isAngular)&&requestAnimationFrame(function(){ra(e.createElement,i,e.element,"hscroll",e.enableRtl)})},t.prototype.initialize=function(){var e=this.getWrapper();e||(e=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.isMenu?this.element.parentElement.insertBefore(e,this.element):document.body.appendChild(e)),this.cssClass&&(0,a.cn)([e],this.cssClass.split(" ")),this.enableRtl&&e.classList.add(Cv),e.appendChild(this.element),this.isMenu&&this.hamburgerMode&&(this.target||this.createHeaderContainer(e)),this.defaultOption=this.showItemOnClick},t.prototype.renderItems=function(){if(!this.items.length){var e=Mt.createJsonFromElement(this.element,{fields:{child:"items"}});this.setProperties({items:e},!0),(0,a.xr)()&&!this.isMenu?this.element=this.removeChildElement(this.element):this.element.innerHTML=""}var i=this.createItems(this.items);if((0,a.R3)(Array.prototype.slice.call(i.children),this.element),this.element.classList.add("e-menu-parent"),this.isMenu&&(!this.hamburgerMode&&this.element.classList.contains("e-vertical")&&this.setBlankIconStyle(this.element),this.enableScrolling)){var r=this.getWrapper();this.element.classList.contains("e-vertical")?ra(this.createElement,r,this.element,"vscroll",this.enableRtl):ra(this.createElement,r,this.element,"hscroll",this.enableRtl)}},t.prototype.wireEvents=function(){var e=this.getWrapper();if(this.target){for(var i=void 0,r=(0,a.td)(this.target),n=0,s=r.length;n<s;n++)i=r[n],this.isMenu?a.bi.add(i,"click",this.menuHeaderClickHandler,this):a.AR.isIos?new a.Xh(i,{tapHold:this.touchHandler.bind(this)}):a.bi.add(i,"contextmenu",this.cmenuHandler,this);if(this.targetElement=i,!this.isMenu){a.bi.add(this.targetElement,"scroll",this.scrollHandler,this);for(var l=0,h=Ks(this.targetElement);l<h.length;l++){var c=h[l];a.bi.add(c,"scroll",this.scrollHandler,this)}}}a.AR.isDevice||(this.delegateMoverHandler=this.moverHandler.bind(this),this.delegateMouseDownHandler=this.mouseDownHandler.bind(this),a.bi.add(this.isMenu?document:e,"mouseover",this.delegateMoverHandler,this),a.bi.add(document,"mousedown",this.delegateMouseDownHandler,this)),this.delegateClickHandler=this.clickHandler.bind(this),a.bi.add(document,"click",this.delegateClickHandler,this),this.wireKeyboardEvent(e),this.rippleFn=(0,a.qx)(e,{selector:"."+Wa})},t.prototype.wireKeyboardEvent=function(e){var i={downarrow:Kn,uparrow:Zo,enter:Eh,leftarrow:na,rightarrow:Xn,escape:sp};this.isMenu&&(i.home=Yo,i.end=Lh,i.tab=ap),new a.nv(e,{keyAction:this.keyBoardHandler.bind(this),keyConfigs:i})},t.prototype.mouseDownHandler=function(e){(0,a.oq)(e.target,".e-"+this.getModuleName()+"-wrapper")!==this.getWrapper()&&!(0,a.oq)(e.target,".e-"+this.getModuleName()+"-popup")&&this.closeMenu(this.isMenu?null:this.navIdx.length,e)},t.prototype.keyBoardHandler=function(e){var i="",r=e.target,n=this.isMenu&&!this.hamburgerMode&&!this.element.classList.contains("e-vertical")&&this.navIdx.length<1;if(e.preventDefault(),this.enableScrolling&&e.keyCode===13&&r.classList.contains("e-scroll-nav")&&this.removeLIStateByClass([Hi,Li],[(0,a.oq)(r,".e-"+this.getModuleName()+"-wrapper")]),n)switch(e.action){case Xn:i=Xn,e.action=Kn;break;case na:i=na,e.action=Zo;break;case Kn:i=Kn,e.action=Xn;break;case Zo:i=Zo,e.action="";break}else if(this.enableRtl)switch(e.action){case na:n=!0,i=na,e.action=Xn;break;case Xn:n=!0,i=Xn,e.action=na;break}switch(e.action){case Kn:case Zo:case Lh:case Yo:case ap:this.upDownKeyHandler(e);break;case Xn:this.rightEnterKeyHandler(e);break;case na:this.leftEscKeyHandler(e);break;case Eh:this.hamburgerMode&&r.tagName==="SPAN"&&r.classList.contains("e-menu-icon")?this.menuHeaderClickHandler(e):this.rightEnterKeyHandler(e);break;case sp:this.leftEscKeyHandler(e);break}n&&(e.action=i)},t.prototype.upDownKeyHandler=function(e){var i=this.getUlByNavIdx(),r=e.action===Kn||e.action===Yo||e.action===ap?0:i.childElementCount-1,n=r,s=this.getLIByClass(i,Hi);s&&(e.action!==Lh&&e.action!==Yo&&(n=this.getIdx(i,s)),s.classList.remove(Hi),e.action!==Lh&&e.action!==Yo&&(e.action===Kn?n++:n--,n===(e.action===Kn?i.childElementCount:-1)&&(n=r)));var l=i.children[n];n=this.isValidLI(l,n,e.action),i.children[n].classList.add(Hi),i.children[n].focus()},t.prototype.isValidLI=function(e,i,r){var n=this.getUlByNavIdx();return(e.classList.contains(Th)||e.classList.contains(op)||e.classList.contains(Ua))&&(r===Kn||r===Xn?i++:i--),e=n.children[i],(e.classList.contains(Th)||e.classList.contains(op)||e.classList.contains(Ua))&&(i=this.isValidLI(e,i,r)),i},t.prototype.getUlByNavIdx=function(e){if(e===void 0&&(e=this.navIdx.length),this.isMenu){var i=[this.getWrapper()].concat([].slice.call((0,a.td)("."+Go)))[e];return(0,a.le)(i)?null:(0,a.Ys)(".e-menu-parent",i)}else return this.getWrapper().children[e]},t.prototype.rightEnterKeyHandler=function(e){var i,r=this.getUlByNavIdx(),n=this.getLIByClass(r,Hi);if(n){var s=this.getIdx(r,n),l=this.navIdx.concat(s),h=this.getItem(l);h.items.length?(this.navIdx.push(s),this.keyType="right",this.action=e.action,this.openMenu(n,h,-1,-1,e)):e.action===Eh&&(this.isMenu&&this.navIdx.length===0?this.removeLIStateByClass([Li],[this.getWrapper()]):n.classList.remove(Hi),n.classList.add(Li),i={element:n,item:h,event:e},this.trigger("select",i),this.closeMenu(null,e))}},t.prototype.leftEscKeyHandler=function(e){this.navIdx.length?(this.keyType="left",this.closeMenu(this.navIdx.length,e)):e.action===sp&&this.closeMenu(null,e)},t.prototype.scrollHandler=function(e){this.closeMenu(null,e)},t.prototype.touchHandler=function(e){this.isTapHold=!0,this.cmenuHandler(e.originalEvent)},t.prototype.cmenuHandler=function(e){e.preventDefault(),this.isCMenu=!0,this.pageX=e.changedTouches?e.changedTouches[0].pageX+1:e.pageX+1,this.pageY=e.changedTouches?e.changedTouches[0].pageY+1:e.pageY+1,this.closeMenu(null,e),this.isCMenu&&(this.canOpen(e.target)&&this.openMenu(null,null,this.pageY,this.pageX,e),this.isCMenu=!1)},t.prototype.closeMenu=function(e,i,r){var n=this;if(e===void 0&&(e=0),i===void 0&&(i=null),this.isMenuVisible()){var s=void 0,l,h=this.getWrapper(),c=void 0,u,p=this.getPopups(),f=!1,g=this.isMenu?p.length+1:h.childElementCount,C=this.isMenu&&g!==1?(0,a.Ys)(".e-ul",p[g-2]):(0,a.td)(".e-menu-parent",h)[g-1];if(this.isMenu&&C.classList.contains("e-menu")&&(s=this.getLIByClass(C,Li),s&&s.classList.remove(Li),f=!0),!f){var L=i&&i.target&&this.getLI(i.target);L?this.cli=L:this.cli=C.children[0],l=this.navIdx.length?this.getItem(this.navIdx):null,u=l?l.items:this.items,c={element:C,parentItem:l,items:u,event:i,cancel:!1,isFocused:!0},this.trigger("beforeClose",c,function(D){var R,B,H="",j,W=!D.cancel;(W||n.isCMenu)&&(n.isMenu?(R=(0,a.oq)(C,"."+Go),n.hamburgerMode&&(R.parentElement.style.minHeight="",(0,a.oq)(C,".e-menu-item").setAttribute("aria-expanded","false")),n.unWireKeyboardEvent(R),wh((0,a.s8)(R.children[0],Ro),R.children[0]),j=(0,a.s8)(R,br),j.hide(),H=R.id,j.destroy(),(0,a.og)(R)):n.toggleAnimation(C,!1),B={element:C,parentItem:l,items:u},n.trigger("onClose",B),n.navIdx.pop()),n.updateReactTemplate();var ne,ie,me,ve=n.getWrapper()&&n.getUlByNavIdx();n.isCMenu&&(n.canOpen(i.target)&&n.openMenu(null,null,n.pageY,n.pageX,i),n.isCMenu=!1),n.isMenu&&ve&&H.length&&(ne=new RegExp("(.*)-ej2menu-"+n.element.id+"-popup").exec(H)[1],ie=ve.querySelector('[id="'+ne+'"]'),me=L&&ve.querySelector('[id="'+L.id+'"]'));var Ee=L&&L.querySelectorAll(".e-menu-item");if(W&&n.hamburgerMode&&e&&!Ee.length)n.afterCloseMenu(i);else if(W&&!n.hamburgerMode&&n.navIdx.length&&ie&&!me&&n.keyType!=="left"){var le=i&&i.target.classList.contains("e-vscroll")?(0,a.oq)(i.target,".e-menu-wrapper"):null;le?(le=le.querySelector(".e-menu-item"),(n.showItemOnClick||le&&n.getIndex(le.id,!0).length<=n.navIdx.length)&&n.closeMenu(n.navIdx[n.navIdx.length-1],i,!0)):n.closeMenu(n.navIdx[n.navIdx.length-1],i)}else if(W&&!r&&!e&&(n.hamburgerMode&&n.navIdx.length||n.navIdx.length===1))n.closeMenu(null,i);else if(W&&(0,a.le)(e)&&n.navIdx.length)n.closeMenu(null,i);else if(W&&!n.isMenu&&!e&&n.navIdx.length===0&&!n.isMenusClosed)n.isMenusClosed=!0,n.closeMenu(0,i);else if(W&&n.isMenu&&i&&i.target&&n.navIdx.length!==0&&(0,a.oq)(i.target,".e-menu-parent.e-control"))n.closeMenu(0,i);else if(W&&!n.isMenu&&(0,a.td)(".e-menu-parent",h)[e-1]&&i.which===3)n.closeMenu(null,i);else{if(W&&(n.keyType==="right"||n.keyType==="click"))n.afterCloseMenu(i);else{var de=n.getUlByNavIdx(),fe=n.getLIByClass(de,Li);if(fe&&(fe.setAttribute("aria-expanded","false"),fe.classList.remove(Li),(D.isFocused&&L||n.keyType==="left")&&(fe.classList.add(Hi),fe.focus())),!W&&n.hamburgerMode&&L&&L.getAttribute("aria-expanded")==="false"&&L.getAttribute("aria-haspopup")==="true"){(0,a.oq)(L,".e-menu-parent.e-control")?n.navIdx=[]:n.navIdx.pop(),n.navIdx.push(n.cliIdx);var Le=n.getItem(n.navIdx);L.setAttribute("aria-expanded","true"),n.openMenu(L,Le,-1,-1,i)}}n.navIdx.length<1&&(n.showSubMenuOn==="Hover"||n.showSubMenuOn==="Click")&&(n.showItemOnClick=n.defaultOption,n.showSubMenuOn="Auto")}n.removeStateWrapper()})}}},t.prototype.updateReactTemplate=function(){if(this.isReact&&this.template&&this.navIdx.length===0){var e=this.portals.splice(0,this.items.length);this.clearTemplate(["template"]),this.portals=e,this.renderReactTemplates()}},t.prototype.getMenuItemModel=function(e,i){if((0,a.le)(e))return null;(0,a.le)(i)&&(i=0);var r=this.getFields(i);return{text:e[r.text],id:e[r.id],items:e[r.child],separator:e[r.separator],iconCss:e[r.iconCss],url:e[r.url]}},t.prototype.getPopups=function(){var e=this,i=[];return[].slice.call(document.querySelectorAll("."+Go)).forEach(function(r){!(0,a.le)(r.querySelector("."+Wa))&&e.getIndex(r.querySelector("."+Wa).id,!0).length&&i.push(r)}),i},t.prototype.isMenuVisible=function(){return this.navIdx.length>0||this.element.classList.contains("e-contextmenu")&&(0,a.pn)(this.element).valueOf()},t.prototype.canOpen=function(e){var i=!0;if(this.filter){i=!1;for(var r=this.filter.split(" "),n=0,s=r.length;n<s;n++)if((0,a.oq)(e,"."+r[n])){i=!0;break}}return i},t.prototype.openMenu=function(e,i,r,n,s,l){var h=this;r===void 0&&(r=0),n===void 0&&(n=0),s===void 0&&(s=null),l===void 0&&(l=this.targetElement);var c=this.getWrapper();this.lItem=e;var u=this.element.id!==""?this.element.id:"menu";if(this.isMenusClosed=!1,(0,a.le)(r)&&(r=-1),(0,a.le)(n)&&(n=-1),e){if(this.uList=this.createItems(i[this.getField("children",this.navIdx.length-1)]),!this.isMenu&&a.AR.isDevice){c.lastChild.style.display="none";var p={text:i[this.getField("text")].toString(),iconCss:bv+" e-previous"},f=new Ko(this.items[0],"items",p,!0),g=this.createItems([f]).children[0];g.classList.add(Ah),this.uList.insertBefore(g,this.uList.children[0])}this.isMenu?(this.popupWrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper "+Go,id:e.id+"-ej2menu-"+u+"-popup"}),this.hamburgerMode?(r=e.offsetHeight,e.appendChild(this.popupWrapper)):document.body.appendChild(this.popupWrapper),this.isNestedOrVertical=this.element.classList.contains("e-vertical")||this.navIdx.length!==1,this.popupObj=this.generatePopup(this.popupWrapper,this.uList,e,this.isNestedOrVertical),this.template&&this.renderReactTemplates(),this.hamburgerMode?this.calculateIndentSize(this.uList,e):(this.cssClass&&(0,a.cn)([this.popupWrapper],this.cssClass.split(" ")),this.popupObj.hide()),!this.hamburgerMode&&!this.showItemOnClick&&this.hoverDelay?(window.clearInterval(this.timer),this.timer=window.setTimeout(function(){h.triggerBeforeOpen(e,h.uList,i,s,0,0,"menu")},this.hoverDelay)):this.triggerBeforeOpen(e,this.uList,i,s,0,0,"menu")):(this.uList.style.zIndex=this.element.style.zIndex,c.appendChild(this.uList),!this.showItemOnClick&&this.hoverDelay?(window.clearInterval(this.timer),this.timer=window.setTimeout(function(){h.triggerBeforeOpen(e,h.uList,i,s,r,n,"none")},this.hoverDelay)):this.triggerBeforeOpen(e,this.uList,i,s,r,n,"none"))}else this.uList=this.element,this.uList.style.zIndex=cn(l||this.element).toString(),this.triggerBeforeOpen(e,this.uList,i,s,r,n,"none")},t.prototype.calculateIndentSize=function(e,i){var r=getComputedStyle(i),n=parseInt(r.textIndent,10);this.navIdx.length<2&&!i.classList.contains("e-blankicon")?n*=2:n+=n/4,e.style.textIndent=n+"px";var s=e.querySelectorAll(".e-blankicon");if(s&&s.length)for(var l=e.querySelector(".e-menu-icon"),h=getComputedStyle(l),c=parseInt(h.marginRight,10)+l.offsetWidth+n,u=0;u<s.length;u++)s[u].style.textIndent=c+"px"},t.prototype.generatePopup=function(e,i,r,n){var s=this,l=new br(e,{actionOnScroll:this.hamburgerMode?"none":"reposition",relateTo:r,collision:this.hamburgerMode?{X:"none",Y:"none"}:{X:n||this.enableRtl?"none":"flip",Y:"fit"},position:n&&!this.hamburgerMode?{X:"right",Y:"top"}:{X:"left",Y:"bottom"},targetType:"relative",enableRtl:this.enableRtl,content:i,open:function(){var h=(0,a.Ys)(".e-menu-vscroll",l.element);h&&(h.style.height="inherit",h.style.maxHeight="");var c=(0,a.Ys)(".e-ul",l.element);l.element.style.maxHeight="",c.focus(),s.triggerOpen(c)}});return l},t.prototype.createHeaderContainer=function(e){e=e||this.getWrapper();var i=this.createElement("span",{className:"e-"+this.getModuleName()+"-header"}),r=this.enableHtmlSanitizer?a.pJ.sanitize(this.title):this.title,n=this.createElement("span",{className:"e-"+this.getModuleName()+"-title",innerHTML:r}),s=this.createElement("span",{className:"e-icons e-"+this.getModuleName()+"-icon",attrs:{tabindex:"0"}});i.appendChild(n),i.appendChild(s),e.insertBefore(i,this.element)},t.prototype.openHamburgerMenu=function(e){this.hamburgerMode&&this.triggerBeforeOpen(null,this.element,null,e,0,0,"hamburger")},t.prototype.closeHamburgerMenu=function(e){var i=this,r={element:this.element,parentItem:null,event:e,items:this.items,cancel:!1};this.trigger("beforeClose",r,function(n){n.cancel||(i.closeMenu(null,e),i.element.classList.add("e-hide-menu"),i.trigger("onClose",{element:i.element,parentItem:null,items:i.items}))})},t.prototype.callFit=function(e,i,r,n,s){return Ws(e,null,{X:i,Y:r},{top:n,left:s})},t.prototype.triggerBeforeOpen=function(e,i,r,n,s,l,h){var c=this,u=e?r[this.getField("children",this.navIdx.length-1)]:this.items,p={element:i,items:u,parentItem:r,event:n,cancel:!1,top:s,left:l,showSubMenuOn:"Auto"},f=h;this.trigger("beforeOpen",p,function(g){switch(f){case"menu":c.hamburgerMode||(g.showSubMenuOn!=="Auto"&&(c.showItemOnClick=!c.defaultOption,c.showSubMenuOn=g.showSubMenuOn),c.top=g.top,c.left=g.left),c.popupWrapper.style.display="block",c.hamburgerMode||(c.popupWrapper.style.maxHeight=c.popupWrapper.getBoundingClientRect().height+"px",c.enableScrolling&&ra(c.createElement,c.popupWrapper,c.uList,"vscroll",c.enableRtl),c.checkScrollOffset(n)),!c.hamburgerMode&&!c.left&&!c.top?(c.popupObj.refreshPosition(c.lItem,!0),c.left=parseInt(c.popupWrapper.style.left,10),c.top=parseInt(c.popupWrapper.style.top,10),c.enableRtl&&(c.left=c.isNestedOrVertical?c.left-c.popupWrapper.offsetWidth-c.lItem.parentElement.offsetWidth+2:c.left-c.popupWrapper.offsetWidth+c.lItem.offsetWidth),c.template&&(c.isReact||c.isAngular)?requestAnimationFrame(function(){c.collision(),c.popupWrapper.style.display=""}):(c.collision(),c.popupWrapper.style.display="")):(c.popupObj.collision={X:"none",Y:"none"},c.popupWrapper.style.display="");break;case"none":c.top=g.top,c.left=g.left;break;case"hamburger":g.cancel||(c.element.classList.remove("e-hide-menu"),c.triggerOpen(c.element));break}if(f!=="hamburger")if(g.cancel)c.isMenu?(c.popupObj.destroy(),(0,a.og)(c.popupWrapper)):i.className.indexOf("e-ul")>-1&&(0,a.og)(i),c.navIdx.pop();else if(c.isMenu)if(c.hamburgerMode)c.popupWrapper.style.top=c.top+"px",c.popupWrapper.style.left=0+"px",c.toggleAnimation(c.popupWrapper);else{c.setBlankIconStyle(c.popupWrapper),c.wireKeyboardEvent(c.popupWrapper),(0,a.qx)(c.popupWrapper,{selector:"."+Wa}),c.popupWrapper.style.left=c.left+"px",c.popupWrapper.style.top=c.top+"px";var C=c.animationSettings.effect!=="None"?{name:c.animationSettings.effect,duration:c.animationSettings.duration,timingFunction:c.animationSettings.easing}:null;c.popupObj.show(C,c.lItem)}else c.setBlankIconStyle(c.uList),c.setPosition(c.lItem,c.uList,c.top,c.left),c.toggleAnimation(c.uList);if(c.keyType==="right"){var L=c.getUlByNavIdx();if(e.classList.remove(Hi),c.isMenu&&c.navIdx.length===1&&c.removeLIStateByClass([Li],[c.getWrapper()]),e.classList.add(Li),c.action===Eh){var D={element:e,item:r,event:n};c.trigger("select",D)}e.focus(),L=c.getUlByNavIdx();var R=c.isValidLI(L.children[0],0,c.action);L.children[R].classList.add(Hi),L.children[R].focus()}})},t.prototype.collision=function(){var e;if(e=Vr(this.popupWrapper,null,this.left,this.top),(this.isNestedOrVertical||this.enableRtl)&&(e.indexOf("right")>-1||e.indexOf("left")>-1)){this.popupObj.collision.X="none";var i=(0,a.oq)(this.lItem,".e-"+this.getModuleName()+"-wrapper").offsetWidth;this.left=this.enableRtl?Di(this.lItem,this.isNestedOrVertical?"right":"left","top").left:this.left-this.popupWrapper.offsetWidth-i+2}e=Vr(this.popupWrapper,null,this.left,this.top),(e.indexOf("left")>-1||e.indexOf("right")>-1)&&(this.left=this.callFit(this.popupWrapper,!0,!1,this.top,this.left).left),this.popupWrapper.style.left=this.left+"px"},t.prototype.setBlankIconStyle=function(e){var i=[].slice.call(e.getElementsByClassName("e-blankicon"));if(!!i.length){var r=e.querySelector(".e-menu-item:not(.e-blankicon):not(.e-separator)"),n=r.querySelector(".e-menu-icon");if(!!n){var s=this.enableRtl?{padding:"paddingRight",margin:"marginLeft"}:{padding:"paddingLeft",margin:"marginRight"},l=getComputedStyle(n),h=parseInt(l.fontSize,10);!!parseInt(l.width,10)&&parseInt(l.width,10)>h&&(h=parseInt(l.width,10));var c=h+parseInt(l[s.margin],10)+parseInt(getComputedStyle(r)[s.padding],10)+"px";i.forEach(function(u){u.style[s.padding]=c})}}},t.prototype.checkScrollOffset=function(e){var i=this.getWrapper();if(i.children[0].classList.contains("e-menu-hscroll")&&this.navIdx.length===1){var r=(0,a.le)(e)?this.element:(0,a.oq)(e.target,"."+Wa),n=(0,a.Ys)(".e-hscroll-bar",i);n.scrollLeft>r.offsetLeft&&(n.scrollLeft-=n.scrollLeft-r.offsetLeft);var s=n.scrollLeft+n.offsetWidth,l=r.offsetLeft+r.offsetWidth;s<l&&(n.scrollLeft+=l-s)}},t.prototype.setPosition=function(e,i,r,n){var s="px";if(this.toggleVisiblity(i),i===this.element||n>-1&&r>-1){var l=Vr(i,null,n,r);if(l.indexOf("right")>-1&&(n=n-i.offsetWidth),l.indexOf("bottom")>-1){var h=this.callFit(i,!1,!0,r,n);if(r=h.top-20,r<0){var c=pageYOffset+document.documentElement.clientHeight-i.getBoundingClientRect().height;c>-1&&(r=c)}}if(l=Vr(i,null,n,r),l.indexOf("left")>-1){var h=this.callFit(i,!0,!1,r,n);n=h.left}}else if(a.AR.isDevice)r=Number(this.element.style.top.replace(s,"")),n=Number(this.element.style.left.replace(s,""));else{var u=this.enableRtl?"left":"right",h=Di(e,u,"top");r=h.top,n=h.left;var l=Vr(i,null,this.enableRtl?n-i.offsetWidth:n,r),p=l.indexOf("left")>-1||l.indexOf("right")>-1;p&&(h=Di(e,this.enableRtl?"right":"left","top"),n=h.left),(this.enableRtl||p)&&(n=this.enableRtl&&p?n:n-i.offsetWidth),l.indexOf("bottom")>-1&&(h=this.callFit(i,!1,!0,r,n),r=h.top)}this.toggleVisiblity(i,!1),i.style.top=r+s,i.style.left=n+s},t.prototype.toggleVisiblity=function(e,i){i===void 0&&(i=!0),e.style.visibility=i?"hidden":"",e.style.display=i?"block":"none"},t.prototype.createItems=function(e){var i=this,r=this.navIdx?this.navIdx.length:0,n=this.getFields(r),s=this.hasField(e,this.getField("iconCss",r)),l={showIcon:s,moduleName:"menu",fields:n,template:this.template,itemNavigable:!0,itemCreating:function(c){c.curData[c.fields[n.id]]||(c.curData[c.fields[n.id]]=(0,a.QI)("menuitem")),c.curData.htmlAttributes={role:"menuitem",tabindex:"-1"},i.isMenu&&!c.curData[i.getField("separator",r)]&&(c.curData.htmlAttributes["aria-label"]=c.curData[c.fields.text]),c.curData[c.fields[n.iconCss]]===""&&(c.curData[c.fields[n.iconCss]]=null)},itemCreated:function(c){if(c.curData[i.getField("separator",r)]&&(c.item.classList.add(Th),c.item.removeAttribute("role")),s&&!c.curData[c.fields.iconCss]&&!c.curData[i.getField("separator",r)]&&c.item.classList.add("e-blankicon"),c.curData[c.fields.child]&&c.curData[c.fields.child].length){var u=i.createElement("span",{className:bv+" "+yv});c.item.appendChild(u),c.item.setAttribute("aria-haspopup","true"),c.item.setAttribute("aria-expanded","false"),i.isMenu||c.item.removeAttribute("role"),c.item.classList.add("e-menu-caret-icon")}i.isMenu&&i.template&&(c.item.setAttribute("id",c.curData[c.fields.id].toString()),c.item.removeAttribute("data-uid"),c.item.classList.contains("e-level-1")&&c.item.classList.remove("e-level-1"),c.item.classList.contains("e-has-child")&&c.item.classList.remove("e-has-child"));var p={item:c.curData,element:c.item};i.trigger("beforeItemRender",p)}};this.setProperties({items:this.items},!0),this.isMenu&&(l.templateID=this.element.id+Qb);var h=Mt.createList(this.createElement,e,l,!this.template,this);return h.setAttribute("tabindex","0"),this.isMenu&&h.setAttribute("role","menu"),h},t.prototype.moverHandler=function(e){var i=e.target;this.liTrgt=i;var r=this.getLI(i),n=r?(0,a.oq)(r,".e-"+this.getModuleName()+"-wrapper"):this.getWrapper(),s=this.getWrapper(),l=new RegExp("-ej2menu-(.*)-popup"),h,c=!1;if(!!n){if(n.id!==""?h=l.exec(n.id)[1]:h=n.querySelector("ul").id,h!==this.element.id)if(this.removeLIStateByClass([Hi,Li],[this.getWrapper()]),this.navIdx.length)c=!0;else return;r&&(0,a.oq)(r,".e-"+this.getModuleName()+"-wrapper")&&!c?(this.removeLIStateByClass([Hi],this.isMenu?[n].concat(this.getPopups()):[n]),this.removeLIStateByClass([Hi],this.isMenu?[s].concat(this.getPopups()):[s]),r.classList.add(Hi),this.showItemOnClick||this.clickHandler(e)):this.isMenu&&this.showItemOnClick&&!c&&this.removeLIStateByClass([Hi],[n].concat(this.getPopups())),this.isMenu&&(!this.showItemOnClick&&i.parentElement!==n&&!(0,a.oq)(i,".e-"+this.getModuleName()+"-popup")&&(!r||r&&!this.getIndex(r.id,!0).length)&&this.showSubMenuOn!=="Hover"?(this.removeLIStateByClass([Hi],[n]),this.navIdx.length&&(this.isClosed=!0,this.closeMenu(null,e))):c&&!this.showItemOnClick&&this.navIdx.length&&(this.isClosed=!0,this.closeMenu(null,e)),this.isClosed||this.removeStateWrapper(),this.isClosed=!1)}},t.prototype.removeStateWrapper=function(){if(this.liTrgt){var e=(0,a.oq)(this.liTrgt,".e-menu-vscroll");this.liTrgt.tagName==="DIV"&&e&&this.removeLIStateByClass([Hi,Li],[e])}},t.prototype.removeLIStateByClass=function(e,i){for(var r,n=function(l){e.forEach(function(h){r=(0,a.Ys)("."+h,i[l]),r&&r.classList.remove(h)})},s=0;s<i.length;s++)n(s)},t.prototype.getField=function(e,i){i===void 0&&(i=0);var r=this.fields[e];return typeof r=="string"?r:r[i]?r[i].toString():r[r.length-1].toString()},t.prototype.getFields=function(e){return e===void 0&&(e=0),{id:this.getField("itemId",e),iconCss:this.getField("iconCss",e),text:this.getField("text",e),url:this.getField("url",e),child:this.getField("children",e),separator:this.getField("separator",e)}},t.prototype.hasField=function(e,i){for(var r=0,n=e.length;r<n;r++)if(e[r][i])return!0;return!1},t.prototype.menuHeaderClickHandler=function(e){(0,a.oq)(e.target,".e-menu-wrapper").querySelector("ul.e-menu-parent").id===this.element.id&&(this.element.classList.contains("e-hide-menu")?this.openHamburgerMenu(e):this.closeHamburgerMenu(e))},t.prototype.clickHandler=function(e){if(this.isTapHold)this.isTapHold=!1;else{var i=this.getWrapper(),r=e.target,n=this.cli=this.getLI(r),s=new RegExp("-ej2menu-(.*)-popup"),l=n?(0,a.oq)(n,".e-"+this.getModuleName()+"-wrapper"):null,h=n&&l&&(this.isMenu?this.getIndex(n.id,!0).length>0:i.firstElementChild.id===l.firstElementChild.id);if(a.AR.isDevice&&this.isMenu&&(this.removeLIStateByClass([Hi],[i].concat(this.getPopups())),this.mouseDownHandler(e)),n&&l&&this.isMenu){var c=l.id?s.exec(l.id)[1]:l.querySelector(".e-menu-parent").id;if(this.element.id!==c)return}if(h&&e.type==="click"&&!n.classList.contains(Ah)){this.setLISelected(n);var u=this.getIndex(n.id,!0),p=this.getItem(u),f={element:n,item:p,event:e};this.trigger("select",f)}if(h&&(e.type==="mouseover"||a.AR.isDevice||this.showItemOnClick)){var g=void 0;if(n.classList.contains(Ah)){g=i.children[this.navIdx.length-1],this.toggleAnimation(g);var C=this.getLIByClass(g,Li);C&&C.classList.remove(Li),(0,a.og)(n.parentNode),this.navIdx.pop()}else if(!n.classList.contains(Th)){this.showSubMenu=!0;var L=n.parentNode;if(this.cliIdx=this.getIdx(L,n),this.isMenu||!a.AR.isDevice){var D=this.isMenu?Array.prototype.indexOf.call([i].concat(this.getPopups()),(0,a.oq)(L,".e-"+this.getModuleName()+"-wrapper")):this.getIdx(i,L);if(this.navIdx[D]===this.cliIdx&&(this.showSubMenu=!1),D!==this.navIdx.length&&(e.type!=="mouseover"||this.showSubMenu)){var C=this.getLIByClass(L,Li);C&&C.classList.remove(Li),this.isClosed=!0,this.keyType="click",this.showItemOnClick&&this.setLISelected(n),this.closeMenu(D+1,e),this.showItemOnClick&&this.setLISelected(n)}}this.isClosed||this.afterCloseMenu(e),this.isClosed=!1}}else if(this.isMenu&&r.tagName==="DIV"&&this.navIdx.length&&(0,a.oq)(r,".e-menu-vscroll")){var R=(0,a.oq)(r,"."+Go),B=Array.prototype.indexOf.call(this.getPopups(),R)+1;B<this.navIdx.length&&(this.closeMenu(B+1,e),R&&this.removeLIStateByClass([Hi,Li],[R]))}else this.isMenu&&this.hamburgerMode&&r.tagName==="SPAN"&&r.classList.contains("e-menu-icon")?this.menuHeaderClickHandler(e):(r.tagName!=="UL"||(this.isMenu?r.parentElement.classList.contains("e-menu-wrapper")&&!this.getIndex(r.querySelector("."+Wa).id,!0).length:r.parentElement!==i))&&(n||this.removeLIStateByClass([Li],[i]),(!n||!n.querySelector("."+yv))&&this.closeMenu(null,e))}},t.prototype.afterCloseMenu=function(e){var i;if(this.showSubMenu){this.showItemOnClick&&this.navIdx.length===0?i=(0,a.oq)(e.target,".e-menu-parent.e-control"):i=(0,a.oq)(this.element,".e-menu-parent.e-control");var r=this.navIdx.concat(this.cliIdx),n=this.getItem(r);if(n&&n[this.getField("children",r.length-1)]&&n[this.getField("children",r.length-1)].length?((e.type==="mouseover"||a.AR.isDevice&&this.isMenu)&&this.setLISelected(this.cli),(!this.hamburgerMode&&i||this.hamburgerMode&&this.cli.getAttribute("aria-expanded")==="false")&&(this.cli.setAttribute("aria-expanded","true"),this.navIdx.push(this.cliIdx),this.openMenu(this.cli,n,null,null,e))):e.type!=="mouseover"&&this.closeMenu(null,e),!i){var s=this.getUlByNavIdx(),l=this.getLIByClass(s,Li);l&&(l.setAttribute("aria-expanded","false"),l.classList.remove(Li))}}this.keyType=""},t.prototype.setLISelected=function(e){var i=this.getLIByClass(e.parentElement,Li);i&&i.classList.remove(Li),this.isMenu||e.classList.remove(Hi),e.classList.add(Li)},t.prototype.getLIByClass=function(e,i){for(var r=0,n=e.children.length;r<n;r++)if(e.children[r].classList.contains(i))return e.children[r];return null},t.prototype.getItemIndex=function(e,i){var r;typeof e=="string"?r=e:r=e.id;var n=i!==!1,s=this.getIndex(r,n);return s},t.prototype.setItem=function(e,i,r){var n;r?n=i||e.id:n=i||e.text;var s=this.getIndex(n,r),l=this.getItem(s);l.iconCss=e.iconCss||l.iconCss,l.text=e.text||l.text,l.url=e.url||l.url,l.separator=e.separator||l.separator},t.prototype.getItem=function(e){e=e.slice();var i=e.pop(),r=this.getItems(e);return r[i]},t.prototype.getItems=function(e){for(var i=this.items,r=0;r<e.length;r++)i=i[e[r]][this.getField("children",r)];return i},t.prototype.setItems=function(e,i){var r=this.getItems(i);r.splice(0,r.length);for(var n=0;n<e.length;n++)r.splice(n,0,e[n])},t.prototype.getIdx=function(e,i,r){r===void 0&&(r=!0);var n=Array.prototype.indexOf.call(e.children,i);return r&&e.children[0].classList.contains(Ah)&&n--,n},t.prototype.getLI=function(e){return e.tagName==="LI"&&e.classList.contains("e-menu-item")?e:(0,a.oq)(e,"li.e-menu-item")},t.prototype.updateItemsByNavIdx=function(){for(var e=this.items,i=0,r=0;r<this.navIdx.length&&(e=e[r].items,!!e);r++){i++;var n=this.getUlByNavIdx(i);if(!n)break;this.updateItem(n,e)}},t.prototype.removeChildElement=function(e){for(;e.firstElementChild;)e.removeChild(e.firstElementChild);return e},t.prototype.onPropertyChanged=function(e,i){for(var r=this,n=this.getWrapper(),s=function(p){switch(p){case"cssClass":i.cssClass&&(0,a.IV)([n],i.cssClass.split(" ")),e.cssClass&&(0,a.cn)([n],e.cssClass.split(" "));break;case"enableRtl":n.classList.toggle(Cv);break;case"showItemOnClick":l.unWireEvents(),l.showItemOnClick=e.showItemOnClick,l.wireEvents();break;case"enableScrolling":if(e.enableScrolling){var f;l.element.classList.contains("e-vertical")?ra(l.createElement,n,l.element,"vscroll",l.enableRtl):ra(l.createElement,n,l.element,"hscroll",l.enableRtl),l.getPopups().forEach(function(j){f=(0,a.Ys)(".e-ul",j),ra(r.createElement,j,f,"vscroll",r.enableRtl)})}else{var g=n.children[0];l.element.classList.contains("e-vertical")?wh((0,a.s8)(g,Ro),g):wh((0,a.s8)(g,iu),g),n.style.overflow="",n.appendChild(l.element),l.getPopups().forEach(function(j){g=j.children[0],wh((0,a.s8)(g,Ro),g),j.style.overflow=""})}break;case"items":{var C=void 0,L=void 0,D=void 0;if(Object.keys(i.items).length)for(var H=Object.keys(e.items),R=0;R<H.length;R++)L=l.getChangedItemIndex(e,[],Number(H[R])),L.length<=l.getWrapper().children.length&&(C=L.pop(),D=l.getItems(L),l.insertAfter([D[C]],D[C].text),l.removeItem(D,L,C),l.setItems(D,L)),L.length=0;else{if(l.updateItem(l.element,l.items),!l.hamburgerMode)for(var R=1,B=n.childElementCount;R<B;R++)(0,a.og)(n.lastElementChild);l.navIdx=[]}break}}},l=this,h=0,c=Object.keys(e);h<c.length;h++){var u=c[h];s(u)}},t.prototype.updateItem=function(e,i){(0,a.xr)()&&!this.isMenu?e=this.removeChildElement(e):e.innerHTML="";var r=[].slice.call(this.createItems(i).children);r.forEach(function(n){e.appendChild(n)})},t.prototype.getChangedItemIndex=function(e,i,r){i.push(r);var n=Object.keys(e.items[r]).pop();if(n==="items"){var s=e.items[r],l=Object.keys(s.items).pop();l&&this.getChangedItemIndex(s,i,Number(l))}else n==="isParentArray"&&i.length>1&&i.pop();return i},t.prototype.removeItem=function(e,i,r){e.splice(r,1);var n=this.getWrapper().children,s=this.hamburgerMode?1:n.length;i.length<s&&(0,a.og)(n[this.hamburgerMode?1:i.length].children[r])},t.prototype.unWireEvents=function(e){e===void 0&&(e=this.target);var i=this.getWrapper();if(e){for(var r=void 0,n=void 0,s=(0,a.td)(e),l=0,h=s.length;l<h;l++)r=s[l],this.isMenu?a.bi.remove(r,"click",this.menuHeaderClickHandler):a.AR.isIos?(n=(0,a.s8)(r,a.Xh),n&&n.destroy()):a.bi.remove(r,"contextmenu",this.cmenuHandler);if(!this.isMenu){a.bi.remove(this.targetElement,"scroll",this.scrollHandler);for(var c=0,u=Ks(this.targetElement);c<u.length;c++){var p=u[c];a.bi.remove(p,"scroll",this.scrollHandler)}}}a.AR.isDevice||(a.bi.remove(this.isMenu?document:i,"mouseover",this.delegateMoverHandler),a.bi.remove(document,"mousedown",this.delegateMouseDownHandler)),a.bi.remove(document,"click",this.delegateClickHandler),this.unWireKeyboardEvent(i),this.rippleFn()},t.prototype.unWireKeyboardEvent=function(e){var i=(0,a.s8)(e,a.nv);i&&i.destroy()},t.prototype.toggleAnimation=function(e,i){var r=this;i===void 0&&(i=!0);var n,s;this.animationSettings.effect==="None"||!i?this.end(e,i):this.animation.animate(e,{name:this.animationSettings.effect,duration:this.animationSettings.duration,timingFunction:this.animationSettings.easing,begin:function(l){r.hamburgerMode?(s=l.element.parentElement,l.element.style.position="absolute",n=s.offsetHeight,l.element.style.maxHeight=l.element.offsetHeight+"px",s.style.maxHeight=""):(l.element.style.display="block",l.element.style.maxHeight=l.element.getBoundingClientRect().height+"px")},progress:function(l){r.hamburgerMode&&(s.style.minHeight=n+l.element.offsetHeight+"px")},end:function(l){r.hamburgerMode?(l.element.style.position="",l.element.style.maxHeight="",s.style.minHeight="",l.element.style.top=0+"px",l.element.children[0].focus(),r.triggerOpen(l.element.children[0])):r.end(l.element,i)}})},t.prototype.triggerOpen=function(e){var i=this.navIdx.length?this.getItem(this.navIdx):null,r={element:e,parentItem:i,items:i?i.items:this.items};this.trigger("onOpen",r)},t.prototype.end=function(e,i){if(i)if(e.style.display="block",e.style.maxHeight="",this.triggerOpen(e),e.querySelector("."+Hi))e.querySelector("."+Hi).focus();else{var r=this.getWrapper().children[this.getIdx(this.getWrapper(),e)-1];r?r.querySelector("."+Li).focus():this.element.focus()}else if(e===this.element){var n=this.getLIByClass(this.element,Hi);n&&n.classList.remove(Hi);var s=this.getLIByClass(this.element,Li);s&&s.classList.remove(Li),e.style.display="none"}else(0,a.og)(e)},t.prototype.getPersistData=function(){return""},t.prototype.getWrapper=function(){return(0,a.oq)(this.element,".e-"+this.getModuleName()+"-wrapper")},t.prototype.getIndex=function(e,i,r,n,s,l){r===void 0&&(r=this.items),n===void 0&&(n=[]),s===void 0&&(s=!1),l===void 0&&(l=0);var h;l=s?l+1:0;for(var c=0,u=r.length;c<u;c++)if(h=r[c],(i?h[this.getField("itemId",l)]:h[this.getField("text",l)])===e){n.push(c);break}else if(h[this.getField("children",l)]&&h[this.getField("children",l)].length)if(n=this.getIndex(e,i,h[this.getField("children",l)],n,!0,l),n[n.length-1]===-1)c!==u-1&&n.pop();else{n.unshift(c);break}else c===u-1&&n.push(-1);return!s&&n[0]===-1?[]:n},t.prototype.enableItems=function(e,i,r){i===void 0&&(i=!0);for(var n,s,l,h=op,c,u=0;u<e.length;u++){if(l=this.getIndex(e[u],r),this.navIdx.length){if(l.length!==1){c=!1;for(var p=0,f=l.length-1;p<f;p++)if(l[p]!==this.navIdx[p]){c=!0;break}if(c)continue}}else if(l.length!==1)continue;s=l.pop(),n=this.getUlByNavIdx(l.length),n&&(i?this.isMenu?(n.children[s].classList.remove(h),n.children[s].removeAttribute("aria-disabled")):a.AR.isDevice&&!n.classList.contains("e-contextmenu")?n.children[s+1].classList.remove(h):n.children[s].classList.remove(h):this.isMenu?(n.children[s].classList.add(h),n.children[s].setAttribute("aria-disabled","true")):a.AR.isDevice&&!n.classList.contains("e-contextmenu")?n.children[s+1].classList.add(h):n.children[s].classList.add(h))}},t.prototype.showItems=function(e,i){this.showHideItems(e,!1,i)},t.prototype.hideItems=function(e,i){this.showHideItems(e,!0,i)},t.prototype.showHideItems=function(e,i,r){for(var n,s,l,h=0;h<e.length;h++)l=this.getIndex(e[h],r),s=l.pop(),n=this.getUlByNavIdx(l.length),n&&(i?a.AR.isDevice&&!n.classList.contains("e-contextmenu")?n.children[s+1].classList.add(Ua):n.children[s].classList.add(Ua):a.AR.isDevice&&!n.classList.contains("e-contextmenu")?n.children[s+1].classList.remove(Ua):n.children[s].classList.remove(Ua))},t.prototype.removeItems=function(e,i){for(var r,n,s,l=0;l<e.length;l++)n=this.getIndex(e[l],i),r=n.pop(),s=this.getItems(n),this.removeItem(s,n,r)},t.prototype.insertAfter=function(e,i,r){this.insertItems(e,i,r)},t.prototype.insertBefore=function(e,i,r){this.insertItems(e,i,r,!1)},t.prototype.insertItems=function(e,i,r,n){n===void 0&&(n=!0);for(var s,l,h,c,u,p=0;p<e.length;p++){h=this.getIndex(i,r),l=h.pop(),c=this.getItems(h),u=new Ko(c[0],"items",e[p],!0),c.splice(n?l+1:l,0,u);var f=this.isMenu?[this.getWrapper()].concat(this.getPopups()):[].slice.call(this.getWrapper().children);if(h.length<f.length){l=n?l+1:l,s=this.createItems(c).children[l];var g=this.isMenu?(0,a.Ys)(".e-menu-parent",f[h.length]):f[h.length];g.insertBefore(s,g.children[l])}}},t.prototype.removeAttributes=function(){var e=this;["top","left","display","z-index"].forEach(function(i){e.element.style.removeProperty(i)}),["role","tabindex","class","style"].forEach(function(i){i==="class"&&e.element.classList.contains("e-menu-parent")&&e.element.classList.remove("e-menu-parent"),(["class","style"].indexOf(i)===-1||!e.element.getAttribute(i))&&e.element.removeAttribute(i),e.isMenu&&i==="class"&&e.element.classList.contains("e-vertical")&&e.element.classList.remove("e-vertical")})},t.prototype.destroy=function(){var e=this.getWrapper();if(e){if(this.unWireEvents(),this.isMenu)this.closeMenu(),(0,a.xr)()&&!this.isMenu?this.element=this.removeChildElement(this.element):this.element.innerHTML="",this.removeAttributes(),e.parentNode.insertBefore(this.element,e),this.clonedElement=null;else{if(this.clonedElement.style.display="",this.clonedElement.tagName==="EJS-CONTEXTMENU")(0,a.cn)([this.clonedElement],["e-control","e-lib","e-"+this.getModuleName()]),this.element=this.clonedElement;else if(this.refreshing&&this.clonedElement.childElementCount&&this.clonedElement.children[0].tagName==="LI"&&this.setProperties({items:[]},!0),document.getElementById(this.clonedElement.id)){var i=this.clonedElement.nextElementSibling;i&&i!==e?this.clonedElement.parentElement.insertBefore(this.element,i):this.clonedElement.parentElement.appendChild(this.element),(0,a.xr)()&&!this.isMenu?this.element=this.removeChildElement(this.element):this.element.innerHTML="",(0,a.R3)([].slice.call(this.clonedElement.children),this.element),(0,a.og)(this.clonedElement),this.removeAttributes()}this.clonedElement=null}this.isMenu&&this.clonedElement?((0,a.og)(this.element),e.style.display="",e.classList.remove("e-"+this.getModuleName()+"-wrapper"),e.removeAttribute("data-ripple")):(0,a.og)(e),o.prototype.destroy.call(this),this.template&&this.clearTemplate(["template"])}this.rippleFn=null},ii([(0,a.ju)()],t.prototype,"beforeItemRender",void 0),ii([(0,a.ju)()],t.prototype,"beforeOpen",void 0),ii([(0,a.ju)()],t.prototype,"onOpen",void 0),ii([(0,a.ju)()],t.prototype,"beforeClose",void 0),ii([(0,a.ju)()],t.prototype,"onClose",void 0),ii([(0,a.ju)()],t.prototype,"select",void 0),ii([(0,a.ju)()],t.prototype,"created",void 0),ii([(0,a.Z9)("")],t.prototype,"cssClass",void 0),ii([(0,a.Z9)(0)],t.prototype,"hoverDelay",void 0),ii([(0,a.Z9)(!1)],t.prototype,"showItemOnClick",void 0),ii([(0,a.Z9)("")],t.prototype,"target",void 0),ii([(0,a.Z9)("")],t.prototype,"filter",void 0),ii([(0,a.Z9)(null)],t.prototype,"template",void 0),ii([(0,a.Z9)(!1)],t.prototype,"enableScrolling",void 0),ii([(0,a.Z9)(!1)],t.prototype,"enableHtmlSanitizer",void 0),ii([(0,a.Zz)({itemId:"id",text:"text",parentId:"parentId",iconCss:"iconCss",url:"url",separator:"separator",children:"items"},Sv)],t.prototype,"fields",void 0),ii([(0,a.FE)([],Ko)],t.prototype,"items",void 0),ii([(0,a.Zz)({duration:400,easing:"ease",effect:"SlideDown"},Jb)],t.prototype,"animationSettings",void 0),t=ii([a.Zl],t),t}(a.wA),eC=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),$n=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},gn="e-vertical",tC="e-scrollable",lp="e-hamburger",qa=function(o){eC(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.tempItems=[],r}return t.prototype.getModuleName=function(){return"menu"},t.prototype.preRender=function(){if(this.isMenu=!0,this.element.id=this.element.id||(0,a.QI)("ej2-menu"),this.template)try{document.querySelectorAll(this.template).length&&(this.template=document.querySelector(this.template).innerHTML.trim(),this.clearChanges())}catch(e){}else this.updateMenuItems(this.items);o.prototype.preRender.call(this)},t.prototype.initialize=function(){o.prototype.initialize.call(this),(0,a.Y4)(this.element,{role:"menubar",tabindex:"0"}),this.orientation==="Vertical"?(this.element.classList.add(gn),this.hamburgerMode&&!this.target&&this.element.previousElementSibling.classList.add(gn),this.element.setAttribute("aria-orientation","vertical")):a.AR.isDevice&&!this.enableScrolling&&this.element.parentElement.classList.add(tC),this.hamburgerMode&&(this.element.parentElement.classList.add(lp),this.orientation==="Horizontal"&&this.element.classList.add("e-hide-menu"))},t.prototype.updateMenuItems=function(e){this.tempItems=e,this.items=[],this.tempItems.map(this.createMenuItems,this),this.setProperties({items:this.items},!0),this.tempItems=[]},t.prototype.onPropertyChanged=function(e,i){for(var r=this,n=0,s=Object.keys(e);n<s.length;n++){var l=s[n];switch(l){case"orientation":e.orientation==="Vertical"?(this.element.classList.add(gn),this.hamburgerMode&&(this.target||this.element.previousElementSibling.classList.add(gn),this.element.classList.remove("e-hide-menu")),this.element.setAttribute("aria-orientation","vertical")):(this.element.classList.remove(gn),this.hamburgerMode&&(this.target||this.element.previousElementSibling.classList.remove(gn),this.element.classList.add("e-hide-menu")),this.element.removeAttribute("aria-orientation"));break;case"items":Object.keys(i.items).length||this.updateMenuItems(e.items);break;case"hamburgerMode":this.element.previousElementSibling||o.prototype.createHeaderContainer.call(this),e.hamburgerMode?(this.element.parentElement.classList.add(lp),[].slice.call(this.element.getElementsByClassName("e-blankicon")).forEach(function(h){h.style[r.enableRtl?"paddingRight":"paddingLeft"]=""})):(this.element.parentElement.classList.remove(lp),this.orientation==="Vertical"&&this.setBlankIconStyle(this.element)),this.orientation==="Vertical"?(this.target||this.element.previousElementSibling.classList.add(gn),this.element.classList.remove("e-hide-menu")):(this.target?this.element.previousElementSibling.classList.add(gn):this.element.previousElementSibling.classList.remove(gn),this.element.classList[e.hamburgerMode?"add":"remove"]("e-hide-menu"));break;case"title":this.hamburgerMode&&this.element.previousElementSibling&&(e.title=this.enableHtmlSanitizer?a.pJ.sanitize(e.title):e.title,this.element.previousElementSibling.querySelector(".e-menu-title").innerHTML=e.title);break;case"target":this.hamburgerMode&&(this.unWireEvents(i.target),this.wireEvents(),this.orientation==="Horizontal"&&(e.target?this.element.previousElementSibling.classList.add(gn):(this.element.previousElementSibling||o.prototype.createHeaderContainer.call(this),this.element.previousElementSibling.classList.remove(gn)),this.element.classList.add("e-hide-menu")));break}}o.prototype.onPropertyChanged.call(this,e,i)},t.prototype.createMenuItems=function(e){var i,r,n=this.items,s=this.getField("parentId");if(e[s]){for(i=this.getIndex(e[s].toString(),!0),r=0;r<i.length;r++)n[i[r]].items||(n[i[r]].items=[]),n=n[i[r]].items;n.push(e)}else this.items.push(e)},t.prototype.open=function(){o.prototype.openHamburgerMenu.call(this)},t.prototype.close=function(){o.prototype.closeHamburgerMenu.call(this)},$n([(0,a.Z9)("Horizontal")],t.prototype,"orientation",void 0),$n([(0,a.Z9)("")],t.prototype,"target",void 0),$n([(0,a.Z9)(null)],t.prototype,"template",void 0),$n([(0,a.Z9)(!1)],t.prototype,"enableScrolling",void 0),$n([(0,a.Z9)(!1)],t.prototype,"hamburgerMode",void 0),$n([(0,a.Z9)("Menu")],t.prototype,"title",void 0),$n([(0,a.Z9)(!1)],t.prototype,"enableHtmlSanitizer",void 0),$n([(0,a.Zz)({itemId:"id",text:"text",parentId:"parentId",iconCss:"iconCss",url:"url",separator:"separator",children:"items"},Sv)],t.prototype,"fields",void 0),t=$n([a.Zl],t),t}(wv),hp=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),cp=function(){return cp=Object.assign||function(o){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(o[r]=t[r])}return o},cp.apply(this,arguments)},qi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},iC=function(o){hp(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return qi([(0,a.Z9)("")],t.prototype,"text",void 0),qi([(0,a.Z9)("")],t.prototype,"iconCss",void 0),qi([(0,a.Z9)("left")],t.prototype,"iconPosition",void 0),t}(a.rt),xv=function(o){hp(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return qi([(0,a.Zz)({},iC)],t.prototype,"header",void 0),qi([(0,a.FE)([],uu)],t.prototype,"content",void 0),qi([(0,a.Z9)("")],t.prototype,"cssClass",void 0),qi([(0,a.Z9)(!1)],t.prototype,"disabled",void 0),t}(a.rt),rC=function(o){hp(t,o);function t(e,i){return o.call(this,e)||this}return t.prototype.preRender=function(){},t.prototype.render=function(){this.element.id||(this.element.id=(0,a.QI)("ribbon")),this.renderRibbon()},t.prototype.destroy=function(){var e=this.element.querySelector(".e-drop-icon");if(e&&e.removeEventListener("click",this.ribbonExpandCollapse.bind(this)),this.menuItems.length){var i=document.getElementById(this.element.id+"_menu");i&&(0,a.Xr)(i,"menu").destroy()}this.toolbarObj.destroy(),this.tabObj.destroy(),this.element.innerHTML="",this.toolbarObj=null,this.tabObj=null,o.prototype.destroy.call(this)},t.prototype.getTabItems=function(){var e=this,i=[];return this.menuItems.length&&i.push({header:{text:this.initMenu(this.menuItems)},content:this.toolbarObj.element,cssClass:"e-menu-tab"}),this.items.forEach(function(r){i.push({header:r.header,content:e.toolbarObj.element})}),i},t.prototype.initMenu=function(e){var i=this,r=this.createElement("ul",{id:this.element.id+"_menu"});this.element.appendChild(r);var n=new qa({cssClass:"e-file-menu",items:e,showItemOnClick:!0,beforeOpen:function(s){s.parentItem.text===e[0].text&&(n.showItemOnClick=!1),i.trigger("beforeOpen",s)},select:function(s){i.trigger("fileMenuItemSelect",s)},beforeClose:function(s){if(s.event.type==="mouseover"&&!(0,a.oq)(s.event.target,".e-menu-popup")){s.cancel=!0;return}i.trigger("beforeClose",s),(!s.parentItem||s.parentItem.text===e[0].text)&&requestAnimationFrame(function(){return n.setProperties({showItemOnClick:!0},!0)})},beforeItemRender:function(s){i.trigger("beforeFileMenuItemRender",s)}});return n.createElement=this.createElement,n.appendTo(r),r.parentElement},t.prototype.renderRibbon=function(){var e=this,i=this.createElement("div"),r=this.createElement("div");this.toolbarObj=new Ho({items:this.items[this.selectedTab].content,clicked:function(s){return e.trigger("clicked",s)}}),this.toolbarObj.createElement=this.createElement,this.toolbarObj.appendTo(r),this.tabObj=new xu({selectedItem:this.getIndex(this.selectedTab),animation:{next:{duration:0},previous:{duration:0}},items:this.getTabItems(),selecting:function(s){if(e.menuItems.length&&s.selectingIndex===0)s.cancel=!0;else{if(s.selectingIndex===e.getIndex(e.selectedTab))return;e.updateToolbar(e.getIndex(s.selectingIndex,!0)),e.toolbarObj.dataBind(),e.element.classList.contains("e-collapsed")&&a.bi.remove(s.selectedItem,"click",e.ribbonExpandCollapse);var l=void 0;e.menuItems.length?(l=cp({},s),l.selectingIndex-=1,l.selectedIndex-=1):l=s,e.trigger("selecting",l)}},selected:function(s){s.selectedIndex!==e.getIndex(e.selectedTab)&&(e.setProperties({selectedTab:e.getIndex(s.selectedIndex,!0)},!0),e.element.classList.contains("e-collapsed")&&(e.element.classList.remove("e-collapsed"),e.trigger("expandCollapse",{element:e.toolbarObj.element,expanded:!0})))},created:function(){e.toolbarObj.refreshOverflow()}}),this.element.appendChild(i),this.tabObj.createElement=this.createElement,this.tabObj.appendTo(i);var n=this.createElement("span",{className:"e-drop-icon e-icons"});n.addEventListener("click",this.ribbonExpandCollapse.bind(this)),this.element.appendChild(n)},t.prototype.ribbonExpandCollapse=function(e){var i={element:this.toolbarObj.element,expanded:!0},r;this.element.classList.contains("e-collapsed")?(r=this.tabObj.element.querySelector(".e-tab-header").getElementsByClassName("e-toolbar-item")[this.tabObj.selectedItem],this.element.classList.remove("e-collapsed"),r.classList.add("e-active"),a.bi.remove(r,"click",this.ribbonExpandCollapse),this.trigger("expandCollapse",i)):(r=this.tabObj.element.querySelector(".e-tab-header .e-toolbar-item.e-active"),this.element.classList.add("e-collapsed"),i.expanded=!1,r.classList.remove("e-active"),a.bi.add(r,"click",this.ribbonExpandCollapse,this),this.trigger("expandCollapse",i))},t.prototype.getIndex=function(e,i){return this.menuItems.length?i?e-1:e+1:e},t.prototype.updateToolbar=function(e){this.toolbarObj.items=this.items[e].content,this.toolbarObj.dataBind()},t.prototype.enableMenuItems=function(e,i,r){i===void 0&&(i=!0),!!this.menuItems.length&&(0,a.Xr)(document.getElementById(this.element.id+"_menu"),"menu").enableItems(e,i,r)},t.prototype.hideMenuItems=function(e,i,r){if(i===void 0&&(i=!0),!!this.menuItems.length){var n=(0,a.Xr)(document.getElementById(this.element.id+"_menu"),"menu");i?n.hideItems(e,r):n.showItems(e,r)}},t.prototype.addMenuItems=function(e,i,r,n){if(r===void 0&&(r=!0),!!this.menuItems.length){var s=(0,a.Xr)(document.getElementById(this.element.id+"_menu"),"menu");r?s.insertAfter(e.reverse(),i,n):s.insertBefore(e,i,n)}},t.prototype.hideTabs=function(e,i){var r=this;i===void 0&&(i=!0);var n,s,l,h;if(i||(h=this.isAllHidden()),e.forEach(function(u){n=r.getTabIndex(u,-1),n>-1&&(i?r.items[n].cssClass.includes(" e-hide")||(r.items[n].cssClass=r.items[n].cssClass+" e-hide",r.tabObj.items[r.getIndex(n)].cssClass=r.items[n].cssClass,s===void 0&&n===r.selectedTab&&(s=!0),l=!0):r.items[n].cssClass.includes(" e-hide")&&(r.items[n].cssClass=r.items[n].cssClass.replace(" e-hide",""),r.tabObj.items[r.getIndex(n)].cssClass=r.items[n].cssClass,s===void 0&&n===r.selectedTab&&(s=!0),l=!0))}),this.setProperties({items:this.items},!0),this.tabObj.items=this.tabObj.items,this.tabObj.dataBind(),i&&(h=this.isAllHidden(),h&&(s=!1)),!i&&h&&(s=!s),l&&h&&(this.element.classList.contains("e-collapsed")?(this.element.classList.remove("e-collapsed"),this.element.querySelector(".e-drop-icon").classList.remove("e-hide")):(this.element.classList.add("e-collapsed"),this.element.querySelector(".e-drop-icon").classList.add("e-hide"))),s){for(var c=0;c<this.items.length;c++)if(!this.items[c].cssClass.includes(" e-hide")){this.tabObj.selectedItem=this.getIndex(c),this.tabObj.dataBind();break}}},t.prototype.isAllHidden=function(){for(var e=!0,i=0;i<this.items.length;i++)if(!this.items[i].cssClass.includes(" e-hide")){e=!1;break}return e},t.prototype.enableTabs=function(e,i){var r=this;i===void 0&&(i=!0),e.forEach(function(n){var s=r.getTabIndex(n,-1);s>-1&&(r.items[s].disabled=!i,s=r.getIndex(s),r.tabObj.enableTab(s,i))}),this.setProperties({items:this.items},!0)},t.prototype.addTabs=function(e,i){var r=this,n=this.getTabIndex(i);e.forEach(function(s){s=new xv(r.items[0],"items",s,!0),r.items.splice(n,0,s),r.tabObj.addTab([{header:s.header,content:r.toolbarObj.element}],r.getIndex(n)),n++}),this.setProperties({items:this.items},!0),this.setProperties({selectedTab:this.getIndex(this.tabObj.selectedItem,!0)},!0)},t.prototype.getTabIndex=function(e,i){if(i===void 0&&(i=this.items.length),e){for(var r=0;r<this.items.length;r++)if(this.items[r].header.text===e){i=r;break}}return i},t.prototype.addToolbarItems=function(e,i,r){var n=this,s=this.getTabIndex(e);(0,a.le)(r)&&(r=this.items[s].content.length),i.forEach(function(l){l=new uu(n.items[s].content[0],"content",l,!0),n.items[s].content.splice(r,0,l),r++}),this.setProperties({items:this.items},!0),s===this.selectedTab&&i.length&&this.updateToolbar(s)},t.prototype.enableItems=function(e,i,r){if(r===void 0&&(r=!0),i){var n=this.getTabIndex(e,-1);if(n<0)return;for(var s=0;s<i.length;s++){if(typeof i[s]=="string"){for(var l=0;l<this.items[n].content.length;l++)if(this.items[n].content[l].id===i[s]){i[s]=l;break}}if(typeof i[s]=="string"){if(i.length-1>s)continue;return}this.items[n].content[i[s]].disabled=!r,n!==this.selectedTab&&this.setProperties({items:this.items},!0)}n===this.selectedTab&&this.updateToolbar(n)}else this.toolbarObj.disable(!r)},t.prototype.hideToolbarItems=function(e,i,r){var n=this;r===void 0&&(r=!0);for(var s,l=0;l<this.items.length;l++)if(this.items[l].header.text===e){s=l,i.forEach(function(h){n.items[s].content[h]&&(r?n.items[s].content[h].cssClass.includes(" e-hide")||(n.items[s].content[h].cssClass=n.items[s].content[h].cssClass+" e-hide"):n.items[s].content[h].cssClass.includes(" e-hide")&&(n.items[s].content[h].cssClass=n.items[s].content[h].cssClass.replace(" e-hide","")))});break}this.setProperties({items:this.items},!0),s!==void 0&&s===this.selectedTab&&this.updateToolbar(s)},t.prototype.getModuleName=function(){return"ribbon"},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"selectedTab":this.tabObj.selectedItem=this.getIndex(e.selectedTab),this.tabObj.dataBind();break}}},qi([(0,a.Z9)("")],t.prototype,"cssClass",void 0),qi([(0,a.Z9)(!0)],t.prototype,"menuType",void 0),qi([(0,a.FE)([],Ko)],t.prototype,"menuItems",void 0),qi([(0,a.Z9)(0)],t.prototype,"selectedTab",void 0),qi([(0,a.FE)([],xv)],t.prototype,"items",void 0),qi([(0,a.ju)()],t.prototype,"selecting",void 0),qi([(0,a.ju)()],t.prototype,"fileMenuItemSelect",void 0),qi([(0,a.ju)()],t.prototype,"beforeFileMenuItemRender",void 0),qi([(0,a.ju)()],t.prototype,"beforeOpen",void 0),qi([(0,a.ju)()],t.prototype,"beforeClose",void 0),qi([(0,a.ju)()],t.prototype,"selectFormat",void 0),qi([(0,a.ju)()],t.prototype,"clicked",void 0),qi([(0,a.ju)()],t.prototype,"created",void 0),qi([(0,a.ju)()],t.prototype,"expandCollapse",void 0),t=qi([a.Zl],t),t}(a.wA),nC=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),or=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},kh="e-rtl",up="EJS-SPLITBUTTON",pp=function(o){nC(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){var e=this.element;if(e.tagName===up){for(var i=(0,a.NA)("ej2_instances",e),r=this.createElement("button",{attrs:{type:"button"}}),n=this.createElement(up,{className:"e-"+this.getModuleName()+"-wrapper"}),s=0,l=e.attributes.length;s<l;s++)r.setAttribute(e.attributes[s].nodeName,e.attributes[s].nodeValue);e.parentNode.insertBefore(n,e),(0,a.og)(e),e=r,n.appendChild(e),(0,a.sO)("ej2_instances",i,e),this.wrapper=n,this.element=e}this.element.id||(this.element.id=(0,a.QI)("e-"+this.getModuleName()))},t.prototype.render=function(){this.initWrapper(),this.createPrimaryButton(),this.renderControl()},t.prototype.renderControl=function(){this.createSecondaryButton(),this.setActiveElem([this.element,this.secondaryBtnObj.element]),this.setAria(),this.wireEvents(),this.renderComplete()},t.prototype.addItems=function(e,i){o.prototype.addItems.call(this,e,i),this.secondaryBtnObj.items=this.items},t.prototype.removeItems=function(e,i){o.prototype.removeItems.call(this,e,i),this.secondaryBtnObj.items=this.items},t.prototype.initWrapper=function(){this.wrapper||(this.wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.element.parentNode.insertBefore(this.wrapper,this.element)),this.element.classList.remove("e-"+this.getModuleName()),this.enableRtl&&this.wrapper.classList.add(kh),this.cssClass&&(0,a.cn)([this.wrapper],this.cssClass.split(" "))},t.prototype.createPrimaryButton=function(){var e={cssClass:this.cssClass,enableRtl:this.enableRtl,iconCss:this.iconCss,iconPosition:this.iconPosition,content:this.content,disabled:this.disabled};this.primaryBtnObj=new $r(e),this.primaryBtnObj.createElement=this.createElement,this.primaryBtnObj.appendTo(this.element),this.element.classList.add("e-"+this.getModuleName()),this.element.type="button",this.wrapper.appendChild(this.element)},t.prototype.createSecondaryButton=function(){var e=this,i=this.createElement("button",{className:"e-icon-btn",attrs:{tabindex:"-1"},id:this.element.id+"_dropdownbtn"});this.wrapper.appendChild(i);var r={cssClass:this.cssClass,disabled:this.disabled,enableRtl:this.enableRtl,items:this.items,target:this.target,createPopupOnClick:this.createPopupOnClick};r.beforeItemRender=function(n){e.createPopupOnClick&&(e.secondaryBtnObj.dropDown.relateTo=e.wrapper,e.dropDown=e.secondaryBtnObj.dropDown),e.trigger("beforeItemRender",n)},r.open=function(n){e.trigger("open",n)},r.close=function(n){e.trigger("close",n)},r.select=function(n){e.trigger("select",n)},r.beforeOpen=function(n){var s=new Ih;return e.trigger("beforeOpen",n,function(l){s.resolve(l)}),s},r.beforeClose=function(n){var s=new Ih;return e.trigger("beforeClose",n,function(l){s.resolve(l)}),s},this.secondaryBtnObj=new Bi(r),this.secondaryBtnObj.createElement=this.createElement,this.secondaryBtnObj.appendTo(i),this.createPopupOnClick||(this.secondaryBtnObj.dropDown.relateTo=this.wrapper,this.dropDown=this.secondaryBtnObj.dropDown),this.secondaryBtnObj.activeElem=[this.element,this.secondaryBtnObj.element],this.secondaryBtnObj.element.querySelector(".e-btn-icon").classList.remove("e-icon-right")},t.prototype.setAria=function(){(0,a.Y4)(this.element,{"aria-expanded":"false","aria-haspopup":"true","aria-label":this.element.textContent+" splitbutton","aria-owns":this.element.id+"_dropdownbtn-popup"})},t.prototype.getModuleName=function(){return"split-btn"},t.prototype.toggle=function(){this.secondaryBtnObj.toggle()},t.prototype.destroy=function(){var e=this,i=[kh];if(this.cssClass&&(i=i.concat(this.cssClass.split(" "))),this.element){var r=document.getElementById(this.element.id);r&&r.parentElement===this.wrapper&&(this.wrapper.tagName===up?(this.wrapper.innerHTML="",(0,a.IV)([this.wrapper],["e-rtl","e-"+this.getModuleName()+"-wrapper"]),(0,a.IV)([this.wrapper],this.cssClass.split(" "))):((0,a.IV)([this.element],i),["aria-label","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(n){e.element.removeAttribute(n)}),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),(0,a.Od)(this.wrapper)),this.unWireEvents())}this.primaryBtnObj.destroy(),this.secondaryBtnObj.destroy(),o.prototype.destroy.call(this),this.element.getAttribute("class")||this.element.removeAttribute("class")},t.prototype.wireEvents=function(){a.bi.add(this.element,"click",this.primaryBtnClickHandler,this),new a.nv(this.element,{keyAction:this.btnKeyBoardHandler.bind(this),keyConfigs:{altdownarrow:"alt+downarrow"}})},t.prototype.unWireEvents=function(){a.bi.remove(this.element,"click",this.primaryBtnClickHandler),(0,a.s8)(this.element,a.nv).destroy()},t.prototype.primaryBtnClickHandler=function(){this.trigger("click",{element:this.element})},t.prototype.btnKeyBoardHandler=function(e){switch(e.action){case"altdownarrow":this.clickHandler(e);break}},t.prototype.onPropertyChanged=function(e,i){var r=["content","iconCss","iconPosition","cssClass","disabled","enableRtl"];this.primaryBtnObj.setProperties(Xs(e,r)),r=["beforeOpen","beforeItemRender","select","open","close","cssClass","disabled","enableRtl","createPopupOnClick"],Object.keys(e).indexOf("items")>-1&&(this.secondaryBtnObj.items=e.items,this.secondaryBtnObj.dataBind()),this.secondaryBtnObj.setProperties(Xs(e,r));for(var n=0,s=Object.keys(e);n<s.length;n++){var l=s[n];switch(l){case"cssClass":i.cssClass&&(0,a.IV)([this.wrapper],i.cssClass.split(" ")),(0,a.cn)([this.wrapper],e.cssClass.split(" "));break;case"enableRtl":e.enableRtl?(0,a.cn)([this.wrapper],kh):(0,a.IV)([this.wrapper],kh);break}}},t.prototype.focusIn=function(){this.element.focus()},or([(0,a.Z9)("")],t.prototype,"content",void 0),or([(0,a.Z9)("")],t.prototype,"cssClass",void 0),or([(0,a.Z9)(!1)],t.prototype,"disabled",void 0),or([(0,a.Z9)("")],t.prototype,"iconCss",void 0),or([(0,a.Z9)("Left")],t.prototype,"iconPosition",void 0),or([(0,a.Z9)(!1)],t.prototype,"createPopupOnClick",void 0),or([(0,a.FE)([],Co)],t.prototype,"items",void 0),or([(0,a.Z9)("")],t.prototype,"target",void 0),or([(0,a.ju)()],t.prototype,"beforeItemRender",void 0),or([(0,a.ju)()],t.prototype,"beforeOpen",void 0),or([(0,a.ju)()],t.prototype,"beforeClose",void 0),or([(0,a.ju)()],t.prototype,"click",void 0),or([(0,a.ju)()],t.prototype,"close",void 0),or([(0,a.ju)()],t.prototype,"open",void 0),or([(0,a.ju)()],t.prototype,"select",void 0),or([(0,a.ju)()],t.prototype,"created",void 0),t=or([a.Zl],t),t}(Bi),Ih=function(){function o(){var t=this;this.promise=new Promise(function(e,i){t.resolve=e,t.reject=i}),this.catch=this.promise.catch.bind(this.promise),this.then=this.promise.then.bind(this.promise)}return o}(),Xo=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ft=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},sC=function(o){Xo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ft([(0,a.Z9)("None")],t.prototype,"placement",void 0),Ft([(0,a.Z9)(10)],t.prototype,"largeStep",void 0),Ft([(0,a.Z9)(1)],t.prototype,"smallStep",void 0),Ft([(0,a.Z9)(!1)],t.prototype,"showSmallTicks",void 0),Ft([(0,a.Z9)(null)],t.prototype,"format",void 0),t}(a.rt),aC=function(o){Xo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ft([(0,a.Z9)(null)],t.prototype,"color",void 0),Ft([(0,a.Z9)(null)],t.prototype,"start",void 0),Ft([(0,a.Z9)(null)],t.prototype,"end",void 0),t}(a.rt),oC=function(o){Xo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ft([(0,a.Z9)(!1)],t.prototype,"enabled",void 0),Ft([(0,a.Z9)(null)],t.prototype,"minStart",void 0),Ft([(0,a.Z9)(null)],t.prototype,"minEnd",void 0),Ft([(0,a.Z9)(null)],t.prototype,"maxStart",void 0),Ft([(0,a.Z9)(null)],t.prototype,"maxEnd",void 0),Ft([(0,a.Z9)(!1)],t.prototype,"startHandleFixed",void 0),Ft([(0,a.Z9)(!1)],t.prototype,"endHandleFixed",void 0),t}(a.rt),lC=function(o){Xo(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ft([(0,a.Z9)("")],t.prototype,"cssClass",void 0),Ft([(0,a.Z9)("Before")],t.prototype,"placement",void 0),Ft([(0,a.Z9)("Focus")],t.prototype,"showOn",void 0),Ft([(0,a.Z9)(!1)],t.prototype,"isVisible",void 0),Ft([(0,a.Z9)(null)],t.prototype,"format",void 0),t}(a.rt),hC=6,cC=3,Re={root:"e-slider",rtl:"e-rtl",sliderHiddenInput:"e-slider-input",controlWrapper:"e-control-wrapper",sliderHandle:"e-handle",rangeBar:"e-range",sliderButton:"e-slider-button",firstButton:"e-first-button",secondButton:"e-second-button",scale:"e-scale",tick:"e-tick",large:"e-large",tickValue:"e-tick-value",sliderTooltip:"e-slider-tooltip",sliderHover:"e-slider-hover",sliderFirstHandle:"e-handle-first",sliderSecondHandle:"e-handle-second",sliderDisabled:"e-disabled",sliderContainer:"e-slider-container",horizontalTooltipBefore:"e-slider-horizontal-before",horizontalTooltipAfter:"e-slider-horizontal-after",verticalTooltipBefore:"e-slider-vertical-before",verticalTooltipAfter:"e-slider-vertical-after",materialTooltip:"e-material-tooltip",materialTooltipOpen:"e-material-tooltip-open",materialTooltipActive:"e-tooltip-active",materialSlider:"e-material-slider",sliderTrack:"e-slider-track",sliderHorizantalColor:"e-slider-horizantal-color",sliderVerticalColor:"e-slider-vertical-color",sliderHandleFocused:"e-handle-focused",verticalSlider:"e-vertical",horizontalSlider:"e-horizontal",sliderHandleStart:"e-handle-start",sliderTooltipStart:"e-material-tooltip-start",sliderTabHandle:"e-tab-handle",sliderButtonIcon:"e-button-icon",sliderSmallSize:"e-small-size",sliderTickPosition:"e-tick-pos",sliderFirstTick:"e-first-tick",sliderLastTick:"e-last-tick",sliderButtonClass:"e-slider-btn",sliderTooltipWrapper:"e-tooltip-wrap",sliderTabTrack:"e-tab-track",sliderTabRange:"e-tab-range",sliderActiveHandle:"e-handle-active",sliderMaterialHandle:"e-material-handle",sliderMaterialRange:"e-material-range",sliderMaterialDefault:"e-material-default",materialTooltipShow:"e-material-tooltip-show",materialTooltipHide:"e-material-tooltip-hide",readonly:"e-read-only",limits:"e-limits",limitBarDefault:"e-limit-bar",limitBarFirst:"e-limit-first",limitBarSecond:"e-limit-second",dragHorizontal:"e-drag-horizontal",dragVertical:"e-drag-vertical"},Ev=function(o){Xo(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.horDir="left",r.verDir="bottom",r.transition={handle:"left .4s cubic-bezier(.25, .8, .25, 1), right .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1) , bottom .4s cubic-bezier(.25, .8, .25, 1)",rangeBar:"all .4s cubic-bezier(.25, .8, .25, 1)"},r.transitionOnMaterialTooltip={handle:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, top 1ms ease-out",rangeBar:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, width 1ms ease-out, height 1ms ease-out"},r.scaleTransform="transform .4s cubic-bezier(.25, .8, .25, 1)",r.customAriaText=null,r.drag=!0,r.isDragComplete=!1,r.initialTooltip=!0,r}return t.prototype.preRender=function(){var e={incrementTitle:"Increase",decrementTitle:"Decrease"};this.l10n=new a.E7("slider",e,this.locale),this.isElementFocused=!1,this.tickElementCollection=[],this.tooltipFormatInfo={},this.ticksFormatInfo={},this.initCultureInfo(),this.initCultureFunc(),this.formChecker()},t.prototype.formChecker=function(){var e=(0,a.oq)(this.element,"form");e?(this.isForm=!0,(0,a.le)(this.formResetValue)||this.setProperties({value:this.formResetValue},!0),this.formResetValue=this.value,this.type==="Range"&&((0,a.le)(this.formResetValue)||typeof this.formResetValue!="object")?this.formResetValue=[parseFloat((0,a.Ac)(this.min)),parseFloat((0,a.Ac)(this.max))]:(0,a.le)(this.formResetValue)&&(this.formResetValue=parseFloat((0,a.Ac)(this.min))),this.formElement=e):this.isForm=!1},t.prototype.initCultureFunc=function(){this.internationalization=new a.eC(this.locale)},t.prototype.initCultureInfo=function(){this.tooltipFormatInfo.format=(0,a.le)(this.tooltip.format)?null:this.tooltip.format,this.ticksFormatInfo.format=(0,a.le)(this.ticks.format)?null:this.ticks.format},t.prototype.formatString=function(e,i){var r=null,n=null;if(e||e===0){r=this.formatNumber(e);var s=this.numberOfDecimals(e);n=this.internationalization.getNumberFormat(i)(this.makeRoundNumber(e,s))}return{elementVal:r,formatString:n}},t.prototype.formatNumber=function(e){var i=this.numberOfDecimals(e);return this.internationalization.getNumberFormat({maximumFractionDigits:i,minimumFractionDigits:i,useGrouping:!1})(e)},t.prototype.numberOfDecimals=function(e){var i=e.toString().split(".")[1],r=!i||!i.length?0:i.length;return r},t.prototype.makeRoundNumber=function(e,i){var r=i||0;return Number(e.toFixed(r))},t.prototype.fractionalToInteger=function(e){e=this.numberOfDecimals(e)===0?Number(e).toFixed(this.noOfDecimals):e;for(var i=1,r=0;r<this.noOfDecimals;r++)i*=10;return e=Number((e*i).toFixed(0)),e},t.prototype.render=function(){var e=this;this.initialize(),this.initRender(),this.wireEvents(),this.setZindex(),this.renderComplete(),this.element.tagName==="EJS-SLIDER"&&this.getTheme(this.sliderContainer)=="none"&&setTimeout(function(){e.refresh()},0)},t.prototype.initialize=function(){(0,a.cn)([this.element],Re.root),this.setCSSClass()},t.prototype.setElementWidth=function(e){(0,a.le)(e)||(typeof e=="number"?this.sliderContainer.style.width=(0,a.Ac)(e):typeof e=="string"&&(this.sliderContainer.style.width=e.match(/px|%|em/)?e:(0,a.Ac)(e)))},t.prototype.setCSSClass=function(e){e&&(0,a.IV)([this.element],e.split(" ")),this.cssClass&&(0,a.cn)([this.element],this.cssClass.split(" "))},t.prototype.setEnabled=function(){this.enabled?((0,a.IV)([this.sliderContainer],[Re.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&this.tooltip.showOn==="Always"&&this.tooltipElement.classList.remove(Re.sliderDisabled),this.wireEvents()):((0,a.cn)([this.sliderContainer],[Re.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&this.tooltip.showOn==="Always"&&this.tooltipElement.classList.add(Re.sliderDisabled),this.unwireEvents())},t.prototype.getTheme=function(e){var i=window.getComputedStyle(e,":after").getPropertyValue("content");return i.replace(/['"]+/g,"")},t.prototype.initRender=function(){this.sliderContainer=this.createElement("div",{className:Re.sliderContainer+" "+Re.controlWrapper}),this.element.parentNode.insertBefore(this.sliderContainer,this.element),this.sliderContainer.appendChild(this.element),this.sliderTrack=this.createElement("div",{className:Re.sliderTrack}),this.element.appendChild(this.sliderTrack),this.setElementWidth(this.width),this.element.tabIndex=-1,this.getThemeInitialization(),this.setHandler(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setOrientClass(),this.hiddenInput=this.createElement("input",{attrs:{type:"hidden",value:(0,a.le)(this.value)?this.min.toString():this.value.toString(),name:this.element.getAttribute("name")||this.element.getAttribute("id")||"_"+(Math.random()*1e3).toFixed(0)+"slider",class:Re.sliderHiddenInput}}),this.hiddenInput.tabIndex=-1,this.sliderContainer.appendChild(this.hiddenInput),this.showButtons&&this.setButtons(),this.setEnableRTL(),this.type==="Range"?this.rangeValueUpdate():this.value=(0,a.le)(this.value)?parseFloat((0,a.Ac)(this.min.toString())):this.value,this.previousVal=this.type!=="Range"?this.checkHandleValue(parseFloat((0,a.Ac)(this.value.toString()))):[this.checkHandleValue(parseFloat((0,a.Ac)(this.value[0].toString()))),this.checkHandleValue(parseFloat((0,a.Ac)(this.value[1].toString())))],this.previousChanged=this.previousVal,(0,a.le)(this.element.hasAttribute("name"))||this.element.removeAttribute("name"),this.setValue(),this.limits.enabled&&this.setLimitBar(),this.ticks.placement!=="None"&&this.renderScale(),this.tooltip.isVisible&&this.renderTooltip(),this.enabled?(0,a.IV)([this.sliderContainer],[Re.sliderDisabled]):(0,a.cn)([this.sliderContainer],[Re.sliderDisabled]),this.readonly?(0,a.cn)([this.sliderContainer],[Re.readonly]):(0,a.IV)([this.sliderContainer],[Re.readonly])},t.prototype.getThemeInitialization=function(){this.isMaterial=this.getTheme(this.sliderContainer)==="material"||this.getTheme(this.sliderContainer)==="material-dark",this.isBootstrap=this.getTheme(this.sliderContainer)==="bootstrap"||this.getTheme(this.sliderContainer)==="bootstrap-dark",this.isBootstrap4=this.getTheme(this.sliderContainer)==="bootstrap4",this.isTailwind=this.getTheme(this.sliderContainer)==="tailwind"||this.getTheme(this.sliderContainer)==="tailwind-dark",this.isBootstrap5=this.getTheme(this.sliderContainer)==="bootstrap5",this.isFluent=this.getTheme(this.sliderContainer)==="FluentUI",this.isMaterialTooltip=this.isMaterial&&this.type!=="Range"&&this.tooltip.isVisible},t.prototype.createRangeBar=function(){this.type!=="Default"&&(this.rangeBar=this.createElement("div",{attrs:{class:Re.rangeBar}}),this.element.appendChild(this.rangeBar),this.drag&&this.type==="Range"&&(this.orientation==="Horizontal"?this.rangeBar.classList.add(Re.dragHorizontal):this.rangeBar.classList.add(Re.dragVertical)))},t.prototype.createLimitBar=function(){var e=this.type!=="Range"?Re.limitBarDefault:Re.limitBarFirst;e+=" "+Re.limits,this.limitBarFirst=this.createElement("div",{attrs:{class:e}}),this.element.appendChild(this.limitBarFirst),this.type==="Range"&&(this.limitBarSecond=this.createElement("div",{attrs:{class:Re.limitBarSecond+" "+Re.limits}}),this.element.appendChild(this.limitBarSecond))},t.prototype.setOrientClass=function(){this.orientation!=="Vertical"?(this.sliderContainer.classList.remove(Re.verticalSlider),this.sliderContainer.classList.add(Re.horizontalSlider),this.firstHandle.setAttribute("aria-orientation","horizontal"),this.type==="Range"&&this.secondHandle.setAttribute("aria-orientation","horizontal")):(this.sliderContainer.classList.remove(Re.horizontalSlider),this.sliderContainer.classList.add(Re.verticalSlider),this.firstHandle.setAttribute("aria-orientation","vertical"),this.type==="Range"&&this.secondHandle.setAttribute("aria-orientation","vertical"))},t.prototype.setAriaAttributes=function(e){var i=this,r=this.min,n=this.max;if(!(0,a.le)(this.customValues)&&this.customValues.length>0&&(r=this.customValues[0],n=this.customValues[this.customValues.length-1]),this.type!=="Range")(0,a.Y4)(e,{"aria-valuemin":r.toString(),"aria-valuemax":n.toString()});else{var s=!(0,a.le)(this.customValues)&&this.customValues.length>0?[[r.toString(),this.customValues[this.value[1]].toString()],[this.customValues[this.value[0]].toString(),n.toString()]]:[[r.toString(),this.value[1].toString()],[this.value[0].toString(),n.toString()]];s.forEach(function(l,h){var c=h===0?i.firstHandle:i.secondHandle;c&&(0,a.Y4)(c,{"aria-valuemin":l[0],"aria-valuemax":l[1]})})}},t.prototype.createSecondHandle=function(){this.secondHandle=this.createElement("div",{attrs:{class:Re.sliderHandle,role:"slider",tabIndex:"0"}}),this.secondHandle.classList.add(Re.sliderSecondHandle),this.element.appendChild(this.secondHandle)},t.prototype.createFirstHandle=function(){this.firstHandle=this.createElement("div",{attrs:{class:Re.sliderHandle,role:"slider",tabIndex:"0"}}),this.firstHandle.classList.add(Re.sliderFirstHandle),this.element.appendChild(this.firstHandle),this.isMaterialTooltip&&(this.materialHandle=this.createElement("div",{attrs:{class:Re.sliderHandle+" "+Re.sliderMaterialHandle}}),this.element.appendChild(this.materialHandle))},t.prototype.wireFirstHandleEvt=function(e){e?(a.bi.remove(this.firstHandle,"mousedown touchstart",this.handleFocus),a.bi.remove(this.firstHandle,"transitionend",this.transitionEnd),a.bi.remove(this.firstHandle,"mouseenter touchenter",this.handleOver),a.bi.remove(this.firstHandle,"mouseleave touchend",this.handleLeave)):(a.bi.add(this.firstHandle,"mousedown touchstart",this.handleFocus,this),a.bi.add(this.firstHandle,"transitionend",this.transitionEnd,this),a.bi.add(this.firstHandle,"mouseenter touchenter",this.handleOver,this),a.bi.add(this.firstHandle,"mouseleave touchend",this.handleLeave,this))},t.prototype.wireSecondHandleEvt=function(e){e?(a.bi.remove(this.secondHandle,"mousedown touchstart",this.handleFocus),a.bi.remove(this.secondHandle,"transitionend",this.transitionEnd),a.bi.remove(this.secondHandle,"mouseenter touchenter",this.handleOver),a.bi.remove(this.secondHandle,"mouseleave touchend",this.handleLeave)):(a.bi.add(this.secondHandle,"mousedown touchstart",this.handleFocus,this),a.bi.add(this.secondHandle,"transitionend",this.transitionEnd,this),a.bi.add(this.secondHandle,"mouseenter touchenter",this.handleOver,this),a.bi.add(this.secondHandle,"mouseleave touchend",this.handleLeave,this))},t.prototype.handleStart=function(){this.type!=="Range"&&(this.firstHandle.classList[this.handlePos1===0?"add":"remove"](Re.sliderHandleStart),this.isMaterialTooltip&&(this.materialHandle.classList[this.handlePos1===0?"add":"remove"](Re.sliderHandleStart),this.tooltipElement&&this.tooltipElement.classList[this.handlePos1===0?"add":"remove"](Re.sliderTooltipStart)))},t.prototype.transitionEnd=function(e){e.propertyName!=="transform"&&(this.handleStart(),this.enableAnimation||(this.getHandle().style.transition="none"),this.type!=="Default"&&(this.rangeBar.style.transition="none"),this.isMaterial&&this.tooltip.isVisible&&this.type==="Default"&&(this.tooltipElement.style.transition=this.transition.handle),this.tooltipToggle(this.getHandle()),this.closeTooltip())},t.prototype.handleFocusOut=function(){this.firstHandle.classList.contains(Re.sliderHandleFocused)&&this.firstHandle.classList.remove(Re.sliderHandleFocused),this.type==="Range"&&this.secondHandle.classList.contains(Re.sliderHandleFocused)&&this.secondHandle.classList.remove(Re.sliderHandleFocused)},t.prototype.handleFocus=function(e){this.focusSliderElement(),this.sliderBarClick(e),e.currentTarget===this.firstHandle?(this.firstHandle.classList.add(Re.sliderHandleFocused),this.firstHandle.classList.add(Re.sliderTabHandle)):(this.secondHandle.classList.add(Re.sliderHandleFocused),this.secondHandle.classList.add(Re.sliderTabHandle)),a.bi.add(document,"mousemove touchmove",this.sliderBarMove,this),a.bi.add(document,"mouseup touchend",this.sliderBarUp,this)},t.prototype.handleOver=function(e){this.tooltip.isVisible&&this.tooltip.showOn==="Hover"&&this.tooltipToggle(e.currentTarget),this.type==="Default"&&this.tooltipToggle(this.getHandle())},t.prototype.handleLeave=function(e){this.tooltip.isVisible&&this.tooltip.showOn==="Hover"&&!e.currentTarget.classList.contains(Re.sliderHandleFocused)&&!e.currentTarget.classList.contains(Re.sliderTabHandle)&&this.closeTooltip()},t.prototype.setHandler=function(){this.min>this.max&&(this.min=this.max),this.createFirstHandle(),this.type==="Range"&&this.createSecondHandle()},t.prototype.setEnableRTL=function(){this.enableRtl&&this.orientation!=="Vertical"?(0,a.cn)([this.sliderContainer],Re.rtl):(0,a.IV)([this.sliderContainer],Re.rtl);var e=this.orientation!=="Vertical"?this.horDir:this.verDir;this.enableRtl?(this.horDir="right",this.verDir="bottom"):(this.horDir="left",this.verDir="bottom");var i=this.orientation!=="Vertical"?this.horDir:this.verDir;e!==i&&this.orientation==="Horizontal"&&((0,a.V7)(this.firstHandle,{right:"",left:"auto"}),this.type==="Range"&&(0,a.V7)(this.secondHandle,{top:"",left:"auto"})),this.setBarColor()},t.prototype.tooltipValue=function(){var e=this,i,r={value:this.value,text:""};this.initialTooltip&&(this.initialTooltip=!1,this.setTooltipContent(),r.text=i=this.tooltipObj.content,this.trigger("tooltipChange",r,function(n){e.addTooltipClass(n.text),i!==n.text&&(e.customAriaText=n.text,e.tooltipObj.content=n.text,e.setAriaAttrValue(e.firstHandle),e.type==="Range"&&e.setAriaAttrValue(e.secondHandle))}),this.isMaterialTooltip&&this.setPreviousVal("change",this.value))},t.prototype.setTooltipContent=function(){var e;e=this.formatContent(this.tooltipFormatInfo,!1),this.tooltipObj.content=e},t.prototype.formatContent=function(e,i){var r="",n=this.handleVal1,s=this.handleVal2;return!(0,a.le)(this.customValues)&&this.customValues.length>0&&(n=this.customValues[this.handleVal1],s=this.customValues[this.handleVal2]),i?(this.type==="Range"?this.enableRtl&&this.orientation!=="Vertical"?r=!(0,a.le)(this.tooltip)&&!(0,a.le)(this.tooltip.format)?this.formatString(s,e).elementVal+" - "+this.formatString(n,e).elementVal:s.toString()+" - "+n.toString():r=!(0,a.le)(this.tooltip)&&!(0,a.le)(this.tooltip.format)?this.formatString(n,e).elementVal+" - "+this.formatString(s,e).elementVal:n.toString()+" - "+s.toString():(0,a.le)(n)||(r=!(0,a.le)(this.tooltip)&&!(0,a.le)(this.tooltip.format)?this.formatString(n,e).elementVal:n.toString()),r):(this.type==="Range"?this.enableRtl&&this.orientation!=="Vertical"?r=(0,a.le)(e.format)?s.toString()+" - "+n.toString():this.formatString(s,e).formatString+" - "+this.formatString(n,e).formatString:r=(0,a.le)(e.format)?n.toString()+" - "+s.toString():this.formatString(n,e).formatString+" - "+this.formatString(s,e).formatString:(0,a.le)(n)||(r=(0,a.le)(e.format)?n.toString():this.formatString(n,e).formatString),r)},t.prototype.addTooltipClass=function(e){if(this.isMaterialTooltip){var i=e.toString().length;if(this.tooltipElement){var r=i>4?{oldCss:Re.sliderMaterialDefault,newCss:Re.sliderMaterialRange}:{oldCss:Re.sliderMaterialRange,newCss:Re.sliderMaterialDefault};this.tooltipElement.classList.remove(r.oldCss),this.tooltipElement.classList.contains(r.newCss)||(this.tooltipElement.classList.add(r.newCss),this.tooltipElement.style.transform=i>4?"scale(1)":this.getTooltipTransformProperties(this.previousTooltipClass).rotate)}else{var r=i>4?Re.sliderMaterialRange:Re.sliderMaterialDefault;this.tooltipObj.cssClass=Re.sliderTooltip+" "+r}}},t.prototype.tooltipPlacement=function(){return this.orientation==="Horizontal"?this.tooltip.placement==="Before"?"TopCenter":"BottomCenter":this.tooltip.placement==="Before"?"LeftCenter":"RightCenter"},t.prototype.tooltipBeforeOpen=function(e){this.tooltipElement=e.element,this.tooltip.cssClass&&(0,a.cn)([this.tooltipElement],this.tooltip.cssClass.split(" ").filter(function(i){return i})),e.target.removeAttribute("aria-describedby"),this.isMaterialTooltip&&(this.tooltipElement.firstElementChild.classList.add(Re.materialTooltipHide),this.handleStart(),this.setTooltipTransform())},t.prototype.tooltipCollision=function(e){if(this.isBootstrap||this.isBootstrap4||this.isMaterial&&!this.isMaterialTooltip){var i=this.isBootstrap4?cC:hC;switch(e){case"TopCenter":this.tooltipObj.setProperties({offsetY:-i},!1);break;case"BottomCenter":this.tooltipObj.setProperties({offsetY:i},!1);break;case"LeftCenter":this.tooltipObj.setProperties({offsetX:-i},!1);break;case"RightCenter":this.tooltipObj.setProperties({offsetX:i},!1);break}}},t.prototype.materialTooltipEventCallBack=function(e){this.sliderBarClick(e),a.bi.add(document,"mousemove touchmove",this.sliderBarMove,this),a.bi.add(document,"mouseup touchend",this.sliderBarUp,this)},t.prototype.wireMaterialTooltipEvent=function(e){this.isMaterialTooltip&&(e?a.bi.remove(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack):a.bi.add(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack,this))},t.prototype.tooltipPositionCalculation=function(e){var i;switch(e){case"TopCenter":i=Re.horizontalTooltipBefore;break;case"BottomCenter":i=Re.horizontalTooltipAfter;break;case"LeftCenter":i=Re.verticalTooltipBefore;break;case"RightCenter":i=Re.verticalTooltipAfter;break}return i},t.prototype.getTooltipTransformProperties=function(e){var i;if(this.tooltipElement){var r=this.orientation==="Horizontal"?this.tooltipElement.clientHeight+14-this.tooltipElement.clientHeight/2:this.tooltipElement.clientWidth+14-this.tooltipElement.clientWidth/2;i=this.orientation==="Horizontal"?e===Re.horizontalTooltipBefore?{rotate:"rotate(45deg)",translate:"translateY("+r+"px)"}:{rotate:"rotate(225deg)",translate:"translateY("+-r+"px)"}:e===Re.verticalTooltipBefore?{rotate:"rotate(-45deg)",translate:"translateX("+r+"px)"}:{rotate:"rotate(-225deg)",translate:"translateX("+-r+"px)"}}return i},t.prototype.openMaterialTooltip=function(){var e=this;if(this.isMaterialTooltip){this.refreshTooltip(this.firstHandle);var i=this.tooltipElement.firstElementChild;i.classList.remove(Re.materialTooltipHide),i.classList.add(Re.materialTooltipShow),this.firstHandle.style.cursor="default",this.tooltipElement.style.transition=this.scaleTransform,this.tooltipElement.classList.add(Re.materialTooltipOpen),this.materialHandle.style.transform="scale(0)",i.innerText.length>4?this.tooltipElement.style.transform="scale(1)":this.tooltipElement.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate,this.type==="Default"?setTimeout(function(){e.tooltipElement.style.transition=e.transition.handle},2500):setTimeout(function(){e.tooltipElement.style.transition="none"},2500)}},t.prototype.closeMaterialTooltip=function(){var e=this;if(this.isMaterialTooltip){var i=this.tooltipElement.firstElementChild;this.tooltipElement.style.transition=this.scaleTransform,i.classList.remove(Re.materialTooltipShow),i.classList.add(Re.materialTooltipHide),this.firstHandle.style.cursor="-webkit-grab",this.firstHandle.style.cursor="grab",this.materialHandle&&(this.materialHandle.style.transform="scale(1)"),this.tooltipElement.classList.remove(Re.materialTooltipOpen),this.setTooltipTransform(),this.tooltipTarget=void 0,setTimeout(function(){e.tooltipElement.style.transition="none"},2500)}},t.prototype.checkTooltipPosition=function(e){var i=this.tooltipPositionCalculation(e.collidedPosition);(this.tooltipCollidedPosition===void 0||this.tooltipCollidedPosition!==e.collidedPosition||!e.element.classList.contains(i))&&(this.isMaterialTooltip&&(i!==void 0&&(e.element.classList.remove(this.previousTooltipClass),e.element.classList.add(i),this.previousTooltipClass=i),e.element.style.transform&&e.element.classList.contains(Re.materialTooltipOpen)&&e.element.firstElementChild.innerText.length<=4&&(e.element.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate)),this.tooltipCollidedPosition=e.collidedPosition),this.isMaterialTooltip&&this.tooltipElement&&this.tooltipElement.style.transform.indexOf("translate")!==-1&&this.setTooltipTransform()},t.prototype.setTooltipTransform=function(){var e=this.getTooltipTransformProperties(this.previousTooltipClass);this.tooltipElement.firstElementChild.innerText.length>4?this.tooltipElement.style.transform=e.translate+" scale(0.01)":this.tooltipElement.style.transform=e.translate+" "+e.rotate+" scale(0.01)"},t.prototype.renderTooltip=function(){this.tooltipObj=new Lo({showTipPointer:this.isBootstrap||this.isMaterial||this.isBootstrap4||this.isTailwind||this.isBootstrap5||this.isFluent,cssClass:Re.sliderTooltip,height:this.isMaterial?30:"auto",animation:{open:{effect:"None"},close:{effect:"FadeOut",duration:500}},opensOn:"Custom",beforeOpen:this.tooltipBeforeOpen.bind(this),beforeCollision:this.checkTooltipPosition.bind(this),beforeClose:this.tooltipBeforeClose.bind(this),enableHtmlSanitizer:this.enableHtmlSanitizer}),this.tooltipObj.appendTo(this.firstHandle),this.initializeTooltipProps()},t.prototype.initializeTooltipProps=function(){var e=this.tooltip.showOn==="Auto"?"Hover":this.tooltip.showOn;this.setProperties({tooltip:{showOn:e}},!0),this.tooltipObj.position=this.tooltipPlacement(),this.tooltipCollision(this.tooltipObj.position),[this.firstHandle,this.rangeBar,this.secondHandle].forEach(function(i){(0,a.le)(i)||(i.style.transition="none")}),this.isMaterialTooltip&&(this.sliderContainer.classList.add(Re.materialSlider),this.tooltipValue(),this.tooltipObj.animation.close.effect="None",this.tooltipObj.open(this.firstHandle))},t.prototype.tooltipBeforeClose=function(){this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0},t.prototype.setButtons=function(){this.firstBtn=this.createElement("div",{className:Re.sliderButton+" "+Re.firstButton}),this.firstBtn.appendChild(this.createElement("span",{className:Re.sliderButtonIcon})),this.isTailwind&&this.firstBtn.querySelector("span").classList.add("e-icons"),this.firstBtn.tabIndex=-1,this.secondBtn=this.createElement("div",{className:Re.sliderButton+" "+Re.secondButton}),this.secondBtn.appendChild(this.createElement("span",{className:Re.sliderButtonIcon})),this.isTailwind&&this.secondBtn.querySelector("span").classList.add("e-icons"),this.secondBtn.tabIndex=-1,this.sliderContainer.classList.add(Re.sliderButtonClass),this.sliderContainer.appendChild(this.firstBtn),this.sliderContainer.appendChild(this.secondBtn),this.sliderContainer.appendChild(this.element),this.buttonTitle()},t.prototype.buttonTitle=function(){var e=this.enableRtl&&this.orientation!=="Vertical";this.l10n.setLocale(this.locale);var i=this.l10n.getConstant("decrementTitle"),r=this.l10n.getConstant("incrementTitle");(0,a.Y4)(e?this.secondBtn:this.firstBtn,{"aria-label":i,title:i}),(0,a.Y4)(e?this.firstBtn:this.secondBtn,{"aria-label":r,title:r})},t.prototype.buttonFocusOut=function(){this.isMaterial&&this.getHandle().classList.remove("e-large-thumb-size")},t.prototype.repeatButton=function(e){var i=this.handleValueUpdate(),r=this.enableRtl&&this.orientation!=="Vertical",n;e.target.parentElement.classList.contains(Re.firstButton)||e.target.classList.contains(Re.firstButton)?r?n=this.add(i,parseFloat(this.step.toString()),!0):n=this.add(i,parseFloat(this.step.toString()),!1):(e.target.parentElement.classList.contains(Re.secondButton)||e.target.classList.contains(Re.secondButton))&&(r?n=this.add(i,parseFloat(this.step.toString()),!1):n=this.add(i,parseFloat(this.step.toString()),!0)),this.limits.enabled&&(n=this.getLimitCorrectedValues(n)),n>=this.min&&n<=this.max&&(this.changeHandleValue(n),this.tooltipToggle(this.getHandle()))},t.prototype.repeatHandlerMouse=function(e){e.preventDefault(),(e.type==="mousedown"||e.type==="touchstart")&&(this.buttonClick(e),this.repeatInterval=setInterval(this.repeatButton.bind(this),180,e))},t.prototype.materialChange=function(){this.getHandle().classList.contains("e-large-thumb-size")||this.getHandle().classList.add("e-large-thumb-size")},t.prototype.focusHandle=function(){this.getHandle().classList.contains(Re.sliderTabHandle)||this.getHandle().classList.add(Re.sliderTabHandle)},t.prototype.repeatHandlerUp=function(e){this.changeEvent("changed",e),this.closeTooltip(),clearInterval(this.repeatInterval),this.getHandle().focus()},t.prototype.customTickCounter=function(e){var i=4;return!(0,a.le)(this.customValues)&&this.customValues.length>0&&(e>4&&(i=3),e>7&&(i=2),e>14&&(i=1),e>28&&(i=0)),i},t.prototype.renderScale=function(){var e=0,i=this.orientation==="Vertical"?"v":"h",r;this.noOfDecimals=this.numberOfDecimals(this.step),this.ul=this.createElement("ul",{className:Re.scale+" e-"+i+"-scale "+Re.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),this.ul.style.zIndex="-1",a.AR.isAndroid&&i==="h"&&this.ul.classList.add(Re.sliderTickPosition);var n=this.ticks.smallStep;this.ticks.showSmallTicks?n<=0&&(n=parseFloat((0,a.Ac)(this.step))):this.ticks.largeStep>0?n=this.ticks.largeStep:n=parseFloat((0,a.Ac)(this.max))-parseFloat((0,a.Ac)(this.min));var s=this.fractionalToInteger(this.min),l=this.fractionalToInteger(this.max),h=this.fractionalToInteger(n),c=!(0,a.le)(this.customValues)&&this.customValues.length>0&&this.customValues.length-1,u=this.customTickCounter(c),p=!(0,a.le)(this.customValues)&&this.customValues.length>0?c*u+c:Math.abs((l-s)/h);this.element.appendChild(this.ul);var f,g=parseFloat(this.min.toString());i==="v"&&(g=parseFloat(this.max.toString()));var C=0,L,D=100/p;D===Infinity&&(D=5);for(var R=0,B=!(0,a.le)(this.customValues)&&this.customValues.length>0?this.customValues.length-1:0,H=0;R<=p;R++){if(f=this.createElement("li",{attrs:{class:Re.tick,role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),!(0,a.le)(this.customValues)&&this.customValues.length>0)L=R%(u+1)==0,L&&(i==="h"?(g=this.customValues[H],H++):(g=this.customValues[B],B--),f.setAttribute("title",g.toString()));else if(f.setAttribute("title",g.toString()),this.numberOfDecimals(this.max)===0&&this.numberOfDecimals(this.min)===0&&this.numberOfDecimals(this.step)===0)i==="h"?L=(g-parseFloat(this.min.toString()))%this.ticks.largeStep==0:L=Math.abs(g-parseFloat(this.max.toString()))%this.ticks.largeStep==0;else{var j=this.fractionalToInteger(this.ticks.largeStep),W=this.fractionalToInteger(g);i==="h"?L=(W-s)%j==0:L=Math.abs(W-parseFloat(l.toString()))%j==0}L&&f.classList.add(Re.large),i==="h"?f.style.width=D+"%":f.style.height=D+"%";var ne=L?this.ticks.placement==="Both"?2:1:0;if(L)for(var ie=0;ie<ne;ie++)this.createTick(f,g,D);else(0,a.le)(this.customValues)&&this.formatTicksValue(f,g);this.ul.appendChild(f),this.tickElementCollection.push(f);var me=void 0;(0,a.le)(this.customValues)&&(this.numberOfDecimals(n)>this.numberOfDecimals(g)?me=this.numberOfDecimals(n):me=this.numberOfDecimals(g),i==="h"?g=this.makeRoundNumber(g+n,me):g=this.makeRoundNumber(g-n,me),C=this.makeRoundNumber(C+n,me))}this.ticksAlignment(i,D)},t.prototype.ticksAlignment=function(e,i,r){r===void 0&&(r=!0),this.firstChild=this.ul.firstElementChild,this.lastChild=this.ul.lastElementChild,this.firstChild.classList.add(Re.sliderFirstTick),this.lastChild.classList.add(Re.sliderLastTick),this.sliderContainer.classList.add(Re.scale+"-"+this.ticks.placement.toLowerCase()),e==="h"?(this.firstChild.style.width=i/2+"%",this.lastChild.style.width=i/2+"%"):(this.firstChild.style.height=i/2+"%",this.lastChild.style.height=i/2+"%");var n={ticksWrapper:this.ul,tickElements:this.tickElementCollection};r&&this.trigger("renderedTicks",n),this.scaleAlignment()},t.prototype.createTick=function(e,i,r){var n=this.createElement("span",{className:Re.tickValue+" "+Re.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}});e.appendChild(n),(0,a.le)(this.customValues)?this.formatTicksValue(e,i,n,r):this.enableHtmlSanitizer?n.innerHTML=a.pJ.sanitize(i.toString()):n.innerHTML=i.toString()},t.prototype.formatTicksValue=function(e,i,r,n){var s=this,l=this.formatNumber(i),h=!(0,a.le)(this.ticks)&&!(0,a.le)(this.ticks.format)?this.formatString(i,this.ticksFormatInfo).formatString:l,c={value:i,text:h,tickElement:e};this.trigger("renderingTicks",c,function(u){e.setAttribute("title",u.text.toString()),r&&(s.enableHtmlSanitizer?r.innerHTML=a.pJ.sanitize(u.text.toString()):r.innerHTML=u.text.toString())})},t.prototype.scaleAlignment=function(){this.tickValuePosition();var e=12,i=20,r=i/2,n=this.orientation==="Vertical"?"v":"h";this.orientation==="Vertical"?this.element.getBoundingClientRect().width<=15?this.sliderContainer.classList.add(Re.sliderSmallSize):this.sliderContainer.classList.remove(Re.sliderSmallSize):this.element.getBoundingClientRect().height<=15?this.sliderContainer.classList.add(Re.sliderSmallSize):this.sliderContainer.classList.remove(Re.sliderSmallSize)},t.prototype.tickValuePosition=function(){this.firstChild=this.element.querySelector("ul").children[0];var e=this.firstChild.getBoundingClientRect(),i,r,n=this.ticks.smallStep,s=Math.abs(parseFloat((0,a.Ac)(this.max))-parseFloat((0,a.Ac)(this.min)))/n;this.firstChild.children.length>0&&(i=this.firstChild.children[0].getBoundingClientRect());var l=[this.sliderContainer.querySelectorAll("."+Re.tick+"."+Re.large+" ."+Re.tickValue)],h;this.ticks.placement==="Both"?h=[].slice.call(l[0],2):h=[].slice.call(l[0],1);for(var c=this.orientation==="Vertical"?e.height*2:e.width*2,u=0;u<this.firstChild.children.length;u++)this.orientation==="Vertical"?this.firstChild.children[u].style.top=-(i.height/2)+"px":this.enableRtl?this.firstChild.children[u].style.left=(c-this.firstChild.children[u].getBoundingClientRect().width)/2+"px":this.firstChild.children[u].style.left=-(i.width/2)+"px";for(var u=0;u<h.length;u++)r=h[u].getBoundingClientRect(),this.orientation==="Vertical"?(0,a.V7)(h[u],{top:(c-r.height)/2+"px"}):(0,a.V7)(h[u],{left:(c-r.width)/2+"px"});this.enableRtl&&this.lastChild.children.length&&s!==0&&(this.lastChild.children[0].style.left=-(this.lastChild.getBoundingClientRect().width/2)+"px",this.ticks.placement==="Both"&&(this.lastChild.children[1].style.left=-(this.lastChild.getBoundingClientRect().width/2)+"px")),s===0&&(this.orientation==="Horizontal"&&(this.enableRtl?(this.firstChild.classList.remove(Re.sliderLastTick),this.firstChild.style.right=this.firstHandle.style.right,this.firstChild.children[0].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px",this.ticks.placement==="Both"&&(this.firstChild.children[1].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px")):(this.firstChild.classList.remove(Re.sliderLastTick),this.firstChild.style.left=this.firstHandle.style.left)),this.orientation==="Vertical"&&this.firstChild.classList.remove(Re.sliderLastTick))},t.prototype.setAriaAttrValue=function(e){var i,r=!(0,a.le)(this.ticks)&&!(0,a.le)(this.ticks.format),n=r?this.formatContent(this.tooltipFormatInfo,!1):this.formatContent(this.ticksFormatInfo,!1),s=r?this.formatContent(this.ticksFormatInfo,!0):this.formatContent(this.tooltipFormatInfo,!0);n=this.customAriaText?this.customAriaText:n,n.split(" - ").length===2?i=n.split(" - "):i=[n,n],this.setAriaAttributes(e),this.type!=="Range"?(0,a.Y4)(e,{"aria-valuenow":s,"aria-valuetext":n}):this.enableRtl?e===this.firstHandle?(0,a.Y4)(e,{"aria-valuenow":s.split(" - ")[1],"aria-valuetext":i[1]}):(0,a.Y4)(e,{"aria-valuenow":s.split(" - ")[0],"aria-valuetext":i[0]}):e===this.firstHandle?(0,a.Y4)(e,{"aria-valuenow":s.split(" - ")[0],"aria-valuetext":i[0]}):(0,a.Y4)(e,{"aria-valuenow":s.split(" - ")[1],"aria-valuetext":i[1]})},t.prototype.handleValueUpdate=function(){var e;return this.type==="Range"?this.activeHandle===1?e=this.handleVal1:e=this.handleVal2:e=this.handleVal1,e},t.prototype.getLimitCorrectedValues=function(e){return this.type==="MinRange"||this.type==="Default"?e=this.getLimitValueAndPosition(e,this.limits.minStart,this.limits.minEnd)[0]:this.activeHandle===1?e=this.getLimitValueAndPosition(e,this.limits.minStart,this.limits.minEnd)[0]:e=this.getLimitValueAndPosition(e,this.limits.maxStart,this.limits.maxEnd)[0],e},t.prototype.focusSliderElement=function(){this.isElementFocused||(this.element.focus(),this.isElementFocused=!0)},t.prototype.buttonClick=function(e){this.focusSliderElement();var i,r=this.enableRtl&&this.orientation!=="Vertical",n=this.handleValueUpdate();e.keyCode===40||e.keyCode===37||e.currentTarget.classList.contains(Re.firstButton)?r?i=this.add(n,parseFloat(this.step.toString()),!0):i=this.add(n,parseFloat(this.step.toString()),!1):e.keyCode===38||e.keyCode===39||e.currentTarget.classList.contains(Re.secondButton)?r?i=this.add(n,parseFloat(this.step.toString()),!1):i=this.add(n,parseFloat(this.step.toString()),!0):e.keyCode===33||e.currentTarget.classList.contains(Re.firstButton)?r?i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):e.keyCode===34||e.currentTarget.classList.contains(Re.secondButton)?r?i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!0):i=this.add(n,parseFloat(this.ticks.largeStep.toString()),!1):e.keyCode===36?i=parseFloat(this.min.toString()):e.keyCode===35&&(i=parseFloat(this.max.toString())),this.limits.enabled&&(i=this.getLimitCorrectedValues(i)),this.changeHandleValue(i),this.isMaterial&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(Re.sliderTabHandle)&&this.materialChange(),this.tooltipToggle(this.getHandle()),this.getHandle().focus(),this.focusHandle(),e.currentTarget.classList.contains(Re.firstButton)&&a.bi.add(this.firstBtn,"mouseup touchend",this.buttonUp,this),e.currentTarget.classList.contains(Re.secondButton)&&a.bi.add(this.secondBtn,"mouseup touchend",this.buttonUp,this)},t.prototype.tooltipToggle=function(e){this.isMaterialTooltip?this.tooltipElement.classList.contains(Re.materialTooltipOpen)?this.refreshTooltip(this.firstHandle):this.openMaterialTooltip():this.tooltipElement?this.refreshTooltip(e):this.openTooltip(e)},t.prototype.buttonUp=function(e){e.currentTarget.classList.contains(Re.firstButton)&&a.bi.remove(this.firstBtn,"mouseup touchend",this.buttonUp),e.currentTarget.classList.contains(Re.secondButton)&&a.bi.remove(this.secondBtn,"mouseup touchend",this.buttonUp)},t.prototype.setRangeBar=function(){this.orientation==="Horizontal"?this.type==="MinRange"?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",(0,a.V7)(this.rangeBar,{width:(0,a.le)(this.handlePos1)?0:this.handlePos1+"px"})):(this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",(0,a.V7)(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"})):this.type==="MinRange"?(this.rangeBar.style.bottom="0px",(0,a.V7)(this.rangeBar,{height:(0,a.le)(this.handlePos1)?0:this.handlePos1+"px"})):(this.rangeBar.style.bottom=this.handlePos1+"px",(0,a.V7)(this.rangeBar,{height:this.handlePos2-this.handlePos1+"px"}))},t.prototype.checkValidValueAndPos=function(e){return e=this.checkHandleValue(e),e=this.checkHandlePosition(e),e},t.prototype.setLimitBarPositions=function(e,i,r,n){this.orientation==="Horizontal"?this.enableRtl?(this.limitBarFirst.style.right=e+"px",this.limitBarFirst.style.width=i-e+"px"):(this.limitBarFirst.style.left=e+"px",this.limitBarFirst.style.width=i-e+"px"):(this.limitBarFirst.style.bottom=e+"px",this.limitBarFirst.style.height=i-e+"px"),this.type==="Range"&&(this.orientation==="Horizontal"?this.enableRtl?(this.limitBarSecond.style.right=r+"px",this.limitBarSecond.style.width=n-r+"px"):(this.limitBarSecond.style.left=r+"px",this.limitBarSecond.style.width=n-r+"px"):(this.limitBarSecond.style.bottom=r+"px",this.limitBarSecond.style.height=n-r+"px"))},t.prototype.setLimitBar=function(){if(this.type==="Default"||this.type==="MinRange"){var e=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];e=this.checkValidValueAndPos(e);var i=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];i=this.checkValidValueAndPos(i),this.setLimitBarPositions(e,i)}else if(this.type==="Range"){var r=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];r=this.checkValidValueAndPos(r);var n=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];n=this.checkValidValueAndPos(n);var s=this.getLimitValueAndPosition(this.limits.maxStart,this.limits.maxStart,this.limits.maxEnd,!0)[0];s=this.checkValidValueAndPos(s);var l=this.getLimitValueAndPosition(this.limits.maxEnd,this.limits.maxStart,this.limits.maxEnd,!0)[0];l=this.checkValidValueAndPos(l),this.setLimitBarPositions(r,n,s,l)}},t.prototype.getLimitValueAndPosition=function(e,i,r,n){return(0,a.le)(i)&&(i=this.min,(0,a.le)(e)&&n&&(e=i)),(0,a.le)(r)&&(r=this.max,(0,a.le)(e)&&n&&(e=r)),e<i&&(e=i),e>r&&(e=r),[e,this.checkHandlePosition(e)]},t.prototype.setValue=function(){if(!(0,a.le)(this.customValues)&&this.customValues.length>0&&(this.min=0,this.max=this.customValues.length-1,this.setBarColor()),this.setAriaAttributes(this.firstHandle),this.handleVal1=(0,a.le)(this.value)?this.checkHandleValue(parseFloat(this.min.toString())):this.checkHandleValue(parseFloat(this.value.toString())),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.preHandlePos1=this.handlePos1,(0,a.le)(this.activeHandle)?this.type==="Range"?this.activeHandle=2:this.activeHandle=1:this.activeHandle=this.activeHandle,this.type==="Default"||this.type==="MinRange"){if(this.limits.enabled){var e=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=e[0],this.handlePos1=e[1],this.preHandlePos1=this.handlePos1}this.setHandlePosition(null),this.handleStart(),this.value=this.handleVal1,this.setAriaAttrValue(this.firstHandle),this.changeEvent("changed",null)}else this.validateRangeValue();this.type!=="Default"&&this.setRangeBar(),this.limits.enabled&&this.setLimitBar()},t.prototype.rangeValueUpdate=function(){(this.value===null||typeof this.value!="object")&&(this.value=[parseFloat((0,a.Ac)(this.min)),parseFloat((0,a.Ac)(this.max))])},t.prototype.validateRangeValue=function(){this.rangeValueUpdate(),this.setRangeValue()},t.prototype.modifyZindex=function(){this.type==="Range"?this.activeHandle===1?(this.firstHandle.style.zIndex=this.zIndex+4+"",this.secondHandle.style.zIndex=this.zIndex+3+""):(this.firstHandle.style.zIndex=this.zIndex+3+"",this.secondHandle.style.zIndex=this.zIndex+4+""):this.isMaterialTooltip&&this.tooltipElement&&(this.tooltipElement.style.zIndex=cn(this.element)+"")},t.prototype.setHandlePosition=function(e){var i=this,r,n=this.activeHandle===1?this.handlePos1:this.handlePos2;this.isMaterialTooltip?r=[this.firstHandle,this.materialHandle]:r=[this.getHandle()],this.handleStart(),r.forEach(function(s){i.orientation==="Horizontal"?i.enableRtl?s.style.right=n+"px":s.style.left=n+"px":s.style.bottom=n+"px"}),this.changeEvent("change",e)},t.prototype.getHandle=function(){return this.activeHandle===1?this.firstHandle:this.secondHandle},t.prototype.setRangeValue=function(){this.updateRangeValue(),this.activeHandle=1,this.setHandlePosition(null),this.activeHandle=2,this.setHandlePosition(null),this.activeHandle=1},t.prototype.changeEvent=function(e,i){var r=e==="change"?this.previousVal:this.previousChanged;if(this.type!=="Range")this.setProperties({value:this.handleVal1},!0),r!==this.value&&(!this.isMaterialTooltip||!this.initialTooltip)&&(this.trigger(e,this.changeEventArgs(e,i)),this.initialTooltip=!0,this.setPreviousVal(e,this.value)),this.setAriaAttrValue(this.firstHandle);else{var n=this.value=[this.handleVal1,this.handleVal2];this.setProperties({value:n},!0),(r.length===this.value.length&&this.value[0]!==r[0]||this.value[1]!==r[1])&&(this.initialTooltip=!1,this.trigger(e,this.changeEventArgs(e,i)),this.initialTooltip=!0,this.setPreviousVal(e,this.value)),this.setAriaAttrValue(this.getHandle())}this.hiddenInput.value=this.value.toString()},t.prototype.changeEventArgs=function(e,i){var r;return this.tooltip.isVisible&&this.tooltipObj&&this.initialTooltip?(this.tooltipValue(),r={value:this.value,previousValue:e==="change"?this.previousVal:this.previousChanged,action:e,text:this.tooltipObj.content,isInteracted:!(0,a.le)(i)}):r={value:this.value,previousValue:e==="change"?this.previousVal:this.previousChanged,action:e,text:(0,a.le)(this.ticksFormatInfo.format)?this.value.toString():this.type!=="Range"?this.formatString(this.value,this.ticksFormatInfo).formatString:this.formatString(this.value[0],this.ticksFormatInfo).formatString+" - "+this.formatString(this.value[1],this.ticksFormatInfo).formatString,isInteracted:!(0,a.le)(i)},r},t.prototype.setPreviousVal=function(e,i){e==="change"?this.previousVal=i:this.previousChanged=i},t.prototype.updateRangeValue=function(){var e=this.value.toString().split(",").map(Number);if(this.enableRtl&&this.orientation!=="Vertical"||this.rtl?this.value=[e[1],e[0]]:this.value=[e[0],e[1]],this.enableRtl&&this.orientation!=="Vertical"?(this.handleVal1=this.checkHandleValue(this.value[1]),this.handleVal2=this.checkHandleValue(this.value[0])):(this.handleVal1=this.checkHandleValue(this.value[0]),this.handleVal2=this.checkHandleValue(this.value[1])),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.preHandlePos1=this.handlePos1,this.preHandlePos2=this.handlePos2,this.limits.enabled){this.activeHandle=1;var i=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=i[0],this.handlePos1=i[1],this.preHandlePos1=this.handlePos1,this.activeHandle=2,i=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=i[0],this.handlePos2=i[1],this.preHandlePos2=this.handlePos2}},t.prototype.checkHandlePosition=function(e){var i;return e=100*(e-parseFloat((0,a.Ac)(this.min)))/(parseFloat((0,a.Ac)(this.max))-parseFloat((0,a.Ac)(this.min))),this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width*(e/100):i=this.element.getBoundingClientRect().height*(e/100),parseFloat((0,a.Ac)(this.max))===parseFloat((0,a.Ac)(this.min))&&(this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width:i=this.element.getBoundingClientRect().height),i},t.prototype.checkHandleValue=function(e){if(this.min>this.max&&(this.min=this.max),this.min===this.max)return parseFloat((0,a.Ac)(this.max));var i=this.tempStartEnd();return e<i.start?e=i.start:e>i.end&&(e=i.end),e},t.prototype.reposition=function(){var e=this;this.firstHandle.style.transition="none",this.type!=="Default"&&(this.rangeBar.style.transition="none"),this.type==="Range"&&(this.secondHandle.style.transition="none"),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handleVal2&&(this.handlePos2=this.checkHandlePosition(this.handleVal2)),this.orientation==="Horizontal"?(this.enableRtl?this.firstHandle.style.right=this.handlePos1+"px":this.firstHandle.style.left=this.handlePos1+"px",this.isMaterialTooltip&&(this.enableRtl?this.materialHandle.style.right=this.handlePos1+"px":this.materialHandle.style.left=this.handlePos1+"px"),this.type==="MinRange"?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",(0,a.V7)(this.rangeBar,{width:(0,a.le)(this.handlePos1)?0:this.handlePos1+"px"})):this.type==="Range"&&(this.enableRtl?this.secondHandle.style.right=this.handlePos2+"px":this.secondHandle.style.left=this.handlePos2+"px",this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",(0,a.V7)(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"}))):(this.firstHandle.style.bottom=this.handlePos1+"px",this.isMaterialTooltip&&(this.materialHandle.style.bottom=this.handlePos1+"px"),this.type==="MinRange"?(this.rangeBar.style.bottom="0px",(0,a.V7)(this.rangeBar,{height:(0,a.le)(this.handlePos1)?0:this.handlePos1+"px"})):this.type==="Range"&&(this.secondHandle.style.bottom=this.handlePos2+"px",this.rangeBar.style.bottom=this.handlePos1+"px",(0,a.V7)(this.rangeBar,{height:this.handlePos2-this.handlePos1+"px"}))),this.limits.enabled&&this.setLimitBar(),this.ticks.placement!=="None"&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.handleStart(),this.tooltip.isVisible||setTimeout(function(){e.firstHandle.style.transition=e.scaleTransform,e.type==="Range"&&(e.secondHandle.style.transition=e.scaleTransform)}),this.refreshTooltip(this.tooltipTarget),this.setBarColor()},t.prototype.changeHandleValue=function(e){var i=null;this.activeHandle===1?(this.limits.enabled&&this.limits.startHandleFixed||(this.handleVal1=this.checkHandleValue(e),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.type==="Range"&&this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.handlePos1!==this.preHandlePos1&&(i=this.preHandlePos1=this.handlePos1)),this.modifyZindex()):(this.limits.enabled&&this.limits.endHandleFixed||(this.handleVal2=this.checkHandleValue(e),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.type==="Range"&&this.handlePos2<this.handlePos1&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.handlePos2!==this.preHandlePos2&&(i=this.preHandlePos2=this.handlePos2)),this.modifyZindex()),i!==null&&(this.type!=="Default"&&this.setRangeBar(),this.setHandlePosition(null))},t.prototype.tempStartEnd=function(){return this.min>this.max?{start:this.max,end:this.min}:{start:this.min,end:this.max}},t.prototype.xyToPosition=function(e){var i;if(this.min===this.max)return 100;if(this.orientation==="Horizontal"){var r=e.x-this.element.getBoundingClientRect().left,n=this.element.offsetWidth/100;this.val=r/n}else{var s=e.y-this.element.getBoundingClientRect().top,n=this.element.offsetHeight/100;this.val=100-s/n}var l=this.stepValueCalculation(this.val);return l<0?l=0:l>100&&(l=100),this.enableRtl&&this.orientation!=="Vertical"&&(l=100-l),this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width*(l/100):i=this.element.getBoundingClientRect().height*(l/100),i},t.prototype.stepValueCalculation=function(e){this.step===0&&(this.step=1);var i=parseFloat((0,a.Ac)(this.step))/((parseFloat((0,a.Ac)(this.max))-parseFloat((0,a.Ac)(this.min)))/100),r=e%Math.abs(i);return r!==0&&(i/2>r?e-=r:e+=Math.abs(i)-r),e},t.prototype.add=function(e,i,r){var n,s=Math.pow(10,n||3),l;return r?l=(Math.round(e*s)+Math.round(i*s))/s:l=(Math.round(e*s)-Math.round(i*s))/s,l},t.prototype.positionToValue=function(e){var i,r=parseFloat((0,a.Ac)(this.max))-parseFloat((0,a.Ac)(this.min));this.orientation==="Horizontal"?i=e/this.element.getBoundingClientRect().width*r:i=e/this.element.getBoundingClientRect().height*r;var n=this.add(i,parseFloat(this.min.toString()),!0);return n},t.prototype.sliderBarClick=function(e){e.preventDefault();var i;e.type==="mousedown"||e.type==="mouseup"||e.type==="click"?i={x:e.clientX,y:e.clientY}:(e.type==="touchend"||e.type==="touchstart")&&(i={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY});var r=this.xyToPosition(i),n=this.positionToValue(r);if(this.type==="Range"&&this.handlePos2-r<r-this.handlePos1){if(this.activeHandle=2,!(this.limits.enabled&&this.limits.endHandleFixed)){if(this.limits.enabled){var s=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd);n=s[0],r=s[1]}this.secondHandle.classList.add(Re.sliderActiveHandle),this.handlePos2=this.preHandlePos2=r,this.handleVal2=n}this.modifyZindex(),this.secondHandle.focus()}else{if(this.activeHandle=1,!(this.limits.enabled&&this.limits.startHandleFixed)){if(this.limits.enabled){var s=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);n=s[0],r=s[1]}this.firstHandle.classList.add(Re.sliderActiveHandle),this.handlePos1=this.preHandlePos1=r,this.handleVal1=n}this.modifyZindex(),this.firstHandle.focus()}this.isMaterialTooltip&&this.tooltipElement.classList.add(Re.materialTooltipActive);var l=this.element.querySelector("."+Re.sliderTabHandle);l&&this.getHandle()!==l&&l.classList.remove(Re.sliderTabHandle);var h=this.activeHandle===1?this.firstHandle:this.secondHandle;if(e.target===h){this.isMaterial&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(Re.sliderTabHandle)&&this.materialChange(),this.sliderBarUp(e),this.tooltipToggle(this.getHandle());return}if(!!this.checkRepeatedValue(n)){var c=this.isMaterial&&this.tooltip.isVisible?this.transitionOnMaterialTooltip:this.transition;this.getHandle().style.transition=c.handle,this.type!=="Default"&&(this.rangeBar.style.transition=c.rangeBar),this.setHandlePosition(e),this.isMaterialTooltip&&(this.initialTooltip=!1),this.changeEvent("changed",e),this.type!=="Default"&&this.setRangeBar()}},t.prototype.handleValueAdjust=function(e,i,r){r===1?(this.handleVal1=i,this.handleVal2=this.handleVal1+this.minDiff):r===2&&(this.handleVal2=i,this.handleVal1=this.handleVal2-this.minDiff),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2)},t.prototype.dragRangeBarMove=function(e){var i,r;e.type!=="touchmove"&&e.preventDefault(),this.rangeBarDragged=!0;var n;this.rangeBar.style.transition="none",this.firstHandle.style.transition="none",this.secondHandle.style.transition="none";var s,l;if(e.type==="mousemove"?(i=[e.clientX,e.clientY],s=i[0],l=i[1]):(r=[e.changedTouches[0].clientX,e.changedTouches[0].clientY],s=r[0],l=r[1]),!(this.limits.enabled&&this.limits.startHandleFixed)&&!(this.limits.enabled&&this.limits.endHandleFixed)){if(this.enableRtl?n={x:s+this.secondPartRemain,y:l+this.secondPartRemain}:n={x:s-this.firstPartRemain,y:l+this.secondPartRemain},this.handlePos1=this.xyToPosition(n),this.handleVal1=this.positionToValue(this.handlePos1),this.enableRtl?n={x:s-this.firstPartRemain,y:l-this.firstPartRemain}:n={x:s+this.secondPartRemain,y:l-this.firstPartRemain},this.handlePos2=this.xyToPosition(n),this.handleVal2=this.positionToValue(this.handlePos2),this.limits.enabled){var h=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=h[0],this.handlePos1=h[1],this.handleVal1===this.limits.minEnd&&this.handleValueAdjust(this.handleVal1,this.limits.minEnd,1),this.handleVal1===this.limits.minStart&&this.handleValueAdjust(this.handleVal1,this.limits.minStart,1),h=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=h[0],this.handlePos2=h[1],this.handleVal2===this.limits.maxStart&&this.handleValueAdjust(this.handleVal2,this.limits.maxStart,2),this.handleVal2===this.limits.maxEnd&&this.handleValueAdjust(this.handleVal2,this.limits.maxEnd,2)}this.handleVal2===this.max&&this.handleValueAdjust(this.handleVal2,this.max,2),this.handleVal1===this.min&&this.handleValueAdjust(this.handleVal1,this.min,1)}this.activeHandle=1,this.setHandlePosition(e),this.activeHandle=2,this.setHandlePosition(e),this.tooltipToggle(this.rangeBar),this.setRangeBar()},t.prototype.sliderBarUp=function(e){this.changeEvent("changed",e),this.handleFocusOut(),this.firstHandle.classList.remove(Re.sliderActiveHandle),this.type==="Range"&&(this.initialTooltip=!1,this.secondHandle.classList.remove(Re.sliderActiveHandle)),this.closeTooltip(),this.isMaterial&&(this.getHandle().classList.remove("e-large-thumb-size"),this.isMaterialTooltip&&this.tooltipElement.classList.remove(Re.materialTooltipActive)),a.bi.remove(document,"mousemove touchmove",this.sliderBarMove),a.bi.remove(document,"mouseup touchend",this.sliderBarUp)},t.prototype.sliderBarMove=function(e){e.type!=="touchmove"&&e.preventDefault();var i;e.type==="mousemove"?i={x:e.clientX,y:e.clientY}:i={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY};var r=this.xyToPosition(i),n=this.positionToValue(r);if(r=Math.round(r),this.type!=="Range"&&this.activeHandle===1){if(!(this.limits.enabled&&this.limits.startHandleFixed)){if(this.limits.enabled){var s=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);r=s[1],n=s[0]}this.handlePos1=r,this.handleVal1=n}this.firstHandle.classList.add(Re.sliderActiveHandle)}if(this.type==="Range"){if(this.activeHandle===1){if(this.firstHandle.classList.add(Re.sliderActiveHandle),!(this.limits.enabled&&this.limits.startHandleFixed)&&(r>this.handlePos2&&(r=this.handlePos2,n=this.handleVal2),r!==this.preHandlePos1)){if(this.limits.enabled){var l=this.getLimitValueAndPosition(n,this.limits.minStart,this.limits.minEnd);n=l[0],r=l[1]}this.handlePos1=this.preHandlePos1=r,this.handleVal1=n,this.activeHandle=1}}else if(this.activeHandle===2&&(this.secondHandle.classList.add(Re.sliderActiveHandle),!(this.limits.enabled&&this.limits.endHandleFixed)&&(r<this.handlePos1&&(r=this.handlePos1,n=this.handleVal1),r!==this.preHandlePos2))){if(this.limits.enabled){var l=this.getLimitValueAndPosition(n,this.limits.maxStart,this.limits.maxEnd);n=l[0],r=l[1]}this.handlePos2=this.preHandlePos2=r,this.handleVal2=n,this.activeHandle=2}}!this.checkRepeatedValue(n)||(this.getHandle().style.transition=this.scaleTransform,this.type!=="Default"&&(this.rangeBar.style.transition="none"),this.setHandlePosition(e),this.isMaterial&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(Re.sliderTabHandle)&&this.materialChange(),this.tooltipToggle(this.getHandle()),this.type!=="Default"&&this.setRangeBar())},t.prototype.dragRangeBarUp=function(e){this.rangeBarDragged?this.isDragComplete=!0:(this.focusSliderElement(),this.sliderBarClick(e)),this.changeEvent("changed",e),this.closeTooltip(),a.bi.remove(document,"mousemove touchmove",this.dragRangeBarMove),a.bi.remove(document,"mouseup touchend",this.dragRangeBarUp),this.rangeBarDragged=!1},t.prototype.checkRepeatedValue=function(e){if(this.type==="Range"){var i=this.enableRtl&&this.orientation!=="Vertical"?this.activeHandle===1?this.previousVal[1]:this.previousVal[0]:this.activeHandle===1?this.previousVal[0]:this.previousVal[1];if(e===i)return 0}else if(e===this.previousVal)return 0;return 1},t.prototype.refreshTooltip=function(e){this.tooltip.isVisible&&this.tooltipObj&&(this.tooltipValue(),e&&(this.tooltipObj.refresh(e),this.tooltipTarget=e))},t.prototype.openTooltip=function(e){this.tooltip.isVisible&&this.tooltipObj&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.open(e),this.tooltipTarget=e)},t.prototype.closeTooltip=function(){this.tooltip.isVisible&&this.tooltipObj&&this.tooltip.showOn!=="Always"&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.close(),this.tooltipTarget=void 0)},t.prototype.keyDown=function(e){switch(e.keyCode){case 37:case 38:case 39:case 40:case 33:case 34:case 36:case 35:e.preventDefault(),this.buttonClick(e);break}},t.prototype.wireButtonEvt=function(e){e?(a.bi.remove(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut),a.bi.remove(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut),a.bi.remove(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse),a.bi.remove(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),a.bi.remove(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse),a.bi.remove(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),a.bi.remove(this.firstBtn,"focusout",this.sliderFocusOut),a.bi.remove(this.secondBtn,"focusout",this.sliderFocusOut)):(a.bi.add(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut,this),a.bi.add(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut,this),a.bi.add(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse,this),a.bi.add(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),a.bi.add(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse,this),a.bi.add(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),a.bi.add(this.firstBtn,"focusout",this.sliderFocusOut,this),a.bi.add(this.secondBtn,"focusout",this.sliderFocusOut,this))},t.prototype.rangeBarMousedown=function(e){var i,r;if(e.preventDefault(),this.focusSliderElement(),this.type==="Range"&&this.drag&&e.target===this.rangeBar){var n=void 0,s=void 0;e.type==="mousedown"?(i=[e.clientX,e.clientY],n=i[0],s=i[1]):e.type==="touchstart"&&(r=[e.changedTouches[0].clientX,e.changedTouches[0].clientY],n=r[0],s=r[1]),this.orientation==="Horizontal"?(this.firstPartRemain=n-this.rangeBar.getBoundingClientRect().left,this.secondPartRemain=this.rangeBar.getBoundingClientRect().right-n):(this.firstPartRemain=s-this.rangeBar.getBoundingClientRect().top,this.secondPartRemain=this.rangeBar.getBoundingClientRect().bottom-s),this.minDiff=this.handleVal2-this.handleVal1,this.tooltipToggle(this.rangeBar);var l=this.element.querySelector("."+Re.sliderTabHandle);l&&l.classList.remove(Re.sliderTabHandle),a.bi.add(document,"mousemove touchmove",this.dragRangeBarMove,this),a.bi.add(document,"mouseup touchend",this.dragRangeBarUp,this)}},t.prototype.elementClick=function(e){if(this.isDragComplete){this.isDragComplete=!1;return}e.preventDefault(),this.focusSliderElement(),this.sliderBarClick(e),this.focusHandle()},t.prototype.wireEvents=function(){this.onresize=this.reposition.bind(this),window.addEventListener("resize",this.onresize),this.enabled&&!this.readonly&&(a.bi.add(this.element,"click",this.elementClick,this),this.type==="Range"&&this.drag&&a.bi.add(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown,this),a.bi.add(this.sliderContainer,"keydown",this.keyDown,this),a.bi.add(this.sliderContainer,"keyup",this.keyUp,this),a.bi.add(this.element,"focusout",this.sliderFocusOut,this),a.bi.add(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover,this),this.wireFirstHandleEvt(!1),this.type==="Range"&&this.wireSecondHandleEvt(!1),this.showButtons&&this.wireButtonEvt(!1),this.wireMaterialTooltipEvent(!1),this.isForm&&a.bi.add(this.formElement,"reset",this.formResetHandler,this))},t.prototype.unwireEvents=function(){a.bi.remove(this.element,"click",this.elementClick),this.type==="Range"&&this.drag&&a.bi.remove(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown),a.bi.remove(this.sliderContainer,"keydown",this.keyDown),a.bi.remove(this.sliderContainer,"keyup",this.keyUp),a.bi.remove(this.element,"focusout",this.sliderFocusOut),a.bi.remove(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover),this.wireFirstHandleEvt(!0),this.type==="Range"&&this.wireSecondHandleEvt(!0),this.showButtons&&this.wireButtonEvt(!0),this.wireMaterialTooltipEvent(!0),a.bi.remove(this.element,"reset",this.formResetHandler)},t.prototype.formResetHandler=function(){this.setProperties({value:this.formResetValue},!0),this.setValue()},t.prototype.keyUp=function(e){if(e.keyCode===9&&e.target.classList.contains(Re.sliderHandle)&&(this.focusSliderElement(),!e.target.classList.contains(Re.sliderTabHandle))){this.element.querySelector("."+Re.sliderTabHandle)&&this.element.querySelector("."+Re.sliderTabHandle).classList.remove(Re.sliderTabHandle),e.target.classList.add(Re.sliderTabHandle);var i=e.target.parentElement;i===this.element&&(i.querySelector("."+Re.sliderTrack).classList.add(Re.sliderTabTrack),(this.type==="Range"||this.type==="MinRange")&&i.querySelector("."+Re.rangeBar).classList.add(Re.sliderTabRange)),this.type==="Range"&&(e.target.previousSibling.classList.contains(Re.sliderHandle)?this.activeHandle=2:this.activeHandle=1),this.getHandle().focus(),this.tooltipToggle(this.getHandle())}this.closeTooltip(),this.changeEvent("changed",e)},t.prototype.hover=function(e){if(!(0,a.le)(e))if(e.type==="mouseover"||e.type==="touchmove"||e.type==="mousemove"||e.type==="pointermove"||e.type==="touchstart")this.sliderContainer.classList.add(Re.sliderHover);else{this.sliderContainer.classList.remove(Re.sliderHover);var i=e.currentTarget;this.tooltip.isVisible&&this.tooltip.showOn!=="Always"&&this.tooltipObj&&this.isMaterialTooltip&&!i.classList.contains(Re.sliderHandleFocused)&&!i.classList.contains(Re.sliderTabHandle)&&this.closeMaterialTooltip()}},t.prototype.sliderFocusOut=function(e){e.relatedTarget!==this.secondHandle&&e.relatedTarget!==this.firstHandle&&e.relatedTarget!==this.element&&e.relatedTarget!==this.firstBtn&&e.relatedTarget!==this.secondBtn&&(this.closeMaterialTooltip(),this.closeTooltip(),this.element.querySelector("."+Re.sliderTabHandle)&&this.element.querySelector("."+Re.sliderTabHandle).classList.remove(Re.sliderTabHandle),this.element.querySelector("."+Re.sliderTabTrack)&&(this.element.querySelector("."+Re.sliderTabTrack).classList.remove(Re.sliderTabTrack),(this.type==="Range"||this.type==="MinRange")&&this.element.querySelector("."+Re.sliderTabRange)&&this.element.querySelector("."+Re.sliderTabRange).classList.remove(Re.sliderTabRange)),this.hiddenInput.focus(),this.hiddenInput.blur(),this.isElementFocused=!1)},t.prototype.removeElement=function(e){e.parentNode&&e.parentNode.removeChild(e)},t.prototype.changeSliderType=function(e,i){this.isMaterialTooltip&&this.materialHandle&&(this.sliderContainer.classList.remove(Re.materialSlider),this.removeElement(this.materialHandle),this.materialHandle=void 0),this.removeElement(this.firstHandle),this.firstHandle=void 0,e!=="Default"&&(e==="Range"&&(this.removeElement(this.secondHandle),this.secondHandle=void 0),this.removeElement(this.rangeBar),this.rangeBar=void 0),this.tooltip.isVisible&&!(0,a.le)(this.tooltipObj)&&(this.tooltipObj.destroy(),this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0),this.limits.enabled&&(e==="MinRange"||e==="Default"?(0,a.le)(this.limitBarFirst)||(this.removeElement(this.limitBarFirst),this.limitBarFirst=void 0):(0,a.le)(this.limitBarSecond)||(this.removeElement(this.limitBarSecond),this.limitBarSecond=void 0)),this.activeHandle=1,this.getThemeInitialization(),this.type==="Range"&&this.rangeValueUpdate(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setHandler(),this.setOrientClass(),this.wireFirstHandleEvt(!1),this.type==="Range"&&this.wireSecondHandleEvt(!1),this.setValue(),this.tooltip.isVisible&&(this.renderTooltip(),this.wireMaterialTooltipEvent(!1)),this.setBarColor(),i!=="tooltip"&&this.updateConfig()},t.prototype.changeRtl=function(){if(!this.enableRtl&&this.type==="Range"&&(this.value=[this.handleVal2,this.handleVal1]),this.updateConfig(),this.tooltip.isVisible&&this.tooltipObj.refresh(this.firstHandle),this.showButtons){var e=this.enableRtl&&this.orientation!=="Vertical";(0,a.Y4)(e?this.secondBtn:this.firstBtn,{"aria-label":"Decrease",title:"Decrease"}),(0,a.Y4)(e?this.firstBtn:this.secondBtn,{"aria-label":"Increase",title:"Increase"})}},t.prototype.changeOrientation=function(){this.changeSliderType(this.type,"null")},t.prototype.updateConfig=function(){this.setEnableRTL(),this.setValue(),this.tooltip.isVisible&&this.refreshTooltip(this.tooltipTarget),this.ticks.placement!=="None"&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.limitsPropertyChange()},t.prototype.limitsPropertyChange=function(){this.limits.enabled?((0,a.le)(this.limitBarFirst)&&this.type!=="Range"&&this.createLimitBar(),(0,a.le)(this.limitBarFirst)&&(0,a.le)(this.limitBarSecond)&&this.type==="Range"&&this.createLimitBar(),this.setLimitBar(),this.setValue()):((0,a.le)(this.limitBarFirst)||(0,a.og)(this.limitBarFirst),(0,a.le)(this.limitBarSecond)||(0,a.og)(this.limitBarSecond))},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.destroy=function(){o.prototype.destroy.call(this),this.unwireEvents(),window.removeEventListener("resize",this.onresize),(0,a.IV)([this.sliderContainer],[Re.sliderDisabled]),this.firstHandle.removeAttribute("aria-orientation"),this.type==="Range"&&this.secondHandle.removeAttribute("aria-orientation"),this.sliderContainer.parentNode.insertBefore(this.element,this.sliderContainer),(0,a.og)(this.sliderContainer),this.tooltip.isVisible&&this.tooltipObj.destroy(),this.element.innerHTML=""},t.prototype.onPropertyChanged=function(e,i){for(var r=this,n=0,s=Object.keys(e);n<s.length;n++){var l=s[n];switch(l){case"cssClass":this.setCSSClass(i.cssClass);break;case"value":if(e&&i){var h=(0,a.le)(e.value)?this.type==="Range"?[this.min,this.max]:this.min:e.value;this.setProperties({value:h},!0),!(0,a.le)(i.value)&&i.value.toString()!==h.toString()&&(this.setValue(),this.refreshTooltip(this.tooltipTarget),this.type==="Range"&&((0,a.le)(e.value)||i.value[1]===h[1]?this.activeHandle=1:this.activeHandle=2))}break;case"min":case"step":case"max":this.setMinMaxValue();break;case"tooltip":!(0,a.le)(e.tooltip)&&!(0,a.le)(i.tooltip)&&this.setTooltip(l);break;case"type":!(0,a.le)(i)&&Object.keys(i).length&&!(0,a.le)(i.type)&&(this.changeSliderType(i.type,l),this.setZindex());break;case"enableRtl":i.enableRtl!==e.enableRtl&&this.orientation!=="Vertical"&&(this.rtl=i.enableRtl,this.changeRtl());break;case"limits":this.limitsPropertyChange();break;case"orientation":this.changeOrientation();break;case"ticks":(0,a.le)(this.sliderContainer.querySelector("."+Re.scale))||((0,a.og)(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(c){c.match(/e-scale-/)&&r.sliderContainer.classList.remove(c)})),this.ticks.placement!=="None"&&(this.renderScale(),this.setZindex());break;case"locale":this.showButtons&&this.buttonTitle();break;case"showButtons":e.showButtons?(this.setButtons(),this.reposition(),this.enabled&&!this.readonly&&this.wireButtonEvt(!1)):this.firstBtn&&this.secondBtn&&(this.sliderContainer.removeChild(this.firstBtn),this.sliderContainer.removeChild(this.secondBtn),this.sliderContainer.classList.remove(Re.sliderButtonClass),this.firstBtn=void 0,this.secondBtn=void 0,this.reposition());break;case"enabled":this.setEnabled();break;case"readonly":this.setReadOnly();break;case"customValues":this.setValue(),this.reposition();break;case"colorRange":this.reposition();break;case"width":this.setElementWidth(e.width),this.setMinMaxValue(),this.limits&&this.limitsPropertyChange();break}}},t.prototype.setReadOnly=function(){this.readonly?(this.unwireEvents(),this.sliderContainer.classList.add(Re.readonly)):(this.wireEvents(),this.sliderContainer.classList.remove(Re.readonly))},t.prototype.setMinMaxValue=function(){var e=this;this.setValue(),this.refreshTooltip(this.tooltipTarget),(0,a.le)(this.sliderContainer.querySelector("."+Re.scale))||this.ul&&((0,a.og)(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(i){i.match(/e-scale-/)&&e.sliderContainer.classList.remove(i)})),this.ticks.placement!=="None"&&(this.renderScale(),this.setZindex())},t.prototype.setZindex=function(){this.zIndex=6,!(0,a.le)(this.ticks)&&this.ticks.placement!=="None"&&(this.ul.style.zIndex=this.zIndex+-7+"",this.element.style.zIndex=this.zIndex+2+""),!this.isMaterial&&!(0,a.le)(this.ticks)&&this.ticks.placement==="Both"&&(this.element.style.zIndex=this.zIndex+2+""),this.firstHandle.style.zIndex=this.zIndex+3+"",this.type==="Range"&&(this.secondHandle.style.zIndex=this.zIndex+4+"")},t.prototype.setTooltip=function(e){this.changeSliderType(this.type,e)},t.prototype.setBarColor=function(){for(var e,i,r=this.sliderTrack.lastElementChild;r;)this.sliderTrack.removeChild(r),r=this.sliderTrack.lastElementChild;for(var n=0;n<this.colorRange.length;n++)if(!(0,a.le)(this.colorRange[n].start)&&!(0,a.le)(this.colorRange[n].end)&&this.colorRange[n].end>this.colorRange[n].start){this.colorRange[n].start<this.min&&(this.colorRange[n].start=this.min),this.colorRange[n].end>this.max&&(this.colorRange[n].end=this.max);var s=this.checkHandlePosition(this.colorRange[n].start),l=this.checkHandlePosition(this.colorRange[n].end),h=this.createElement("div");h.style.backgroundColor=this.colorRange[n].color,h.style.border="1px solid "+this.colorRange[n].color,this.orientation==="Horizontal"?(i=Re.sliderHorizantalColor,this.enableRtl?(0,a.le)(this.customValues)?e=this.checkHandlePosition(this.max)-this.checkHandlePosition(this.colorRange[n].end):e=this.checkHandlePosition(this.customValues.length-this.colorRange[n].end-1):e=this.checkHandlePosition(this.colorRange[n].start),h.style.width=l-s+"px",h.style.left=e+"px"):(i=Re.sliderVerticalColor,e=this.checkHandlePosition(this.colorRange[n].start),h.style.height=l-s+"px",h.style.bottom=e+"px"),h.classList.add(i),this.sliderTrack.appendChild(h)}},t.prototype.getModuleName=function(){return"slider"},Ft([(0,a.Z9)(null)],t.prototype,"value",void 0),Ft([(0,a.Z9)(null)],t.prototype,"customValues",void 0),Ft([(0,a.Z9)(1)],t.prototype,"step",void 0),Ft([(0,a.Z9)(null)],t.prototype,"width",void 0),Ft([(0,a.Z9)(0)],t.prototype,"min",void 0),Ft([(0,a.Z9)(100)],t.prototype,"max",void 0),Ft([(0,a.Z9)(!1)],t.prototype,"readonly",void 0),Ft([(0,a.Z9)("Default")],t.prototype,"type",void 0),Ft([(0,a.FE)([{}],aC)],t.prototype,"colorRange",void 0),Ft([(0,a.Zz)({},sC)],t.prototype,"ticks",void 0),Ft([(0,a.Zz)({},oC)],t.prototype,"limits",void 0),Ft([(0,a.Z9)(!0)],t.prototype,"enabled",void 0),Ft([(0,a.Zz)({},lC)],t.prototype,"tooltip",void 0),Ft([(0,a.Z9)(!1)],t.prototype,"showButtons",void 0),Ft([(0,a.Z9)(!0)],t.prototype,"enableAnimation",void 0),Ft([(0,a.Z9)("Horizontal")],t.prototype,"orientation",void 0),Ft([(0,a.Z9)("")],t.prototype,"cssClass",void 0),Ft([(0,a.Z9)(!1)],t.prototype,"enableHtmlSanitizer",void 0),Ft([(0,a.ju)()],t.prototype,"created",void 0),Ft([(0,a.ju)()],t.prototype,"change",void 0),Ft([(0,a.ju)()],t.prototype,"changed",void 0),Ft([(0,a.ju)()],t.prototype,"renderingTicks",void 0),Ft([(0,a.ju)()],t.prototype,"renderedTicks",void 0),Ft([(0,a.ju)()],t.prototype,"tooltipChange",void 0),t=Ft([a.Zl],t),t}(a.wA),uC=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Vi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Dh="e-apply",dp="e-cancel",fp="e-current",pC="e-container",vp="e-ctrl-btn",Za="e-switch-ctrl-btn",Av="e-disabled",Tv="e-value-switch-btn",Lv="e-handler",kv="e-hex",mp="e-hide-hex-value",gp="e-hide-opacity",Ya="e-hide-switchable-value",sa="e-hide-value",Iv="e-hide-valueswitcher",$o="e-hsv-color",Dv="e-hsv-container",Ga="e-selected-value",Oh="e-mode-switch-btn",yp="e-nocolor-item",bp="e-opacity-value",Qo="e-palette",Rh="e-color-palette",Cp="e-color-picker",Mh="e-preview-container",Ph="e-previous",dC="e-rtl",Ka="e-show-value",Jo="e-selected",Sp="e-split-preview",Nh="e-tile",fC={default:["#000000","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"]},wp=function(o){uC(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){var e=this.element;this.formElement=(0,a.oq)(this.element,"form"),this.formElement&&a.bi.add(this.formElement,"reset",this.formResetHandler,this);var i={Apply:"Apply",Cancel:"Cancel",ModeSwitcher:"Switch Mode"};this.l10n=new a.E7("colorpicker",i,this.locale),e.getAttribute("ejs-for")&&!e.getAttribute("name")&&e.setAttribute("name",e.id)},t.prototype.render=function(){this.initWrapper(),this.inline?this.createWidget():this.createSplitBtn(),this.enableOpacity||(0,a.cn)([this.container.parentElement],gp),this.renderComplete()},t.prototype.initWrapper=function(){var e=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"});this.element.parentNode.insertBefore(e,this.element),e.appendChild(this.element),(0,a.Y4)(this.element,{tabindex:"-1",spellcheck:"false"}),this.container=this.createElement("div",{className:pC}),this.getWrapper().appendChild(this.container);var i=this.value?this.roundValue(this.value).toLowerCase():"#008000ff";this.noColor&&this.mode==="Palette"&&this.value===""&&(i="");var r=i.slice(0,7);(0,a.le)(this.initialInputValue)&&(this.initialInputValue=r),this.element.value=r,this.enableOpacity?this.setProperties({value:i},!0):this.setProperties({value:r},!0),this.enableRtl&&e.classList.add(dC),this.cssClass&&(0,a.cn)([e],this.cssClass.split(" ")),this.tileRipple=(0,a.qx)(this.container,{selector:"."+Nh}),this.ctrlBtnRipple=(0,a.qx)(this.container,{selector:".e-btn"})},t.prototype.getWrapper=function(){return this.element.parentElement},t.prototype.createWidget=function(){this.mode==="Palette"?(this.createPalette(),this.inline||this.firstPaletteFocus()):(this.createPicker(),this.inline||this.getDragHandler().focus()),this.isRgb=!0,this.createInput(),this.createCtrlBtn(),this.disabled||this.wireEvents(),this.inline&&this.disabled&&this.toggleDisabled(!0),a.AR.isDevice&&this.refreshPopupPos()},t.prototype.createSplitBtn=function(){var e=this,i=this.createElement("button",{className:"e-split-colorpicker"});this.getWrapper().appendChild(i),this.splitBtn=new pp({iconCss:"e-selected-color",target:this.container,disabled:this.disabled,enableRtl:this.enableRtl,createPopupOnClick:this.createPopupOnClick,open:this.onOpen.bind(this),click:function(){e.trigger("change",{currentValue:{hex:e.value.slice(0,7),rgba:e.convertToRgbString(e.hexToRgb(e.value))},previousValue:{hex:null,rgba:null},value:e.value})}}),this.splitBtn.createElement=this.createElement,this.splitBtn.appendTo(i);var r=this.createElement("span",{className:Sp});(0,a.Ys)(".e-selected-color",i).appendChild(r),r.style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value));var n=this.getPopupEle();if((0,a.cn)([n],"e-colorpicker-popup"),this.cssClass&&(0,a.cn)([n],this.cssClass.split(" ")),a.AR.isDevice){var s=this.getPopupInst();s.relateTo=document.body,s.position={X:"center",Y:"center"},s.targetType="container",s.collision={X:"fit",Y:"fit"},s.offsetY=4,n.style.zIndex=cn(this.splitBtn.element).toString()}this.bindCallBackEvent()},t.prototype.onOpen=function(){this.trigger("open",{element:this.container})},t.prototype.getPopupInst=function(){return(0,a.s8)(this.getPopupEle(),br)},t.prototype.bindCallBackEvent=function(){var e=this;this.splitBtn.beforeOpen=function(i){var r=new Ih;return e.trigger("beforeOpen",i,function(n){if(!n.cancel){var s=e.getPopupEle();s.style.top=(0,a.Ac)(0+pageYOffset),s.style.left=(0,a.Ac)(0+pageXOffset),s.style.display="block",e.createWidget(),s.style.display="",a.AR.isDevice&&(e.modal=e.createElement("div"),e.modal.className="e-"+e.getModuleName()+" e-modal",e.modal.style.display="none",document.body.insertBefore(e.modal,s),document.body.className+=" e-colorpicker-overflow",e.modal.style.display="block",e.modal.style.zIndex=(Number(s.style.zIndex)-1).toString())}i.cancel=n.cancel,r.resolve(n)}),r},this.splitBtn.beforeClose=function(i){var r=new Ih;if((0,a.le)(i.event))r.resolve(i);else{var n={element:e.container,event:i.event,cancel:!1};e.trigger("beforeClose",n,function(s){a.AR.isDevice&&i.event.target===e.modal&&(s.cancel=!0),s.cancel||e.onPopupClose(),i.cancel=s.cancel,r.resolve(s)})}return r}},t.prototype.onPopupClose=function(){this.unWireEvents(),this.destroyOtherComp(),this.container.style.width="",(0,a.Ys)("."+Sp,this.splitBtn.element).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value)),this.container.innerHTML="",(0,a.IV)([this.container],[Cp,Rh]),a.AR.isDevice&&this.modal&&((0,a.IV)([document.body],"e-colorpicker-overflow"),this.modal.style.display="none",this.modal.outerHTML="",this.modal=null)},t.prototype.createPalette=function(){if((0,a.s1)(this.container,[Rh],[Cp]),this.presetColors){var e=this.createElement("div",{className:"e-custom-palette"});this.appendElement(e);var i=Object.keys(this.presetColors);if(i.length===1)this.appendPalette(this.presetColors[i[0]],i[0],e);else for(var r=0,n=i.length;r<n;r++)this.appendPalette(this.presetColors[i[r]],i[r],e);(0,a.td)(".e-row",e).length>10&&(0,a.cn)([e],"e-palette-group")}else this.appendPalette(fC.default,"default");this.mode==="Palette"&&!this.modeSwitcher&&this.noColor&&this.setNoColor();var s=parseInt(getComputedStyle(this.container).borderBottomWidth,10);this.container.style.width=(0,a.Ac)(this.container.children[0].offsetWidth+s+s),this.rgb=this.hexToRgb(this.roundValue(this.value)),this.hsv=this.rgbToHsv.apply(this,this.rgb)},t.prototype.firstPaletteFocus=function(){(0,a.Ys)("."+Jo,this.container.children[0])||(0,a.td)("."+Qo,this.container)[0].focus()},t.prototype.appendPalette=function(e,i,r){var n=this.createElement("div",{className:Qo,attrs:{tabindex:"0"}});r?r.appendChild(n):this.appendElement(n);for(var s,l,h,c=0,u=e.length;c<u;c++)(c===0||c%this.columns==0)&&(s=this.createElement("div",{className:"e-row",attrs:{role:"presentation"}}),n.appendChild(s)),h=this.roundValue(e[c]).toLowerCase(),l=this.createElement("span",{className:Nh,attrs:{role:"gridcell","aria-label":h,"aria-selected":"false",tabindex:"0"}}),this.trigger("beforeTileRender",{element:l,presetName:i,value:e[c]}),s.appendChild(l),this.value===h&&(this.addTileSelection(l),n.focus()),l.style.backgroundColor=this.convertToRgbString(this.hexToRgb(h))},t.prototype.setNoColor=function(){var e=this.container.querySelector(".e-row").children[0];e.classList.add(yp),this.value||(e.classList.add(Jo),(0,a.oq)(e,"."+Qo).focus()),["aria-selected","aria-label"].forEach(function(i){e.removeAttribute(i)}),e.style.backgroundColor=""},t.prototype.appendElement=function(e,i){i===void 0&&(i=0);var r=this.container.children[i];r?this.container.insertBefore(e,r):this.container.appendChild(e)},t.prototype.addTileSelection=function(e){e.classList.add(Jo),e.setAttribute("aria-selected","true")},t.prototype.createPicker=function(){(0,a.s1)(this.container,[Cp],[Rh]);var e=this.createElement("div",{className:Dv});this.appendElement(e),e.appendChild(this.createElement("div",{className:$o}));var i=this.createElement("span",{className:Lv,attrs:{tabindex:"0"}});e.appendChild(i),this.value===null&&(this.value="#008000ff"),this.rgb=this.hexToRgb(this.value),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHsvContainerBg(),this.setHandlerPosition(),this.createSlider(),this.createDragTooltip()},t.prototype.setHsvContainerBg=function(e){e===void 0&&(e=this.hsv[0]),this.getHsvContainer().style.backgroundColor=this.convertToRgbString(this.hsvToRgb(e,100,100,1))},t.prototype.getHsvContainer=function(){return(0,a.Ys)("."+Dv,this.container)},t.prototype.setHandlerPosition=function(){var e=this.getDragHandler(),i=(0,a.Ys)("."+$o,this.container);this.enableRtl?e.style.left=(0,a.Ac)(i.offsetWidth*Math.abs(100-this.hsv[1])/100):e.style.left=(0,a.Ac)(i.offsetWidth*this.hsv[1]/100),e.style.top=(0,a.Ac)(i.offsetHeight*(100-this.hsv[2])/100)},t.prototype.createSlider=function(){var e=this.createElement("div",{className:"e-slider-preview"});this.appendElement(e,1),this.createPreview(e);var i=this.createElement("div",{className:"e-colorpicker-slider"});e.insertBefore(i,e.children[0]);var r=this.createElement("div",{className:"e-hue-slider"});i.appendChild(r),this.hueSlider=new Ev({value:this.hsv[0],min:0,max:359,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.hueChange.bind(this)}),this.hueSlider.createElement=this.createElement,this.hueSlider.appendTo(r),this.enableOpacity&&(r=this.createElement("div",{className:"e-opacity-slider"}),i.appendChild(r),this.createOpacitySlider(r))},t.prototype.createOpacitySlider=function(e){this.opacitySlider=new Ev({value:this.rgb[3]*100,min:0,max:100,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.opacityChange.bind(this)}),this.opacitySlider.createElement=this.createElement,this.opacitySlider.appendTo(e);var i=this.createElement("div",{className:"e-opacity-empty-track"});e.appendChild(i),this.updateOpacitySliderBg()},t.prototype.updateOpacitySliderBg=function(){var e=this.enableRtl?"to left":"to right",i=(0,a.Ys)(".e-opacity-empty-track",this.opacitySlider.element);i&&(i.style.background="linear-gradient("+e+", rgba("+this.rgb.slice(0,3)+", 0) 0%, "+this.convertToRgbString(this.rgb.slice(0,3))+" 100%)")},t.prototype.hueChange=function(e){this.hsv[0]=e.value,this.setHsvContainerBg(),this.convertToOtherFormat()},t.prototype.opacityChange=function(e){var i=e.value,r=this.rgbToHex(this.rgb);this.hsv[3]=i/100,this.rgb[3]=i/100;var n=this.rgbToHex(this.rgb);this.updateOpacityInput(i);var s=this.convertToRgbString(this.rgb);this.updatePreview(s),this.triggerEvent(n,r,s)},t.prototype.updateOpacityInput=function(e){if(this.enableOpacity&&!this.getWrapper().classList.contains(sa)){var i=(0,a.s8)((0,a.Ys)("."+bp,this.container),Zn);i.value=e,i.dataBind()}},t.prototype.createPreview=function(e){var i=this.createElement("div",{className:Mh});e.appendChild(i);var r=this.createElement("span",{className:"e-preview "+fp});i.appendChild(r);var n=this.convertToRgbString(this.rgb);r.style.backgroundColor=n,r=this.createElement("span",{className:"e-preview "+Ph}),i.appendChild(r),r.style.backgroundColor=n},t.prototype.isPicker=function(){return!this.container.classList.contains(Rh)},t.prototype.getPopupEle=function(){return this.container.parentElement},t.prototype.createNumericInput=function(e,i,r,n){var s=this,l=new Zn({value:i,placeholder:r,min:0,max:n,format:"###.##",showSpinButton:!1,floatLabelType:"Always",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker(),change:function(h){h.event&&s.inputHandler(h.event)}});l.createElement=this.createElement,l.appendTo(e)},t.prototype.createInput=function(){var e=this.isPicker(),i=this.getWrapper();if(e&&!i.classList.contains(sa)||!e&&i.classList.contains(Ka)){var r=this.createElement("div",{className:Ga});e?this.appendElement(r,2):this.appendElement(r,1);var n=this.createElement("div",{className:"e-input-container"});if(r.appendChild(n),i.classList.contains(Iv)||this.appendValueSwitchBtn(r),!i.classList.contains(mp)){var s=this.createElement("input",{className:kv,attrs:{maxlength:"7",spellcheck:"false"}});n.appendChild(s),Ue.createInput({element:s,floatLabelType:"Always",properties:{placeholder:"HEX",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker()}},this.createElement),Ue.setValue(this.value.slice(0,7),s),s.addEventListener("input",this.inputHandler.bind(this))}if(!i.classList.contains(Ya)){var l=void 0,h=void 0;this.isRgb?(l="RGB",h=this.rgb):(l="HSV",h=this.hsv);for(var c=["rh","gs","bv"],u=0;u<3;u++)this.createNumericInput(n.appendChild(this.createElement("input",{className:"e-"+c[u]+"-value"})),h[u],l[u],255);this.enableOpacity&&this.appendOpacityValue(n)}}},t.prototype.appendOpacityValue=function(e){this.createNumericInput(e.appendChild(this.createElement("input",{className:bp})),this.rgb[3]*100,"A",100)},t.prototype.appendValueSwitchBtn=function(e){var i=this.createElement("button",{className:"e-icons e-css e-btn e-flat e-icon-btn "+Tv});e.appendChild(i),this.isPicker()&&!this.getWrapper().classList.contains(Ya)&&i.addEventListener("click",this.formatSwitchHandler.bind(this))},t.prototype.createCtrlBtn=function(){if(this.modeSwitcher||this.showButtons){this.l10n.setLocale(this.locale);var e=this.createElement("div",{className:Za});if(this.container.appendChild(e),this.showButtons){var i=this.createElement("div",{className:vp});e.appendChild(i);var r=this.l10n.getConstant("Apply");i.appendChild(this.createElement("button",{innerHTML:r,className:"e-btn e-css e-flat e-primary e-small "+Dh,attrs:{title:r}}));var n=this.l10n.getConstant("Cancel");i.appendChild(this.createElement("button",{innerHTML:n,className:"e-btn e-css e-flat e-small "+dp,attrs:{title:n}}))}this.modeSwitcher&&this.appendModeSwitchBtn()}},t.prototype.appendModeSwitchBtn=function(){var e=this.createElement("button",{className:"e-icons e-btn e-flat e-icon-btn "+Oh,attrs:{title:this.l10n.getConstant("ModeSwitcher")}});(0,a.Ys)("."+Za,this.container).insertBefore(e,(0,a.Ys)("."+vp,this.container))},t.prototype.createDragTooltip=function(){var e=this,i=new Lo({opensOn:"Custom",showTipPointer:!1,cssClass:"e-color-picker-tooltip",beforeOpen:function(r){e.tooltipEle=r.element},animation:{open:{effect:"None"},close:{effect:"None"}}});i.createElement=this.createElement,i.appendTo(this.container),i.open(this.container),this.tooltipEle.style.zIndex=cn(this.tooltipEle).toString(),(0,a.Ys)(".e-tip-content",this.tooltipEle).appendChild(this.createElement("div",{className:"e-tip-transparent"}))},t.prototype.getTooltipInst=function(){return(0,a.s8)(this.container,Lo)},t.prototype.setTooltipOffset=function(e){this.getTooltipInst().offsetY=e},t.prototype.toggleDisabled=function(e){e?this.getWrapper().classList.add(Av):this.getWrapper().classList.remove(Av),this.showButtons&&[].slice.call((0,a.td)(".e-btn",this.container)).forEach(function(i){e?(0,a.Y4)(i,{disabled:""}):i.removeAttribute("disabled")})},t.prototype.convertToRgbString=function(e){return e.length?e.length===4?"rgba("+e.join()+")":"rgb("+e.join()+")":""},t.prototype.convertToHsvString=function(e){return e.length===4?"hsva("+e.join()+")":"hsv("+e.join()+")"},t.prototype.updateHsv=function(){this.hsv[1]=this.hsv[1]>100?100:this.hsv[1],this.hsv[2]=this.hsv[2]>100?100:this.hsv[2],this.setHandlerPosition()},t.prototype.convertToOtherFormat=function(e){e===void 0&&(e=!1);var i=this.rgbToHex(this.rgb);this.rgb=this.hsvToRgb.apply(this,this.hsv);var r=this.rgbToHex(this.rgb),n=this.convertToRgbString(this.rgb);this.updatePreview(n),this.updateInput(r),this.triggerEvent(r,i,n,e)},t.prototype.updateInput=function(e){var i=this.getWrapper();i.classList.contains(sa)||(i.classList.contains(mp)||Ue.setValue(e.substr(0,7),(0,a.Ys)("."+kv,this.container)),i.classList.contains(Ya)||(this.isRgb?this.updateValue(this.rgb,!1):this.updateValue(this.hsv,!1)))},t.prototype.updatePreview=function(e){this.enableOpacity&&this.updateOpacitySliderBg(),(0,a.Ys)(".e-tip-transparent",this.tooltipEle).style.backgroundColor=e,(0,a.Ys)("."+Mh+" ."+fp,this.container).style.backgroundColor=e,(0,a.Ys)("."+Mh+" ."+Ph,this.container).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value))},t.prototype.getDragHandler=function(){return(0,a.Ys)("."+Lv,this.container)},t.prototype.removeTileSelection=function(){var e=[].slice.call((0,a.td)("."+Jo,this.container.children[0]));e.forEach(function(i){i.classList.remove(Jo),i.setAttribute("aria-selected","false")})},t.prototype.convertRgbToNumberArray=function(e){return e.slice(e.indexOf("(")+1,e.indexOf(")")).split(",").map(function(i,r){return r!==3?parseInt(i,10):parseFloat(i)})},t.prototype.getValue=function(e,i){if(e||(e=this.value),i=i?i.toLowerCase():"hex",e[0]==="r"){var r=this.convertRgbToNumberArray(e);if(i==="hex"||i==="hexa"){var n=this.rgbToHex(r);return i==="hex"?n.slice(0,7):n}else return i==="hsv"?this.convertToHsvString(this.rgbToHsv.apply(this,r.slice(0,3))):i==="hsva"?this.convertToHsvString(this.rgbToHsv.apply(this,r)):"null"}else if(e[0]==="h"){var r=this.hsvToRgb.apply(this,this.convertRgbToNumberArray(e));if(i==="rgba")return this.convertToRgbString(r);if(i==="hex"||i==="hexa"){var n=this.rgbToHex(r);return i==="hex"?n.slice(0,7):n}else return i==="rgb"?this.convertToRgbString(r.slice(0,3)):"null"}else{e=this.roundValue(e);var s=this.hexToRgb(e);return(i==="rgb"||i==="hsv")&&(s=s.slice(0,3)),i==="rgba"||i==="rgb"?this.convertToRgbString(s):i==="hsva"||i==="hsv"?this.convertToHsvString(this.rgbToHsv.apply(this,s)):i==="hex"?e.slice(0,7):i==="a"?s[3].toString():"null"}},t.prototype.toggle=function(){this.container.parentElement.classList.contains("e-popup-close")?this.splitBtn.toggle():this.closePopup(null)},t.prototype.getModuleName=function(){return"colorpicker"},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.wireEvents=function(){if(this.isPicker()){var e=this.getDragHandler();a.bi.add(e,"keydown",this.pickerKeyDown,this),a.bi.add(this.getHsvContainer(),"mousedown touchstart",this.handlerDown,this),(this.modeSwitcher||this.showButtons)&&this.addCtrlSwitchEvent(),a.bi.add((0,a.Ys)("."+Ph,this.container),"click",this.previewHandler,this)}else a.bi.add(this.container,"click",this.paletteClickHandler,this),a.bi.add(this.container,"keydown",this.paletteKeyDown,this)},t.prototype.formResetHandler=function(){this.value=this.initialInputValue,(0,a.Y4)(this.element,{value:this.initialInputValue})},t.prototype.addCtrlSwitchEvent=function(){var e=(0,a.Ys)("."+Za,this.container);e&&a.bi.add(e,"click",this.btnClickHandler,this)},t.prototype.pickerKeyDown=function(e){switch(e.keyCode){case 39:this.handlerDragPosition(1,this.enableRtl?-1:1,e);break;case 37:this.handlerDragPosition(1,this.enableRtl?1:-1,e);break;case 38:this.handlerDragPosition(2,1,e);break;case 40:this.handlerDragPosition(2,-1,e);break;case 13:{e.preventDefault();var i=this.rgbToHex(this.rgb);this.enterKeyHandler(i,e)}}},t.prototype.enterKeyHandler=function(e,i){this.triggerChangeEvent(e),this.inline||(this.closePopup(i),this.splitBtn.element.focus())},t.prototype.closePopup=function(e){var i=this,r={element:this.container,event:e,cancel:!1};this.trigger("beforeClose",r,function(n){n.cancel||(i.splitBtn.toggle(),i.onPopupClose())})},t.prototype.triggerChangeEvent=function(e){var i=e.slice(0,7);this.trigger("change",{currentValue:{hex:i,rgba:this.convertToRgbString(this.rgb)},previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:this.enableOpacity?e:i}),this.enableOpacity?this.setProperties({value:e},!0):this.setProperties({value:i},!0),this.element.value=i||"#000000"},t.prototype.handlerDragPosition=function(e,i,r){r.preventDefault(),this.hsv[e]+=i*(r.ctrlKey?1:3),this.hsv[e]<0&&(this.hsv[e]=0),this.updateHsv(),this.convertToOtherFormat(!0)},t.prototype.handlerDown=function(e){e.preventDefault(),e.type==="mousedown"?(this.clientX=Math.abs(e.pageX-pageXOffset),this.clientY=Math.abs(e.pageY-pageYOffset),this.setTooltipOffset(8)):(this.clientX=Math.abs(e.changedTouches[0].pageX-pageXOffset),this.clientY=Math.abs(e.changedTouches[0].pageY-pageYOffset),this.setTooltipOffset(-8)),this.setHsv(this.clientX,this.clientY),this.getDragHandler().style.transition="left .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1)",this.updateHsv(),this.convertToOtherFormat(),this.getDragHandler().focus(),a.bi.add(document,"mousemove touchmove",this.handlerMove,this),a.bi.add(document,"mouseup touchend",this.handlerEnd,this)},t.prototype.handlerMove=function(e){e.type!=="touchmove"&&e.preventDefault();var i,r;e.type==="mousemove"?(i=Math.abs(e.pageX-pageXOffset),r=Math.abs(e.pageY-pageYOffset)):(i=Math.abs(e.changedTouches[0].pageX-pageXOffset),r=Math.abs(e.changedTouches[0].pageY-pageYOffset)),this.setHsv(i,r);var n=this.getDragHandler();this.updateHsv(),this.convertToOtherFormat(),this.getTooltipInst().refresh(n),this.tooltipEle.style.transform||(Math.abs(this.clientX-i)>8||Math.abs(this.clientY-r)>8)&&((0,a.Ys)("."+$o,this.container).style.cursor="pointer",n.style.transition="none",this.inline||(this.tooltipEle.style.zIndex=(parseInt(this.getPopupEle().style.zIndex,10)+1).toString()),this.tooltipEle.style.transform="rotate(45deg)",n.classList.add("e-hide-handler"))},t.prototype.setHsv=function(e,i){var r=(0,a.Ys)("."+$o,this.container),n=r.getBoundingClientRect();this.enableRtl?e=e>n.right?0:Math.abs(e-n.right):e=e>n.left?Math.abs(e-n.left):0,i=i>n.top?Math.abs(i-n.top):0,this.hsv[2]=Math.round(Number(100*(r.offsetHeight-Math.max(0,Math.min(r.offsetHeight,i-r.offsetTop)))/r.offsetHeight)*10)/10,this.hsv[1]=Math.round(Number(100*Math.max(0,Math.min(r.offsetWidth,e-r.offsetLeft))/r.offsetWidth)*10)/10},t.prototype.handlerEnd=function(e){e.type!=="touchend"&&e.preventDefault(),a.bi.remove(document,"mousemove touchmove",this.handlerMove),a.bi.remove(document,"mouseup touchend",this.handlerEnd);var i=this.getDragHandler();(0,a.Ys)("."+$o,this.container).style.cursor="",this.tooltipEle.style.transform&&(this.tooltipEle.style.transform="",i.classList.remove("e-hide-handler")),!this.inline&&!this.showButtons&&this.closePopup(e)},t.prototype.btnClickHandler=function(e){var i=e.target;(0,a.oq)(i,"."+Oh)?(e.stopPropagation(),this.switchToPalette()):(i.classList.contains(Dh)||i.classList.contains(dp))&&this.ctrlBtnClick(i,e)},t.prototype.switchToPalette=function(){this.trigger("beforeModeSwitch",{element:this.container,mode:"Palette"}),this.unWireEvents(),this.destroyOtherComp(),(0,a.og)((0,a.Ys)(".e-slider-preview",this.container)),this.getWrapper().classList.contains(sa)||(0,a.Od)((0,a.Ys)("."+Ga,this.container)),(0,a.og)(this.getHsvContainer()),this.createPalette(),this.firstPaletteFocus(),this.createInput(),this.refreshPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Palette"})},t.prototype.refreshPopupPos=function(){if(!this.inline){var e=this.getPopupEle();e.style.left=(0,a.Ac)(0+pageXOffset),e.style.top=(0,a.Ac)(0+pageYOffset),this.getPopupInst().refreshPosition(this.splitBtn.element.parentElement)}},t.prototype.formatSwitchHandler=function(){this.isRgb?(this.updateValue(this.hsv,!0,3,[360,100,100]),this.isRgb=!1):(this.updateValue(this.rgb,!0,2),this.isRgb=!0)},t.prototype.updateValue=function(e,i,r,n){for(var s=["e-rh-value","e-gs-value","e-bv-value"],l,h=0,c=s.length;h<c;h++)l=(0,a.s8)((0,a.Ys)("."+s[h],this.container),Zn),l.value=Math.round(e[h]),i&&(l.placeholder=s[h].substr(r,1).toUpperCase(),l.max=n?n[h]:255),l.dataBind()},t.prototype.previewHandler=function(e){var i=e.target,r=this.rgbToHex(this.rgb);this.rgb=this.convertRgbToNumberArray(i.style.backgroundColor),this.rgb[3]||(this.rgb[3]=1);var n=this.rgbToHex(this.rgb),s=this.rgbToHsv.apply(this,this.rgb);s[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:s[0]},!0),this.hueSlider.refresh()),this.setHsvContainerBg(s[0]),this.enableOpacity&&s[3]!==this.hsv[3]&&(this.opacitySlider.setProperties({value:s[3]*100},!0),this.opacitySlider.refresh(),this.updateOpacitySliderBg()),this.hsv=s,this.setHandlerPosition(),this.updateInput(n),(0,a.Ys)("."+Mh+" ."+fp,this.container).style.backgroundColor=this.convertToRgbString(this.rgb),this.triggerEvent(n,r,this.convertToRgbString(this.rgb))},t.prototype.paletteClickHandler=function(e){e.preventDefault();var i=e.target;if(i.classList.contains(Nh)){if(this.removeTileSelection(),this.addTileSelection(i),i.classList.contains(yp))this.noColorTile();else{var r=i.getAttribute("aria-label"),n=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(this.roundValue(r)),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(Ka)&&this.updateInput(r),this.triggerEvent(r,n,this.convertToRgbString(this.rgb))}!this.inline&&!this.showButtons&&this.closePopup(e)}else(0,a.oq)(i,"."+Oh)?this.switchToPicker():i.classList.contains(Dh)||i.classList.contains(dp)?this.ctrlBtnClick(i,e):this.getWrapper().classList.contains(Ka)&&(0,a.oq)(i,"."+Tv)&&this.formatSwitchHandler()},t.prototype.noColorTile=function(e){e===void 0&&(e=!1);var i=this.rgbToHex(this.rgb);this.rgb=[],this.hsv=[],this.triggerEvent("",i,"",e)},t.prototype.switchToPicker=function(){var e=this.getWrapper();this.trigger("beforeModeSwitch",{element:this.container,mode:"Picker"}),this.unWireEvents(),[].slice.call((0,a.td)("."+Qo,this.container)).forEach(function(r){(0,a.og)(r)}),e.classList.contains(Ka)&&(0,a.og)((0,a.Ys)("."+Ga,this.container)),this.container.style.width="";var i=(0,a.Ys)(".e-custom-palette",this.container);this.presetColors&&(0,a.Od)(i),this.createPicker(),this.getDragHandler().focus(),this.createInput(),this.refreshPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Picker"})},t.prototype.ctrlBtnClick=function(e,i){if(e.classList.contains(Dh)){var r=this.rgbToHex(this.rgb);this.triggerChangeEvent(r)}this.inline||(this.closePopup(i),this.splitBtn.element.focus())},t.prototype.paletteKeyDown=function(e){var i=e.target;if(!!i.classList.contains(Qo)){var r,n,s=[].slice.call((0,a.td)("."+Nh,i)),l=s.filter(function(c){return c.classList.contains("e-selected")}).pop();switch(!e.altKey&&e.keyCode){case 39:e.preventDefault(),r=l?s[this.tilePosition(s,l,this.enableRtl?-1:1)]:s[this.enableRtl?s.length-1:0],this.keySelectionChanges(r);break;case 37:e.preventDefault(),r=l?s[this.tilePosition(s,l,this.enableRtl?1:-1)]:s[this.enableRtl?0:s.length-1],this.keySelectionChanges(r);break;case 38:e.preventDefault(),n=l?this.tilePosition(s,l,-this.columns):0,r=s[n]?s[n]:s[n-this.columns],this.keySelectionChanges(r);break;case 40:e.preventDefault(),n=l?this.tilePosition(s,l,this.columns):s.length-1,s[n]||(n%=s.length,n+=s[s.length-1].parentElement.childElementCount),r=s[n],this.keySelectionChanges(r);break;case 13:if(e.preventDefault(),l){var h=l.getAttribute("aria-label");this.enterKeyHandler(h||"",e)}}}},t.prototype.keySelectionChanges=function(e){if(this.removeTileSelection(),this.addTileSelection(e),e.classList.contains(yp))this.noColorTile(!0);else{var i=e.getAttribute("aria-label"),r=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(i),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(Ka)&&this.updateInput(i),this.triggerEvent(i,r,this.convertToRgbString(this.rgb),!0)}},t.prototype.tilePosition=function(e,i,r){e=Array.prototype.slice.call(e);var n=e.length,s=this.columns-e[n-1].parentElement.childElementCount,l=e.indexOf(i);return l+=r,l<0?l+=n+s:l%=n+s,l},t.prototype.inputHandler=function(e){var i=e.target;if(!!i.value.length){var r,n,s=(0,a.Ys)(".e-float-text",i.parentElement).textContent;switch(s){case"HEX":{var l="";if((i.value[0]==="#"&&i.value.length!==5||i.value[0]!=="#"&&i.value.length!==4)&&(l=this.roundValue(i.value)),l.length===9)n=this.rgbToHex(this.rgb),this.rgb=this.hexToRgb(l+l.substr(-2)),this.inputValueChange(this.rgbToHsv.apply(this,this.rgb),n,i.value);else return;break}case"R":this.rgb[0]!==Number(i.value)&&(n=this.rgbToHex(this.rgb),this.rgb[0]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,n));break;case"G":this.rgb[1]!==Number(i.value)&&(n=this.rgbToHex(this.rgb),this.rgb[1]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,n));break;case"B":this.rgb[2]!==Number(i.value)&&(n=this.rgbToHex(this.rgb),this.rgb[2]=Number(i.value),r=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(r,n));break;case"H":this.hueSlider.value=Number(i.value);break;case"S":this.hsv[1]!==Number(i.value)&&(this.hsv[1]=Number(i.value),this.updateHsv(),this.convertToOtherFormat());break;case"V":this.hsv[2]!==Number(i.value)&&(this.hsv[2]=Number(i.value),this.updateHsv(),this.convertToOtherFormat());break;case"A":this.opacitySlider.value=Number(i.value);break}}},t.prototype.inputValueChange=function(e,i,r){e[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:e[0]},!0),this.hueSlider.refresh(),this.setHsvContainerBg(e[0])),this.hsv=e;var n=this.rgbToHex(this.rgb);this.setHandlerPosition(),this.updateInput(r||n);var s=this.convertToRgbString(this.rgb);this.updatePreview(s),this.triggerEvent(n,i,s)},t.prototype.triggerEvent=function(e,i,r,n){n===void 0&&(n=!1);var s=e.slice(0,7);!this.showButtons&&!n?(this.trigger("change",{currentValue:{hex:s,rgba:r},previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:e}),this.enableOpacity?this.setProperties({value:e},!0):this.setProperties({value:s},!0),this.element.value=s||"#000000"):this.trigger("select",{currentValue:{hex:s,rgba:r},previousValue:{hex:i.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(i))}})},t.prototype.destroy=function(){var e=this,i=this.getWrapper();o.prototype.destroy.call(this),["tabindex","spellcheck"].forEach(function(r){e.element.removeAttribute(r)}),this.inline?(this.unWireEvents(),this.destroyOtherComp()):(this.isPopupOpen()&&(this.unWireEvents(),this.destroyOtherComp()),this.splitBtn.destroy(),this.splitBtn=null),this.tileRipple(),this.tileRipple=null,this.ctrlBtnRipple(),this.ctrlBtnRipple=null,this.element.nextElementSibling&&(0,a.og)(this.element.nextElementSibling),i&&(i.parentElement.insertBefore(this.element,i),(0,a.og)(i)),this.container=null,this.formElement&&a.bi.remove(this.formElement,"reset",this.formResetHandler)},t.prototype.destroyOtherComp=function(){if(this.isPicker()){this.hueSlider.destroy(),this.enableOpacity&&(this.opacitySlider.destroy(),this.opacitySlider=null),this.hueSlider=null;var e=this.getTooltipInst();e.close(),e.destroy(),this.tooltipEle=null}},t.prototype.isPopupOpen=function(){return this.getPopupEle().classList.contains("e-popup-open")},t.prototype.unWireEvents=function(){if(this.isPicker()){var e=this.getDragHandler();a.bi.remove(e,"keydown",this.pickerKeyDown),a.bi.remove(this.getHsvContainer(),"mousedown touchstart",this.handlerDown),(this.modeSwitcher||this.showButtons)&&a.bi.remove((0,a.Ys)("."+Za,this.container),"click",this.btnClickHandler),a.bi.remove((0,a.Ys)("."+Ph,this.container),"click",this.previewHandler)}else a.bi.remove(this.container,"click",this.paletteClickHandler),a.bi.remove(this.container,"keydown",this.paletteKeyDown)},t.prototype.roundValue=function(e){if(!e)return"";e[0]!=="#"&&(e="#"+e);var i=e.length;if(i===4&&(e+="f",i=5),i===5){for(var r="",n=1,s=e.length;n<s;n++)r+=e.charAt(n)+e.charAt(n);e="#"+r,i=9}return i===7&&(e+="ff"),e},t.prototype.hexToRgb=function(e){if(!e)return[];e=e.trim(),e.length!==9&&(e=this.roundValue(e));var i=Number((parseInt(e.slice(-2),16)/255).toFixed(2));e=e.slice(1,7);var r=parseInt(e,16),n=[];return n.push(r>>16&255),n.push(r>>8&255),n.push(r&255),n.push(i),n},t.prototype.rgbToHsv=function(e,i,r,n){if(this.rgb&&!this.rgb.length)return[];e/=255,i/=255,r/=255;var s=Math.max(e,i,r),l=Math.min(e,i,r),h,c=s,u=s-l,p=s===0?0:u/s;if(s===l)h=0;else{switch(s){case e:h=(i-r)/u+(i<r?6:0);break;case i:h=(r-e)/u+2;break;case r:h=(e-i)/u+4;break}h/=6}var f=[Math.round(h*360),Math.round(p*1e3)/10,Math.round(c*1e3)/10];return(0,a.le)(n)||f.push(n),f},t.prototype.hsvToRgb=function(e,i,r,n){var s,l,h;if(i/=100,r/=100,i===0)return s=l=h=r,[Math.round(s*255),Math.round(l*255),Math.round(h*255),n];e/=60;var c=Math.floor(e),u=e-c,p=r*(1-i),f=r*(1-i*u),g=r*(1-i*(1-u));switch(c){case 0:s=r,l=g,h=p;break;case 1:s=f,l=r,h=p;break;case 2:s=p,l=r,h=g;break;case 3:s=p,l=f,h=r;break;case 4:s=g,l=p,h=r;break;default:s=r,l=p,h=f}var C=[Math.round(s*255),Math.round(l*255),Math.round(h*255)];return(0,a.le)(n)||C.push(n),C},t.prototype.rgbToHex=function(e){return e.length?"#"+this.hex(e[0])+this.hex(e[1])+this.hex(e[2])+((0,a.le)(e[3])?"":e[3]!==0?(Math.round(e[3]*255)+65536).toString(16).substr(-2):"00"):""},t.prototype.hex=function(e){return("0"+e.toString(16)).slice(-2)},t.prototype.changeModeSwitcherProp=function(e){var i=(0,a.Ys)("."+Za,this.container);e?i?this.appendModeSwitchBtn():(this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):i&&(this.showButtons?(0,a.og)((0,a.Ys)("."+Oh,i)):(0,a.Od)(i))},t.prototype.changeShowBtnProps=function(e){var i=(0,a.Ys)("."+Za,this.container);e?(i&&(0,a.Od)(i),this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):this.modeSwitcher?(0,a.og)((0,a.Ys)("."+vp,i)):(0,a.Od)(i)},t.prototype.changeValueProp=function(e){if(this.isPicker())this.rgb=this.hexToRgb(e),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHandlerPosition(),(0,a.og)((0,a.oq)(this.hueSlider.element,".e-slider-preview")),this.createSlider(),this.setHsvContainerBg(),this.updateInput(e),this.rgb.length===4&&this.updateOpacityInput(this.rgb[3]*100);else{this.removeTileSelection();var i=this.container.querySelector('span[aria-label="'+this.roundValue(e)+'"]');i&&this.addTileSelection(i)}},t.prototype.setInputEleProps=function(){(0,a.Od)((0,a.Ys)("."+Ga,this.container)),this.createInput()},t.prototype.changeDisabledProp=function(e){this.isPicker()&&(this.hueSlider.enabled=!e,this.opacitySlider.enabled=!e,this.setInputEleProps()),e?(this.toggleDisabled(!0),this.unWireEvents()):(this.toggleDisabled(!1),this.wireEvents())},t.prototype.changeCssClassProps=function(e,i){var r=this.getWrapper(),n=this.getPopupEle();i&&(0,a.IV)([r,n],i.split(" ")),e&&(0,a.cn)([r,n],e.split(" "))},t.prototype.changeRtlProps=function(e){e?(0,a.cn)([this.getWrapper()],"e-rtl"):(0,a.IV)([this.getWrapper()],"e-rtl")},t.prototype.changePaletteProps=function(){(0,a.og)(this.container.children[0]),this.container.style.width="",this.createPalette()},t.prototype.changeOpacityProps=function(e){var i=this.getWrapper();e?((0,a.IV)([this.container.parentElement],gp),this.createOpacitySlider((0,a.Ys)(".e-colorpicker-slider",this.container).appendChild(this.createElement("div",{className:"e-opacity-slider"}))),!i.classList.contains(sa)&&!i.classList.contains(Ya)&&this.appendOpacityValue((0,a.Ys)(".e-input-container",this.container))):((0,a.cn)([this.container.parentElement],gp),this.opacitySlider.destroy(),(0,a.Od)(this.opacitySlider.element),this.opacitySlider=null,!i.classList.contains(sa)&&!i.classList.contains(Ya)&&(0,a.Od)((0,a.Ys)("."+bp,this.container).parentElement))},t.prototype.onPropertyChanged=function(e,i){var r=this;if(!(0,a.le)(e.value)){var n=this.roundValue(e.value);if(n.length===9){this.element.value=this.roundValue(n).slice(0,7);var s=this.splitBtn&&(0,a.Ys)("."+Sp,this.splitBtn.element);s&&(s.style.backgroundColor=this.convertToRgbString(this.hexToRgb(e.value)))}else this.value=i.value}if(!this.inline&&(0,a.le)(e.inline)){var l=["disabled","enableRtl"];if(this.splitBtn.setProperties(Xs(e,l)),!this.isPopupOpen()){this.changeCssClassProps(e.cssClass,i.cssClass),this.changeRtlProps(e.enableRtl);return}}for(var h=function(g){switch(g){case"inline":e.inline?(c.getWrapper().appendChild(c.container),c.splitBtn.destroy(),(0,a.og)(c.element.nextElementSibling),c.container.children.length||c.createWidget()):(c.destroyOtherComp(),c.unWireEvents(),c.container.innerHTML="",c.createSplitBtn());break;case"cssClass":{c.changeCssClassProps(e.cssClass,i.cssClass);var C=e.cssClass.split(" ").concat(i.cssClass.split(" "));C=C.reduce(function(D,R){return D.indexOf(R)<0&&D.push(R),D},[]);var L=0;C.forEach(function(D){if(L===0&&(D===sa||D===Iv||D===Ka||D===mp||D===Ya)){var R=(0,a.Ys)("."+Ga,r.container);R&&(0,a.Od)((0,a.Ys)("."+Ga,r.container)),r.createInput(),L++}});break}case"enableRtl":c.isPicker()&&(c.hueSlider.enableRtl=e.enableRtl,c.enableOpacity&&(c.opacitySlider.enableRtl=e.enableRtl),c.setInputEleProps()),c.changeRtlProps(e.enableRtl);break;case"disabled":c.changeDisabledProp(e.disabled);break;case"value":c.value!==i.value&&c.changeValueProp(e.value);break;case"showButtons":c.changeShowBtnProps(e.showButtons);break;case"mode":e.mode==="Picker"?c.switchToPicker():c.switchToPalette();break;case"modeSwitcher":c.changeModeSwitcherProp(e.modeSwitcher);break;case"columns":case"presetColors":c.isPicker()||c.changePaletteProps();break;case"noColor":e.noColor?c.mode==="Palette"&&!c.modeSwitcher&&c.setNoColor():c.changePaletteProps();break;case"enableOpacity":c.changeOpacityProps(e.enableOpacity);break}},c=this,u=0,p=Object.keys(e);u<p.length;u++){var f=p[u];h(f)}},t.prototype.focusIn=function(){this.element.parentElement.focus()},Vi([(0,a.Z9)("#008000ff")],t.prototype,"value",void 0),Vi([(0,a.Z9)("")],t.prototype,"cssClass",void 0),Vi([(0,a.Z9)(!1)],t.prototype,"disabled",void 0),Vi([(0,a.Z9)("Picker")],t.prototype,"mode",void 0),Vi([(0,a.Z9)(!0)],t.prototype,"modeSwitcher",void 0),Vi([(0,a.Z9)(null)],t.prototype,"presetColors",void 0),Vi([(0,a.Z9)(!0)],t.prototype,"showButtons",void 0),Vi([(0,a.Z9)(10)],t.prototype,"columns",void 0),Vi([(0,a.Z9)(!1)],t.prototype,"inline",void 0),Vi([(0,a.Z9)(!1)],t.prototype,"noColor",void 0),Vi([(0,a.Z9)(!1)],t.prototype,"enablePersistence",void 0),Vi([(0,a.Z9)(!0)],t.prototype,"enableOpacity",void 0),Vi([(0,a.Z9)(!1)],t.prototype,"createPopupOnClick",void 0),Vi([(0,a.ju)()],t.prototype,"select",void 0),Vi([(0,a.ju)()],t.prototype,"change",void 0),Vi([(0,a.ju)()],t.prototype,"beforeTileRender",void 0),Vi([(0,a.ju)()],t.prototype,"beforeOpen",void 0),Vi([(0,a.ju)()],t.prototype,"open",void 0),Vi([(0,a.ju)()],t.prototype,"beforeClose",void 0),Vi([(0,a.ju)()],t.prototype,"beforeModeSwitch",void 0),Vi([(0,a.ju)()],t.prototype,"onModeSwitch",void 0),Vi([(0,a.ju)()],t.prototype,"created",void 0),t=Vi([a.Zl],t),t}(a.wA),vC=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.render=function(){var t=this,e=this.parent.element.id,i=this.parent.createElement("input",{attrs:{type:"color"}});this.fontColorPicker=new wp({value:"#000000ff",mode:"Palette",showButtons:!1,presetColors:Q1,enableOpacity:!1,beforeClose:function(){return t.beforeCloseHandler(t.fontColorPicker)},open:this.openHandler.bind(this),beforeModeSwitch:function(r){return t.beforeModeSwitch(t.fontColorPicker,r)},change:function(r){var n=t.fontColorPicker.getValue(r.currentValue.rgba),s={style:{color:n},onActionUpdate:!0};t.parent.notify(pe.vbl,s),s.cancel?t.fontColorPicker.setProperties({value:t.fontColorPicker.getValue(r.previousValue.rgba,"HEXA")},!0):t.updateSelectedColor(s.style.color,t.fontColorPicker.element),we(t.parent.element)},created:function(){return t.wireFocusEvent(t.fontColorPicker.element,"#000000")}}),this.fontColorPicker.createElement=this.parent.createElement,this.parent.element.appendChild(i),this.fontColorPicker.appendTo(i),i.parentElement.id=e+"_font_color_picker",(0,a.cn)([i.nextElementSibling.getElementsByClassName("e-selected-color")[0]],["e-icons","e-font-color"]),i=this.parent.createElement("input",{attrs:{type:"color"}}),this.filColorPicker=new wp({value:"#ffff00ff",mode:"Palette",presetColors:J1,showButtons:!1,enableOpacity:!1,open:this.openHandler.bind(this),beforeClose:function(){return t.beforeCloseHandler(t.filColorPicker)},beforeModeSwitch:function(r){return t.beforeModeSwitch(t.filColorPicker,r)},change:function(r){var n=t.filColorPicker.getValue(r.currentValue.rgba),s={style:{backgroundColor:n},onActionUpdate:!0};t.parent.notify(pe.vbl,s),s.cancel?t.filColorPicker.setProperties({value:t.filColorPicker.getValue(r.previousValue.rgba,"HEXA")},!0):t.updateSelectedColor(s.style.backgroundColor,t.filColorPicker.element),we(t.parent.element)},created:function(){return t.wireFocusEvent(t.filColorPicker.element,"#ffff00")}}),this.filColorPicker.createElement=this.parent.createElement,this.parent.element.appendChild(i),this.filColorPicker.appendTo(i),i.parentElement.id=e+"_fill_color_picker",(0,a.cn)([i.nextElementSibling.getElementsByClassName("e-selected-color")[0]],["e-icons","e-fill-color"])},o.prototype.updateSelectedColor=function(t,e){e.nextElementSibling.querySelector(".e-selected-color").style.borderBottomColor=t},o.prototype.wireFocusEvent=function(t,e){var i=this;this.updateSelectedColor(e,t),t=t.parentElement.querySelector(".e-split-colorpicker"),t.addEventListener("focus",function(){we(i.parent.element)})},o.prototype.openHandler=function(t){t.element.querySelector(".e-mode-switch-btn").title=this.parent.serviceLocator.getService(Ve).getConstant("MoreColors")},o.prototype.beforeCloseHandler=function(t){t.modeSwitcher||t.setProperties({modeSwitcher:!0},!0),t.showButtons&&t.setProperties({showButtons:!1},!0)},o.prototype.beforeModeSwitch=function(t,e){var i=this.parent.serviceLocator.getService(Ve);e.mode==="Picker"?(t.showButtons=!0,t.dataBind(),e.element.querySelector(".e-apply").title=i.getConstant("Apply"),e.element.querySelector(".e-cancel").title=i.getConstant("Cancel"),e.element.querySelector(".e-mode-switch-btn").title=i.getConstant("StandardColors")):(t.showButtons=!1,t.dataBind(),e.element.querySelector(".e-mode-switch-btn").title=i.getConstant("MoreColors"))},o.prototype.destroy=function(){this.parent&&(this.removeEventListener(),this.fontColorPicker.destroy(),this.fontColorPicker=null,this.filColorPicker.destroy(),this.filColorPicker=null,this.parent=null)},o.prototype.addEventListener=function(){this.parent.on(E.c,this.render,this),this.parent.on("destroyRibbonComponents",this.destroy,this),this.parent.on(E.xn,this.destroy,this)},o.prototype.removeEventListener=function(){this.parent.off(E.c,this.render),this.parent.off("destroyRibbonComponents",this.destroy),this.parent.on(E.xn,this.destroy,this)},o}(),xp=["north-west","north","north-east","west","east","south-west","south","south-east"],Bh="e-resize-handle",aa="e-focused-handle",mC="e-dlg-resizable",Ov=["e-restrict-left"],Rv="e-resize-viewport",gC=["north","west","east","south"],ci,Ln,Ep=0,Ap=0,Mv=0,Pv=0,el=0,tl=0,Xa,Ss,Tp,Qn,Xt,il=null,Lp=null,kp=null,ws,Fh=!0,Nv=0,Ip=!0,xs;function yC(o){il=o.resizeBegin,Lp=o.resizing,kp=o.resizeComplete,ci=Bv(o.element),Xt=Bv(o.boundary);for(var t=o.direction.split(" "),e=0;e<t.length;e++)if(gC.indexOf(t[e])>=0&&t[e])bC(t[e]);else if(t[e].trim()!==""){var i=(0,a.az)("div",{className:"e-icons "+Bh+" e-"+t[e]});ci.appendChild(i)}Xa=o.minHeight,Tp=o.minWidth,Qn=o.maxWidth,Ss=o.maxHeight,o.proxy&&o.proxy.element&&o.proxy.element.classList.contains("e-dialog")?Fv(o.proxy):Fv()}function bC(o){Dp();var t=(0,a.az)("span",{attrs:{unselectable:"on",contenteditable:"false"}});t.setAttribute("class","e-dialog-border-resize e-"+o),o==="south"&&(t.style.height="2px",t.style.width="100%",t.style.bottom="0px",t.style.left="0px"),o==="north"&&(t.style.height="2px",t.style.width="100%",t.style.top="0px",t.style.left="0px"),o==="east"&&(t.style.height="100%",t.style.width="2px",t.style.right="0px",t.style.top="0px"),o==="west"&&(t.style.height="100%",t.style.width="2px",t.style.left="0px",t.style.top="0px"),ci.appendChild(t)}function Bv(o){var t;return(0,a.le)(o)||(typeof o=="string"?t=document.querySelector(o):t=o),t}function Fv(o){(0,a.le)(o)&&(o=this);for(var t=ci.querySelectorAll("."+Bh),e=0;e<t.length;e++){Ln=t[e],a.bi.add(Ln,"mousedown",Vv,o);var i=a.AR.info.name==="msie"?"pointerdown":"touchstart";a.bi.add(Ln,i,zv,o)}var r=ci.querySelectorAll(".e-dialog-border-resize");if(!(0,a.le)(r))for(var e=0;e<r.length;e++){Ln=r[e],a.bi.add(Ln,"mousedown",Vv,o);var i=a.AR.info.name==="msie"?"pointerdown":"touchstart";a.bi.add(Ln,i,zv,o)}}function Hv(o){return o.indexOf("mouse")>-1?"mouse":"touch"}function Vv(o){if(o.preventDefault(),ci=o.target.parentElement,Dp(),el=o.pageX,tl=o.pageY,o.target.classList.add(aa),!(!(0,a.le)(il)&&(xs=this,il(o,xs)===!0))){this.targetEle&&ci&&ci.querySelector("."+mC)&&(Xt=(this.target,null),Qn=this.targetEle.clientWidth,Ss=this.targetEle.clientHeight);var t=(0,a.le)(Xt)?document:Xt;a.bi.add(t,"mousemove",rl,this),a.bi.add(document,"mouseup",Hh,this);for(var e=0;e<Ov.length;e++)ci.classList.contains(Ov[e])?Fh=!1:Fh=!0}}function Hh(o){var t=a.AR.info.name==="msie"?"pointermove":"touchmove",e=a.AR.info.name==="msie"?"pointerup":"touchend",i=(0,a.le)(Xt)?document:Xt,r=a.AR.info.name==="msie"?"pointerdown":"touchstart";a.bi.remove(i,"mousemove",rl),a.bi.remove(i,t,rl),a.bi.remove(i,r,rl),(0,a.le)(document.body.querySelector("."+aa))||document.body.querySelector("."+aa).classList.remove(aa),(0,a.le)(kp)||(xs=this,kp(o,xs)),a.bi.remove(document,"mouseup",Hh),a.bi.remove(document,e,Hh)}function Dp(){Ep=parseFloat(getComputedStyle(ci,null).getPropertyValue("width").replace("px","")),Ap=parseFloat(getComputedStyle(ci,null).getPropertyValue("height").replace("px","")),Mv=ci.getBoundingClientRect().left,Pv=ci.getBoundingClientRect().top}function zv(o){ci=o.target.parentElement,Dp();var t=o.touches?o.changedTouches[0]:o;if(el=t.pageX,tl=t.pageY,!(!(0,a.le)(il)&&(xs=this,il(o,xs)===!0))){var e=a.AR.info.name==="msie"?"pointermove":"touchmove",i=a.AR.info.name==="msie"?"pointerup":"touchend",r=(0,a.le)(Xt)?document:Xt;a.bi.add(r,e,rl,this),a.bi.add(document,i,Hh)}}function rl(o){if(o.target.classList.contains(Bh)&&o.target.classList.contains(aa)?Ln=o.target:(0,a.le)(document.body.querySelector("."+aa))||(Ln=document.body.querySelector("."+aa)),!(0,a.le)(Ln)){for(var t="",e=0;e<xp.length;e++)Ln.classList.contains("e-"+xp[e])&&(t=xp[e]);switch((0,a.le)(Lp)||(xs=this,Lp(o,xs)),t){case"south":Op(o);break;case"north":Rp(o);break;case"west":Mp(o);break;case"east":Pp(o);break;case"south-east":Op(o),Pp(o);break;case"south-west":Op(o),Mp(o);break;case"north-east":Rp(o),Pp(o);break;case"north-west":Rp(o),Mp(o);break;default:break}}}function Es(o){return o.getBoundingClientRect()}function Op(o){var t=document.documentElement.clientHeight,e=!1,i=o.touches?o.changedTouches[0]:o,r=i.pageY,n=Es(ci),s;(0,a.le)(Xt)||(s=Es(Xt)),(0,a.le)(Xt)?(0,a.le)(Xt)&&(t-r>=0||n.top<0)&&(e=!0):e=!0;var l=Ap+(r-tl);l=l>Xa?l:Xa;var h=0;(0,a.le)(Xt)||(h=s.top);var c=(0,a.le)(Xt)?0:Xt.offsetHeight-Xt.clientHeight,u=n.top-h-c/2;if(u=u<0?0:u,n.top>0&&u+l>Ss){if(e=!1,ci.classList.contains(Rv))return;ci.style.height=Ss-parseInt(u.toString(),10)+"px";return}var p=0;if(e){n.top<0&&t+(n.height+n.top)>0&&(p=n.top,l+p<=30&&(l=n.height-(n.height+n.top)+30)),l+n.top>=Ss&&(ci.style.height=n.height+(t-(n.height+n.top))+"px");var f=(0,a.le)(Xt)?p:u;l>=Xa&&l+f<=Ss&&(ci.style.height=l+"px")}}function Rp(o){var t=!1,e,i=Hv(o.type)==="mouse"?o.pageY:o.touches[0].pageY,r=Es(ci);(0,a.le)(Xt)||(e=Es(Xt)),(!(0,a.le)(Xt)&&r.top-e.top>0||(0,a.le)(Xt)&&i>0)&&(t=!0);var n=Ap-(i-tl);if(t&&n>=Xa&&n<=Ss){var s=0;(0,a.le)(Xt)||(s=e.top);var l=Pv-s+(i-tl);l=l>0?l:1,ci.style.height=n+"px",ci.style.top=l+"px"}}function Mp(o){var t=document.documentElement.clientWidth,e=!1,i;(0,a.le)(Xt)||(i=Es(Xt));var r=Hv(o.type)==="mouse"?o.pageX:o.touches[0].pageX,n=Es(ci),s=(0,a.le)(Xt)?0:Xt.offsetWidth-Xt.clientWidth,l=(0,a.le)(Xt)?0:i.left,h=(0,a.le)(Xt)?0:i.width;(0,a.le)(ws)&&((0,a.le)(Xt)?ws=t:(ws=n.left-l-s/2+n.width,ws=ws+(h-s-ws))),(!(0,a.le)(Xt)&&Math.floor(n.left-i.left+n.width+(i.right-n.right))-s<=Qn||(0,a.le)(Xt)&&r>=0)&&(e=!0);var c=Ep-(r-el);if(Fh&&(c=c>ws?ws:c),e&&c>=Tp&&c<=Qn){var u=0;(0,a.le)(Xt)||(u=i.left);var p=Mv-u+(r-el);p=p>0?p:1,c!==Nv&&Ip&&(ci.style.width=c+"px"),Fh&&(ci.style.left=p+"px",p===1?Ip=!1:Ip=!0)}Nv=c}function Pp(o){var t=document.documentElement.clientWidth,e=!1,i;(0,a.le)(Xt)||(i=Es(Xt));var r=o.touches?o.changedTouches[0]:o,n=r.pageX,s=Es(ci);(!(0,a.le)(Xt)&&(s.left-i.left+s.width<=Qn||s.right-i.left>=s.width)||(0,a.le)(Xt)&&t-n>0)&&(e=!0);var l=Ep+(n-el),h=0;if((0,a.le)(Xt)||(h=i.left),s.left-h+l>Qn){if(e=!1,ci.classList.contains(Rv))return;ci.style.width=Qn-(s.left-h)+"px"}e&&l>=Tp&&l<=Qn&&(ci.style.width=l+"px")}function CC(o){Xa=o}function SC(o){Qn=o}function wC(o){Ss=o}function _v(){for(var o=ci.querySelectorAll("."+Bh),t=0;t<o.length;t++)(0,a.og)(o[t]);var e=ci.querySelectorAll(".e-dialog-border-resize");if(!(0,a.le)(e))for(var t=0;t<e.length;t++)(0,a.og)(e[t])}var Np=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),_t=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},xC=function(o){Np(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return _t([(0,a.Z9)(!0)],t.prototype,"isFlat",void 0),_t([(0,a.Z9)()],t.prototype,"buttonModel",void 0),_t([(0,a.Z9)("Button")],t.prototype,"type",void 0),_t([(0,a.ju)()],t.prototype,"click",void 0),t}(a.rt),EC=function(o){Np(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return _t([(0,a.Z9)("Fade")],t.prototype,"effect",void 0),_t([(0,a.Z9)(400)],t.prototype,"duration",void 0),_t([(0,a.Z9)(0)],t.prototype,"delay",void 0),t}(a.rt),Vh="e-dialog",Bp="e-rtl",Fp="e-dlg-header-content",jv="e-dlg-header",nl="e-footer-content",Hp="e-dlg-modal",AC="e-dlg-content",Wv="e-icon-dlg-close",TC="e-dlg-overlay",kn="e-dlg-target",LC="e-dlg-container",yn="e-scroll-disabled",kC="e-primary",IC="e-icons",DC="e-popup",Uv="e-device",zh="e-dlg-fullscreen",qv="e-dlg-closeicon-btn",OC="e-popup-close",Zv="e-popup-open",Vp="Information",Yv="e-scroll-disabled",Gv="e-alert-dialog",Kv="e-confirm-dialog",zp="e-dlg-resizable",_h="e-restrict-left",Xv="e-resize-viewport",RC="e-dlg-ref-element",_p="user action",MC="close icon",PC="escape",NC="overlayClick",sl=function(o){Np(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.dlgClosedBy=_p,r}return t.prototype.render=function(){this.initialize(),this.initRender(),this.wireEvents(),this.width==="100%"&&(this.element.style.width=""),this.minHeight!==""&&(this.element.style.minHeight=(0,a.Ac)(this.minHeight)),this.enableResize&&(this.setResize(),this.animationSettings.effect==="None"&&this.getMinHeight()),this.renderComplete()},t.prototype.preRender=function(){var e=this;this.headerContent=null,this.allowMaxHeight=!0,this.preventVisibility=!0,this.clonedEle=this.element.cloneNode(!0),this.closeIconClickEventHandler=function(n){e.dlgClosedBy=MC,e.hide(n)},this.dlgOverlayClickEventHandler=function(n){e.dlgClosedBy=NC,n.preventFocus=!1,e.trigger("overlayClick",n,function(s){s.preventFocus||e.focusContent(),e.dlgClosedBy=_p})};var i={close:"Close"};if(this.l10n=new a.E7("dialog",i,this.locale),this.checkPositionData(),(0,a.le)(this.target)){var r=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.target=document.body,this.isProtectedOnChange=r}},t.prototype.isNumberValue=function(e){var i=/^[-+]?\d*\.?\d+$/.test(e);return i},t.prototype.checkPositionData=function(){if(!(0,a.le)(this.position)){if(!(0,a.le)(this.position.X)&&typeof this.position.X!="number"){var e=this.isNumberValue(this.position.X);if(e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.X=parseFloat(this.position.X),this.isProtectedOnChange=i}}if(!(0,a.le)(this.position.Y)&&typeof this.position.Y!="number"){var e=this.isNumberValue(this.position.Y);if(e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.position.Y=parseFloat(this.position.Y),this.isProtectedOnChange=i}}}},t.prototype.getEle=function(e,i){for(var r=void 0,n=0;n<e.length;n++)if(e[n].classList.contains(i)){r=e[n];break}return r},t.prototype.getMinHeight=function(){var e="0px",i="0px";(0,a.le)(this.element.querySelector("."+Fp))||(e=getComputedStyle(this.headerContent).height);var r=this.getEle(this.element.children,nl);(0,a.le)(r)||(i=getComputedStyle(r).height);var n=parseInt(e.slice(0,e.indexOf("p")),10),s=parseInt(i.slice(0,i.indexOf("p")),10);return CC(n+30+(isNaN(s)?0:s)),n+30+s},t.prototype.onResizeStart=function(e,i){return i.trigger("resizeStart",e),e.cancel},t.prototype.onResizing=function(e,i){i.trigger("resizing",e)},t.prototype.onResizeComplete=function(e,i){i.trigger("resizeStop",e)},t.prototype.setResize=function(){if(this.enableResize){if(this.isBlazorServerRender()&&!(0,a.le)(this.element.querySelector(".e-icons.e-resize-handle")))return;this.element.classList.add(zp);for(var e=getComputedStyle(this.element).minHeight,i=getComputedStyle(this.element).minWidth,r="",n=0;n<this.resizeHandles.length;n++)if(this.resizeHandles[n]==="All"){r="south north east west north-east north-west south-east south-west";break}else{var s="";switch(this.resizeHandles[n].toString()){case"SouthEast":s="south-east";break;case"SouthWest":s="south-west";break;case"NorthEast":s="north-east";break;case"NorthWest":s="north-west";break;default:s=this.resizeHandles[n].toString();break}r+=s.toLocaleLowerCase()+" "}this.enableRtl&&r.trim()==="south-east"?r="south-west":this.enableRtl&&r.trim()==="south-west"&&(r="south-east"),this.isModal&&this.enableRtl?this.element.classList.add(_h):this.isModal&&this.target===document.body&&this.element.classList.add(Xv),yC({element:this.element,direction:r,minHeight:parseInt(e.slice(0,i.indexOf("p")),10),maxHeight:this.targetEle.clientHeight,minWidth:parseInt(i.slice(0,i.indexOf("p")),10),maxWidth:this.targetEle.clientWidth,boundary:this.target===document.body?null:this.targetEle,resizeBegin:this.onResizeStart.bind(this),resizeComplete:this.onResizeComplete.bind(this),resizing:this.onResizing.bind(this),proxy:this}),this.wireWindowResizeEvent()}else _v(),this.unWireWindowResizeEvent(),this.isModal?this.element.classList.remove(_h):this.element.classList.remove(Xv),this.element.classList.remove(zp)},t.prototype.getFocusElement=function(e){var i='input,select,textarea,button:enabled,a,[contenteditable="true"],[tabindex]',r=e.querySelectorAll(i);return{element:r[r.length-1]}},t.prototype.keyDown=function(e){var i=this;if(e.keyCode===9&&this.isModal){var r=void 0;(0,a.le)(this.btnObj)||(r=this.btnObj[this.btnObj.length-1]),(0,a.le)(this.btnObj)&&!(0,a.le)(this.ftrTemplateContent)&&(r=this.getFocusElement(this.ftrTemplateContent)),(0,a.le)(this.btnObj)&&(0,a.le)(this.ftrTemplateContent)&&!(0,a.le)(this.contentEle)&&(r=this.getFocusElement(this.contentEle)),!(0,a.le)(r)&&document.activeElement===r.element&&!e.shiftKey&&(e.preventDefault(),this.focusableElements(this.element).focus()),document.activeElement===this.focusableElements(this.element)&&e.shiftKey&&(e.preventDefault(),(0,a.le)(r)||r.element.focus())}var n=document.activeElement,s=["input","textarea"].indexOf(n.tagName.toLowerCase())>-1,l=!1;if(s||(l=n.hasAttribute("contenteditable")&&n.getAttribute("contenteditable")==="true"),e.keyCode===27&&this.closeOnEscape&&(this.dlgClosedBy=PC,document.querySelector(".e-popup-open:not(.e-dialog)")||this.hide(e)),e.keyCode===13&&!e.ctrlKey&&n.tagName.toLowerCase()!=="textarea"&&s&&!(0,a.le)(this.primaryButtonEle)||e.keyCode===13&&e.ctrlKey&&(n.tagName.toLowerCase()==="textarea"||l)&&!(0,a.le)(this.primaryButtonEle)){var h,c=this.buttons.some(function(u,p){h=p;var f=u.buttonModel;return!(0,a.le)(f)&&f.isPrimary===!0});c&&typeof this.buttons[h].click=="function"&&setTimeout(function(){i.buttons[h].click.call(i,e)})}},t.prototype.initialize=function(){(0,a.le)(this.target)||(this.targetEle=typeof this.target=="string"?document.querySelector(this.target):this.target),this.isBlazorServerRender()||(0,a.cn)([this.element],Vh),a.AR.isDevice&&(0,a.cn)([this.element],Uv),this.isBlazorServerRender()||this.setCSSClass(),this.setMaxHeight()},t.prototype.initRender=function(){var e=this;if(this.initialRender=!0,this.isBlazorServerRender()||(0,a.Y4)(this.element,{role:"dialog"}),this.zIndex===1e3?(this.setzIndex(this.element,!1),this.calculatezIndex=!0):this.calculatezIndex=!1,this.isBlazorServerRender()&&(0,a.le)(this.headerContent)&&(this.headerContent=this.element.getElementsByClassName("e-dlg-header-content")[0]),this.isBlazorServerRender()&&(0,a.le)(this.contentEle)&&(this.contentEle=this.element.querySelector("#"+this.element.id+"_dialog-content")),this.isBlazorServerRender()||(this.setTargetContent(),this.header!==""&&!(0,a.le)(this.header)&&this.setHeader(),this.renderCloseIcon(),this.setContent(),this.footerTemplate!==""&&!(0,a.le)(this.footerTemplate)?this.setFooterTemplate():(0,a.le)(this.buttons[0].buttonModel)||this.setButton()),this.isBlazorServerRender()&&!(0,a.le)(this.buttons[0].buttonModel)&&this.footerTemplate===""&&this.setButton(),this.allowDragging&&!(0,a.le)(this.headerContent)&&this.setAllowDragging(),this.isBlazorServerRender()||((0,a.Y4)(this.element,{"aria-modal":this.isModal?"true":"false"}),this.isModal&&this.setIsModal()),this.isBlazorServerRender()&&(0,a.le)(this.dlgContainer)){this.dlgContainer=this.element.parentElement;for(var i=0,r=this.dlgContainer.children;i<r.length;i++)r[i].classList.contains("e-dlg-overlay")&&(this.dlgOverlay=r[i])}if(this.element.classList.contains(Gv)!==!0&&this.element.classList.contains(Kv)!==!0&&!(0,a.le)(this.element.parentElement)){var n=this.isModal?this.dlgContainer.parentElement:this.element.parentElement;this.refElement=this.createElement("div",{className:RC}),n.insertBefore(this.refElement,this.isModal?this.dlgContainer:this.element)}(0,a.le)(this.targetEle)||(this.isModal?this.targetEle.appendChild(this.dlgContainer):this.targetEle.appendChild(this.element)),this.popupObj=new br(this.element,{height:this.height,width:this.width,zIndex:this.zIndex,relateTo:this.target,actionOnScroll:"none",enableRtl:this.enableRtl,open:function(s){var l={container:e.isModal?e.dlgContainer:e.element,element:e.element,target:e.target,preventFocus:!1};e.enableResize&&e.resetResizeIcon(),e.trigger("open",l,function(h){h.preventFocus||e.focusContent()})},close:function(s){e.isModal&&(0,a.cn)([e.dlgOverlay],"e-fade"),e.unBindEvent(e.element),e.isModal&&(e.dlgContainer.style.display="none"),e.trigger("close",e.closeArgs);var l=document.activeElement;!(0,a.le)(l)&&!(0,a.le)(l.blur)&&l.blur(),!(0,a.le)(e.storeActiveElement)&&!(0,a.le)(e.storeActiveElement.focus)&&e.storeActiveElement.focus()}}),this.positionChange(),this.setEnableRTL(),this.isBlazorServerRender()||((0,a.cn)([this.element],OC),this.isModal&&this.setOverlayZindex()),this.visible?this.show():this.isModal&&(this.dlgOverlay.style.display="none"),this.initialRender=!1},t.prototype.resetResizeIcon=function(){var e=this.getMinHeight();if(this.targetEle.offsetHeight<e){var i=this.enableRtl?"e-south-west":"e-south-east",r=this.element.querySelector("."+i);(0,a.le)(r)||(r.style.bottom="-"+e.toString()+"px")}},t.prototype.setOverlayZindex=function(e){var i;(0,a.le)(e)?i=parseInt(this.element.style.zIndex,10)?parseInt(this.element.style.zIndex,10):this.zIndex:i=e,this.dlgOverlay.style.zIndex=(i-1).toString(),this.dlgContainer.style.zIndex=i.toString()},t.prototype.positionChange=function(){this.isModal?!isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():!isNaN(parseFloat(this.position.X))&&isNaN(parseFloat(this.position.Y))||isNaN(parseFloat(this.position.X))&&!isNaN(parseFloat(this.position.Y))?this.setPopupPosition():(this.element.style.top="0px",this.element.style.left="0px",this.dlgContainer.classList.add("e-dlg-"+this.position.X+"-"+this.position.Y)):this.setPopupPosition()},t.prototype.setPopupPosition=function(){this.popupObj.setProperties({position:{X:this.position.X,Y:this.position.Y}})},t.prototype.setAllowDragging=function(){var e=this,i="."+Fp;this.dragObj=new a._l(this.element,{clone:!1,isDragScroll:!0,abort:".e-dlg-closeicon-btn",handle:i,dragStart:function(r){e.trigger("dragStart",r,function(n){(0,a.xr)()&&n.bindEvents(r.dragElement)})},dragStop:function(r){e.isModal&&((0,a.le)(e.position)||e.dlgContainer.classList.remove("e-dlg-"+e.position.X+"-"+e.position.Y),e.element.style.position="relative"),e.trigger("dragStop",r),e.element.classList.remove(_h)},drag:function(r){e.trigger("drag",r)}}),(0,a.le)(this.targetEle)||(this.dragObj.dragArea=this.targetEle)},t.prototype.setButton=function(){if(!this.isBlazorServerRender()){this.buttonContent=[],this.btnObj=[];for(var e=!0,i=0;i<this.buttons.length;i++){var r=(0,a.le)(this.buttons[i].type)?"button":this.buttons[i].type.toLowerCase(),n=this.createElement("button",{attrs:{type:r}});this.buttonContent.push(n.outerHTML)}this.setFooterTemplate()}for(var s,i=0,l=this.element.children;i<l.length;i++)l[i].classList.contains(nl)&&(s=l[i].querySelectorAll("button"));for(var i=0;i<this.buttons.length;i++)this.isBlazorServerRender()||(this.btnObj[i]=new $r(this.buttons[i].buttonModel)),this.isBlazorServerRender()&&(this.ftrTemplateContent=this.element.querySelector("."+nl)),!(0,a.le)(this.ftrTemplateContent)&&s.length>0&&(typeof this.buttons[i].click=="function"&&a.bi.add(s[i],"click",this.buttons[i].click,this),typeof this.buttons[i].click=="object"&&a.bi.add(s[i],"click",this.buttonClickHandler.bind(this,i),this)),!this.isBlazorServerRender()&&!(0,a.le)(this.ftrTemplateContent)&&(this.btnObj[i].appendTo(this.ftrTemplateContent.children[i]),this.buttons[i].isFlat&&this.btnObj[i].element.classList.add("e-flat"),this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0])},t.prototype.buttonClickHandler=function(e){this.trigger("buttons["+e+"].click",{})},t.prototype.setContent=function(){if((0,a.Y4)(this.element,{"aria-describedby":this.element.id+"_dialog-content"}),this.contentEle=this.createElement("div",{className:AC,id:this.element.id+"_dialog-content"}),this.innerContentElement)this.contentEle.appendChild(this.innerContentElement);else if(!(0,a.le)(this.content)&&this.content!==""||!this.initialRender){var e=Object.keys(window);typeof this.content=="string"&&!(0,a.xr)()?this.setTemplate(this.content,this.contentEle,"content"):this.content instanceof HTMLElement?this.contentEle.appendChild(this.content):this.setTemplate(this.content,this.contentEle,"content")}(0,a.le)(this.headerContent)?this.element.insertBefore(this.contentEle,this.element.children[0]):this.element.insertBefore(this.contentEle,this.element.children[1]),this.height==="auto"&&(!this.isBlazorServerRender()&&a.AR.isIE&&this.element.style.width===""&&!(0,a.le)(this.width)&&(this.element.style.width=(0,a.Ac)(this.width)),this.setMaxHeight())},t.prototype.setTemplate=function(e,i,r){var n,s,l=Object.keys(window);i.classList.contains(jv)?s=this.element.id+"header":i.classList.contains(nl)?s=this.element.id+"footerTemplate":s=this.element.id+"content";var h;(0,a.le)(e.outerHTML)?(typeof e=="string"||typeof e!="string"||(0,a.xr)()&&!this.isStringTemplate)&&(typeof e=="string"&&(e=this.sanitizeHelper(e)),n=(0,a.MY)(e),h=e):i.appendChild(e);var c=[];if(!(0,a.le)(n)){for(var u=(0,a.xr)()&&!this.isStringTemplate&&h.indexOf("<div>Blazor")===0?this.isStringTemplate:!0,p=0,f=n({},this,r,s,u);p<f.length;p++){var g=f[p];c.push(g)}(0,a.R3)([].slice.call(c),i)}},t.prototype.sanitizeHelper=function(e){if(this.enableHtmlSanitizer){var i=a.pJ.beforeSanitize(),r={cancel:!1,helper:null};(0,a.l7)(i,i,r),this.trigger("beforeSanitizeHtml",i),i.cancel&&!(0,a.le)(i.helper)?e=i.helper(e):i.cancel||(e=a.pJ.serializeValue(i,e))}return e},t.prototype.setMaxHeight=function(){if(!!this.allowMaxHeight){var e=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=!(0,a.le)(this.target)&&this.targetEle.offsetHeight<window.innerHeight?this.targetEle.offsetHeight-20+"px":window.innerHeight-20+"px",this.element.style.display=e,a.AR.isIE&&this.height==="auto"&&!(0,a.le)(this.contentEle)&&this.element.offsetHeight<this.contentEle.offsetHeight&&(this.element.style.height="inherit")}},t.prototype.setEnableRTL=function(){this.isBlazorServerRender()||(this.enableRtl?(0,a.cn)([this.element],Bp):(0,a.IV)([this.element],Bp)),(0,a.le)(this.element.querySelector(".e-resize-handle"))||(_v(),this.setResize())},t.prototype.setTargetContent=function(){var e=this;if((0,a.le)(this.content)||this.content===""){var i=this.element.innerHTML.replace(/\s|<(\/?|\/?)(!--!--)>/g,"")!=="";(this.element.children.length>0||i)&&(this.innerContentElement=document.createDocumentFragment(),[].slice.call(this.element.childNodes).forEach(function(r){r.nodeType!==8&&e.innerContentElement.appendChild(r)}))}},t.prototype.setHeader=function(){this.headerEle?this.headerEle.innerHTML="":this.headerEle=this.createElement("div",{id:this.element.id+"_title",className:jv}),this.createHeaderContent(),this.headerContent.appendChild(this.headerEle),this.setTemplate(this.header,this.headerEle,"header"),(0,a.Y4)(this.element,{"aria-labelledby":this.element.id}),this.element.insertBefore(this.headerContent,this.element.children[0])},t.prototype.setFooterTemplate=function(){this.ftrTemplateContent?this.ftrTemplateContent.innerHTML="":this.ftrTemplateContent=this.createElement("div",{className:nl}),this.footerTemplate!==""&&!(0,a.le)(this.footerTemplate)?this.setTemplate(this.footerTemplate,this.ftrTemplateContent,"footerTemplate"):this.ftrTemplateContent.innerHTML=this.buttonContent.join(""),this.element.appendChild(this.ftrTemplateContent)},t.prototype.createHeaderContent=function(){(0,a.le)(this.headerContent)&&(this.headerContent=this.createElement("div",{id:this.element.id+"_dialog-header",className:Fp}))},t.prototype.renderCloseIcon=function(){this.showCloseIcon&&(this.closeIcon=this.createElement("button",{className:qv,attrs:{type:"button"}}),this.closeIconBtnObj=new $r({cssClass:"e-flat",iconCss:Wv+" "+IC}),this.closeIconTitle(),(0,a.le)(this.headerContent)?(this.createHeaderContent(),(0,a.Ce)([this.closeIcon],this.headerContent),this.element.insertBefore(this.headerContent,this.element.children[0])):(0,a.Ce)([this.closeIcon],this.headerContent),this.closeIconBtnObj.appendTo(this.closeIcon))},t.prototype.closeIconTitle=function(){this.l10n.setLocale(this.locale);var e=this.l10n.getConstant("close");this.closeIcon.setAttribute("title",e),this.closeIcon.setAttribute("aria-label",e)},t.prototype.setCSSClass=function(e){this.cssClass&&(0,a.cn)([this.element],this.cssClass.split(" ")),e&&(0,a.IV)([this.element],e.split(" "))},t.prototype.setIsModal=function(){this.dlgContainer=this.createElement("div",{className:LC}),this.element.classList.remove(Zv),this.element.parentNode.insertBefore(this.dlgContainer,this.element),this.dlgContainer.appendChild(this.element),(0,a.cn)([this.element],Hp),this.dlgOverlay=this.createElement("div",{className:TC}),this.dlgOverlay.style.zIndex=(this.zIndex-1).toString(),this.dlgContainer.appendChild(this.dlgOverlay)},t.prototype.getValidFocusNode=function(e){for(var i,r=0;r<e.length;r++){if(i=e[r],(i.clientHeight>0||i.tagName.toLowerCase()==="a"&&i.hasAttribute("href"))&&i.tabIndex>-1&&!i.disabled&&!this.disableElement(i,'[disabled],[aria-disabled="true"],[type="hidden"]'))return i;i=null}return i},t.prototype.focusableElements=function(e){if(!(0,a.le)(e)){var i='input,select,textarea,button,a,[contenteditable="true"],[tabindex]',r=e.querySelectorAll(i);return this.getValidFocusNode(r)}return null},t.prototype.getAutoFocusNode=function(e){var i=e.querySelector("."+qv),r="[autofocus]",n=e.querySelectorAll(r),s=this.getValidFocusNode(n);if((0,a.xr)()&&(this.primaryButtonEle=this.element.getElementsByClassName("e-primary")[0]),!(0,a.le)(s))i=s;else if(s=this.focusableElements(this.contentEle),(0,a.le)(s)){if(!(0,a.le)(this.primaryButtonEle))return this.element.querySelector("."+kC)}else return i=s;return i},t.prototype.disableElement=function(e,i){var r=e?e.matches||e.webkitMatchesSelector||e.msGetRegionContent:null;if(r){for(;e;e=e.parentNode)if(e instanceof Element&&r.call(e,i))return e}return null},t.prototype.focusContent=function(){var e=this.getAutoFocusNode(this.element),i=(0,a.le)(e)?this.element:e,r=a.AR.userAgent;(r.indexOf("MSIE ")>0||r.indexOf("Trident/")>0)&&this.element.focus(),i.focus(),this.bindEvent(this.element)},t.prototype.bindEvent=function(e){a.bi.add(e,"keydown",this.keyDown,this)},t.prototype.unBindEvent=function(e){a.bi.remove(e,"keydown",this.keyDown)},t.prototype.updateSanitizeContent=function(){this.isBlazorServerRender()||(this.contentEle.innerHTML=this.sanitizeHelper(this.content))},t.prototype.isBlazorServerRender=function(){return(0,a.xr)()&&this.isServerRendered},t.prototype.getModuleName=function(){return"dialog"},t.prototype.onPropertyChanged=function(e,i){if(!!this.element.classList.contains(Vh))for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"content":!(0,a.le)(this.content)&&this.content!==""?(this.isBlazorServerRender()&&(this.contentEle=this.element.querySelector(".e-dlg-content")),!(0,a.le)(this.contentEle)&&this.contentEle.getAttribute("role")!=="dialog"?(this.isBlazorServerRender()||(this.contentEle.innerHTML=""),typeof this.content=="function"?(this.clearTemplate(["content"]),(0,a.og)(this.contentEle),this.contentEle=null,this.setContent()):typeof this.content=="string"?this.isBlazorServerRender()&&this.contentEle.innerText===""?this.contentEle.insertAdjacentHTML("beforeend",this.sanitizeHelper(this.content)):this.updateSanitizeContent():this.contentEle.appendChild(this.content),this.setMaxHeight()):(!this.isBlazorServerRender()||(0,a.le)(this.element.querySelector(".e-dlg-content")))&&this.setContent()):(0,a.le)(this.contentEle)||((0,a.og)(this.contentEle),this.contentEle=null);break;case"header":this.header===""||(0,a.le)(this.header)?this.headerEle&&((0,a.og)(this.headerEle),this.headerEle=null):(!this.isBlazorServerRender()||(0,a.le)(this.element.querySelector(".e-dlg-header-content")))&&this.setHeader();break;case"footerTemplate":if(this.footerTemplate===""||(0,a.le)(this.footerTemplate)){if(!this.ftrTemplateContent)return;(0,a.og)(this.ftrTemplateContent),this.ftrTemplateContent=null,this.buttons=[{}]}else(!this.isBlazorServerRender()||(0,a.le)(this.element.querySelector(".e-footer-content")))&&this.setFooterTemplate(),this.buttons=[{}];break;case"showCloseIcon":this.element.getElementsByClassName(Wv).length>0?!this.showCloseIcon&&(this.header===""||(0,a.le)(this.header))?((0,a.og)(this.headerContent),this.headerContent=null):this.showCloseIcon?this.isBlazorServerRender()&&this.wireEvents():(0,a.og)(this.closeIcon):(this.isBlazorServerRender()||this.renderCloseIcon(),this.wireEvents());break;case"locale":this.showCloseIcon&&this.closeIconTitle();break;case"visible":this.visible?this.show():this.hide();break;case"isModal":this.updateIsModal();break;case"height":(0,a.V7)(this.element,{height:(0,a.Ac)(e.height)});break;case"width":(0,a.V7)(this.element,{width:(0,a.Ac)(e.width)});break;case"zIndex":this.popupObj.zIndex=this.zIndex,this.isModal&&this.setOverlayZindex(this.zIndex),this.element.style.zIndex!==this.zIndex.toString()&&(this.calculatezIndex=!1);break;case"cssClass":this.setCSSClass(i.cssClass);break;case"buttons":{var l=this.buttons.length;!(0,a.le)(this.ftrTemplateContent)&&!this.isBlazorServerRender()&&((0,a.og)(this.ftrTemplateContent),this.ftrTemplateContent=null);for(var h=0;h<l;h++)(0,a.le)(this.buttons[h].buttonModel)||(this.footerTemplate="",this.setButton());break}case"allowDragging":this.allowDragging&&!(0,a.le)(this.headerContent)?this.setAllowDragging():this.dragObj.destroy();break;case"target":this.setTarget(e.target);break;case"position":if(this.checkPositionData(),this.isModal){var c=(0,a.le)(i.position.X)?this.position.X:i.position.X,u=(0,a.le)(i.position.Y)?this.position.Y:i.position.Y;this.dlgContainer.classList.contains("e-dlg-"+c+"-"+u)&&this.dlgContainer.classList.remove("e-dlg-"+c+"-"+u)}this.positionChange();break;case"enableRtl":this.setEnableRTL();break;case"enableResize":this.setResize();break}}},t.prototype.setTarget=function(e){this.popupObj.relateTo=e,this.target=e,this.targetEle=typeof this.target=="string"?document.querySelector(this.target):this.target,this.dragObj&&(this.dragObj.dragArea=this.targetEle),this.setMaxHeight(),this.isModal&&this.updateIsModal(),this.enableResize&&this.setResize()},t.prototype.updateIsModal=function(){if(this.element.setAttribute("aria-modal",this.isModal?"true":"false"),this.isModal)(0,a.le)(this.dlgOverlay)&&(this.setIsModal(),this.element.style.top="0px",this.element.style.left="0px",(0,a.le)(this.targetEle)||this.targetEle.appendChild(this.dlgContainer));else{for((0,a.IV)([this.element],Hp),(0,a.IV)([document.body],[kn,yn]),(0,a.og)(this.dlgOverlay);this.dlgContainer.firstChild;)this.dlgContainer.parentElement.insertBefore(this.dlgContainer.firstChild,this.dlgContainer);this.dlgContainer.parentElement.removeChild(this.dlgContainer)}this.visible&&this.show(),this.positionChange(),this.isModal&&this.dlgOverlay&&a.bi.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)},t.prototype.setzIndex=function(e,i){var r=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.zIndex=cn(e),this.isProtectedOnChange=r,i&&(this.popupObj.zIndex=this.zIndex)},t.prototype.windowResizeHandler=function(){SC(this.targetEle.clientWidth),wC(this.targetEle.clientHeight),this.setMaxHeight()},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.destroy=function(){if(!this.isDestroyed){var e=[Bp,Hp,zp,_h,zh,Uv],i=["role","aria-modal","aria-labelledby","aria-describedby","aria-grabbed","tabindex","style"];if((0,a.IV)([this.targetEle],[kn,yn]),!(0,a.le)(this.element)&&this.element.classList.contains(zh)&&(0,a.IV)([document.body],[kn,yn]),this.isModal&&(0,a.IV)([(0,a.le)(this.targetEle)?document.body:this.targetEle],yn),this.unWireEvents(),!(0,a.le)(this.btnObj))for(var r=0;r<this.btnObj.length;r++)this.btnObj[r].destroy();if((0,a.le)(this.dragObj)||this.dragObj.destroy(),!(0,a.le)(this.popupObj.element)&&this.popupObj.element.classList.contains(DC)&&this.popupObj.destroy(),(0,a.IV)([this.element],e),!(0,a.le)(this.cssClass)&&this.cssClass!==""&&(0,a.IV)([this.element],this.cssClass.split(" ")),!(0,a.le)(this.refElement)&&!(0,a.le)(this.refElement.parentElement)&&(this.refElement.parentElement.insertBefore(this.isModal?this.dlgContainer:this.element,this.refElement),(0,a.og)(this.refElement),this.refElement=void 0),this.isModal&&!this.isBlazorServerRender()&&((0,a.og)(this.dlgOverlay),this.dlgContainer.parentNode.insertBefore(this.element,this.dlgContainer),(0,a.og)(this.dlgContainer)),this.isBlazorServerRender()||(this.element.innerHTML=this.clonedEle.innerHTML),this.isBlazorServerRender()&&!(0,a.le)(this.element.children))for(var r=0;r<=this.element.children.length;r++)r=r-r,(0,a.og)(this.element.children[r]);for(var r=0;r<i.length;r++)this.element.removeAttribute(i[r]);this.isBlazorServerRender()?this.isDestroyed=!0:o.prototype.destroy.call(this),this.isReact&&this.clearTemplate()}},t.prototype.wireWindowResizeEvent=function(){window.addEventListener("resize",this.windowResizeHandler.bind(this))},t.prototype.unWireWindowResizeEvent=function(){window.removeEventListener("resize",this.windowResizeHandler.bind(this))},t.prototype.wireEvents=function(){this.isBlazorServerRender()&&this.showCloseIcon&&(this.closeIcon=this.element.getElementsByClassName("e-dlg-closeicon-btn")[0]),this.showCloseIcon&&a.bi.add(this.closeIcon,"click",this.closeIconClickEventHandler,this),this.isModal&&this.dlgOverlay&&a.bi.add(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler,this)},t.prototype.unWireEvents=function(){if(this.showCloseIcon&&a.bi.remove(this.closeIcon,"click",this.closeIconClickEventHandler),this.isModal&&a.bi.remove(this.dlgOverlay,"click",this.dlgOverlayClickEventHandler),this.buttons.length>0&&!(0,a.le)(this.buttons[0].buttonModel)&&this.footerTemplate==="")for(var e=0;e<this.buttons.length;e++)typeof this.buttons[e].click=="function"&&a.bi.remove(this.ftrTemplateContent.children[e],"click",this.buttons[e].click)},t.prototype.refreshPosition=function(){this.popupObj.refreshPosition()},t.prototype.getDimension=function(){var e=this.element.offsetWidth,i=this.element.offsetHeight;return{width:e,height:i}},t.prototype.show=function(e){var i=this;if(!!this.element.classList.contains(Vh)){if(!this.element.classList.contains(Zv)||!(0,a.le)(e)){(0,a.le)(e)||this.fullScreen(e);var r=(0,a.xr)()?{cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,maxHeight:this.element.style.maxHeight}:{cancel:!1,element:this.element,container:this.isModal?this.dlgContainer:this.element,target:this.target,maxHeight:this.element.style.maxHeight};this.trigger("beforeOpen",r,function(n){if(!n.cancel){i.element.style.maxHeight!==r.maxHeight&&(i.allowMaxHeight=!1,i.element.style.maxHeight=r.maxHeight),i.storeActiveElement=document.activeElement,i.element.tabIndex=-1,i.isModal&&!(0,a.le)(i.dlgOverlay)&&(i.dlgOverlay.style.display="block",i.dlgContainer.style.display="flex",(0,a.IV)([i.dlgOverlay],"e-fade"),(0,a.le)(i.targetEle)?(0,a.cn)([document.body],[kn,yn]):(i.targetEle===document.body?i.dlgContainer.style.position="fixed":i.dlgContainer.style.position="absolute",i.dlgOverlay.style.position="absolute",i.element.style.position="relative",(0,a.cn)([i.targetEle],[kn,yn])));var s={name:i.animationSettings.effect+"In",duration:i.animationSettings.duration,delay:i.animationSettings.delay},l=i.isModal?i.element.parentElement:i.element;i.calculatezIndex&&(i.setzIndex(l,!0),(0,a.V7)(i.element,{zIndex:i.zIndex}),i.isModal&&i.setOverlayZindex(i.zIndex)),i.animationSettings.effect==="None"?i.popupObj.show():i.popupObj.show(s),i.dialogOpen=!0;var h=i.isProtectedOnChange;i.isProtectedOnChange=!0,i.visible=!0,i.preventVisibility=!0,i.isProtectedOnChange=h}})}this.isReact&&this.renderReactTemplates()}},t.prototype.hide=function(e){var i=this;if(!!this.element.classList.contains(Vh)&&this.preventVisibility){var r=(0,a.xr)()?{cancel:!1,isInteracted:!!e,element:this.element,container:this.isModal?this.dlgContainer:this.element,event:e}:{cancel:!1,isInteracted:!!e,element:this.element,target:this.target,container:this.isModal?this.dlgContainer:this.element,event:e,closedBy:this.dlgClosedBy};this.closeArgs=r,this.trigger("beforeClose",r,function(n){if(!n.cancel){i.isModal&&((0,a.le)(i.targetEle)||(0,a.IV)([i.targetEle],[kn,yn])),document.body.classList.contains(kn)&&document.body.classList.contains(yn)&&(0,a.IV)([document.body],[kn,yn]);var s={name:i.animationSettings.effect+"Out",duration:i.animationSettings.duration,delay:i.animationSettings.delay};i.animationSettings.effect==="None"?i.popupObj.hide():i.popupObj.hide(s),i.dialogOpen=!1;var l=i.isProtectedOnChange;i.isProtectedOnChange=!0,i.visible=!1,i.preventVisibility=!1,i.isProtectedOnChange=l}i.dlgClosedBy=_p})}},t.prototype.fullScreen=function(e){var i=this.element.offsetTop,r=this.element.offsetLeft;if(e){(0,a.cn)([this.element],zh),this.element.style.top=document.scrollingElement.scrollTop+"px";var n=this.element.style.display;this.element.style.display="none",this.element.style.maxHeight=(0,a.le)(this.target)?window.innerHeight+"px":this.targetEle.offsetHeight+"px",this.element.style.display=n,(0,a.cn)([document.body],[kn,yn]),this.allowDragging&&!(0,a.le)(this.dragObj)&&this.dragObj.destroy()}else(0,a.IV)([this.element],zh),(0,a.IV)([document.body],[kn,yn]),this.allowDragging&&!(0,a.le)(this.headerContent)&&this.setAllowDragging();return e},t.prototype.getButtons=function(e){return(0,a.le)(e)?this.btnObj:this.btnObj[e]},_t([(0,a.Z9)("")],t.prototype,"content",void 0),_t([(0,a.Z9)(!0)],t.prototype,"enableHtmlSanitizer",void 0),_t([(0,a.Z9)(!1)],t.prototype,"showCloseIcon",void 0),_t([(0,a.Z9)(!1)],t.prototype,"isModal",void 0),_t([(0,a.Z9)("")],t.prototype,"header",void 0),_t([(0,a.Z9)(!0)],t.prototype,"visible",void 0),_t([(0,a.Z9)(!1)],t.prototype,"enableResize",void 0),_t([(0,a.Z9)(["South-East"])],t.prototype,"resizeHandles",void 0),_t([(0,a.Z9)("auto")],t.prototype,"height",void 0),_t([(0,a.Z9)("")],t.prototype,"minHeight",void 0),_t([(0,a.Z9)("100%")],t.prototype,"width",void 0),_t([(0,a.Z9)("")],t.prototype,"cssClass",void 0),_t([(0,a.Z9)(1e3)],t.prototype,"zIndex",void 0),_t([(0,a.Z9)(null)],t.prototype,"target",void 0),_t([(0,a.Z9)("")],t.prototype,"footerTemplate",void 0),_t([(0,a.Z9)(!1)],t.prototype,"allowDragging",void 0),_t([(0,a.FE)([{}],xC)],t.prototype,"buttons",void 0),_t([(0,a.Z9)(!0)],t.prototype,"closeOnEscape",void 0),_t([(0,a.Zz)({},EC)],t.prototype,"animationSettings",void 0),_t([(0,a.Zz)({X:"center",Y:"center"},Na)],t.prototype,"position",void 0),_t([(0,a.ju)()],t.prototype,"created",void 0),_t([(0,a.ju)()],t.prototype,"open",void 0),_t([(0,a.ju)()],t.prototype,"beforeSanitizeHtml",void 0),_t([(0,a.ju)()],t.prototype,"beforeOpen",void 0),_t([(0,a.ju)()],t.prototype,"close",void 0),_t([(0,a.ju)()],t.prototype,"beforeClose",void 0),_t([(0,a.ju)()],t.prototype,"dragStart",void 0),_t([(0,a.ju)()],t.prototype,"dragStop",void 0),_t([(0,a.ju)()],t.prototype,"drag",void 0),_t([(0,a.ju)()],t.prototype,"overlayClick",void 0),_t([(0,a.ju)()],t.prototype,"resizeStart",void 0),_t([(0,a.ju)()],t.prototype,"resizing",void 0),_t([(0,a.ju)()],t.prototype,"resizeStop",void 0),_t([(0,a.ju)()],t.prototype,"destroyed",void 0),t=_t([a.Zl],t),t}(a.wA),$v;(function(o){function t(u){var p,f=(0,a.az)("div",{className:Gv});document.body.appendChild(f);var g,C=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}];return typeof u=="string"?g=i({content:u,position:{X:"center",Y:"top"},isModal:!0,header:Vp,buttons:C},f):g=i(r(u),f),g.close=function(){u&&u.close&&u.close.apply(g),g.destroy(),g.element.classList.contains("e-dlg-modal")?(g.element.parentElement.remove(),g.target.classList.remove(Yv)):g.element.remove()},g}o.alert=t;function e(u){var p,f=(0,a.az)("div",{className:Kv});document.body.appendChild(f);var g,C=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},{buttonModel:{content:"Cancel"},click:function(){this.hide()}}];return typeof u=="string"?g=i({position:{X:"center",Y:"top"},content:u,isModal:!0,header:Vp,buttons:C},f):g=i(n(u),f),g.close=function(){u&&u.close&&u.close.apply(g),g.destroy(),g.element.classList.contains("e-dlg-modal")?(g.element.parentElement.remove(),g.target.classList.remove(Yv)):g.element.remove()},g}o.confirm=e;function i(u,p){var f=new sl(u);return f.appendTo(p),f}function r(u){var p={};return p.buttons=[],p=s(p,u),p=l(p,u),p}function n(u){var p={};return p.buttons=[],p=s(p,u),p=h(p,u),p}function s(u,p){return u.header=(0,a.le)(p.title)?Vp:p.title,u.content=(0,a.le)(p.content)?"":p.content,u.isModal=(0,a.le)(p.isModal)?!0:p.isModal,u.showCloseIcon=(0,a.le)(p.showCloseIcon)?!1:p.showCloseIcon,u.allowDragging=(0,a.le)(p.isDraggable)?!1:p.isDraggable,u.closeOnEscape=(0,a.le)(p.closeOnEscape)?!1:p.closeOnEscape,u.position=(0,a.le)(p.position)?{X:"center",Y:"top"}:p.position,u.animationSettings=(0,a.le)(p.animationSettings)?{effect:"Fade",duration:400,delay:0}:p.animationSettings,u.cssClass=(0,a.le)(p.cssClass)?"":p.cssClass,u.zIndex=(0,a.le)(p.zIndex)?1e3:p.zIndex,u.open=(0,a.le)(p.open)?null:p.open,u}function l(u,p){var f=[{buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}}];return(0,a.le)(p.okButton)?u.buttons=f:u.buttons[0]=c(u.buttons[0],p.okButton,f[0]),u}function h(u,p){var f={buttonModel:{isPrimary:!0,content:"OK"},click:function(){this.hide()}},g={buttonModel:{content:"Cancel"},click:function(){this.hide()}};return(0,a.le)(p.okButton)?u.buttons[0]=f:u.buttons[0]=c(u.buttons[0],p.okButton,f),(0,a.le)(p.cancelButton)?u.buttons[1]=g:u.buttons[1]=c(u.buttons[1],p.cancelButton,g),u}function c(u,p,f){var g=f;return(0,a.le)(p.text)||(g.buttonModel.content=p.text),(0,a.le)(p.icon)||(g.buttonModel.iconCss=p.icon),(0,a.le)(p.cssClass)||(g.buttonModel.cssClass=p.cssClass),(0,a.le)(p.click)||(g.click=p.click),g}})($v||($v={}));var jp=function(){function o(t){this.border="1px solid #000000",this.fontNameIndex=5,this.numPopupWidth=0,this.findValue="",this.preTabIdx=1,this.chartThemeIndex=5,this.parent=t,this.addEventListener(),new vC(t)}return o.prototype.getModuleName=function(){return"ribbon"},o.prototype.ribbonOperation=function(t){t&&t.onPropertyChange?this.onPropertyChanged(t.prop):this.initialize()},o.prototype.initialize=function(t){if(this.parent.notify(E.c,{}),this.parent.isMobileView())this.createMobileView();else{var e=t&&(this.parent.element.querySelector(".e-formula-bar-panel")||document.getElementById(this.parent.element.id+"_sheet_panel"));this.createRibbon(e)}},o.prototype.getRibbonMenuItems=function(){var t=this.parent.serviceLocator.getService(Ve),e=this.parent.element.id;return[{text:this.parent.isMobileView()?"":t.getConstant("File"),iconCss:this.parent.isMobileView()?"e-icons e-file-menu-icon":null,id:e+"_File",items:[{text:t.getConstant("New"),id:e+"_New",iconCss:"e-new e-icons"},{text:t.getConstant("Open"),id:e+"_Open",iconCss:"e-open e-icons"},{text:t.getConstant("SaveAs"),iconCss:"e-save e-icons",id:e+"_Save_As",items:[{text:t.getConstant("ExcelXlsx"),id:e+"_Xlsx",iconCss:"e-xlsx e-icons"},{text:t.getConstant("ExcelXls"),id:e+"_Xls",iconCss:"e-xls e-icons"},{text:t.getConstant("CSV"),id:e+"_Csv",iconCss:"e-csv e-icons"},{text:t.getConstant("PDF"),id:e+"_Pdf",iconCss:"e-pdf e-icons"}]}]}]},o.prototype.getRibbonItems=function(){var t=this,e=this.parent.element.id,i=this.parent.serviceLocator.getService(Ve),r=[{header:{text:i.getConstant("Home")},content:[{prefixIcon:"e-undo-icon",tooltipText:i.getConstant("Undo")+" (Ctrl+Z)",id:e+"_undo",disabled:!0},{prefixIcon:"e-redo-icon",tooltipText:i.getConstant("Redo")+" (Ctrl+Y)",id:e+"_redo",disabled:!0},{type:"Separator",id:e+"_separator_1"},{prefixIcon:"e-cut-icon",tooltipText:i.getConstant("Cut")+" (Ctrl+X)",id:e+"_cut"},{prefixIcon:"e-copy-icon",tooltipText:i.getConstant("Copy")+" (Ctrl+C)",id:e+"_copy"},{tooltipText:i.getConstant("Paste")+" (Ctrl+V)",template:this.getPasteBtn(e),id:e+"_paste",disabled:!0},{type:"Separator",id:e+"_separator_2"},{template:this.getNumFormatDDB(e),tooltipText:i.getConstant("NumberFormat"),id:e+"_number_format"},{type:"Separator",id:e+"_separator_3"},{template:this.getFontNameDDB(e),tooltipText:i.getConstant("Font"),id:e+"_font_name"},{type:"Separator",id:e+"_separator_4"},{template:this.getFontSizeDDB(e),tooltipText:i.getConstant("FontSize"),id:e+"_font_size"},{type:"Separator",id:e+"_separator_5"},{template:this.getBtn(e,"bold"),tooltipText:i.getConstant("Bold")+" (Ctrl+B)",id:e+"_bold"},{template:this.getBtn(e,"italic"),tooltipText:i.getConstant("Italic")+" (Ctrl+I)",id:e+"_italic"},{template:this.getBtn(e,"line-through"),tooltipText:i.getConstant("Strikethrough")+" (Ctrl+5)",id:e+"_line-through"},{template:this.getBtn(e,"underline"),tooltipText:i.getConstant("Underline")+" (Ctrl+U)",id:e+"_underline"},{template:document.getElementById(e+"_font_color_picker"),tooltipText:i.getConstant("TextColor"),id:e+"_font_color_picker"},{type:"Separator",id:e+"_separator_6"},{template:document.getElementById(e+"_fill_color_picker"),tooltipText:i.getConstant("FillColor"),id:e+"_fill_color_picker"},{template:this.getBordersDBB(e),tooltipText:i.getConstant("Borders"),id:e+"_borders"},{template:this.getMergeSplitBtn(e),tooltipText:i.getConstant("MergeCells"),id:e+"_merge_cells",disabled:!0},{type:"Separator",id:e+"_separator_7"},{template:this.getTextAlignDDB(e),tooltipText:i.getConstant("HorizontalAlignment"),id:e+"_text_align"},{template:this.getVerticalAlignDDB(e),tooltipText:i.getConstant("VerticalAlignment"),id:e+"_vertical_align"},{template:this.getBtn(e,"wrap",!1),tooltipText:""+i.getConstant("WrapText"),id:e+"_wrap"}]},{header:{text:i.getConstant("Insert")},content:[{prefixIcon:"e-hyperlink-icon",text:i.getConstant("Link"),id:e+"_hyperlink",tooltipText:i.getConstant("Link"),click:function(){t.getHyperlinkDlg()}},{prefixIcon:"e-image-icon",text:i.getConstant("Image"),id:e+"_image",tooltipText:i.getConstant("Image"),click:function(){(0,a.Ys)("#"+e+"_imageUpload",t.parent.element).click()}}]},{header:{text:i.getConstant("Formulas")},content:[{prefixIcon:"e-insert-function",tooltipText:i.getConstant("InsertFunction"),text:i.getConstant("InsertFunction"),id:e+"_insert_function"}]},{header:{text:i.getConstant("Data")},content:[{prefixIcon:"e-protect-icon",text:i.getConstant("ProtectSheet"),id:e+"_protect",tooltipText:i.getConstant("ProtectSheet")},{prefixIcon:"e-password-protect-icon",text:i.getConstant("ProtectWorkbook"),id:e+"_protectworkbook",tooltipText:i.getConstant("ProtectWorkbook")},{type:"Separator",id:e+"_separator_8"},{template:this.datavalidationDDB(e),tooltipText:i.getConstant("DataValidation"),id:e+"_datavalidation"}]},{header:{text:i.getConstant("View")},content:[{prefixIcon:"e-hide-headers",text:this.getLocaleText("Headers"),id:e+"_headers",tooltipText:this.getLocaleText("Headers")},{type:"Separator",id:e+"_separator_9"},{prefixIcon:"e-hide-gridlines",text:this.getLocaleText("GridLines"),id:e+"_gridlines",tooltipText:this.getLocaleText("GridLines")},{type:"Separator",id:e+"_separator_13"},{prefixIcon:"e-freeze-pane",text:i.getConstant("FreezePanes"),id:e+"_freezepanes",tooltipText:i.getConstant("FreezePanes"),disabled:!this.parent.allowFreezePane},{prefixIcon:"e-freeze-row",text:i.getConstant("FreezeRows"),id:e+"_freezerows",tooltipText:i.getConstant("FreezeRows"),disabled:!this.parent.allowFreezePane},{prefixIcon:"e-freeze-column",text:i.getConstant("FreezeColumns"),id:e+"_freezecolumns",tooltipText:i.getConstant("FreezeColumns"),disabled:!this.parent.allowFreezePane}]}];return this.parent.allowConditionalFormat&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({type:"Separator",id:e+"_separator_10"},{template:this.getCFDBB(e),tooltipText:i.getConstant("ConditionalFormatting"),id:e+"_conditionalformatting"}),this.parent.allowChart&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Insert")}).content.push({type:"Separator",id:e+"_separator_11"},{template:this.getChartDDB(e,!0),text:i.getConstant("Chart"),tooltipText:i.getConstant("Chart"),id:e+"_chart"}),this.parent.allowCellFormatting&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({type:"Separator",id:e+"_separator_12"},{template:this.getClearDDB(e),tooltipText:i.getConstant("Clear"),id:e+"_clear"}),(this.parent.allowSorting||this.parent.allowFiltering)&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({template:this.getSortFilterDDB(e),tooltipText:i.getConstant("SortAndFilter"),id:e+"_sorting"}),this.parent.allowFindAndReplace&&r.find(function(n){return n.header&&n.header.text===i.getConstant("Home")}).content.push({template:this.getFindBtn(e),prefixIcon:"e-tbar-search-icon tb-icons",tooltipText:i.getConstant("FindReplaceTooltip"),id:e+"_find"}),r},o.prototype.getPasteBtn=function(t){var e=this,i=this.parent.element.appendChild(this.parent.createElement("button",{id:t+"_paste"})),r=this.parent.serviceLocator.getService(Ve);return this.pasteSplitBtn=new pp({iconCss:"e-icons e-paste-icon",items:[{text:r.getConstant("All"),id:"All"},{text:r.getConstant("Values"),id:"Values"},{text:r.getConstant("Formats"),id:"Formats"}],createPopupOnClick:!0,select:function(n){e.parent.notify(E.v,{type:n.item.id,isAction:!0,isInternal:!0})},click:function(){e.parent.notify(E.v,{isAction:!0,isInternal:!0})},close:function(){we(e.parent.element)}}),this.pasteSplitBtn.createElement=this.parent.createElement,this.pasteSplitBtn.appendTo(i),i.parentElement},o.prototype.getHyperlinkDlg=function(){var t=(0,pe.dK5)(this.parent.getActiveSheet().activeCell),e=this.parent.sheets[this.parent.getActiveSheet().id-1].rows[t[0]],i;(0,a.le)(e)||(i=e.cells[t[1]]),(0,a.le)(i)&&(0,w.Jxt)(t[0],t[1],this.parent.getActiveSheet(),i,!1),i&&i.hyperlink?this.parent.notify(E.qP,null):this.parent.notify(E.tW,null)},o.prototype.passwordProtectDlg=function(){this.parent.password.length>0?this.parent.notify(E.xY,null):document.getElementById(this.parent.element.id+"_protectworkbook").classList.contains("e-active")?(document.getElementById(this.parent.element.id+"_protectworkbook").classList.remove("e-active"),this.parent.showSheetTabs&&this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled")):this.parent.notify(E.du,null)},o.prototype.getLocaleText=function(t){var e,i=this.parent.serviceLocator.getService(Ve),r=this.parent.getActiveSheet();return r["show"+t]?e=i.getConstant("Hide"+t):e=i.getConstant("Show"+t),e},o.prototype.getLocaleProtectText=function(t,e){var i,r=this.parent.serviceLocator.getService(Ve),n=this.parent.getActiveSheet();return n.isProtected?(e&&this.parent.getMainContent().classList.remove("e-hide-"+t.toLowerCase()),i=r.getConstant("Unprotect"+t)):(e&&this.parent.getMainContent().classList.add("e-hide-"+t.toLowerCase()),i=r.getConstant("Protect"+t)),i},o.prototype.getLocaleProtectWorkbook=function(t,e){var i,r=this.parent.serviceLocator.getService(Ve);return this.parent.isProtected?(e&&this.parent.getMainContent().classList.remove("e-hide-"+t.toLowerCase()),i=r.getConstant(t)):(e&&this.parent.getMainContent().classList.add("e-hide-"+t.toLowerCase()),i=r.getConstant(t)),i},o.prototype.insertDesignChart=function(){var t=this,e=this.parent.serviceLocator.getService(Ve),i=this.ribbon.items.length-1,r=e.getConstant("ChartDesign");if(this.parent.allowChart&&this.ribbon.items[i]&&this.ribbon.items[i].header.text!==r){this.preTabIdx=this.ribbon.selectedTab;var n=this.parent.element.id,s=[{header:{text:r},content:[{template:this.getAddChartEleDBB(n),tooltipText:e.getConstant("AddChartElement"),id:n+"add_chart_ element_chart"},{type:"Separator"},{prefixIcon:"e-switch-row-column-icon",text:e.getConstant("SwitchRowColumn"),tooltipText:e.getConstant("SwitchRowColumn"),id:n+"switch_row_column_chart",click:function(){t.parent.notify(E.dG,{switchRowColumn:!0,triggerEvent:!0})}},{type:"Separator"},{template:this.getChartThemeDDB(n),tooltipText:e.getConstant("ChartTheme"),id:n+"_chart_theme"},{type:"Separator"},{template:this.getChartDDB(n,!1),tooltipText:e.getConstant("ChartType"),id:n+"_chart_type"}]}];this.addRibbonTabs({items:s}),this.ribbon.tabObj.select(this.ribbon.items.length)}},o.prototype.removeDesignChart=function(){var t=this.parent.serviceLocator.getService(Ve),e=this.ribbon.items.length-1;this.parent.allowChart&&this.ribbon.items[e]&&this.ribbon.items[e].header.text===t.getConstant("ChartDesign")&&(this.ribbon.tabObj.select(this.preTabIdx+1),this.parent.hideRibbonTabs([t.getConstant("ChartDesign")],!0),document.getElementsByClassName("e-addchart-ddb").length>0&&document.getElementsByClassName("e-addchart-ddb")[0].remove(),document.getElementsByClassName("e-chart-type-ddb").length>0&&document.getElementsByClassName("e-chart-type-ddb")[0].remove(),document.getElementsByClassName("e-charttheme-ddb").length>0&&document.getElementsByClassName("e-charttheme-ddb")[0].remove(),delete this.ribbon.items[e].content[0],this.ribbon.items.length=this.ribbon.items.length-1)},o.prototype.createRibbon=function(t){var e=this.parent.createElement("div",{id:this.parent.element.id+"_ribbon"});this.ribbon=new rC({selectedTab:0,menuItems:this.getRibbonMenuItems(),items:this.getRibbonItems(),fileMenuItemSelect:this.fileMenuItemSelect.bind(this),beforeOpen:this.fileMenuBeforeOpen.bind(this),beforeClose:this.fileMenuBeforeClose.bind(this),clicked:this.toolbarClicked.bind(this),created:this.ribbonCreated.bind(this),selecting:this.tabSelecting.bind(this),expandCollapse:this.expandCollapseHandler.bind(this),beforeFileMenuItemRender:this.beforeRenderHandler.bind(this)}),this.ribbon.createElement=this.parent.createElement,t?this.parent.element.insertBefore(e,t):this.parent.element.appendChild(e),this.ribbon.appendTo(e)},o.prototype.tabSelecting=function(t){if(t.selectingIndex!==this.ribbon.selectedTab){if(this.parent.allowChart){var e=this.parent.serviceLocator.getService(Ve);if(this.ribbon.items[t.selectingIndex]&&this.ribbon.items[t.selectingIndex].header.text===e.getConstant("Insert")&&this.createChartDdb(document.getElementById(this.parent.element.id+"_chart-btn"),!0),this.ribbon.items[t.selectedIndex]&&this.ribbon.items[t.selectedIndex].header.text===e.getConstant("Insert")){for(var i=this.ribbon.items[t.selectedIndex].content,r=i.length-1;r>=0;r--)if(i[r].id===this.parent.element.id+"_chart"){var n=i[r].template;n&&n.classList.contains("e-dropdown-btn")&&this.destroyComponent(n,"dropdown-btn");break}}}this.refreshRibbonContent(t.selectingIndex),this.parent.notify(E.Zp,{activeTab:t.selectingIndex})}},o.prototype.beforeRenderHandler=function(t){var e=this.parent.serviceLocator.getService(Ve);t.item.text===e.getConstant("Open")&&(!this.parent.openUrl||!this.parent.allowOpen)&&t.element.classList.add("e-disabled"),t.item.text===e.getConstant("SaveAs")&&(!this.parent.saveUrl||!this.parent.allowSave)&&t.element.classList.add("e-disabled")},o.prototype.getChartThemeDDB=function(t){var e=this,i=this.parent.createElement("button",{id:t+"_chart_theme"});return i.appendChild(this.parent.createElement("span",{className:"e-tbar-btn-text",innerHTML:"Material"})),this.chartThemeDDB=new Bi({items:this.getChartThemeDdbItems(),createPopupOnClick:!0,select:function(r){return e.chartThemeDDBSelect(r)},close:function(){return e.parent.element.focus()},cssClass:"e-flat e-charttheme-ddb",beforeOpen:function(r){return e.tBarDdbBeforeOpen(r.element,r.items)}}),this.chartThemeDDB.createElement=this.parent.createElement,this.chartThemeDDB.appendTo(i),i},o.prototype.getNumFormatDDB=function(t){var e=this,i=this.parent.createElement("button",{id:t+"_number_format"});return i.appendChild(this.parent.createElement("span",{className:"e-tbar-btn-text",innerHTML:"General"})),this.numFormatDDB=new Bi({items:this.getNumFormatDdbItems(t),createPopupOnClick:!0,select:function(r){return e.numDDBSelect(r)},open:function(r){return e.numDDBOpen(r)},beforeItemRender:function(r){return e.previewNumFormat(r)},close:function(){return we(e.parent.element)},cssClass:"e-flat e-numformat-ddb",beforeOpen:function(r){return e.tBarDdbBeforeOpen(r.element,r.items)}}),this.numFormatDDB.createElement=this.parent.createElement,this.numFormatDDB.appendTo(i),i},o.prototype.getFontSizeDDB=function(t){var e=this;return this.fontSizeDdb=new Bi({cssClass:"e-font-size-ddb",content:"11",createPopupOnClick:!0,items:[{text:"8"},{text:"9"},{text:"10"},{text:"11"},{text:"12"},{text:"14"},{text:"16"},{text:"18"},{text:"20"},{text:"22"},{text:"24"},{text:"26"},{text:"28"},{text:"36"},{text:"48"},{text:"72"}],beforeOpen:function(i){e.tBarDdbBeforeOpen(i.element,i.items),e.refreshSelected(e.fontSizeDdb,i.element,"content","text")},select:function(i){var r={style:{fontSize:i.item.text+"pt"},onActionUpdate:!0};e.parent.notify(w.vbl,r),r.cancel||(e.fontSizeDdb.content=r.style.fontSize.split("pt")[0],e.fontSizeDdb.dataBind())},close:function(){return we(e.parent.element)}}),this.fontSizeDdb.createElement=this.parent.createElement,this.fontSizeDdb.appendTo(this.parent.createElement("button",{id:t+"_font_size"})),this.fontSizeDdb.element},o.prototype.getChartDDB=function(t,e){var i=this.parent.serviceLocator.getService(Ve),r;return e?(r=this.parent.createElement("button",{id:t+"_chart-btn"}),r.appendChild(this.parent.createElement("span",{id:t+"_chart",innerHTML:i.getConstant("Chart")}))):(r=this.parent.createElement("button",{id:t+"_chart-type-btn"}),r.appendChild(this.parent.createElement("span",{id:t+"_chart_type",innerHTML:i.getConstant("ChartType")})),this.createChartDdb(r,!1)),r},o.prototype.createChartDdb=function(t,e){var i=this,r=this.parent.serviceLocator.getService(Ve),n=e?"e-chart-menu":"e-chart-type-menu",s=this.parent.createElement("ul",{id:""+this.parent.element.id+(e?"_chart_menu":"_chart_type_menu")}),l,h=new Bi({iconCss:"e-icons "+(e?"e-chart-icon":"e-chart-type-icon"),cssClass:e?"e-chart-ddb":"e-chart-type-ddb",target:s,createPopupOnClick:!0,beforeOpen:function(c){l=i.createChartMenu(s,n,r,h),i.tBarDdbBeforeOpen(c.element,l.items)},beforeClose:function(c){c.event&&(0,a.oq)(c.event.target,"."+n)?c.cancel=!0:l.destroy()},close:function(){return we(i.parent.element)}});h.createElement=this.parent.createElement,h.appendTo(t)},o.prototype.createChartMenu=function(t,e,i,r){var n=this,s=new qa({cssClass:e,items:[{iconCss:"e-icons e-column",text:i.getConstant("Column"),items:[{id:"column_chart"}]},{iconCss:"e-icons e-bar",text:i.getConstant("Bar"),items:[{id:"bar_chart"}]},{iconCss:"e-icons e-area",text:i.getConstant("Area"),items:[{id:"area_chart"}]},{iconCss:"e-icons e-pie-doughnut",text:i.getConstant("PieAndDoughnut"),items:[{id:"pie_doughnut_chart"}]},{iconCss:"e-icons e-line",text:i.getConstant("Line"),items:[{id:"line_chart"}]},{iconCss:"e-icons e-scatter",text:i.getConstant("Scatter"),items:[{id:"scatter_chart"}]}],orientation:"Vertical",beforeOpen:function(Gt){Gt.parentItem.text===i.getConstant("Column")?(Gt.element.firstChild.appendChild(l),Gt.element.parentElement.classList.add("e-column-chart")):Gt.parentItem.text===i.getConstant("Bar")?(Gt.element.firstChild.appendChild(R),Gt.element.parentElement.classList.add("e-bar-chart")):Gt.parentItem.text===i.getConstant("Area")?(Gt.element.firstChild.appendChild(le),Gt.element.parentElement.classList.add("e-area-chart")):Gt.parentItem.text===i.getConstant("Line")?(Gt.element.firstChild.appendChild(De),Gt.element.parentElement.classList.add("e-line-chart")):Gt.parentItem.text===i.getConstant("PieAndDoughnut")?(Gt.element.firstChild.appendChild(it),Gt.element.parentElement.classList.add("e-pie-doughnut-chart")):Gt.parentItem.text===i.getConstant("Radar")?(Gt.element.firstChild.appendChild(ge),Gt.element.parentElement.classList.add("e-radar-chart")):Gt.parentItem.text===i.getConstant("Scatter")&&(Gt.element.firstChild.appendChild(Qe),Gt.element.parentElement.classList.add("e-scatter-chart"))},select:function(Gt){return n.chartSelected(Gt,r)}}),l=this.parent.createElement("div",{id:"column_main",className:"e-column-main"}),h=this.parent.createElement("div",{id:"column1_text",className:"e-column1-text",innerHTML:i.getConstant("Column")}),c=this.parent.createElement("div",{id:"column1_cont",className:"e-column1-cont"}),u=this.parent.createElement("div",{id:"column2_cont",className:"e-column2-cont"});l.appendChild(h),l.appendChild(c);var p=this.parent.createElement("span",{id:"clusteredColumn",className:"e-clusteredcolumn e-column-icon e-menu-icon e-icons"}),f=this.parent.createElement("span",{id:"stackedColumn",className:"e-stackedcolumn e-column-icon e-menu-icon e-icons"}),g=this.parent.createElement("span",{id:"stackedColumn100",className:"e-stackedcolumn100 e-column-icon e-menu-icon e-icons"}),C=this.parent.createElement("span",{id:"clusteredColumn3D",className:"e-clusteredColumn3D e-column-icon"}),L=this.parent.createElement("span",{id:"stackedColumn3D",className:"e-stackedColumn3D e-column-icon"}),D=this.parent.createElement("span",{id:"stackedColumn1003D",className:"e-stackedColumn1003D e-column-icon"});p.title=i.getConstant("ClusteredColumn"),f.title=i.getConstant("StackedColumn"),g.title=i.getConstant("StackedColumn100"),D.title=i.getConstant("OrangeDataBar"),L.title=i.getConstant("LightblueDataBar"),C.title=i.getConstant("PurpleDataBar"),c.appendChild(p),c.appendChild(f),c.appendChild(g),u.appendChild(C),u.appendChild(L),u.appendChild(D);var R=this.parent.createElement("div",{id:"bar_main",className:"e-bar-main"}),B=this.parent.createElement("div",{id:"bar1_text",className:"e-bar1-text",innerHTML:i.getConstant("Bar")}),H=this.parent.createElement("div",{id:"bar1_cont",className:"e-bar1-cont"}),j=this.parent.createElement("div",{id:"bar2_cont",className:"e-bar2-cont"});R.appendChild(B),R.appendChild(H);var W=this.parent.createElement("span",{id:"clusteredBar",className:"e-clusteredbar e-bar-icon e-menu-icon e-icons"}),ne=this.parent.createElement("span",{id:"stackedBar",className:"e-stackedbar e-bar-icon e-menu-icon e-icons"}),ie=this.parent.createElement("span",{id:"stackedBar100",className:"e-stackedbar100 e-bar-icon e-menu-icon e-icons"}),me=this.parent.createElement("span",{id:"clusteredBar3D",className:"e-clusteredBar3D e-bar-icon"}),ve=this.parent.createElement("span",{id:"stackedBar3D",className:"e-stackedBar3D e-bar-icon"}),Ee=this.parent.createElement("span",{id:"stackedBar1003D",className:"e-stackedBar1003D e-bar-icon"});W.title=i.getConstant("ClusteredBar"),ne.title=i.getConstant("StackedBar"),ie.title=i.getConstant("StackedBar100"),Ee.title=i.getConstant("OrangeDataBar"),ve.title=i.getConstant("LightblueDataBar"),me.title=i.getConstant("PurpleDataBar"),H.appendChild(W),H.appendChild(ne),H.appendChild(ie),j.appendChild(me),j.appendChild(ve),j.appendChild(Ee);var le=this.parent.createElement("div",{id:"area_main",className:"e-area-main"}),de=this.parent.createElement("div",{id:"area_text",className:"e-area-text",innerHTML:i.getConstant("Area")}),fe=this.parent.createElement("div",{id:"area_cont",className:"e-area-cont"});le.appendChild(de),le.appendChild(fe);var Le=this.parent.createElement("span",{id:"area",className:"e-area e-area-icon e-menu-icon e-icons"}),ke=this.parent.createElement("span",{id:"stackedArea",className:"e-stackedarea e-area-icon e-menu-icon e-icons"}),Me=this.parent.createElement("span",{id:"stackedArea100",className:"e-stackedarea100 e-area-icon e-menu-icon e-icons"});Le.title=i.getConstant("Area"),ke.title=i.getConstant("StackedArea"),Me.title=i.getConstant("StackedArea100"),fe.appendChild(Le),fe.appendChild(ke),fe.appendChild(Me);var De=this.parent.createElement("div",{id:"line_main",className:"e-line-main"}),Fe=this.parent.createElement("div",{id:"line_text",className:"e-line-text",innerHTML:i.getConstant("Line")}),Pe=this.parent.createElement("div",{id:"line_cont",className:"e-line-cont"});De.appendChild(Fe),De.appendChild(Pe);var Ye=this.parent.createElement("span",{id:"line",className:"e-line e-line-icon e-menu-icon e-icons"}),Ze=this.parent.createElement("span",{id:"stackedLine",className:"e-stackedline e-line-icon e-menu-icon e-icons"}),nt=this.parent.createElement("span",{id:"stackedline100",className:"e-stackedline100 e-line-icon e-menu-icon e-icons"});Ye.title=i.getConstant("Line"),Ze.title=i.getConstant("StackedLine"),nt.title=i.getConstant("StackedLine100"),Pe.appendChild(Ye),Pe.appendChild(Ze),Pe.appendChild(nt);var it=this.parent.createElement("div",{id:"pie_main",className:"e-pie-main"}),et=this.parent.createElement("div",{id:"pie_text",className:"e-pie-text",innerHTML:i.getConstant("Pie")}),at=this.parent.createElement("div",{id:"pie_cont",className:"e-pie-cont"});it.appendChild(et),it.appendChild(at);var Ge=this.parent.createElement("span",{id:"pie",className:"e-pie e-pie-icon e-menu-icon e-icons"}),gt=this.parent.createElement("span",{id:"doughnut",className:"e-doughnut e-pie-icon e-menu-icon e-icons"});Ge.title=i.getConstant("Pie"),gt.title=i.getConstant("Doughnut"),at.appendChild(Ge),at.appendChild(gt);var ge=this.parent.createElement("div",{id:"radar_main",className:"e-radar-main"}),xe=this.parent.createElement("div",{id:"radar_text",className:"e-radar-text",innerHTML:"Radar"}),je=this.parent.createElement("div",{id:"radar_cont",className:"e-radar-cont"});ge.appendChild(xe),ge.appendChild(je);var Je=this.parent.createElement("span",{id:"radar",className:"e-radar e-radar-icon e-menu-icon e-icons"}),lt=this.parent.createElement("span",{id:"radar_markers",className:"e-radar-markers e-radar-icon e-menu-icon e-icons"});Je.title=i.getConstant("BlueDataBar"),lt.title=i.getConstant("GreenDataBar"),je.appendChild(Je),je.appendChild(lt);var Qe=this.parent.createElement("div",{id:"scatter_main",className:"e-scatter-main"}),Bt=this.parent.createElement("div",{id:"scatter_text",className:"e-scatter-text",innerHTML:i.getConstant("Scatter")}),pi=this.parent.createElement("div",{id:"scatter_cont",className:"e-scatter-cont"});Qe.appendChild(Bt),Qe.appendChild(pi);var si=this.parent.createElement("span",{id:"scatter",className:"e-scatter e-scatter-icon e-menu-icon e-icons"});return si.title=i.getConstant("Scatter"),pi.appendChild(si),s.createElement=this.parent.createElement,s.appendTo(t),t.classList.add("e-ul"),s},o.prototype.getAddChartEleDBB=function(t){var e=this,i=this.parent.serviceLocator.getService(Ve),r=this.parent.createElement("ul",{id:t+"_add_chart_menu"}),n;this.addChartDdb=new Bi({iconCss:"e-icons e-addchart-icon",cssClass:"e-addchart-ddb",target:r,createPopupOnClick:!0,close:function(){return we(e.parent.element)},beforeOpen:function(l){n=e.createAddChartMenu(r,i),e.tBarDdbBeforeOpen(l.element,n.items)},beforeClose:function(l){l.event&&(0,a.oq)(l.event.target,".e-addchart-menu")?l.cancel=!0:n.destroy()}}),this.addChartDdb.createElement=this.parent.createElement;var s=this.parent.createElement("button",{id:t+"_addchart"});return s.appendChild(this.parent.createElement("span",{id:t+"_chart",innerHTML:i.getConstant("AddChartElement")})),this.addChartDdb.appendTo(s),this.addChartDdb.element},o.prototype.createAddChartMenu=function(t,e){var i=new qa({cssClass:"e-addchart-menu",title:e.getConstant("AddChartElement"),items:[{iconCss:"e-icons e-axes",text:e.getConstant("Axes"),items:[{iconCss:"e-icons e-ph-axes",id:"PHAxes",text:e.getConstant("PrimaryHorizontal")},{iconCss:"e-icons e-pv-axes",id:"PVAxes",text:e.getConstant("PrimaryVertical")}]},{iconCss:"e-icons e-axis-title",text:e.getConstant("AxisTitle"),items:[{iconCss:"e-icons e-ph-axistitle",id:"PHAxisTitle",text:e.getConstant("PrimaryHorizontal")},{iconCss:"e-icons e-pv-axistitle",id:"PVAxisTitle",text:e.getConstant("PrimaryVertical")}]},{iconCss:"e-icons e-chart-title",text:e.getConstant("ChartTitle"),items:[{iconCss:"e-icons e-ct-none",id:"ChartTitleNone",text:e.getConstant("None")},{iconCss:"e-icons e-ct-abovechart",id:"ChartTitleAbove",text:e.getConstant("AboveChart")}]},{iconCss:"e-icons e-data-labels",text:e.getConstant("DataLabels"),items:[{iconCss:"e-icons e-dl-none",id:"DLNone",text:e.getConstant("None")},{iconCss:"e-icons e-dl-center",id:"DLCenter",text:e.getConstant("Center")},{iconCss:"e-icons e-dl-insideend",id:"DLInsideend",text:e.getConstant("InsideEnd")},{iconCss:"e-icons e-dl-insidebase",id:"DLInsidebase",text:e.getConstant("InsideBase")},{iconCss:"e-icons e-dl-outsideend",id:"DLOutsideend",text:e.getConstant("OutsideEnd")}]},{iconCss:"e-icons e-gridlines",text:e.getConstant("Gridlines"),items:[{iconCss:"e-icons e-gl-major-horizontal",id:"GLMajorHorizontal",text:e.getConstant("PrimaryMajorHorizontal")},{iconCss:"e-icons e-gl-major-vertical",id:"GLMajorVertical",text:e.getConstant("PrimaryMajorVertical")},{iconCss:"e-icons e-gl-minor-horizontal",id:"GLMinorHorizontal",text:e.getConstant("PrimaryMinorHorizontal")},{iconCss:"e-icons e-gl-minor-vertical",id:"GLMinorVertical",text:e.getConstant("PrimaryMinorVertical")}]},{iconCss:"e-icons e-legends",text:e.getConstant("Legends"),items:[{iconCss:"e-icons e-legends-none",id:"LegendNone",text:e.getConstant("None")},{iconCss:"e-icons e-legends-right",id:"LegendsRight",text:e.getConstant("Right")},{iconCss:"e-icons e-legends-left",id:"LegendsLeft",text:e.getConstant("Left")},{iconCss:"e-icons e-legends-bottom",id:"LegendsBottom",text:e.getConstant("Bottom")},{iconCss:"e-icons e-legends-top",id:"LegendsTop",text:e.getConstant("Top")}]}],orientation:"Vertical",select:this.addChartEleSelected.bind(this)});return i.createElement=this.parent.createElement,i.appendTo(t),t.classList.add("e-ul"),i},o.prototype.getCFDBB=function(t){var e=this,i=this.parent.createElement("ul",{id:t+"_cf_menu"}),r;return this.cFDdb=new Bi({iconCss:"e-icons e-conditionalformatting-icon",cssClass:"e-cf-ddb",target:i,createPopupOnClick:!0,close:function(){return we(e.parent.element)},beforeOpen:function(n){r=e.createCFMenu(i),e.tBarDdbBeforeOpen(n.element,r.items)},beforeClose:function(n){n.event&&(0,a.oq)(n.event.target,".e-cf-menu")?n.cancel=!0:r.destroy()}}),this.cFDdb.createElement=this.parent.createElement,this.cFDdb.appendTo(this.parent.createElement("button",{id:t+"_conditionalformatting"})),this.cFDdb.element},o.prototype.createCFMenu=function(t){var e=this.parent.serviceLocator.getService(Ve),i=new qa({cssClass:"e-cf-menu",items:[{iconCss:"e-icons e-hlcellrules",text:e.getConstant("HighlightCellsRules"),items:[{iconCss:"e-icons e-greaterthan",id:"cf_greaterthan",text:e.getConstant("GreaterThan")+"..."},{iconCss:"e-icons e-lessthan",id:"cf_lessthan",text:e.getConstant("LessThan")+"..."},{iconCss:"e-icons e-between",id:"cf_between",text:e.getConstant("Between")+"..."},{iconCss:"e-icons e-equalto",id:"cf_eqaulto",text:e.getConstant("CFEqualTo")+"..."},{iconCss:"e-icons e-textcontains",id:"cf_textthatcontains",text:e.getConstant("TextThatContains")+"..."},{iconCss:"e-icons e-adateoccuring",id:"cf_adateoccuring",text:e.getConstant("ADateOccuring")+"..."},{iconCss:"e-icons e-duplicate",id:"cf_duplicatevalues",text:e.getConstant("DuplicateValues")+"..."}]},{iconCss:"e-icons e-topbottomrules",text:e.getConstant("TopBottomRules"),items:[{iconCss:"e-icons e-top10items",id:"cf_top10items",text:e.getConstant("Top10Items")+"..."},{iconCss:"e-icons e-top10",id:"cf_top10",text:e.getConstant("Top10")+" %..."},{iconCss:"e-icons e-bottom10items",id:"cf_bottom10items",text:e.getConstant("Bottom10Items")+"..."},{iconCss:"e-icons e-bottom10",id:"cf_bottom10",text:e.getConstant("Bottom10")+" %..."},{iconCss:"e-icons e-aboveaverage",id:"cf_aboveaverage",text:e.getConstant("AboveAverage")+"..."},{iconCss:"e-icons e-belowaverage",id:"cf_belowaverage",text:e.getConstant("BelowAverage")+"..."}]},{iconCss:"e-icons e-databars",text:e.getConstant("DataBars"),items:[{id:"cf_databars"}]},{iconCss:"e-icons e-colorscales",text:e.getConstant("ColorScales"),items:[{id:"cf_colorscales"}]},{iconCss:"e-icons e-iconsets",text:e.getConstant("IconSets"),items:[{id:"cf_iconsets"}]},{iconCss:"e-icons e-clearrules",text:e.getConstant("ClearRules"),items:[{id:"cf_cr_cells",text:e.getConstant("SelectedCells")},{id:"cf_cr_sheet",text:e.getConstant("EntireSheet")}]}],orientation:"Vertical",beforeOpen:function(Xr){Xr.parentItem.text===e.getConstant("DataBars")?(Xr.element.firstChild.appendChild(r),Xr.element.parentElement.classList.add("e-databars")):Xr.parentItem.text===e.getConstant("ColorScales")?(Xr.element.firstChild.appendChild(g),Xr.element.parentElement.classList.add("e-colorscales")):Xr.parentItem.text===e.getConstant("IconSets")&&(Xr.element.firstChild.appendChild(fe),Xr.element.parentElement.classList.add("e-iconsets"))},select:this.cFSelected.bind(this)}),r=this.parent.createElement("div",{id:"db",className:"e-db"}),n=this.parent.createElement("div",{id:"db1",className:"e-db1"}),s=this.parent.createElement("div",{id:"db2",className:"e-db2"});r.appendChild(n),r.appendChild(s);var l=this.parent.createElement("span",{id:"BlueDataBar",className:"e-bdatabar e-databar-icon"}),h=this.parent.createElement("span",{id:"GreenDataBar",className:"e-gdatabar e-databar-icon"}),c=this.parent.createElement("span",{id:"RedDataBar",className:"e-rdatabar e-databar-icon"}),u=this.parent.createElement("span",{id:"OrangeDataBar",className:"e-odatabar e-databar-icon"}),p=this.parent.createElement("span",{id:"LightBlueDataBar",className:"e-lbdatabar e-databar-icon"}),f=this.parent.createElement("span",{id:"PurpleDataBar",className:"e-pdatabar e-databar-icon"});l.title=e.getConstant("BlueDataBar"),h.title=e.getConstant("GreenDataBar"),c.title=e.getConstant("RedDataBar"),u.title=e.getConstant("OrangeDataBar"),p.title=e.getConstant("LightblueDataBar"),f.title=e.getConstant("PurpleDataBar"),n.appendChild(l),n.appendChild(h),n.appendChild(c),s.appendChild(u),s.appendChild(p),s.appendChild(f),i.createElement=this.parent.createElement;var g=this.parent.createElement("div",{id:"db",className:"e-cs"}),C=this.parent.createElement("div",{id:"cs1",className:"e-cs1"}),L=this.parent.createElement("div",{id:"cs2",className:"e-cs2"}),D=this.parent.createElement("div",{id:"cs3",className:"e-cs3"});g.appendChild(C),g.appendChild(L),g.appendChild(D);var R=this.parent.createElement("span",{id:"GYRColorScale",className:"e-gyr e-colorscale-icon"}),B=this.parent.createElement("span",{id:"RYGColorScale",className:"e-ryg e-colorscale-icon"}),H=this.parent.createElement("span",{id:"GWRColorScale",className:"e-gwr e-colorscale-icon"}),j=this.parent.createElement("span",{id:"RWGColorScale",className:"e-rwg e-colorscale-icon"}),W=this.parent.createElement("span",{id:"BWRColorScale",className:"e-bwr e-colorscale-icon"}),ne=this.parent.createElement("span",{id:"RWBColorScale",className:"e-rwb e-colorscale-icon"}),ie=this.parent.createElement("span",{id:"WRColorScale",className:"e-wr e-colorscale-icon"}),me=this.parent.createElement("span",{id:"RWColorScale",className:"e-rw e-colorscale-icon"}),ve=this.parent.createElement("span",{id:"GWColorScale",className:"e-gw e-colorscale-icon"}),Ee=this.parent.createElement("span",{id:"WGColorScale",className:"e-wg e-colorscale-icon"}),le=this.parent.createElement("span",{id:"GYColorScale",className:"e-gy e-colorscale-icon"}),de=this.parent.createElement("span",{id:"YGColorScale",className:"e-yg e-colorscale-icon"});R.title=e.getConstant("GYRColorScale"),B.title=e.getConstant("RYGColorScale"),H.title=e.getConstant("GWRColorScale"),j.title=e.getConstant("RWGColorScale"),W.title=e.getConstant("BWRColorScale"),ne.title=e.getConstant("RWBColorScale"),ie.title=e.getConstant("WRColorScale"),me.title=e.getConstant("RWColorScale"),ve.title=e.getConstant("GWColorScale"),Ee.title=e.getConstant("WGColorScale"),le.title=e.getConstant("GYColorScale"),de.title=e.getConstant("YGColorScale"),C.appendChild(R),C.appendChild(B),C.appendChild(H),C.appendChild(j),L.appendChild(W),L.appendChild(ne),L.appendChild(ie),L.appendChild(me),D.appendChild(ve),D.appendChild(Ee),D.appendChild(le),D.appendChild(de);var fe=this.parent.createElement("div",{id:"is",className:"e-is"}),Le=this.parent.createElement("div",{id:"is1",className:"e-is1",innerHTML:"Directional"}),ke=this.parent.createElement("div",{id:"is2",className:"e-is2"}),Me=this.parent.createElement("div",{id:"is3",className:"e-is3",innerHTML:"Shapes"}),De=this.parent.createElement("div",{id:"is4",className:"e-is4"}),Fe=this.parent.createElement("div",{id:"is5",className:"e-is5",innerHTML:"Indicators"}),Pe=this.parent.createElement("div",{id:"is6",className:"e-is6"}),Ye=this.parent.createElement("div",{id:"is7",className:"e-is7",innerHTML:"Ratings"}),Ze=this.parent.createElement("div",{id:"is8",className:"e-is8"});Le.title=e.getConstant("GYColorScale"),ke.title=e.getConstant("YGColorScale"),Me.title=e.getConstant("GYColorScale"),De.title=e.getConstant("YGColorScale"),Fe.title=e.getConstant("GYColorScale"),Pe.title=e.getConstant("YGColorScale"),Ye.title=e.getConstant("GYColorScale"),Ze.title=e.getConstant("YGColorScale"),fe.appendChild(Le),fe.appendChild(ke),fe.appendChild(Me),fe.appendChild(De),fe.appendChild(Fe),fe.appendChild(Pe),fe.appendChild(Ye),fe.appendChild(Ze);var nt=this.parent.createElement("div",{id:"ThreeArrows",className:"e-3arrows e-is-wrapper"}),it=this.parent.createElement("div",{id:"ThreeArrowsGray",className:"e-3arrowsgray e-is-wrapper"}),et=this.parent.createElement("div",{id:"ThreeTriangles",className:"e-3triangles e-is-wrapper"}),at=this.parent.createElement("div",{id:"FourArrowsGray",className:"e-4arrowsgray e-is-wrapper"}),Ge=this.parent.createElement("div",{id:"FourArrows",className:"e-4arrows e-is-wrapper"}),gt=this.parent.createElement("div",{id:"FiveArrowsGray",className:"e-5arrowsgray e-is-wrapper"}),ge=this.parent.createElement("div",{id:"FiveArrows",className:"e-5arrows e-is-wrapper"});nt.title=e.getConstant("ThreeArrowsColor"),it.title=e.getConstant("ThreeArrowsGray"),et.title=e.getConstant("ThreeTriangles"),at.title=e.getConstant("FourArrowsColor"),Ge.title=e.getConstant("FourArrowsGray"),gt.title=e.getConstant("FiveArrowsColor"),ge.title=e.getConstant("FiveArrowsGray"),ke.appendChild(nt),ke.appendChild(it),ke.appendChild(et),ke.appendChild(at),ke.appendChild(Ge),ke.appendChild(gt),ke.appendChild(ge);var xe=this.parent.createElement("div",{id:"ThreeTrafficLights1",className:"e-3trafficlights e-is-wrapper"}),je=this.parent.createElement("div",{id:"ThreeTrafficLights2",className:"e-3rafficlights2 e-is-wrapper"}),Je=this.parent.createElement("div",{id:"ThreeSigns",className:"e-3signs e-is-wrapper"}),lt=this.parent.createElement("div",{id:"FourTrafficLights",className:"e-4trafficlights e-is-wrapper"}),Qe=this.parent.createElement("div",{id:"FourRedToBlack",className:"e-4redtoblack e-is-wrapper"});xe.title=e.getConstant("ThreeTrafficLights1"),je.title=e.getConstant("ThreeTrafficLights2"),Je.title=e.getConstant("ThreeSigns"),lt.title=e.getConstant("FourTrafficLights"),Qe.title=e.getConstant("RedToBlack"),De.appendChild(xe),De.appendChild(je),De.appendChild(Je),De.appendChild(lt),De.appendChild(Qe);var Bt=this.parent.createElement("div",{id:"ThreeSymbols",className:"e-3symbols e-is-wrapper"}),pi=this.parent.createElement("div",{id:"ThreeSymbols2",className:"e-3symbols2 e-is-wrapper"}),si=this.parent.createElement("div",{id:"ThreeFlags",className:"e-3flags e-is-wrapper"});Bt.title=e.getConstant("ThreeSymbols1"),pi.title=e.getConstant("ThreeSymbols2"),si.title=e.getConstant("ThreeFlags"),Pe.appendChild(Bt),Pe.appendChild(pi),Pe.appendChild(si);var Gt=this.parent.createElement("div",{id:"ThreeStars",className:"e-3stars e-is-wrapper"}),Pi=this.parent.createElement("div",{id:"FourRating",className:"e-4rating e-is-wrapper"}),Gr=this.parent.createElement("div",{id:"FiveQuarters",className:"e-5quarters e-is-wrapper"}),Kr=this.parent.createElement("div",{id:"FiveRating",className:"e-5rating e-is-wrapper"}),as=this.parent.createElement("div",{id:"FiveBoxes",className:"e-5boxes e-is-wrapper"});return Gt.title=e.getConstant("ThreeStars"),Pi.title=e.getConstant("FourRatings"),Gr.title=e.getConstant("FiveQuarters"),Kr.title=e.getConstant("FiveRatings"),as.title=e.getConstant("FiveBoxes"),Ze.appendChild(Gt),Ze.appendChild(Pi),Ze.appendChild(Gr),Ze.appendChild(Kr),Ze.appendChild(as),nt.appendChild(this.createElement("span","e-3arrows-1 e-iconsetspan")),nt.appendChild(this.createElement("span","e-3arrows-2 e-iconsetspan")),nt.appendChild(this.createElement("span","e-3arrows-3 e-iconsetspan")),it.appendChild(this.createElement("span","e-3arrowsgray-1 e-iconsetspan")),it.appendChild(this.createElement("span","e-3arrowsgray-2 e-iconsetspan")),it.appendChild(this.createElement("span","e-3arrowsgray-3 e-iconsetspan")),et.appendChild(this.createElement("span","e-3triangles-1 e-iconsetspan")),et.appendChild(this.createElement("span","e-3triangles-2 e-iconsetspan")),et.appendChild(this.createElement("span","e-3triangles-3 e-iconsetspan")),at.appendChild(this.createElement("span","e-4arrowsgray-1 e-iconsetspan")),at.appendChild(this.createElement("span","e-4arrowsgray-2 e-iconsetspan")),at.appendChild(this.createElement("span","e-4arrowsgray-3 e-iconsetspan")),at.appendChild(this.createElement("span","e-4arrowsgray-4 e-iconsetspan")),Ge.appendChild(this.createElement("span","e-4arrows-1 e-iconsetspan")),Ge.appendChild(this.createElement("span","e-4arrows-2 e-iconsetspan")),Ge.appendChild(this.createElement("span","e-4arrows-3 e-iconsetspan")),Ge.appendChild(this.createElement("span","e-4arrows-4 e-iconsetspan")),gt.appendChild(this.createElement("span","e-5arrowsgray-1 e-iconsetspan")),gt.appendChild(this.createElement("span","e-5arrowsgray-2 e-iconsetspan")),gt.appendChild(this.createElement("span","e-5arrowsgray-3 e-iconsetspan")),gt.appendChild(this.createElement("span","e-5arrowsgray-4 e-iconsetspan")),gt.appendChild(this.createElement("span","e-5arrowsgray-5 e-iconsetspan")),ge.appendChild(this.createElement("span","e-5arrows-1 e-iconsetspan")),ge.appendChild(this.createElement("span","e-5arrows-2 e-iconsetspan")),ge.appendChild(this.createElement("span","e-5arrows-3 e-iconsetspan")),ge.appendChild(this.createElement("span","e-5arrows-4 e-iconsetspan")),ge.appendChild(this.createElement("span","e-5arrows-5 e-iconsetspan")),xe.appendChild(this.createElement("span","e-3trafficlights-1 e-iconsetspan")),xe.appendChild(this.createElement("span","e-3trafficlights-2 e-iconsetspan")),xe.appendChild(this.createElement("span","e-3trafficlights-3 e-iconsetspan")),je.appendChild(this.createElement("span","e-3rafficlights2-1 e-iconsetspan")),je.appendChild(this.createElement("span","e-3rafficlights2-2 e-iconsetspan")),je.appendChild(this.createElement("span","e-3rafficlights2-3 e-iconsetspan")),Je.appendChild(this.createElement("span","e-3signs-1 e-iconsetspan")),Je.appendChild(this.createElement("span","e-3signs-2 e-iconsetspan")),Je.appendChild(this.createElement("span","e-3signs-3 e-iconsetspan")),lt.appendChild(this.createElement("span","e-4trafficlights-1 e-iconsetspan")),lt.appendChild(this.createElement("span","e-4trafficlights-2 e-iconsetspan")),lt.appendChild(this.createElement("span","e-4trafficlights-3 e-iconsetspan")),lt.appendChild(this.createElement("span","e-4trafficlights-4 e-iconsetspan")),Qe.appendChild(this.createElement("span","e-4redtoblack-1 e-iconsetspan")),Qe.appendChild(this.createElement("span","e-4redtoblack-2 e-iconsetspan")),Qe.appendChild(this.createElement("span","e-4redtoblack-3 e-iconsetspan")),Qe.appendChild(this.createElement("span","e-4redtoblack-4 e-iconsetspan")),Bt.appendChild(this.createElement("span","e-3symbols-1 e-iconsetspan")),Bt.appendChild(this.createElement("span","e-3symbols-2 e-iconsetspan")),Bt.appendChild(this.createElement("span","e-3symbols-3 e-iconsetspan")),pi.appendChild(this.createElement("span","e-3symbols2-1 e-iconsetspan")),pi.appendChild(this.createElement("span","e-3symbols2-2 e-iconsetspan")),pi.appendChild(this.createElement("span","e-3symbols2-3 e-iconsetspan")),si.appendChild(this.createElement("span","e-3flags-1 e-iconsetspan")),si.appendChild(this.createElement("span","e-3flags-2 e-iconsetspan")),si.appendChild(this.createElement("span","e-3flags-3 e-iconsetspan")),Gt.appendChild(this.createElement("span","e-3stars-1 e-iconsetspan")),Gt.appendChild(this.createElement("span","e-3stars-2 e-iconsetspan")),Gt.appendChild(this.createElement("span","e-3stars-3 e-iconsetspan")),Pi.appendChild(this.createElement("span","e-4rating-1 e-iconsetspan")),Pi.appendChild(this.createElement("span","e-4rating-2 e-iconsetspan")),Pi.appendChild(this.createElement("span","e-4rating-3 e-iconsetspan")),Pi.appendChild(this.createElement("span","e-4rating-4 e-iconsetspan")),Gr.appendChild(this.createElement("span","e-5quarters-1 e-iconsetspan")),Gr.appendChild(this.createElement("span","e-5quarters-2 e-iconsetspan")),Gr.appendChild(this.createElement("span","e-5quarters-3 e-iconsetspan")),Gr.appendChild(this.createElement("span","e-5quarters-4 e-iconsetspan")),Gr.appendChild(this.createElement("span","e-5quarters-5 e-iconsetspan")),Kr.appendChild(this.createElement("span","e-5rating-1 e-iconsetspan")),Kr.appendChild(this.createElement("span","e-5rating-2 e-iconsetspan")),Kr.appendChild(this.createElement("span","e-5rating-3 e-iconsetspan")),Kr.appendChild(this.createElement("span","e-5rating-4 e-iconsetspan")),Kr.appendChild(this.createElement("span","e-5rating-5 e-iconsetspan")),as.appendChild(this.createElement("span","e-5boxes-1 e-iconsetspan")),as.appendChild(this.createElement("span","e-5boxes-2 e-iconsetspan")),as.appendChild(this.createElement("span","e-5boxes-3 e-iconsetspan")),as.appendChild(this.createElement("span","e-5boxes-4 e-iconsetspan")),as.appendChild(this.createElement("span","e-5boxes-5 e-iconsetspan")),i.createElement=this.parent.createElement,i.appendTo(t),t.classList.add("e-ul"),i},o.prototype.createElement=function(t,e){return this.parent.createElement(t,{className:e})},o.prototype.getBordersDBB=function(t){var e=this,i=this.parent.createElement("ul",{id:t+"_borders_menu"});this.cPickerEle=this.parent.createElement("input",{id:t+"_cell_border_color",attrs:{type:"color"}}),this.parent.element.appendChild(this.cPickerEle),this.colorPicker=new wp({cssClass:"e-border-colorpicker",mode:"Palette",inline:!0,change:function(n){var s=e.border.split(" ");s[2]=n.currentValue.hex,e.border=s.join(" ")}}),this.colorPicker.createElement=this.parent.createElement,this.colorPicker.appendTo(this.cPickerEle);var r;return this.bordersDdb=new Bi({iconCss:"e-icons e-bottom-borders",cssClass:"e-borders-ddb",target:i,createPopupOnClick:!0,beforeOpen:function(n){r=e.createBorderMenu(i),e.tBarDdbBeforeOpen(n.element,r.items,1)},beforeClose:function(n){n.event&&(0,a.oq)(n.event.target,".e-borders-menu")?n.cancel=!0:r.destroy()},close:function(){return we(e.parent.element)}}),this.bordersDdb.createElement=this.parent.createElement,this.bordersDdb.appendTo(this.parent.createElement("button",{id:t+"_borders"})),this.bordersDdb.element},o.prototype.createBorderMenu=function(t){var e=this,i=this.parent.serviceLocator.getService(Ve),r=this.parent.element.id,n=new qa({cssClass:"e-borders-menu",items:[{iconCss:"e-icons e-top-borders",text:i.getConstant("TopBorders"),id:r+"_border_topborders"},{iconCss:"e-icons e-left-borders",text:i.getConstant("LeftBorders"),id:r+"_border_leftborders"},{iconCss:"e-icons e-right-borders",text:i.getConstant("RightBorders"),id:r+"_border_rightborders"},{iconCss:"e-icons e-bottom-borders",text:i.getConstant("BottomBorders"),id:r+"_border_bottomborders"},{iconCss:"e-icons e-all-borders",text:i.getConstant("AllBorders"),id:r+"_border_allborders"},{iconCss:"e-icons e-horizontal-borders",text:i.getConstant("HorizontalBorders"),id:r+"_border_horizontalborders"},{iconCss:"e-icons e-vertical-borders",text:i.getConstant("VerticalBorders"),id:r+"_border_verticalborders"},{iconCss:"e-icons e-outside-borders",text:i.getConstant("OutsideBorders"),id:r+"_border_outsideborders"},{iconCss:"e-icons e-inside-borders",text:i.getConstant("InsideBorders"),id:r+"_border_insideborders"},{iconCss:"e-icons e-no-borders",text:i.getConstant("NoBorders"),id:r+"_border_noborders"},{separator:!0},{text:i.getConstant("BorderColor"),items:[{id:r+"_border_colors"}],id:r+"_border_bordercolor"},{text:i.getConstant("BorderStyle"),items:[{iconCss:"e-icons e-selected-icon",id:r+"_1px"},{id:r+"_2px"},{id:r+"_3px"},{id:r+"_dashed"},{id:r+"_dotted"},{id:r+"_double"}]}],orientation:"Vertical",beforeOpen:function(s){if(s.parentItem.id===r+"_border_bordercolor"){e.colorPicker.refresh();var l=e.colorPicker.element.parentElement;s.element.firstElementChild.appendChild(l),l.style.display="inline-block",s.element.parentElement.classList.add("e-border-color")}else s.element.classList.add("e-border-style")},beforeClose:function(s){if(s.parentItem.id===r+"_border_bordercolor")if(!(0,a.oq)(s.event.target,".e-border-colorpicker")||(0,a.oq)(s.event.target,".e-apply")||(0,a.oq)(s.event.target,".e-cancel")){e.colorPicker=(0,a.Xr)(e.cPickerEle,"colorpicker"),e.colorPicker.mode==="Picker"&&(e.colorPicker.mode="Palette",e.colorPicker.dataBind());var l=e.colorPicker.element.parentElement;l.style.display="",e.parent.element.appendChild(l)}else s.cancel=!0},onOpen:function(s){s.parentItem.id===r+"_border_bordercolor"&&(s.element.parentElement.style.overflow="visible")},select:function(s){return e.borderSelected(s,n)}});return n.createElement=this.parent.createElement,n.appendTo(t),t.classList.add("e-ul"),n},o.prototype.chartSelected=function(t,e){var i=!(0,a.le)((0,a.oq)(t.element,".e-chart-menu")),r=t.element.id;if("column_chartbar_chartarea_chartpie_doughnut_chartline_chartradar_chartscatter_chart".includes(r)){var n=t.event.target.id;this.parent.notify(E.jh,{action:r,id:n,isChart:i})}t.item&&(!t.item.items||!t.item.items.length)&&e.toggle()},o.prototype.addChartEleSelected=function(t){var e=t.element.id;this.parent.notify(E.dG,{addChartEle:e,triggerEvent:!0}),t.item&&(!t.item.items||!t.item.items.length)&&this.addChartDdb.toggle()},o.prototype.cFSelected=function(t){var e=t.element.id;if("cf_greaterthancf_lessthancf_betweencf_eqaultocf_textthatcontainscf_adateoccuringcf_duplicatevaluescf_top10itemscf_top10cf_bottom10itemscf_bottom10cf_aboveaveragecf_belowaverage".includes(e))this.parent.notify(E.h4,{action:t.item.text});else if("cf_databarscf_colorscales".includes(e)){var i=t.event.target.id;this.parent.notify(E.Nm,{action:e,id:i})}else if(t.element.id==="cf_iconsets"){var r=t.event.target,n=r.id===""?r.parentElement.id:r.id;this.parent.notify(E.Nm,{action:e,id:n})}if(e==="cf_cr_cells")this.parent.notify(pe.G2p,{range:this.parent.getActiveSheet().selectedRange,isPublic:!1});else if(e==="cf_cr_sheet"){var s=this.parent.getActiveSheet(),l=(0,pe.i0K)([0,0,s.rowCount-1,s.colCount-1]);this.parent.conditionalFormat=null,this.parent.notify(pe.G2p,{range:l,isPublic:!1})}t.item&&(!t.item.items||!t.item.items.length)&&this.cFDdb.toggle()},o.prototype.borderSelected=function(t,e){var i=this.parent.element.id;if(!(t.item.items.length||t.item.id===i+"_border_colors")){if(!t.item.text){var r=this.border.split(" "),n=r[1]==="solid"?i+"_"+r[0]:i+"_"+r[1];if(n===t.item.id)return;t.item.id===i+"_1px"||t.item.id===i+"_2px"||t.item.id===i+"_3px"?(r[0]=t.item.id.split(i+"_")[1],r[1]="solid"):(r[1]=t.item.id.split(i+"_")[1],r[0]=r[1]==="double"?"3px":"1px"),this.border=r.join(" "),e.items[12].items.forEach(function(s){s.id===n&&(s.iconCss=null),s.id===t.item.id&&(s.iconCss="e-icons e-selected-icon")}),e.setProperties({items:e.items},!0);return}switch(this.bordersDdb.toggle(),this.parent.showSpinner(),t.item.id){case i+"_border_topborders":this.parent.notify(w.vbl,{style:{borderTop:this.border},onActionUpdate:!0});break;case i+"_border_leftborders":this.parent.notify(w.vbl,{style:{borderLeft:this.border},onActionUpdate:!0});break;case i+"_border_rightborders":this.parent.notify(w.vbl,{style:{borderRight:this.border},onActionUpdate:!0});break;case i+"_border_bottomborders":this.parent.notify(w.vbl,{style:{borderBottom:this.border},onActionUpdate:!0});break;case i+"_border_allborders":this.parent.notify(w.vbl,{style:{border:this.border},onActionUpdate:!0});break;case i+"_border_horizontalborders":this.parent.notify(w.vbl,{style:{border:this.border},onActionUpdate:!0,borderType:"Horizontal"});break;case i+"_border_verticalborders":this.parent.notify(w.vbl,{style:{border:this.border},onActionUpdate:!0,borderType:"Vertical"});break;case i+"_border_outsideborders":this.parent.notify(w.vbl,{style:{border:this.border},onActionUpdate:!0,borderType:"Outer"});break;case i+"_border_insideborders":this.parent.notify(w.vbl,{style:{border:this.border},onActionUpdate:!0,borderType:"Inner"});break;case i+"_border_noborders":this.parent.notify(w.vbl,{style:{border:""},onActionUpdate:!0});break}this.parent.hideSpinner()}},o.prototype.getFontNameDDB=function(t){var e=this,i=this.parent.createElement("button",{id:t+"_font_name"});return i.appendChild(this.parent.createElement("span",{className:"e-tbar-btn-text",innerHTML:"Calibri"})),this.fontNameDdb=new Bi({cssClass:"e-font-family",items:this.getFontFamilyItems(),createPopupOnClick:!0,select:function(r){var n={style:{fontFamily:r.item.text},onActionUpdate:!0};e.parent.notify(w.vbl,n),n.cancel||e.refreshFontNameSelection(n.style.fontFamily)},close:function(){return we(e.parent.element)},beforeOpen:function(r){return e.tBarDdbBeforeOpen(r.element,r.items)}}),this.fontNameDdb.createElement=this.parent.createElement,this.fontNameDdb.appendTo(i),i},o.prototype.getBtn=function(t,e,i){i===void 0&&(i=!0);var r=new $r({iconCss:"e-icons e-"+e+"-icon",isToggle:!0});return r.createElement=this.parent.createElement,r.appendTo(this.parent.createElement("button",{id:t+"_"+e,attrs:{type:"button"}})),i&&r.element.addEventListener("click",this.toggleBtnClicked.bind(this)),r.element},o.prototype.datavalidationDDB=function(t){var e=this,i=this.parent.serviceLocator.getService(Ve),r;return this.datavalidationDdb=new Bi({cssClass:"e-datavalidation-ddb",iconCss:"e-datavalidation-icon e-icons",content:i.getConstant("DataValidation"),items:[{text:i.getConstant("DataValidation")},{text:i.getConstant("HighlightInvalidData")},{text:i.getConstant("ClearHighlight")},{text:i.getConstant("ClearValidation")}],createPopupOnClick:!0,beforeOpen:function(n){e.refreshSelected(e.datavalidationDdb,n.element,"iconCss")},select:function(n){switch(n.item.text){case i.getConstant("DataValidation"):e.parent.notify(E.Z4,null);break;case i.getConstant("HighlightInvalidData"):e.parent.notify(E.QG,{isRemoveHighlight:!1});break;case i.getConstant("ClearHighlight"):e.parent.notify(E.QG,{isRemoveHighlight:!0});break;case i.getConstant("ClearValidation"):e.parent.notify(E.hu,{isAction:!0});break;default:r=n.item.text===i.getConstant("SortAscending")?"Ascending":"Descending",e.parent.notify(E.vy,{sortOptions:{sortDescriptors:{order:r}}});break}},close:function(){return we(e.parent.element)}}),this.datavalidationDdb.createElement=this.parent.createElement,this.datavalidationDdb.appendTo(this.parent.createElement("button",{id:t+"_datavalidation"})),this.datavalidationDdb.element},o.prototype.getTextAlignDDB=function(t){var e=this;return this.textAlignDdb=new Bi({cssClass:"e-align-ddb",iconCss:"e-icons e-left-icon",items:[{iconCss:"e-icons e-left-icon"},{iconCss:"e-icons e-center-icon"},{iconCss:"e-icons e-right-icon"}],beforeItemRender:this.alignItemRender.bind(this),createPopupOnClick:!0,beforeOpen:function(i){e.refreshSelected(e.textAlignDdb,i.element,"iconCss")},select:function(i){var r={style:{textAlign:i.item.iconCss.split(" e-")[1].split("-icon")[0]},onActionUpdate:!0};e.parent.notify(w.vbl,r),r.cancel||(e.textAlignDdb.iconCss="e-icons e-"+r.style.textAlign+"-icon",e.textAlignDdb.dataBind())},close:function(){return we(e.parent.element)}}),this.textAlignDdb.createElement=this.parent.createElement,this.textAlignDdb.appendTo(this.parent.createElement("button",{id:t+"_text_align"})),this.textAlignDdb.element},o.prototype.getVerticalAlignDDB=function(t){var e=this;return this.verticalAlignDdb=new Bi({cssClass:"e-align-ddb",iconCss:"e-icons e-bottom-icon",items:[{iconCss:"e-icons e-top-icon"},{iconCss:"e-icons e-middle-icon"},{iconCss:"e-icons e-bottom-icon"}],beforeItemRender:this.alignItemRender.bind(this),createPopupOnClick:!0,beforeOpen:function(i){e.refreshSelected(e.verticalAlignDdb,i.element,"iconCss")},select:function(i){var r={style:{verticalAlign:i.item.iconCss.split(" e-")[1].split("-icon")[0]},onActionUpdate:!0};e.parent.notify(w.vbl,r),r.cancel||(e.verticalAlignDdb.iconCss="e-icons e-"+r.style.verticalAlign+"-icon",e.verticalAlignDdb.dataBind())},close:function(){return we(e.parent.element)}}),this.verticalAlignDdb.createElement=this.parent.createElement,this.verticalAlignDdb.appendTo(this.parent.createElement("button",{id:t+"_vertical_align"})),this.verticalAlignDdb.element},o.prototype.getMergeSplitBtn=function(t){var e=this;this.parent.element.appendChild(this.parent.createElement("button",{id:t+"_merge"}));var i=this.parent.serviceLocator.getService(Ve);return this.mergeSplitBtn=new pp({cssClass:"e-merge-ddb",iconCss:"e-icons e-merge-icon",createPopupOnClick:!0,items:[{text:i.getConstant("MergeAll"),id:t+"_merge_all"},{text:i.getConstant("MergeHorizontally"),id:t+"_merge_horizontally"},{text:i.getConstant("MergeVertically"),id:t+"_merge_vertically"},{separator:!0,id:t+"_merge_separator"},{text:i.getConstant("Unmerge"),id:t+"_unmerge"}],select:this.mergeSelectHandler.bind(this),close:function(){return we(e.parent.element)},click:function(r){r.element.classList.contains("e-active")?(e.toggleActiveState(!1),e.unMerge()):(e.toggleActiveState(!0),e.merge(e.parent.element.id+"_merge_all"))},created:function(){e.mergeSplitBtn.element.title=i.getConstant("MergeCells"),e.mergeSplitBtn.element.nextElementSibling.title=i.getConstant("SelectMergeType")}}),this.mergeSplitBtn.createElement=this.parent.createElement,this.mergeSplitBtn.appendTo("#"+t+"_merge"),this.mergeSplitBtn.element.parentElement},o.prototype.mergeSelectHandler=function(t){t.item.id===this.parent.element.id+"_unmerge"?this.unMerge():this.merge(t.item.id)},o.prototype.unMerge=function(){this.parent.showSpinner(),this.parent.notify(pe.mtj,{merge:!1,range:this.parent.getActiveSheet().selectedRange,isAction:!0,refreshRibbon:!0,type:"All"}),this.parent.hideSpinner()},o.prototype.merge=function(t){for(var e=this,i=this.parent.getActiveSheet(),r=(0,pe.dK5)(i.selectedRange),n,s,l=r[0];l<=r[2];l++)for(var h=r[1];h<=r[3];h++)l===r[0]&&h===r[1]&&t.includes("merge_all")||l===r[0]&&t.includes("merge_vertically")||h===r[1]&&t.includes("_merge_horizontally")||(n=(0,w.$Su)(l,h,i)||{},(n.value||n.formula)&&(s=!0));if(!s){this.performMerge(t);return}var c=this.parent.serviceLocator.getService(Yt);c.show({target:this.parent.element,height:200,width:400,isModal:!0,showCloseIcon:!0,cssClass:"e-merge-alert-dlg",content:this.parent.serviceLocator.getService(Ve).getConstant("MergeCellsAlert"),beforeOpen:function(u){var p={dialogName:"MergeAlertDialog",element:u.element,target:u.target,cancel:u.cancel};e.parent.trigger("dialogBeforeOpen",p),p.cancel&&(u.cancel=!0),we(e.parent.element)},buttons:[{buttonModel:{content:this.parent.serviceLocator.getService(Ve).getConstant("Ok"),isPrimary:!0},click:function(){c.hide(),e.performMerge(t)}}]})},o.prototype.performMerge=function(t){var e=this.parent.element.id;switch(this.parent.showSpinner(),t){case e+"_merge_all":this.parent.notify(pe.mtj,{merge:!0,range:this.parent.getActiveSheet().selectedRange,type:"All",isAction:!0,refreshRibbon:!0});break;case e+"_merge_horizontally":this.parent.notify(pe.mtj,{merge:!0,range:this.parent.getActiveSheet().selectedRange,type:"Horizontally",isAction:!0});break;case e+"_merge_vertically":this.parent.notify(pe.mtj,{merge:!0,range:this.parent.getActiveSheet().selectedRange,type:"Vertically",isAction:!0});break}this.parent.hideSpinner()},o.prototype.getSortFilterDDB=function(t){var e=this,i=this.parent.serviceLocator.getService(Ve),r;return this.sortingDdb=new Bi({cssClass:"e-sort-filter-ddb",iconCss:"e-icons e-sort-filter-icon",items:[{text:i.getConstant("SortAscending"),iconCss:"e-icons e-sort-asc"},{text:i.getConstant("SortDescending"),iconCss:"e-icons e-sort-desc"},{text:i.getConstant("CustomSort")+"...",iconCss:"e-icons e-sort-custom"},{separator:!0},{text:i.getConstant("Filter"),iconCss:"e-icons e-filter-apply",id:t+"_applyfilter"},{text:i.getConstant("ClearAllFilter"),iconCss:"e-icons e-filter-clear",id:t+"_clearfilter"},{text:i.getConstant("ReapplyFilter"),iconCss:"e-icons e-filter-reapply",id:t+"_reapplyfilter"}],createPopupOnClick:!0,beforeItemRender:function(n){var s={isFiltered:!1,isClearAll:!0};e.parent.notify(E.I2,s),!e.parent.allowSorting&&(n.item.text===i.getConstant("SortAscending")||n.item.text===i.getConstant("SortDescending")||n.item.text===i.getConstant("CustomSort")+"...")&&n.element.classList.add("e-disabled"),!e.parent.allowFiltering&&n.item.text===i.getConstant("Filter")&&n.element.classList.add("e-disabled"),(n.item.id===t+"_clearfilter"||n.item.id===t+"_reapplyfilter")&&(s.isFiltered?n.element.classList.remove("e-disabled"):n.element.classList.add("e-disabled"))},beforeOpen:function(n){e.refreshSelected(e.sortingDdb,n.element,"iconCss")},select:function(n){switch(n.item.text){case i.getConstant("Filter"):e.parent.notify(E.WG,{});break;case i.getConstant("ClearAllFilter"):e.parent.notify(E.Dg,{isAction:!0});break;case i.getConstant("ReapplyFilter"):e.parent.notify(E.Zh,null);break;case i.getConstant("CustomSort")+"...":e.parent.notify(E.HR,null);break;default:r=n.item.text===i.getConstant("SortAscending")?"Ascending":"Descending",e.parent.notify(E.vy,{sortOptions:{sortDescriptors:{order:r}}});break}},close:function(){return we(e.parent.element)}}),this.sortingDdb.createElement=this.parent.createElement,this.sortingDdb.appendTo(this.parent.createElement("button",{id:t+"_sorting"})),this.sortingDdb.element},o.prototype.getFindBtn=function(t){var e=this.parent.createElement("button",{id:t+"_findbtn",attrs:{type:"button"}});return this.findDdb=new $r({cssClass:"e-spreadsheet-find-ddb",iconCss:"e-icons e-search-icon"}),this.findDdb.createElement=this.parent.createElement,this.findDdb.appendTo(e),e.onclick=this.findToolDlg.bind(this),this.findDdb.element},o.prototype.findToolDlg=function(t){var e=this,i=function(L){var D=t&&t.target?(0,a.oq)(t.target,"#"+e.parent.element.id+"_findbtn"):(0,a.Ys)("#"+e.parent.element.id+"_findbtn",e.ribbon.element);D&&(L?D.classList.add("e-disabled"):D.classList.remove("e-disabled"),D.disabled=L)};i(!0);var r=this.parent.element.getElementsByClassName("e-findtool-dlg")[0];if(r)this.findDialog.hide();else{var n,s=this.parent.createElement("div",{className:"e-input-group"}),l=this.parent.createElement("input",{className:"e-input e-text-findNext-short",attrs:{type:"Text"}});this.findValue&&(l.value=this.findValue);var h=this.parent.serviceLocator.getService(Ve);l.setAttribute("placeholder",h.getConstant("FindValue"));var c=this.parent.createElement("span",{className:"e-input-group-icon"}),u,p=this.parent.getActiveSheet(),f=p.usedRange.rowIndex*p.usedRange.colIndex>100;l.onkeyup=function(L){var D=function(){if(!!l){var R=l.value;if(L.keyCode===13)l.value&&c.textContent!=="0 of 0"&&(e.parent.notify(E.nb,{findOption:L.shiftKey?"prev":"next"}),e.updateCount(c,L.shiftKey));else{var B=void 0;if(R==="")c.textContent="0 of 0",B=!1;else{var H={value:R,mode:"Sheet",isCSen:!1,sheetIndex:e.parent.activeSheetIndex,isEMatch:!1,searchBy:"By Row"};e.parent.notify(pe.QXW,H),c.textContent=H.findCount,B=H.findCount!=="0 of 0"}n.enableItems(1,B),n.enableItems(2,B)}}};f?(u&&clearTimeout(u),u=setTimeout(D,500)):D()},s.appendChild(l),s.appendChild(c);var g=[{type:"Input",template:s},{prefixIcon:"e-icons e-prev-icon",tooltipText:"Find Previous",type:"Button",cssClass:"e-findRib-prev",disabled:!0},{prefixIcon:"e-icons e-next-icon",tooltipText:"Find Next",type:"Button",cssClass:"e-findRib-next",disabled:!0},{type:"Separator"},{prefixIcon:"e-icons e-option-icon",tooltipText:"More Options",type:"Button",cssClass:"e-findRib-more"},{prefixIcon:"e-icons e-close",tooltipText:"Close",type:"Button",cssClass:"e-findRib-close"}];n=new Ho({clicked:function(L){L.item.cssClass==="e-findRib-next"?(e.parent.notify(E.nb,{findOption:"next"}),e.updateCount(c)):L.item.cssClass==="e-findRib-prev"?(e.parent.notify(E.nb,{findOption:"prev"}),e.updateCount(c,!0)):L.item.cssClass==="e-findRib-more"&&(e.parent.notify(E.DK,null),e.findDialog.hide())},width:"auto",height:"auto",items:g,cssClass:"e-find-toolObj"});var C=this.parent.createElement("div",{className:"e-find-toolbar"});n.createElement=this.parent.createElement,n.appendTo(C),r=this.parent.createElement("div",{className:"e-dlg-div"}),this.findDialog=new sl({cssClass:"e-findtool-dlg",content:C,visible:!1,target:this.parent.element.getElementsByClassName("e-sheet")[0],open:function(){if(a.bi.add(document,"click",e.closeDialog,e),e.findValue){var L={value:e.findValue,mode:"Sheet",isCSen:!1,sheetIndex:e.parent.activeSheetIndex,isEMatch:!1,searchBy:"By Row"};e.parent.notify(pe.QXW,L),c.textContent=L.findCount}else c.textContent="0 of 0";i(!1),n.element.addEventListener("focus",function(){var D=document.querySelector(".e-text-findNext-short");D.focus(),D.classList.add("e-input-focus"),D.setSelectionRange(0,D.value.length)})},beforeClose:function(){e.findValue=l.value||null,n.destroy(),a.bi.remove(document,"click",e.closeDialog)},close:function(){e.findDialog.destroy(),e.findDialog=null,(0,a.og)(r),we(e.parent.element),i(!1)},created:function(){var L=e.parent.getMainContent();r.style.width=L.offsetWidth+"px",r.style.visibility="hidden",r.style.display="block",e.findDialog.width=parseInt(getComputedStyle(r).borderLeftWidth,10)*2+r.querySelector(".e-toolbar-items").getBoundingClientRect().width+"px",r.style.display="",r.style.width="",r.style.visibility="",e.findDialog.position={X:L.parentElement.getBoundingClientRect().width-parseInt(e.findDialog.width,10)-e.parent.sheetModule.getScrollSize(),Y:e.parent.getActiveSheet().showHeaders?31:0},e.findDialog.dataBind(),e.findDialog.show()}}),this.findDialog.createElement=this.parent.createElement,this.findDialog.appendTo(r)}},o.prototype.updateCount=function(t,e){var i=t.textContent.split(" "),r;e?(r=Number(i[0])-1,r<1&&(r=Number(i[2]))):(r=Number(i[0])+1,r>Number(i[2])&&(r=1)),i[0]=r.toString(),t.textContent=i.join(" ")},o.prototype.closeDialog=function(t){((0,a.oq)(t.target,".e-findRib-close")||!(0,a.oq)(t.target,".e-spreadsheet"))&&this.findDialog&&this.findToolDlg()},o.prototype.getClearDDB=function(t){var e=this,i=this.parent.serviceLocator.getService(Ve);return this.clearDdb=new Bi({cssClass:"e-clear-ddb",iconCss:"e-icons e-clear-icon",items:[{text:i.getConstant("ClearAll"),id:t+"_Clear All"},{text:i.getConstant("ClearFormats"),id:t+"_Clear Formats"},{text:i.getConstant("ClearContents"),id:t+"_Clear Contents"},{text:i.getConstant("ClearHyperlinks"),id:t+"_Clear Hyperlinks"}],createPopupOnClick:!0,select:function(r){return e.parent.notify(E.MQ,{options:{type:r.item.id.replace(t+"_","")}})},close:function(){return we(e.parent.element)}}),this.clearDdb.createElement=this.parent.createElement,this.clearDdb.appendTo(this.parent.createElement("button",{id:t+"_clear"})),this.clearDdb.element},o.prototype.ribbonCreated=function(){this.ribbon.element.querySelector(".e-drop-icon").title=this.parent.serviceLocator.getService(Ve).getConstant("CollapseToolbar")},o.prototype.alignItemRender=function(t){var e=t.item.iconCss.split(" e-")[1].split("-icon")[0];e=e[0].toUpperCase()+e.slice(1,e.length),t.element.title=this.parent.serviceLocator.getService(Ve).getConstant("Align"+e)},o.prototype.toggleBtnClicked=function(t){var e=(0,a.oq)(t.target,".e-btn"),i=this.parent.element.id,r=e.id,n=w.vbl,s,l,h,c,u;switch(r){case i+"_bold":l={fontWeight:"normal"},h={fontWeight:"bold"},u="fontWeight";break;case i+"_italic":l={fontStyle:"normal"},h={fontStyle:"italic"},u="fontStyle";break;case i+"_line-through":n=pe.nQ,l={textDecoration:"line-through"},h=l,u="textDecoration";break;case i+"_underline":n=pe.nQ,l={textDecoration:"underline"},h=l,u="textDecoration";break}e.classList.contains("e-active")?(s=h[u],c={style:h,onActionUpdate:!0},this.parent.notify(n,c),c.cancel&&e.classList.remove("e-active")):(s=l[u],c={style:l,onActionUpdate:!0},this.parent.notify(n,c),c.cancel&&e.classList.add("e-active")),!c.cancel&&s!==c.style[u]&&this.refreshToggleBtn((0,w.n53)(this.parent.getActiveSheet().activeCell)),we(this.parent.element)},o.prototype.getCellStyleValue=function(t,e){var i=(0,w.$Su)(e[0],e[1],this.parent.getActiveSheet()),r=this.parent.cellStyle[t];return i&&i.style&&i.style[t]&&(r=i.style[t]),r},o.prototype.refreshSelected=function(t,e,i,r){r===void 0&&(r=i);for(var n=0;n<t.items.length;n++)if(t.items[n][r]===t[i]){e.children[n].classList.add("e-selected");break}},o.prototype.expandCollapseHandler=function(t){var e=this.ribbon.element.querySelector(".e-drop-icon"),i=this.parent.serviceLocator.getService(Ve);t.expanded?e.title=i.getConstant("CollapseToolbar"):e.title=i.getConstant("ExpandToolbar"),this.parent.setPanelSize()},o.prototype.getChartThemeDdbItems=function(){var t=this.parent.serviceLocator.getService(Ve);return[{id:"Material",text:t.getConstant("Material")},{id:"Fabric",text:t.getConstant("Fabric")},{id:"Bootstrap",text:t.getConstant("Bootstrap")},{id:"HighContrastLight",text:t.getConstant("HighContrastLight")},{id:"MaterialDark",text:t.getConstant("MaterialDark")},{id:"FabricDark",text:t.getConstant("FabricDark")},{id:"HighContrast",text:t.getConstant("HighContrast")},{id:"BootstrapDark",text:t.getConstant("BootstrapDark")},{id:"Bootstrap4",text:t.getConstant("Bootstrap4")},{id:"Bootstrap5Dark",text:t.getConstant("Bootstrap5Dark")},{id:"Bootstrap5",text:t.getConstant("Bootstrap5")},{id:"TailwindDark",text:t.getConstant("TailwindDark")},{id:"Tailwind",text:t.getConstant("Tailwind")},{id:"FluentDark",text:t.getConstant("FluentDark")},{id:"Fluent",text:t.getConstant("Fluent")}]},o.prototype.getNumFormatDdbItems=function(t){var e=this.parent.serviceLocator.getService(Ve);return[{id:t+"_General",text:e.getConstant("General")},{id:t+"_Number",text:e.getConstant("Number")},{id:t+"_Currency",text:e.getConstant("Currency")},{id:t+"_Accounting",text:e.getConstant("Accounting")},{id:t+"_ShortDate",text:e.getConstant("ShortDate")},{id:t+"_LongDate",text:e.getConstant("LongDate")},{id:t+"_Time",text:e.getConstant("Time")},{id:t+"_Percentage",text:e.getConstant("Percentage")},{id:t+"_Fraction",text:e.getConstant("Fraction")},{id:t+"_Scientific",text:e.getConstant("Scientific")},{id:t+"_Text",text:e.getConstant("Text")},{id:t+"_Custom",text:e.getConstant("Custom")}]},o.prototype.getFontFamilyItems=function(){return[{text:"Arial"},{text:"Arial Black"},{text:"Axettac Demo"},{text:"Batang"},{text:"Book Antiqua"},{text:"Calibri",iconCss:"e-icons e-selected-icon"},{text:"Courier"},{text:"Courier New"},{text:"Din Condensed"},{text:"Georgia"},{text:"Helvetica"},{text:"Helvetica New"},{text:"Roboto"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Verdana"}]},o.prototype.numDDBSelect=function(t){var e=this.parent.serviceLocator.getService(Ve),i=this.parent.getActiveSheet(),r=(0,w.n53)(i.activeCell),n=(0,w.$Su)(r[0],r[1],i),s=t.item.id.split(this.parent.element.id+"_")[1],l={format:(0,w.KzY)(s),range:i.selectedRange,cancel:!1,requestType:"NumberFormat"};t.item.text===e.getConstant("Custom")&&n&&(l.format=n.format);var h={range:i.name+"!"+l.range,format:l.format,requestType:"NumberFormat"};this.parent.trigger("beforeCellFormat",l),this.parent.notify(pe.ya2,{eventArgs:l,action:"format"}),!l.cancel&&(this.parent.notify(pe.XUD,l),this.parent.notify(w.Pmi,{type:"mousedown"}),t.item.text===e.getConstant("Custom")?this.renderCustomFormatDialog():(this.refreshNumFormatSelection(t.item.text),this.refreshTextAlign(i,(0,w.$Su)(r[0],r[1],i,!1,!0),s,r),this.parent.notify(E.Av,{eventArgs:h,action:"format"})))},o.prototype.renderCustomFormatDialog=function(){var t=this,e=this.parent.serviceLocator.getService(Ve),i=(0,w.n53)(this.parent.getActiveSheet().activeCell),r=(0,w.$Su)(i[0],i[1],this.parent.getActiveSheet()),n=this.parent.createElement("div"),s=this.parent.createElement("div",{className:"e-custom-dialog"}),l=this.parent.createElement("button",{className:"e-btn",innerHTML:e.getConstant("APPLY")}),h=this.parent.createElement("div",{className:"e-custom-sample",innerHTML:e.getConstant("CustomFormatSample")+":"}),c=this.parent.createElement("input",{className:"e-input e-dialog-input",attrs:{type:"text",name:"input",placeholder:"Custom Number Format",spellcheck:"false"}}),u=this.parent.createElement("div",{className:"e-custom-listview"}),p=this.parent.serviceLocator.getService(Yt),f=[{text:"General"},{text:"0"},{text:"0.00"},{text:"#,##0"},{text:"#,##0.00"},{text:"#,##0_);(#,##0)"},{text:"#,##0_);[Red](#,##0)"},{text:"#,##0.00_);(#,##0.00)"},{text:"#,##0.00_);[Red](#,##0.00)"},{text:"$#,##0_);($#,##0)"},{text:"$#,##0_);[Red]($#,##0)"},{text:"$#,##0.00_);($#,##0.00)"},{text:"$#,##0.00_);[Red]($#,##0.00)"},{text:"0%"},{text:"0.00%"},{text:"0.00E+00"},{text:"##0.0E+0"},{text:"# ?/?"},{text:"# ??/??"},{text:"dd-MM-yy"},{text:"dd-MMM-yy"},{text:"dd-MMM"},{text:"MMM-yy"},{text:"h:mm AM/PM"},{text:"h:mm:ss AM/PM"},{text:"h:mm"},{text:"h:mm:ss"},{text:"dd-MM-yy h:mm"},{text:"mm:ss"},{text:"mm:ss.0"},{text:"@"},{text:"[h]:mm:ss"},{text:'_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'},{text:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'},{text:'_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'},{text:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'}],g=new Sh({dataSource:f,select:function(L){c.value=L.text}});s.appendChild(c),s.appendChild(l),s.appendChild(h),s.appendChild(u),g.appendTo(u),l.addEventListener("click",function(){var L=c.value,D={range:t.parent.getActiveSheet().name+"!"+t.parent.getActiveSheet().selectedRange,format:L,requestType:"NumberFormat"};t.parent.numberFormat(L,D.range),t.refreshNumFormatSelection(e.getConstant("Custom")),g.destroy(),p.hide(),t.parent.notify(E.Av,{eventArgs:D,action:"format"})}),p.show({header:e.getConstant("CustomFormat"),cssClass:"e-custom-format-dlg",height:this.parent.cssClass.indexOf("e-bigger")>-1?502:480,width:440,isModal:!0,showCloseIcon:!0,content:s,footerTemplate:n});var C={text:r.format};g.selectItem(C)},o.prototype.chartThemeDDBSelect=function(t){this.parent.notify(w.Pmi,{type:"mousedown"}),this.refreshChartThemeSelection(t.item.id),this.parent.notify(E.dG,{chartTheme:t.item.id,triggerEvent:!0})},o.prototype.tBarDdbBeforeOpen=function(t,e,i){i===void 0&&(i=0);var r=this.parent.viewport.height,n=parseInt(getComputedStyle(t.firstElementChild).height,10)*(e.length-i)+parseInt(getComputedStyle(t).paddingTop,10)*2;if(i){var s=getComputedStyle(t.querySelector(".e-separator"));n+=i*(parseInt(s.borderBottomWidth,10)+parseInt(s.marginTop,10)*2)}n>r?(t.style.height=r+"px",t.style.overflowY="auto"):t.style.height&&(t.style.height="",t.style.overflowY="")},o.prototype.numDDBOpen=function(t){this.numPopupWidth=0;for(var e=t.element.querySelectorAll("span.e-numformat-preview-text"),i=0,r=e.length;i<r;i++)this.numPopupWidth<e[i].offsetWidth&&(this.numPopupWidth=e[i].offsetWidth);var n=this.numPopupWidth+160;document.querySelector(".e-numformat-ddb.e-dropdown-popup").style.width=n+"px"},o.prototype.previewNumFormat=function(t){if(t.item.text!=="Custom"){var e=this.parent.createElement("div",{className:"e-numformat-text",styles:"width:100%",innerHTML:t.element.innerHTML});t.element.innerHTML="";var i=this.parent.getActiveSheet(),r=(0,w.n53)(i.activeCell),n=(0,w.$Su)(r[0],r[1],i),s={type:t.item.text,formattedText:"",value:n&&(n.value||n.value===0)?n.value:"",format:(0,w.KzY)(t.item.id.split(this.parent.element.id+"_")[1]),sheetIndex:this.parent.activeSheetIndex,onLoad:!0};this.parent.notify(pe.eYQ,s);var l=this.parent.createElement("span",{className:"e-numformat-preview-text",styles:"float:right;",innerHTML:s.formattedText.toString()});e.appendChild(l),t.element.appendChild(e)}},o.prototype.refreshRibbonContent=function(t){if(!!this.ribbon){(0,a.le)(t)&&(t=this.ribbon.selectedTab);var e=this.parent.serviceLocator.getService(Ve),i=this.parent.getActiveSheet();switch(this.ribbon.items[t].header.text){case e.getConstant("Home"):this.refreshHomeTabContent((0,w.n53)(i.activeCell));break;case e.getConstant("Insert"):break;case e.getConstant("Formulas"):break;case e.getConstant("Data"):this.refreshDataTabContent(t);break;case e.getConstant("View"):this.refreshViewTabContent(t);break}}},o.prototype.refreshHomeTabContent=function(t){(0,a.le)(document.getElementById(this.parent.element.id+"_number_format"))||(this.numFormatDDB=(0,a.Xr)(document.getElementById(this.parent.element.id+"_number_format"),Bi));var e=this.parent.getActiveSheet(),i=(0,w.n53)(this.parent.getActiveSheet().activeCell),r=this.parent.serviceLocator.getService(Ve),n=(0,w.$Su)(i[0],i[1],this.parent.getActiveSheet())||{},s=(0,w.K2R)(n.format?n.format:"General");if(this.numFormatDDB&&(e.isProtected&&!e.protectSettings.formatCells?(s="General",this.refreshNumFormatSelection(s)):(n.format&&s==="General"&&(s="Custom"),this.refreshNumFormatSelection(r.getConstant(s)))),this.fontNameDdb&&(e.isProtected&&!e.protectSettings.formatCells?this.refreshFontNameSelection("Calibri"):this.refreshFontNameSelection(this.getCellStyleValue("fontFamily",t))),this.fontSizeDdb){var l=this.getCellStyleValue("fontSize",t);e.isProtected&&!e.protectSettings.formatCells?this.fontSizeDdb.content="11":(l=l.includes("pt")?l.split("pt")[0]:"11",l!==this.fontSizeDdb.content&&(this.fontSizeDdb.content=l,this.fontSizeDdb.dataBind()))}if(this.refreshTextAlign(e,n,s,t),this.verticalAlignDdb){var l="e-icons e-"+this.getCellStyleValue("verticalAlign",t).toLowerCase()+"-icon";e.isProtected&&!e.protectSettings.formatCells?this.verticalAlignDdb.iconCss="e-icons e-bottom-icon":l!==this.verticalAlignDdb.iconCss&&(this.verticalAlignDdb.iconCss=l,this.verticalAlignDdb.dataBind())}if(this.refreshToggleBtn(t),!e.isProtected&&(n.rowSpan>1||n.colSpan>1))this.enableToolbarItems([{tab:r.getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:!0}]),this.toggleActiveState(!0);else{var h=(0,pe.dK5)(e.selectedRange);this.enableToolbarItems([{tab:r.getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:h[0]!==h[2]||h[1]!==h[3]}]),this.toggleActiveState(!1)}},o.prototype.refreshTextAlign=function(t,e,i,r){if(this.textAlignDdb){var n=this.getCellStyleValue("textAlign",r);if(t.isProtected&&!t.protectSettings.formatCells)this.textAlignDdb.iconCss="e-icons e-left-icon";else{e.value!==void 0&&n==="left"&&(i==="Accounting"||(0,pe.hj$)(e.value)&&i!=="Text")&&(n="right");var s="e-icons e-"+n.toLowerCase()+"-icon";s!==this.textAlignDdb.iconCss&&(this.textAlignDdb.iconCss=s,this.textAlignDdb.dataBind())}}},o.prototype.toggleActiveState=function(t){var e=this.parent.serviceLocator.getService(Ve);this.parent.getActiveSheet().isProtected||(t?(this.mergeSplitBtn.element.classList.add("e-active"),this.mergeSplitBtn.element.title=e.getConstant("UnmergeCells")):(this.mergeSplitBtn.element.classList.contains("e-active")&&this.mergeSplitBtn.element.classList.remove("e-active"),this.mergeSplitBtn.element.title=e.getConstant("MergeCells")))},o.prototype.refreshToggleBtn=function(t){var e=this,i=this.parent.getActiveSheet(),r,n=this.parent.element.id,s,l,h=(0,w.$Su)(t[0],t[1],i),c=["fontWeight","fontStyle","textDecoration","textDecoration"];["bold","italic","line-through","underline","wrap"].forEach(function(u,p){r=document.getElementById(n+"_"+u),r&&(i.isProtected&&!i.protectSettings.formatCells?r.classList.remove("e-active"):u==="wrap"?l=h&&h.wrap:(s=e.getCellStyleValue(c[p],t).toLowerCase(),l=s.indexOf(u)>-1),l?r.classList.add("e-active"):r.classList.contains("e-active")&&r.classList.remove("e-active"))})},o.prototype.refreshFontNameSelection=function(t){t=t.split('"').join(""),this.fontNameDdb.element.firstElementChild.textContent=t;for(var e=0;e<this.fontNameDdb.items.length;e++)if(this.fontNameDdb.items[e].text===t){this.fontNameDdb.items[e].iconCss="e-icons e-selected-icon",e!==this.fontNameIndex&&(this.fontNameDdb.items[this.fontNameIndex].iconCss=""),this.fontNameDdb.setProperties({items:this.fontNameDdb.items},!0),this.fontNameIndex=e;break}["Arial","Arial Black","Axettac Demo","Batang","Book Antiqua","Calibri","Courier","Courier New","Din Condensed","Georgia","Helvetica","Helvetica New","Roboto","Tahoma","Times New Roman","Verdana"].indexOf(t)<0&&(this.fontNameDdb.items[this.fontNameIndex].iconCss="")},o.prototype.refreshNumFormatSelection=function(t){for(var e=0;e<this.numFormatDDB.items.length;e++)this.numFormatDDB.items[e].iconCss!==""&&(this.numFormatDDB.items[e].iconCss=""),this.numFormatDDB.items[e].text===t&&(this.numFormatDDB.items[e].iconCss="e-icons e-selected-icon");this.numFormatDDB.element.firstElementChild.textContent=t,this.numFormatDDB.setProperties({items:this.numFormatDDB.items},!0)},o.prototype.refreshChartThemeSelection=function(t){if(t!==this.chartThemeDDB.items[this.chartThemeIndex].text){this.chartThemeDDB.element.firstElementChild.textContent=this.getChartThemeText(t);for(var e=0;e<this.chartThemeDDB.items.length;e++)if(this.chartThemeDDB.items[e].id===t){this.chartThemeDDB.items[e].iconCss="e-icons e-selected-icon",this.chartThemeDDB.items[this.chartThemeIndex].iconCss="",this.chartThemeDDB.setProperties({items:this.chartThemeDDB.items},!0),this.chartThemeIndex=e;break}}},o.prototype.getChartThemeText=function(t){var e=this.parent.serviceLocator.getService(Ve),i="";switch(t){case"Material":i=e.getConstant("Material");break;case"Fabric":i=e.getConstant("Fabric");break;case"Bootstrap":i=e.getConstant("Bootstrap");break;case"HighContrastLight":i=e.getConstant("HighContrastLight");break;case"MaterialDark":i=e.getConstant("MaterialDark");break;case"FabricDark":i=e.getConstant("FabricDark");break;case"HighContrast":i=e.getConstant("HighContrast");break;case"BootstrapDark":i=e.getConstant("BootstrapDark");break;case"Bootstrap4":i=e.getConstant("Bootstrap4");break;case"Bootstrap5Dark":i=e.getConstant("Bootstrap5Dark");break;case"Bootstrap5":i=e.getConstant("Bootstrap5");break;case"TailwindDark":i=e.getConstant("TailwindDark");break;case"Tailwind":i=e.getConstant("Tailwind");break;case"Fluent":i=e.getConstant("Fluent");break;case"FluentDark":i=e.getConstant("FluentDark");break}return i},o.prototype.fileMenuItemSelect=function(t){var e=this,i=(0,a.l7)({cancel:!1},t);this.parent.trigger("fileMenuItemSelect",i);var r=this.parent.element.id,n;if(!i.cancel)switch(t.item.id){case r+"_Open":(0,a.Ys)("#"+r+"_fileUpload",this.parent.element).click();break;case r+"_Xlsx":case r+"_Xls":case r+"_Csv":case r+"_Pdf":this.parent.notify(pe.Tsy,t);break;case r+"_New":n=this.parent.serviceLocator.getService(Yt),n.show({height:200,width:400,isModal:!0,showCloseIcon:!0,content:this.parent.serviceLocator.getService(Ve).getConstant("DestroyAlert"),beforeOpen:function(s){var l={dialogName:"DestroySheetDialog",element:s.element,target:s.target,cancel:s.cancel};e.parent.trigger("dialogBeforeOpen",l),l.cancel&&(s.cancel=!0),we(e.parent.element)},buttons:[{buttonModel:{content:this.parent.serviceLocator.getService(Ve).getConstant("Ok"),isPrimary:!0},click:function(){n.hide(),e.parent.refresh(!0)}}]});break}},o.prototype.toolbarClicked=function(t){if(t.item.id!=="spreadsheet_find"){var e=this.parent.element.id,i=this.parent.getActiveSheet(),r=void 0,n=void 0,s=void 0,l=void 0,h=void 0;switch(t.item.id){case e+"_headers":if(r={isShow:!i.showHeaders,sheetIdx:this.parent.activeSheetIndex,cancel:!1},this.parent.notify(E.Av,{eventArgs:r,action:"headers"}),r.cancel)return;this.parent.setSheetPropertyOnMute(i,"showHeaders",!i.showHeaders),this.parent.serviceLocator.getService("sheet").showHideHeaders(),this.toggleRibbonItems({props:"Headers",activeTab:this.ribbon.selectedTab}),we(this.parent.element);break;case e+"_gridlines":if(n={isShow:!i.showGridLines,sheetIdx:this.parent.activeSheetIndex,cancel:!1},this.parent.notify(E.Av,{eventArgs:n,action:"gridLines"}),n.cancel)return;this.parent.setSheetPropertyOnMute(i,"showGridLines",!i.showGridLines),this.toggleRibbonItems({props:"GridLines",activeTab:this.ribbon.selectedTab}),we(this.parent.element);break;case e+"_protect":this.parent.openModule.isImportedFile&&this.parent.openModule.unProtectSheetIdx.indexOf(this.parent.activeSheetIndex)===-1?this.parent.notify(E.z1,{isImportedSheet:!0}):i.password&&i.password.length>0?this.parent.notify(E.z1,null):(this.parent.setSheetPropertyOnMute(i,"isProtected",!i.isProtected),s=!i.isProtected,this.parent.notify(E.Oj,{isActive:s,id:e+"_protect",sheetIndex:this.parent.activeSheetIndex,triggerEvent:!0}));break;case e+"_undo":this.parent.notify(E.Y5,{isUndo:!0});break;case e+"_redo":this.parent.notify(E.Y5,{isUndo:!1});break;case e+"_freezepanes":l=(0,w.n53)(i.topLeftCell),h=i.frozenRows||i.frozenColumns?l:(0,w.n53)(i.activeCell),this.parent.notify(E.vV,{row:h[0]-l[0],column:h[1]-l[1],triggerEvent:!0});break;case e+"_freezerows":this.parent.notify(E.vV,{row:i.frozenRows?0:(0,w.n53)(i.activeCell)[0]-(0,w.n53)(i.topLeftCell)[0],column:i.frozenColumns,triggerEvent:!0});break;case e+"_freezecolumns":this.parent.notify(E.vV,{row:i.frozenRows,column:i.frozenColumns?0:(0,w.n53)(i.activeCell)[1]-(0,w.n53)(i.topLeftCell)[1],triggerEvent:!0});break;case e+"_protectworkbook":this.parent.password.length>0?this.parent.notify(E.xY,null):this.parent.isProtected?(this.parent.isProtected=!1,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").removeAttribute("disabled"),this.parent.element.querySelector(".e-add-sheet-tab").classList.remove("e-disabled")),this.toggleRibbonItems({props:"Protectworkbook",activeTab:this.ribbon.selectedTab})):this.parent.element.querySelector(".e-add-sheet-tab").classList.contains("e-disabled")?this.toggleRibbonItems({props:"Protectworkbook",activeTab:this.ribbon.selectedTab}):this.parent.notify(E.du,null);break}this.parent.notify(E.hU,t)}},o.prototype.toggleRibbonItems=function(t){var e="",i=this.parent.serviceLocator.getService(Ve).getConstant("View"),r=this.parent.serviceLocator.getService(Ve).getConstant("Data");if(this.ribbon.items[this.ribbon.selectedTab].header.text===i){if((0,a.le)(t.activeTab)){for(var n=0,s=this.ribbon.items.length;n<s;n++)if(this.ribbon.items[n].header.text===i){t.activeTab=n;break}}var l=this.getLocaleText(t.props);t.props==="GridLines"&&this.parent.serviceLocator.getService("sheet").toggleGridlines();for(var h=this.parent.element.id+"_"+t.props.toLowerCase(),c=this.ribbon.items[t.activeTab].content.length,n=void 0;n<c;n++)this.ribbon.items[t.activeTab].content[n].type!=="Separator"&&this.ribbon.items[t.activeTab].content[n].id===h&&(this.ribbon.items[t.activeTab].content[n].text=l,this.ribbon.setProperties({items:this.ribbon.items},!0));this.ribbon.items[this.ribbon.selectedTab].header.text===i&&this.updateToggleText(t.props.toLowerCase(),l)}if(this.ribbon.items[this.ribbon.selectedTab].header.text===r){if((0,a.le)(t.activeTab)){for(var n=0,u=this.ribbon.items.length;n<u;n++)if(this.ribbon.items[n].header.text===r){t.activeTab=n;break}}var h=this.parent.element.id+"_"+t.props.toLowerCase();if(h===this.parent.element.id+"_protect"){var p=this.ribbon.items[this.ribbon.selectedTab].content.length,f=void 0;for(f=0;f<p&&this.ribbon.items[this.ribbon.selectedTab].content[f].id!==this.parent.element.id+"_protect";f++);e=this.getLocaleProtectText("Sheet",!0)}else if(h===this.parent.element.id+"_protectworkbook"){var g=this.ribbon.items[this.ribbon.selectedTab].content.length,f=void 0;for(f=0;f<g&&this.ribbon.items[this.ribbon.selectedTab].content[f].id!==this.parent.element.id+"_protectworkbook";f++);this.parent.isProtected||this.parent.password.length>0?e=this.getLocaleProtectWorkbook("UnProtectWorkbook"):this.parent.isProtected||(e=this.getLocaleProtectWorkbook("ProtectWorkbook"))}for(var c=this.ribbon.items[t.activeTab].content.length,n=void 0;n<c;n++)this.ribbon.items[t.activeTab].content[n].type!=="Separator"&&this.ribbon.items[t.activeTab].content[n].id===h&&(this.ribbon.items[t.activeTab].content[n].text=e,this.ribbon.setProperties({items:this.ribbon.items},!0));this.ribbon.items[this.ribbon.selectedTab].header.text===r&&this.updateToggleText(t.props.toLowerCase(),e)}},o.prototype.enableFileMenuItems=function(t){this.ribbon.enableMenuItems(t.items,t.enable,t.isUniqueId)},o.prototype.hideRibbonTabs=function(t){this.ribbon.hideTabs(t.tabs,t.hide)},o.prototype.addRibbonTabs=function(t){this.ribbon.addTabs(t.items,t.insertBefore);var e=(0,a.Ys)(".e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab).e-hide",this.parent.element);e&&this.parent.updateActiveBorder((0,a.td)(".e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab)",this.parent.element)[this.ribbon.selectedTab])},o.prototype.updateToggleText=function(t,e){var i=this;$(function(){var r=(0,a.Ys)("#"+i.parent.element.id+"_"+t+" .e-tbar-btn-text",i.ribbon.element);r&&(r.textContent=e)}),t==="headers"&&this.findDialog&&(this.findDialog.position.Y=this.parent.getActiveSheet().showHeaders?31:0,this.findDialog.dataBind())},o.prototype.refreshViewTabContent=function(t){for(var e=this.parent.element.id,i=this.parent.getActiveSheet(),r=this.parent.serviceLocator.getService(Ve),n=0;n<this.ribbon.items[t].content.length;n++)this.ribbon.items[t].content[n].type!=="Separator"&&(this.ribbon.items[t].content[n].id===e+"_headers"&&this.updateViewTabContent(t,"Headers",n),this.ribbon.items[t].content[n].id===e+"_gridlines"&&this.updateViewTabContent(t,"GridLines",n),this.ribbon.items[t].content[n].id===e+"_freezepanes"&&(i.frozenRows||i.frozenColumns?this.ribbon.items[t].content[n].text===r.getConstant("FreezePanes")&&this.updateToggleText("freezepanes",this.updateRibbonItemText("Unfreeze","Panes",n,t)):this.ribbon.items[t].content[n].text===r.getConstant("UnfreezePanes")&&this.updateToggleText("freezepanes",this.updateRibbonItemText("Freeze","Panes",n,t))),this.ribbon.items[t].content[n].id===e+"_freezerows"&&(i.frozenRows?this.ribbon.items[t].content[n].text===r.getConstant("FreezeRows")&&this.updateToggleText("freezerows",this.updateRibbonItemText("Unfreeze","Rows",n,t)):this.ribbon.items[t].content[n].text===r.getConstant("UnfreezeRows")&&this.updateToggleText("freezerows",this.updateRibbonItemText("Freeze","Rows",n,t))),this.ribbon.items[t].content[n].id===e+"_freezecolumns"&&(i.frozenColumns?this.ribbon.items[t].content[n].text===r.getConstant("FreezeColumns")&&this.updateToggleText("freezecolumns",this.updateRibbonItemText("Unfreeze","Columns",n,t)):this.ribbon.items[t].content[n].text===r.getConstant("UnfreezeColumns")&&this.updateToggleText("freezecolumns",this.updateRibbonItemText("Freeze","Columns",n,t))))},o.prototype.updateViewTabContent=function(t,e,i){var r=this.parent.getActiveSheet(),n=this.parent.serviceLocator.getService(Ve);r["show"+e]?this.ribbon.items[t].content[i].text===n.getConstant("Show"+e)&&this.updateToggleText(e.toLowerCase(),this.updateRibbonItemText("Hide",e,i,t)):this.ribbon.items[t].content[i].text===n.getConstant("Hide"+e)&&this.updateToggleText(e.toLowerCase(),this.updateRibbonItemText("Show",e,i,t))},o.prototype.updateRibbonItemText=function(t,e,i,r){var n=this.parent.serviceLocator.getService(Ve),s=n.getConstant(t+e);return this.ribbon.items[r].content[i].text=s,this.ribbon.setProperties({items:this.ribbon.items},!0),s},o.prototype.refreshDataTabContent=function(t){for(var e=this.parent.element.id,i,r=0;r<this.ribbon.items[t].content.length;r++)if(this.ribbon.items[t].content[r].type!=="Separator"){if(this.ribbon.items[t].content[r].id===e+"_protect"){if(this.updateDataTabContent(t,"Sheet",r),i)break;i=!0}this.ribbon.items[t].content[r].id===e+"_protectworkbook"&&this.updateDataTabContent(t,"Workbook",r)}},o.prototype.updateDataTabContent=function(t,e,i){var r=this.parent.getActiveSheet(),n=this.parent.serviceLocator.getService(Ve);if(e==="Sheet")r.isProtected?this.ribbon.items[t].content[i].text===n.getConstant("Protect"+e)&&(this.ribbon.items[t].content[i].cssClass="e-active",this.updateProtectBtn("Unprotect",e,i,t)):this.updateProtectBtn("Protect",e,i,t);else if(e==="Workbook"){var s=this.parent.serviceLocator.getService(Ve);this.parent.isProtected?this.ribbon.items[t].content[i].text===s.getConstant("Protect"+e)&&this.updateToggleText("protectworkbook",this.updateRibbonItemText("UnProtect",e,i,t)):this.ribbon.items[t].content[i].text===s.getConstant("UnProtect"+e)&&this.updateToggleText("protectworkbook",this.updateRibbonItemText("Protect",e,i,t))}},o.prototype.updateProtectBtn=function(t,e,i,r){var n=this.parent.serviceLocator.getService(Ve),s=n.getConstant(t+e);this.ribbon.items[r].content[i].text=s,this.ribbon.setProperties({items:this.ribbon.items},!0),this.updateToggleText("protect",s)},o.prototype.updateProtectWorkbookBtn=function(t,e,i,r){var n=this.parent.serviceLocator.getService(Ve),s=n.getConstant(t);this.ribbon.items[r].content[i].text=s,this.ribbon.setProperties({items:this.ribbon.items},!0),this.updateToggleText("protectworkbook",s)},o.prototype.addToolbarItems=function(t){this.ribbon.addToolbarItems(t.tab,t.items,t.index)},o.prototype.enableToolbarItems=function(t){var e=this;t.forEach(function(i){e.ribbon.enableItems(i.tab||e.ribbon.items[e.ribbon.selectedTab].header.text,i.items,i.enable)})},o.prototype.createMobileView=function(){var t=this,e=this.parent.element.id,i=this.parent.createElement("div",{className:"e-header-toolbar"}),r=this.parent.createElement("ul");i.appendChild(r);var n=new Ho({items:[{prefixIcon:"e-tick-icon",align:"Left",id:e+"focused_tick",cssClass:"e-focused-tick"},{template:r,align:"Right",id:e+"file_menu"}],clicked:function(s){switch(s.item.id){case e+"focused_tick":t.parent.element.classList.remove("e-mobile-focused"),t.parent.renderModule.setSheetPanelSize();break}},created:function(){var s=new qa({cssClass:"e-mobile e-file-menu",enableRtl:!0,showItemOnClick:!0,items:t.getRibbonMenuItems(),select:t.fileMenuItemSelect.bind(t),beforeOpen:function(l){l.element.parentElement.classList.remove("e-rtl"),t.fileMenuBeforeOpen(l)},beforeClose:t.fileMenuBeforeClose.bind(t)});s.createElement=t.parent.createElement,s.appendTo(r)}});n.createElement=this.parent.createElement,n.appendTo(i),this.parent.element.insertBefore(i,this.parent.element.firstElementChild),this.renderMobileToolbar()},o.prototype.renderMobileToolbar=function(){var t=this,e=this.parent.createElement("div",{className:"e-toolbar-panel e-ribbon"}),i=this.parent.createElement("div"),r=this.parent.createElement("button");e.appendChild(i),e.appendChild(r),e.style.display="block",this.parent.element.appendChild(e);var n=new Bi({cssClass:"e-caret-hide",content:this.ribbon.items[0].header.text,items:[{text:this.ribbon.items[0].header.text},{text:this.ribbon.items[1].header.text},{text:this.ribbon.items[2].header.text},{text:this.ribbon.items[3].header.text}],createPopupOnClick:!0,select:function(l){l.item.text!==n.content&&(s.element.style.display="none",n.content=l.item.text,n.dataBind(),s.items=t.ribbon.items[n.items.indexOf(l.item)+1].content,s.width="calc(100% - "+r.getBoundingClientRect().width+"px)",s.element.style.display="",s.dataBind(),s.items[0].text=l.item.text,s.dataBind())},open:function(l){var h=l.element.parentElement,c=h.getBoundingClientRect(),u=Di(n.element,"right","bottom");h.style.left=u.left-c.width+"px",h.style.top=u.top-c.height+"px";for(var p=0;p<n.items.length;p++)if(n.content===n.items[p].text){l.element.children[p].classList.add("e-selected");break}},close:function(){return we(t.parent.element)}});n.createElement=this.parent.createElement,n.appendTo(r);var s=new Ho({width:"calc(100% - "+r.getBoundingClientRect().width+"px)",items:this.ribbon.items[0].content,clicked:this.toolbarClicked.bind(this)});s.createElement=this.parent.createElement,s.appendTo(i),e.style.display=""},o.prototype.fileMenuBeforeOpen=function(t){var e=this,i=this.parent.serviceLocator.getService(Ve),r,n=[".xlsx",".xls",".csv",".pdf"];t.parentItem.text===i.getConstant("SaveAs")&&[].slice.call(t.element.children).forEach(function(s,l){r=e.parent.createElement("div",{innerHTML:s.innerHTML}),s.innerHTML="",r.appendChild(e.parent.createElement("span",{className:"e-extension",innerHTML:n[l]})),s.appendChild(r)}),this.parent.trigger("fileMenuBeforeOpen",t)},o.prototype.enableRibbonTabs=function(t){this.ribbon.enableTabs(t.tabs,t.enable)},o.prototype.fileMenuBeforeClose=function(t){this.parent.trigger("fileMenuBeforeClose",t)},o.prototype.hideFileMenuItems=function(t){this.ribbon.hideMenuItems(t.items,t.hide,t.isUniqueId)},o.prototype.addFileMenuItems=function(t){this.ribbon.addMenuItems(t.items,t.text,t.insertAfter,t.isUniqueId)},o.prototype.hideToolbarItems=function(t){this.ribbon.hideToolbarItems(t.tab,t.indexes,t.hide)},o.prototype.protectSheetHandler=function(t){var e=this.parent.getActiveSheet(),i=this.parent.serviceLocator.getService(Ve);e.isProtected&&e.protectSettings.formatCells||!e.isProtected?(this.parent.allowCellFormatting?this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.enableHomeBtnId,enable:!0}]):this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.enableHomeBtnId.slice(2,14),enable:!1}]),this.parent.allowWrap||this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.enableHomeBtnId.slice(14,15),enable:!1}]),this.parent.allowNumberFormatting||this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.enableHomeBtnId.slice(2,3),enable:!1}]),this.parent.notify(E.Ev,null)):this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.disableHomeBtnId,enable:!1}]),e.isProtected&&e.protectSettings.insertLink||!e.isProtected?!this.parent.allowHyperlink||e.isProtected&&e.protectSettings.insertLink?this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.enableInsertBtnId.slice(0,1),enable:!1}]):this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.enableInsertBtnId,enable:!0}]):this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.enableInsertBtnId,enable:!1}]),e.isProtected&&e.protectSettings.selectCells||e.protectSettings.selectUnLockedCells||!e.isProtected?this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.findBtnId,enable:!0}]):this.enableToolbarItems([{tab:i.getConstant("Home"),items:t.findBtnId,enable:!1}]);var r=this.ribbon.items[this.ribbon.selectedTab].content.length,n;for(n=0;n<r&&this.ribbon.items[this.ribbon.selectedTab].content[n].id!==this.parent.element.id+"_protectworkbook";n++);e.isProtected?(this.parent.isProtected&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook")&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook").querySelector(".e-tbar-btn-text").textContent===i.getConstant("UnProtectWorkbook")?this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("UnProtectWorkbook")):this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("ProtectWorkbook")),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.imageBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Data"),items:t.dataValidationBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Formulas"),items:t.enableFrmlaBtnId,enable:!1}]),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.chartBtnId,enable:!1}])):(this.parent.isProtected&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook")&&this.parent.element.querySelector("#"+this.parent.element.id+"_protectworkbook").querySelector(".e-tbar-btn-text").textContent===i.getConstant("UnProtectWorkbook")?this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("UnProtectWorkbook")):this.ribbon.items[this.ribbon.selectedTab].header.text===i.getConstant("Data")&&(this.ribbon.items[this.ribbon.selectedTab].content[n].text=i.getConstant("ProtectWorkbook")),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.imageBtnId,enable:this.parent.allowImage}]),this.enableToolbarItems([{tab:i.getConstant("Data"),items:t.dataValidationBtnId,enable:this.parent.allowDataValidation}]),this.enableToolbarItems([{tab:i.getConstant("Formulas"),items:t.enableFrmlaBtnId,enable:!0}]),this.enableToolbarItems([{tab:i.getConstant("Insert"),items:t.chartBtnId,enable:this.parent.allowChart}]))},o.prototype.updateMergeItem=function(t){if(t.type==="mousemove"||t.type==="pointermove"||t.shiftKey&&t.type==="mousedown"){var e=(0,pe.dK5)(this.parent.getActiveSheet().selectedRange);(e[1]!==e[3]||e[0]!==e[2])&&!this.parent.getActiveSheet().isProtected&&this.parent.allowMerge&&(this.enableToolbarItems([{tab:this.parent.serviceLocator.getService(Ve).getConstant("Home"),items:[this.parent.element.id+"_merge_cells"],enable:!0}]),this.toggleActiveState(!1))}},o.prototype.onPropertyChanged=function(t){var e=this.parent.serviceLocator.getService(Ve),i=this.parent.element.id;switch(t){case"allowFreezePane":this.ribbon.enableItems(e.getConstant("View"),[i+"_freezepanes",i+"_freezerows",i+"_freezecolumns"],this.parent.allowFreezePane);break;case"showRibbon":this.parent.showRibbon?this.initialize(!0):this.ribbon&&this.destroy();break}},o.prototype.addEventListener=function(){this.parent.on(E.cA,this.ribbonOperation,this),this.parent.on(E.y3,this.enableToolbarItems,this),this.parent.on(pe.q6q,this.refreshRibbonContent,this),this.parent.on(E.IE,this.toggleRibbonItems,this),this.parent.on(E.$V,this.enableFileMenuItems,this),this.parent.on(E.b6,this.hideRibbonTabs,this),this.parent.on(E.Zf,this.addRibbonTabs,this),this.parent.on(E.Pk,this.addToolbarItems,this),this.parent.on(E.BT,this.hideFileMenuItems,this),this.parent.on(E.sO,this.addFileMenuItems,this),this.parent.on(E.vD,this.hideToolbarItems,this),this.parent.on(E.TP,this.enableRibbonTabs,this),this.parent.on(E.qo,this.protectSheetHandler,this),this.parent.on(w.Pmi,this.updateMergeItem,this),this.parent.on(pe.bUq,this.refreshRibbonContent,this),this.parent.on(E.A$,this.insertDesignChart,this),this.parent.on(E.k3,this.removeDesignChart,this),this.parent.on(pe.JK0,this.findToolDlg,this)},o.prototype.destroy=function(){var t=this.parent.element,e=this.ribbon.element,i=this.cPickerEle,r=t.id;["bold","italic","line-through","underline"].forEach(function(n){he((0,a.Ys)("#"+(r+"_"+n),t),$r)}),this.pasteSplitBtn.destroy(),this.pasteSplitBtn=null,this.mergeSplitBtn.destroy(),this.mergeSplitBtn=null,this.numFormatDDB.destroy(),this.numFormatDDB=null,this.fontSizeDdb.destroy(),this.fontSizeDdb=null,this.fontNameDdb.destroy(),this.fontNameDdb=null,this.textAlignDdb.destroy(),this.textAlignDdb=null,this.verticalAlignDdb.destroy(),this.verticalAlignDdb=null,this.sortingDdb.destroy(),this.sortingDdb=null,this.clearDdb.destroy(),this.clearDdb=null,this.colorPicker.destroy(),this.colorPicker=null,this.destroyComponent(r+"_borders_menu","menu"),this.bordersDdb.destroy(),this.bordersDdb=null,this.findDdb.destroy(),this.findDdb=null,this.destroyComponent(r+"_chart_menu","menu"),this.destroyComponent(r+"_chart_type_menu","menu"),this.destroyComponent(r+"_chart-btn","dropdown-btn"),this.destroyComponent(r+"_chart-type-btn","dropdown-btn"),this.destroyComponent(r+"_cf_menu","menu"),this.cFDdb.destroy(),this.cFDdb=null,this.detachPopupElement(r),this.parent.notify("destroyRibbonComponents",null),this.ribbon.destroy(),e&&(0,a.og)(e),this.ribbon=null,i&&(0,a.og)(i),this.cPickerEle=null,this.findDialog&&this.findDialog.hide(),this.removeEventListener()},o.prototype.destroyComponent=function(t,e){var i=typeof t=="string"?document.getElementById(t):t;if(i){if(e!=="menu"||i.childElementCount){var r=(0,a.Xr)(i,e);if(r&&(r.destroy(),e==="dropdown-btn")){var n=document.getElementById(i.id+"-popup");n&&(0,a.og)(n)}}e==="menu"&&(0,a.og)(i)}},o.prototype.detachPopupElement=function(t){["_conditionalformatting","_chart-type-btn","_chart-btn","_borders"].forEach(function(e){var i=document.getElementById(""+t+e+"-popup");i&&(0,a.og)(i)})},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.cA,this.ribbonOperation),this.parent.off(E.y3,this.enableToolbarItems),this.parent.off(pe.q6q,this.refreshRibbonContent),this.parent.off(E.IE,this.toggleRibbonItems),this.parent.off(E.$V,this.enableFileMenuItems),this.parent.off(E.b6,this.hideRibbonTabs),this.parent.off(E.Zf,this.addRibbonTabs),this.parent.off(E.Pk,this.addToolbarItems),this.parent.off(E.BT,this.hideFileMenuItems),this.parent.off(E.sO,this.addFileMenuItems),this.parent.off(E.vD,this.hideToolbarItems),this.parent.off(E.TP,this.enableRibbonTabs),this.parent.off(E.qo,this.protectSheetHandler),this.parent.off(w.Pmi,this.updateMergeItem),this.parent.off(pe.bUq,this.refreshRibbonContent),this.parent.off(E.A$,this.insertDesignChart),this.parent.off(E.k3,this.removeDesignChart),this.parent.on(pe.JK0,this.findToolDlg,this))},o}(),BC=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Oi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Qv="e-atc-spinner-icon";mt.root="e-combobox";var FC={container:null,buttons:[]},Jv=function(o){BC(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){o.prototype.preRender.call(this)},t.prototype.getLocaleName=function(){return"combo-box"},t.prototype.wireEvent=function(){this.getModuleName()==="combobox"&&(a.bi.add(this.inputWrapper.buttons[0],"mousedown",this.preventBlur,this),a.bi.add(this.inputWrapper.container,"blur",this.onBlurHandler,this)),(0,a.le)(this.inputWrapper.buttons[0])||a.bi.add(this.inputWrapper.buttons[0],"mousedown",this.dropDownClick,this),a.bi.add(this.inputElement,"focus",this.targetFocus,this),this.readonly||(a.bi.add(this.inputElement,"input",this.onInput,this),a.bi.add(this.inputElement,"keyup",this.onFilterUp,this),a.bi.add(this.inputElement,"keydown",this.onFilterDown,this),a.bi.add(this.inputElement,"paste",this.pasteHandler,this)),this.bindCommonEvent()},t.prototype.preventBlur=function(e){(!this.allowFiltering&&document.activeElement!==this.inputElement&&!document.activeElement.classList.contains(mt.input)&&a.AR.isDevice||!a.AR.isDevice)&&e.preventDefault()},t.prototype.onBlurHandler=function(e){var i=this.inputElement&&this.inputElement.value===""?null:this.inputElement&&this.inputElement.value;!(0,a.le)(this.listData)&&!(0,a.le)(i)&&i!==this.text&&this.customValue(e),o.prototype.onBlurHandler.call(this,e)},t.prototype.targetElement=function(){return this.inputElement},t.prototype.setOldText=function(e){Ue.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.customValue(),this.removeSelection()},t.prototype.setOldValue=function(e){this.allowCustom?this.valueMuteChange(this.value):this.valueMuteChange(null),this.removeSelection(),this.setHiddenValue()},t.prototype.valueMuteChange=function(e){var i=(0,a.le)(e)?null:e.toString();Ue.setValue(i,this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({value:e,text:e,index:null},!0),this.activeIndex=this.index;var r=this.fields,n={};n[r.text]=(0,a.le)(e)?null:e.toString(),n[r.value]=(0,a.le)(e)?null:e.toString(),this.itemData=n,this.item=null,this.previousValue!==this.value&&this.detachChangeEvent(null)},t.prototype.updateValues=function(){if((0,a.le)(this.value))if(this.text&&(0,a.le)(this.value)){var e=this.getElementByText(this.text);e?this.setSelection(e,null):(Ue.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton),this.customValue())}else this.setSelection(this.liCollections[this.activeIndex],null);else{var e=this.getElementByValue(this.value);e?this.setSelection(e,null):this.allowCustom?this.valueMuteChange(this.value):this.valueMuteChange(null)}this.setHiddenValue(),Ue.setValue(this.text,this.inputElement,this.floatLabelType,this.showClearButton)},t.prototype.updateIconState=function(){this.showClearButton&&(this.inputElement&&this.inputElement.value!==""&&!this.readonly?(0,a.IV)([this.inputWrapper.clearButton],mt.clearIconHide):(0,a.cn)([this.inputWrapper.clearButton],mt.clearIconHide))},t.prototype.getAriaAttributes=function(){var e={"aria-owns":this.element.id+"_options",role:"combobox","aria-autocomplete":"both","aria-labelledby":this.hiddenElement.id,"aria-hasPopup":"true","aria-expanded":"false","aria-readonly":this.readonly.toString(),autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"};return e},t.prototype.searchLists=function(e){this.isTyped=!0,this.isFiltering()?(o.prototype.searchLists.call(this,e),this.ulElement&&this.filterInput.value.trim()===""&&this.setHoverList(this.ulElement.querySelector("."+mt.li))):(this.ulElement&&this.inputElement.value===""&&this.preventAutoFill&&this.setHoverList(this.ulElement.querySelector("."+mt.li)),this.incrementalSearch(e))},t.prototype.getNgDirective=function(){return"EJS-COMBOBOX"},t.prototype.setSearchBox=function(){return this.filterInput=this.inputElement,this.isFiltering()?this.inputWrapper:FC},t.prototype.onActionComplete=function(e,i,r,n){var s=this;o.prototype.onActionComplete.call(this,e,i,r),this.isSelectCustom&&this.removeSelection(),!this.preventAutoFill&&this.getModuleName()==="combobox"&&this.isTyped&&setTimeout(function(){s.inlineSearch()})},t.prototype.getFocusElement=function(){var e=this.isSelectCustom?{text:""}:this.getItemData(),i=this.list.querySelector("."+mt.selected),r=e.text===this.inputElement.value&&!(0,a.le)(i);if(r)return i;if((a.AR.isDevice&&!this.isDropDownClick||!a.AR.isDevice)&&!(0,a.le)(this.liCollections)&&this.liCollections.length>0){var n=this.inputElement.value,s=Ch(n,this.liCollections,this.filterType,!0),l=s.item;if((0,a.le)(l))this.isSelectCustom&&this.inputElement.value.trim()!==""&&(this.removeFocus(),this.list.scrollTop=0);else{var h=this.getIndexByValue(l.getAttribute("data-value"))-1,c=parseInt(getComputedStyle(this.liCollections[0],null).getPropertyValue("height"),10);if(!isNaN(c)&&this.getModuleName()!=="autocomplete"){this.removeFocus();var u=this.fields.groupBy?this.liCollections[0].offsetHeight:0;this.list.scrollTop=h*c+u,(0,a.cn)([l],mt.focus)}}return l}else return null},t.prototype.setValue=function(e){return e&&e.type==="keydown"&&e.action==="enter"&&this.removeFillSelection(),this.autofill&&this.getModuleName()==="combobox"&&e&&e.type==="keydown"&&e.action!=="enter"?(this.preventAutoFill=!1,this.inlineSearch(e),!1):o.prototype.setValue.call(this,e)},t.prototype.checkCustomValue=function(){this.itemData=this.getDataByValue(this.value);var e=this.getItemData();this.allowCustom&&(0,a.le)(e.value)&&(0,a.le)(e.text)||this.setProperties({value:e.value,text:e.text},!this.allowCustom)},t.prototype.showSpinner=function(){(0,a.le)(this.spinnerElement)&&(this.spinnerElement=this.getModuleName()==="autocomplete"?this.inputWrapper.buttons[0]||this.inputWrapper.clearButton||Ue.appendSpan("e-input-group-icon "+Qv,this.inputWrapper.container,this.createElement):this.inputWrapper.buttons[0]||this.inputWrapper.clearButton,(0,a.cn)([this.spinnerElement],mt.disableIcon),Ha({target:this.spinnerElement,width:a.AR.isDevice?"16px":"14px"},this.createElement),jn(this.spinnerElement))},t.prototype.hideSpinner=function(){(0,a.le)(this.spinnerElement)||(Cs(this.spinnerElement),(0,a.IV)([this.spinnerElement],mt.disableIcon),this.spinnerElement.classList.contains(Qv)?(0,a.og)(this.spinnerElement):this.spinnerElement.innerHTML="",this.spinnerElement=null)},t.prototype.setAutoFill=function(e,i){if(i||this.setHoverList(e),this.autofill&&!this.preventAutoFill){var r=this.getTextByValue(e.getAttribute("data-value")).toString(),n=this.getFormattedValue(e.getAttribute("data-value"));this.getModuleName()==="combobox"&&(!this.isSelected&&this.previousValue!==n?(this.updateSelectedItem(e,null),this.isSelected=!0,this.previousValue=this.getFormattedValue(e.getAttribute("data-value"))):this.updateSelectedItem(e,null,!0)),this.isAndroidAutoFill(r)||this.setAutoFillSelection(r,i)}},t.prototype.isAndroidAutoFill=function(e){if(a.AR.isAndroid){var i=this.getSelectionPoints(),r=this.prevSelectPoints.end,n=i.end,s=this.prevSelectPoints.start,l=i.start;return r!==0&&(r===e.length&&s===e.length||s>l&&r>n||r===n&&s===l)}else return!1},t.prototype.clearAll=function(e,i){((0,a.le)(i)||!(0,a.le)(i)&&(0,a.le)(i.dataSource))&&o.prototype.clearAll.call(this,e),this.isFiltering()&&!(0,a.le)(e)&&e.target===this.inputWrapper.clearButton&&this.searchLists(e)},t.prototype.isSelectFocusItem=function(e){return!(0,a.le)(e)},t.prototype.inlineSearch=function(e){var i=e&&(e.action==="down"||e.action==="up"||e.action==="home"||e.action==="end"||e.action==="pageUp"||e.action==="pageDown"),r=i?this.liCollections[this.activeIndex]:this.getFocusElement();if((0,a.le)(r))if(this.inputElement.value===""){this.activeIndex=null,this.list.scrollTop=0;var s=this.list.querySelector("."+mt.li);this.setHoverList(s)}else this.activeIndex=null,this.removeSelection(),this.liCollections&&this.liCollections.length>0&&!this.isCustomFilter&&this.removeFocus();else{if(!i){var n=this.getFormattedValue(r.getAttribute("data-value"));this.activeIndex=this.getIndexByValue(n),this.activeIndex=(0,a.le)(this.activeIndex)?null:this.activeIndex}this.preventAutoFill=this.inputElement.value===""?!1:this.preventAutoFill,this.setAutoFill(r,i)}},t.prototype.incrementalSearch=function(e){this.showPopup(),(0,a.le)(this.listData)||(this.inlineSearch(e),e.preventDefault())},t.prototype.setAutoFillSelection=function(e,i){i===void 0&&(i=!1);var r=this.getSelectionPoints(),n=this.inputElement.value.substr(0,r.start);if(n&&n.toLowerCase()===e.substr(0,r.start).toLowerCase()){var s=n+e.substr(n.length,e.length);Ue.setValue(s,this.inputElement,this.floatLabelType,this.showClearButton),this.inputElement.setSelectionRange(r.start,this.inputElement.value.length)}else i&&(Ue.setValue(e,this.inputElement,this.floatLabelType,this.showClearButton),this.inputElement.setSelectionRange(0,this.inputElement.value.length))},t.prototype.getValueByText=function(e){return o.prototype.getValueByText.call(this,e,!0,this.ignoreAccent)},t.prototype.unWireEvent=function(){this.getModuleName()==="combobox"&&(a.bi.remove(this.inputWrapper.buttons[0],"mousedown",this.preventBlur),a.bi.remove(this.inputWrapper.container,"blur",this.onBlurHandler)),(0,a.le)(this.inputWrapper.buttons[0])||a.bi.remove(this.inputWrapper.buttons[0],"mousedown",this.dropDownClick),this.inputElement&&(a.bi.remove(this.inputElement,"focus",this.targetFocus),this.readonly||(a.bi.remove(this.inputElement,"input",this.onInput),a.bi.remove(this.inputElement,"keyup",this.onFilterUp),a.bi.remove(this.inputElement,"keydown",this.onFilterDown),a.bi.remove(this.inputElement,"paste",this.pasteHandler))),this.unBindCommonEvent()},t.prototype.setSelection=function(e,i){o.prototype.setSelection.call(this,e,i),!(0,a.le)(e)&&!this.autofill&&!this.isDropDownClick&&this.removeFocus()},t.prototype.selectCurrentItem=function(e){var i;this.isPopupOpen&&(this.isSelected?i=this.list.querySelector("."+mt.selected):i=this.list.querySelector("."+mt.focus),i&&(this.setSelection(i,e),this.isTyped=!1),this.isSelected&&(this.isSelectCustom=!1,this.onChangeEvent(e))),e.action==="enter"&&this.inputElement.value.trim()===""?this.clearAll(e):this.isTyped&&!this.isSelected&&(0,a.le)(i)&&this.customValue(e),this.hidePopup(e)},t.prototype.setHoverList=function(e){this.removeSelection(),this.isValidLI(e)&&!e.classList.contains(mt.selected)&&(this.removeFocus(),e.classList.add(mt.focus))},t.prototype.targetFocus=function(e){a.AR.isDevice&&!this.allowFiltering&&(this.preventFocus=!1),this.onFocus(e)},t.prototype.dropDownClick=function(e){e.preventDefault(),a.AR.isDevice&&!this.isFiltering()&&(this.preventFocus=!0),o.prototype.dropDownClick.call(this,e)},t.prototype.customValue=function(e){var i=this,r=this.getValueByText(this.inputElement.value);if(!this.allowCustom&&this.inputElement.value!==""){var n=this.previousValue,s=this.value;this.setProperties({value:r}),(0,a.le)(this.value)&&Ue.setValue("",this.inputElement,this.floatLabelType,this.showClearButton),this.autofill&&n===this.value&&s!==this.value&&this.onChangeEvent(null)}else if(this.inputElement.value.trim()!==""){var l=this.value;if((0,a.le)(r)){var h=this.inputElement.value===""?null:this.inputElement.value,c={text:h,item:{}};this.initial?this.updateCustomValueCallback(h,c,l):this.trigger("customValueSpecifier",c,function(u){i.updateCustomValueCallback(h,u,l,e)})}else this.isSelectCustom=!1,this.setProperties({value:r}),l!==this.value&&this.onChangeEvent(e)}else this.allowCustom&&(this.isSelectCustom=!0)},t.prototype.updateCustomValueCallback=function(e,i,r,n){var s=this.fields,l=i.item,h={};l&&(0,a.NA)(s.text,l)&&(0,a.NA)(s.value,l)?h=l:((0,a.sO)(s.text,e,h),(0,a.sO)(s.value,e,h)),this.itemData=h;var c={text:(0,a.NA)(s.text,this.itemData),value:(0,a.NA)(s.value,this.itemData),index:null};this.setProperties(c,!0),this.setSelection(null,null),this.isSelectCustom=!0,r!==this.value&&this.onChangeEvent(n)},t.prototype.onPropertyChanged=function(e,i){this.getModuleName()==="combobox"&&(this.checkData(e),this.setUpdateInitial(["fields","query","dataSource"],e));for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"readonly":Ue.setReadonly(this.readonly,this.inputElement),this.readonly?(a.bi.remove(this.inputElement,"input",this.onInput),a.bi.remove(this.inputElement,"keyup",this.onFilterUp),a.bi.remove(this.inputElement,"keydown",this.onFilterDown)):(a.bi.add(this.inputElement,"input",this.onInput,this),a.bi.add(this.inputElement,"keyup",this.onFilterUp,this),a.bi.add(this.inputElement,"keydown",this.onFilterDown,this)),this.setReadOnly();break;case"allowFiltering":this.setSearchBox(),this.isFiltering()&&this.getModuleName()==="combobox"&&(0,a.le)(this.list)&&o.prototype.renderList.call(this);break;case"allowCustom":break;default:{var l=this.getPropObject(s,e,i);o.prototype.onPropertyChanged.call(this,l.newProperty,l.oldProperty),this.isFiltering()&&s==="dataSource"&&(0,a.le)(this.list)&&this.itemTemplate&&this.getModuleName()==="combobox"&&o.prototype.renderList.call(this);break}}}},t.prototype.render=function(){o.prototype.render.call(this),this.setSearchBox(),this.isFiltering()&&this.getModuleName()==="combobox"&&(0,a.le)(this.list)&&o.prototype.renderList.call(this),this.renderComplete()},t.prototype.getModuleName=function(){return"combobox"},t.prototype.addItem=function(e,i){o.prototype.addItem.call(this,e,i)},t.prototype.filter=function(e,i,r){o.prototype.filter.call(this,e,i,r)},t.prototype.showPopup=function(){o.prototype.showPopup.call(this)},t.prototype.hidePopup=function(e){var i=this.inputElement&&this.inputElement.value===""?null:this.inputElement&&this.inputElement.value;if(!(0,a.le)(this.listData)){var r=this.isEscapeKey;this.isEscapeKey&&(Ue.setValue(this.typedString,this.inputElement,this.floatLabelType,this.showClearButton),this.isEscapeKey=!1),this.autofill&&this.removeFillSelection();var n=this.isSelectCustom?{text:""}:this.getItemData(),s=this.list.querySelector("."+mt.selected);if(this.inputElement&&n.text===this.inputElement.value&&!(0,a.le)(s)){this.isSelected&&(this.onChangeEvent(e),this.isSelectCustom=!1),o.prototype.hidePopup.call(this,e);return}if(this.getModuleName()==="combobox"&&this.inputElement.value.trim()!==""){var l=Ch(this.inputElement.value,this.liCollections,"Equal",!0);this.selectedLI=l.item,(0,a.le)(l.index)&&(l.index=Ch(this.inputElement.value,this.liCollections,"StartsWith",!0).index),this.activeIndex=l.index,(0,a.le)(this.selectedLI)?r&&(this.isSelectCustom=!0,this.removeSelection()):this.updateSelectedItem(this.selectedLI,null,!0)}!this.isEscapeKey&&this.isTyped&&!this.isInteracted&&this.customValue(e)}(0,a.le)(this.listData)&&this.allowCustom&&!(0,a.le)(i)&&i!==this.value&&this.customValue(),o.prototype.hidePopup.call(this,e)},t.prototype.focusIn=function(){!this.enabled||(a.AR.isDevice&&!this.isFiltering()&&(this.preventFocus=!0),o.prototype.focusIn.call(this))},t.prototype.clear=function(){this.value=null},t.prototype.focusOut=function(e){o.prototype.focusOut.call(this,e)},t.prototype.getItems=function(){return o.prototype.getItems.call(this)},t.prototype.getDataByValue=function(e){return o.prototype.getDataByValue.call(this,e)},t.prototype.renderHightSearch=function(){},Oi([(0,a.Z9)(!1)],t.prototype,"autofill",void 0),Oi([(0,a.Z9)(!0)],t.prototype,"allowCustom",void 0),Oi([(0,a.Z9)({})],t.prototype,"htmlAttributes",void 0),Oi([(0,a.Z9)(!1)],t.prototype,"allowFiltering",void 0),Oi([(0,a.Z9)(null)],t.prototype,"query",void 0),Oi([(0,a.Z9)(null)],t.prototype,"index",void 0),Oi([(0,a.Z9)(!0)],t.prototype,"showClearButton",void 0),Oi([(0,a.Z9)(!1)],t.prototype,"enableRtl",void 0),Oi([(0,a.ju)()],t.prototype,"customValueSpecifier",void 0),Oi([(0,a.ju)()],t.prototype,"filtering",void 0),Oi([(0,a.Z9)(null)],t.prototype,"valueTemplate",void 0),Oi([(0,a.Z9)("Never")],t.prototype,"floatLabelType",void 0),Oi([(0,a.Z9)(null)],t.prototype,"filterBarPlaceholder",void 0),Oi([(0,a.Z9)(null)],t.prototype,"cssClass",void 0),Oi([(0,a.Z9)(null)],t.prototype,"headerTemplate",void 0),Oi([(0,a.Z9)(null)],t.prototype,"footerTemplate",void 0),Oi([(0,a.Z9)(null)],t.prototype,"placeholder",void 0),Oi([(0,a.Z9)("100%")],t.prototype,"width",void 0),Oi([(0,a.Z9)("300px")],t.prototype,"popupHeight",void 0),Oi([(0,a.Z9)("100%")],t.prototype,"popupWidth",void 0),Oi([(0,a.Z9)(!1)],t.prototype,"readonly",void 0),Oi([(0,a.Z9)(null)],t.prototype,"text",void 0),Oi([(0,a.Z9)(null)],t.prototype,"value",void 0),t=Oi([a.Zl],t),t}(mn),Wp=ae(9402),Up=function(){function o(t){this.categoryCollection=[],this.formulaCollection=[],this.isGoto=!1,this.parent=t,this.addEventListener()}return o.prototype.getModuleName=function(){return"formulaBar"},o.prototype.createFormulaBar=function(t){if(!this.parent.showFormulaBar&&this.insertFnRipple){this.destroy();return}var e=this.parent.serviceLocator.getService(Ve),i=this.parent.element.id,r=this.parent.createElement("div",{className:"e-formula-bar-panel"});if(!this.parent.isMobileView()){var n=this.parent.createElement("input",{id:i+"_name_box",attrs:{type:"text"}});r.appendChild(n),this.comboBoxInstance=new Jv({value:"A1",cssClass:"e-name-box",width:"",noRecordsTemplate:"",fields:{text:"name",value:"refersTo"},beforeOpen:this.nameBoxBeforeOpen.bind(this),blur:this.nameBoxBlur.bind(this),select:this.nameBoxSelect.bind(this),change:function(){}}),this.comboBoxInstance.createElement=this.parent.createElement,this.comboBoxInstance.appendTo(n),this.comboBoxInstance.element.parentElement.title=e.getConstant("NameBox")}var s=r.appendChild(this.parent.createElement("button",{className:"e-btn e-css e-flat e-icon-btn e-insert-function",attrs:{title:e.getConstant("InsertFunction")}}));s.appendChild(this.parent.createElement("span",{className:"e-btn-icon e-icons"})),this.insertFnRipple=(0,a.qx)(r,{selector:".e-insert-function"}),r.appendChild(this.parent.createElement("div",{className:"e-separator"}));var l=r.appendChild(this.parent.createElement("textarea",{className:"e-formula-bar e-css",id:i+"_formula_input",attrs:{title:e.getConstant("FormulaBar"),spellcheck:"false"}}));l.rows=1,this.parent.isMobileView()?(l.placeholder=e.getConstant("MobileFormulaBarPlaceHolder"),a.bi.add(l,"focus",this.textAreaFocusIn,this),a.bi.add(l,"blur",this.textAreaFocusOut,this)):r.appendChild(this.parent.createElement("span",{className:"e-drop-icon e-icons",attrs:{title:e.getConstant("ExpandFormulaBar")}})),t&&t.uiUpdate?this.parent.element.insertBefore(r,document.getElementById(i+"_sheet_panel")):this.parent.element.appendChild(r)},o.prototype.textAreaFocusIn=function(){var t=this.parent.element.querySelector(".e-formula-bar-panel"),e=this.parent.createElement("button",{className:"e-btn e-css e-flat e-icon-btn e-formula-submit"});e.appendChild(this.parent.createElement("span",{className:"e-btn-icon e-icons e-tick-icon"})),t.classList.add("e-focused"),t.appendChild(e)},o.prototype.textAreaFocusOut=function(){var t=this.parent.element.querySelector(".e-formula-bar-panel");t.classList.remove("e-focused"),(0,a.og)(t.querySelector(".e-formula-submit"))},o.prototype.keyDownHandler=function(t){var e=t.target;if(this.parent.isEdit&&!this.parent.getActiveSheet().isProtected){if(((0,w.C2M)(e.value)||e.validity&&e.value.toString().indexOf("=")===0)&&t.keyCode===16)return;e.classList.contains("e-formula-bar")&&this.parent.notify(E.vJ,{action:"refreshEditor",value:e.value,refreshEditorElem:!0})}},o.prototype.keyUpHandler=function(t){if(this.parent.isEdit){var e=t.target;if(e.classList.contains("e-formula-bar")){var i={action:"getCurrentEditValue",editedValue:""};this.parent.notify(E.vJ,i),i.editedValue!==e.value&&t.keyCode!==16&&this.parent.notify(E.vJ,{action:"refreshEditor",value:e.value,refreshEditorElem:!0})}}},o.prototype.nameBoxBeforeOpen=function(t){this.comboBoxInstance.element.classList.contains("e-name-editing")?t.cancel=!0:this.comboBoxInstance.element.select()},o.prototype.nameBoxBlur=function(){this.comboBoxInstance.element.classList.contains("e-name-editing")&&(this.comboBoxInstance.element.classList.remove("e-name-editing"),this.UpdateValueAfterMouseUp())},o.prototype.nameBoxSelect=function(t){if(t.isInteracted){var e=t.itemData.refersTo.substr(1),i=(0,w.Q8D)(this.parent,(0,w.HAf)(e));if(i===void 0)return;var r=(0,Ke.VB)(e),n=(0,w.zfV)(this.parent,i);if(r.indexOf(":")!==-1){var s=r.indexOf(":"),l=r.substr(0,s),h=r.substr(s+1,r.length);l=l.replace("$",""),h=h.replace("$",""),h.match(/\D/g)&&!h.match(/[0-9]/g)&&l.match(/\D/g)&&!l.match(/[0-9]/g)?(l=l+"1",h=h+n.rowCount,r=l+":"+h):!h.match(/\D/g)&&h.match(/[0-9]/g)&&!l.match(/\D/g)&&l.match(/[0-9]/g)&&(l=(0,Ke.qk)(parseInt(l,10)-1,0),h=(0,Ke.qk)(parseInt(h,10)-1,n.colCount-1),r=l+":"+h)}i===this.parent.activeSheetIndex?(this.parent.selectRange(r),we(this.parent.element)):((0,w.TmR)(this.parent,r,n),this.parent.activeSheetIndex=i)}},o.prototype.formulaBarUpdateHandler=function(t){var e=this,i=this.parent.getActiveSheet(),r=i.selectedRange.split(":"),n,s={action:"getElement",element:null};this.parent.notify(E.vJ,s);var l=this.parent.element.querySelector(".e-formula-bar"),h=new a.eC;if(t.type==="mousemove"||t.type==="pointermove"){var c=(0,Ke.dK)(r[0]),u=(0,Ke.dK)(r[1]);n=Math.abs(c[0]-u[0])+1+"R x "+(Math.abs(c[1]-u[1])+1)+"C",this.parent.isEdit&&(t.target&&!t.target.classList.contains("e-spreadsheet-edit")?this.parent.notify(E.PA,null):s.element&&(l.value=s.element.textContent))}else{n=r[0];var p=this.parent.getData((0,w.Rao)(this.parent)+"!"+n);p.then(function(f){var g="",C;f.forEach(function(L){var D=L&&L.format?(0,w.K2R)(L.format):"General";if(L){if(!(0,a.le)(L.value))if(C=(0,Wp.OD)(Number(L.value)),C.toString()!=="Invalid Date"&&(D==="ShortDate"||D==="LongDate")){if(g=h.formatDate(C,{type:"date",skeleton:"yMd"}),g&&g.indexOf("/")>-1||g.indexOf("-")>0){var R=g.split(/-|\//),B=L?L.format:"";(B==="dd-MM-yyyy"||B==="dd/MM/yyyy")&&Number(R[0])<=12&&Number(R[1])<=31&&(g=R[1]+"/"+R[0]+"/"+R[2])}}else C.toString()!=="Invalid Date"&&D==="Time"?(Number(L.value)>=1&&(g=h.formatDate(C,{type:"dateTime",skeleton:"yMd"})+" "),g+=h.formatDate(C,{type:"dateTime",skeleton:"hms"})):g=L.value;L.formula&&(g=L.formula)}var H={action:"getCurrentEditValue",editedValue:""};e.parent.notify(E.vJ,H);var j=H.editedValue&&H.editedValue.toString().indexOf("=")===0||(0,w.C2M)(H.editedValue),W=document.getElementById(e.parent.element.id+"_formula_input"),ne=(0,Ke.dK)(n),ie=e.parent.getCell(ne[0],ne[1]);if(L&&!L.formula&&ie&&(D!=="Time"||!g))if(L.value===void 0||e.isDateTimeType(L.format)&&L.value&&(0,Wp.OD)(Number(L.value)).toString()!=="Invalid Date"||(0,a.le)(L.format)){var me=e.isDateTimeType(L.format);if(me){var ve=new a.eC,Ee=me==="date"?"M/d/yyyy":"h:mm:ss a";(L.format==="dd-MM-yyyy"||L.format==="dd/MM/yyyy")&&(Ee=L.format),W.value=ve.formatDate((0,Wp.OD)(parseFloat(L.value)),{type:me,format:Ee})}else L.validation&&L.validation.type==="List"?W.value=(ie.lastElementChild||ie).textContent:W.value=ie.textContent}else W.value=L.value;else W.value=g;!(0,a.le)(g)&&!j&&e.parent.notify(E.vJ,{action:"refreshEditor",value:W.value,refreshEditorElem:!0}),e.parent.isEdit&&(t.target&&!t.target.classList.contains("e-spreadsheet-edit")?e.parent.notify(E.PA,null):s.element&&(l.value=s.element.textContent))})})}this.updateComboBoxValue(n)},o.prototype.isDateTimeType=function(t){var e=["/","-d","-m","-y","dd","mm","yy"],i=[":","hh","h","mm:ss","h:mm:ss"],r;return i.forEach(function(n){t&&t.indexOf(n)>-1&&(r="time")}),r||(e.forEach(function(n){t&&t.indexOf(n)>-1&&(r="date")}),r)},o.prototype.UpdateValueAfterMouseUp=function(){this.updateComboBoxValue(this.parent.getActiveSheet().selectedRange.split(":")[0])},o.prototype.updateComboBoxValue=function(t){var e=this.parent.getActiveSheet(),i=(0,w.Rao)(this.parent)+"!"+e.selectedRange,r={action:"getNameFromRange",range:i,definedName:null};if(this.parent.notify(E.Sn,r),r.definedName&&(t=r.definedName.name),!this.parent.isMobileView()){if(this.comboBoxInstance.text===t)return;this.comboBoxInstance.text=t,this.comboBoxInstance.dataBind()}},o.prototype.disabletextarea=function(){var t=this.getFormulaBar();this.parent.getActiveSheet().isProtected?t.disabled=!0:t.disabled=!1},o.prototype.formulaBarScrollEdit=function(){var t=(0,Ke.dK)(this.parent.getActiveSheet().selectedRange),e=(0,Ke.n5)(this.parent.getActiveSheet().topLeftCell);t[0]<e[0]&&(this.parent.goTo(this.parent.getActiveSheet().selectedRange),this.isGoto=!0),this.parent.notify(E.vJ,{action:"startEdit",refreshCurPos:!1})},o.prototype.formulaBarClickHandler=function(t){var e=this,i=t.target,r=this.parent.getActiveSheet(),n=r.isProtected,s=(0,Ke.n5)(r.activeCell),l=(0,w.$Su)(s[0],s[1],r),h=(0,w.p1d)(l,(0,w.wDo)(r,s[1]));if(i.classList.contains("e-drop-icon")&&(0,a.oq)(i,".e-formula-bar-panel"))this.toggleFormulaBar(i);else if(i.classList.contains("e-formula-bar"))!this.parent.isEdit&&(!n||n&&!h)?this.formulaBarScrollEdit():n&&h&&this.parent.notify(E.Gn,null);else if(i.parentElement&&i.parentElement.classList.contains("e-name-box"))if(i.classList.contains("e-ddl-icon")){var c={action:"getNames",names:[]};this.parent.notify(E.Sn,c),this.comboBoxInstance.dataSource=c.names}else this.comboBoxInstance.element.classList.add("e-name-editing"),this.comboBoxInstance.element.select();if(!(0,a.le)(i.offsetParent)&&(i.offsetParent.classList.contains("e-insert-function")||i.classList.contains("e-insert-function")||this.parent.element.id+"_insert_function"===i.offsetParent.id||this.parent.element.id+"_insert_function"===i.id||i.parentElement.classList.contains("e-insert-function")||this.parent.element.id+"_insert_function"===i.parentElement.id)){if(n){this.parent.notify(E.Gn,null);return}var u=!this.parent.isEdit,p={action:"getCurrentEditValue",editedValue:""};if(!u){var c={action:"isFormulaEditing",isFormulaEdit:!1};this.parent.notify(E.Sn,c),u=c.isFormulaEdit,this.parent.notify(E.vJ,p)}if(u||p.editedValue===""){p.editedValue===""&&this.parent.notify(E.vJ,{action:"refreshEditor",value:"="});var f=this.parent.serviceLocator.getService(Ve),g=this.parent.createElement("div",{className:"e-formula-description",id:this.parent.element.id+"_description_content"}),C=this.parent.createElement("div",{className:"e-category-content",id:this.parent.element.id+"_category_content",innerHTML:f.getConstant("PickACategory")}),L=this.parent.createElement("input",{className:"e-formula-category",id:this.parent.element.id+"_formula_category"}),D=this.parent.createElement("div",{className:"e-formula-list",id:this.parent.element.id+"_formula_list"}),R=this.parent.createElement("div",{className:"e-description-content",innerHTML:f.getConstant("Description")}),B=this.parent.createElement("div",{className:"e-header-content",innerHTML:f.getConstant("InsertFunction")}),H={action:"getFormulaCategory",categoryCollection:[]};this.parent.notify(ot.B7,H),this.categoryCollection=H.categoryCollection,this.categoryList=new mn({dataSource:this.categoryCollection,index:0,width:"285px",popupHeight:"210px",select:this.dropDownSelect.bind(this)});var j={action:"getLibraryFormulas",formulaCollection:[]};this.parent.notify(ot.B7,j),this.formulaCollection=j.formulaCollection,this.formulaList=new Sh({dataSource:this.formulaCollection.sort(),actionComplete:this.updateFormulaList.bind(this),select:this.listSelected.bind(this),width:"285px",height:"200px"}),this.dialog=this.parent.serviceLocator.getService("dialog"),this.dialog.show({header:B.outerHTML,content:C.outerHTML+L.outerHTML+D.outerHTML+R.outerHTML+g.outerHTML,width:"320px",height:"485px",cssClass:"e-spreadsheet-function-dlg",showCloseIcon:!0,isModal:!0,beforeOpen:function(W){var ne={dialogName:"InsertFunctionDialog",element:W.element,target:W.target,cancel:W.cancel};e.parent.trigger("dialogBeforeOpen",ne),ne.cancel&&(W.cancel=!0),we(e.parent.element)},open:this.dialogOpen.bind(this),beforeClose:this.dialogBeforeClose.bind(this),close:this.dialogClose.bind(this),buttons:[{click:this.selectFormula.bind(this,this.dialog,this),buttonModel:{content:f.getConstant("Ok"),isPrimary:!0}}]}),this.categoryList.appendTo("#"+this.parent.element.id+"_formula_category"),this.formulaList.appendTo("#"+this.parent.element.id+"_formula_list"),a.bi.add(this.formulaList.element,"dblclick",this.formulaClickHandler,this)}}},o.prototype.toggleFormulaBar=function(t){var e=t.parentElement,i=this.parent.serviceLocator.getService(Ve);e.classList.contains("e-expanded")?(e.classList.remove("e-expanded"),document.getElementById(this.parent.element.id+"_formula_input").rows=1,t.title=i.getConstant("ExpandFormulaBar")):(e.classList.add("e-expanded"),document.getElementById(this.parent.element.id+"_formula_input").rows=3,t.title=i.getConstant("CollapseFormulaBar")),this.parent.setPanelSize()},o.prototype.dialogOpen=function(){this.focusOkButton()},o.prototype.dialogClose=function(){var t={action:"getCurrentEditValue",editedValue:""};this.parent.notify(E.vJ,t),t.editedValue.toString().trim()==="="&&this.parent.notify(E.vJ,{action:"refreshEditor",value:""})},o.prototype.dialogBeforeClose=function(){a.bi.remove(this.formulaList.element,"dblclick",this.formulaClickHandler);var t=document.getElementsByClassName("e-spreadsheet-function-dlg")[0].querySelector(".e-dlg-content");t.parentNode.removeChild(t),this.dialog.dialogInstance.storeActiveElement=document.getElementById(this.parent.element.id+"_edit")},o.prototype.selectFormula=function(t,e){var i=e.formulaList.getSelectedItems().text,r=(0,w.zfV)(this.parent,this.parent.activeSheetIndex);this.parent.isEdit?this.parent.notify(E.vJ,{action:"refreshEditor",value:i+"(",refreshFormulaBar:!0,refreshEditorElem:!0,isAppend:!0}):(this.parent.notify(E.vJ,{action:"startEdit",value:"="+i+"(",address:r.activeCell}),this.parent.notify(E.GN,{action:"refreshFormulabar",value:"="+i+"("})),t.hide()},o.prototype.listSelected=function(){this.updateFormulaDescription()},o.prototype.updateFormulaList=function(){this.activeListFormula(),this.updateFormulaDescription()},o.prototype.dropDownSelect=function(t){this.formulaCollection=[];var e={action:"getLibraryFormulas",formulaCollection:[]};if(t.item.textContent==="All")this.parent.notify(ot.B7,e),this.formulaCollection=e.formulaCollection;else{var i=t.item.textContent,r={action:"dropDownSelectFormulas",formulaCollection:[],selectCategory:i};this.parent.notify(ot.B7,r),this.formulaCollection=r.formulaCollection}this.formulaList.dataSource=this.formulaCollection.sort()},o.prototype.focusOkButton=function(){var t=document.getElementsByClassName("e-spreadsheet-function-dlg")[0].querySelector(".e-dlg-content");t.nextElementSibling.firstElementChild.focus()},o.prototype.activeListFormula=function(){var t=document.getElementById(this.parent.element.id+"_formula_list"),e=t.children[0].children[0].firstElementChild;this.formulaList.selectItem(e)},o.prototype.updateFormulaDescription=function(){var t=this.formulaList.getSelectedItems().text,e={action:"getFormulaDescription",description:"",selectedList:t};this.parent.notify(ot.B7,e),this.focusOkButton();var i=document.getElementById(this.parent.element.id+"_description_content");t=t==="AND"?"CalculateAND":t==="OR"?"CalculateOR":t,i.innerHTML=this.parent.serviceLocator.getService(Ve).getConstant(t)},o.prototype.formulaClickHandler=function(t){var e=t.target,i=(0,w.zfV)(this.parent,this.parent.activeSheetIndex);(e.offsetParent.classList.contains("e-text-content")||e.classList.contains("e-list-item"))&&(this.parent.isEdit?this.parent.notify(E.vJ,{action:"refreshEditor",value:e.innerText+"(",refreshFormulaBar:!0,refreshEditorElem:!0,isAppend:!0}):(this.parent.notify(E.vJ,{action:"startEdit",value:"="+e.innerText+"(",address:i.activeCell}),this.parent.notify(E.GN,{action:"refreshFormulabar",value:"="+e.innerText+"("})),this.dialog.hide())},o.prototype.addEventListener=function(){this.parent.on(E.y8,this.createFormulaBar,this),this.parent.on(E.V4,this.formulaBarClickHandler,this),this.parent.on(E.SH,this.keyDownHandler,this),this.parent.on(E.yR,this.keyUpHandler,this),this.parent.on(ot.Pm,this.formulaBarUpdateHandler,this),this.parent.on(E.Vo,this.UpdateValueAfterMouseUp,this),this.parent.on(E.GN,this.editOperationHandler,this),this.parent.on(E.HP,this.disabletextarea,this),this.parent.on(E.UM,this.isFormulaBarEdit,this)},o.prototype.destroy=function(){this.removeEventListener(),this.comboBoxInstance.destroy(),this.comboBoxInstance=null,this.insertFnRipple(),this.insertFnRipple=null;var t=this.parent.element.querySelector(".e-formula-bar-panel");t&&(0,a.og)(t)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.y8,this.createFormulaBar),this.parent.off(E.V4,this.formulaBarClickHandler),this.parent.off(E.SH,this.keyDownHandler),this.parent.off(E.yR,this.keyUpHandler),this.parent.off(ot.Pm,this.formulaBarUpdateHandler),this.parent.off(E.Vo,this.UpdateValueAfterMouseUp),this.parent.off(E.GN,this.editOperationHandler),this.parent.off(E.HP,this.disabletextarea),this.parent.off(E.UM,this.isFormulaBarEdit))},o.prototype.editOperationHandler=function(t){var e=t.action;switch(e){case"refreshFormulabar":this.getFormulaBar().value=(0,a.o8)(t.value)?"":t.value;break;case"getElement":t.element=this.getFormulaBar();break}},o.prototype.isFormulaBarEdit=function(t){var e=this.parent.isEdit;e&&this.isGoto?t.isEdit=!0:t.isEdit=!1},o.prototype.getFormulaBar=function(){return(0,a.Ys)("#"+this.parent.element.id+"_formula_input",this.parent.element)},o}();function jh(o,t,e,i){if(t!==""){var r=e?"gim":"gm";t=/^[a-zA-Z0-9- ]*$/.test(t)?t:t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var n=i==="StartsWith"?"^("+t+")":i==="EndsWith"?"("+t+")$":"("+t+")";em(o,new RegExp(n,r))}}function em(o,t){for(var e=0;o.childNodes&&e<o.childNodes.length;e++)if(o.childNodes[e].nodeType===3&&o.childNodes[e].textContent.trim()!==""){var i=o.childNodes[e].nodeValue.trim().replace(t,'<span class="e-highlight">$1</span>');o.childNodes[e].nodeValue="",o.innerHTML=o.innerHTML.trim()+i;break}else em(o.childNodes[e],t)}function HC(o){for(var t=o.querySelectorAll(".e-highlight"),e=t.length-1;e>=0;e--){var i=t[e].parentNode,r=document.createTextNode(t[e].textContent);i.replaceChild(r,t[e])}}var VC=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),lr=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n};mt.root="e-autocomplete",mt.icon="e-input-group-icon e-ddl-icon e-search-icon";var tm=function(o){VC(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.isFiltered=!1,r.searchList=!1,r}return t.prototype.preRender=function(){o.prototype.preRender.call(this)},t.prototype.getLocaleName=function(){return"auto-complete"},t.prototype.getNgDirective=function(){return"EJS-AUTOCOMPLETE"},t.prototype.getQuery=function(e){var i=e?e.clone():this.query?this.query.clone():new yt.A,r=this.queryString===""&&!(0,a.le)(this.value)?"equal":this.filterType,n=this.queryString===""&&!(0,a.le)(this.value)?this.value:this.queryString;if(this.isFiltered)return i;if(this.queryString!==null&&this.queryString!==""){var s=this.typeOfData(this.dataSource).typeof;if(!(this.dataSource instanceof Oe.h)&&s==="string"||s==="number")i.where("",r,n,this.ignoreCase,this.ignoreAccent);else{var l=(0,a.le)(this.fields.value)?"":this.fields.value;i.where(l,r,n,this.ignoreCase,this.ignoreAccent)}}if(!(0,a.le)(this.suggestionCount)){if(this.suggestionCount!==20)for(var h=0;h<i.queries.length;h++)i.queries[h].fn==="onTake"&&i.queries.splice(h,1);i.take(this.suggestionCount)}return i},t.prototype.searchLists=function(e){var i=this;if(this.isTyped=!0,this.isDataFetched=this.isSelectCustom=!1,(0,a.le)(this.list)&&o.prototype.renderList.call(this,!0),this.queryString=this.filterInput.value,e.type!=="mousedown"&&(e.keyCode===40||e.keyCode===38)){this.queryString=this.queryString===""?null:this.queryString,this.beforePopupOpen=!0,this.resetList(this.dataSource,this.fields);return}this.isSelected=!1,this.activeIndex=null;var r={preventDefaultAction:!1,text:this.filterInput.value,updateData:function(n,s,l){r.cancel||(i.isFiltered=!0,i.filterAction(n,s,l))},cancel:!1};this.trigger("filtering",r,function(n){!n.cancel&&!i.isFiltered&&!n.preventDefaultAction&&(i.searchList=!0,i.filterAction(i.dataSource,null,i.fields))})},t.prototype.filter=function(e,i,r){this.isFiltered=!0,this.filterAction(e,i,r)},t.prototype.filterAction=function(e,i,r){this.beforePopupOpen=!0,this.queryString!==""&&this.queryString.length>=this.minLength?this.resetList(e,r,i):(this.hidePopup(),this.beforePopupOpen=!1),this.renderReactTemplates()},t.prototype.clearAll=function(e,i){((0,a.le)(i)||!(0,a.le)(i)&&(0,a.le)(i.dataSource))&&o.prototype.clearAll.call(this,e),this.beforePopupOpen&&this.hidePopup()},t.prototype.onActionComplete=function(e,i,r,n){this.fixedHeaderElement=null,o.prototype.onActionComplete.call(this,e,i,r);var s=this.list.querySelector("."+mt.li);(0,a.le)(s)||(0,a.IV)([s],mt.focus),this.postBackAction()},t.prototype.postBackAction=function(){if(this.autofill&&!(0,a.le)(this.liCollections[0])&&this.searchList){var e=[this.liCollections[0]],i=Ch(this.inputElement.value,e,"StartsWith",this.ignoreCase);this.searchList=!1,(0,a.le)(i.item)||o.prototype.setAutoFill.call(this,this.liCollections[0],!0)}},t.prototype.setSelection=function(e,i){if(!!this.isValidLI(e))if(!(0,a.le)(i)&&i.type==="keydown"&&i.action!=="enter"&&i.action!=="tab"&&this.isValidLI(e)){var r=this.getFormattedValue(e.getAttribute("data-value"));if(this.activeIndex=this.getIndexByValue(r),this.setHoverList(e),this.selectedLI=e,this.setScrollPosition(i),this.autofill&&this.isPopupOpen){this.preventAutoFill=!1;var n=i&&i.action==="down"||i.action==="up"||i.action==="home"||i.action==="end"||i.action==="pageUp"||i.action==="pageDown";o.prototype.setAutoFill.call(this,e,n)}(0,a.Y4)(this.inputElement,{"aria-activedescendant":this.selectedLI?this.selectedLI.id:null})}else o.prototype.setSelection.call(this,e,i)},t.prototype.listOption=function(e,i){var r=this,n=o.prototype.listOption.call(this,e,i);if((0,a.le)(n.itemCreated))n.itemCreated=function(l){r.highlight&&(r.element.tagName===r.getNgDirective()&&r.itemTemplate?setTimeout(function(){jh(l.item,r.queryString,r.ignoreCase,r.filterType)},0):jh(l.item,r.queryString,r.ignoreCase,r.filterType))};else{var s=n.itemCreated;n.itemCreated=function(l){r.highlight&&jh(l.item,r.queryString,r.ignoreCase,r.filterType),s.apply(r,[l])}}return n},t.prototype.isFiltering=function(){return!0},t.prototype.renderPopup=function(){this.list.scrollTop=0,o.prototype.renderPopup.call(this)},t.prototype.isEditTextBox=function(){return this.inputElement.value.trim()!==""},t.prototype.isPopupButton=function(){return this.showPopupButton},t.prototype.isSelectFocusItem=function(e){return!1},t.prototype.showPopup=function(){if(!!this.enabled){if(this.beforePopupOpen){this.refreshPopup();return}this.beforePopupOpen=!0,this.preventAutoFill=!0,(0,a.le)(this.list)?this.renderList():this.resetList(this.dataSource,this.fields)}},t.prototype.hidePopup=function(e){o.prototype.hidePopup.call(this,e),this.activeIndex=-1},t.prototype.onPropertyChanged=function(e,i){this.getModuleName()==="autocomplete"&&this.setUpdateInitial(["fields","query","dataSource"],e);for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"showPopupButton":if(this.showPopupButton){var l=Ue.appendSpan(mt.icon,this.inputWrapper.container,this.createElement);this.inputWrapper.buttons[0]=l,this.inputWrapper&&this.inputWrapper.buttons&&this.inputWrapper.buttons[0]&&a.bi.add(this.inputWrapper.buttons[0],"click",this.dropDownClick,this)}else(0,a.og)(this.inputWrapper.buttons[0]),this.inputWrapper.buttons[0]=null;break;default:{var h=this.getPropObject(s,e,i);o.prototype.onPropertyChanged.call(this,h.newProperty,h.oldProperty);break}}}},t.prototype.renderHightSearch=function(){if(this.highlight)for(var e=0;e<this.liCollections.length;e++){var i=this.ulElement.querySelector(".e-active");i||(HC(this.liCollections[e]),jh(this.liCollections[e],this.queryString,this.ignoreCase,this.filterType))}},t.prototype.getModuleName=function(){return"autocomplete"},t.prototype.render=function(){o.prototype.render.call(this)},lr([(0,a.Zz)({value:null,iconCss:null,groupBy:null},uv)],t.prototype,"fields",void 0),lr([(0,a.Z9)(!0)],t.prototype,"ignoreCase",void 0),lr([(0,a.Z9)(!1)],t.prototype,"showPopupButton",void 0),lr([(0,a.Z9)(!1)],t.prototype,"highlight",void 0),lr([(0,a.Z9)(20)],t.prototype,"suggestionCount",void 0),lr([(0,a.Z9)({})],t.prototype,"htmlAttributes",void 0),lr([(0,a.Z9)(null)],t.prototype,"query",void 0),lr([(0,a.Z9)(1)],t.prototype,"minLength",void 0),lr([(0,a.Z9)("Contains")],t.prototype,"filterType",void 0),lr([(0,a.ju)()],t.prototype,"filtering",void 0),lr([(0,a.Z9)(null)],t.prototype,"index",void 0),lr([(0,a.Z9)("Never")],t.prototype,"floatLabelType",void 0),lr([(0,a.Z9)(null)],t.prototype,"valueTemplate",void 0),lr([(0,a.Z9)(null)],t.prototype,"filterBarPlaceholder",void 0),lr([(0,a.Z9)(!1)],t.prototype,"allowFiltering",void 0),lr([(0,a.Z9)(null)],t.prototype,"text",void 0),t=lr([a.Zl],t),t}(Jv),qp=function(){function o(t){this.isFormulaBar=!1,this.isFormula=!1,this.isPopupOpened=!1,this.isPreventClose=!1,this.isSubFormula=!1,this.parent=t,this.addEventListener()}return o.prototype.getModuleName=function(){return"formula"},o.prototype.destroy=function(){this.removeEventListener(),this.autocompleteInstance&&(this.autocompleteInstance.destroy(),this.autocompleteInstance.element&&this.autocompleteInstance.element.remove()),this.autocompleteInstance=null,this.parent=null},o.prototype.addEventListener=function(){this.parent.on(E.Sn,this.performFormulaOperation,this),this.parent.on(E.yR,this.keyUpHandler,this),this.parent.on(E.SH,this.keyDownHandler,this),this.parent.on(E.V4,this.formulaClick,this),this.parent.on(E.YM,this.refreshFormulaDatasource,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.Sn,this.performFormulaOperation),this.parent.off(E.yR,this.keyUpHandler),this.parent.off(E.SH,this.keyDownHandler),this.parent.off(E.V4,this.formulaClick),this.parent.off(E.YM,this.refreshFormulaDatasource))},o.prototype.performFormulaOperation=function(t){var e=this,i=t.action,r=this.parent.serviceLocator.getService(Ve),n,s;switch(i){case"renderAutoComplete":this.renderAutoComplete();break;case"endEdit":this.endEdit();break;case"addDefinedName":t.isAdded=this.addDefinedName(t.definedName);break;case"getNames":t.sheetName||(t.sheetName=(0,w.Rao)(this.parent)),t.names=this.getNames(t.sheetName);break;case"getNameFromRange":t.definedName=this.getNameFromRange(t.range);break;case"isFormulaEditing":t.isFormulaEdit=this.isFormula;break;case"isCircularReference":n=this.parent.serviceLocator.getService(Yt),s=r.getConstant("CircularReference"),n.dialogInstance&&n.dialogInstance.visible&&n.dialogInstance.content===s||n.show({height:180,width:400,isModal:!0,showCloseIcon:!0,content:r.getConstant("CircularReference"),beforeOpen:function(l){var h={dialogName:"CircularReferenceDialog",element:l.element,target:l.target,cancel:l.cancel};e.parent.trigger("dialogBeforeOpen",h),h.cancel&&(l.cancel=!0)}}),t.argValue="0";break}},o.prototype.renderAutoComplete=function(){if(!(0,a.Ys)("#"+this.parent.element.id+"_ac",this.parent.element)){var t=this.parent.createElement("input",{id:this.parent.element.id+"_ac",className:"e-ss-ac"});this.parent.element.appendChild(t);var e={action:"getLibraryFormulas",formulaCollection:[]};this.parent.notify(w.B7N,e);var i={dataSource:e.formulaCollection,cssClass:"e-ss-atc",popupWidth:"130px",allowFiltering:!0,filterType:"StartsWith",sortOrder:"Ascending",open:this.onSuggestionOpen.bind(this),close:this.onSuggestionClose.bind(this),select:this.onSelect.bind(this),actionComplete:this.onSuggestionComplete.bind(this)};this.autocompleteInstance=new tm(i,t),this.autocompleteInstance.createElement=this.parent.createElement}},o.prototype.onSuggestionOpen=function(t){var e=this;this.isPopupOpened=!0,t.popup.relateTo=this.getRelateToElem(),t.popup.element.firstChild.style.maxHeight="180px",new Promise(function(i,r){setTimeout(function(){i()},100)}).then(function(){e.triggerKeyDownEvent(Yr.DOWN)})},o.prototype.onSuggestionClose=function(t){this.isPreventClose?t.cancel=!0:this.isPopupOpened=!1},o.prototype.onSelect=function(t){var e="="+t.itemData.value+"(";if(this.isSubFormula){var i=this.getEditingValue(),r=i.lastIndexOf(this.getArgumentSeparator());r>-1?e=i.slice(0,r+1):(r=i.lastIndexOf("("),r>-1&&(e=i.slice(0,r+1))),e+=t.itemData.value+"("}if(this.parent.notify(E.vJ,{action:"refreshEditor",value:e,refreshFormulaBar:!0,refreshEditorElem:!0,refreshCurPos:!this.isFormulaBar}),this.isPopupOpened){this.hidePopUp();var n=(0,a.Ys)("#"+this.parent.element.id+"_ac_popup");n&&(0,a.og)(n),this.isPopupOpened=!1}},o.prototype.onSuggestionComplete=function(t){this.isPreventClose=t.result.length>0,this.isPreventClose||(t.cancel=!0,this.hidePopUp())},o.prototype.refreshFormulaDatasource=function(){var t={action:"getLibraryFormulas",formulaCollection:[]};this.parent.notify(w.B7N,t),this.autocompleteInstance.dataSource=t.formulaCollection},o.prototype.keyUpHandler=function(t){if(this.parent.isEdit){var e=this.getEditingValue();this.isFormula=(0,w.C2M)(e),(this.isFormula||this.isPopupOpened)&&(t.keyCode!==Yr.TAB&&this.isFormula&&(e=this.getSuggestionKeyFromFormula(e)),this.refreshFormulaSuggestion(t,e))}else this.isPopupOpened&&this.hidePopUp()},o.prototype.keyDownHandler=function(t){var e=t.keyCode;if(this.isFormula){if(this.isPopupOpened)switch(e){case Yr.UP:case Yr.DOWN:t.preventDefault(),this.triggerKeyDownEvent(e);break;case Yr.TAB:t.preventDefault(),this.triggerKeyDownEvent(Yr.ENTER);break}}else{var i=t.target;if(i.id===this.parent.element.id+"_name_box")switch(e){case Yr.ENTER:this.addDefinedName({name:i.value}),we(this.parent.element);break;case Yr.ESC:we(this.parent.element);break}}},o.prototype.formulaClick=function(t){if(this.parent.isEdit){var e=t.target;this.isFormulaBar=e.classList.contains("e-formula-bar")}},o.prototype.refreshFormulaSuggestion=function(t,e){if(e.length>0){var i=this.autocompleteInstance.element,r=t.keyCode,n=this.isPopupOpened;this.isNavigationKey(r)||(i.value=e,i.dispatchEvent(new Event("input")),i.dispatchEvent(new Event("keyup")),n&&this.triggerKeyDownEvent(Yr.DOWN))}else this.isPopupOpened&&(this.isPreventClose=!1,this.hidePopUp())},o.prototype.endEdit=function(){if(this.isSubFormula=!1,this.isPreventClose=!1,this.isFormula=!1,this.isFormulaBar=!1,this.isPopupOpened){this.hidePopUp();var t=(0,a.Ys)("#"+this.parent.element.id+"_ac_popup");t&&(0,a.og)(t),this.isPopupOpened=!1}},o.prototype.hidePopUp=function(){this.autocompleteInstance.hidePopup()},o.prototype.getSuggestionKeyFromFormula=function(t){var e="";if(t=t.substr(1),t){var i=t.lastIndexOf("(");t=t.substr(i+1);var r=t.split(this.getArgumentSeparator());r.length===1?(e=r[0],this.isSubFormula=i>-1):(e=r[r.length-1],this.isSubFormula=!0);var n=e.match(/\w/);(!n||n&&n.index!==0)&&(e="")}return e},o.prototype.getRelateToElem=function(){var t={action:"getElement"};return this.isFormulaBar?this.parent.notify(E.GN,t):this.parent.notify(E.vJ,t),t.element},o.prototype.getEditingValue=function(){var t={action:"getCurrentEditValue",editedValue:""};return this.parent.notify(E.vJ,t),t.editedValue},o.prototype.isNavigationKey=function(t){return t===Yr.UP||t===Yr.DOWN||t===Yr.LEFT||t===Yr.RIGHT},o.prototype.triggerKeyDownEvent=function(t){var e=this.autocompleteInstance.element;e.dispatchEvent(new Event("input"));var i=new Event("keydown");i.keyCode=t,i.which=t,i.altKey=!1,i.shiftKey=!1,i.ctrlKey=!1,e.dispatchEvent(i)},o.prototype.getArgumentSeparator=function(){var t={action:"getArgumentSeparator",argumentSeparator:""};return this.parent.notify(w.B7N,t),t.argumentSeparator},o.prototype.getNames=function(t){var e=this.parent.definedNames.filter(function(i){return i.scope==="Workbook"||i.scope===""||i.scope===t});return e},o.prototype.getNameFromRange=function(t){var e=t.slice(0,t.indexOf(":")),i=t.slice(t.indexOf("!")+1).split(":"),r=i.length>1&&i[0]===i[1],n=this.parent.definedNames.filter(function(s){return r&&s.refersTo==="="+e?!0:s.refersTo==="="+t});return n&&n[0]},o.prototype.addDefinedName=function(t){var e=this,i=t.name,r=!1;if(i&&(0,w.qhV)(i.toUpperCase()))return this.parent.goTo(i),r;if(!t.refersTo){var n=(0,w.zfV)(this.parent,this.parent.activeSheetIndex),s=(0,w.Rao)(this.parent);s=s.indexOf(" ")!==-1?"'"+s+"'":s;var l=n.selectedRange;if(!(0,a.le)(l)){var h=l.indexOf(":"),c=l.substr(0,h),u=l.substr(h+1,l.length);parseInt(u.replace(/\D/g,""),10)===n.rowCount&&parseInt(c.replace(/\D/g,""),10)===1?(u=u.replace(/[0-9]/g,""),c=c.replace(/[0-9]/g,""),l="$"+c+":$"+u):(0,w.n53)(u)[1]===n.colCount-1&&(0,w.n53)(c)[1]===0?(u=u.replace(/\D/g,""),c=c.replace(/\D/g,""),l="$"+c+":$"+u):l=c===u?c:l}t.refersTo=s+"!"+l,t.scope="Workbook"}if(i.length>0&&/^([a-zA-Z_0-9.]){0,255}$/.test(i)){var p={action:"addDefinedName",definedName:t,isAdded:!1};this.parent.notify(w.B7N,p),r=p.isAdded,p.isAdded||this.parent.serviceLocator.getService(Yt).show({content:this.parent.serviceLocator.getService(Ve).getConstant("DefineNameExists"),width:"300",beforeOpen:function(f){var g={dialogName:"DefineNameExistsDialog",element:f.element,target:f.target,cancel:f.cancel};e.parent.trigger("dialogBeforeOpen",g),g.cancel&&(f.cancel=!0)}})}else this.parent.serviceLocator.getService(Yt).show({content:this.parent.serviceLocator.getService(Ve).getConstant("DefineNameInValid"),width:"300",beforeOpen:function(f){var g={dialogName:"DefineNameInValidDialog",element:f.element,target:f.target,cancel:f.cancel};e.parent.trigger("dialogBeforeOpen",g),g.cancel&&(f.cancel=!0)}});return r},o}(),Zp=function(){function o(t){this.aggregateContent="",this.selaggregateCnt="Sum",this.parent=t,this.addEventListener()}return o.prototype.getModuleName=function(){return"sheetTabs"},o.prototype.createSheetTabs=function(){var t=this;if(!this.parent.showSheetTabs&&this.tabInstance){this.destroy();return}var e=this.parent.serviceLocator.getService(Ve),i=this.parent.createElement("div",{className:"e-sheet-tab-panel",id:this.parent.element.id+"_sheet_tab_panel"}),r=this.parent.createElement("button",{className:"e-add-sheet-tab e-btn e-css e-flat e-icon-btn"+(this.parent.allowInsert?"":" e-disabled"),attrs:{title:e.getConstant("AddSheet")}});r.appendChild(this.parent.createElement("span",{className:"e-btn-icon e-icons e-add-icon"})),r.addEventListener("click",this.addSheetTab.bind(this)),r.disabled=!this.parent.allowInsert,i.appendChild(r),this.addBtnRipple=(0,a.qx)(i,{selector:".e-add-sheet-tab"});var n=this.parent.createElement("button",{attrs:{title:e.getConstant("ListAllSheets")}});i.appendChild(n),this.parent.element.appendChild(i);var s=this.getSheetTabItems();this.dropDownInstance=new Bi({iconCss:"e-icons",items:s.ddbItems,createPopupOnClick:!0,beforeItemRender:function(g){var C=t.parent.sheets[t.dropDownInstance.items.indexOf(g.item)];C.state==="Hidden"?g.element.classList.add("e-hide"):C.state==="VeryHidden"&&(g.element.style.display="none")},select:function(g){return t.updateSheetTab({idx:t.dropDownInstance.items.indexOf(g.item)})},beforeOpen:function(g){return t.beforeOpenHandler(t.dropDownInstance,g.element)},open:function(g){return t.openHandler(t.dropDownInstance,g.element,"left")},cssClass:"e-sheets-list e-flat e-caret-hide",close:function(){return we(t.parent.element)}}),this.dropDownInstance.createElement=this.parent.createElement,this.dropDownInstance.appendTo(n);var l=this.parent.createElement("div",{className:"e-sheet-tab"}),h;this.tabInstance=new xu({selectedItem:this.parent.activeSheetIndex,overflowMode:"Scrollable",items:s.tabItems,scrollStep:250,selecting:function(g){if(g.selectingIndex!==g.selectedIndex)if(h)h=!1;else{var C={currentSheetIndex:g.selectingIndex,previousSheetIndex:g.selectedIndex,cancel:!1};t.parent.notify(w.ya2,{eventArgs:C,action:"gotoSheet"}),h=C.cancel}},selected:function(g){t.goToSheet(g,h,!0)},created:function(){var g=t.tabInstance.element.querySelector(".e-toolbar-items");g.classList.add("e-sheet-tabs-items"),a.bi.add(g,"dblclick",t.renameSheetTab,t)}}),i.appendChild(l),this.tabInstance.createElement=this.parent.createElement,this.tabInstance.appendTo(l),a.bi.remove(this.tabInstance.element,"keydown",this.tabInstance.spaceKeyDown);for(var c=s.tabItems.length,u,p=0;p<c;p++){u=(0,w.zfV)(this.parent,p);var f={action:"addSheet",sheetName:"Sheet"+u.id,sheetId:u.id,visibleName:u.name};this.parent.notify(pe.B7N,f)}this.parent.notify(pe.B7N,{action:"initiateDefinedNames"}),this.parent.notify(E.Vm,null)},o.prototype.goToSheet=function(t,e,i){if(t.selectedIndex!==t.previousIndex){if(e){this.tabInstance.selectedItem=t.previousIndex,this.tabInstance.dataBind(),we(this.parent.element);return}if(this.parent.notify(E.k3,{}),this.parent.isEdit){var r=window.getSelection(),n={action:"getCurrentEditValue",editedValue:""};this.parent.notify(E.vJ,n);var s=n.editedValue?(0,pe.C2M)(n.editedValue,!0):!1;!s&&r&&r.focusNode&&r.focusNode.classList&&r.focusNode.classList.contains("e-formula-bar-panel")&&(s=(0,pe.C2M)(this.parent.element.querySelector(".e-formula-bar").value,!0)),s||this.parent.endEdit()}this.parent.activeSheetIndex=t.selectedIndex,this.parent.dataBind(),this.updateDropDownItems(t.selectedIndex,t.previousIndex),we(this.parent.element);var l={action:"registerGridInCalc",sheetID:(t.selectedIndex+1).toString()};this.parent.notify(pe.B7N,l),i&&this.parent.notify(E.Av,{eventArgs:{previousSheetIndex:t.previousIndex,currentSheetIndex:t.selectedIndex},action:"gotoSheet"})}},o.prototype.updateDropDownItems=function(t,e){e>-1&&(this.dropDownInstance.items[e].iconCss=""),this.dropDownInstance.items[t].iconCss="e-selected-icon e-icons",this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0)},o.prototype.beforeOpenHandler=function(t,e){var i=this.parent.viewport.height,r=parseInt(getComputedStyle(e.firstElementChild).height,10)*t.items.length+parseInt(getComputedStyle(e).paddingTop,10)*2;r>i&&(e.style.height=i+"px",e.style.overflowY="auto"),e.parentElement.style.visibility="hidden"},o.prototype.openHandler=function(t,e,i){var r=e.parentElement,n,s=Vr(r);if(s.indexOf("bottom")===-1){n=e.style.overflowY==="auto"?this.parent.viewport.height:r.getBoundingClientRect().height;var l=Di(t.element,i,"top");i==="right"&&(l.left-=r.getBoundingClientRect().width),r.style.left=l.left+"px",r.style.top=l.top-n+"px"}r.style.visibility=""},o.prototype.getSheetTabItems=function(){var t=this,e=[],i=[],r;return this.parent.sheets.forEach(function(n,s){r=(0,w.Rao)(t.parent,s).replace(/</g,"&lt;").replace(/>/g,"&gt;"),e.push({header:{text:r},visible:n.state==="Visible"}),i.push({text:r,iconCss:s===t.parent.activeSheetIndex?"e-selected-icon e-icons":""})}),{tabItems:e,ddbItems:i}},o.prototype.refreshSheetTab=function(){var t=this.getSheetTabItems();this.dropDownInstance.items=t.ddbItems,this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0),this.tabInstance.items=t.tabItems,this.tabInstance.selectedItem=this.parent.activeSheetIndex,this.tabInstance.dataBind()},o.prototype.addSheetTab=function(){var t={action:"getCurrentEditValue",editedValue:""};this.parent.notify(E.vJ,t),this.parent.notify(pe.IQJ,{model:this.parent,start:this.parent.activeSheetIndex+1,end:this.parent.activeSheetIndex+1,modelType:"Sheet",isAction:!0,activeSheetIndex:this.parent.activeSheetIndex+1}),we(this.parent.element)},o.prototype.insertSheetTab=function(t){this.parent.notify(E.k3,{}),(!t.preventUpdate||t.startIdx===this.tabInstance.selectedItem)&&(this.dropDownInstance.items[this.tabInstance.selectedItem].iconCss="");for(var e=t.startIdx;e<=t.endIdx;e++){var i=this.parent.sheets[e].name.replace(/</g,"&lt;").replace(/>/g,"&gt;");this.dropDownInstance.items.splice(e,0,{text:i}),this.tabInstance.addTab([{header:{text:i},content:""}],e)}(!t.preventUpdate||t.startIdx===this.tabInstance.selectedItem)&&(this.dropDownInstance.items[t.startIdx].iconCss="e-selected-icon e-icons"),this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0),t.preventUpdate?t.startIdx!==this.tabInstance.selectedItem&&this.refreshSheetTab():this.updateSheetTab({idx:t.startIdx,preventDataBind:!0})},o.prototype.updateSheetTab=function(t){if(t.name==="activeSheetChanged")t.idx=this.parent.skipHiddenSheets(t.idx);else if(this.parent.sheets[t.idx].state==="Hidden"){if(this.parent.isProtected)return;this.showSheet({sheetIndex:t.idx,triggerEvent:!0})}this.tabInstance.selectedItem=t.idx,t.preventDataBind||this.tabInstance.dataBind(),this.parent.notify(E.Vm,null)},o.prototype.showSheet=function(t){this.parent.setSheetPropertyOnMute(this.parent.sheets[t.sheetIndex],"state","Visible"),this.tabInstance.hideTab(t.sheetIndex,!1),t.triggerEvent&&this.parent.notify(E.Av,{action:"showSheet",eventArgs:{sheetIndex:t.sheetIndex}})},o.prototype.switchSheetTab=function(t){var e=(0,a.oq)(t.event.target,".e-toolbar-item");if(!!e){for(var i=e.querySelector(".e-tab-text").textContent,r=[],n=this.parent.element.id+"_cmenu",s=0,l=this.parent.sheets.length;s<l;s++)if(this.parent.sheets[s].name===i){this.parent.activeSheetIndex!==s&&this.updateSheetTab({idx:s});break}t.element.classList.contains("e-contextmenu")&&t.items[0]&&t.items[0].id===this.parent.element.id+"_cmenu_insert_sheet"&&(this.skipHiddenSheets()===1&&r.push(n+"_hide_sheet",n+"_delete_sheet"),(!this.parent.allowInsert||this.parent.isProtected)&&r.push(n+"_insert_sheet"),!this.parent.allowDelete&&r.indexOf(n+"_delete_sheet")>-1&&r.push(n+"_delete_sheet")),(this.parent.password.length>0||this.parent.isProtected)&&(r.indexOf(n+"_insert_sheet")>-1&&r.push(n+"_insert_sheet"),r.indexOf(n+"_delete_sheet")>-1&&r.push(n+"_delete_sheet"),r.push(n+"_duplicate",n+"_rename")),this.parent.enableContextMenuItems(r,!1,!0)}},o.prototype.skipHiddenSheets=function(){var t=this.parent.sheets.length;return this.parent.sheets.forEach(function(e){e.state!=="Visible"&&--t}),t},o.prototype.renameSheetTab=function(){var t=this.tabInstance.element.querySelector(".e-toolbar-item.e-active");if(t){t=t.querySelector(".e-text-wrap");var e=t.querySelector(".e-tab-text").textContent,i={eventArgs:{name:e,index:this.parent.getActiveSheet().id},action:"renameSheet",cancel:!1};if(this.parent.trigger("actionBegin",i),i.cancel)return;var r=this.parent.createElement("input",{id:this.parent.element.id+"_rename_input",className:"e-input e-sheet-rename",styles:"width: "+t.getBoundingClientRect().width+"px",attrs:{type:"text",name:"Rename",required:"",value:e,spellcheck:"false",maxlength:"31"}});t.firstElementChild.style.display="none",t.appendChild(r),a.bi.add(document,"mousedown touchstart",this.renameInputFocusOut,this),a.bi.add(r,"input",this.updateWidth,this),r.focus(),r.setSelectionRange(0,e.length),a.bi.remove((0,a.oq)(t,".e-toolbar-items"),"dblclick",this.renameSheetTab)}},o.prototype.updateWidth=function(t){var e=t.target,i=e.value.length,r=e.value.split(" ");if(r.length){var n=r.length-1;i-=n,i+=n*.5}e.style.width=i+"ch"},o.prototype.renameInputFocusOut=function(t){var e=t.target;if(!((t.type==="mousedown"||t.type==="touchstart")&&(e.classList.contains("e-sheet-rename")||(0,a.oq)(e,".e-dlg-container")))){if(e=document.getElementById(this.parent.element.id+"_rename_input"),t.type==="keydown"&&t.keyCode===27){this.removeRenameInput(e),we(this.parent.element);return}var i=e.value,r=this.parent.serviceLocator.getService(Ve);if(i){var n=this.tabInstance.selectedItem;if(i.match(new RegExp(".*[\\[\\]\\*\\\\/\\?].*")))this.showRenameDialog(e,r.getConstant("SheetRenameInvalidAlert"));else{if(this.parent.sheets[n].name!==i){for(var s=0,l=this.parent.sheets.length;s<l;s++)if(s!==this.parent.activeSheetIndex&&this.parent.sheets[s].name.toLowerCase()===i.toLowerCase()){this.showRenameDialog(e,r.getConstant("SheetRenameAlreadyExistsAlert"));return}}var h=this.removeRenameInput(e);this.parent.sheets[n].name!==i&&(this.parent.setSheetPropertyOnMute(this.parent.sheets[n],"name",i),this.updateSheetName({value:i,idx:n,items:h})),(t.type==="keydown"||(0,a.oq)(t.target,".e-spreadsheet"))&&we(this.parent.element)}}else this.showRenameDialog(e,r.getConstant("SheetRenameEmptyAlert"));this.parent.notify(E.Av,{eventArgs:{index:this.parent.getActiveSheet().id,value:i},action:"renameSheet"})}},o.prototype.updateSheetName=function(t){var e=this.tabInstance.items[t.idx].header.text.replace(/&lt;/g,"<").replace(/&gt;/g,">"),i=t.value.replace(/</g,"&lt;").replace(/>/g,"&gt;");this.tabInstance.items[t.idx].header.text=i,this.dropDownInstance.items[t.idx].text=i,this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0),t.items.children[t.idx+1].querySelector(".e-tab-text").textContent="",t.items.children[t.idx+1].querySelector(".e-tab-text").appendChild(document.createTextNode(t.value)),t.value.indexOf("  ")>-1?this.tabInstance.setProperties({items:this.tabInstance.items},!0):this.tabInstance.dataBind(),this.parent.notify(pe.B7N,{action:"renameUpdation",value:t.value,pName:e})},o.prototype.hideSheet=function(t){var e={action:"hideSheet",eventArgs:{sheetIndex:t.sheetIndex,cancel:!1}};t.triggerEvent&&(this.parent.notify(w.ya2,e),e.eventArgs.cancel)||(this.parent.setSheetPropertyOnMute((0,w.zfV)(this.parent,t.sheetIndex),"state","Hidden"),this.tabInstance.hideTab(t.sheetIndex),t.triggerEvent&&(delete e.eventArgs.cancel,this.parent.notify(E.Av,e)))},o.prototype.removeRenameInput=function(t){var e=t.parentElement.querySelector(".e-tab-text"),i=(0,a.oq)(t,".e-toolbar-items");return a.bi.add(i,"dblclick",this.renameSheetTab,this),a.bi.remove(document,"mousedown touchstart",this.renameInputFocusOut),a.bi.remove(t,"input",this.updateWidth),(0,a.Od)(t),e.style.display="",i},o.prototype.showRenameDialog=function(t,e){var i=this,r=this.parent.serviceLocator.getService(Yt);r.show({target:document.getElementById(this.parent.element.id+"_sheet_panel"),height:180,width:400,isModal:!0,showCloseIcon:!0,content:e,beforeOpen:function(n){var s={dialogName:"SheetRenameDialog",element:n.element,target:n.target,cancel:n.cancel};i.parent.trigger("dialogBeforeOpen",s),s.cancel&&(n.cancel=!0),t.focus()},close:function(){return t.setSelectionRange(0,t.value.length)}})},o.prototype.focusRenameInput=function(){var t=document.getElementById(this.parent.element.id+"_rename_input");t&&t.focus()},o.prototype.removeSheetTab=function(t){var e=this;if(!(t.count&&t.count===this.parent.sheets.length)){var i=this.parent.serviceLocator.getService(Ve);if(this.skipHiddenSheets()>1){var r=t.sheetName?(0,w.zfV)(this.parent,(0,w.Q8D)(this.parent,t.sheetName)):this.parent.getActiveSheet(),n=(0,a.le)(t.index)?(0,w.Q8D)(this.parent,r.name):t.index,s={index:n,sheetCount:this.parent.sheets.length,sheetName:r.name},l=r.rows&&r.rows.length?r.rows.length===1?!!(r.rows[0].cells&&r.rows[0].cells.length):!0:!1;if(l){var h=this.parent.serviceLocator.getService(Yt);t.clicked?this.forceDelete(n):h.show({height:200,width:400,isModal:!0,showCloseIcon:!0,cssClass:"e-delete-sheet-dlg",content:i.getConstant("DeleteSheetAlert"),beforeOpen:function(c){var u={dialogName:"DeleteSheetDialog",element:c.element,target:c.target,cancel:c.cancel};e.parent.trigger("dialogBeforeOpen",u),u.cancel&&(c.cancel=!0),we(e.parent.element)},buttons:[{buttonModel:{content:i.getConstant("Ok"),isPrimary:!0},click:function(){h.hide(),e.forceDelete(n),e.parent.notify(E.V9,null),t&&!t.isAction&&(s.sheetCount=e.parent.sheets.length,e.parent.notify(E.Av,{eventArgs:s,action:"removeSheet"}))}}]})}else this.parent.notify(pe.B7N,{action:"deleteSheetTab",sheetId:(0,w.zfV)(this.parent,n).id}),this.destroySheet(n),this.parent.notify(E.V9,null),t&&!t.isAction&&(s.sheetCount=this.parent.sheets.length,this.parent.notify(E.Av,{eventArgs:s,action:"removeSheet"}))}else this.parent.serviceLocator.getService(Yt).show({target:document.getElementById(this.parent.element.id+"_sheet_panel"),height:180,width:400,isModal:!0,showCloseIcon:!0,content:i.getConstant("DeleteSingleLastSheetAlert"),beforeOpen:function(c){var u={dialogName:"DeleteSingleSheetDialog",element:c.element,target:c.target,cancel:c.cancel};e.parent.trigger("dialogBeforeOpen",u),u.cancel&&(c.cancel=!0),we(e.parent.element)}})}},o.prototype.forceDelete=function(t){this.parent.notify(E.k3,{}),this.parent.notify(pe.B7N,{action:"deleteSheetTab",sheetId:(0,w.zfV)(this.parent,t).id}),this.destroySheet(t)},o.prototype.destroySheet=function(t){var e=(0,a.le)(t)?this.parent.activeSheetIndex:t;this.parent.removeSheet(e),this.parent.notify(pe.Iap,{sheetIndex:e}),this.dropDownInstance.items.splice(e,1),this.dropDownInstance.setProperties({items:this.dropDownInstance.items},!0),this.tabInstance.removeTab(e);var i=this.parent.skipHiddenSheets(this.tabInstance.selectedItem);this.parent.activeSheetIndex=i,this.parent.setProperties({activeSheetIndex:i},!0),this.parent.renderModule.refreshSheet(),this.tabInstance.selectedItem=i,this.tabInstance.dataBind(),this.updateDropDownItems(i),this.parent.notify(E.Vm,null),we(this.parent.element)},o.prototype.showAggregate=function(){var t=this;if(!(0,w.hYl)((0,w.dK5)(this.parent.getActiveSheet().selectedRange))){var e={Count:0,Sum:"0",Avg:"0",Min:"0",Max:"0",countOnly:!0};if(this.parent.notify(w.Ai5,e),e.Count>1){this.aggregateContent=e.countOnly?"Count":this.selaggregateCnt,e.countOnly&&(this.aggregateContent="Count",delete e.Sum,delete e.Avg,delete e.Min,delete e.Max);var i=e.countOnly?"e-aggregate-list e-flat e-aggregate-list-countonly e-caret-hide":"e-aggregate-list e-flat";delete e.countOnly;var r=this.aggregateContent,n=r+": "+e[r];if(this.aggregateDropDown)this.updateAggregateContent(n,e);else{var s=this.parent.createElement("button",{id:this.parent.element.id+"_aggregate"});document.getElementById(this.parent.element.id+"_sheet_tab_panel").appendChild(s),this.aggregateDropDown=new Bi({content:n,items:this.getAggregateItems(e),createPopupOnClick:!0,select:function(l){t.parent.notify(w.Ai5,e),t.updateAggregateContent(l.item.text,{Count:e.Count,Sum:e.Sum,Avg:e.Avg,Min:e.Min,Max:e.Max},!0)},beforeOpen:function(l){return t.beforeOpenHandler(t.aggregateDropDown,l.element)},open:function(l){return t.openHandler(t.aggregateDropDown,l.element,"right")},close:function(){return we(t.parent.element)},cssClass:i}),this.aggregateDropDown.createElement=this.parent.createElement,this.aggregateDropDown.appendTo(s)}}else this.removeAggregate()}},o.prototype.getAggregateItems=function(t){var e=this,i=[],r,n;return Object.keys(t).forEach(function(s){t[s]!==w.Ai5&&(r=s+": "+t[s],n=s===e.aggregateContent?"e-selected-icon e-icons":"",i.push({text:r,iconCss:n}))}),i},o.prototype.updateAggregateContent=function(t,e,i){this.aggregateContent=t.split(": ")[0],i&&(this.selaggregateCnt=t.split(": ")[0]),this.aggregateDropDown.content=t,this.aggregateDropDown.dataBind(),this.aggregateDropDown.setProperties({items:this.getAggregateItems(e)},!0)},o.prototype.removeAggregate=function(){(0,a.le)(this.aggregateDropDown)||(this.aggregateDropDown.destroy(),(0,a.Od)(this.aggregateDropDown.element),this.aggregateDropDown=null)},o.prototype.addEventListener=function(){this.parent.on(E.LA,this.createSheetTabs,this),this.parent.on(E.$c,this.refreshSheetTab,this),this.parent.on(E.CX,this.insertSheetTab,this),this.parent.on(E.Lh,this.removeSheetTab,this),this.parent.on(E.Xd,this.renameSheetTab,this),this.parent.on(E.MX,this.switchSheetTab,this),this.parent.on(E.Z,this.updateSheetTab,this),this.parent.on(E.Oe,this.renameInputFocusOut,this),this.parent.on(pe.q6q,this.removeAggregate,this),this.parent.on(E.oS,this.focusRenameInput,this),this.parent.on(E.iI,this.focusRenameInput,this),this.parent.on(E.ej,this.updateSheetName,this),this.parent.on(E.oR,this.hideSheet,this),this.parent.on(E.I4,this.showAggregate,this),this.parent.on(E.lA,this.goToSheet,this),this.parent.on(E.Rp,this.showSheet,this)},o.prototype.destroy=function(){this.removeEventListener(),this.dropDownInstance.destroy(),this.dropDownInstance=null,this.tabInstance.destroy(),this.tabInstance=null,this.removeAggregate(),this.aggregateContent=null,this.addBtnRipple(),this.addBtnRipple=null,a.bi.remove(document,"mousedown touchstart",this.renameInputFocusOut);var t=document.getElementById(this.parent.element.id+"_sheet_tab_panel");t&&(0,a.Od)(t),this.parent=null},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.LA,this.createSheetTabs),this.parent.off(E.$c,this.refreshSheetTab),this.parent.off(E.CX,this.insertSheetTab),this.parent.off(E.Lh,this.removeSheetTab),this.parent.off(E.Xd,this.renameSheetTab),this.parent.off(E.MX,this.switchSheetTab),this.parent.off(E.Z,this.updateSheetTab),this.parent.off(E.Oe,this.renameInputFocusOut),this.parent.off(pe.q6q,this.removeAggregate),this.parent.off(E.oS,this.focusRenameInput),this.parent.off(E.iI,this.focusRenameInput),this.parent.off(E.ej,this.updateSheetName),this.parent.off(E.oR,this.hideSheet),this.parent.off(E.I4,this.showAggregate),this.parent.off(E.lA,this.goToSheet),this.parent.off(E.Rp,this.showSheet))},o}(),Yp=function(){function o(t){this.isImportedFile=!1,this.unProtectSheetIdx=[],this.parent=t,this.addEventListener(),this.renderFileUpload()}return o.prototype.addEventListener=function(){this.parent.on(w.jJC,this.openSuccess,this),this.parent.on(w.zcH,this.openFailed,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(w.jJC,this.openSuccess),this.parent.off(w.zcH,this.openFailed))},o.prototype.renderFileUpload=function(){var t=this.parent.element.id+"_fileUpload";this.parent.element.appendChild(this.parent.createElement("input",{id:t,attrs:{type:"file",accept:".xls, .xlsx, .csv, .xlsm",name:"fileUpload"}}));var e=document.getElementById(t);e.onchange=this.fileSelect.bind(this),e.onerror=this.openFailed.bind(this),e.style.display="none"},o.prototype.fileSelect=function(t){var e=t.target.files[0];if(!(e&&e.length<1)){var i={file:e};this.parent.open(i),document.getElementById(this.parent.element.id+"_fileUpload").value=""}},o.prototype.openSuccess=function(t){var e=this,i=["UnsupportedFile","InvalidUrl","NeedPassword","InCorrectPassword","InCorrectSheetPassword","CorrectSheetPassword"];if(i.indexOf(t.data)>-1)if(i[2]===t.data)this.parent.element.querySelector(".e-importprotectworkbook-dlg")||this.parent.notify(E.wq,t.eventArgs);else if(i[3]===t.data){var r=this.parent.serviceLocator.getService(Ve),n=this.parent.createElement("span",{className:"e-importprotectpwd-alert-span",innerHTML:r.getConstant("InCorrectPassword")});this.parent.element.querySelector(".e-importprotectworkbook-dlg").querySelector(".e-dlg-content").appendChild(n)}else if(i[4]===t.data){var r=this.parent.serviceLocator.getService(Ve),n=this.parent.createElement("span",{className:"e-unprotectsheetpwd-alert-span",innerHTML:r.getConstant("InCorrectPassword")});this.parent.element.querySelector(".e-unprotectworksheet-dlg").querySelector(".e-dlg-content").appendChild(n)}else if(i[5]===t.data){this.parent.isOpen=!1,this.parent.notify(E.z2,null);var s=this.parent.serviceLocator.getService(Yt);s.hide(),this.parent.hideSpinner()}else{var s=this.parent.serviceLocator.getService(Yt);s.hide(),this.parent.serviceLocator.getService(Yt).show({content:this.parent.serviceLocator.getService("spreadsheetLocale").getConstant(t.data),width:"300",beforeOpen:function(h){var c={dialogName:"OpenDialog",element:h.element,target:h.target,cancel:h.cancel};e.parent.trigger("dialogBeforeOpen",c),c.cancel&&(h.cancel=!0)}}),this.parent.hideSpinner();return}else{var s=this.parent.serviceLocator.getService(Yt);s.hide(),this.parent.showSpinner()}!this.parent.element||i[5]!==t.data&&(t.isOpenFromJson||(this.parent.trigger("openComplete",{response:t}),this.parent.notify(E.Av,{response:t,action:"import"})),this.parent.notify(w.fdW,{cellRef:null,isOpen:!0}),this.parent.renderModule.refreshSheet(t.isOpenFromJson),this.parent.notify(E.$c,this),this.isImportedFile=!0,this.unProtectSheetIdx=[],this.parent.hideSpinner())},o.prototype.openFailed=function(t){this.parent.trigger("openFailure",t),this.parent.hideSpinner()},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"open"},o}(),Gp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(ot.bC,this.initiateSave,this),this.parent.on(ot.Dw,this.saveCompleted,this),this.parent.on(ot.cE,this.showErrorDialog,this),this.parent.on(ot.Ts,this.exportDialog,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ot.bC,this.initiateSave),this.parent.off(ot.Dw,this.saveCompleted),this.parent.off(ot.cE,this.showErrorDialog),this.parent.off(ot.Ts,this.exportDialog))},o.prototype.getModuleName=function(){return"save"},o.prototype.initiateSave=function(){this.parent.showSpinner()},o.prototype.saveCompleted=function(){this.parent.hideSpinner()},o.prototype.showErrorDialog=function(t){var e=this,i=this.parent.serviceLocator.getService(Yt);i.show({target:this.parent.element,isModal:!0,showCloseIcon:!0,height:180,width:400,content:t.content,beforeOpen:function(){return we(e.parent.element)}})},o.prototype.exportDialog=function(t){var e=this,i=this.parent.serviceLocator.getService(Ve),r=this.parent.serviceLocator.getService(Yt),n=t?t.item.id.split(this.parent.element.id+"_")[1]:"xlsx";if((0,a.le)(this.parent.element.querySelector(".e-find-dlg"))){var s={isModal:!0,showCloseIcon:!0,cssClass:"e-open-dlg",allowDragging:!1,header:i.getConstant("SaveAs"),beforeOpen:function(l){var h={dialogName:i.getConstant("SaveAs"),element:l.element,target:l.target,cancel:l.cancel};e.parent.trigger("dialogBeforeOpen",h),h.cancel&&(l.cancel=!0),r.dialogInstance.content=e.OpenContent(n),r.dialogInstance.dataBind(),e.parent.element.querySelector(".e-text-open").setSelectionRange(0,e.parent.element.querySelector(".e-text-open").value.length),we(e.parent.element)},buttons:[{buttonModel:{content:i.getConstant("Save"),isPrimary:!0,cssClass:"e-btn-open-ok"},click:function(){var l=e.parent.element.querySelector(".e-text-open").value;if(e.checkValidName(l)){r.hide();var h=t?t.item.id.split(e.parent.element.id+"_")[1]:"Xlsx";e.parent.save({saveType:h,fileName:l})}else{var c=e.parent.element.querySelector(".e-btn-open-ok"),u=(0,a.Xr)(c,"btn");u.disabled=!0;var p=e.parent.serviceLocator.getService(Ve),f=l.length===0?p.getConstant("EmptyFileName"):l.length>218?p.getConstant("LargeName"):p.getConstant("FileNameError"),g=e.parent.createElement("span",{className:"e-file-alert-span",innerHTML:f});e.parent.element.querySelector(".e-file-alert-span")&&e.parent.element.querySelector(".e-file-alert-span").remove(),e.parent.element.querySelector(".e-open-dlg").querySelector(".e-dlg-content").appendChild(g)}}}],close:function(){r.hide()}};r.show(s)}else r.hide()},o.prototype.checkValidName=function(t){var e=!0;return(t.match(new RegExp('.*[\\[\\]\\*\\\\/\\?\\:\\<\\>\\|\\"].*'))||t.length<1||t.length>218)&&(e=!1),e},o.prototype.OpenContent=function(t){var e=this,i=this.parent.serviceLocator.getService(Ve),r=this.parent.createElement("div",{className:"e-open-dialog"}),n=this.parent.createElement("div",{className:"e-open-head"}),s=this.parent.createElement("div",{className:"e-input-group"});r.appendChild(n),r.appendChild(s);var l=this.parent.createElement("p",{className:"e-header",innerHTML:i.getConstant("FileName")}),h=this.parent.createElement("input",{className:"e-input e-text-open",attrs:{type:"Text"}}),c=this.parent.createElement("span",{className:"e-input-group-icon"});return h.onkeyup=function(u){if(e.parent.element.querySelector(".e-file-alert-span")&&u.keyCode!==13){var p=e.parent.element.querySelector(".e-btn-open-ok"),f=(0,a.Xr)(p,"btn");f.disabled=!1,e.parent.element.querySelector(".e-file-alert-span").remove()}},n.appendChild(l),c.textContent="."+t.toLowerCase(),s.appendChild(h),h.setAttribute("value","Sample"),s.appendChild(c),r},o}(),zC=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Wh=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},im=function(o){zC(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){this.isMenu=!1,this.element.id=this.element.id||(0,a.QI)("ej2-contextmenu"),o.prototype.preRender.call(this)},t.prototype.initialize=function(){o.prototype.initialize.call(this),(0,a.Y4)(this.element,{role:"menubar",tabindex:"0"}),this.element.style.zIndex=cn(this.element).toString()},t.prototype.open=function(e,i,r){o.prototype.openMenu.call(this,null,null,e,i,null,r)},t.prototype.close=function(){o.prototype.closeMenu.call(this)},t.prototype.onPropertyChanged=function(e,i){o.prototype.onPropertyChanged.call(this,e,i);for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"filter":this.close(),this.filter=e.filter;break;case"target":this.unWireEvents(i.target),this.wireEvents();break}}},t.prototype.getModuleName=function(){return"contextmenu"},Wh([(0,a.Z9)("")],t.prototype,"target",void 0),Wh([(0,a.Z9)("")],t.prototype,"filter",void 0),Wh([(0,a.FE)([],Ko)],t.prototype,"items",void 0),t=Wh([a.Zl],t),t}(wv),rm=function(){function o(t){this.parent=t,this.init()}return o.prototype.init=function(){this.initContextMenu(),this.addEventListener()},o.prototype.initContextMenu=function(){var t=document.createElement("ul");t.id=this.parent.element.id+"_contextmenu",this.parent.element.appendChild(t),this.contextMenuInstance=new im({cssClass:"e-spreadsheet-contextmenu",target:"#"+this.parent.element.id,filter:"e-numericcontainer e-active-cell e-selection e-row e-header-row e-select-all-cell e-sheet-tabs-items",select:this.selectHandler.bind(this),beforeOpen:this.beforeOpenHandler.bind(this),beforeClose:this.beforeCloseHandler.bind(this)},t)},o.prototype.beforeCloseHandler=function(t){this.parent.trigger("contextMenuBeforeClose",t)},o.prototype.selectHandler=function(t){var e=(0,a.l7)({cancel:!1},t);this.parent.trigger("contextMenuItemSelect",e);var i=this.parent.element.id+"_cmenu",r,n,s;if(!e.cancel){var l=void 0;switch(t.item.id){case i+"_cut":this.parent.notify(E.z7,{invokeCopy:!0,promise:Promise});break;case i+"_copy":this.parent.notify(E.JG,{invokeCopy:!0,promise:Promise});break;case i+"_paste":this.parent.notify(E.v,{isAction:!0,isInternal:!0});break;case i+"_pastevalues":this.parent.notify(E.v,{type:"Values",isAction:!0,isInternal:!0});break;case i+"_pasteformats":this.parent.notify(E.v,{type:"Formats",isAction:!0,isInternal:!0});break;case i+"_rename":this.parent.notify(E.Xd,{});break;case i+"_delete_sheet":this.parent.notify(E.Lh,{});break;case i+"_insert_sheet":this.parent.notify(pe.IQJ,{model:this.parent,start:this.parent.activeSheetIndex,end:this.parent.activeSheetIndex,modelType:"Sheet",isAction:!0,activeSheetIndex:this.parent.activeSheetIndex});break;case i+"_hide_sheet":this.parent.notify(E.oR,{sheetIndex:this.parent.activeSheetIndex,triggerEvent:!0});break;case i+"_duplicate":(0,w.tNt)(this.parent,void 0,!0);break;case i+"_move_right":(0,w.j1e)(this.parent,this.parent.activeSheetIndex+1,null,!0);break;case i+"_move_left":(0,w.j1e)(this.parent,this.parent.activeSheetIndex-1,null,!0);break;case i+"_ascending":this.parent.notify(E.vy,null);break;case i+"_descending":this.parent.notify(E.vy,{sortOptions:{sortDescriptors:{order:"Descending"}}});break;case i+"_customsort":this.parent.notify(E.HR,null);break;case i+"_filtercellvalue":this.parent.notify(E.FA,null);break;case i+"_clearfilter":r=(0,pe.AH9)((0,pe.n53)(this.parent.getActiveSheet().activeCell)[1]+1),this.parent.notify(E.Dg,{field:r});break;case i+"_reapplyfilter":this.parent.notify(E.Zh,null);break;case i+"_hide_row":l=(0,pe.dK5)(this.parent.getActiveSheet().selectedRange),this.parent.notify(w.wtl,{startIndex:l[0],endIndex:l[2],hide:!0,isCol:!1,actionUpdate:!0}),we(this.parent.element);break;case i+"_unhide_row":l=(0,pe.dK5)(this.parent.getActiveSheet().selectedRange),this.parent.notify(w.wtl,{startIndex:l[0],endIndex:l[2],hide:!1,isCol:!1,actionUpdate:!0}),we(this.parent.element);break;case i+"_hide_column":l=(0,pe.dK5)(this.parent.getActiveSheet().selectedRange),this.parent.notify(w.wtl,{startIndex:l[1],endIndex:l[3],hide:!0,isCol:!0,actionUpdate:!0}),we(this.parent.element);break;case i+"_unhide_column":l=(0,pe.dK5)(this.parent.getActiveSheet().selectedRange),this.parent.notify(w.wtl,{startIndex:l[1],endIndex:l[3],hide:!1,isCol:!0,actionUpdate:!0}),we(this.parent.element);break;case i+"_insert_row_above":case i+"_delete_row":l=(0,pe.dK5)(this.parent.getActiveSheet().selectedRange),this.parent.notify(t.item.id.substr(i.length+1,6)+"Model",{model:this.parent.getActiveSheet(),start:l[0],end:l[2],modelType:"Row",isAction:!0,insertType:"above"}),we(this.parent.element);break;case i+"_insert_row_below":l=(0,w.gaE)((0,pe.dK5)(this.parent.getActiveSheet().selectedRange)),this.parent.notify(pe.IQJ,{model:this.parent.getActiveSheet(),start:l[2]+1,end:l[2]+1+(l[2]-l[0]),modelType:"Row",isAction:!0,insertType:"below"}),we(this.parent.element);break;case i+"_insert_column_before":case i+"_delete_column":l=(0,pe.dK5)(this.parent.getActiveSheet().selectedRange),this.parent.notify(t.item.id.substr(i.length+1,6)+"Model",{model:this.parent.getActiveSheet(),start:l[1],end:l[3],modelType:"Column",isAction:!0,insertType:"before"}),we(this.parent.element);break;case i+"_insert_column_after":l=(0,w.gaE)((0,pe.dK5)(this.parent.getActiveSheet().selectedRange)),this.parent.notify(pe.IQJ,{model:this.parent.getActiveSheet(),start:l[3]+1,end:l[3]+1+(l[3]-l[1]),modelType:"Column",isAction:!0,insertType:"after"}),we(this.parent.element);break;case i+"_hyperlink":this.parent.notify(E.tW,null);break;case i+"_editHyperlink":this.parent.notify(E.qP,null);break;case i+"_openHyperlink":this.parent.notify(E.IO,null);break;case i+"_removeHyperlink":this.parent.notify(E.Th,{range:this.parent.getActiveSheet().selectedRange});break;case i+"_protect":n=this.parent.getActiveSheet(),n.isProtected&&n.password&&n.password.length>0?this.parent.notify(E.z1,null):(this.parent.setSheetPropertyOnMute(n,"isProtected",!n.isProtected),s=!n.isProtected,this.parent.notify(E.Oj,{isActive:s,sheetIndex:this.parent.activeSheetIndex,triggerEvent:!0}));break}}},o.prototype.getInsertModel=function(t,e){for(var i=[],r=t;r<=e;r++)r===t?i.push({index:r}):i.push({});return i},o.prototype.beforeOpenHandler=function(t){var e=t.event.target,i=this.getTarget(e),r;if(t.element.classList.contains("e-contextmenu")){var n=this.parent.getActiveSheet();if(t.event.target&&(e.classList.contains("e-rowresize")||e.classList.contains("e-colresize"))){var s=(0,pe.dK5)(n.selectedRange);if(!(e.classList.contains("e-rowresize")?s[1]===0&&s[3]===n.colCount-1:s[0]===0&&s[2]===n.rowCount-1)){t.cancel=!0;return}(e.classList.contains("e-rowresize")?this.parent.hiddenCount(s[0],s[2])!==Math.abs(s[2]-s[0])+1:this.parent.hiddenCount(s[1],s[3],"columns")!==Math.abs(s[3]-s[1])+1)?r=this.getDataSource(i):r=this.getDataSource(i,e)}else{if(i==="Content"){var s=(0,pe.dK5)(n.selectedRange),l=s[1]===0&&s[3]===n.colCount-1,h=s[0]===0&&s[2]===n.rowCount-1;i=l&&h?"SelectAll":l?"RowHeader":h?"ColumnHeader":"Content"}r=this.getDataSource(i)}this.contextMenuInstance.items=r,this.contextMenuInstance.dataBind()}else r=t.items;if(i==="ColumnHeader"||i==="RowHeader"){if(t.element&&t.element.childElementCount>0){var c=i==="ColumnHeader"?t.element.querySelector("#"+this.parent.element.id+"_cmenu_insert_column"):t.element.querySelector("#"+this.parent.element.id+"_cmenu_insert_row"),u=i==="ColumnHeader"?t.element.querySelector("#"+this.parent.element.id+"_cmenu_delete_column"):t.element.querySelector("#"+this.parent.element.id+"_cmenu_delete_row");this.parent.allowInsert&&c.classList.contains("e-disabled")?c.classList.remove("e-disabled"):(!this.parent.allowInsert||!!this.parent.element.querySelector(".e-selectall.e-highlight"))&&!c.classList.contains("e-disabled")&&c.classList.add("e-disabled"),this.parent.allowDelete&&u.classList.contains("e-disabled")?u.classList.remove("e-disabled"):!this.parent.allowDelete&&!u.classList.contains("e-disabled")&&u.classList.add("e-disabled")}}else if(i==="Footer"){var p=(0,w.Q8D)(this.parent,e.textContent);p===0&&t.element.querySelector("#"+this.parent.element.id+"_cmenu_move_left").classList.add("e-disabled"),p===this.parent.sheets.length-1&&t.element.querySelector("#"+this.parent.element.id+"_cmenu_move_right").classList.add("e-disabled")}this.parent.trigger("contextMenuBeforeOpen",t),this.parent.notify(E.MX,(0,a.l7)(t,{target:i,items:r}))},o.prototype.getTarget=function(t){return(0,a.oq)(t,".e-sheet-content")?"Content":(0,a.oq)(t,".e-column-header")?t.classList.contains("e-header-cell")?"ColumnHeader":"Content":(0,a.oq)(t,".e-row-header")?t.classList.contains("e-header-cell")?"RowHeader":"Content":(0,a.oq)(t,".e-sheet-tabs-items")?"Footer":(0,a.oq)(t,".e-selectall-container")?t.classList.contains("e-header-cell")?(0,a.oq)(t,".e-header-row")?"ColumnHeader":"RowHeader":(0,a.oq)(t,".e-select-all-cell")?"SelectAll":"Content":""},o.prototype.getDataSource=function(t,e){var i=this.parent.serviceLocator.getService(Ve),r=[],n=this.parent.element.id+"_cmenu";if(t==="Content")this.setClipboardData(r,i,n),r.push({separator:!0}),this.setFilterItems(r,n),this.setSortItems(r,n),r.push({separator:!0}),this.setHyperLink(r,n);else if(t==="RowHeader"){this.setClipboardData(r,i,n);var s=this.parent.getActiveSheet(),l=(0,pe.dK5)(s.selectedRange);this.setInsertDeleteItems(r,i,"Row",n,[l[0],l[2]],["Above","Below"]),(!e||e.classList.contains("e-rowresize")||!e.parentElement||!e.parentElement.classList.value.includes("e-hide"))&&this.setHideShowItems(r,i,"Row",n,[l[0],l[2]])}else if(t==="ColumnHeader"){this.setClipboardData(r,i,n);var s=this.parent.getActiveSheet(),l=(0,pe.dK5)(s.selectedRange);this.setInsertDeleteItems(r,i,"Column",n,[l[1],l[3]],["Before","After"]),(!e||!e.classList.value.includes("e-hide"))&&this.setHideShowItems(r,i,"Column",n,[l[1],l[3]])}else t==="SelectAll"?(this.setClipboardData(r,i,n),this.setFilterItems(r,n),this.setSortItems(r,n)):t==="Footer"&&(r.push({text:i.getConstant("Insert"),id:n+"_insert_sheet"}),r.push({text:i.getConstant("Delete"),iconCss:"e-icons e-delete",id:n+"_delete_sheet"}),r.push({text:i.getConstant("DuplicateSheet"),id:n+"_duplicate"}),r.push({text:i.getConstant("Rename"),id:n+"_rename"}),r.push({text:i.getConstant("Hide"),id:n+"_hide_sheet"}),this.setProtectSheetItems(r,n),r.push({text:i.getConstant("MoveRight"),id:n+"_move_right"}),r.push({text:i.getConstant("MoveLeft"),id:n+"_move_left"}));return r},o.prototype.setProtectSheetItems=function(t,e){var i=this.parent.serviceLocator.getService(Ve);this.parent.getActiveSheet().isProtected?t.push({text:i.getConstant("UnprotectSheet"),id:e+"_protect",iconCss:"e-icons e-protect-icon"}):t.push({text:i.getConstant("ProtectSheet"),id:e+"_protect",iconCss:"e-icons e-protect-icon"})},o.prototype.setFilterItems=function(t,e){if(this.parent.allowFiltering){var i=this.parent.serviceLocator.getService(Ve),r={clearFilterText:null,isFiltered:!1};this.parent.notify(E.I2,r),t.push({text:i.getConstant("Filter"),id:e+"_filter",iconCss:"",items:[{text:r.clearFilterText,iconCss:"e-icons e-filter-clear",id:e+"_clearfilter"},{text:i.getConstant("ReapplyFilter"),iconCss:"e-icons e-filter-reapply",id:e+"_reapplyfilter"},{separator:!0},{text:i.getConstant("FilterCellValue"),iconCss:"",id:e+"_filtercellvalue"}]})}},o.prototype.setSortItems=function(t,e){var i=this.parent.serviceLocator.getService(Ve);this.parent.allowSorting&&t.push({text:i.getConstant("Sort"),id:e+"_sort",iconCss:"e-icons e-sort-icon",items:[{text:i.getConstant("SortAscending"),iconCss:"e-icons e-sort-asc",id:e+"_ascending"},{text:i.getConstant("SortDescending"),iconCss:"e-icons e-sort-desc",id:e+"_descending"},{text:i.getConstant("CustomSort")+"...",iconCss:"e-icons e-sort-custom",id:e+"_customsort"}]})},o.prototype.setHyperLink=function(t,e){var i=this.parent.getActiveSheet();if(this.parent.allowHyperlink){var r=this.parent.serviceLocator.getService(Ve);!document.activeElement.getElementsByClassName("e-hyperlink")[0]&&!document.activeElement.classList.contains("e-hyperlink")||i.isProtected&&!i.protectSettings.insertLink?t.push({text:r.getConstant("Hyperlink"),iconCss:"e-icons e-hyperlink-icon",id:e+"_hyperlink"}):t.push({text:r.getConstant("EditHyperlink"),iconCss:"e-icons e-edithyperlink-icon",id:e+"_editHyperlink"},{text:r.getConstant("OpenHyperlink"),iconCss:"e-icons e-openhyperlink-icon",id:e+"_openHyperlink"},{text:r.getConstant("RemoveHyperlink"),iconCss:"e-icons e-removehyperlink-icon",id:e+"_removeHyperlink"})}},o.prototype.setClipboardData=function(t,e,i){this.parent.enableClipboard&&(t.push({text:e.getConstant("Cut"),iconCss:"e-icons e-cut-icon",id:i+"_cut"}),t.push({text:e.getConstant("Copy"),iconCss:"e-icons e-copy-icon",id:i+"_copy"}),t.push({text:e.getConstant("Paste"),iconCss:"e-icons e-paste-icon",id:i+"_paste"}),t.push({text:e.getConstant("PasteSpecial"),id:i+"_pastespecial",items:[{text:e.getConstant("Values"),id:i+"_pastevalues"},{text:e.getConstant("Formats"),id:i+"_pasteformats"}]}))},o.prototype.setInsertDeleteItems=function(t,e,i,r,n,s){t.push({separator:!0}),["Insert","Delete"].forEach(function(l){n[0]===n[1]?t.push({text:e.getConstant(""+l+i),id:r+("_"+l.toLowerCase()+"_"+i.toLowerCase())}):t.push({text:e.getConstant(""+l+i+"s"),id:r+("_"+l.toLowerCase()+"_"+i.toLowerCase())}),l==="Insert"&&(t[t.length-1].items=[],s.forEach(function(h){t[t.length-1].items.push({text:e.getConstant(h),id:t[t.length-1].id+"_"+h.toLowerCase()})}))})},o.prototype.setHideShowItems=function(t,e,i,r,n){if(n[0]===n[1])t.push({text:e.getConstant("Hide"+i),id:r+("_hide_"+i.toLowerCase())});else{var s=n[0];n[0]=n[0]>n[1]?n[1]:n[0],n[1]=n[1]>s?n[1]:s,t.push({text:e.getConstant("Hide"+i+"s"),id:r+("_hide_"+i.toLowerCase())})}this.parent.hiddenCount(n[0],n[1],i.toLowerCase()+"s")&&t.push({text:e.getConstant("UnHide"+i+"s"),id:r+("_unhide_"+i.toLowerCase())})},o.prototype.addEventListener=function(){this.parent.on(E.SF,this.addItemsHandler,this),this.parent.on(E.vG,this.removeItemsHandler,this),this.parent.on(E.fL,this.enableItemsHandler,this)},o.prototype.addItemsHandler=function(t){t.insertAfter?this.contextMenuInstance.insertAfter(t.items,t.text,t.isUniqueId):this.contextMenuInstance.insertBefore(t.items,t.text,t.isUniqueId)},o.prototype.removeItemsHandler=function(t){this.contextMenuInstance.removeItems(t.items,t.isUniqueId)},o.prototype.enableItemsHandler=function(t){this.contextMenuInstance.enableItems(t.items,t.enable,t.isUniqueId)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.SF,this.addItemsHandler),this.parent.off(E.vG,this.removeItemsHandler),this.parent.off(E.fL,this.enableItemsHandler))},o.prototype.getModuleName=function(){return"contextMenu"},o.prototype.destroy=function(){this.removeEventListener(),this.contextMenuInstance.destroy();var t=document.getElementById(this.parent.element.id+"_contextmenu");t&&(0,a.og)(t),this.parent=null},o}(),Kp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.refreshCellElement=function(t){var e=this.parent.getCell(t.rowIndex,t.colIndex);(0,a.le)(e)||this.parent.refreshNode(e,t)},o.prototype.getTextSpace=function(t){t.width=ht(t.char,t.cell.style,this.parent.cellStyle)},o.prototype.rowFillHandler=function(t){var e=t.td?t.td:this.parent.getCell(t.rowIdx,t.colIdx),i,r;if(e){t.formatText&&(e.innerHTML=t.formatText.toString()),t.secText&&(r=this.parent.createElement("span"),r.classList.add("e-fill-sec"),r.innerHTML=t.secText.toString()),e.children.length?i=e.querySelector(".e-fill"):(i=this.parent.createElement("span"),i.style.flexGrow="1",i.classList.add("e-fill"),e.appendChild(i),r&&e.appendChild(r)),i.innerHTML="";var n=ht(t.value.toString(),t.cell.style,this.parent.cellStyle),s=Math.round(i.offsetWidth/n);t.formatText=t.value.repeat(s),i.innerHTML=t.formatText}},o.prototype.addEventListener=function(){this.parent.on(ot.RT,this.refreshCellElement,this),this.parent.on(ot.db,this.rowFillHandler,this),this.parent.on(ot.d8,this.getTextSpace,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ot.RT,this.refreshCellElement),this.parent.off(ot.db,this.rowFillHandler),this.parent.off(ot.d8,this.getTextSpace))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"numberFormat"},o}(),_C=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),tn=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Xp="e-label",nm="e-ripple-container",$p="e-rtl",Qp="e-radio-wrapper",jC=["title","class","style","disabled","readonly","name","value"],Uh=function(o){_C(t,o);function t(i,r){var n=o.call(this,i,r)||this;return n.isFocused=!1,n}e=t,t.prototype.changeHandler=function(i){this.checked=!0,this.dataBind();var r=this.element.getAttribute("value");r=this.isVue&&r?this.element.value:this.value,this.trigger("change",{value:r,event:i}),this.tagName==="EJS-RADIOBUTTON"&&i.stopPropagation()},t.prototype.updateChange=function(){for(var i,r,n=this.getRadioGroup(),s=0;s<n.length;s++)i=n[s],i!==this.element&&(r=(0,a.s8)(i,e),r.checked=!1,this.tagName==="EJS-RADIOBUTTON"&&(r.angularValue=this.value))},t.prototype.destroy=function(){var i=this,r=this.wrapper;o.prototype.destroy.call(this),r&&(this.disabled||this.unWireEvents(),this.tagName==="INPUT"?(r.parentNode&&r.parentNode.insertBefore(this.element,r),(0,a.og)(r),this.element.checked=!1,["name","value","disabled"].forEach(function(n){i.element.removeAttribute(n)})):(["role","aria-checked","class"].forEach(function(n){r.removeAttribute(n)}),r.innerHTML=""))},t.prototype.focusHandler=function(){this.isFocused=!0},t.prototype.focusOutHandler=function(){var i=this.getLabel();i&&i.classList.remove("e-focus")},t.prototype.getModuleName=function(){return"radio"},t.prototype.getSelectedValue=function(){for(var i,r=this.getRadioGroup(),n=0,s=r.length;n<s;n++)if(i=r[n],i.checked)return i.value;return""},t.prototype.getRadioGroup=function(){return document.querySelectorAll('input.e-radio[name="'+this.element.getAttribute("name")+'"]')},t.prototype.getPersistData=function(){return this.addOnPersist(["checked"])},t.prototype.getWrapper=function(){return this.element?this.element.parentElement:null},t.prototype.getLabel=function(){return this.element?this.element.nextElementSibling:null},t.prototype.initialize=function(){(0,a.le)(this.initialCheckedValue)&&(this.initialCheckedValue=this.checked),this.initWrapper(),this.updateHtmlAttribute(),this.name&&this.element.setAttribute("name",this.name);var i=this.element.getAttribute("value");this.isVue&&i&&i===this.value&&(this.checked=!0),(this.isVue?this.value&&!i:this.value)&&this.element.setAttribute("value",this.value),this.checked&&(this.element.checked=!0),this.disabled&&this.setDisabled()},t.prototype.initWrapper=function(){var i,r=this.element.parentElement;r.classList.contains(Qp)||(r=this.createElement("div",{className:Qp}),this.element.parentNode.insertBefore(r,this.element));var n=this.createElement("label",{attrs:{for:this.element.id}});r.appendChild(this.element),r.appendChild(n),a.re&&(i=this.createElement("span",{className:nm}),n.appendChild(i),(0,a.qx)(i,{duration:400,isCenterRipple:!0})),r.classList.add("e-wrapper"),this.enableRtl&&n.classList.add($p),this.cssClass&&(0,a.cn)([r],this.cssClass.split(" ")),this.label&&this.setText(this.label)},t.prototype.keyUpHandler=function(){this.isFocused&&this.getLabel().classList.add("e-focus")},t.prototype.labelRippleHandler=function(i){var r=this.getLabel().getElementsByClassName(nm)[0];ls(i,r)},t.prototype.formResetHandler=function(){this.checked=this.initialCheckedValue,this.initialCheckedValue&&(0,a.Y4)(this.element,{checked:"true"})},t.prototype.onPropertyChanged=function(i,r){for(var n=this.getWrapper(),s=this.getLabel(),l=0,h=Object.keys(i);l<h.length;l++){var c=h[l];switch(c){case"checked":i.checked&&this.updateChange(),this.element.checked=i.checked;break;case"disabled":i.disabled?(this.setDisabled(),this.unWireEvents()):(this.element.disabled=!1,this.wireEvents());break;case"cssClass":r.cssClass&&(0,a.IV)([n],r.cssClass.split(" ")),i.cssClass&&(0,a.cn)([n],i.cssClass.split(" "));break;case"enableRtl":i.enableRtl?s.classList.add($p):s.classList.remove($p);break;case"label":this.setText(i.label);break;case"labelPosition":i.labelPosition==="Before"?s.classList.add("e-right"):s.classList.remove("e-right");break;case"name":this.element.setAttribute("name",i.name);break;case"value":if(!(0,a.le)(this.htmlAttributes)&&this.htmlAttributes.value)break;this.element.setAttribute("value",i.value);break;case"htmlAttributes":this.updateHtmlAttribute();break}}},t.prototype.preRender=function(){var i=this.element;if(this.formElement=(0,a.oq)(this.element,"form"),this.tagName=this.element.tagName,i=on(this.createElement,"EJS-RADIOBUTTON","radio",i,Qp,"radio"),this.element=i,this.element.getAttribute("type")!=="radio"&&this.element.setAttribute("type","radio"),this.element.id||(this.element.id=(0,a.QI)("e-"+this.getModuleName())),this.tagName==="EJS-RADIOBUTTON"){var r=this.element.getAttribute("formcontrolname");r&&(this.setProperties({name:r},!0),this.element.setAttribute("name",r))}},t.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete(),this.wrapper=this.getWrapper()},t.prototype.setDisabled=function(){this.element.disabled=!0},t.prototype.setText=function(i){var r=this.getLabel(),n=r.getElementsByClassName(Xp)[0];n?n.textContent=i:(i=this.enableHtmlSanitizer?a.pJ.sanitize(i):i,n=this.createElement("span",{className:Xp,innerHTML:i}),r.appendChild(n)),this.labelPosition==="Before"?this.getLabel().classList.add("e-right"):this.getLabel().classList.remove("e-right")},t.prototype.updateHtmlAttribute=function(){if(!(0,a.le)(this.htmlAttributes))for(var i=0,r=Object.keys(this.htmlAttributes);i<r.length;i++){var n=r[i];if(jC.indexOf(n)>-1){var s=this.element.parentElement;n==="class"?(0,a.cn)([s],this.htmlAttributes[n].split(" ")):n==="title"||n==="style"?s.setAttribute(n,this.htmlAttributes[n]):this.element.setAttribute(n,this.htmlAttributes[n])}}},t.prototype.unWireEvents=function(){var i=this.wrapper;a.bi.remove(this.element,"change",this.changeHandler),a.bi.remove(this.element,"focus",this.focusHandler),a.bi.remove(this.element,"focusout",this.focusOutHandler),a.bi.remove(this.element,"keyup",this.keyUpHandler);var r=i.getElementsByTagName("label")[0];r&&(a.bi.remove(r,"mousedown",this.labelRippleHandler),a.bi.remove(r,"mouseup",this.labelRippleHandler)),this.formElement&&a.bi.remove(this.formElement,"reset",this.formResetHandler)},t.prototype.wireEvents=function(){var i=this.getLabel();a.bi.add(this.element,"change",this.changeHandler,this),a.bi.add(this.element,"keyup",this.keyUpHandler,this),a.bi.add(this.element,"focus",this.focusHandler,this),a.bi.add(this.element,"focusout",this.focusOutHandler,this);var r=i.getElementsByClassName(Xp)[0];r&&(a.bi.add(r,"mousedown",this.labelRippleHandler,this),a.bi.add(r,"mouseup",this.labelRippleHandler,this)),this.formElement&&a.bi.add(this.formElement,"reset",this.formResetHandler,this)},t.prototype.click=function(){this.element.click()},t.prototype.focusIn=function(){this.element.focus()};var e;return tn([(0,a.ju)()],t.prototype,"change",void 0),tn([(0,a.ju)()],t.prototype,"created",void 0),tn([(0,a.Z9)(!1)],t.prototype,"checked",void 0),tn([(0,a.Z9)("")],t.prototype,"cssClass",void 0),tn([(0,a.Z9)(!1)],t.prototype,"disabled",void 0),tn([(0,a.Z9)("")],t.prototype,"label",void 0),tn([(0,a.Z9)("After")],t.prototype,"labelPosition",void 0),tn([(0,a.Z9)("")],t.prototype,"name",void 0),tn([(0,a.Z9)("")],t.prototype,"value",void 0),tn([(0,a.Z9)(!1)],t.prototype,"enableHtmlSanitizer",void 0),tn([(0,a.Z9)({})],t.prototype,"htmlAttributes",void 0),t=e=tn([a.Zl],t),t}(a.wA),Jp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(E.vy,this.applySortHandler,this),this.parent.on(ot.Vz,this.sortCompleteHandler,this),this.parent.on(E.HR,this.initiateCustomSortHandler,this),this.parent.on(ot.Ae,this.sortImport,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.vy,this.applySortHandler),this.parent.off(ot.Vz,this.sortCompleteHandler),this.parent.off(E.HR,this.initiateCustomSortHandler),this.parent.off(ot.Ae,this.sortImport))},o.prototype.getModuleName=function(){return"sort"},o.prototype.isValidSortRange=function(){var t=this.parent.getActiveSheet(),e=(0,w.gaE)((0,w.IRR)(t.selectedRange));return!(e[0]>t.usedRange.rowIndex||e[1]>t.usedRange.colIndex)},o.prototype.sortImport=function(t){for(var e=this.parent.sortCollection,i,r=this.parent.getActiveSheet().usedRange.rowIndex-1,n=t?t.sheetIdx:this.parent.activeSheetIndex,s=0;s<e.length;s++)if(e[s].sheetIndex===n){for(var l=0;l<r;l++)if(i=this.parent.getCell(l,e[s].columnIndex),i&&i.querySelector(".e-filter-icon")){e[s].order==="Ascending"||e[s].order==="OnTop"?i.querySelector(".e-filter-icon").classList.contains("e-sortasc-filter")||i.querySelector(".e-filter-icon").classList.add("e-sortasc-filter"):i.querySelector(".e-filter-icon").classList.contains("e-sortdesc-filter")||i.querySelector(".e-filter-icon").classList.add("e-sortdesc-filter");return}}},o.prototype.sortRangeAlertHandler=function(t){var e=this,i=this.parent.serviceLocator.getService(Yt),r=this.parent.serviceLocator.getService(Ve);i.show({height:180,width:400,isModal:!0,showCloseIcon:!0,content:t.error,beforeOpen:function(n){var s={dialogName:t.error===r.getConstant("MultiRangeSortError")?"MultiRangeSortDialog":"SortRangeDialog",content:t.error,element:n.element,target:n.target,cancel:n.cancel};e.parent.trigger("dialogBeforeOpen",s),s.cancel&&(n.cancel=!0),i.dialogInstance.content=s.content}}),this.parent.hideSpinner()},o.prototype.initiateCustomSortHandler=function(){var t=this,e=this.parent.serviceLocator.getService(Ve),i=this.parent.getActiveSheet();if(!this.isValidSortRange()||i.rows.length==0){this.sortRangeAlertHandler({error:e.getConstant("SortOutOfRangeError")});return}if(Lt(i.selectedRange)){this.sortRangeAlertHandler({error:e.getConstant("MultiRangeSortError")});return}var r=this.parent.serviceLocator.getService(Yt),n;r.show({height:400,width:560,isModal:!0,showCloseIcon:!0,cssClass:"e-customsort-dlg",header:e.getConstant("CustomSort"),beforeOpen:function(s){var l={dialogName:"CustomSortDialog",element:s.element,target:s.target,cancel:s.cancel};t.parent.trigger("dialogBeforeOpen",l),l.cancel&&(s.cancel=!0),r.dialogInstance.content=t.customSortContent(),r.dialogInstance.dataBind(),we(t.parent.element)},buttons:[{buttonModel:{content:e.getConstant("Ok"),isPrimary:!0},click:function(){var s=r.dialogInstance.content,l=(0,a.Xr)(s.getElementsByClassName("e-list-sort e-listview e-lib")[0],"listview"),h=l.dataSource;t.clearError();var c=s.getElementsByClassName("e-sort-error")[0];c.style.display="block",t.validateError(h,s,c)||(n={sortDescriptors:h,containsHeader:s.getElementsByClassName("e-sort-checkheader")[0].checked,caseSensitive:s.getElementsByClassName("e-sort-checkcase")[0].checked},r.hide())}}],close:function(){n&&$(function(){return t.applySortHandler({sortOptions:n})})}})},o.prototype.validateError=function(t,e,i){var r=this.parent.serviceLocator.getService(Ve),n=t.some(function(p){return p.field.toString()===""});if(n)return Array.prototype.some.call(e.getElementsByClassName("e-sort-field"),function(p){var f=!(0,a.Xr)(p,"dropdownlist").value;return f&&p.parentElement.classList.add("e-error"),f}),i.innerText=r.getConstant("SortEmptyFieldError"),!0;var s=new Set,l="",h=t.some(function(p){return l=p.field.toString(),s.size===s.add(p.field).size}),c="";if(h){var u=0;return Array.prototype.some.call(e.getElementsByClassName("e-sort-field"),function(p){var f=(0,a.Xr)(p,"dropdownlist");return f.value===l&&(p.parentElement.classList.add("e-error"),c=f.text,u++),u===2}),i.innerHTML="<strong>"+c+"</strong>"+r.getConstant("SortDuplicateFieldError"),!0}return!1},o.prototype.customSortContent=function(){var t=this.parent.createElement("div",{className:"e-sort-dialog"}),e=this.getFields(),i=(0,a.QI)("customSort"),r=this.getCustomListview(i);this.setHeaderTab(t,r,e);var n=this.parent.createElement("div",{className:"e-sort-listsection",styles:""});t.appendChild(n);var s=this.parent.createElement("div",{className:"e-list-sort",styles:""});n.appendChild(s),r.createElement=this.parent.createElement,r.appendTo(s),s.removeAttribute("tabindex"),this.renderListItem(i,r,!0,e);var l=this.parent.createElement("div",{className:"e-sort-error"});return t.appendChild(l),t},o.prototype.getFields=function(){var t=this.parent.getActiveSheet(),e=(0,w.gaE)((0,w.IRR)(t.selectedRange));if(e[0]===e[2]&&e[2]-e[0]==0){e[0]=0,e[1]=0,e[3]=t.usedRange.colIndex;var i={filterRange:[],hasFilter:!1};this.parent.notify(E.CT,i),i.hasFilter&&i.filterRange&&(e[0]=i.filterRange[0])}var r=[],n,s;for(e[1];e[1]<=e[3];e[1]++){var l=(0,w.$Su)(e[0],e[1],t);if(s="Column "+(0,w.AH9)(e[1]+1),l&&l.value){if(n=l.value,l.format){var h={formattedText:n,value:n,format:l.format,onLoad:!0};this.parent.notify(ot.eY,h),n=h.formattedText}}else n=s;r.push({text:n,value:s})}return r},o.prototype.setHeaderTab=function(t,e,i){var r=this,n=this.parent.serviceLocator.getService(Ve),s=this.parent.createElement("div",{className:"e-sort-header",styles:"",innerHTML:""});t.appendChild(s);var l=this.parent.createElement("button",{className:"e-btn e-sort-addbtn e-flat",innerHTML:n.getConstant("AddColumn")}),h=this.parent.element.querySelector(".e-customsort-dlg .e-footer-content");h.insertBefore(l,h.firstElementChild),l.addEventListener("click",function(){if(e){var g=(0,a.QI)("customSort");e.addItem([{id:g,text:n.getConstant("ThenBy"),field:"",order:"ascending"}]),r.renderListItem(g,e,c.checked,i,!0)}});var c=new Yn({label:n.getConstant("ContainsHeader"),checked:!0,change:function(g){var C=g.checked?{text:"text",value:"value"}:{text:"value"};Array.prototype.forEach.call(t.getElementsByClassName("e-sort-field e-dropdownlist e-lib"),function(L){var D=(0,a.Xr)(L,"dropdownlist");D.dataSource=null,D.dataSource=i,D.fields=C,D.dataBind()})},cssClass:"e-sort-headercheckbox"}),u=this.parent.createElement("input",{className:"e-sort-checkheader",attrs:{type:"checkbox"}});s.appendChild(u),c.createElement=this.parent.createElement,c.appendTo(u);var p=new Yn({label:n.getConstant("CaseSensitive"),checked:!1,cssClass:"e-sort-casecheckbox"}),f=this.parent.createElement("input",{className:"e-sort-checkcase",attrs:{type:"checkbox"}});s.appendChild(f),p.createElement=this.parent.createElement,p.appendTo(f)},o.prototype.getCustomListview=function(t){var e=this.parent.serviceLocator.getService(Ve),i=[{id:t,text:e.getConstant("SortBy"),field:"",order:"ascending"}];(0,a.dW)(!1);var r=new Sh({dataSource:i,fields:{id:"id"},height:"100%",template:'<div class="e-sort-listwrapper"><span class="text">${text}</span><div class="e-sort-row"><div class="e-sort-field"></div><div class="e-sort-order"><span class="e-sort-ordertxt" style="display:none;">${order}</span></div><span class="e-icons e-sort-delete"></span></div>',cssClass:"e-sort-template"});return r},o.prototype.deleteHandler=function(t,e){var i=t.getElementsByClassName("e-sort-delete")[0];i.addEventListener("click",function(){t&&e.removeItem(t)})},o.prototype.renderListItem=function(t,e,i,r,n){var s=this,l=this.parent.serviceLocator.getService(Ve),h=e.element.querySelector("li[data-uid="+t+"]"),c=i?{text:"text",value:"value"}:{text:"value"},u=h.getElementsByClassName("e-sort-field")[0],p=new mn({dataSource:r,width:"auto",cssClass:"e-sort-field-ddl",fields:c,placeholder:l.getConstant("SelectAColumn"),change:function(H){!H.value||(Array.prototype.some.call(e.dataSource,function(j){return j.id===t&&(j.field=H.value.toString().replace("Column ","")),j.id===t}),s.clearError())}});p.createElement=this.parent.createElement,p.appendTo(u),n||(p.index=0);var f=h.getElementsByClassName("e-sort-order")[0],g=f.getElementsByClassName("e-sort-ordertxt")[0],C=g.innerText.toLocaleLowerCase()==="ascending",L=new Uh({label:l.getConstant("SortAscending"),name:"sortAZ_"+t,value:"ascending",checked:C,cssClass:"e-sort-radiobutton",change:function(H){s.setRadioBtnValue(e,t,H.value)}}),D=this.parent.createElement("input",{id:"orderAsc_"+t,className:"e-sort-radioasc",styles:"",attrs:{type:"radio"}});f.appendChild(D),L.createElement=this.parent.createElement,L.appendTo(D);var R=new Uh({label:l.getConstant("SortDescending"),name:"sortAZ_"+t,value:"descending",checked:!C,cssClass:"e-sort-radiobutton",change:function(H){s.setRadioBtnValue(e,t,H.value)}}),B=this.parent.createElement("input",{id:"orderDesc_"+t,className:"e-sort-radiodesc",styles:"",attrs:{type:"radio"}});f.appendChild(B),R.createElement=this.parent.createElement,R.appendTo(B),this.deleteHandler(h,e)},o.prototype.setRadioBtnValue=function(t,e,i){!i||Array.prototype.some.call(t.dataSource,function(r){return r.id===e&&(r.order=i),r.id===e})},o.prototype.clearError=function(){var t=document.getElementsByClassName("e-sort-dialog")[0],e=t.getElementsByClassName("e-sort-error")[0];e.style.display!=="none"&&e.innerHTML!==""&&(e.style.display="none",Array.prototype.forEach.call(t.getElementsByClassName("e-error"),function(i){i.classList.remove("e-error")}))},o.prototype.applySortHandler=function(t){var e=this,i=this.parent.getActiveSheet(),r=t&&t.range||i.selectedRange,n=(0,w.gaE)((0,w.IRR)(r)),s=t&&t.sortOptions||{sortDescriptors:{}},l=n[0]===n[2],h={filterRange:[],hasFilter:!1,sheetIdx:this.parent.activeSheetIndex};this.parent.notify(E.CT,h),h.hasFilter&&(l?(0,w.Z2v)(h.filterRange,n[0],n[1]):h.filterRange[0]===n[0]&&(this.parent.element.querySelector(".e-selectall.e-highlight")||n[1]>=h.filterRange[1]&&n[1]<=h.filterRange[3]||n[3]>=h.filterRange[1]&&n[3]<=h.filterRange[3]))&&(n[0]=h.filterRange[0],n[1]=h.filterRange[1],n[2]=i.usedRange.rowIndex,n[3]=i.usedRange.colIndex,s.containsHeader=!0,l=!1),r=(0,w.i0K)(n);var c={range:r,sortOptions:s,cancel:!1};if(this.parent.trigger(ot.Cf,c),!c.cancel){this.parent.notify(w.ya2,{eventArgs:c,action:"beforeSort"}),this.parent.showSpinner();var u=new Promise(function(f,g){f(function(){}())}),p={args:{range:c.range,sortOptions:c.sortOptions,checkForHeader:l&&r!==c.range},promise:u,previousSort:t&&t.previousSort};this.parent.notify(w.fqz,p),p.promise.then(function(f){return e.sortCompleteHandler(f),e.parent.trigger(ot.Vz,f),e.parent.notify(E.Av,{eventArgs:f,action:"sorting"}),Promise.resolve(f)}).catch(function(f){return e.sortRangeAlertHandler({error:f}),Promise.reject(f)})}},o.prototype.sortCompleteHandler=function(t){for(var e=(0,w.IRR)(t.range),i=e[0];i<=e[2];i++)for(var r=e[1];r<=e[3];r++)this.parent.notify(ot.B7,{action:"refreshCalculate",rowIndex:i,colIndex:r});this.parent.serviceLocator.getService("cell").refreshRange(e,!0,!0),this.parent.hideSpinner()},o}(),RA="create",MA="destroy",PA="load",NA="rowDataBound",BA="queryCellInfo",FA="headerCellInfo",sm="actionBegin",qh="actionComplete",HA="actionFailure",VA="dataBound",zA="rowSelecting",_A="rowSelected",jA="rowDeselecting",WA="rowDeselected",UA="cellSelecting",qA="cellSelected",ZA="cellDeselecting",YA="cellDeselected",GA="columnSelecting",KA="columnSelected",XA="columnDeselecting",$A="columnDeselected",QA="columnDragStart",JA="columnDrag",eT="columnDrop",tT="rowDragStartHelper",iT="rowDragStart",rT="rowDrag",nT="rowDrop",sT="beforePrint",aT="printComplete",oT="detailDataBound",lT="toolbarClick",hT="batchAdd",cT="batchCancel",uT="batchDelete",pT="beforeBatchAdd",dT="beforeBatchDelete",fT="beforeBatchSave",vT="beginEdit",mT="cellEdit",gT="cellSave",yT="cellSaved",bT="endAdd",CT="endDelete",ST="endEdit",wT="recordDoubleClick",xT="recordClick",ET="beforeDataBound",AT="beforeOpenColumnChooser",TT="beforeOpenAdaptiveDialog",LT="resizeStart",kT="resizing",IT="resizeStop",DT="checkBoxChange",OT="beforeCopy",RT="beforePaste",MT="beforeAutoFill",am="filterchoicerequest",WC="filterafteropen",UC="filterbeforeopen",qC="filtersearchbegin",PT="commandClick",NT="exportGroupCaption",BT="lazyLoadGroupExpand",FT="lazyLoadGroupCollapse",HT="initial-load",VT="initial-end",zT="data-ready",_T="content-ready",jT="ui-update",WT="on-empty",UT="inbound-model-changed",qT="model-changed",ZT="colgroup-refresh",YT="header-refreshed",GT="paging-begin",KT="paging-complete",XT="sorting-begin",$T="sorting-complete",QT="filtering-begin",JT="filtering-complete",eL="searching-begin",tL="searching-complete",iL="reorder-begin",rL="reorder-complete",nL="rowdraganddrop-begin",sL="rowdraganddrop-complete",aL="grouping-begin",oL="grouping-complete",lL="ungrouping-begin",hL="ungrouping-complete",cL="group-aggregates",uL="refresh-footer-rendered",pL="refresh-aggregate-cell",dL="refresh-aggregates",fL="rowselecting",vL="rowselected",mL="columnselecting",gL="columnselected",yL="cellselecting",bL="cellselected",CL="beforecellfocused",SL="cellfocused",wL="key-pressed",xL="click",EL="destroy",AL="column-visible-changed",TL="scroll",LL="column-width-changed",kL="column-position-changed",IL="row-drag-and-drop",DL="rows-added",OL="rows-removed",RL="column-drag-stop",ML="header-drop",PL="datasource-modified",NL="refresh-complete",BL="refresh-virtual-block",FL="dblclick",HL="toolbar-refresh",VL="bulk-save",zL="auto-col",_L="tooltip-destroy",jL="update-data",WL="edit-begin",UL="edit-complete",qL="add-begin",ZL="add-complete",YL="save-complete",GL="delete-begin",KL="delete-complete",XL="prevent-batch",$L="dialog-destroy",QL="crud-Action",JL="add-delete-Action",ek="destroy-form",tk="double-tap",ik="beforeExcelExport",rk="excelExportComplete",nk="excelQueryCellInfo",sk="excelHeaderQueryCellInfo",ak="exportDetailDataBound",ok="beforePdfExport",lk="pdfExportComplete",hk="pdfQueryCellInfo",ck="pdfHeaderQueryCellInfo",uk="access-predicate",pk="contextMenuClick",dk="freezerender",fk="freezerefresh",vk="contextMenuOpen",mk="columnMenuClick",gk="columnMenuOpen",yk="filterOpen",Zh="filterDialogCreated",ZC="filter-menu-close",bk="initForeignKeyColumn",Ck="getForeignKeyData",ed="generateQuery",Sk="showEmptyGrid",YC="foreignKeyData",wk="columnDataStateChange",om="dataStateChange",xk="dataSourceChanged",Ek="rtl-updated",Ak="beforeFragAppend",Tk="frozenHeight",Lk="textWrapRefresh",kk="recordAdded",Ik="cancel-Begin",Dk="editNextValCell",Ok="hierarchyprint",Rk="expandchildgrid",Mk="printGrid-Init",Pk="export-RowDataBound",Nk="export-DataBound",Bk="row-position-changed",Fk="columnChooserOpened",Hk="batchedit-form",Vk="edit-form",zk="before-batch-cancel",_k="batcheditform-rendered",jk="partial-refresh",GC="beforeCustomFilterOpen",Wk="select-virtual-Row",Uk="columns-prepared",KC="cbox-filter-begin",lm="cbox-filter-complete",td="filter-Prevent",id="before-filter-cmenu-open",qk="validation-custom-placement",rd="filter-cbox-value",Zk="component-rendered",Yk="restore-Focus",Gk="detail-state-change",Kk="detail-indentcell-info",Xk="virtaul-key-handler",$k="virtaul-cell-focus",Qk="virtual-scroll-edit-action-begin",Jk="virtual-scroll-edit-success",eI="virtual-scroll-edit-cancel",tI="virtual-scroll-edit",iI="refresh-virtual-cache",rI="edit-reset",nI="virtual-scroll-add-action-begin",sI="get-virtual-data",aI="refresh-infinite-mode-blocks",oI="reset-infinite-blocks",lI="infinite-scroll-handler",hI="infinite-page-query",cI="infinite-show-hide",uI="append-infinite-content",pI="remove-infinite-rows",dI="set-infinite-cache",fI="infinite-edit-handler",vI="initial-collapse",mI="get-aggregate-query",gI="close-filter-dialog",yI="columnChooserCancelBtnClick",bI="get-filterbar-operator",CI="reset-columns",SI="pdfAggregateQueryCellInfo",wI="excelAggregateQueryCellInfo",xI="group-cache",EI="lazy-load-scroll-handler",AI="group-collapse",XC="beforeCheckboxRenderer",TI="refreshResizeHandlers",LI="refresh-frozen-columns",kI="set-reorder-destination-element",II="refresh-virtual-frozen-height",DI="set-freeze-selection",OI="set-infinite-frozen-height",RI="set-infinite-col-frozen-height",MI="before-refresh-on-data-change",PI="immutable-batch-cancel",NI="refresh-virtual-frozenrows",BI="check-scroll-reset",FI="refresh-frozen-height",HI="set-height-to-frozen-element",VI="prevent-frozen-scroll-refresh",zI="next-cell-index",_I="refresh-infinite-current-view-data",jI="infinite-crud-cancel",oa="filter-dialog-close",hm="refresh-cutsom-filter-ok-button",$C="refresh-cutsom-filter-clear-button",cm="render-responsive-cmenu",nd="filter-cmenu-select",QC="custom-filter-close",WI="set-fullscreen-dialog",UI="refresh-Expand-and-Collapse",qI="row-mode-change",ZI="enter-key-handler",YI="refresh-virtual-max-page",GI="set-virtual-page-query",KI="select-row-on-context-open",XI="pager-refresh",$I="closeinline",QI="closebatch",JI="close-edit",eD="reset-virtual-focus",tD="after-content-renderer",iD="refresh-virtual-editform-cells",rD="scroll-to-edit",JC="before-checkbox-renderer-query",nD="create-virtual-validation-form",sD="validate-virtual-form",aD="destroy-child-grid",oD="sticky-scroll-complete",lD="infinite-group-collapse",hD="refresh-infinite-persist-selection",cD="refresh-infinite-editrowindex",eS="after-filter-column-menu-close",tS="beforeCheckboxfilterRenderer",um=ae(13268);function uD(o,t){return o.prototype&&t in o.prototype}function pm(o,t,e){return(0,a.le)(o)||o===""?"":vn.j.getObject(o,t)}function pD(o,t){return isNullOrUndefined(o)||o===""?"":DataUtil.getObject(o,t)}function dD(o,t){requestAnimationFrame(function(){try{t(null,o())}catch(e){t(e)}})}function fD(o){return!isNullOrUndefined(o)&&!isNullOrUndefined(o.columns)&&o.columns.length>0}function vD(o,t){for(var e=o.columns,i=t.columns,r=0;r<e.length;r++)if(i.length-1>=r)if(i[r].columns)for(var n=0;n<i[r].columns.length;n++)e[r].columns[n].type=i[r].columns[n].type;else e[r].type=i[r].type}function mD(o){for(var t=[],e=o.vRows,i=0;i<e.length;i++)e[i].isDataRow?t.push(e[i]):e[i].isDataRow||(t.push(e[i]),!e[i].isExpand&&e[i].isCaptionRow&&(i+=iS(e[i],o)));o.vcRows=t}var Wr=0;function iS(o,t){Wr=0;var e="gSummary",i="count",r=t.groupSettings.columns.length,n="records",s="items",l=o[e],h=0,c="aggregatesCount";if(l===o.data[i])return t.groupSettings.columns.length&&!isNullOrUndefined(o[c])&&o[c]?t.groupSettings.columns.length!==1?Wr+=o.indent!==0&&l<2?o[e]*(r-o.indent+(r-o.indent)*o[c]):o[e]*(r-o.indent+(r-o.indent-1)*o[c])+o[c]:t.groupSettings.columns.length===1&&(Wr+=o[e]*(r-o.indent)+o[c]):t.groupSettings.columns.length&&(t.groupSettings.columns.length!==1?Wr+=o[e]*(t.groupSettings.columns.length-o.indent):Wr+=o[e]),Wr;for(var u=0,p=o.data[s].length;u<p;u++){var f=o.data[s][u];Wr+=f[s].length+(r!==t.columns.length&&!isNullOrUndefined(f[s][n])?f[s][n].length:0),h+=!isNullOrUndefined(f[s][n])&&!isNullOrUndefined(o[c])?f[s][n].length:f[s].length,f[s].GroupGuid&&f[s].childLevels!==0&&dm(f)}return Wr+=o.data[s].length,isNullOrUndefined(o[c])||o[c]&&Wr&&h!==0&&(Wr+=(Wr-h)*o[c]+o[c]),Wr}function dm(o){for(var t="items",e="count",i=0,r=o[t].length;i<r;i++){var n=o[t][i];Wr+=n[e],n[t].childLevels!==0&&dm(n)}}function gD(o,t){for(var e=[],i=0,r=o.length;i<r;i++){var n=t(o[i],i);isNullOrUndefined(n)||e.push(n)}return e}function yD(o){for(var t=[],e=0;e<o.length;e++)t.push(baseExtend({},Yh(o[e]),{},!0));return t}function bD(o){if(o)try{return document.querySelectorAll(o).length?baseTemplateComplier(document.querySelector(o).innerHTML.trim()):baseTemplateComplier(o)}catch(t){return baseTemplateComplier(o)}}function CD(o,t){var e={},i=["style","class"];baseExtend(e,t,{}),"style"in e&&(setStyleAttribute(o,e[i[0]]),delete e[i[0]]),"class"in e&&(addClass([o],e[i[1]]),delete e[i[1]]),attributes(o,e)}function $a(o,t,e,i){for(var r=(0,a.l7)(o,t,e),n=Object.keys(r),s=0;s<n.length;s++)i&&i.indexOf(n[s])!==-1&&delete r[n[s]];return r}function rS(o,t){t===void 0&&(t=0);for(var e=0,i=o.length;e<i;e++)o[e].columns?(o[e].index=isNullOrUndefined(o[e].index)?t:o[e].index,t++,t=rS(o[e].columns,t)):(o[e].index=isNullOrUndefined(o[e].index)?t:o[e].index,t++);return t}function nS(o,t,e){for(var i=0,r=o.length;i<r;i++){var n=void 0;typeof o[i]=="string"?n=new Column({field:o[i]},e):!(o[i]instanceof Column)||o[i].columns?o[i].columns?(o[i].columns=nS(o[i].columns,null,e),n=new Column(o[i],e)):n=new Column(o[i],e):n=o[i],n.type&&n.type.toLowerCase()==="checkbox"&&(n.allowReordering=!1),n.headerText=isNullOrUndefined(n.headerText)?n.foreignKeyValue||n.field||"":n.headerText,n.foreignKeyField=n.foreignKeyField||n.field,n.valueAccessor=(typeof n.valueAccessor=="string"?getValue(n.valueAccessor,window):n.valueAccessor)||pm,n.width=t&&isNullOrUndefined(n.width)?200:n.width,isNullOrUndefined(n.visible)&&(n.visible=!0),o[i]=n}return o}function SD(o,t,e){var i=o.querySelector("span"),r=o.parentElement.getBoundingClientRect(),n=t.target.getBoundingClientRect();i.className=e,o.style.display="";var s=(isNullOrUndefined(t.clientY)?t.changedTouches[0].clientY:t.clientY)>o.offsetHeight+10;o.style.top=n.top-r.top+(s?-(o.offsetHeight+10):o.offsetHeight+10)+"px",o.style.left=sS(o,t,n,r.left)+"px",s?(o.querySelector(".e-downtail").style.display="",o.querySelector(".e-uptail").style.display="none"):(o.querySelector(".e-downtail").style.display="none",o.querySelector(".e-uptail").style.display="")}function sS(o,t,e,i){var r=o.offsetWidth/2,n=oS(t).x;return n-e.left<r?e.left-i:e.right-n<r?e.right-i-r*2:n-i-r}function Yh(o){return o instanceof a.rt?(0,a.NA)("properties",o):o}function rn(o,t,e){for(var i=o;i&&!(e?i.id===t:i.classList.contains(t));)i=i.parentElement;return i}function wD(o,t){for(var e=-1,i=0,r=t.length;i<r;i++)if(t[i].isEqualNode(o)){e=i;break}return e}function xD(o,t){for(var e=0,i=t.length;e<i;e++)if(t[e]===o)return e;return-1}function aS(o){for(var t=[],e=0,i=o.length;e<i;e++)o[e].hasOwnProperty("properties")?t.push(o[e].properties):t.push(o[e]);return t}function ED(o,t){for(var e=[].slice.call(o.querySelectorAll(t)),i=0;i<e.length;i++)remove(e[i])}function oS(o){var t={};return t.x=isNullOrUndefined(o.clientX)?o.changedTouches[0].clientX:o.clientX,t.y=isNullOrUndefined(o.clientY)?o.changedTouches[0].clientY:o.clientY,t}var lS=0;function sd(o){return o+lS++}function Gh(o,t){for(var e=0,i=t.length;e<i;e++)i===t.length?o.appendChild(t[e]):o.appendChild(t[0]);return o}function AD(o,t,e){for(var i=o,r=[];i;)(e?i.id===t:i.classList.contains(t))&&r.push(i),i=i.parentElement;return r}function TD(o,t,e,i){if(o==="Custom"){var r=e.customAggregate;return typeof r=="string"&&(r=getValue(r,window)),r?r.call(i,t,e):""}return e.field in t||t instanceof Array?DataUtil.aggregates[o.toLowerCase()](t,e.field):null}var ad=null;function LD(){if(ad!==null)return ad;var o=document.createElement("div"),t=0;return o.style.cssText="width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(o),t=o.offsetWidth-o.clientWidth|0,document.body.removeChild(o),ad=t}var al;function kD(o){if(al!==void 0)return al;var t=createElement("table",{className:literals.table,styles:"visibility: hidden",attrs:{role:"grid"}});t.innerHTML='<tr><td class="e-rowcell">A<td></tr>',o.appendChild(t);var e=t.querySelector("td").getBoundingClientRect();return o.removeChild(t),al=Math.ceil(e.height),al}var hS;function ID(o){if(hS!==void 0)return al;var t=createElement("table",{className:literals.table,styles:"visibility: hidden",attrs:{role:"grid"}});t.innerHTML='<tr><td class="e-rowcell">A<td></tr>',o.appendChild(t);var e=t.querySelector("tr").getBoundingClientRect();return o.removeChild(t),e.height}function As(o){return o.split(".").length>1}function nn(o){return o===void 0&&(o=""),o.replace(/\./g,"___")}function DD(o){return o===void 0&&(o=""),o.replace(/___/g,".")}function OD(o,t,e){var i=rn(e,literals.row),r=i?i&&!i.classList.contains("e-insertedrow"):!0;return t==="beginEdit"&&r?!(o.isIdentity||o.isPrimaryKey||!o.allowEditing):t==="add"&&o.isIdentity?!1:!(r&&!o.allowEditing&&!o.isIdentity&&!o.isPrimaryKey)}function RD(o){var t=select("#"+o.element.id+"EditConfirm",o.element);return o.editSettings.mode==="Batch"&&selectAll(".e-updatedtd",o.element).length&&o.editSettings.showConfirmDialog&&(t?t.classList.contains("e-popup-close"):!0)}function MD(o,t){var e="e-wrap";o=o instanceof Array?o:[o];for(var i=0;i<o.length;i++)t?o[i].classList.add(e):o[i].classList.remove(e)}function PD(o,t){var e=o.getService("valueFormatter"),i="format",r;switch((t.type==="date"||t.type==="datetime")&&(r={type:t.type,skeleton:t.format},typeof t.format=="string"&&t.format!=="yMd"&&(r[i]=t.format)),t.type){case"date":t.setFormatter(e.getFormatFunction(r)),t.setParser(e.getParserFunction(r));break;case"datetime":t.setFormatter(e.getFormatFunction(r)),t.setParser(e.getParserFunction(r));break;case"number":t.setFormatter(e.getFormatFunction({format:t.format})),t.setParser(e.getParserFunction({format:t.format}));break}}function ND(o,t){for(var e=[],i=2;i<arguments.length;i++)e[i-2]=arguments[i];for(var r=0,n=o.length;r<n;r++)t?(classList(o[r],e.slice(),[]),o[r].setAttribute("aria-selected","true")):(classList(o[r],[],e.slice()),o[r].removeAttribute("aria-selected"))}function cS(o){for(var t={},e=[],i=0;i<o.length;i++)o[i]in t||(e.push(o[i].toString()),t[o[i]]=1);return e}function uS(o,t){var e=t.element.style.display;t.element.style.display="block";var i=t.width,r=wa(o,t.element);t.element.style.display=e,t.element.style.top=r.top+o.getBoundingClientRect().height-5+"px";var n=r.left-i+o.clientWidth;n<1?t.element.style.left=i+n-16+"px":t.element.style.left=n+-4+"px"}function BD(o,t){o.popup.element.style.zIndex=(t.zIndex+1).toString()}function pS(o){var t=o.querySelector(".e-frame"),e=t.previousSibling;t.classList.contains("e-check")?(e.checked=!1,(0,a.s1)(t,["e-uncheck"],["e-check"])):(e.checked=!0,(0,a.s1)(t,["e-check"],["e-uncheck"]))}function Kh(o,t){o.checked=t}function od(o,t,e){var i=(0,a.az)("div",{className:e});return i.appendChild(t),i.setAttribute("uid",o),i}function dS(o,t){(0,a.IV)([o],["e-check","e-stop","e-uncheck"]),t?o.classList.add("e-check"):o.classList.add("e-uncheck")}function FD(o,t,e){for(var i=0;i<t.length;i++)setValue(t[i].field,fm(t[i],e),o.foreignKeyData);for(var r=o.cells,i=0;i<r.length;i++)r[i].isForeignKey&&setValue("foreignKeyData",getValue(r[i].column.field,o.foreignKeyData),r[i])}function fm(o,t,e,i){var r=o.foreignKeyField,n=(0,a.le)(e)?pm(o.field,t,o):e;n=(0,a.le)(n)?"":n;var s=new yt.A,l=i||(o.dataSource instanceof Oe.h&&o.dataSource.dataSource.json.length?o.dataSource.dataSource.json:o.columnData);return n.getDay?s.where(Qa({field:r,operator:"equal",value:n,matchCase:!1})):s.where(r,"==",n,!1),new Oe.h(l).executeLocal(s)}function vm(o,t){var e;return t.some(function(i){return e=i,i.foreignKeyValue===o})&&e}function Qa(o,t){var e,i,r,n=(0,a.l7)({},Yh(o)),s=(0,a.l7)({},Yh(o));if((0,a.le)(o.value)||o.value==="")return e=new yt.$(n.field,n.operator,n.value,!1),e;var l=new Date(o.value);if(o.operator==="equal"||o.operator==="notequal"){t==="datetime"?(i=new Date(l.setSeconds(l.getSeconds()-1)),r=new Date(l.setSeconds(l.getSeconds()+2)),o.value=new Date(l.setSeconds(r.getSeconds()-1))):(i=new Date(l.setHours(0)-1),r=new Date(l.setHours(24))),n.value=i,s.value=r,o.operator==="equal"?(n.operator="greaterthan",s.operator="lessthan"):o.operator==="notequal"&&(n.operator="lessthanorequal",s.operator="greaterthanorequal");var h=new yt.$(n.field,n.operator,n.value,!1),c=new yt.$(s.field,s.operator,s.value,!1);e=o.operator==="equal"?h.and(c):h.or(c)}else{t==="date"&&(o.operator==="lessthanorequal"||o.operator==="greaterthan")&&(n.value=new Date(l.setHours(24)-1)),typeof n.value=="string"&&(n.value=new Date(n.value));var u=new yt.$(n.field,n.operator,n.value,!1);e=u}return o.setProperties?o.setProperties({ejpredicate:e},!0):o.ejpredicate=e,e}function HD(o,t,e){t=t&&e&&e.isRowDragable()?t+1:t;for(var i=o.cloneNode(!0),r=0;r<t;r++)i.removeChild(i.children[0]);for(var r=t,n=o.childElementCount;r<n;r++)o.removeChild(o.children[o.childElementCount-1]);return i}function VD(o){return o.enableVirtualization&&o.groupSettings.columns.length>0&&o.isVirtualAdaptive}function mm(o,t){if(o===void 0&&(o=""),o){for(var e=t,i=o.split("."),r=0;r<i.length&&!(0,a.le)(e);r++)e=e[i[r]];return e}}function gm(o,t){var e=new a.eC,i,r="format",n="type";return t==="date"?i=typeof o=="object"?e.getDatePattern({type:o[n]?o[n]:"date",format:o[r]},!1):e.getDatePattern({type:"dateTime",skeleton:o},!1):i=typeof o=="object"?e.getDatePattern({type:o[n]?o[n]:"dateTime",format:o[r]},!1):e.getDatePattern({type:"dateTime",skeleton:o},!1),i}function fS(o,t){for(var e=o.getRowsObject(),i={},r=0,n=e;r<n.length;r++){var s=n[r];if(s.isExpand&&!s.isDetailRow){var l=o.allowPaging&&o.printMode==="AllPages"?s.index+o.pageSettings.currentPage*o.pageSettings.pageSize-o.pageSettings.pageSize:s.index;i[l]={},i[l].isExpand=!0,i[l].gridModel=vS(s.childGrid,t),i[l].gridModel.query=o.childGrid.query}}return i}function vS(o,t){t===void 0&&(t="Expanded");var e={};if(!o)return e;for(var i=o.isFrozenGrid()&&!o.getFrozenColumns(),r=0,n=Print.printGridProp;r<n.length;r++){var s=n[r];s==="columns"?e[s]=aS(i?o.getColumns():o[s]):s==="allowPaging"?e[s]=o.printMode==="CurrentPage":e[s]=Yh(o[s])}return e.enableHover=!1,o.childGrid&&t!=="None"&&(e.expandedRows=fS(o,t)),e}function mS(o,t,e,i){var r=o||{},n=arguments.length;i&&(n=n-1);for(var s=1;s<n;s++)if(!!arguments[s])for(var l=arguments[s],h=Object.keys(Object.getPrototypeOf(l)).length?Object.keys(l).concat(gS(l)):Object.keys(l),c=0;c<h.length;c++){var u=r[h[c]],p=l[h[c]],f=void 0;i&&((0,a.Kn)(p)||Array.isArray(p))?(0,a.Kn)(p)?(f=u||{},r[h[c]]=(0,a.l7)({},f,p,i)):(f=u||[],r[h[c]]=(0,a.l7)([],f,p,i)):r[h[c]]=p}return r}function gS(o){for(var t=[];Object.getPrototypeOf(o)&&Object.keys(Object.getPrototypeOf(o)).length;)t=t.concat(Object.keys(Object.getPrototypeOf(o))),o=Object.getPrototypeOf(o);return t}function zD(o){for(var t=0,e=0;e<o.length;e++){var i=ym(o[e],0);t<i&&(t=i)}return t+1}function ym(o,t){var e=t,i=[];if(o.columns){t++;for(var r=0;r<o.columns.length;r++)i[r]=ym(o.columns[r],t);for(var n=0;n<i.length;n++)e<i[n]&&(e=i[n]);t=e}return t}function _D(o,t){for(var e=0;e<t.length;e++)t[e].uid=t[e].isForeignKey?vm(t[e].field,o.getForeignKeyColumns()).uid:o.enableColumnVirtualization?CS(o,t[e].field).uid:o.getColumnByField(t[e].field).uid}var bm;(function(o){o.timer=null})(bm||(bm={}));function jD(o){var t=document.defaultView.getComputedStyle(o,null),e=t.getPropertyValue("transform"),i=e.replace(/,/g,""),r=parseFloat(i.split(" ")[4]),n=parseFloat(i.split(" ")[5]);return{width:r,height:n}}function Cm(o,t){o.classList.contains("e-bigger")&&t.classList.add("e-bigger")}function WD(o,t){if(o&&t){var e=closest(o,"."+literals.row).getBoundingClientRect().height,i=closest(t,"."+literals.row).getBoundingClientRect().height;e>i?t.style.height=e+"px":o.style.height=i+"px"}}function UD(o,t){var e=t.getContent().firstElementChild.offsetHeight;return o&&o.getBoundingClientRect().top>e}function qD(o,t){return o&&o.getBoundingClientRect().top<t}function ZD(o,t){var e=t.getRowHeight(),i=t.getContent().firstElementChild.scrollTop/e,r=i+t.getContent().firstElementChild.offsetHeight/e;return o<r&&o>i}function YD(o,t){var e=o.getPrimaryKeyFieldNames()[0],i;return o.getCurrentViewRecords().filter(function(r,n){r[e]===t[e]&&(i=n)}),i}function Sm(o,t){var e=yS(t),i=new Oe.B;return e.dataSource=i.resolve,e.action=o,{state:e,deffered:i}}function yS(o){var t=new um.lM,e=new Oe.h({url:"",adaptor:new um.lM}),i=t.processQuery(e,o),r=JSON.parse(i.data);return r}function GD(o){for(var t=o.getVisibleColumns(),e=0,i=0,r=0;r<t.length;r++)isUndefined(t[r].width)?i++:t[r].width.toString().indexOf("%")!==-1&&e++;return(o.width==="auto"||typeof o.width=="string"&&o.width.indexOf("%")!==-1)&&!o.groupSettings.showGroupedColumn&&o.groupSettings.columns.length&&e&&!i}function KD(o,t,e,i,r){for(var n=i||0,s=r||0;s<t.length;s++)if(t[s].isDataRow){t[s].index=n,t[s].isAltRow=o.enableAltRow?n%2!=0:!1,e[s].setAttribute(literals.ariaRowIndex,n.toString()),t[s].isAltRow?e[s].classList.add("e-altrow"):e[s].classList.remove("e-altrow");for(var l=0;l<e[s].cells.length;l++)e[s].cells[l].setAttribute("index",n.toString());n++}t.length||o.renderModule.emptyRow(!0)}function XD(o,t,e,i){var r=o.dataToBeUpdated[e].concat(t[e]).reduce(function(n,s){return n[s[i]]=n[s[i]]===void 0?s:Object.assign(n[s[i]],s),n},{});o.dataToBeUpdated[e]=Object.keys(r).map(function(n){return r[n]})}function $D(o){if(o.isFrozenGrid()){o.contentModule.rowElements=[].slice.call(o.element.querySelectorAll(".e-movableheader .e-row, .e-movablecontent .e-row"));var t=o.getFrozenMode()===literals.leftRight?".e-frozen-left-header .e-row, .e-frozen-left-content .e-row":".e-frozenheader .e-row, .e-frozencontent .e-row";o.contentModule.freezeRowElements=[].slice.call(o.element.querySelectorAll(t)),o.getFrozenMode()===literals.leftRight&&(o.contentModule.frozenRightRowElements=[].slice.call(o.element.querySelectorAll(".e-frozen-right-header .e-row, .e-frozen-right-content .e-row")))}else o.contentModule.rowElements=[].slice.call(o.element.querySelectorAll(".e-row:not(.e-addedrow)"))}function QD(o,t,e){var i=o.getFrozenLeftCount(),r=o.getMovableColumnsCount(),n=o.getFrozenRightColumnsCount(),s=o.getFrozenMode(),l=o.isRowDragable()?1:0,h=s==="Right"?i+r:i+r+l,c=s==="Right"?i:i+l,u=s==="Right"?t.length-n-l:n?t.length-n:t.length;return e===literals.frozenLeft?t=t.slice(0,i?i+l:t.length):e===literals.frozenRight?t=t.slice(h,t.length):e==="movable"&&(t=t.slice(c,u)),t}function JD(o,t,e,i,r){(e[0].length||i)&&(r?t(literals.frozenLeft,e[0],r[0]):t(literals.frozenLeft,e[0])),o.isFrozenGrid()&&(e[1].length||i)&&(r?t("movable",e[1],r[1]):t("movable",e[1])),(o.getFrozenMode()===literals.leftRight||o.getFrozenMode()==="Right")&&(e[2].length||i)&&(r?t(literals.frozenRight,e[2],r[2]):t(literals.frozenRight,e[2]))}function eO(o){return[o.getFrozenMode()!=="Right"?o.getRowsObject():[],o.getMovableRowsObject(),o.getFrozenRightRowsObject()]}function tO(o){return[o.getFrozenMode()!=="Right"?o.getAllDataRows(!0):[],o.getAllMovableDataRows(!0),o.getAllFrozenRightDataRows(!0)]}function iO(o,t,e){for(var i=o.children,r=i.length,n=0,s=0;s<r;s++,n++)s>=t&&s<e||(o.removeChild(o.children[n]),n--)}function bS(o,t,e){return t.getFreezeTableName()==="movable"?[].slice.call(o.getMovableDataRows()[e].getElementsByClassName(literals.rowCell)):t.getFreezeTableName()===literals.frozenRight?[].slice.call(o.getFrozenRightDataRows()[e].getElementsByClassName(literals.rowCell)):[].slice.call(o.getDataRows()[e].getElementsByClassName(literals.rowCell))}function rO(o,t,e,i){var r=o.getFrozenLeftCount(),n=o.getMovableColumnsCount();return i=t.getFreezeTableName()==="movable"?i-r:t.getFreezeTableName()===literals.frozenRight?i-(r+n):i,bS(o,t,e)[i]}function nO(o,t,e,i,r,n,s){s||o.getFreezeTableName()===literals.frozenLeft||!t&&o.getFreezeTableName()===literals.frozenRight||n===1?e[nn(o.field)]=o.validationRules:o.getFreezeTableName()==="movable"||!o.getFreezeTableName()?i[nn(o.field)]=o.validationRules:o.getFreezeTableName()===literals.frozenRight&&(r[nn(o.field)]=o.validationRules)}function sO(o){var t;return o.isFrozenGrid()&&(t=o.frozenRows&&o.editSettings.newRowPosition==="Top"?o.getMovableHeaderTbody():o.getMovableContentTbody()),t}function aO(o){var t;return o.getFrozenMode()===literals.leftRight&&(t=o.frozenRows&&o.editSettings.newRowPosition==="Top"?o.getFrozenRightHeaderTbody():o.getFrozenRightContentTbody()),t}function oO(o,t,e,i,r,n,s){o&&i&&s(o,i),t&&r&&s(t,r),e&&n&&s(e,n)}function lO(o,t,e){var i,r=new Internationalization;if(t==="number")try{i=r.getNumberPattern({format:o,currency:this.currency,useGrouping:!0},!0)}catch(l){i=o}else if(t==="date"||t==="time"||t==="datetime")try{if(i=r.getDatePattern({skeleton:o,type:t},e),isNullOrUndefined(i))throw"error"}catch(l){try{i=r.getDatePattern({format:o,type:t},e)}catch(h){i=o}}else i=o;if(t!=="number"){var n=/G|H|c|'| a|yy|y|EEEE|E/g,s={G:"",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"};i=i.replace(n,function(l){return s[l]})}return i}function hO(o){if(o.enableAdaptiveUI)for(var t=document.getElementsByClassName("e-responsive-dialog"),e=0;e<t.length;e++)t[e].classList.add("e-bigger")}function wm(o,t){for(var e,i=o.split(".").length,r=o.split("."),n=t,s=0;s<i;s++)e=n[r[s]],n=e;return e}function cO(o,t,e,i,r,n){for(var s=Object.keys(o),l=0;l<s.length;l++){var h=o[s[l]].querySelectorAll("td.e-rowcell")[t];if(o[s[l]].querySelectorAll("td.e-rowcell").length&&h)if(setStyleAttribute(o[s[l]].querySelectorAll("td.e-rowcell")[t],{display:e}),o[s[l]].querySelectorAll("td.e-rowcell")[t].classList.contains("e-hide")&&removeClass([o[s[l]].querySelectorAll("td.e-rowcell")[t]],["e-hide"]),n&&r.isRowDragable()){var c=r.getFrozenColumns()?t:t+1;i[s[l]].cells[c].visible=e===""}else i[s[l]].cells[t].visible=e===""}}function uO(o,t,e,i){for(var r=0,n=t;r<n.length;r++){var s=n[r];e?o.on(s.event,s.handler,i):o.off(s.event,s.handler)}}function pO(o,t,e,i){var r=nn(t.field);return i=Object.assign(i,{id:o.element.id+r,name:r,"e-mappinguid":t.uid}),o.createElement("input",{className:e,attrs:i})}function dO(o,t){for(var e,i=0,r=o.columnModel;i<r.length;i++){var n=r[i];if(n.uid===t){e=n;break}}return e}function CS(o,t){var e;o.columnModel||o.getColumns();for(var i=0,r=o.columnModel;i<r.length;i++){var n=r[i];if(n.field===t){e=n;break}}return e}function xm(o,t,e,i){i.eventHandlers[o]={};for(var r=0;r<t.length;r++)i.eventHandlers[o][t[r]]=e[t[r]]}function Em(o,t,e){for(var i=0;i<t.length&&!o.isDestroyed;i++)o.removeEventListener(t[i],e.eventHandlers[o.element.id][t[i]])}function Am(o,t){o.destroyTemplate(t),o.isReact&&o.renderTemplates()}function fO(o){return parseInt(o.getAttribute(literals.ariaRowIndex),10)}function vO(o,t,e){for(var i=[],r=0;r<o.length;r++){var n=e.parent.getColumnByField(o[r]),s=t[r]==="null"?null:t[r],l={field:o[r],predicate:"or",uid:n.uid,operator:"equal",type:n.type,matchCase:e.allowCaseSensitive,ignoreAccent:e.parent.filterSettings.ignoreAccent};s===""||isNullOrUndefined(s)?i=i.concat(CheckBoxFilterBase.generateNullValuePredicates(l)):i.push($a({},{value:s},l))}return CheckBoxFilterBase.getPredicate(i)}function mO(o){for(var t=[],e=0,i=Object.keys(o);e<i.length;e++){var r=i[e];t.push(o[r])}return t}function gO(o,t){for(var e=[],i=[],r=o;r>=0&&!(t[r].isCaptionRow&&e.indexOf(t[r].data.field)===-1&&(t[r].indent<t[o].indent||r===o)&&(e.push(t[r].data.field),i.push(t[r].data.key),t[r].indent===0));r--);return{fields:e,keys:i}}var Tm=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ki=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},bn="e-other-month",ld="e-other-year",ol="e-calendar",Lm="e-device",SS="e-header",km="e-rtl",wS="e-content",hd="e-year",cd="e-month",Im="e-decade",Dm="e-icons",xS="e-prev",ES="e-next",AS="e-date-icon-prev",TS="e-date-icon-next ",LS="e-icon-container",zi="e-disabled",Ts="e-overlay",kS="e-weekend",ud="e-week-number",Sr="e-selected",hr="e-focused-date",Xh="e-month-hide",Om="e-today",IS="e-title",Rm="e-day",Mm="e-cell",DS="e-week-header",$h="e-zoomin",OS="e-footer-container",RS="e-btn",MS="e-flat",PS="e-css",NS="e-primary",Pm="e-calendar-day-header-lg",pd=864e5,BS=6e4,FS=function(o){Tm(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.effect="",r.isPopupClicked=!1,r.isDateSelected=!0,r.isTodayClicked=!1,r.preventChange=!1,r.isAngular=!1,r}return t.prototype.render=function(){this.rangeValidation(this.min,this.max),this.calendarEleCopy=this.element.cloneNode(!0),this.calendarMode==="Islamic"&&(+this.min.setSeconds(0)==+new Date(1900,0,1,0,0,0)&&(this.min=new Date(1944,2,18)),+this.max==+new Date(2099,11,31)&&(this.max=new Date(2069,10,16))),this.globalize=new a.eC(this.locale),((0,a.le)(this.firstDayOfWeek)||this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:this.globalize.getFirstDayOfWeek()},!0),this.todayDisabled=!1,this.todayDate=new Date(new Date().setHours(0,0,0,0)),this.getModuleName()==="calendar"?(this.element.classList.add(ol),this.enableRtl&&this.element.classList.add(km),a.AR.isDevice&&this.element.classList.add(Lm),(0,a.Y4)(this.element,{"data-role":"calendar"}),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.setAttribute("tabindex",this.tabIndex)):(this.calendarElement=this.createElement("div"),this.calendarElement.classList.add(ol),this.enableRtl&&this.calendarElement.classList.add(km),a.AR.isDevice&&this.calendarElement.classList.add(Lm),(0,a.Y4)(this.calendarElement,{role:"calendar"})),this.createHeader(),this.createContent(),this.wireEvents()},t.prototype.rangeValidation=function(e,i){(0,a.le)(e)&&this.setProperties({min:new Date(1900,0,1)},!0),(0,a.le)(i)&&this.setProperties({max:new Date(2099,11,31)},!0)},t.prototype.getDefaultKeyConfig=function(){return this.defaultKeyConfigs={controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",altUpArrow:"alt+uparrow",spacebar:"space",altRightArrow:"alt+rightarrow",altLeftArrow:"alt+leftarrow"},this.defaultKeyConfigs},t.prototype.validateDate=function(e){this.setProperties({min:this.checkDateValue(new Date(this.checkValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkValue(this.max)))},!0),this.currentDate=this.currentDate?this.currentDate:new Date(new Date().setHours(0,0,0,0)),!(0,a.le)(e)&&this.min<=this.max&&e>=this.min&&e<=this.max&&(this.currentDate=new Date(this.checkValue(e)))},t.prototype.setOverlayIndex=function(e,i,r,n){if(n&&!(0,a.le)(i)&&!(0,a.le)(r)&&!(0,a.le)(e)){var s=parseInt(i.style.zIndex,10)?parseInt(i.style.zIndex,10):1e3;r.style.zIndex=(s-1).toString(),e.style.zIndex=s.toString()}},t.prototype.minMaxUpdate=function(e){+this.min<=+this.max?(0,a.IV)([this.element],Ts):(this.setProperties({min:this.min},!0),(0,a.cn)([this.element],Ts)),this.min=(0,a.le)(this.min)||!+this.min?this.min=new Date(1900,0,1):this.min,this.max=(0,a.le)(this.max)||!+this.max?this.max=new Date(2099,11,31):this.max,+this.min<=+this.max&&e&&+e<=+this.max&&+e>=+this.min?this.currentDate=new Date(this.checkValue(e)):+this.min<=+this.max&&!e&&+this.currentDate>+this.max?this.currentDate=new Date(this.checkValue(this.max)):+this.currentDate<+this.min&&(this.currentDate=new Date(this.checkValue(this.min)))},t.prototype.createHeader=function(){var e={"aria-disabled":"false","aria-label":"previous month"},i={"aria-disabled":"false","aria-label":"next month"},r={"aria-atomic":"true","aria-live":"assertive","aria-label":"title"};this.headerElement=this.createElement("div",{className:SS});var n=this.createElement("div",{className:LS});this.previousIcon=this.createElement("button",{className:""+xS,attrs:{type:"button"}}),(0,a.qx)(this.previousIcon,{duration:400,selector:".e-prev",isCenterRipple:!0}),(0,a.Y4)(this.previousIcon,e),this.nextIcon=this.createElement("button",{className:""+ES,attrs:{type:"button"}}),(0,a.qx)(this.nextIcon,{selector:".e-next",duration:400,isCenterRipple:!0}),this.getModuleName()==="daterangepicker"&&((0,a.Y4)(this.previousIcon,{tabIndex:"-1"}),(0,a.Y4)(this.nextIcon,{tabIndex:"-1"})),(0,a.Y4)(this.nextIcon,i),this.headerTitleElement=this.createElement("div",{className:""+Rm+" "+IS}),(0,a.Y4)(this.headerTitleElement,r),this.headerElement.appendChild(this.headerTitleElement),this.previousIcon.appendChild(this.createElement("span",{className:""+AS+" "+Dm})),this.nextIcon.appendChild(this.createElement("span",{className:""+TS+" "+Dm})),n.appendChild(this.previousIcon),n.appendChild(this.nextIcon),this.headerElement.appendChild(n),this.getModuleName()==="calendar"?this.element.appendChild(this.headerElement):this.calendarElement.appendChild(this.headerElement),this.adjustLongHeaderSize()},t.prototype.createContent=function(){this.contentElement=this.createElement("div",{className:wS}),this.table=this.createElement("table",{attrs:{tabIndex:"0",role:"grid","aria-activedescendant":""}}),this.getModuleName()==="calendar"?this.element.appendChild(this.contentElement):this.calendarElement.appendChild(this.contentElement),this.contentElement.appendChild(this.table),this.createContentHeader(),this.createContentBody(),this.showTodayButton&&this.createContentFooter()},t.prototype.getCultureValues=function(){var e=[],i,r="days.stand-alone."+this.dayHeaderFormat.toLowerCase();this.locale==="en"||this.locale==="en-US"?i=(0,a.NA)(r,(0,a.bD)()):i=this.getCultureObjects(a.qV,""+this.locale);for(var n=0,s=Object.keys(i);n<s.length;n++){var l=s[n];e.push((0,a.NA)(l,i))}return e},t.prototype.toCapitalize=function(e){return!(0,a.le)(e)&&e.length?e[0].toUpperCase()+e.slice(1):e},t.prototype.createContentHeader=function(){this.getModuleName()==="calendar"?(0,a.le)(this.element.querySelectorAll(".e-content .e-week-header")[0])||(0,a.og)(this.element.querySelectorAll(".e-content .e-week-header")[0]):(0,a.le)(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0])||(0,a.og)(this.calendarElement.querySelectorAll(".e-content .e-week-header")[0]);var e=6,i="";(this.firstDayOfWeek>6||this.firstDayOfWeek<0)&&this.setProperties({firstDayOfWeek:0},!0),this.tableHeadElement=this.createElement("thead",{className:DS}),this.weekNumber&&(i+='<th class="e-week-number"></th>',this.getModuleName()==="calendar"?(0,a.cn)([this.element],""+ud):(0,a.cn)([this.calendarElement],""+ud));for(var r=this.shiftArray(this.getCultureValues().length>0&&this.getCultureValues(),this.firstDayOfWeek),n=0;n<=e;n++)i+='<th  class="">'+this.toCapitalize(r[n])+"</th>";i="<tr>"+i+"</tr>",this.tableHeadElement.innerHTML=i,this.table.appendChild(this.tableHeadElement)},t.prototype.createContentBody=function(){switch(this.getModuleName()==="calendar"?(0,a.le)(this.element.querySelectorAll(".e-content tbody")[0])||(0,a.og)(this.element.querySelectorAll(".e-content tbody")[0]):(0,a.le)(this.calendarElement.querySelectorAll(".e-content tbody")[0])||(0,a.og)(this.calendarElement.querySelectorAll(".e-content tbody")[0]),this.start){case"Year":this.renderYears();break;case"Decade":this.renderDecades();break;default:this.renderMonths()}},t.prototype.updateFooter=function(){this.todayElement.textContent=this.l10.getConstant("today"),this.todayElement.setAttribute("aria-label",this.l10.getConstant("today"))},t.prototype.createContentFooter=function(){if(this.showTodayButton){var e=new Date(+this.min),i=new Date(+this.max),r={today:"Today"};this.globalize=new a.eC(this.locale),this.l10=new a.E7(this.getModuleName(),r,this.locale),this.todayElement=this.createElement("button",{attrs:{role:"button"}}),(0,a.qx)(this.todayElement),this.updateFooter(),(0,a.cn)([this.todayElement],[RS,Om,MS,NS,PS]),(!(+new Date(e.setHours(0,0,0,0))<=+this.todayDate&&+this.todayDate<=+new Date(i.setHours(0,0,0,0)))||this.todayDisabled)&&(0,a.cn)([this.todayElement],zi),this.footer=this.createElement("div",{className:OS}),this.footer.appendChild(this.todayElement),this.getModuleName()==="calendar"&&this.element.appendChild(this.footer),this.getModuleName()==="datepicker"&&this.calendarElement.appendChild(this.footer),this.getModuleName()==="datetimepicker"&&this.calendarElement.appendChild(this.footer),this.todayElement.classList.contains(zi)||a.bi.add(this.todayElement,"click",this.todayButtonClick,this)}},t.prototype.wireEvents=function(e,i,r,n){a.bi.add(this.headerTitleElement,"click",this.navigateTitle,this),this.defaultKeyConfigs=(0,a.l7)(this.defaultKeyConfigs,this.keyConfigs),this.getModuleName()==="calendar"?this.keyboardModule=new a.nv(this.element,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs}):this.keyboardModule=new a.nv(this.calendarElement,{eventName:"keydown",keyAction:this.keyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})},t.prototype.dateWireEvents=function(e,i,r,n){this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.defaultKeyConfigs=(0,a.l7)(this.defaultKeyConfigs,r),this.serverModuleName=n},t.prototype.todayButtonClick=function(e,i,r){this.showTodayButton&&(this.currentView()===this.depth?this.effect="":this.effect="e-zoomin",this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.navigateTo(this.depth,new Date(this.checkValue(i)),r):this.navigateTo("Month",new Date(this.checkValue(i)),r))},t.prototype.resetCalendar=function(){this.calendarElement&&(0,a.og)(this.calendarElement),this.tableBodyElement&&(0,a.og)(this.tableBodyElement),this.table&&(0,a.og)(this.table),this.tableHeadElement&&(0,a.og)(this.tableHeadElement),this.nextIcon&&(0,a.og)(this.nextIcon),this.previousIcon&&(0,a.og)(this.previousIcon),this.footer&&(0,a.og)(this.footer),this.todayElement=null,this.renderDayCellArgs=null,this.calendarElement=this.tableBodyElement=this.footer=this.tableHeadElement=this.nextIcon=this.previousIcon=this.table=null},t.prototype.keyActionHandle=function(e,i,r){var n=this.tableBodyElement.querySelector("tr td.e-focused-date"),s;r?!(0,a.le)(n)&&+i===parseInt(n.getAttribute("id").split("_")[0],10)?s=n:s=this.tableBodyElement.querySelector("tr td.e-selected"):s=this.tableBodyElement.querySelector("tr td.e-selected");var l=this.getViewNumber(this.currentView()),h=this.getViewNumber(this.depth),c=l===h&&this.getViewNumber(this.start)>=h;switch(this.effect="",e.action){case"moveLeft":this.keyboardNavigate(-1,l,e,this.max,this.min),e.preventDefault();break;case"moveRight":this.keyboardNavigate(1,l,e,this.max,this.min),e.preventDefault();break;case"moveUp":l===0?this.keyboardNavigate(-7,l,e,this.max,this.min):this.keyboardNavigate(-4,l,e,this.max,this.min),e.preventDefault();break;case"moveDown":l===0?this.keyboardNavigate(7,l,e,this.max,this.min):this.keyboardNavigate(4,l,e,this.max,this.min),e.preventDefault();break;case"select":if(e.target===this.todayElement)this.todayButtonClick(e,i);else{var u=(0,a.le)(n)?s:n;if(!(0,a.le)(u)&&!u.classList.contains(zi))if(c){var p=new Date(parseInt(""+u.id,0));this.selectDate(e,p,u)}else this.contentClick(null,--l,u,i)}break;case"controlUp":this.title(),e.preventDefault();break;case"controlDown":(!(0,a.le)(n)||!(0,a.le)(s)&&!c)&&this.contentClick(null,--l,n||s,i),e.preventDefault();break;case"home":this.currentDate=this.firstDay(this.currentDate),(0,a.og)(this.tableBodyElement),l===0?this.renderMonths(e):l===1?this.renderYears(e):this.renderDecades(e),e.preventDefault();break;case"end":this.currentDate=this.lastDay(this.currentDate,l),(0,a.og)(this.tableBodyElement),l===0?this.renderMonths(e):l===1?this.renderYears(e):this.renderDecades(e),e.preventDefault();break;case"pageUp":this.addMonths(this.currentDate,-1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"pageDown":this.addMonths(this.currentDate,1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"shiftPageUp":this.addYears(this.currentDate,-1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"shiftPageDown":this.addYears(this.currentDate,1),this.navigateTo("Month",this.currentDate),e.preventDefault();break;case"controlHome":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),0,1)),e.preventDefault();break;case"controlEnd":this.navigateTo("Month",new Date(this.currentDate.getFullYear(),11,31)),e.preventDefault();break}this.getModuleName()==="calendar"&&this.table.focus()},t.prototype.keyboardNavigate=function(e,i,r,n,s){var l=new Date(this.checkValue(this.currentDate));switch(i){case 2:this.addYears(this.currentDate,e),this.isMonthYearRange(this.currentDate)?((0,a.og)(this.tableBodyElement),this.renderDecades(r)):this.currentDate=l;break;case 1:this.addMonths(this.currentDate,e),this.calendarMode==="Gregorian"?this.isMonthYearRange(this.currentDate)?((0,a.og)(this.tableBodyElement),this.renderYears(r)):this.currentDate=l:this.isMonthYearRange(this.currentDate)?((0,a.og)(this.tableBodyElement),this.renderYears(r)):this.currentDate=l;break;case 0:this.addDay(this.currentDate,e,r,n,s),this.isMinMaxRange(this.currentDate)?((0,a.og)(this.tableBodyElement),this.renderMonths(r)):this.currentDate=l;break}},t.prototype.preRender=function(e){var i=this;this.navigatePreviousHandler=this.navigatePrevious.bind(this),this.navigateNextHandler=this.navigateNext.bind(this),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.navigateHandler=function(r){i.triggerNavigate(r)}},t.prototype.minMaxDate=function(e){var i=new Date(new Date(+e).setHours(0,0,0,0)),r=new Date(new Date(+this.min).setHours(0,0,0,0)),n=new Date(new Date(+this.max).setHours(0,0,0,0));return(+i==+r||+i==+n)&&(+e<+this.min&&(e=new Date(+this.min)),+e>+this.max&&(e=new Date(+this.max))),e},t.prototype.renderMonths=function(e,i,r){var n=this.weekNumber?8:7,s;this.calendarMode==="Gregorian"?s=this.renderDays(this.currentDate,i,null,null,r):s=this.islamicModule.islamicRenderDays(this.currentDate,i),this.createContentHeader(),this.calendarMode==="Gregorian"?this.renderTemplate(s,n,cd,e,i):this.islamicModule.islamicRenderTemplate(s,n,cd,e,i)},t.prototype.renderDays=function(e,i,r,n,s){var l=[],h=42,c=s?new Date(+e):this.getDate(new Date,this.timezone),u=new Date(this.checkValue(e)),p,f=u.getMonth();this.titleUpdate(e,"days");var g=u;for(u=new Date(g.getFullYear(),g.getMonth(),0,g.getHours(),g.getMinutes(),g.getSeconds(),g.getMilliseconds());u.getDay()!==this.firstDayOfWeek;)this.setStartDate(u,-1*pd);for(var C=0;C<h;++C){var L=this.createElement("td",{className:Mm}),D=this.createElement("span");if(C%7==0&&this.weekNumber){var R=this.weekRule==="FirstDay"?6:this.weekRule==="FirstFourDayWeek"?3:0,B=new Date(u.getFullYear(),u.getMonth(),u.getDate()+R);D.textContent=""+this.getWeek(B),L.appendChild(D),(0,a.cn)([L],""+ud),l.push(L)}p=new Date(+u),u=this.minMaxDate(u);var H={type:"dateTime",skeleton:"full"},j=this.globalize.parseDate(this.globalize.formatDate(u,H),H),W=this.dayCell(u),ne=this.globalize.formatDate(u,{type:"date",skeleton:"full"}),ie=this.createElement("span");ie.textContent=this.globalize.formatDate(u,{format:"d",type:"date",skeleton:"yMd"});var me=this.min>u||this.max<u;me?((0,a.cn)([W],zi),(0,a.cn)([W],Ts)):ie.setAttribute("title",""+ne),f!==u.getMonth()&&(0,a.cn)([W],bn),(u.getDay()===0||u.getDay()===6)&&(0,a.cn)([W],kS),W.appendChild(ie),this.renderDayCellArgs={date:u,isDisabled:!1,element:W,isOutOfRange:me};var ve=this.renderDayCellArgs;if(this.renderDayCellEvent(ve),ve.isDisabled){var Ee=new Date(this.checkValue(i)),le=new Date(this.checkValue(ve.date));if(r){if(!(0,a.le)(n)&&n.length>0)for(var de=0;de<n.length;de++){var fe=+new Date(this.globalize.formatDate(ve.date,{type:"date",skeleton:"yMd"})),Le=+new Date(this.globalize.formatDate(n[de],{type:"date",skeleton:"yMd"}));fe===Le&&(n.splice(de,1),de=-1)}}else Ee&&+Ee==+le&&this.setProperties({value:null},!0)}this.renderDayCellArgs.isDisabled&&!W.classList.contains(Sr)&&((0,a.cn)([W],zi),(0,a.cn)([W],Ts),+this.renderDayCellArgs.date==+this.todayDate&&(this.todayDisabled=!0));var ke=W.classList.contains(bn),Me=W.classList.contains(zi);if(Me||a.bi.add(W,"click",this.clickHandler,this),r&&!(0,a.le)(n)&&!Me){for(var De=0;De<n.length;De++){var Fe=this.calendarMode==="Gregorian"?"gregorian":"islamic",Pe={format:null,type:"date",skeleton:"short",calendar:Fe},fe=this.globalize.formatDate(u,Pe),Le=this.globalize.formatDate(n[De],Pe);fe===Le&&this.getDateVal(u,n[De])||this.getDateVal(u,i)?(0,a.cn)([W],Sr):this.updateFocus(ke,Me,u,W,e)}n.length<=0&&this.updateFocus(ke,Me,u,W,e)}else!Me&&this.getDateVal(u,i)&&(0,a.cn)([W],Sr);this.updateFocus(ke,Me,u,W,e),j.getFullYear()===c.getFullYear()&&j.getMonth()===c.getMonth()&&j.getDate()===c.getDate()&&(0,a.cn)([W],Om),l.push(this.renderDayCellArgs.element),u=new Date(+p),this.addDay(u,1,null,this.max,this.min)}return l},t.prototype.updateFocus=function(e,i,r,n,s){s.getDate()===r.getDate()&&!e&&!i?(0,a.cn)([n],hr):(s>=this.max&&parseInt(n.id,0)===+this.max&&!e&&!i&&(0,a.cn)([n],hr),s<=this.min&&parseInt(n.id,0)===+this.min&&!e&&!i&&(0,a.cn)([n],hr))},t.prototype.renderYears=function(e,i){this.removeTableHeadElement();var r=4,n=[],s=(0,a.le)(i),l=new Date(this.checkValue(this.currentDate)),h=l.getMonth(),c=l.getFullYear(),u=l,p=u.getFullYear(),f=new Date(this.checkValue(this.min)).getFullYear(),g=new Date(this.checkValue(this.min)).getMonth(),C=new Date(this.checkValue(this.max)).getFullYear(),L=new Date(this.checkValue(this.max)).getMonth();u.setMonth(0),this.titleUpdate(this.currentDate,"months"),u.setDate(1);for(var D=0;D<12;++D){var R=this.dayCell(u),B=this.createElement("span"),H=i&&i.getMonth()===u.getMonth(),j=i&&i.getFullYear()===c&&H;B.textContent=this.toCapitalize(this.globalize.formatDate(u,{format:null,type:"dateTime",skeleton:"MMM"})),this.min&&(p<f||D<g&&p===f)||this.max&&(p>C||D>L&&p>=C)?(0,a.cn)([R],zi):!s&&j?(0,a.cn)([R],Sr):u.getMonth()===h&&this.currentDate.getMonth()===h&&(0,a.cn)([R],hr),u.setDate(1),u.setMonth(u.getMonth()+1),R.classList.contains(zi)||a.bi.add(R,"click",this.clickHandler,this),R.appendChild(B),n.push(R)}this.renderTemplate(n,r,hd,e,i)},t.prototype.renderDecades=function(e,i){this.removeTableHeadElement();var r=4,n=12,s=[],l=new Date(this.checkValue(this.currentDate));l.setMonth(0),l.setDate(1);var h=l.getFullYear(),c=new Date(l.setFullYear(h-h%10)),u=new Date(l.setFullYear(h-h%10+(10-1))),p=c.getFullYear(),f=u.getFullYear(),g=this.globalize.formatDate(c,{format:null,type:"dateTime",skeleton:"y"}),C=this.globalize.formatDate(u,{format:null,type:"dateTime",skeleton:"y"});this.headerTitleElement.textContent=g+" - "+C;for(var L=new Date(h-h%10-1,0,1),D=L.getFullYear(),R=0;R<n;++R){var B=D+R;l.setFullYear(B);var H=this.dayCell(l);(0,a.Y4)(H,{role:"gridcell"});var j=this.createElement("span");j.textContent=this.globalize.formatDate(l,{format:null,type:"dateTime",skeleton:"y"}),B<p||B>f?((0,a.cn)([H],ld),!(0,a.le)(i)&&l.getFullYear()===i.getFullYear()&&(0,a.cn)([H],Sr),(B<new Date(this.checkValue(this.min)).getFullYear()||B>new Date(this.checkValue(this.max)).getFullYear())&&(0,a.cn)([H],zi)):B<new Date(this.checkValue(this.min)).getFullYear()||B>new Date(this.checkValue(this.max)).getFullYear()?(0,a.cn)([H],zi):!(0,a.le)(i)&&l.getFullYear()===i.getFullYear()?(0,a.cn)([H],Sr):l.getFullYear()===this.currentDate.getFullYear()&&!H.classList.contains(zi)&&(0,a.cn)([H],hr),H.classList.contains(zi)||a.bi.add(H,"click",this.clickHandler,this),H.appendChild(j),s.push(H)}this.renderTemplate(s,r,"e-decade",e,i)},t.prototype.dayCell=function(e){var i=this.calendarMode==="Gregorian"?"gregorian":"islamic",r={skeleton:"full",type:"dateTime",calendar:i},n=this.globalize.parseDate(this.globalize.formatDate(e,r),r),s=n.valueOf(),l={className:Mm,attrs:{id:""+(0,a.QI)(""+s),"aria-selected":"false",role:"gridcell"}};return this.createElement("td",l)},t.prototype.firstDay=function(e){var i=this.currentView()!=="Decade"?this.tableBodyElement.querySelectorAll("td:not(."+bn+""):this.tableBodyElement.querySelectorAll("td:not(."+ld+"");if(i.length){for(var r=0;r<i.length;r++)if(!i[r].classList.contains(zi)){e=new Date(parseInt(i[r].id,0));break}}return e},t.prototype.lastDay=function(e,i){var r=new Date(e.getFullYear(),e.getMonth()+1,0);if(i!==2){var n=Math.abs(r.getTimezoneOffset()-this.firstDay(e).getTimezoneOffset());return n&&r.setHours(this.firstDay(e).getHours()+n/60),this.findLastDay(r)}else return this.findLastDay(this.firstDay(r))},t.prototype.checkDateValue=function(e){return!(0,a.le)(e)&&e instanceof Date&&!isNaN(+e)?e:null},t.prototype.findLastDay=function(e){var i=this.currentView()==="Decade"?this.tableBodyElement.querySelectorAll("td:not(."+ld+""):this.tableBodyElement.querySelectorAll("td:not(."+bn+"");if(i.length){for(var r=i.length-1;r>=0;r--)if(!i[r].classList.contains(zi)){e=new Date(parseInt(i[r].id,0));break}}return e},t.prototype.removeTableHeadElement=function(){this.getModuleName()==="calendar"?(0,a.le)(this.element.querySelectorAll(".e-content table thead")[0])||(0,a.og)(this.tableHeadElement):(0,a.le)(this.calendarElement.querySelectorAll(".e-content table thead")[0])||(0,a.og)(this.tableHeadElement)},t.prototype.renderTemplate=function(e,i,r,n,s){var l=this.getViewNumber(this.currentView()),h;this.tableBodyElement=this.createElement("tbody"),this.table.appendChild(this.tableBodyElement),(0,a.IV)([this.contentElement,this.headerElement],[cd,Im,hd]),(0,a.cn)([this.contentElement,this.headerElement],[r]);for(var c=41,u=35,p=6,f=i,g=0,C=0;C<e.length/i;++C){for(h=this.createElement("tr",{attrs:{role:"row"}}),g=0+g;g<f;g++)!e[g].classList.contains("e-week-number")&&!(0,a.le)(e[g].children[0])&&((0,a.cn)([e[g].children[0]],[Rm]),(0,a.qx)(e[g].children[0],{duration:600,isCenterRipple:!0})),h.appendChild(e[g]),this.weekNumber&&g===p+1&&e[p+1].classList.contains(bn)&&(0,a.cn)([h],Xh),!this.weekNumber&&g===p&&e[p].classList.contains(bn)&&(0,a.cn)([h],Xh),this.weekNumber?g===c&&e[c].classList.contains(bn)&&(0,a.cn)([h],Xh):g===u&&e[u].classList.contains(bn)&&(0,a.cn)([h],Xh);f=f+i,g=g+0,this.tableBodyElement.appendChild(h)}this.table.querySelector("tbody").className=this.effect,this.calendarMode==="Gregorian"?this.iconHandler():this.islamicModule.islamicIconHandler(),(l!==this.getViewNumber(this.currentView())||l===0&&l!==this.getViewNumber(this.currentView()))&&this.navigateHandler(n),this.setAriaActiveDescendant()},t.prototype.clickHandler=function(e,i){this.clickEventEmitter(e);var r=e.currentTarget,n=this.getViewNumber(this.currentView());r.classList.contains(bn)?this.contentClick(e,0,null,i):n===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?this.contentClick(e,1,null,i):n===2?this.contentClick(e,1,null,i):!r.classList.contains(bn)&&n===0?this.selectDate(e,this.getIdValue(e,null),null):this.contentClick(e,0,r,i),this.getModuleName()==="calendar"&&this.table.focus()},t.prototype.clickEventEmitter=function(e){e.preventDefault()},t.prototype.contentClick=function(e,i,r,n){var s=this.getViewNumber(this.currentView()),l=this.getIdValue(e,r);switch(i){case 0:s===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth)?((0,a.og)(this.tableBodyElement),this.currentDate=l,this.effect=$h,this.renderMonths(e)):(this.calendarMode==="Gregorian"?(this.currentDate.setMonth(l.getMonth()),l.getMonth()>0&&this.currentDate.getMonth()!==l.getMonth()&&this.currentDate.setDate(0),this.currentDate.setFullYear(l.getFullYear())):this.currentDate=l,this.effect=$h,(0,a.og)(this.tableBodyElement),this.renderMonths(e));break;case 1:if(s===this.getViewNumber(this.depth)&&this.getViewNumber(this.start)>=this.getViewNumber(this.depth))this.selectDate(e,l,null);else{if(this.calendarMode==="Gregorian")this.currentDate.setFullYear(l.getFullYear());else{var h=this.islamicModule.getIslamicDate(l);this.currentDate=this.islamicModule.toGregorian(h.year,h.month,1)}this.effect=$h,(0,a.og)(this.tableBodyElement),this.renderYears(e)}}},t.prototype.switchView=function(e,i,r,n){switch(e){case 0:(0,a.og)(this.tableBodyElement),this.renderMonths(i,null,n),r&&!(0,a.le)(this.tableBodyElement.querySelectorAll("."+hr)[0])&&this.tableBodyElement.querySelectorAll("."+hr)[0].classList.remove(hr);break;case 1:(0,a.og)(this.tableBodyElement),this.renderYears(i);break;case 2:(0,a.og)(this.tableBodyElement),this.renderDecades(i)}},t.prototype.getModuleName=function(){return"calendar"},t.prototype.requiredModules=function(){var e=[];return this&&e.push({args:[this],member:"islamic"}),e},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.onPropertyChanged=function(e,i,r,n){this.effect="";for(var s=0,l=Object.keys(e);s<l.length;s++){var h=l[s];switch(h){case"enableRtl":e.enableRtl?this.getModuleName()==="calendar"?this.element.classList.add("e-rtl"):this.calendarElement.classList.add("e-rtl"):this.getModuleName()==="calendar"?this.element.classList.remove("e-rtl"):this.calendarElement.classList.remove("e-rtl");break;case"dayHeaderFormat":this.getCultureValues(),this.getModuleName()!=="datepicker"?this.createContentHeader():this.calendarElement&&this.createContentHeader(),this.adjustLongHeaderSize();break;case"min":case"max":this.rangeValidation(this.min,this.max),h==="min"?this.setProperties({min:this.checkDateValue(new Date(this.checkValue(e.min)))},!0):this.setProperties({max:this.checkDateValue(new Date(this.checkValue(e.max)))},!0),this.setProperties({start:this.currentView()},!0),this.tableBodyElement&&(0,a.og)(this.tableBodyElement),this.minMaxUpdate(),r&&this.validateValues(r,n),this.getModuleName()!=="datepicker"?this.createContentBody():this.calendarElement&&this.createContentBody(),(this.todayDate<this.min||this.max<this.todayDate)&&this.footer&&this.todayElement?((0,a.og)(this.todayElement),(0,a.og)(this.footer),this.todayElement=this.footer=null,this.createContentFooter()):this.footer&&this.todayElement&&this.todayElement.classList.contains("e-disabled")&&((0,a.IV)([this.todayElement],zi),(0,a.og)(this.todayElement),(0,a.og)(this.footer),this.todayElement=this.footer=null,this.createContentFooter());break;case"start":case"depth":case"weekNumber":case"firstDayOfWeek":case"weekRule":this.checkView(),this.getModuleName()!=="datepicker"?(this.createContentHeader(),this.createContentBody()):this.calendarElement&&(this.createContentHeader(),this.createContentBody());break;case"locale":this.globalize=new a.eC(this.locale),this.getModuleName()!=="datepicker"?(this.createContentHeader(),this.createContentBody()):this.calendarElement&&(this.createContentHeader(),this.createContentBody()),this.l10.setLocale(this.locale),this.updateFooter();break;case"showTodayButton":e.showTodayButton?this.createContentFooter():!(0,a.le)(this.todayElement)&&!(0,a.le)(this.footer)&&((0,a.og)(this.todayElement),(0,a.og)(this.footer),this.todayElement=this.footer=void 0),this.setProperties({showTodayButton:e.showTodayButton},!0);break}}},t.prototype.validateValues=function(e,i){if(e&&!(0,a.le)(i)&&i.length>0){for(var r=this.copyValues(i),n=0;n<r.length;n++){var s=r[n],l=this.calendarMode==="Gregorian"?"gregorian":"islamic",h=void 0;this.calendarMode==="Gregorian"?h=this.globalize.formatDate(s,{type:"date",skeleton:"yMd"}):h=this.globalize.formatDate(s,{type:"dateTime",skeleton:"full",calendar:"islamic"});var c={type:"date",skeleton:"yMd",calendar:l},u=this.globalize.formatDate(this.min,c),p=u,f={type:"date",skeleton:"yMd",calendar:l},g=this.globalize.formatDate(this.max,f),C=g;(+new Date(h)<+new Date(p)||+new Date(h)>+new Date(C))&&(r.splice(n,1),n=-1)}this.setProperties({values:r},!0)}},t.prototype.setValueUpdate=function(){(0,a.le)(this.tableBodyElement)||((0,a.og)(this.tableBodyElement),this.setProperties({start:this.currentView()},!0),this.createContentBody())},t.prototype.copyValues=function(e){var i=[];if(!(0,a.le)(e)&&e.length>0)for(var r=0;r<e.length;r++)i.push(new Date(+e[r]));return i},t.prototype.titleUpdate=function(e,i){var r=new a.eC(this.locale),n,s,l=this.calendarMode==="Gregorian"?"gregorian":"islamic";switch(this.calendarMode==="Gregorian"?(n=r.formatDate(e,{type:"dateTime",skeleton:"yMMMM",calendar:l}),s=r.formatDate(e,{format:null,type:"dateTime",skeleton:"y",calendar:l})):(n=r.formatDate(e,{type:"dateTime",format:"MMMM y",calendar:l}),s=r.formatDate(e,{type:"dateTime",format:"y",calendar:l})),i){case"days":this.headerTitleElement.textContent=this.toCapitalize(n);break;case"months":this.headerTitleElement.textContent=s}},t.prototype.setActiveDescendant=function(){var e,i=this.tableBodyElement.querySelector("tr td.e-focused-date"),r=this.tableBodyElement.querySelector("tr td.e-selected"),n=this.calendarMode==="Gregorian"?"gregorian":"islamic",s,l=this.currentView();return l==="Month"?s=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"full",calendar:n}):l==="Year"?n!=="islamic"?s=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"yMMMM",calendar:n}):s=this.globalize.formatDate(this.currentDate,{type:"date",skeleton:"GyMMM",calendar:n}):s=this.globalize.formatDate(this.currentDate,{format:null,type:"date",skeleton:"y",calendar:n}),(r||i)&&((0,a.le)(r)||r.setAttribute("aria-selected","true"),(i||r).setAttribute("aria-label",s),e=(i||r).getAttribute("id")),e},t.prototype.iconHandler=function(){switch(new Date(this.checkValue(this.currentDate)).setDate(1),this.currentView()){case"Month":this.previousIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareMonth(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Year":this.previousIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareYear(new Date(this.checkValue(this.currentDate)),this.max)>-1);break;case"Decade":this.previousIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.min)<1),this.nextIconHandler(this.compareDecade(new Date(this.checkValue(this.currentDate)),this.max)>-1)}},t.prototype.destroy=function(){this.getModuleName()==="calendar"&&this.element?(0,a.IV)([this.element],[ol]):this.calendarElement&&this.element&&(0,a.IV)([this.element],[ol]),this.getModuleName()==="calendar"&&this.element&&(a.bi.remove(this.headerTitleElement,"click",this.navigateTitle),this.todayElement&&a.bi.remove(this.todayElement,"click",this.todayButtonClick),this.previousIconHandler(!0),this.nextIconHandler(!0),this.keyboardModule.destroy(),this.element.removeAttribute("data-role"),(0,a.le)(this.calendarEleCopy.getAttribute("tabindex"))?this.element.removeAttribute("tabindex"):this.element.setAttribute("tabindex",this.tabIndex)),this.element&&(this.element.innerHTML=""),o.prototype.destroy.call(this)},t.prototype.title=function(e){var i=this.getViewNumber(this.currentView());this.effect=$h,this.switchView(++i,e)},t.prototype.getViewNumber=function(e){return e==="Month"?0:e==="Year"?1:2},t.prototype.navigateTitle=function(e){e.preventDefault(),this.title(e),this.getModuleName()==="calendar"&&this.table.focus()},t.prototype.previous=function(){this.effect="";var e=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,-1),this.switchView(e);break;case"Year":this.addYears(this.currentDate,-1),this.switchView(e);break;case"Decade":this.addYears(this.currentDate,-10),this.switchView(e);break}},t.prototype.navigatePrevious=function(e){e.preventDefault(),this.calendarMode==="Gregorian"?this.previous():this.islamicModule.islamicPrevious(),this.triggerNavigate(e),this.getModuleName()==="calendar"&&this.table.focus()},t.prototype.next=function(){this.effect="";var e=this.getViewNumber(this.currentView());switch(this.currentView()){case"Month":this.addMonths(this.currentDate,1),this.switchView(e);break;case"Year":this.addYears(this.currentDate,1),this.switchView(e);break;case"Decade":this.addYears(this.currentDate,10),this.switchView(e);break}},t.prototype.navigateNext=function(e){e.preventDefault(),this.calendarMode==="Gregorian"?this.next():this.islamicModule.islamicNext(),this.triggerNavigate(e),this.getModuleName()==="calendar"&&this.table.focus()},t.prototype.navigateTo=function(e,i,r){+i>=+this.min&&+i<=+this.max&&(this.currentDate=i),+i<=+this.min&&(this.currentDate=new Date(this.checkValue(this.min))),+i>=+this.max&&(this.currentDate=new Date(this.checkValue(this.max))),this.getViewNumber(this.depth)>=this.getViewNumber(e)&&(this.getViewNumber(this.depth)<=this.getViewNumber(this.start)||this.getViewNumber(this.depth)===this.getViewNumber(e))&&(e=this.depth),this.switchView(this.getViewNumber(e),null,null,r)},t.prototype.currentView=function(){return this.contentElement.classList.contains(hd)?"Year":this.contentElement.classList.contains(Im)?"Decade":"Month"},t.prototype.getDateVal=function(e,i){return!(0,a.le)(i)&&e.getDate()===i.getDate()&&e.getMonth()===i.getMonth()&&e.getFullYear()===i.getFullYear()},t.prototype.getCultureObjects=function(e,i){var r=".dates.calendars.gregorian.days.format."+this.dayHeaderFormat.toLowerCase(),n=".dates.calendars.islamic.days.format."+this.dayHeaderFormat.toLowerCase(),s="main.";return this.calendarMode==="Gregorian"?(0,a.NA)(s+""+this.locale+r,e):(0,a.NA)("main."+this.locale+n,e)},t.prototype.getWeek=function(e){var i=new Date(this.checkValue(e)).valueOf(),r=new Date(e.getFullYear(),0,1).valueOf();return Math.ceil((i-r+pd)/pd/7)},t.prototype.setStartDate=function(e,i){var r=e.getTimezoneOffset(),n=new Date(e.getTime()+i),s=n.getTimezoneOffset()-r;e.setTime(n.getTime()+s*BS)},t.prototype.addMonths=function(e,i){if(this.calendarMode==="Gregorian"){var r=e.getDate();e.setDate(1),e.setMonth(e.getMonth()+i),e.setDate(Math.min(r,this.getMaxDays(e)))}else{var n=this.islamicModule.getIslamicDate(e);this.currentDate=this.islamicModule.toGregorian(n.year,n.month+i,1)}},t.prototype.addYears=function(e,i){if(this.calendarMode==="Gregorian"){var r=e.getDate();e.setDate(1),e.setFullYear(e.getFullYear()+i),e.setDate(Math.min(r,this.getMaxDays(e)))}else{var n=this.islamicModule.getIslamicDate(e);this.currentDate=this.islamicModule.toGregorian(n.year+i,n.month,1)}},t.prototype.getIdValue=function(e,i){var r;e?r=e.currentTarget:r=i;var n=this.calendarMode==="Gregorian"?"gregorian":"islamic",s={type:"dateTime",skeleton:"full",calendar:n},l=this.globalize.formatDate(new Date(parseInt(""+r.getAttribute("id"),0)),s),h=this.globalize.parseDate(l,s),c=h.valueOf()-h.valueOf()%1e3;return new Date(c)},t.prototype.adjustLongHeaderSize=function(){(0,a.IV)([this.element],Pm),this.dayHeaderFormat==="Wide"&&(0,a.cn)([this.getModuleName()==="calendar"?this.element:this.calendarElement],Pm)},t.prototype.selectDate=function(e,i,r,n,s){var l=r||e.currentTarget;if(this.isDateSelected=!1,this.currentView()==="Decade")this.setDateDecade(this.currentDate,i.getFullYear());else if(this.currentView()==="Year")this.setDateYear(this.currentDate,i);else{if(n&&!this.checkPresentDate(i,s)){var h=this.copyValues(s);!(0,a.le)(s)&&h.length>0?(h.push(new Date(this.checkValue(i))),this.setProperties({values:h},!0),this.setProperties({value:s[s.length-1]},!0)):this.setProperties({values:[new Date(this.checkValue(i))]},!0)}else this.setProperties({value:new Date(this.checkValue(i))},!0);this.currentDate=new Date(this.checkValue(i))}var c=(0,a.oq)(l,"."+ol);if((0,a.le)(c)&&(c=this.tableBodyElement),!n&&!(0,a.le)(c.querySelector("."+Sr))&&(0,a.IV)([c.querySelector("."+Sr)],Sr),!n&&!(0,a.le)(c.querySelector("."+hr))&&(0,a.IV)([c.querySelector("."+hr)],hr),n){for(var h=this.copyValues(s),u=Array.prototype.slice.call(this.tableBodyElement.querySelectorAll("td")),p=0;p<u.length;p++){var f=c.querySelectorAll("td."+hr)[0],g=c.querySelectorAll("td."+Sr)[0];u[p]===f&&(0,a.IV)([u[p]],hr),u[p]===g&&!this.checkPresentDate(new Date(parseInt(g.getAttribute("id").split("_")[0],10)),s)&&(0,a.IV)([u[p]],Sr)}if(l.classList.contains(Sr)){(0,a.IV)([l],Sr);for(var C=0;C<h.length;C++){var L=this.calendarMode==="Gregorian"?"gregorian":"islamic",D={format:null,type:"date",skeleton:"short",calendar:L},R=this.globalize.formatDate(i,D),B=this.globalize.formatDate(h[C],D);if(R===B){var p=h.indexOf(h[C]);h.splice(p,1),(0,a.cn)([l],hr)}}this.setProperties({values:h},!0)}else(0,a.cn)([l],Sr)}else(0,a.cn)([l],Sr);this.isDateSelected=!0},t.prototype.checkPresentDate=function(e,i){var r=!1;if(!(0,a.le)(i))for(var n=0;n<i.length;n++){var s=this.calendarMode==="Gregorian"?"gregorian":"islamic",l=this.globalize.formatDate(e,{format:null,type:"date",skeleton:"short",calendar:s}),h=this.globalize.formatDate(i[n],{format:null,type:"date",skeleton:"short",calendar:s});l===h&&(r=!0)}return r},t.prototype.setAriaActiveDescendant=function(){(0,a.Y4)(this.table,{"aria-activedescendant":""+this.setActiveDescendant()})},t.prototype.previousIconHandler=function(e){e?(a.bi.remove(this.previousIcon,"click",this.navigatePreviousHandler),(0,a.cn)([this.previousIcon],""+zi),(0,a.cn)([this.previousIcon],""+Ts),this.previousIcon.setAttribute("aria-disabled","true")):(a.bi.add(this.previousIcon,"click",this.navigatePreviousHandler),(0,a.IV)([this.previousIcon],""+zi),(0,a.IV)([this.previousIcon],""+Ts),this.previousIcon.setAttribute("aria-disabled","false"))},t.prototype.renderDayCellEvent=function(e){(0,a.l7)(this.renderDayCellArgs,{name:"renderDayCell"}),this.trigger("renderDayCell",e)},t.prototype.navigatedEvent=function(e){(0,a.l7)(this.navigatedArgs,{name:"navigated",event:e}),this.trigger("navigated",this.navigatedArgs)},t.prototype.triggerNavigate=function(e){this.navigatedArgs={view:this.currentView(),date:this.currentDate},this.navigatedEvent(e)},t.prototype.nextIconHandler=function(e){e?(a.bi.remove(this.nextIcon,"click",this.navigateNextHandler),(0,a.cn)([this.nextIcon],zi),(0,a.cn)([this.nextIcon],Ts),this.nextIcon.setAttribute("aria-disabled","true")):(a.bi.add(this.nextIcon,"click",this.navigateNextHandler),(0,a.IV)([this.nextIcon],zi),(0,a.IV)([this.nextIcon],Ts),this.nextIcon.setAttribute("aria-disabled","false"))},t.prototype.compare=function(e,i,r){var n=i.getFullYear(),s,l;return s=n,l=0,r&&(n=n-n%r,s=n-n%r+r-1),e.getFullYear()>s?l=1:e.getFullYear()<n&&(l=-1),l},t.prototype.isMinMaxRange=function(e){return+e>=+this.min&&+e<=+this.max},t.prototype.isMonthYearRange=function(e){if(this.calendarMode==="Gregorian")return e.getMonth()>=this.min.getMonth()&&e.getFullYear()>=this.min.getFullYear()&&e.getMonth()<=this.max.getMonth()&&e.getFullYear()<=this.max.getFullYear();var i=this.islamicModule.getIslamicDate(e);return i.month>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).month&&i.year>=this.islamicModule.getIslamicDate(new Date(1944,1,18)).year&&i.month<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).month&&i.year<=this.islamicModule.getIslamicDate(new Date(2069,1,16)).year},t.prototype.compareYear=function(e,i){return this.compare(e,i,0)},t.prototype.compareDecade=function(e,i){return this.compare(e,i,10)},t.prototype.shiftArray=function(e,i){return e.slice(i).concat(e.slice(0,i))},t.prototype.addDay=function(e,i,r,n,s){var l=i,h=new Date(+e);if(!(0,a.le)(this.tableBodyElement)&&!(0,a.le)(r)){for(;this.findNextTD(new Date(+e),l,n,s);)l+=i;var c=new Date(h.setDate(h.getDate()+l));l=+c>+n||+c<+s?l===i?i-i:i:l}e.setDate(e.getDate()+l)},t.prototype.findNextTD=function(e,i,r,n){var s=new Date(e.setDate(e.getDate()+i)),l=[],h=!1;if((!(0,a.le)(s)&&s.getMonth())===(!(0,a.le)(this.currentDate)&&this.currentDate.getMonth())){var c=void 0;this.calendarMode==="Gregorian"?c=this.renderDays(s):c=this.islamicModule.islamicRenderDays(this.currentDate,s),l=c.filter(function(p){return p.classList.contains(zi)})}else l=this.tableBodyElement.querySelectorAll("td."+zi);if(+s<=+r&&+s>=+n&&l.length)for(var u=0;u<l.length&&(h=+s==+new Date(parseInt(l[u].id,0)),!h);u++);return h},t.prototype.getMaxDays=function(e){var i,r=new Date(this.checkValue(e));i=28;for(var n=r.getMonth();r.getMonth()===n;)++i,r.setDate(i);return i-1},t.prototype.setDateDecade=function(e,i){e.setFullYear(i),this.setProperties({value:new Date(this.checkValue(e))},!0)},t.prototype.setDateYear=function(e,i){e.setFullYear(i.getFullYear(),i.getMonth(),e.getDate()),i.getMonth()!==e.getMonth()&&(e.setDate(0),this.currentDate=new Date(this.checkValue(i))),this.setProperties({value:new Date(this.checkValue(e))},!0)},t.prototype.compareMonth=function(e,i){var r;return e.getFullYear()>i.getFullYear()?r=1:e.getFullYear()<i.getFullYear()?r=-1:r=e.getMonth()===i.getMonth()?0:e.getMonth()>i.getMonth()?1:-1,r},t.prototype.checkValue=function(e){return e instanceof Date?e.toUTCString():""+e},t.prototype.checkView=function(){this.start!=="Decade"&&this.start!=="Year"&&this.setProperties({start:"Month"},!0),this.depth!=="Decade"&&this.depth!=="Year"&&this.setProperties({depth:"Month"},!0),this.getViewNumber(this.depth)>this.getViewNumber(this.start)&&this.setProperties({depth:"Month"},!0)},t.prototype.getDate=function(e,i){return i&&(e=new Date(e.toLocaleString("en-US",{timeZone:i}))),e},ki([(0,a.Z9)(new Date(1900,0,1))],t.prototype,"min",void 0),ki([(0,a.Z9)(!0)],t.prototype,"enabled",void 0),ki([(0,a.Z9)(null)],t.prototype,"cssClass",void 0),ki([(0,a.Z9)(new Date(2099,11,31))],t.prototype,"max",void 0),ki([(0,a.Z9)(null)],t.prototype,"firstDayOfWeek",void 0),ki([(0,a.Z9)("Gregorian")],t.prototype,"calendarMode",void 0),ki([(0,a.Z9)("Month")],t.prototype,"start",void 0),ki([(0,a.Z9)("Month")],t.prototype,"depth",void 0),ki([(0,a.Z9)(!1)],t.prototype,"weekNumber",void 0),ki([(0,a.Z9)("FirstDay")],t.prototype,"weekRule",void 0),ki([(0,a.Z9)(!0)],t.prototype,"showTodayButton",void 0),ki([(0,a.Z9)("Short")],t.prototype,"dayHeaderFormat",void 0),ki([(0,a.Z9)(!1)],t.prototype,"enablePersistence",void 0),ki([(0,a.Z9)(null)],t.prototype,"keyConfigs",void 0),ki([(0,a.Z9)(null)],t.prototype,"serverTimezoneOffset",void 0),ki([(0,a.ju)()],t.prototype,"created",void 0),ki([(0,a.ju)()],t.prototype,"destroyed",void 0),ki([(0,a.ju)()],t.prototype,"navigated",void 0),ki([(0,a.ju)()],t.prototype,"renderDayCell",void 0),t=ki([a.Zl],t),t}(a.wA),HS=function(o){Tm(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.render=function(){if(this.calendarMode==="Islamic"&&this.islamicModule===void 0&&(0,a._y)("Requires the injectable Islamic modules to render Calendar in Islamic mode"),this.isMultiSelection&&typeof this.values=="object"&&!(0,a.le)(this.values)&&this.values.length>0){for(var e=[],i=[],r=0;r<this.values.length;r++)e.indexOf(+this.values[r])===-1&&(e.push(+this.values[r]),i.push(this.values[r]));this.setProperties({values:i},!0);for(var n=0;n<this.values.length;n++)if(!this.checkDateValue(this.values[n]))if(typeof this.values[n]=="string"&&this.checkDateValue(new Date(this.checkValue(this.values[n])))){var s=new Date(this.checkValue(this.values[n]));this.values.splice(n,1),this.values.splice(n,0,s)}else this.values.splice(n,1);this.setProperties({value:this.values[this.values.length-1]},!0),this.previousValues=this.values.length}if(this.validateDate(),this.minMaxUpdate(),this.getModuleName()==="calendar"&&(this.setEnable(this.enabled),this.setClass(this.cssClass)),o.prototype.render.call(this),this.getModuleName()==="calendar"){var l=(0,a.oq)(this.element,"form");l&&a.bi.add(l,"reset",this.formResetHandler.bind(this)),this.setTimeZone(this.serverTimezoneOffset)}this.renderComplete()},t.prototype.setEnable=function(e){e?(0,a.IV)([this.element],zi):(0,a.cn)([this.element],zi)},t.prototype.setClass=function(e,i){(0,a.le)(i)||(i=i.replace(/\s+/g," ").trim()),(0,a.le)(e)||(e=e.replace(/\s+/g," ").trim()),!(0,a.le)(i)&&i!==""&&(0,a.IV)([this.element],i.split(" ")),(0,a.le)(e)||(0,a.cn)([this.element],e.split(" "))},t.prototype.isDayLightSaving=function(){var e=new Date(this.value.getFullYear(),6,1).getTimezoneOffset(),i=new Date(this.value.getFullYear(),0,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(i,e)},t.prototype.setTimeZone=function(e){if(!(0,a.le)(this.serverTimezoneOffset)&&this.value){var i=e,r=new Date().getTimezoneOffset()/60,n=i+r;n=this.isDayLightSaving()?n--:n,this.value=new Date(this.value.getTime()+n*60*60*1e3)}},t.prototype.formResetHandler=function(){this.setProperties({value:null},!0)},t.prototype.validateDate=function(){typeof this.value=="string"&&this.setProperties({value:this.checkDateValue(new Date(this.checkValue(this.value)))},!0),o.prototype.validateDate.call(this,this.value),!(0,a.le)(this.value)&&this.min<=this.max&&this.value>=this.min&&this.value<=this.max&&(this.currentDate=new Date(this.checkValue(this.value))),isNaN(+this.value)&&this.setProperties({value:null},!0)},t.prototype.minMaxUpdate=function(){this.getModuleName()==="calendar"&&(!(0,a.le)(this.value)&&this.value<=this.min&&this.min<=this.max?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!(0,a.le)(this.value)&&this.value>=this.max&&this.min<=this.max&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})),this.getModuleName()!=="calendar"&&!(0,a.le)(this.value)?!(0,a.le)(this.value)&&this.value<this.min&&this.min<=this.max?o.prototype.minMaxUpdate.call(this,this.min):!(0,a.le)(this.value)&&this.value>this.max&&this.min<=this.max&&o.prototype.minMaxUpdate.call(this,this.max):o.prototype.minMaxUpdate.call(this,this.value)},t.prototype.generateTodayVal=function(e){var i=new Date;return(0,a.le)(this.timezone)||(i=o.prototype.getDate.call(this,i,this.timezone)),e&&(0,a.le)(this.timezone)?(i.setHours(e.getHours()),i.setMinutes(e.getMinutes()),i.setSeconds(e.getSeconds()),i.setMilliseconds(e.getMilliseconds())):i=new Date(i.getFullYear(),i.getMonth(),i.getDate(),0,0,0,0),i},t.prototype.todayButtonClick=function(e){if(this.showTodayButton){var i=this.generateTodayVal(this.value);if(this.setProperties({value:i},!0),this.isTodayClicked=!0,this.todayButtonEvent=e,this.isMultiSelection){var r=this.copyValues(this.values);o.prototype.checkPresentDate.call(this,i,this.values)||(r.push(i),this.setProperties({values:r}))}o.prototype.todayButtonClick.call(this,e,new Date(+this.value))}},t.prototype.keyActionHandle=function(e){o.prototype.keyActionHandle.call(this,e,this.value,this.isMultiSelection)},t.prototype.preRender=function(){var e=this;this.changeHandler=function(i){e.triggerChange(i)},this.checkView(),o.prototype.preRender.call(this,this.value)},t.prototype.createContent=function(){this.previousDate=this.value,this.previousDateTime=this.value,o.prototype.createContent.call(this)},t.prototype.minMaxDate=function(e){return o.prototype.minMaxDate.call(this,e)},t.prototype.renderMonths=function(e,i,r){o.prototype.renderMonths.call(this,e,this.value,r)},t.prototype.renderDays=function(e,i,r,n,s){var l=o.prototype.renderDays.call(this,e,this.value,this.isMultiSelection,this.values,s);return this.isMultiSelection&&o.prototype.validateValues.call(this,this.isMultiSelection,this.values),l},t.prototype.renderYears=function(e){this.calendarMode==="Gregorian"?o.prototype.renderYears.call(this,e,this.value):this.islamicModule.islamicRenderYears(e,this.value)},t.prototype.renderDecades=function(e){this.calendarMode==="Gregorian"?o.prototype.renderDecades.call(this,e,this.value):this.islamicModule.islamicRenderDecade(e,this.value)},t.prototype.renderTemplate=function(e,i,r,n){this.calendarMode==="Gregorian"?o.prototype.renderTemplate.call(this,e,i,r,n,this.value):this.islamicModule.islamicRenderTemplate(e,i,r,n,this.value),this.changedArgs={value:this.value,values:this.values},this.changeHandler()},t.prototype.clickHandler=function(e){var i=e.currentTarget;if(this.isPopupClicked=!0,i.classList.contains(bn))if(this.isMultiSelection){var r=this.copyValues(this.values);r.push(this.getIdValue(e,null)),this.setProperties({values:r},!0),this.setProperties({value:this.values[this.values.length-1]},!0)}else this.setProperties({value:this.getIdValue(e,null)},!0);var n=this.currentView();o.prototype.clickHandler.call(this,e,this.value),this.isMultiSelection&&this.currentDate!==this.value&&!(0,a.le)(this.tableBodyElement.querySelectorAll("."+hr)[0])&&n==="Year"&&this.tableBodyElement.querySelectorAll("."+hr)[0].classList.remove(hr)},t.prototype.switchView=function(e,i,r,n){o.prototype.switchView.call(this,e,i,this.isMultiSelection,n)},t.prototype.getModuleName=function(){return o.prototype.getModuleName.call(this),"calendar"},t.prototype.getPersistData=function(){o.prototype.getPersistData.call(this);var e=["value","values"];return this.addOnPersist(e)},t.prototype.onPropertyChanged=function(e,i){this.effect="",this.rangeValidation(this.min,this.max);for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"value":this.isDateSelected&&(typeof e.value=="string"?this.setProperties({value:new Date(this.checkValue(e.value))},!0):e.value=new Date(this.checkValue(e.value)),isNaN(+this.value)&&this.setProperties({value:i.value},!0),this.update());break;case"values":if(this.isDateSelected){if(typeof e.values=="string"||typeof e.values=="number")this.setProperties({values:null},!0);else{for(var l=this.copyValues(this.values),h=0;h<l.length;h++){var c=l[h];this.checkDateValue(c)&&!o.prototype.checkPresentDate.call(this,c,l)&&l.push(c)}this.setProperties({values:l},!0),this.values.length>0&&this.setProperties({value:e.values[e.values.length-1]},!0)}this.validateValues(this.isMultiSelection,this.values),this.update()}break;case"isMultiSelection":this.isDateSelected&&(this.setProperties({isMultiSelection:e.isMultiSelection},!0),this.update());break;case"enabled":this.setEnable(this.enabled);break;case"cssClass":this.getModuleName()==="calendar"&&this.setClass(e.cssClass,i.cssClass);break;default:o.prototype.onPropertyChanged.call(this,e,i,this.isMultiSelection,this.values)}}this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange},t.prototype.destroy=function(){if(o.prototype.destroy.call(this),this.getModuleName()==="calendar"){var e=(0,a.oq)(this.element,"form");e&&a.bi.remove(e,"reset",this.formResetHandler.bind(this))}},t.prototype.navigateTo=function(e,i,r){this.minMaxUpdate(),o.prototype.navigateTo.call(this,e,i,r)},t.prototype.currentView=function(){return o.prototype.currentView.call(this)},t.prototype.addDate=function(e){if(typeof e!="string"&&typeof e!="number"){var i=this.copyValues(this.values);if(typeof e=="object"&&e.length>0)for(var r=e,n=0;n<r.length;n++)this.checkDateValue(r[n])&&!o.prototype.checkPresentDate.call(this,r[n],i)&&(!(0,a.le)(i)&&i.length>0?i.push(r[n]):i=[new Date(+r[n])]);else this.checkDateValue(e)&&!o.prototype.checkPresentDate.call(this,e,i)&&(!(0,a.le)(i)&&i.length>0?i.push(e):i=[new Date(+e)]);this.setProperties({values:i},!0),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.validateValues(this.isMultiSelection,i),this.update(),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}},t.prototype.removeDate=function(e){if(typeof e!="string"&&typeof e!="number"&&!(0,a.le)(this.values)&&this.values.length>0){var i=this.copyValues(this.values);if(typeof e=="object"&&e.length>0)for(var r=e,n=0;n<r.length;n++)for(var s=0;s<i.length;s++)+i[s]==+r[n]&&i.splice(s,1);else for(var s=0;s<i.length;s++)+i[s]==+e&&i.splice(s,1);this.setProperties({values:i},!1),this.update(),this.isMultiSelection&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler()}},t.prototype.setTodayDate=function(e){var i=new Date(+e);this.setProperties({value:i},!0),o.prototype.todayButtonClick.call(this,null,i,!0)},t.prototype.update=function(){this.validateDate(),this.minMaxUpdate(),o.prototype.setValueUpdate.call(this)},t.prototype.selectDate=function(e,i,r){o.prototype.selectDate.call(this,e,i,r,this.isMultiSelection,this.values),this.isMultiSelection&&!(0,a.le)(this.values)&&this.values.length>0&&this.setProperties({value:this.values[this.values.length-1]},!0),this.changedArgs={value:this.value,values:this.values},this.changeHandler(e)},t.prototype.changeEvent=function(e){((this.value&&this.value.valueOf())!==(this.previousDate&&+this.previousDate.valueOf())||this.isMultiSelection)&&(this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousDate=new Date(+this.value))},t.prototype.triggerChange=function(e){!(0,a.le)(this.todayButtonEvent)&&this.isTodayClicked&&(e=this.todayButtonEvent,this.isTodayClicked=!1),this.changedArgs.event=e||null,this.changedArgs.isInteracted=!(0,a.le)(e),(0,a.le)(this.value)||this.setProperties({value:this.value},!0),!this.isMultiSelection&&+this.value!==Number.NaN&&(+this.value!=+this.previousDate||this.previousDate==null&&!isNaN(+this.value))?this.changeEvent(e):!(0,a.le)(this.values)&&this.previousValues!==this.values.length&&(this.changeEvent(e),this.previousValues=this.values.length)},ki([(0,a.Z9)(null)],t.prototype,"value",void 0),ki([(0,a.Z9)(null)],t.prototype,"values",void 0),ki([(0,a.Z9)(!1)],t.prototype,"isMultiSelection",void 0),ki([(0,a.ju)()],t.prototype,"change",void 0),t=ki([a.Zl],t),t}(FS),VS=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),fi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},zS="e-date-wrapper",Qh="e-datepicker",_S="e-lib",jS="e-control",Nm="e-popup-wrapper",WS="e-input-group-icon",US="e-popup",qS="e-input-group",dd="e-input-focus",ZS="e-input",Bm="e-error",Jh="e-active",Fm="e-date-overflow",YS="e-date-icon",yO="e-clear-icon",GS="e-icons",KS=300,XS=4,ec="e-selected",$S="e-focused-date",fd="e-non-edit",Hm=["title","class","style"],Vm=function(o){VS(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.previousElementValue="",r.isDateIconClicked=!1,r.isAltKeyPressed=!1,r.isInteracted=!0,r.invalidValueString=null,r.checkPreviousValue=null,r.maskedDateValue="",r.isAngular=!1,r.preventChange=!1,r.isIconClicked=!1,r.isDynamicValueChanged=!1,r.moduleName=r.getModuleName(),r.isFocused=!1,r.datepickerOptions=e,r}return t.prototype.render=function(){this.initialize(),this.bindEvents(),this.renderComplete(),this.setTimeZone(this.serverTimezoneOffset)},t.prototype.setTimeZone=function(e){if(!(0,a.le)(this.serverTimezoneOffset)&&this.value){var i=new Date().getTimezoneOffset()/60,r=e,n=r+i;n=this.isDayLightSaving()?n--:n,this.value=new Date(this.value.getTime()+n*60*60*1e3),this.updateInput()}},t.prototype.isDayLightSaving=function(){var e=new Date(this.value.getFullYear(),0,1).getTimezoneOffset(),i=new Date(this.value.getFullYear(),6,1).getTimezoneOffset();return this.value.getTimezoneOffset()<Math.max(e,i)},t.prototype.setAllowEdit=function(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):(0,a.Y4)(this.inputElement,{readonly:""}),this.updateIconState()},t.prototype.updateIconState=function(){!this.allowEdit&&this.inputWrapper&&!this.readonly?this.inputElement.value===""?(0,a.IV)([this.inputWrapper.container],[fd]):(0,a.cn)([this.inputWrapper.container],[fd]):this.inputWrapper&&(0,a.IV)([this.inputWrapper.container],[fd])},t.prototype.initialize=function(){this.checkInvalidValue(this.value),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"}),this.createInput(),this.updateHtmlAttributeToWrapper(),this.setAllowEdit(),this.updateInput(),this.enableMask&&!this.value&&this.maskedDateValue&&(this.floatLabelType=="Always"||!this.floatLabelType||!this.placeholder)&&this.updateInputValue(this.maskedDateValue),this.previousElementValue=this.inputElement.value,this.previousDate=(0,a.le)(this.value)?null:new Date(+this.value),this.inputElement.setAttribute("value",this.inputElement.value),this.inputValueCopy=this.value},t.prototype.createInput=function(){var e={"aria-live":"assertive","aria-atomic":"true","aria-haspopup":"true","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-invalid":"false"};if(this.getModuleName()==="datepicker"){var i={placeholder:this.placeholder};this.globalize=new a.eC(this.locale),this.l10n=new a.E7("datepicker",i,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0)}var r=this.cssClass;!(0,a.le)(this.cssClass)&&this.cssClass!==""&&(r=this.cssClass.replace(/\s+/g," ").trim());var n=!this.enableMask;this.inputWrapper=Ue.createInput({element:this.inputElement,floatLabelType:this.floatLabelType,bindClearAction:n,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:r,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:[WS+" "+YS+" "+GS]},this.createElement),this.setWidth(this.width),this.inputElement.name!==""?this.inputElement.setAttribute("name",""+this.inputElement.getAttribute("name")):this.inputElement.setAttribute("name",""+this.element.id),(0,a.Y4)(this.inputElement,e),this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1),Ue.addAttributes({"aria-label":"select"},this.inputWrapper.buttons[0]),(0,a.cn)([this.inputWrapper.container],zS)},t.prototype.updateInput=function(e){e===void 0&&(e=!1);var i;if(this.value&&!this.isCalendar()&&!e&&this.disabledDates(),isNaN(+new Date(this.checkValue(this.value)))&&this.setProperties({value:null},!0),this.strictMode&&(o.prototype.validateDate.call(this),this.minMaxUpdates(),o.prototype.minMaxUpdate.call(this)),!(0,a.le)(this.value)){var r=this.value,n=void 0,s=(0,a.le)(this.formatString)?this.dateTimeFormat:this.formatString;if(this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?n=this.globalize.formatDate(this.value,{format:s,type:"dateTime",skeleton:"yMd"}):n=this.globalize.formatDate(this.value,{format:s,type:"dateTime",skeleton:"yMd",calendar:"islamic"}):(this.calendarMode==="Gregorian"?i={format:this.formatString,type:"dateTime",skeleton:"yMd"}:i={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},n=this.globalize.formatDate(this.value,i)),+r<=+this.max&&+r>=+this.min)this.updateInputValue(n);else{var l=+r>=+this.max||!+this.value||!+this.value||+r<=+this.min;!this.strictMode&&l&&this.updateInputValue(n)}}(0,a.le)(this.value)&&this.strictMode&&(this.enableMask?(this.updateInputValue(this.maskedDateValue),this.notify("createMask",{module:"MaskedDateTime"})):this.updateInputValue("")),!this.strictMode&&(0,a.le)(this.value)&&this.invalidValueString&&this.updateInputValue(this.invalidValueString),this.changedArgs={value:this.value},this.errorClass(),this.updateIconState()},t.prototype.minMaxUpdates=function(){!(0,a.le)(this.value)&&this.value<this.min&&this.min<=this.max&&this.strictMode?(this.setProperties({value:this.min},!0),this.changedArgs={value:this.value}):!(0,a.le)(this.value)&&this.value>this.max&&this.min<=this.max&&this.strictMode&&(this.setProperties({value:this.max},!0),this.changedArgs={value:this.value})},t.prototype.checkStringValue=function(e){var i=null,r=null,n=null;if(this.getModuleName()==="datetimepicker"){var s=new a.eC(this.locale);this.calendarMode==="Gregorian"?(r={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd"},n={format:s.getDatePattern({skeleton:"yMd"}),type:"dateTime"}):(r={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},n={format:s.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};return i=this.checkDateValue(this.globalize.parseDate(e,r)),(0,a.le)(i)&&this.getModuleName()==="datetimepicker"&&(i=this.checkDateValue(this.globalize.parseDate(e,n))),i},t.prototype.checkInvalidValue=function(e){if(!(e instanceof Date)&&!(0,a.le)(e)){var i=null,r=e;typeof e=="number"&&(r=e.toString());var n=null,s=null;if(this.getModuleName()==="datetimepicker"){var l=new a.eC(this.locale);this.calendarMode==="Gregorian"?(n={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd"},s={format:l.getDatePattern({skeleton:"yMd"}),type:"dateTime"}):(n={format:this.dateTimeFormat,type:"dateTime",skeleton:"yMd",calendar:"islamic"},s={format:l.getDatePattern({skeleton:"yMd"}),type:"dateTime",calendar:"islamic"})}else this.calendarMode==="Gregorian"?n={format:this.formatString,type:"dateTime",skeleton:"yMd"}:n={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};var h=!1;if(typeof r!="string")r=null,h=!0;else if(typeof r=="string"&&(r=r.trim()),i=this.checkStringValue(r),!i){var c=null,u=null;c=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,u=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,!c.test(r)&&!u.test(r)||/^[a-zA-Z0-9- ]*$/.test(r)||isNaN(+new Date(this.checkValue(r)))?h=!0:i=new Date(r)}h?(this.strictMode||(this.invalidValueString=r),this.setProperties({value:null},!0)):this.setProperties({value:i},!0)}},t.prototype.bindInputEvent=function(){(!(0,a.le)(this.formatString)||this.enableMask)&&(this.enableMask||this.formatString.indexOf("y")===-1?a.bi.add(this.inputElement,"input",this.inputHandler,this):a.bi.remove(this.inputElement,"input",this.inputHandler))},t.prototype.bindEvents=function(){a.bi.add(this.inputWrapper.buttons[0],"mousedown touchstart",this.dateIconHandler,this),a.bi.add(this.inputElement,"mouseup",this.mouseUpHandler,this),a.bi.add(this.inputElement,"focus",this.inputFocusHandler,this),a.bi.add(this.inputElement,"blur",this.inputBlurHandler,this),this.enableMask&&a.bi.add(this.inputElement,"keydown",this.keydownHandler,this),this.bindInputEvent(),a.bi.add(this.inputElement,"change",this.inputChangeHandler,this),this.showClearButton&&this.inputWrapper.clearButton&&a.bi.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this),this.formElement&&a.bi.add(this.formElement,"reset",this.resetFormHandler,this),this.defaultKeyConfigs=(0,a.l7)(this.defaultKeyConfigs,this.keyConfigs),this.keyboardModules=new a.nv(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})},t.prototype.keydownHandler=function(e){switch(e.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":case"Home":case"End":case"Delete":this.enableMask&&!this.popupObj&&!this.readonly&&(e.code!=="Delete"&&e.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e}));break;default:break}},t.prototype.unBindEvents=function(){a.bi.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.dateIconHandler),a.bi.remove(this.inputElement,"mouseup",this.mouseUpHandler),a.bi.remove(this.inputElement,"focus",this.inputFocusHandler),a.bi.remove(this.inputElement,"blur",this.inputBlurHandler),a.bi.remove(this.inputElement,"change",this.inputChangeHandler),this.enableMask&&a.bi.remove(this.inputElement,"keydown",this.keydownHandler),this.showClearButton&&this.inputWrapper.clearButton&&a.bi.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler),this.formElement&&a.bi.remove(this.formElement,"reset",this.resetFormHandler)},t.prototype.resetFormHandler=function(){if(!!this.enabled&&!this.inputElement.disabled){var e=this.inputElement.getAttribute("value");(this.element.tagName==="EJS-DATEPICKER"||this.element.tagName==="EJS-DATETIMEPICKER")&&(e="",this.inputValueCopy=null,this.inputElement.setAttribute("value","")),this.setProperties({value:this.inputValueCopy},!0),this.restoreValue(),this.inputElement&&(this.updateInputValue(e),this.errorClass())}},t.prototype.restoreValue=function(){this.currentDate=this.value?this.value:new Date,this.previousDate=this.value,this.previousElementValue=(0,a.le)(this.inputValueCopy)?"":this.globalize.formatDate(this.inputValueCopy,{format:this.formatString,type:"dateTime",skeleton:"yMd"})},t.prototype.inputChangeHandler=function(e){!this.enabled||e.stopPropagation()},t.prototype.bindClearEvent=function(){this.showClearButton&&this.inputWrapper.clearButton&&a.bi.add(this.inputWrapper.clearButton,"mousedown touchstart",this.resetHandler,this)},t.prototype.resetHandler=function(e){!this.enabled||(e.preventDefault(),this.clear(e))},t.prototype.mouseUpHandler=function(e){this.enableMask&&(e.preventDefault(),this.notify("setMaskSelection",{module:"MaskedDateTime"}))},t.prototype.clear=function(e){this.setProperties({value:null},!0),this.enableMask||this.updateInputValue("");var i={event:e};this.trigger("cleared",i),this.invalidValueString="",this.updateInput(),this.popupUpdate(),this.changeEvent(e),this.enableMask&&this.notify("clearHandler",{module:"MaskedDateTime"})},t.prototype.preventEventBubbling=function(e){e.preventDefault(),this.interopAdaptor.invokeMethodAsync("OnDateIconClick")},t.prototype.updateInputValue=function(e){Ue.setValue(e,this.inputElement,this.floatLabelType,this.showClearButton)},t.prototype.dateIconHandler=function(e){!this.enabled||(this.isIconClicked=!0,a.AR.isDevice&&(this.inputElement.setAttribute("readonly",""),this.inputElement.blur()),e.preventDefault(),this.readonly||(this.isCalendar()?this.hide(e):(this.isDateIconClicked=!0,this.show(null,e),this.getModuleName()==="datetimepicker"&&this.inputElement.focus(),this.inputElement.focus(),(0,a.cn)([this.inputWrapper.container],[dd]),(0,a.cn)(this.inputWrapper.buttons,Jh))),this.isIconClicked=!1)},t.prototype.updateHtmlAttributeToWrapper=function(){if(!(0,a.le)(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(!(0,a.le)(this.htmlAttributes[r])&&Hm.indexOf(r)>-1)if(r==="class"){var n=this.htmlAttributes[r].replace(/\s+/g," ").trim();n!==""&&(0,a.cn)([this.inputWrapper.container],n.split(" "))}else if(r==="style"){var s=this.inputWrapper.container.getAttribute(r);(0,a.le)(s)?s=this.htmlAttributes[r]:s.charAt(s.length-1)===";"?s=s+this.htmlAttributes[r]:s=s+";"+this.htmlAttributes[r],this.inputWrapper.container.setAttribute(r,s)}else this.inputWrapper.container.setAttribute(r,this.htmlAttributes[r])}},t.prototype.updateHtmlAttributeToElement=function(){if(!(0,a.le)(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];Hm.indexOf(r)<0&&this.inputElement.setAttribute(r,this.htmlAttributes[r])}},t.prototype.updateCssClass=function(e,i){(0,a.le)(i)||(i=i.replace(/\s+/g," ").trim()),(0,a.le)(e)||(e=e.replace(/\s+/g," ").trim()),Ue.setCssClass(e,[this.inputWrapper.container],i),this.popupWrapper&&Ue.setCssClass(e,[this.popupWrapper],i)},t.prototype.calendarKeyActionHandle=function(e){switch(e.action){case"escape":this.isCalendar()?this.hide(e):this.inputWrapper.container.children[this.index].blur();break;case"enter":this.isCalendar()?+this.value!=+this.currentDate&&!this.isCalendar()&&this.inputWrapper.container.children[this.index].focus():this.show(null,e),this.getModuleName()==="datetimepicker"&&this.inputElement.focus();break;case"tab":this.hide(e)}},t.prototype.inputFocusHandler=function(){if(this.isFocused=!0,!!this.enabled){this.enableMask&&!this.inputElement.value&&this.placeholder&&this.maskedDateValue&&!this.value&&(this.floatLabelType=="Auto"||this.floatLabelType=="Never"||this.placeholder)&&(this.updateInputValue(this.maskedDateValue),this.inputElement.selectionStart=0,this.inputElement.selectionEnd=this.inputElement.value.length);var e={model:this};this.isDateIconClicked=!1,this.trigger("focus",e),this.updateIconState(),this.openOnFocus&&!this.isIconClicked&&this.show()}},t.prototype.inputHandler=function(){this.isPopupClicked=!1,this.enableMask&&this.notify("inputHandler",{module:"MaskedDateTime"})},t.prototype.inputBlurHandler=function(e){if(!!this.enabled){if(this.strictModeUpdate(),this.inputElement.value===""&&(0,a.le)(this.value)&&(this.invalidValueString=null,this.updateInputValue("")),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.enableMask&&this.maskedDateValue&&this.placeholder&&this.floatLabelType!=="Always"&&this.inputElement.value==this.maskedDateValue&&!this.value&&(this.floatLabelType=="Auto"||this.floatLabelType=="Never"||this.placeholder)&&this.updateInputValue(""),this.errorClass(),this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(e),this.getModuleName()==="datepicker"){var i={model:this};this.trigger("blur",i)}this.isCalendar()&&(this.defaultKeyConfigs=(0,a.l7)(this.defaultKeyConfigs,this.keyConfigs),this.calendarKeyboardModules=new a.nv(this.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:this.calendarKeyActionHandle.bind(this),keyConfigs:this.defaultKeyConfigs})),this.isPopupClicked=!1}},t.prototype.documentHandler=function(e){!(0,a.le)(this.popupObj)&&(this.inputWrapper.container.contains(e.target)||this.popupObj.element&&this.popupObj.element.contains(e.target))&&e.type!=="touchstart"&&e.preventDefault();var i=e.target;!(0,a.oq)(i,".e-datepicker.e-popup-wrapper")&&(0,a.oq)(i,"."+qS)!==this.inputWrapper.container&&!i.classList.contains("e-day")?(this.hide(e),this.focusOut()):(0,a.oq)(i,".e-datepicker.e-popup-wrapper")&&(i.classList.contains("e-day")&&!(0,a.le)(e.target.parentElement)&&e.target.parentElement.classList.contains("e-selected")&&(0,a.oq)(i,".e-content")&&(0,a.oq)(i,".e-content").classList.contains("e-"+this.depth.toLowerCase())?this.hide(e):(0,a.oq)(i,".e-footer-container")&&i.classList.contains("e-today")&&i.classList.contains("e-btn")&&+new Date(+this.value)==+o.prototype.generateTodayVal.call(this,this.value)&&this.hide(e))},t.prototype.inputKeyActionHandle=function(e){var i=this.currentView();switch(e.action){case"altUpArrow":this.isAltKeyPressed=!1,this.hide(e),this.inputElement.focus();break;case"altDownArrow":this.isAltKeyPressed=!0,this.strictModeUpdate(),this.updateInput(),this.changeTrigger(e),this.getModuleName()==="datepicker"&&this.show(null,e);break;case"escape":this.hide(e);break;case"enter":this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass(),!this.isCalendar()&&document.activeElement===this.inputElement&&this.hide(e),this.isCalendar()&&(e.preventDefault(),e.stopPropagation());break;case"tab":case"shiftTab":var r=this.inputElement.selectionStart,n=this.inputElement.selectionEnd;if(this.enableMask&&!this.popupObj&&!this.readonly){var s=this.inputElement.value.length;(r==0&&n==s||n!==s&&e.action=="tab"||r!==0&&e.action=="shiftTab")&&e.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e}),r=this.inputElement.selectionStart,n=this.inputElement.selectionEnd}this.strictModeUpdate(),this.updateInput(),this.popupUpdate(),this.changeTrigger(e),this.errorClass(),this.enableMask&&(this.inputElement.selectionStart=r,this.inputElement.selectionEnd=n),this.hide(e);break;default:this.defaultAction(e),e.action==="select"&&i===this.depth&&this.hide(e)}},t.prototype.defaultAction=function(e){this.previousDate=!(0,a.le)(this.value)&&new Date(+this.value)||null,this.isCalendar()&&(o.prototype.keyActionHandle.call(this,e),this.isCalendar()&&(0,a.Y4)(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()}))},t.prototype.popupUpdate=function(){if(((0,a.le)(this.value)&&!(0,a.le)(this.previousDate)||+this.value!=+this.previousDate)&&(this.popupObj&&this.popupObj.element.querySelectorAll("."+ec).length>0&&(0,a.IV)(this.popupObj.element.querySelectorAll("."+ec),[ec]),!(0,a.le)(this.value)&&+this.value>=+this.min&&+this.value<=+this.max)){var e=new Date(this.checkValue(this.value));o.prototype.navigateTo.call(this,"Month",e)}},t.prototype.strictModeUpdate=function(){var e,i;if(this.getModuleName()==="datetimepicker"?e=(0,a.le)(this.formatString)?this.dateTimeFormat:this.formatString:e=(0,a.le)(this.formatString)?this.formatString:this.formatString.replace("dd","d"),!(0,a.le)(e)){var r=e.split("M").length-1;r<3&&(e=e.replace("MM","M"))}var n;this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?n={format:(0,a.le)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}:n={format:(0,a.le)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:(this.calendarMode==="Gregorian"?i={format:e,type:"dateTime",skeleton:"yMd"}:i={format:e,type:"dateTime",skeleton:"yMd",calendar:"islamic"},n=i);var s;typeof this.inputElement.value=="string"&&(this.inputElement.value=this.inputElement.value.trim()),this.getModuleName()==="datetimepicker"?this.checkDateValue(this.globalize.parseDate(this.inputElement.value,n))?s=this.globalize.parseDate(this.inputElement.value,n):(this.calendarMode==="Gregorian"?i={type:"dateTime",skeleton:"yMd"}:i={type:"dateTime",skeleton:"yMd",calendar:"islamic"},s=this.globalize.parseDate(this.inputElement.value,i)):(s=this.globalize.parseDate(this.inputElement.value,n),s=!(0,a.le)(s)&&isNaN(+s)?null:s,!(0,a.le)(this.formatString)&&this.inputElement.value!==""&&this.strictMode&&(this.isPopupClicked||!this.isPopupClicked&&this.inputElement.value===this.previousElementValue)&&this.formatString.indexOf("y")===-1&&s.setFullYear(this.value.getFullYear())),this.getModuleName()==="datepicker"&&this.value&&!isNaN(+this.value)&&s&&s.setHours(this.value.getHours(),this.value.getMinutes(),this.value.getSeconds(),this.value.getMilliseconds()),this.strictMode&&s?(this.updateInputValue(this.globalize.formatDate(s,n)),this.inputElement.value!==this.previousElementValue&&this.setProperties({value:s},!0)):this.strictMode||this.inputElement.value!==this.previousElementValue&&this.setProperties({value:s},!0),this.strictMode&&!s&&this.inputElement.value===(this.enableMask?this.maskedDateValue:"")&&this.setProperties({value:null},!0),isNaN(+this.value)&&this.setProperties({value:null},!0),(0,a.le)(this.value)&&(this.currentDate=new Date(new Date().setHours(0,0,0,0)))},t.prototype.createCalendar=function(){var e=this;this.popupWrapper=this.createElement("div",{className:""+Qh+" "+Nm}),(0,a.le)(this.cssClass)||(this.popupWrapper.className+=" "+this.cssClass),a.AR.isDevice&&(this.modelHeader(),this.modal=this.createElement("div"),this.modal.className=""+Qh+" e-date-modal",document.body.className+=" "+Fm,this.modal.style.display="block",document.body.appendChild(this.modal)),this.calendarElement.querySelector("table tbody").className="",this.popupObj=new br(this.popupWrapper,{content:this.calendarElement,relateTo:a.AR.isDevice?document.body:this.inputWrapper.container,position:a.AR.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},offsetY:XS,targetType:"container",enableRtl:this.enableRtl,zIndex:this.zIndex,collision:a.AR.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},open:function(){e.getModuleName()!=="datetimepicker"&&document.activeElement!==e.inputElement&&(e.defaultKeyConfigs=(0,a.l7)(e.defaultKeyConfigs,e.keyConfigs),e.calendarElement.children[1].firstElementChild.focus(),e.calendarKeyboardModules=new a.nv(e.calendarElement.children[1].firstElementChild,{eventName:"keydown",keyAction:e.calendarKeyActionHandle.bind(e),keyConfigs:e.defaultKeyConfigs}),e.calendarKeyboardModules=new a.nv(e.inputWrapper.container.children[e.index],{eventName:"keydown",keyAction:e.calendarKeyActionHandle.bind(e),keyConfigs:e.defaultKeyConfigs}))},close:function(){e.isDateIconClicked&&e.inputWrapper.container.children[e.index].focus(),e.value&&e.disabledDates(),e.popupObj&&e.popupObj.destroy(),e.resetCalendar(),(0,a.og)(e.popupWrapper),e.popupObj=e.popupWrapper=null,e.preventArgs=null,e.calendarKeyboardModules=null,e.setAriaAttributes()},targetExitViewport:function(){a.AR.isDevice||e.hide()}}),this.popupObj.element.className+=" "+this.cssClass,this.setAriaAttributes()},t.prototype.setAriaDisabled=function(){this.enabled?(this.inputElement.setAttribute("aria-disabled","false"),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.inputElement.setAttribute("aria-disabled","true"),this.inputElement.tabIndex=-1)},t.prototype.modelHeader=function(){var e,i=this.createElement("div",{className:"e-model-header"}),r=this.createElement("h1",{className:"e-model-year"}),n=this.createElement("div"),s=this.createElement("span",{className:"e-model-day"}),l=this.createElement("span",{className:"e-model-month"});this.calendarMode==="Gregorian"?e={format:"y",skeleton:"dateTime"}:e={format:"y",skeleton:"dateTime",calendar:"islamic"},r.textContent=""+this.globalize.formatDate(this.value||new Date,e),this.calendarMode==="Gregorian"?e={format:"E",skeleton:"dateTime"}:e={format:"E",skeleton:"dateTime",calendar:"islamic"},s.textContent=""+this.globalize.formatDate(this.value||new Date,e)+", ",this.calendarMode==="Gregorian"?e={format:"MMM d",skeleton:"dateTime"}:e={format:"MMM d",skeleton:"dateTime",calendar:"islamic"},l.textContent=""+this.globalize.formatDate(this.value||new Date,e),i.appendChild(r),n.appendChild(s),n.appendChild(l),i.appendChild(n),this.calendarElement.insertBefore(i,this.calendarElement.firstElementChild)},t.prototype.changeTrigger=function(e){this.inputElement.value!==this.previousElementValue&&(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())&&(this.isDynamicValueChanged&&this.isCalendar()&&this.popupUpdate(),this.changedArgs.value=this.value,this.changedArgs.event=e||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=!(0,a.le)(e),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",this.changedArgs),this.previousElementValue=this.inputElement.value,this.previousDate=isNaN(+new Date(this.checkValue(this.value)))?null:new Date(this.checkValue(this.value)),this.isInteracted=!0)},t.prototype.navigatedEvent=function(){this.trigger("navigated",this.navigatedArgs)},t.prototype.changeEvent=function(e){(this.previousDate&&this.previousDate.valueOf())!==(this.value&&this.value.valueOf())&&(this.selectCalendar(e),this.changedArgs.event=e||null,this.changedArgs.element=this.element,this.changedArgs.isInteracted=this.isInteracted,this.isDynamicValueChanged||this.trigger("change",this.changedArgs),this.previousDate=this.value&&new Date(+this.value),this.isDynamicValueChanged||this.hide(e),this.previousElementValue=this.inputElement.value,this.errorClass())},t.prototype.requiredModules=function(){var e=[];return this&&e.push({args:[this],member:"islamic"}),this.enableMask&&e.push({args:[this],member:"MaskedDateTime"}),e},t.prototype.selectCalendar=function(e){var i,r,n;this.getModuleName()==="datetimepicker"?r=(0,a.le)(this.formatString)?this.dateTimeFormat:this.formatString:r=this.formatString,this.value&&(this.getModuleName()==="datetimepicker"?(this.calendarMode==="Gregorian"?n={format:r,type:"dateTime",skeleton:"yMd"}:n={format:r,type:"dateTime",skeleton:"yMd",calendar:"islamic"},i=this.globalize.formatDate(this.changedArgs.value,n)):(this.calendarMode==="Gregorian"?n={format:this.formatString,type:"dateTime",skeleton:"yMd"}:n={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},i=this.globalize.formatDate(this.changedArgs.value,n)),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"})),(0,a.le)(i)||(this.updateInputValue(i),this.enableMask&&this.notify("setMaskSelection",{module:"MaskedDateTime"}))},t.prototype.isCalendar=function(){return!!(this.popupWrapper&&this.popupWrapper.classList.contains(""+Nm))},t.prototype.setWidth=function(e){typeof e=="number"?this.inputWrapper.container.style.width=(0,a.Ac)(this.width):typeof e=="string"?this.inputWrapper.container.style.width=e.match(/px|%|em/)?this.width:(0,a.Ac)(this.width):this.inputWrapper.container.style.width="100%"},t.prototype.show=function(e,i){var r=this;if(!(this.enabled&&this.readonly||!this.enabled||this.popupObj)){var n=!0,s=void 0;!(0,a.le)(this.value)&&!(+this.value>=+this.min&&+this.value<=+this.max)?(s=new Date(this.checkValue(this.value)),this.setProperties({value:null},!0)):s=this.value||null,this.isCalendar()||(o.prototype.render.call(this),this.setProperties({value:s||null},!0),this.previousDate=s,this.createCalendar()),a.AR.isDevice&&(this.mobilePopupWrapper=this.createElement("div",{className:"e-datepick-mob-popup-wrap"}),document.body.appendChild(this.mobilePopupWrapper)),this.preventArgs={preventDefault:function(){n=!1},popup:this.popupObj,event:i||null,cancel:!1,appendTo:a.AR.isDevice?this.mobilePopupWrapper:document.body};var l=this.preventArgs;this.trigger("open",l,function(h){if(r.preventArgs=h,n&&!r.preventArgs.cancel){(0,a.cn)(r.inputWrapper.buttons,Jh),r.preventArgs.appendTo.appendChild(r.popupWrapper),r.popupObj.refreshPosition(r.inputElement);var c={name:"FadeIn",duration:a.AR.isDevice?0:KS};r.zIndex===1e3?r.popupObj.show(new a.fw(c),r.element):r.popupObj.show(new a.fw(c),null),o.prototype.setOverlayIndex.call(r,r.mobilePopupWrapper,r.popupObj.element,r.modal,a.AR.isDevice),r.setAriaAttributes()}else r.popupObj.destroy(),r.popupWrapper=r.popupObj=null;!(0,a.le)(r.inputElement)&&r.inputElement.value===""&&!(0,a.le)(r.tableBodyElement)&&r.tableBodyElement.querySelectorAll("td.e-selected").length>0&&((0,a.cn)([r.tableBodyElement.querySelector("td.e-selected")],$S),(0,a.IV)(r.tableBodyElement.querySelectorAll("td.e-selected"),ec)),a.bi.add(document,"mousedown touchstart",r.documentHandler,r)})}},t.prototype.hide=function(e){var i=this;if((0,a.le)(this.popupWrapper))a.AR.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit();else{var r=!0;this.preventArgs={preventDefault:function(){r=!1},popup:this.popupObj,event:e||null,cancel:!1},(0,a.IV)(this.inputWrapper.buttons,Jh),(0,a.IV)([document.body],Fm);var n=this.preventArgs;this.isCalendar()?this.trigger("close",n,function(s){i.closeEventCallback(r,s)}):this.closeEventCallback(r,n)}},t.prototype.closeEventCallback=function(e,i){this.preventArgs=i,this.isCalendar()&&e&&!this.preventArgs.cancel&&(this.popupObj.hide(),this.isAltKeyPressed=!1,this.keyboardModule.destroy(),(0,a.IV)(this.inputWrapper.buttons,Jh)),this.setAriaAttributes(),a.AR.isDevice&&this.modal&&(this.modal.style.display="none",this.modal.outerHTML="",this.modal=null),a.AR.isDevice&&((0,a.le)(this.mobilePopupWrapper)||(this.mobilePopupWrapper.remove(),this.mobilePopupWrapper=null)),a.bi.remove(document,"mousedown touchstart",this.documentHandler),a.AR.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()},t.prototype.focusIn=function(e){document.activeElement!==this.inputElement&&this.enabled&&(this.inputElement.focus(),(0,a.cn)([this.inputWrapper.container],[dd]))},t.prototype.focusOut=function(){document.activeElement===this.inputElement&&((0,a.IV)([this.inputWrapper.container],[dd]),this.inputElement.blur())},t.prototype.currentView=function(){var e;return this.calendarElement&&(e=o.prototype.currentView.call(this)),e},t.prototype.navigateTo=function(e,i){this.calendarElement&&o.prototype.navigateTo.call(this,e,i)},t.prototype.destroy=function(){this.unBindEvents(),o.prototype.destroy.call(this),this.keyboardModules.destroy(),this.popupObj&&this.popupObj.element.classList.contains(US)&&o.prototype.destroy.call(this);var e={"aria-live":"assertive","aria-atomic":"true","aria-disabled":"true","aria-haspopup":"true","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"};this.inputElement&&(Ue.removeAttributes(e,this.inputElement),(0,a.le)(this.inputElementCopy.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),a.bi.remove(this.inputElement,"blur",this.inputBlurHandler),a.bi.remove(this.inputElement,"focus",this.inputFocusHandler),this.ensureInputAttribute()),this.isCalendar()&&(this.popupWrapper&&(0,a.og)(this.popupWrapper),this.popupObj=this.popupWrapper=null,this.keyboardModule.destroy()),this.ngTag===null&&(this.inputElement&&(this.inputWrapper.container.insertAdjacentElement("afterend",this.inputElement),(0,a.IV)([this.inputElement],[ZS])),(0,a.IV)([this.element],[Qh]),(0,a.og)(this.inputWrapper.container)),this.formElement&&a.bi.remove(this.formElement,"reset",this.resetFormHandler)},t.prototype.ensureInputAttribute=function(){for(var e=[],i=0;i<this.inputElement.attributes.length;i++)e[i]=this.inputElement.attributes[i].name;for(var i=0;i<e.length;i++)(0,a.le)(this.inputElementCopy.getAttribute(e[i]))?(e[i].toLowerCase()==="value"&&(this.inputElement.value=""),this.inputElement.removeAttribute(e[i])):(e[i].toLowerCase()==="value"&&(this.inputElement.value=this.inputElementCopy.getAttribute(e[i])),this.inputElement.setAttribute(e[i],this.inputElementCopy.getAttribute(e[i])))},t.prototype.preRender=function(){this.inputElementCopy=this.element.cloneNode(!0),(0,a.IV)([this.inputElementCopy],[Qh,jS,_S]),this.inputElement=this.element,this.formElement=(0,a.oq)(this.inputElement,"form"),this.index=this.showClearButton?2:1,this.ngTag=null,(this.element.tagName==="EJS-DATEPICKER"||this.element.tagName==="EJS-DATETIMEPICKER")&&(this.ngTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.element.getAttribute("id")?this.ngTag!==null&&(this.inputElement.id=this.element.getAttribute("id")+"_input"):this.getModuleName()==="datetimepicker"?(this.element.id=(0,a.QI)("ej2-datetimepicker"),this.ngTag!==null&&(0,a.Y4)(this.inputElement,{id:this.element.id+"_input"})):(this.element.id=(0,a.QI)("ej2-datepicker"),this.ngTag!==null&&(0,a.Y4)(this.inputElement,{id:this.element.id+"_input"})),this.ngTag!==null&&this.validationAttribute(this.element,this.inputElement),this.updateHtmlAttributeToElement(),this.defaultKeyConfigs=this.getDefaultKeyConfig(),this.checkHtmlAttributes(!1),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),o.prototype.preRender.call(this)},t.prototype.getDefaultKeyConfig=function(){return this.defaultKeyConfigs={altUpArrow:"alt+uparrow",altDownArrow:"alt+downarrow",escape:"escape",enter:"enter",controlUp:"ctrl+38",controlDown:"ctrl+40",moveDown:"downarrow",moveUp:"uparrow",moveLeft:"leftarrow",moveRight:"rightarrow",select:"enter",home:"home",end:"end",pageUp:"pageup",pageDown:"pagedown",shiftPageUp:"shift+pageup",shiftPageDown:"shift+pagedown",controlHome:"ctrl+home",controlEnd:"ctrl+end",shiftTab:"shift+tab",tab:"tab"},this.defaultKeyConfigs},t.prototype.validationAttribute=function(e,i){var r=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("id");i.setAttribute("name",r),e.removeAttribute("name");for(var n=["required","aria-required","form"],s=0;s<n.length;s++)if(!(0,a.le)(e.getAttribute(n[s]))){var l=e.getAttribute(n[s]);i.setAttribute(n[s],l),e.removeAttribute(n[s])}},t.prototype.checkFormat=function(){var e=new a.eC(this.locale);if(this.format)if(typeof this.format=="string")this.formatString=this.format;else if(this.format.skeleton!==""&&!(0,a.le)(this.format.skeleton)){var i=this.format.skeleton;this.getModuleName()==="datetimepicker"?this.formatString=e.getDatePattern({skeleton:i,type:"dateTime"}):this.formatString=e.getDatePattern({skeleton:i,type:"date"})}else this.getModuleName()==="datetimepicker"?this.formatString=this.dateTimeFormat:this.formatString=null;else this.formatString=null},t.prototype.checkHtmlAttributes=function(e){this.globalize=new a.eC(this.locale),this.checkFormat(),this.checkView();var i=e?(0,a.le)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["value","min","max","disabled","readonly","style","name","placeholder","type"],r;this.getModuleName()==="datetimepicker"?this.calendarMode==="Gregorian"?r={format:(0,a.le)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:(0,a.le)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}:this.calendarMode==="Gregorian"?r={format:this.formatString,type:"dateTime",skeleton:"yMd"}:r={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"};for(var n=0,s=i;n<s.length;n++){var l=s[n];if(!(0,a.le)(this.inputElement.getAttribute(l)))switch(l){case"disabled":if((0,a.le)(this.datepickerOptions)||this.datepickerOptions.enabled===void 0||e){var h=!(this.inputElement.getAttribute(l)==="disabled"||this.inputElement.getAttribute(l)===""||this.inputElement.getAttribute(l)==="true");this.setProperties({enabled:h},!e)}break;case"readonly":if((0,a.le)(this.datepickerOptions)||this.datepickerOptions.readonly===void 0||e){var c=this.inputElement.getAttribute(l)==="readonly"||this.inputElement.getAttribute(l)===""||this.inputElement.getAttribute(l)==="true";this.setProperties({readonly:c},!e)}break;case"placeholder":((0,a.le)(this.datepickerOptions)||this.datepickerOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.inputElement.getAttribute(l)},!e);break;case"style":this.inputElement.setAttribute("style",""+this.inputElement.getAttribute(l));break;case"name":this.inputElement.setAttribute("name",""+this.inputElement.getAttribute(l));break;case"value":if((0,a.le)(this.datepickerOptions)||this.datepickerOptions.value===void 0||e){var u=this.inputElement.getAttribute(l);this.setProperties((0,a.sO)(l,this.globalize.parseDate(u,r),{}),!e)}break;case"min":if(+this.min==+new Date(1900,0,1)||e){var p=this.inputElement.getAttribute(l);this.setProperties((0,a.sO)(l,this.globalize.parseDate(p),{}),!e)}break;case"max":if(+this.max==+new Date(2099,11,31)||e){var f=this.inputElement.getAttribute(l);this.setProperties((0,a.sO)(l,this.globalize.parseDate(f),{}),!e)}break;case"type":this.inputElement.getAttribute(l)!=="text"&&this.inputElement.setAttribute("type","text");break}}},t.prototype.getModuleName=function(){return"datepicker"},t.prototype.disabledDates=function(){var e,i,r=this.checkDateValue(this.value)?new Date(+this.value):new Date(this.checkValue(this.value)),n=this.previousDate;this.minMaxUpdates(),o.prototype.render.call(this),this.previousDate=n;var s=r&&+r,l='*[id^="/id"]'.replace("/id",""+s);this.strictMode||(typeof this.value=="string"||typeof this.value=="object"&&+this.value!=+r)&&this.setProperties({value:r},!0),(0,a.le)(this.calendarElement.querySelectorAll(l)[0])||this.calendarElement.querySelectorAll(l)[0].classList.contains("e-disabled")&&(this.strictMode||(this.currentDate=new Date(new Date().setHours(0,0,0,0))));var h;this.getModuleName()==="datetimepicker"?(this.calendarMode==="Gregorian"?i=this.globalize.formatDate(r,{format:(0,a.le)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd"}):i=this.globalize.formatDate(r,{format:(0,a.le)(this.formatString)?this.dateTimeFormat:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),h=i):(this.calendarMode==="Gregorian"?e={format:this.formatString,type:"dateTime",skeleton:"yMd"}:e={format:this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"},h=this.globalize.formatDate(r,e)),this.popupObj||(this.updateInputValue(h),this.enableMask&&(this.updateInputValue(this.maskedDateValue),this.notify("createMask",{module:"MaskedDateTime"})))},t.prototype.setAriaAttributes=function(){this.isCalendar()?(Ue.addAttributes({"aria-expanded":"true"},this.inputElement),(0,a.Y4)(this.inputElement,{"aria-activedescendant":""+this.setActiveDescendant()})):(Ue.addAttributes({"aria-expanded":"false"},this.inputElement),(0,a.Y4)(this.inputElement,{"aria-activedescendant":"null"}))},t.prototype.errorClass=function(){var e='*[id^="/id"]'.replace("/id",""+ +this.value),i=this.calendarElement&&this.calendarElement.querySelectorAll(e)[0]&&this.calendarElement.querySelectorAll(e)[0].classList.contains("e-disabled");!(0,a.le)(this.value)&&!(+new Date(+this.value).setMilliseconds(0)>=+this.min&&+new Date(+this.value).setMilliseconds(0)<=+this.max)||!this.strictMode&&this.inputElement.value!==""&&this.inputElement.value!==this.maskedDateValue&&(0,a.le)(this.value)||i?((0,a.cn)([this.inputWrapper.container],Bm),(0,a.Y4)(this.inputElement,{"aria-invalid":"true"})):((0,a.IV)([this.inputWrapper.container],Bm),(0,a.Y4)(this.inputElement,{"aria-invalid":"false"}))},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"value":this.isDynamicValueChanged=!0,this.isInteracted=!1,this.invalidValueString=null,this.checkInvalidValue(e.value),e.value=this.value,this.previousElementValue=this.inputElement.value,(0,a.le)(this.value)&&(this.updateInputValue(""),this.currentDate=new Date(new Date().setHours(0,0,0,0))),this.updateInput(!0),+this.previousDate!=+this.value&&this.changeTrigger(null),this.isInteracted=!0,this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange,this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"format":this.checkFormat(),this.bindInputEvent(),this.updateInput(),this.enableMask&&(this.notify("createMask",{module:"MaskedDateTime"}),this.value||this.updateInputValue(this.maskedDateValue));break;case"allowEdit":this.setAllowEdit();break;case"placeholder":Ue.setPlaceholder(this.placeholder,this.inputElement);break;case"readonly":Ue.setReadonly(this.readonly,this.inputElement);break;case"enabled":Ue.setEnabled(this.enabled,this.inputElement),this.setAriaDisabled();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkHtmlAttributes(!0);break;case"locale":this.globalize=new a.eC(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),Ue.setPlaceholder(this.placeholder,this.inputElement),this.updateInput(),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"enableRtl":Ue.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"start":case"depth":this.checkView(),this.calendarElement&&o.prototype.onPropertyChanged.call(this,e,i);break;case"zIndex":this.setProperties({zIndex:e.zIndex},!0);break;case"cssClass":this.updateCssClass(e.cssClass,i.cssClass);break;case"showClearButton":Ue.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent(),this.index=this.showClearButton?2:1;break;case"strictMode":this.invalidValueString=null,this.updateInput();break;case"width":this.setWidth(e.width);break;case"floatLabelType":this.floatLabelType=e.floatLabelType,Ue.removeFloating(this.inputWrapper),Ue.addFloating(this.inputElement,this.floatLabelType,this.placeholder);break;case"enableMask":this.enableMask?(this.notify("createMask",{module:"MaskedDateTime"}),this.updateInputValue(this.maskedDateValue),this.bindInputEvent()):this.inputElement.value===this.maskedDateValue&&this.updateInputValue("");break;default:this.calendarElement&&this.isCalendar()&&o.prototype.onPropertyChanged.call(this,e,i);break}this.isDynamicValueChanged||this.hide(null),this.isDynamicValueChanged=!1}},fi([(0,a.Z9)(null)],t.prototype,"width",void 0),fi([(0,a.Z9)(null)],t.prototype,"value",void 0),fi([(0,a.Z9)(null)],t.prototype,"cssClass",void 0),fi([(0,a.Z9)(!1)],t.prototype,"strictMode",void 0),fi([(0,a.Z9)(null)],t.prototype,"format",void 0),fi([(0,a.Z9)(!0)],t.prototype,"enabled",void 0),fi([(0,a.Z9)({})],t.prototype,"htmlAttributes",void 0),fi([(0,a.Z9)(null)],t.prototype,"values",void 0),fi([(0,a.Z9)(!1)],t.prototype,"isMultiSelection",void 0),fi([(0,a.Z9)(!0)],t.prototype,"showClearButton",void 0),fi([(0,a.Z9)(!0)],t.prototype,"allowEdit",void 0),fi([(0,a.Z9)(null)],t.prototype,"keyConfigs",void 0),fi([(0,a.Z9)(!1)],t.prototype,"enablePersistence",void 0),fi([(0,a.Z9)(1e3)],t.prototype,"zIndex",void 0),fi([(0,a.Z9)(!1)],t.prototype,"readonly",void 0),fi([(0,a.Z9)(null)],t.prototype,"placeholder",void 0),fi([(0,a.Z9)("Never")],t.prototype,"floatLabelType",void 0),fi([(0,a.Z9)(null)],t.prototype,"serverTimezoneOffset",void 0),fi([(0,a.Z9)(!1)],t.prototype,"openOnFocus",void 0),fi([(0,a.Z9)(!1)],t.prototype,"enableMask",void 0),fi([(0,a.Z9)({day:"day",month:"month",year:"year",hour:"hour",minute:"minute",second:"second",dayOfTheWeek:"day of the week"})],t.prototype,"maskPlaceholder",void 0),fi([(0,a.ju)()],t.prototype,"open",void 0),fi([(0,a.ju)()],t.prototype,"cleared",void 0),fi([(0,a.ju)()],t.prototype,"close",void 0),fi([(0,a.ju)()],t.prototype,"blur",void 0),fi([(0,a.ju)()],t.prototype,"focus",void 0),fi([(0,a.ju)()],t.prototype,"created",void 0),fi([(0,a.ju)()],t.prototype,"destroyed",void 0),t=fi([a.Zl],t),t}(HS),zm=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Kt=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},QS="e-time-wrapper",JS="e-popup",_m="e-error",jm="240px",Wm=new Date().getDate(),Um=new Date().getMonth(),qm=new Date().getFullYear(),tc="e-timepicker",ew="e-lib",tw="e-control",iw="e-content",la="e-active",vd="e-hover",md="e-navigation",Cn="e-disabled",rw="e-icon-anim",bO="e-time-icon",CO="e-clear-icon",gd="e-input-focus",Jn="e-list-item",Zm=2,Ym=50,Gm="e-time-overflow",nw=4,yd="e-non-edit",Km=["title","class","style"],bd;(function(o){function t(e,i,r,n,s,l){var h;this.calendarMode==="Gregorian"?h={format:s,type:"time"}:h={format:s,type:"time",calendar:"islamic"};var c,u=l*6e4,p=[],f=[];c=+i.setMilliseconds(0);for(var g=+r.setMilliseconds(0);g>=c;)f.push(c),p.push(n.formatDate(new Date(c),{format:s,type:"time"})),c+=u;var C=Mt.createList(e,p,null,!0);return{collection:f,list:C}}o.createListItems=t})(bd||(bd={}));var SO=function(o){zm(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Kt([(0,a.Z9)("day")],t.prototype,"day",void 0),Kt([(0,a.Z9)("month")],t.prototype,"month",void 0),Kt([(0,a.Z9)("year")],t.prototype,"year",void 0),Kt([(0,a.Z9)("day of the week")],t.prototype,"dayOfTheWeek",void 0),Kt([(0,a.Z9)("hour")],t.prototype,"hour",void 0),Kt([(0,a.Z9)("minute")],t.prototype,"minute",void 0),Kt([(0,a.Z9)("second")],t.prototype,"second",void 0),t}(a.rt),wO=function(o){zm(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.liCollections=[],r.timeCollections=[],r.disableItemCollection=[],r.invalidValueString=null,r.isAngular=!1,r.preventChange=!1,r.maskedDateValue="",r.moduleName=r.getModuleName(),r.timeOptions=e,r}return t.prototype.preRender=function(){this.keyConfigure={enter:"enter",escape:"escape",end:"end",tab:"tab",home:"home",down:"downarrow",up:"uparrow",left:"leftarrow",right:"rightarrow",open:"alt+downarrow",close:"alt+uparrow"},this.cloneElement=this.element.cloneNode(!0),(0,a.IV)([this.cloneElement],[tc,tw,ew]),this.inputElement=this.element,this.angularTag=null,this.formElement=(0,a.oq)(this.element,"form"),this.element.tagName==="EJS-TIMEPICKER"&&(this.angularTag=this.element.tagName,this.inputElement=this.createElement("input"),this.element.appendChild(this.inputElement)),this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),this.openPopupEventArgs={appendTo:document.body}},t.prototype.render=function(){this.initialize(),this.createInputElement(),this.updateHtmlAttributeToWrapper(),this.setTimeAllowEdit(),this.setEnable(),this.validateInterval(),this.bindEvents(),this.validateDisable(),this.setValue(this.getFormattedValue(this.value)),this.enableMask&&!this.value&&this.maskedDateValue&&(this.floatLabelType=="Always"||!this.floatLabelType||!this.placeholder)&&(this.updateInputValue(this.maskedDateValue),this.checkErrorState(this.maskedDateValue)),this.anchor=this.inputElement,this.inputElement.setAttribute("value",this.inputElement.value),this.inputEleValue=this.getDateObject(this.inputElement.value),this.renderComplete()},t.prototype.setTimeAllowEdit=function(){this.allowEdit?this.readonly||this.inputElement.removeAttribute("readonly"):(0,a.Y4)(this.inputElement,{readonly:""}),this.clearIconState()},t.prototype.clearIconState=function(){!this.allowEdit&&this.inputWrapper&&!this.readonly?this.inputElement.value===""?(0,a.IV)([this.inputWrapper.container],[yd]):(0,a.cn)([this.inputWrapper.container],[yd]):this.inputWrapper&&(0,a.IV)([this.inputWrapper.container],[yd])},t.prototype.validateDisable=function(){this.setMinMax(this.initMin,this.initMax),this.popupCreation(),this.popupObj.destroy(),this.popupWrapper=this.popupObj=null,!isNaN(+this.value)&&this.value!==null&&(this.valueIsDisable(this.value)||(this.strictMode&&this.resetState(),this.initValue=null,this.initMax=this.getDateObject(this.initMax),this.initMin=this.getDateObject(this.initMin),this.timeCollections=this.liCollections=[],this.setMinMax(this.initMin,this.initMax)))},t.prototype.validationAttribute=function(e,i){var r=e.getAttribute("name")?e.getAttribute("name"):e.getAttribute("id");i.setAttribute("name",r),e.removeAttribute("name");for(var n=["required","aria-required","form"],s=0;s<n.length;s++)if(!(0,a.le)(e.getAttribute(n[s]))){var l=e.getAttribute(n[s]);i.setAttribute(n[s],l),e.removeAttribute(n[s])}},t.prototype.initialize=function(){this.globalize=new a.eC(this.locale),this.defaultCulture=new a.eC("en"),this.checkTimeFormat(),this.checkInvalidValue(this.value),this.setProperties({value:this.checkDateValue(new Date(this.checkInValue(this.value)))},!0),this.setProperties({min:this.checkDateValue(new Date(this.checkInValue(this.min)))},!0),this.setProperties({max:this.checkDateValue(new Date(this.checkInValue(this.max)))},!0),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkInValue(this.scrollTo)))},!0),this.angularTag!==null&&this.validationAttribute(this.element,this.inputElement),this.updateHtmlAttributeToElement(),this.checkAttributes(!1);var e={placeholder:this.placeholder};this.l10n=new a.E7("timepicker",e,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.initValue=this.checkDateValue(this.value),this.initMin=this.checkDateValue(this.min),this.initMax=this.checkDateValue(this.max),this.isNavigate=this.isPreventBlur=this.isTextSelected=!1,this.activeIndex=this.valueWithMinutes=this.prevDate=null,(0,a.le)(this.element.getAttribute("id"))?(this.element.id=(0,a.QI)("ej2_timepicker"),this.angularTag!==null&&(0,a.Y4)(this.inputElement,{id:this.element.id+"_input"})):this.angularTag!==null&&(this.inputElement.id=this.element.getAttribute("id")+"_input"),(0,a.le)(this.inputElement.getAttribute("name"))&&(0,a.Y4)(this.inputElement,{name:this.element.id}),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"})},t.prototype.checkTimeFormat=function(){if(this.format)if(typeof this.format=="string")this.formatString=this.format;else if(!(0,a.le)(this.format.skeleton)&&this.format.skeleton!==""){var e=this.format.skeleton;this.formatString=this.globalize.getDatePattern({type:"time",skeleton:e})}else this.formatString=this.globalize.getDatePattern({type:"time",skeleton:"short"});else this.formatString=null},t.prototype.checkDateValue=function(e){return!(0,a.le)(e)&&e instanceof Date&&!isNaN(+e)?e:null},t.prototype.createInputElement=function(){var e=this.cssClass,i=!this.enableMask;!(0,a.le)(this.cssClass)&&this.cssClass!==""&&(e=this.cssClass.replace(/\s+/g," ").trim()),this.inputWrapper=Ue.createInput({element:this.inputElement,bindClearAction:i,floatLabelType:this.floatLabelType,properties:{readonly:this.readonly,placeholder:this.placeholder,cssClass:e,enabled:this.enabled,enableRtl:this.enableRtl,showClearButton:this.showClearButton},buttons:[" e-input-group-icon e-time-icon e-icons"]},this.createElement),this.inputWrapper.container.style.width=this.setWidth(this.width),(0,a.Y4)(this.inputElement,{"aria-haspopup":"true","aria-autocomplete":"list",tabindex:"0","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-disabled":"false","aria-invalid":"false"}),this.isNullOrEmpty(this.inputStyle)||Ue.addAttributes({style:this.inputStyle},this.inputElement),(0,a.cn)([this.inputWrapper.container],QS)},t.prototype.getCldrDateTimeFormat=function(){var e=new a.eC(this.locale),i,r=e.getDatePattern({skeleton:"yMd"});return this.isNullOrEmpty(this.formatString)?i=r+" "+this.cldrFormat("time"):i=this.formatString,i},t.prototype.checkInvalidValue=function(e){var i=!1;if(typeof e!="object"&&!(0,a.le)(e)){var r=e;typeof r=="string"&&(r=r.trim());var n=null,s=null;if(typeof e=="number"?r=e.toString():typeof e=="string"&&(/^[a-zA-Z0-9- ]*$/.test(e)||(n=this.setCurrentDate(this.getDateObject(e)),(0,a.le)(n)&&(n=this.checkDateValue(this.globalize.parseDate(r,{format:this.getCldrDateTimeFormat(),type:"datetime"})),(0,a.le)(n)&&(n=this.checkDateValue(this.globalize.parseDate(r,{format:this.formatString,type:"dateTime",skeleton:"yMd"})))))),s=this.globalize.parseDate(r,{format:this.getCldrDateTimeFormat(),type:"datetime"}),n=!(0,a.le)(s)&&s instanceof Date&&!isNaN(+s)?s:null,(0,a.le)(n)&&r.replace(/\s/g,"").length){var l=null,h=null;l=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,h=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,!l.test(r)&&!h.test(r)||/^[a-zA-Z0-9- ]*$/.test(e)||isNaN(+new Date(""+r))?i=!0:n=new Date(""+r)}i?(this.strictMode||(this.invalidValueString=r),this.setProperties({value:null},!0),this.initValue=null):(this.setProperties({value:n},!0),this.initValue=this.value)}},t.prototype.requiredModules=function(){var e=[];return this.enableMask&&e.push({args:[this],member:"MaskedDateTime"}),e},t.prototype.cldrFormat=function(e){var i;return this.locale==="en"||this.locale==="en-US"?i=(0,a.NA)("timeFormats.short",(0,a.bD)()):i=this.getCultureTimeObject(a.qV,""+this.locale),i},t.prototype.destroy=function(){this.hide(),this.unBindEvents();var e={"aria-haspopup":"true","aria-autocomplete":"list",tabindex:"0","aria-activedescendant":"null","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-disabled":"true","aria-invalid":"false"};this.inputElement&&(Ue.removeAttributes(e,this.inputElement),this.angularTag===null&&this.inputWrapper.container.parentElement.appendChild(this.inputElement),(0,a.le)(this.cloneElement.getAttribute("tabindex"))?this.inputElement.removeAttribute("tabindex"):this.inputElement.setAttribute("tabindex",this.tabIndex),this.ensureInputAttribute(),this.enableElement([this.inputElement]),this.inputElement.classList.remove("e-input"),(0,a.le)(this.cloneElement.getAttribute("disabled"))&&Ue.setEnabled(!0,this.inputElement,this.floatLabelType)),this.inputWrapper.container&&(0,a.og)(this.inputWrapper.container),this.inputWrapper=this.popupWrapper=this.cloneElement=void 0,this.liCollections=this.timeCollections=this.disableItemCollection=[],(0,a.le)(this.rippleFn)||this.rippleFn(),o.prototype.destroy.call(this),this.formElement&&a.bi.remove(this.formElement,"reset",this.formResetHandler)},t.prototype.ensureInputAttribute=function(){for(var e=[],i=0;i<this.inputElement.attributes.length;i++)e[i]=this.inputElement.attributes[i].name;for(var i=0;i<e.length;i++)(0,a.le)(this.cloneElement.getAttribute(e[i]))?(this.inputElement.removeAttribute(e[i]),e[i].toLowerCase()==="value"&&(this.inputElement.value="")):(this.inputElement.setAttribute(e[i],this.cloneElement.getAttribute(e[i])),e[i].toLowerCase()==="value"&&(this.inputElement.value=this.cloneElement.getAttribute(e[i])))},t.prototype.popupCreation=function(){this.popupWrapper=this.createElement("div",{className:tc+" "+JS,attrs:{id:this.element.id+"_popup",style:"visibility:hidden"}}),(0,a.le)(this.cssClass)||(this.popupWrapper.className+=" "+this.cssClass),!(0,a.le)(this.step)&&this.step>0&&(this.generateList(),(0,a.R3)([this.listWrapper],this.popupWrapper)),this.openPopupEventArgs.appendTo.appendChild(this.popupWrapper),this.addSelection(),this.renderPopup(),(0,a.og)(this.popupWrapper)},t.prototype.getPopupHeight=function(){var e=parseInt(jm,10),i=this.popupWrapper.getBoundingClientRect().height;return i>e?e:i},t.prototype.generateList=function(){this.createListItems(),this.wireListEvents();var e={duration:300,selector:"."+Jn};this.rippleFn=(0,a.qx)(this.listWrapper,e),this.liCollections=this.listWrapper.querySelectorAll("."+Jn)},t.prototype.renderPopup=function(){var e=this;this.containerStyle=this.inputWrapper.container.getBoundingClientRect(),this.popupObj=new br(this.popupWrapper,{width:this.setPopupWidth(this.width),zIndex:this.zIndex,targetType:"relative",position:a.AR.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},collision:a.AR.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},enableRtl:this.enableRtl,relateTo:a.AR.isDevice?document.body:this.inputWrapper.container,offsetY:nw,open:function(){e.popupWrapper.style.visibility="visible",(0,a.cn)([e.inputWrapper.buttons[0]],la)},close:function(){(0,a.IV)([e.inputWrapper.buttons[0]],la),e.unWireListEvents(),e.inputElement.setAttribute("aria-activedescendant","null"),(0,a.Od)(e.popupObj.element),e.popupObj.destroy(),e.popupWrapper.innerHTML="",e.listWrapper=e.popupWrapper=e.listTag=void 0},targetExitViewport:function(){a.AR.isDevice||e.hide()}}),a.AR.isDevice||(this.popupObj.collision={X:"none",Y:"flip"}),this.popupObj.element.style.maxHeight=jm},t.prototype.getFormattedValue=function(e){return(0,a.le)(this.checkDateValue(e))?null:this.globalize.formatDate(e,{skeleton:"medium",type:"time"})},t.prototype.getDateObject=function(e){if(!this.isNullOrEmpty(e)){var i=this.createDateObj(e),r=!this.isNullOrEmpty(this.initValue);if(this.checkDateValue(i)){var n=r?this.initValue.getDate():Wm,s=r?this.initValue.getMonth():Um,l=r?this.initValue.getFullYear():qm;return new Date(l,s,n,i.getHours(),i.getMinutes(),i.getSeconds())}}return null},t.prototype.updateHtmlAttributeToWrapper=function(){if(!(0,a.le)(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];if(Km.indexOf(r)>-1)if(r==="class"){var n=this.htmlAttributes[r].replace(/\s+/g," ").trim();n!==""&&(0,a.cn)([this.inputWrapper.container],n.split(" "))}else if(r==="style"){var s=this.inputWrapper.container.getAttribute(r);s=(0,a.le)(s)?this.htmlAttributes[r]:s+this.htmlAttributes[r],this.inputWrapper.container.setAttribute(r,s)}else this.inputWrapper.container.setAttribute(r,this.htmlAttributes[r])}},t.prototype.updateHtmlAttributeToElement=function(){if(!(0,a.le)(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var r=i[e];Km.indexOf(r)<0&&this.inputElement.setAttribute(r,this.htmlAttributes[r])}},t.prototype.updateCssClass=function(e,i){(0,a.le)(i)||(i=i.replace(/\s+/g," ").trim()),(0,a.le)(e)||(e=e.replace(/\s+/g," ").trim()),Ue.setCssClass(e,[this.inputWrapper.container],i),this.popupWrapper&&Ue.setCssClass(e,[this.popupWrapper],i)},t.prototype.removeErrorClass=function(){(0,a.IV)([this.inputWrapper.container],_m),(0,a.Y4)(this.inputElement,{"aria-invalid":"false"})},t.prototype.checkErrorState=function(e){var i=this.getDateObject(e);this.validateState(i)&&!this.invalidValueString||this.enableMask&&this.inputElement.value===this.maskedDateValue?this.removeErrorClass():((0,a.cn)([this.inputWrapper.container],_m),(0,a.Y4)(this.inputElement,{"aria-invalid":"true"}))},t.prototype.validateInterval=function(){!(0,a.le)(this.step)&&this.step>0?this.enableElement([this.inputWrapper.buttons[0]]):this.disableTimeIcon()},t.prototype.disableTimeIcon=function(){this.disableElement([this.inputWrapper.buttons[0]]),this.hide()},t.prototype.disableElement=function(e){(0,a.cn)(e,Cn)},t.prototype.enableElement=function(e){(0,a.IV)(e,Cn)},t.prototype.selectInputText=function(){this.inputElement.setSelectionRange(0,this.inputElement.value.length)},t.prototype.setCursorToEnd=function(){this.inputElement.setSelectionRange(this.inputElement.value.length,this.inputElement.value.length)},t.prototype.getMeridianText=function(){var e;if(this.locale==="en"||this.locale==="en-US")e=(0,a.NA)("dayPeriods.format.wide",(0,a.bD)());else{var i=".dates.calendars.gregorian.dayPeriods.format.abbreviated",r="main.";e=(0,a.NA)(r+""+this.locale+i,a.qV)}return e},t.prototype.getCursorSelection=function(){var e=this.inputElement,i=0,r=0;return isNaN(e.selectionStart)||(i=e.selectionStart,r=e.selectionEnd),{start:Math.abs(i),end:Math.abs(r)}},t.prototype.getActiveElement=function(){return(0,a.le)(this.popupWrapper)?null:this.popupWrapper.querySelectorAll("."+la)},t.prototype.isNullOrEmpty=function(e){return!!((0,a.le)(e)||typeof e=="string"&&e.trim()==="")},t.prototype.setWidth=function(e){return typeof e=="number"?e=(0,a.Ac)(e):typeof e=="string"?e=e.match(/px|%|em/)?e:(0,a.Ac)(e):e="100%",e},t.prototype.setPopupWidth=function(e){if(e=this.setWidth(e),e.indexOf("%")>-1){var i=this.containerStyle.width*parseFloat(e)/100;e=i.toString()+"px"}return e},t.prototype.setScrollPosition=function(){var e=this.selectedElement;(0,a.le)(e)?this.popupWrapper&&this.checkDateValue(this.scrollTo)&&this.setScrollTo():this.findScrollTop(e)},t.prototype.findScrollTop=function(e){var i=this.getPopupHeight(),r=e.nextElementSibling,n=r?r.offsetTop:e.offsetTop,s=e.getBoundingClientRect().height;n+e.offsetTop>i?this.popupWrapper.scrollTop=r?n-(i/Zm+s/Zm):n:this.popupWrapper.scrollTop=0},t.prototype.setScrollTo=function(){var e;if((0,a.le)(this.popupWrapper))this.popupWrapper.scrollTop=0;else{var i=this.popupWrapper.querySelectorAll("."+Jn);if(i.length){var r=this.timeCollections[0],n=this.getDateObject(this.checkDateValue(this.scrollTo)).getTime();e=i[Math.round((n-r)/(this.step*6e4))]}}(0,a.le)(e)?this.popupWrapper.scrollTop=0:this.findScrollTop(e)},t.prototype.getText=function(){return(0,a.le)(this.checkDateValue(this.value))?"":this.getValue(this.value)},t.prototype.getValue=function(e){return(0,a.le)(this.checkDateValue(e))?null:this.globalize.formatDate(e,{format:this.cldrTimeFormat(),type:"time"})},t.prototype.cldrDateFormat=function(){var e;return this.locale==="en"||this.locale==="en-US"?e=(0,a.NA)("dateFormats.short",(0,a.bD)()):e=this.getCultureDateObject(a.qV,""+this.locale),e},t.prototype.cldrTimeFormat=function(){var e;return this.isNullOrEmpty(this.formatString)?this.locale==="en"||this.locale==="en-US"?e=(0,a.NA)("timeFormats.short",(0,a.bD)()):e=this.getCultureTimeObject(a.qV,""+this.locale):e=this.formatString,e},t.prototype.dateToNumeric=function(){var e;return this.locale==="en"||this.locale==="en-US"?e=(0,a.NA)("timeFormats.medium",(0,a.bD)()):e=(0,a.NA)("main."+this.locale+".dates.calendars.gregorian.timeFormats.medium",a.qV),e},t.prototype.getExactDateTime=function(e){return(0,a.le)(this.checkDateValue(e))?null:this.globalize.formatDate(e,{format:this.dateToNumeric(),type:"time"})},t.prototype.setValue=function(e){var i=this.checkValue(e);!this.strictMode&&!this.validateState(i)?(this.checkDateValue(this.valueWithMinutes)===null&&(this.initValue=this.valueWithMinutes=null),this.validateMinMax(this.value,this.min,this.max)):this.isNullOrEmpty(i)?(this.initValue=null,this.validateMinMax(this.value,this.min,this.max)):this.initValue=this.compareFormatChange(i),this.updateInput(!0,this.initValue)},t.prototype.compareFormatChange=function(e){return(0,a.le)(e)?null:e!==this.getText()?this.getDateObject(e):this.getDateObject(this.value)},t.prototype.updatePlaceHolder=function(){Ue.setPlaceholder(this.l10n.getConstant("placeholder"),this.inputElement)},t.prototype.updateInputValue=function(e){Ue.setValue(e,this.inputElement,this.floatLabelType,this.showClearButton)},t.prototype.preventEventBubbling=function(e){e.preventDefault(),this.interopAdaptor.invokeMethodAsync("OnTimeIconClick")},t.prototype.popupHandler=function(e){!this.enabled||(a.AR.isDevice&&this.inputElement.setAttribute("readonly",""),e.preventDefault(),this.isPopupOpen()?this.closePopup(0,e):(this.inputElement.focus(),this.show(e)))},t.prototype.mouseDownHandler=function(){!this.enabled||this.readonly||(this.inputElement.setSelectionRange(0,0),a.bi.add(this.inputElement,"mouseup",this.mouseUpHandler,this))},t.prototype.mouseUpHandler=function(e){if(!this.readonly)if(e.preventDefault(),this.enableMask){e.preventDefault(),this.notify("setMaskSelection",{module:"MaskedDateTime"});return}else{a.bi.remove(this.inputElement,"mouseup",this.mouseUpHandler);var i=this.getCursorSelection();i.start===0&&i.end===this.inputElement.value.length||(this.inputElement.value.length>0&&(this.cursorDetails=this.focusSelection()),this.inputElement.setSelectionRange(this.cursorDetails.start,this.cursorDetails.end))}},t.prototype.focusSelection=function(){var e=new RegExp("^[a-zA-Z0-9]+$"),i=this.inputElement.value.split("");i.push(" ");var r=this.getCursorSelection(),n=0,s=0,l=!1;if(this.isTextSelected)n=r.start,s=r.end,this.isTextSelected=!1;else for(var h=0;h<i.length;h++)if(e.test(i[h])||(s=h,l=!0),l)if(r.start>=n&&r.end<=s){s=s,this.isTextSelected=!0;break}else n=h+1,l=!1;return{start:n,end:s}},t.prototype.inputHandler=function(e){if(!this.readonly&&this.enabled)switch(e.action!=="right"&&e.action!=="left"&&e.action!=="tab"&&e.preventDefault(),e.action){case"home":case"end":case"up":case"down":this.enableMask&&!this.readonly&&!this.isPopupOpen()&&(e.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e})),(!this.enableMask||this.isPopupOpen())&&this.keyHandler(e);break;case"enter":this.isNavigate?(this.selectedElement=this.liCollections[this.activeIndex],this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),this.updateValue(this.valueWithMinutes,e)):this.updateValue(this.inputElement.value,e),this.hide(),this.isNavigate=!1,this.isPopupOpen()&&e.stopPropagation();break;case"open":this.show(e);break;case"escape":this.updateInputValue(this.objToString(this.value)),this.enableMask&&(this.value||this.updateInputValue(this.maskedDateValue),this.createMask()),this.previousState(this.value),this.hide();break;case"close":this.hide();break;case"right":case"left":case"tab":case"shiftTab":!this.isPopupOpen()&&this.enableMask&&!this.readonly&&((this.inputElement.selectionStart==0&&this.inputElement.selectionEnd==this.inputElement.value.length||this.inputElement.selectionEnd!==this.inputElement.value.length&&e.action=="tab"||this.inputElement.selectionStart!==0&&e.action=="shiftTab"||e.action=="left"||e.action=="right")&&e.preventDefault(),this.notify("keyDownHandler",{module:"MaskedDateTime",e}));break;default:this.isNavigate=!1;break}},t.prototype.onMouseClick=function(e){var i=e.target,r=this.selectedElement=(0,a.oq)(i,"."+Jn);this.setSelection(r,e),r&&r.classList.contains(Jn)&&this.hide()},t.prototype.closePopup=function(e,i){var r=this;if(this.isPopupOpen()&&this.popupWrapper){var n={popup:this.popupObj,event:i||null,cancel:!1,name:"open"};(0,a.IV)([document.body],Gm),this.trigger("close",n,function(s){if(!s.cancel){var l={name:"FadeOut",duration:Ym,delay:e||0};r.popupObj.hide(new a.fw(l)),(0,a.IV)([r.inputWrapper.container],[rw]),(0,a.Y4)(r.inputElement,{"aria-expanded":"false"}),a.bi.remove(document,"mousedown touchstart",r.documentClickHandler)}a.AR.isDevice&&r.modal&&(r.modal.style.display="none",r.modal.outerHTML="",r.modal=null),a.AR.isDevice&&((0,a.le)(r.mobileTimePopupWrap)||(r.mobileTimePopupWrap.remove(),r.mobileTimePopupWrap=null)),a.AR.isDevice&&r.allowEdit&&!r.readonly&&r.inputElement.removeAttribute("readonly")})}else a.AR.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly")},t.prototype.disposeServerPopup=function(){this.popupWrapper&&(this.popupWrapper.style.visibility="hidden",this.popupWrapper.style.top="-9999px",this.popupWrapper.style.left="-9999px",this.popupWrapper.style.width="0px",this.popupWrapper.style.height="0px")},t.prototype.checkValueChange=function(e,i){if(!this.strictMode&&!this.validateState(this.valueWithMinutes))this.checkDateValue(this.valueWithMinutes)===null&&(this.initValue=this.valueWithMinutes=null),this.setProperties({value:this.compareFormatChange(this.inputElement.value)},!0),this.initValue=this.valueWithMinutes=this.compareFormatChange(this.inputElement.value),this.prevValue=this.inputElement.value,+this.prevDate!=+this.value&&this.changeEvent(e);else if(!i)(this.prevValue!==this.inputElement.value||(0,a.le)(this.checkDateValue(this.value)))&&this.valueProcess(e,this.compareFormatChange(this.inputElement.value));else{var r=this.getDateObject(new Date(this.timeCollections[this.activeIndex]));+this.prevDate!=+r&&this.valueProcess(e,r)}},t.prototype.onMouseOver=function(e){var i=(0,a.oq)(e.target,"."+Jn);this.setHover(i,vd)},t.prototype.setHover=function(e,i){this.enabled&&this.isValidLI(e)&&!e.classList.contains(i)&&(this.removeHover(i),(0,a.cn)([e],i),i===md&&e.setAttribute("aria-selected","true"))},t.prototype.setSelection=function(e,i){this.isValidLI(e)&&(this.checkValue(e.getAttribute("data-value")),this.enableMask&&this.notify("setMaskSelection",{module:"MaskedDateTime"}),this.selectedElement=e,this.activeIndex=Array.prototype.slice.call(this.liCollections).indexOf(e),this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),(0,a.cn)([this.selectedElement],la),this.selectedElement.setAttribute("aria-selected","true"),this.checkValueChange(i,!0))},t.prototype.onMouseLeave=function(){this.removeHover(vd)},t.prototype.scrollHandler=function(){this.getModuleName()==="timepicker"&&a.AR.isDevice||this.hide()},t.prototype.setMinMax=function(e,i){(0,a.le)(this.checkDateValue(e))&&(this.initMin=this.getDateObject("12:00:00 AM")),(0,a.le)(this.checkDateValue(i))&&(this.initMax=this.getDateObject("11:59:59 PM"))},t.prototype.validateMinMax=function(e,i,r){var n=e instanceof Date?e:this.getDateObject(e);return(0,a.le)(this.checkDateValue(n))?+this.createDateObj(this.getFormattedValue(this.initMin))>+this.createDateObj(this.getFormattedValue(this.initMax))&&this.disableTimeIcon():e=this.strictOperation(this.initMin,this.initMax,e,n),this.strictMode&&(e=this.valueIsDisable(e)?e:null),this.checkErrorState(e),e},t.prototype.valueIsDisable=function(e){if(this.disableItemCollection.length>0){if(this.disableItemCollection.length===this.timeCollections.length)return!1;for(var i=e instanceof Date?this.objToString(e):e,r=0;r<this.disableItemCollection.length;r++)if(i===this.disableItemCollection[r])return!1}return!0},t.prototype.validateState=function(e){if(!this.strictMode)if(this.valueIsDisable(e)){var i=typeof e=="string"?this.setCurrentDate(this.getDateObject(e)):this.setCurrentDate(this.getDateObject(e)),r=this.setCurrentDate(this.getDateObject(this.initMax)),n=this.setCurrentDate(this.getDateObject(this.initMin));if((0,a.le)(this.checkDateValue(i))){if(+r<+n||this.inputElement.value!=="")return!1}else if(+i>+r||+i<+n)return!1}else return!1;return!0},t.prototype.strictOperation=function(e,i,r,n){var s=this.createDateObj(this.getFormattedValue(i)),l=this.createDateObj(this.getFormattedValue(e)),h=this.createDateObj(this.getFormattedValue(n));if(this.strictMode){if(+l>+s)return this.disableTimeIcon(),this.initValue=this.getDateObject(s),this.updateInputValue(this.getValue(this.initValue)),this.enableMask&&this.createMask(),this.inputElement.value;if(+l>=+h)return this.getDateObject(l);if(+h>=+s||+l==+s)return this.getDateObject(s)}else if(+l>+s&&(this.disableTimeIcon(),!isNaN(+this.createDateObj(r))))return r;return r},t.prototype.bindEvents=function(){a.bi.add(this.inputWrapper.buttons[0],"mousedown",this.popupHandler,this),a.bi.add(this.inputElement,"blur",this.inputBlurHandler,this),a.bi.add(this.inputElement,"focus",this.inputFocusHandler,this),a.bi.add(this.inputElement,"change",this.inputChangeHandler,this),a.bi.add(this.inputElement,"input",this.inputEventHandler,this),this.enableMask&&a.bi.add(this.inputElement,"keydown",this.keydownHandler,this),this.showClearButton&&this.inputWrapper.clearButton&&a.bi.add(this.inputWrapper.clearButton,"mousedown",this.clearHandler,this),this.formElement&&a.bi.add(this.formElement,"reset",this.formResetHandler,this),a.AR.isDevice||(this.keyConfigure=(0,a.l7)(this.keyConfigure,this.keyConfigs),this.inputEvent=new a.nv(this.inputWrapper.container,{keyAction:this.inputHandler.bind(this),keyConfigs:this.keyConfigure,eventName:"keydown"}),this.showClearButton&&this.inputElement&&a.bi.add(this.inputElement,"mousedown",this.mouseDownHandler,this))},t.prototype.keydownHandler=function(e){switch(e.code){case"Delete":this.enableMask&&!this.popupObj&&!this.readonly&&this.notify("keyDownHandler",{module:"MaskedDateTime",e});break;default:break}},t.prototype.formResetHandler=function(){if(!!this.enabled&&!this.inputElement.disabled){var e=this.inputElement.getAttribute("value"),i=this.checkDateValue(this.inputEleValue);this.element.tagName==="EJS-TIMEPICKER"&&(i=null,e="",this.inputElement.setAttribute("value","")),this.setProperties({value:i},!0),this.prevDate=this.value,this.valueWithMinutes=this.value,this.initValue=this.value,this.inputElement&&(this.updateInputValue(e),this.enableMask&&(e||this.updateInputValue(this.maskedDateValue),this.createMask()),this.checkErrorState(e),this.prevValue=this.inputElement.value)}},t.prototype.inputChangeHandler=function(e){!this.enabled||e.stopPropagation()},t.prototype.inputEventHandler=function(){this.enableMask&&this.notify("inputHandler",{module:"MaskedDateTime"})},t.prototype.unBindEvents=function(){this.inputWrapper&&a.bi.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.popupHandler),a.bi.remove(this.inputElement,"blur",this.inputBlurHandler),a.bi.remove(this.inputElement,"focus",this.inputFocusHandler),a.bi.remove(this.inputElement,"change",this.inputChangeHandler),a.bi.remove(this.inputElement,"input",this.inputEventHandler),this.inputEvent&&this.inputEvent.destroy(),a.bi.remove(this.inputElement,"mousedown touchstart",this.mouseDownHandler),this.showClearButton&&!(0,a.le)(this.inputWrapper.clearButton)&&a.bi.remove(this.inputWrapper.clearButton,"mousedown touchstart",this.clearHandler),this.formElement&&a.bi.remove(this.formElement,"reset",this.formResetHandler)},t.prototype.bindClearEvent=function(){this.showClearButton&&this.inputWrapper.clearButton&&a.bi.add(this.inputWrapper.clearButton,"mousedown",this.clearHandler,this)},t.prototype.raiseClearedEvent=function(e){var i={event:e};this.trigger("cleared",i)},t.prototype.clearHandler=function(e){!this.enabled||(e.preventDefault(),(0,a.le)(this.value)?(this.resetState(),this.raiseClearedEvent(e)):this.clear(e),this.popupWrapper&&(this.popupWrapper.scrollTop=0),this.enableMask&&this.notify("clearHandler",{module:"MaskedDateTime"}))},t.prototype.clear=function(e){this.setProperties({value:null},!0),this.initValue=null,this.resetState(),this.raiseClearedEvent(e),this.changeEvent(e)},t.prototype.setZIndex=function(){this.popupObj&&(this.popupObj.zIndex=this.zIndex,this.popupObj.dataBind())},t.prototype.checkAttributes=function(e){for(var i=e?(0,a.le)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["step","disabled","readonly","style","name","value","min","max","placeholder"],r,n=0,s=i;n<s.length;n++){var l=s[n];if(!(0,a.le)(this.inputElement.getAttribute(l)))switch(l){case"disabled":if((0,a.le)(this.timeOptions)||this.timeOptions.enabled===void 0||e){var h=!(this.inputElement.getAttribute(l)==="disabled"||this.inputElement.getAttribute(l)===""||this.inputElement.getAttribute(l)==="true");this.setProperties({enabled:h},!e)}break;case"style":this.inputStyle=this.inputElement.getAttribute(l);break;case"readonly":if((0,a.le)(this.timeOptions)||this.timeOptions.readonly===void 0||e){var c=this.inputElement.getAttribute(l)==="readonly"||this.inputElement.getAttribute(l)===""||this.inputElement.getAttribute(l)==="true";this.setProperties({readonly:c},!e)}break;case"name":this.inputElement.setAttribute("name",this.inputElement.getAttribute(l));break;case"step":this.step=parseInt(this.inputElement.getAttribute(l),10);break;case"placeholder":((0,a.le)(this.timeOptions)||this.timeOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.inputElement.getAttribute(l)},!e);break;case"min":((0,a.le)(this.timeOptions)||this.timeOptions.min===void 0||e)&&(r=new Date(this.inputElement.getAttribute(l)),(0,a.le)(this.checkDateValue(r))||this.setProperties({min:r},!e));break;case"max":((0,a.le)(this.timeOptions)||this.timeOptions.max===void 0||e)&&(r=new Date(this.inputElement.getAttribute(l)),(0,a.le)(this.checkDateValue(r))||this.setProperties({max:r},!e));break;case"value":((0,a.le)(this.timeOptions)||this.timeOptions.value===void 0||e)&&(r=new Date(this.inputElement.getAttribute(l)),(0,a.le)(this.checkDateValue(r))||(this.initValue=r,this.updateInput(!1,this.initValue),this.setProperties({value:r},!e)));break}}},t.prototype.setCurrentDate=function(e){return(0,a.le)(this.checkDateValue(e))?null:new Date(qm,Um,Wm,e.getHours(),e.getMinutes(),e.getSeconds())},t.prototype.getTextFormat=function(){var e=0;if(this.cldrTimeFormat().split(" ")[0]==="a"||this.cldrTimeFormat().indexOf("a")===0)e=1;else if(this.cldrTimeFormat().indexOf("a")<0){for(var i=this.cldrTimeFormat().split(" "),r=0;r<i.length;r++)if(i[r].toLowerCase().indexOf("h")>=0){e=r;break}}return e},t.prototype.updateValue=function(e,i){var r;if(this.isNullOrEmpty(e))this.resetState();else if(r=this.checkValue(e),this.strictMode){var n=r===null&&e.trim().length>0?this.previousState(this.prevDate):this.inputElement.value;this.updateInputValue(n),this.enableMask&&(n||this.updateInputValue(this.maskedDateValue),(0,a.le)(r)&&e!=this.maskedDateValue&&this.createMask(),(0,a.le)(r)&&e==this.maskedDateValue&&this.updateInputValue(this.maskedDateValue))}this.checkValueChange(i,typeof e!="string")},t.prototype.previousState=function(e){for(var i=this.getDateObject(e),r=0;r<this.timeCollections.length;r++)if(+i===this.timeCollections[r]){this.activeIndex=r,this.selectedElement=this.liCollections[r],this.valueWithMinutes=new Date(this.timeCollections[r]);break}return this.prevValue},t.prototype.resetState=function(){this.removeSelection(),Ue.setValue("",this.inputElement,this.floatLabelType,!1),this.valueWithMinutes=this.activeIndex=null,this.strictMode||this.checkErrorState(null)},t.prototype.objToString=function(e){return(0,a.le)(this.checkDateValue(e))?null:this.globalize.formatDate(e,{format:this.cldrTimeFormat(),type:"time"})},t.prototype.checkValue=function(e){if(!this.isNullOrEmpty(e)){var i=e instanceof Date?e:this.getDateObject(e);return this.validateValue(i,e)}return this.resetState(),this.valueWithMinutes=null},t.prototype.validateValue=function(e,i){var r,n=this.validateMinMax(i,this.min,this.max),s=this.createDateObj(n);if(this.getFormattedValue(s)!==this.getFormattedValue(this.value)?(this.valueWithMinutes=(0,a.le)(s)?null:s,r=this.objToString(this.valueWithMinutes)):(this.strictMode&&(e=s),this.valueWithMinutes=this.checkDateValue(e),r=this.objToString(this.valueWithMinutes)),!this.strictMode&&(0,a.le)(r)){var l=n.trim().length>0?n:"";this.updateInputValue(l),this.enableMask&&(l||this.updateInputValue(this.maskedDateValue))}else this.updateInputValue(r),this.enableMask&&(r==""&&this.updateInputValue(this.maskedDateValue),(0,a.le)(r)&&i!=this.maskedDateValue&&this.createMask(),(0,a.le)(r)&&i==this.maskedDateValue&&this.updateInputValue(this.maskedDateValue));return r},t.prototype.createMask=function(){this.notify("createMask",{module:"MaskedDateTime"})},t.prototype.findNextElement=function(e){var i=this.inputElement.value,r=(0,a.le)(this.valueWithMinutes)?this.createDateObj(i):this.getDateObject(this.valueWithMinutes),n=null,s=this.liCollections.length,l=this.timeCollections;if(!(0,a.le)(this.checkDateValue(r))||!(0,a.le)(this.activeIndex)){if(e.action==="home"){var h=this.validLiElement(0);n=+this.createDateObj(new Date(this.timeCollections[h])),this.activeIndex=h}else if(e.action==="end"){var h=this.validLiElement(l.length-1,!0);n=+this.createDateObj(new Date(this.timeCollections[h])),this.activeIndex=h}else if(e.action==="down"){for(var c=0;c<s;c++)if(+r<this.timeCollections[c]){var h=this.validLiElement(c);n=+this.createDateObj(new Date(this.timeCollections[h])),this.activeIndex=h;break}else if(c===s-1){var h=this.validLiElement(0);n=+this.createDateObj(new Date(this.timeCollections[h])),this.activeIndex=h;break}}else for(var c=s-1;c>=0;c--)if(+r>this.timeCollections[c]){var h=this.validLiElement(c,!0);n=+this.createDateObj(new Date(this.timeCollections[h])),this.activeIndex=h;break}else if(c===0){var h=this.validLiElement(s-1);n=+this.createDateObj(new Date(this.timeCollections[h])),this.activeIndex=h;break}this.selectedElement=this.liCollections[this.activeIndex],this.elementValue((0,a.le)(n)?null:new Date(n))}else this.selectNextItem(e)},t.prototype.selectNextItem=function(e){var i=this.validLiElement(0,e.action!=="down");this.activeIndex=i,this.selectedElement=this.liCollections[i],this.elementValue(new Date(this.timeCollections[i]))},t.prototype.elementValue=function(e){(0,a.le)(this.checkDateValue(e))||this.checkValue(e)},t.prototype.validLiElement=function(e,i){var r=null,n=(0,a.le)(this.popupWrapper)?this.liCollections:this.popupWrapper.querySelectorAll("."+Jn),s=!0;if(n.length)if(i)for(var l=e;l>=0;l--)if(n[l].classList.contains(Cn))l===0&&s&&(e=l=n.length,s=!1);else{r=l;break}else for(var l=e;l<=n.length-1;l++)if(n[l].classList.contains(Cn))l===n.length-1&&s&&(e=l=-1,s=!1);else{r=l;break}return r},t.prototype.keyHandler=function(e){if(!((0,a.le)(this.step)||this.step<=0||this.inputWrapper.buttons[0].classList.contains(Cn))){var i=this.timeCollections.length;if((0,a.le)(this.getActiveElement())||this.getActiveElement().length===0)if(this.liCollections.length>0)if((0,a.le)(this.value)&&(0,a.le)(this.activeIndex)){var r=this.validLiElement(0,e.action!=="down");this.activeIndex=r,this.selectedElement=this.liCollections[r],this.elementValue(new Date(this.timeCollections[r]))}else this.findNextElement(e);else this.findNextElement(e);else{var n=void 0;if(e.keyCode>=37&&e.keyCode<=40){var r=e.keyCode===40||e.keyCode===39?++this.activeIndex:--this.activeIndex;this.activeIndex=r=this.activeIndex===i?0:this.activeIndex,this.activeIndex=r=this.activeIndex<0?i-1:this.activeIndex,this.activeIndex=r=this.validLiElement(this.activeIndex,!(e.keyCode===40||e.keyCode===39)),n=(0,a.le)(this.timeCollections[r])?this.timeCollections[0]:this.timeCollections[r]}else if(e.action==="home"){var r=this.validLiElement(0);this.activeIndex=r,n=this.timeCollections[r]}else if(e.action==="end"){var r=this.validLiElement(i-1,!0);this.activeIndex=r,n=this.timeCollections[r]}this.selectedElement=this.liCollections[this.activeIndex],this.elementValue(new Date(n))}this.isNavigate=!0,this.setHover(this.selectedElement,md),this.setActiveDescendant(),this.selectInputText(),this.isPopupOpen()&&this.selectedElement!==null&&(!e||e.type!=="click")&&this.setScrollPosition()}},t.prototype.getCultureTimeObject=function(e,i){return(0,a.NA)("main."+i+".dates.calendars.gregorian.timeFormats.short",e)},t.prototype.getCultureDateObject=function(e,i){return(0,a.NA)("main."+i+".dates.calendars.gregorian.dateFormats.short",e)},t.prototype.wireListEvents=function(){a.bi.add(this.listWrapper,"click",this.onMouseClick,this),a.AR.isDevice||(a.bi.add(this.listWrapper,"mouseover",this.onMouseOver,this),a.bi.add(this.listWrapper,"mouseout",this.onMouseLeave,this))},t.prototype.unWireListEvents=function(){this.listWrapper&&(a.bi.remove(this.listWrapper,"click",this.onMouseClick),a.AR.isDevice||(a.bi.remove(this.listWrapper,"mouseover",this.onMouseOver),a.bi.remove(this.listWrapper,"mouseout",this.onMouseLeave)))},t.prototype.valueProcess=function(e,i){var r=(0,a.le)(this.checkDateValue(i))?null:i;+this.prevDate!=+r&&(this.initValue=r,this.changeEvent(e))},t.prototype.changeEvent=function(e){this.addSelection(),this.updateInput(!0,this.initValue);var i={event:e||null,value:this.value,text:this.inputElement.value,isInteracted:!(0,a.le)(e),element:this.element};i.value=this.valueWithMinutes||this.getDateObject(this.inputElement.value),this.prevDate=this.valueWithMinutes||this.getDateObject(this.inputElement.value),this.isAngular&&this.preventChange?this.preventChange=!1:this.trigger("change",i),this.invalidValueString=null,this.checkErrorState(this.value)},t.prototype.updateInput=function(e,i){e&&(this.prevValue=this.getValue(i)),this.prevDate=this.valueWithMinutes=i,(typeof i!="number"||(this.value&&+new Date(+this.value).setMilliseconds(0))!==+i)&&(this.setProperties({value:i},!0),this.enableMask&&this.createMask()),!this.strictMode&&(0,a.le)(this.value)&&this.invalidValueString&&(this.checkErrorState(this.invalidValueString),this.updateInputValue(this.invalidValueString)),this.clearIconState()},t.prototype.setActiveDescendant=function(){(0,a.le)(this.selectedElement)?(0,a.Y4)(this.inputElement,{"aria-activedescendant":"null"}):(0,a.Y4)(this.inputElement,{"aria-activedescendant":this.selectedElement.getAttribute("id")})},t.prototype.removeSelection=function(){if(this.removeHover(vd),!(0,a.le)(this.popupWrapper)){var e=this.popupWrapper.querySelectorAll("."+la);e.length&&((0,a.IV)(e,la),e[0].removeAttribute("aria-selected"))}},t.prototype.removeHover=function(e){var i=this.getHoverItem(e);i&&i.length&&((0,a.IV)(i,e),e===md&&i[0].removeAttribute("aria-selected"))},t.prototype.getHoverItem=function(e){var i;return(0,a.le)(this.popupWrapper)||(i=this.popupWrapper.querySelectorAll("."+e)),i},t.prototype.setActiveClass=function(){if(!(0,a.le)(this.popupWrapper)){var e=this.popupWrapper.querySelectorAll("."+Jn);if(e.length){for(var i=0;i<e.length;i++)if(this.timeCollections[i]===+this.getDateObject(this.valueWithMinutes)){e[i].setAttribute("aria-selected","true"),this.selectedElement=e[i],this.activeIndex=i;break}}}},t.prototype.addSelection=function(){this.selectedElement=null,this.removeSelection(),this.setActiveClass(),(0,a.le)(this.selectedElement)||((0,a.cn)([this.selectedElement],la),this.selectedElement.setAttribute("aria-selected","true"))},t.prototype.isValidLI=function(e){return e&&e.classList.contains(Jn)&&!e.classList.contains(Cn)},t.prototype.createDateObj=function(e){var i=null,r=this.globalize.formatDate(new Date,{format:i,skeleton:"short",type:"date"}),n=null;return typeof e=="string"?e.toUpperCase().indexOf("AM")>-1||e.toUpperCase().indexOf("PM")>-1?(r=this.defaultCulture.formatDate(new Date,{format:i,skeleton:"short",type:"date"}),n=isNaN(+new Date(r+" "+e))?null:new Date(new Date(r+" "+e).setMilliseconds(0)),(0,a.le)(n)&&(n=this.timeParse(r,e))):n=this.timeParse(r,e):e instanceof Date&&(n=e),n},t.prototype.timeParse=function(e,i){var r;return r=this.globalize.parseDate(e+" "+i,{format:this.cldrDateFormat()+" "+this.cldrTimeFormat(),type:"datetime"}),r=(0,a.le)(r)?this.globalize.parseDate(e+" "+i,{format:this.cldrDateFormat()+" "+this.dateToNumeric(),type:"datetime"}):r,r=(0,a.le)(r)?r:new Date(r.setMilliseconds(0)),r},t.prototype.createListItems=function(){var e=this;this.listWrapper=this.createElement("div",{className:iw,attrs:{tabindex:"0"}});var i,r=this.step*6e4,n=[];this.timeCollections=[],this.disableItemCollection=[],i=+this.getDateObject(this.initMin).setMilliseconds(0);for(var s=+this.getDateObject(this.initMax).setMilliseconds(0);s>=i;)this.timeCollections.push(i),n.push(this.globalize.formatDate(new Date(i),{format:this.cldrTimeFormat(),type:"time"})),i+=r;var l={itemCreated:function(h){var c={element:h.item,text:h.text,value:e.getDateObject(h.text),isDisabled:!1};e.trigger("itemRender",c,function(u){u.isDisabled&&u.element.classList.add(Cn),u.element.classList.contains(Cn)&&e.disableItemCollection.push(u.element.getAttribute("data-value"))})}};this.listTag=Mt.createList(this.createElement,n,l,!0),(0,a.Y4)(this.listTag,{role:"listbox","aria-hidden":"false",id:this.element.id+"_options"}),(0,a.R3)([this.listTag],this.listWrapper)},t.prototype.documentClickHandler=function(e){var i=e.target;!(0,a.le)(this.popupObj)&&(this.inputWrapper.container.contains(i)||this.popupObj.element&&this.popupObj.element.contains(i))&&e.type!=="touchstart"&&e.preventDefault(),!(0,a.oq)(i,'[id="'+this.popupObj.element.id+'"]')&&i!==this.inputElement&&i!==(this.inputWrapper&&this.inputWrapper.buttons[0])&&i!==(this.inputWrapper&&this.inputWrapper.clearButton)&&i!==(this.inputWrapper&&this.inputWrapper.container)?this.isPopupOpen()&&(this.hide(),this.focusOut()):i!==this.inputElement&&(a.AR.isDevice||(this.isPreventBlur=(a.AR.isIE||a.AR.info.name==="edge")&&document.activeElement===this.inputElement&&i===this.popupWrapper))},t.prototype.setEnableRtl=function(){Ue.setEnableRtl(this.enableRtl,[this.inputWrapper.container]),this.popupObj&&(this.popupObj.enableRtl=this.enableRtl,this.popupObj.dataBind())},t.prototype.setEnable=function(){Ue.setEnabled(this.enabled,this.inputElement,this.floatLabelType),this.enabled?((0,a.IV)([this.inputWrapper.container],Cn),(0,a.Y4)(this.inputElement,{"aria-disabled":"false"}),this.inputElement.setAttribute("tabindex",this.tabIndex)):(this.hide(),(0,a.cn)([this.inputWrapper.container],Cn),(0,a.Y4)(this.inputElement,{"aria-disabled":"true"}),this.inputElement.tabIndex=-1)},t.prototype.getProperty=function(e,i){i==="min"?(this.initMin=this.checkDateValue(new Date(this.checkInValue(e.min))),this.setProperties({min:this.initMin},!0)):(this.initMax=this.checkDateValue(new Date(this.checkInValue(e.max))),this.setProperties({max:this.initMax},!0)),this.inputElement.value===""?this.validateMinMax(this.value,this.min,this.max):this.checkValue(this.inputElement.value),this.checkValueChange(null,!1)},t.prototype.inputBlurHandler=function(e){if(!!this.enabled){if(this.isPreventBlur&&this.isPopupOpen()){this.inputElement.focus();return}this.closePopup(0,e),this.enableMask&&this.maskedDateValue&&this.placeholder&&this.floatLabelType!=="Always"&&this.inputElement.value==this.maskedDateValue&&!this.value&&(this.floatLabelType=="Auto"||this.floatLabelType=="Never"||this.placeholder)&&this.updateInputValue(""),(0,a.IV)([this.inputWrapper.container],[gd]);var i={model:this};this.trigger("blur",i),this.getText()!==this.inputElement.value?this.updateValue(this.inputElement.value,e):this.inputElement.value.trim().length===0&&this.resetState(),this.cursorDetails=null,this.isNavigate=!1,this.inputElement.value===""&&(this.invalidValueString=null)}},t.prototype.focusOut=function(){if(document.activeElement===this.inputElement){this.inputElement.blur(),(0,a.IV)([this.inputWrapper.container],[gd]);var e={model:this};this.trigger("blur",e)}},t.prototype.isPopupOpen=function(){return!!(this.popupWrapper&&this.popupWrapper.classList.contains(""+tc))},t.prototype.inputFocusHandler=function(){if(!!this.enabled){var e={model:this};!this.readonly&&!a.AR.isDevice&&!this.enableMask&&this.selectInputText(),this.enableMask&&!this.inputElement.value&&this.placeholder&&this.maskedDateValue&&!this.value&&(this.floatLabelType=="Auto"||this.floatLabelType=="Never"||this.placeholder)&&(this.updateInputValue(this.maskedDateValue),this.inputElement.selectionStart=0,this.inputElement.selectionEnd=this.inputElement.value.length),this.trigger("focus",e),this.clearIconState(),this.openOnFocus&&this.show()}},t.prototype.focusIn=function(){document.activeElement!==this.inputElement&&this.enabled&&this.inputElement.focus()},t.prototype.hide=function(){this.closePopup(100,null),this.clearIconState()},t.prototype.show=function(e){var i=this;if(!(this.enabled&&this.readonly||!this.enabled||this.popupWrapper)){this.popupCreation(),a.AR.isDevice&&this.listWrapper&&(this.modal=this.createElement("div"),this.modal.className=""+tc+" e-time-modal",document.body.className+=" "+Gm,document.body.appendChild(this.modal)),a.AR.isDevice&&(this.mobileTimePopupWrap=this.createElement("div",{className:"e-timepicker-mob-popup-wrap"}),document.body.appendChild(this.mobileTimePopupWrap)),this.openPopupEventArgs={popup:this.popupObj||null,cancel:!1,event:e||null,name:"open",appendTo:a.AR.isDevice?this.mobileTimePopupWrap:document.body};var r=this.openPopupEventArgs;this.trigger("open",r,function(n){if(i.openPopupEventArgs=n,!i.openPopupEventArgs.cancel&&!i.inputWrapper.buttons[0].classList.contains(Cn)){i.openPopupEventArgs.appendTo.appendChild(i.popupWrapper),i.popupAlignment(i.openPopupEventArgs),i.setScrollPosition(),a.AR.isDevice||i.inputElement.focus();var s={name:"FadeIn",duration:Ym};i.popupObj.refreshPosition(i.anchor),i.zIndex===1e3?i.popupObj.show(new a.fw(s),i.element):i.popupObj.show(new a.fw(s),null),i.setActiveDescendant(),(0,a.Y4)(i.inputElement,{"aria-expanded":"true"}),(0,a.cn)([i.inputWrapper.container],gd),a.bi.add(document,"mousedown touchstart",i.documentClickHandler,i),i.setOverlayIndex(i.mobileTimePopupWrap,i.popupObj.element,i.modal,a.AR.isDevice)}else i.popupObj.destroy(),i.popupWrapper=i.listTag=void 0,i.liCollections=i.timeCollections=i.disableItemCollection=[],i.popupObj=null})}},t.prototype.setOverlayIndex=function(e,i,r,n){if(n&&!(0,a.le)(i)&&!(0,a.le)(r)&&!(0,a.le)(e)){var s=parseInt(i.style.zIndex,10)?parseInt(i.style.zIndex,10):1e3;r.style.zIndex=(s-1).toString(),e.style.zIndex=s.toString()}},t.prototype.formatValues=function(e){var i;return typeof e=="number"?i=(0,a.Ac)(e):typeof e=="string"&&(i=e.match(/px|%|em/)||isNaN(parseInt(e,10))?e:(0,a.Ac)(e)),i},t.prototype.popupAlignment=function(e){if(e.popup.position.X=this.formatValues(e.popup.position.X),e.popup.position.Y=this.formatValues(e.popup.position.Y),(!isNaN(parseFloat(e.popup.position.X))||!isNaN(parseFloat(e.popup.position.Y)))&&(this.popupObj.relateTo=this.anchor=document.body,this.popupObj.targetType="container"),isNaN(parseFloat(e.popup.position.X))||(this.popupObj.offsetX=parseFloat(e.popup.position.X)),isNaN(parseFloat(e.popup.position.Y))||(this.popupObj.offsetY=parseFloat(e.popup.position.Y)),a.AR.isDevice)e.popup.position.X==="center"&&e.popup.position.Y==="center"&&(this.popupObj.relateTo=this.anchor=document.body,this.popupObj.offsetY=0,this.popupObj.targetType="container",this.popupObj.collision={X:"fit",Y:"fit"});else{switch(e.popup.position.X){case"left":break;case"right":e.popup.offsetX=this.containerStyle.width;break;case"center":e.popup.offsetX=-(this.containerStyle.width/2);break}switch(e.popup.position.Y){case"top":break;case"bottom":break;case"center":e.popup.offsetY=-(this.containerStyle.height/2);break}e.popup.position.X==="center"&&e.popup.position.Y==="center"&&(this.popupObj.relateTo=this.inputWrapper.container,this.anchor=this.inputElement,this.popupObj.targetType="relative")}},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.getModuleName=function(){return"timepicker"},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"placeholder":Ue.setPlaceholder(e.placeholder,this.inputElement),this.inputElement.setAttribute("aria-placeholder",e.placeholder);break;case"readonly":Ue.setReadonly(this.readonly,this.inputElement,this.floatLabelType),this.readonly&&this.hide(),this.setTimeAllowEdit();break;case"enabled":this.setProperties({enabled:e.enabled},!0),this.setEnable();break;case"allowEdit":this.setTimeAllowEdit();break;case"enableRtl":this.setProperties({enableRtl:e.enableRtl},!0),this.setEnableRtl();break;case"cssClass":this.updateCssClass(e.cssClass,i.cssClass);break;case"zIndex":this.setProperties({zIndex:e.zIndex},!0),this.setZIndex();break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkAttributes(!0);break;case"min":case"max":this.getProperty(e,s);break;case"showClearButton":Ue.setClearButton(this.showClearButton,this.inputElement,this.inputWrapper),this.bindClearEvent();break;case"locale":this.setProperties({locale:e.locale},!0),this.globalize=new a.eC(this.locale),this.l10n.setLocale(this.locale),this.updatePlaceHolder(),this.setValue(this.value),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"width":(0,a.V7)(this.inputWrapper.container,{width:this.setWidth(e.width)}),this.containerStyle=this.inputWrapper.container.getBoundingClientRect();break;case"format":this.setProperties({format:e.format},!0),this.checkTimeFormat(),this.setValue(this.value),this.enableMask&&(this.createMask(),this.value||this.updateInputValue(this.maskedDateValue));break;case"value":this.invalidValueString=null,this.checkInvalidValue(e.value),e.value=this.value,this.invalidValueString?(this.updateInputValue(this.invalidValueString),this.checkErrorState(this.invalidValueString)):(typeof e.value=="string"?(this.setProperties({value:this.checkDateValue(new Date(e.value))},!0),e.value=this.value):(e.value&&+new Date(+e.value).setMilliseconds(0))!==+this.value&&(e.value=this.checkDateValue(new Date(""+e.value))),this.initValue=e.value,e.value=this.compareFormatChange(this.checkValue(e.value))),this.checkValueChange(null,!1),this.isPopupOpen()&&this.setScrollPosition(),this.isAngular&&this.preventChange&&(this.preventChange=!1),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"});break;case"floatLabelType":this.floatLabelType=e.floatLabelType,Ue.removeFloating(this.inputWrapper),Ue.addFloating(this.inputElement,this.floatLabelType,this.placeholder);break;case"strictMode":this.invalidValueString=null,e.strictMode&&this.checkErrorState(null),this.setProperties({strictMode:e.strictMode},!0),this.checkValue(this.inputElement.value),this.checkValueChange(null,!1);break;case"scrollTo":this.checkDateValue(new Date(this.checkInValue(e.scrollTo)))?(this.popupWrapper&&this.setScrollTo(),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkInValue(e.scrollTo)))},!0)):this.setProperties({scrollTo:null},!0);break;case"enableMask":this.enableMask?(this.notify("createMask",{module:"MaskedDateTime"}),this.updateInputValue(this.maskedDateValue)):this.inputElement.value===this.maskedDateValue&&this.updateInputValue("");break}}},t.prototype.checkInValue=function(e){return e instanceof Date?e.toUTCString():""+e},Kt([(0,a.Z9)(null)],t.prototype,"width",void 0),Kt([(0,a.Z9)(null)],t.prototype,"cssClass",void 0),Kt([(0,a.Z9)(!1)],t.prototype,"strictMode",void 0),Kt([(0,a.Z9)(null)],t.prototype,"keyConfigs",void 0),Kt([(0,a.Z9)(null)],t.prototype,"format",void 0),Kt([(0,a.Z9)(!0)],t.prototype,"enabled",void 0),Kt([(0,a.Z9)(!1)],t.prototype,"readonly",void 0),Kt([(0,a.Z9)({})],t.prototype,"htmlAttributes",void 0),Kt([(0,a.Z9)("Never")],t.prototype,"floatLabelType",void 0),Kt([(0,a.Z9)(null)],t.prototype,"placeholder",void 0),Kt([(0,a.Z9)(1e3)],t.prototype,"zIndex",void 0),Kt([(0,a.Z9)(!1)],t.prototype,"enablePersistence",void 0),Kt([(0,a.Z9)(!0)],t.prototype,"showClearButton",void 0),Kt([(0,a.Z9)(30)],t.prototype,"step",void 0),Kt([(0,a.Z9)(null)],t.prototype,"scrollTo",void 0),Kt([(0,a.Z9)(null)],t.prototype,"value",void 0),Kt([(0,a.Z9)(null)],t.prototype,"min",void 0),Kt([(0,a.Z9)(null)],t.prototype,"max",void 0),Kt([(0,a.Z9)(!0)],t.prototype,"allowEdit",void 0),Kt([(0,a.Z9)(!1)],t.prototype,"openOnFocus",void 0),Kt([(0,a.Z9)(!1)],t.prototype,"enableMask",void 0),Kt([(0,a.Z9)({day:"day",month:"month",year:"year",hour:"hour",minute:"minute",second:"second",dayOfTheWeek:"day of the week"})],t.prototype,"maskPlaceholder",void 0),Kt([(0,a.ju)()],t.prototype,"change",void 0),Kt([(0,a.ju)()],t.prototype,"created",void 0),Kt([(0,a.ju)()],t.prototype,"destroyed",void 0),Kt([(0,a.ju)()],t.prototype,"open",void 0),Kt([(0,a.ju)()],t.prototype,"itemRender",void 0),Kt([(0,a.ju)()],t.prototype,"close",void 0),Kt([(0,a.ju)()],t.prototype,"cleared",void 0),Kt([(0,a.ju)()],t.prototype,"blur",void 0),Kt([(0,a.ju)()],t.prototype,"focus",void 0),t=Kt([a.Zl],t),t}(a.wA),sw=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ri=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},aw="e-date-wrapper",ow="e-datepicker",lw="e-datetime-wrapper",hw=new Date().getDate(),cw=new Date().getMonth(),uw=new Date().getFullYear(),pw=new Date().getHours(),dw=new Date().getMinutes(),fw=new Date().getSeconds(),vw=new Date().getMilliseconds(),ll="e-datetimepicker",Xm="e-datetimepopup-wrapper",mw="e-input-group-icon",$m="e-popup",gw="e-time-icon",hl="e-input-focus",Qm="250px",Jm="e-icon-anim",Cd="e-disabled",eg="e-error",yw="e-content",bw="e-navigation",Ls="e-active",Sd="e-hover",Cw="e-icons",tg=2,ks="e-list-item",ig=100,rg="e-time-overflow",Sw=function(o){sw(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.valueWithMinutes=null,r.scrollInvoked=!1,r.moduleName=r.getModuleName(),r.dateTimeOptions=e,r}return t.prototype.focusHandler=function(){!this.enabled||(0,a.cn)([this.inputWrapper.container],hl)},t.prototype.focusIn=function(){o.prototype.focusIn.call(this)},t.prototype.focusOut=function(){document.activeElement===this.inputElement&&(this.inputElement.blur(),(0,a.IV)([this.inputWrapper.container],[hl]))},t.prototype.blurHandler=function(e){if(!!this.enabled){if(this.isTimePopupOpen()&&this.isPreventBlur){this.inputElement.focus();return}(0,a.IV)([this.inputWrapper.container],hl);var i={model:this};this.isTimePopupOpen()&&this.hide(e),this.trigger("blur",i)}},t.prototype.destroy=function(){this.popupObject&&this.popupObject.element.classList.contains($m)&&(this.popupObject.destroy(),(0,a.og)(this.dateTimeWrapper),this.dateTimeWrapper=void 0,this.liCollections=this.timeCollections=[],(0,a.le)(this.rippleFn)||this.rippleFn());var e={"aria-live":"assertive","aria-atomic":"true","aria-invalid":"false","aria-haspopup":"true","aria-activedescendant":"null",autocorrect:"off",autocapitalize:"off",spellcheck:"false","aria-owns":this.element.id+"_options","aria-expanded":"false",role:"combobox",autocomplete:"off"};this.inputElement&&(Ue.removeAttributes(e,this.inputElement),this.inputElement.removeAttribute("aria-placeholder")),this.isCalendar()&&(this.popupWrapper&&(0,a.og)(this.popupWrapper),this.popupObject=this.popupWrapper=null,this.keyboardHandler.destroy()),this.unBindInputEvents(),o.prototype.destroy.call(this)},t.prototype.render=function(){this.timekeyConfigure={enter:"enter",escape:"escape",end:"end",tab:"tab",home:"home",down:"downarrow",up:"uparrow",left:"leftarrow",right:"rightarrow",open:"alt+downarrow",close:"alt+uparrow"},this.valueWithMinutes=null,this.previousDateTime=null,this.isPreventBlur=!1,this.cloneElement=this.element.cloneNode(!0),this.dateTimeFormat=this.cldrDateTimeFormat(),this.initValue=this.value,o.prototype.updateHtmlAttributeToElement.call(this),this.checkAttributes(!1);var e={placeholder:this.placeholder};this.l10n=new a.E7("datetimepicker",e,this.locale),this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),o.prototype.render.call(this),this.createInputElement(),o.prototype.updateHtmlAttributeToWrapper.call(this),this.bindInputEvents(),this.enableMask&&this.notify("createMask",{module:"MaskedDateTime"}),this.setValue(),this.enableMask&&!this.value&&this.maskedDateValue&&(this.floatLabelType=="Always"||!this.floatLabelType||!this.placeholder)&&Ue.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkValue(this.scrollTo)))},!0),this.previousDateTime=this.value&&new Date(+this.value),this.element.tagName==="EJS-DATETIMEPICKER"&&(this.tabIndex=this.element.hasAttribute("tabindex")?this.element.getAttribute("tabindex"):"0",this.element.removeAttribute("tabindex"),this.enabled||(this.inputElement.tabIndex=-1)),this.renderComplete()},t.prototype.setValue=function(){if(this.initValue=this.validateMinMaxRange(this.value),!this.strictMode&&this.isDateObject(this.initValue)){var e=this.validateMinMaxRange(this.initValue);Ue.setValue(this.getFormattedValue(e),this.inputElement,this.floatLabelType,this.showClearButton),this.setProperties({value:e},!0)}else(0,a.le)(this.value)&&(this.initValue=null,this.setProperties({value:null},!0));this.valueWithMinutes=this.value,o.prototype.updateInput.call(this)},t.prototype.validateMinMaxRange=function(e){var i=e;return this.isDateObject(e)?i=this.validateValue(e):+this.min>+this.max&&this.disablePopupButton(!0),this.checkValidState(i),i},t.prototype.checkValidState=function(e){this.isValidState=!0,this.strictMode||(+e>+this.max||+e<+this.min)&&(this.isValidState=!1),this.checkErrorState()},t.prototype.checkErrorState=function(){this.isValidState?(0,a.IV)([this.inputWrapper.container],eg):(0,a.cn)([this.inputWrapper.container],eg),(0,a.Y4)(this.inputElement,{"aria-invalid":this.isValidState?"false":"true"})},t.prototype.validateValue=function(e){var i=e;return this.strictMode?+this.min>+this.max?(this.disablePopupButton(!0),i=this.max):+e<+this.min?i=this.min:+e>+this.max&&(i=this.max):+this.min>+this.max&&(this.disablePopupButton(!0),i=e),i},t.prototype.disablePopupButton=function(e){e?((0,a.cn)([this.inputWrapper.buttons[0],this.timeIcon],Cd),this.hide()):(0,a.IV)([this.inputWrapper.buttons[0],this.timeIcon],Cd)},t.prototype.getFormattedValue=function(e){var i;return(0,a.le)(e)?null:(this.calendarMode==="Gregorian"?i={format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:"yMd"}:i={format:this.cldrDateTimeFormat(),type:"dateTime",skeleton:"yMd",calendar:"islamic"},this.globalize.formatDate(e,i))},t.prototype.isDateObject=function(e){return!(0,a.le)(e)&&!isNaN(+e)},t.prototype.createInputElement=function(){(0,a.IV)([this.inputElement],ow),(0,a.IV)([this.inputWrapper.container],aw),(0,a.cn)([this.inputWrapper.container],lw),(0,a.cn)([this.inputElement],ll),this.renderTimeIcon()},t.prototype.renderTimeIcon=function(){this.timeIcon=Ue.appendSpan(mw+" "+gw+" "+Cw,this.inputWrapper.container)},t.prototype.bindInputEvents=function(){a.bi.add(this.timeIcon,"mousedown",this.timeHandler,this),a.bi.add(this.inputWrapper.buttons[0],"mousedown",this.dateHandler,this),a.bi.add(this.inputElement,"blur",this.blurHandler,this),a.bi.add(this.inputElement,"focus",this.focusHandler,this),this.defaultKeyConfigs=(0,a.l7)(this.defaultKeyConfigs,this.keyConfigs),this.keyboardHandler=new a.nv(this.inputElement,{eventName:"keydown",keyAction:this.inputKeyAction.bind(this),keyConfigs:this.defaultKeyConfigs})},t.prototype.unBindInputEvents=function(){a.bi.remove(this.timeIcon,"mousedown touchstart",this.timeHandler),a.bi.remove(this.inputWrapper.buttons[0],"mousedown touchstart",this.dateHandler),this.inputElement&&(a.bi.remove(this.inputElement,"blur",this.blurHandler),a.bi.remove(this.inputElement,"focus",this.focusHandler)),this.keyboardHandler&&this.keyboardHandler.destroy()},t.prototype.cldrTimeFormat=function(){var e;return this.isNullOrEmpty(this.timeFormat)?this.locale==="en"||this.locale==="en-US"?e=(0,a.NA)("timeFormats.short",(0,a.bD)()):e=this.getCultureTimeObject(a.qV,""+this.locale):e=this.timeFormat,e},t.prototype.cldrDateTimeFormat=function(){var e,i=new a.eC(this.locale),r=i.getDatePattern({skeleton:"yMd"});return this.isNullOrEmpty(this.formatString)?e=r+" "+this.getCldrFormat("time"):e=this.formatString,e},t.prototype.getCldrFormat=function(e){var i;return this.locale==="en"||this.locale==="en-US"?i=(0,a.NA)("timeFormats.short",(0,a.bD)()):i=this.getCultureTimeObject(a.qV,""+this.locale),i},t.prototype.isNullOrEmpty=function(e){return!!((0,a.le)(e)||typeof e=="string"&&e.trim()==="")},t.prototype.getCultureTimeObject=function(e,i){return this.calendarMode==="Gregorian"?(0,a.NA)("main."+this.locale+".dates.calendars.gregorian.timeFormats.short",e):(0,a.NA)("main."+this.locale+".dates.calendars.islamic.timeFormats.short",e)},t.prototype.timeHandler=function(e){!this.enabled||(this.isIconClicked=!0,a.AR.isDevice&&this.inputElement.setAttribute("readonly",""),e.currentTarget===this.timeIcon&&e.preventDefault(),this.enabled&&!this.readonly&&(this.isDatePopupOpen()&&o.prototype.hide.call(this,e),this.isTimePopupOpen()?this.closePopup(e):(this.inputElement.focus(),this.popupCreation("time",e),(0,a.cn)([this.inputWrapper.container],[hl]))),this.isIconClicked=!1)},t.prototype.dateHandler=function(e){!this.enabled||(e.currentTarget===this.inputWrapper.buttons[0]&&e.preventDefault(),this.enabled&&!this.readonly&&(this.isTimePopupOpen()&&this.closePopup(e),(0,a.le)(this.popupWrapper)||this.popupCreation("date",e)))},t.prototype.show=function(e,i){this.enabled&&this.readonly||!this.enabled||(e==="time"&&!this.dateTimeWrapper?(this.isDatePopupOpen()&&this.hide(i),this.popupCreation("time",i)):this.popupObj||(this.isTimePopupOpen()&&this.hide(i),o.prototype.show.call(this),this.popupCreation("date",i)))},t.prototype.toggle=function(e){this.isDatePopupOpen()?(o.prototype.hide.call(this,e),this.show("time",null)):this.isTimePopupOpen()?(this.hide(e),o.prototype.show.call(this,null,e),this.popupCreation("date",null)):this.show(null,e)},t.prototype.listCreation=function(){var e;this.calendarMode==="Gregorian"?e=this.globalize.parseDate(this.inputElement.value,{format:this.cldrDateTimeFormat(),type:"datetime"}):e=this.globalize.parseDate(this.inputElement.value,{format:this.cldrDateTimeFormat(),type:"datetime",calendar:"islamic"});var i=(0,a.le)(this.value)?this.inputElement.value!==""?e:new Date:this.value;this.valueWithMinutes=i,this.listWrapper=(0,a.az)("div",{className:yw,attrs:{tabindex:"0"}});var r=this.startTime(i),n=this.endTime(i),s=bd.createListItems(this.createElement,r,n,this.globalize,this.cldrTimeFormat(),this.step);this.timeCollections=s.collection,this.listTag=s.list,(0,a.Y4)(this.listTag,{role:"listbox","aria-hidden":"false",id:this.element.id+"_options"}),(0,a.R3)([s.list],this.listWrapper),this.wireTimeListEvents();var l={duration:300,selector:"."+ks};this.rippleFn=(0,a.qx)(this.listWrapper,l),this.liCollections=this.listWrapper.querySelectorAll("."+ks)},t.prototype.popupCreation=function(e,i){a.AR.isDevice&&this.element.setAttribute("readonly","readonly"),e==="date"?!this.readonly&&this.popupWrapper&&((0,a.cn)([this.popupWrapper],Xm),(0,a.Y4)(this.popupWrapper,{id:this.element.id+"_datepopup"})):this.readonly||(this.dateTimeWrapper=(0,a.az)("div",{className:ll+" "+$m,attrs:{id:this.element.id+"_timepopup",style:"visibility:hidden ; display:block"}}),(0,a.le)(this.cssClass)||(this.dateTimeWrapper.className+=" "+this.cssClass),!(0,a.le)(this.step)&&this.step>0&&(this.listCreation(),(0,a.R3)([this.listWrapper],this.dateTimeWrapper)),document.body.appendChild(this.dateTimeWrapper),this.addTimeSelection(),this.renderPopup(),this.setTimeScrollPosition(),this.openPopup(i),this.popupObject.refreshPosition(this.inputElement))},t.prototype.openPopup=function(e){var i=this;this.preventArgs={cancel:!1,popup:this.popupObject,event:e||null};var r=this.preventArgs;this.trigger("open",r,function(n){if(i.preventArgs=n,!i.preventArgs.cancel&&!i.readonly){var s={name:"FadeIn",duration:ig};i.zIndex===1e3?i.popupObject.show(new a.fw(s),i.element):i.popupObject.show(new a.fw(s),null),(0,a.cn)([i.inputWrapper.container],[Jm]),(0,a.Y4)(i.inputElement,{"aria-expanded":"true"}),a.bi.add(document,"mousedown touchstart",i.documentClickHandler,i)}})},t.prototype.documentClickHandler=function(e){var i=e.target;!(0,a.le)(this.popupObject)&&(this.inputWrapper.container.contains(i)||this.popupObject.element&&this.popupObject.element.contains(i))&&e.type!=="touchstart"&&e.preventDefault(),!(0,a.oq)(i,'[id="'+(this.popupObject&&this.popupObject.element.id+'"]'))&&i!==this.inputElement&&i!==this.timeIcon&&i!==this.inputWrapper.container?this.isTimePopupOpen()&&(this.hide(e),this.focusOut()):i!==this.inputElement&&(a.AR.isDevice||(this.isPreventBlur=document.activeElement===this.inputElement&&(a.AR.isIE||a.AR.info.name==="edge")&&i===this.popupObject.element))},t.prototype.isTimePopupOpen=function(){return!!(this.dateTimeWrapper&&this.dateTimeWrapper.classList.contains(""+ll))},t.prototype.isDatePopupOpen=function(){return!!(this.popupWrapper&&this.popupWrapper.classList.contains(""+Xm))},t.prototype.renderPopup=function(){var e=this;this.containerStyle=this.inputWrapper.container.getBoundingClientRect(),a.AR.isDevice&&(this.timeModal=(0,a.az)("div"),this.timeModal.className=""+ll+" e-time-modal",document.body.className+=" "+rg,this.timeModal.style.display="block",document.body.appendChild(this.timeModal));var i=4;this.popupObject=new br(this.dateTimeWrapper,{width:this.setPopupWidth(),zIndex:this.zIndex,targetType:"container",collision:a.AR.isDevice?{X:"fit",Y:"fit"}:{X:"flip",Y:"flip"},relateTo:a.AR.isDevice?document.body:this.inputWrapper.container,position:a.AR.isDevice?{X:"center",Y:"center"}:{X:"left",Y:"bottom"},enableRtl:this.enableRtl,offsetY:i,open:function(){e.dateTimeWrapper.style.visibility="visible",(0,a.cn)([e.timeIcon],Ls),a.AR.isDevice||(e.timekeyConfigure=(0,a.l7)(e.timekeyConfigure,e.keyConfigs),e.inputEvent=new a.nv(e.inputWrapper.container,{keyAction:e.timeKeyActionHandle.bind(e),keyConfigs:e.timekeyConfigure,eventName:"keydown"}))},close:function(){(0,a.IV)([e.timeIcon],Ls),e.unWireTimeListEvents(),e.inputElement.setAttribute("aria-activedescendant","null"),(0,a.Od)(e.popupObject.element),e.popupObject.destroy(),e.dateTimeWrapper.innerHTML="",e.listWrapper=e.dateTimeWrapper=void 0,e.inputEvent&&e.inputEvent.destroy()},targetExitViewport:function(){a.AR.isDevice||e.hide()}}),this.popupObject.element.style.maxHeight=Qm},t.prototype.setDimension=function(e){return typeof e=="number"?e=(0,a.Ac)(e):typeof e=="string"?e=e:e="100%",e},t.prototype.setPopupWidth=function(){var e=this.setDimension(this.width);if(e.indexOf("%")>-1){var i=this.containerStyle.width*parseFloat(e)/100;e=i.toString()+"px"}return e},t.prototype.wireTimeListEvents=function(){a.bi.add(this.listWrapper,"click",this.onMouseClick,this),a.AR.isDevice||(a.bi.add(this.listWrapper,"mouseover",this.onMouseOver,this),a.bi.add(this.listWrapper,"mouseout",this.onMouseLeave,this))},t.prototype.unWireTimeListEvents=function(){this.listWrapper&&(a.bi.remove(this.listWrapper,"click",this.onMouseClick),a.bi.remove(document,"mousedown touchstart",this.documentClickHandler),a.AR.isDevice||(a.bi.add(this.listWrapper,"mouseover",this.onMouseOver,this),a.bi.add(this.listWrapper,"mouseout",this.onMouseLeave,this)))},t.prototype.onMouseOver=function(e){var i=(0,a.oq)(e.target,"."+ks);this.setTimeHover(i,Sd)},t.prototype.onMouseLeave=function(){this.removeTimeHover(Sd)},t.prototype.setTimeHover=function(e,i){this.enabled&&this.isValidLI(e)&&!e.classList.contains(i)&&(this.removeTimeHover(i),(0,a.cn)([e],i))},t.prototype.getPopupHeight=function(){var e=parseInt(Qm,10),i=this.dateTimeWrapper.getBoundingClientRect().height;return i>e?e:i},t.prototype.changeEvent=function(e){(this.value&&this.value.valueOf())!==(this.previousDateTime&&+this.previousDateTime.valueOf())&&(o.prototype.changeEvent.call(this,e),this.valueWithMinutes=this.value,this.setInputValue("date"),this.previousDateTime=this.value&&new Date(+this.value))},t.prototype.updateValue=function(e){this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs={value:this.value,event:e||null,isInteracted:!(0,a.le)(e),element:this.element},this.addTimeSelection(),this.trigger("change",this.changedArgs),this.previousDateTime=this.previousDate=this.value)},t.prototype.setTimeScrollPosition=function(){var e=this.selectedElement;(0,a.le)(e)?this.dateTimeWrapper&&this.checkDateValue(this.scrollTo)&&this.setScrollTo():this.findScrollTop(e)},t.prototype.findScrollTop=function(e){var i=this.getPopupHeight(),r=e.nextElementSibling,n=r?r.offsetTop:e.offsetTop,s=e.getBoundingClientRect().height;n+e.offsetTop>i?this.dateTimeWrapper.scrollTop=r?n-(i/tg+s/tg):n:this.dateTimeWrapper.scrollTop=0},t.prototype.setScrollTo=function(){var e,i=this.dateTimeWrapper.querySelectorAll("."+ks);if(i.length>=0){this.scrollInvoked=!0;var r=this.timeCollections[0],n=this.getDateObject(this.checkDateValue(this.scrollTo)).getTime();e=i[Math.round((n-r)/(this.step*6e4))]}else this.dateTimeWrapper.scrollTop=0;(0,a.le)(e)?this.dateTimeWrapper.scrollTop=0:this.findScrollTop(e)},t.prototype.setInputValue=function(e){if(e==="date")this.inputElement.value=this.previousElementValue=this.getFormattedValue(this.getFullDateTime()),this.setProperties({value:this.getFullDateTime()},!0);else{var i=this.getFormattedValue(new Date(this.timeCollections[this.activeIndex]));Ue.setValue(i,this.inputElement,this.floatLabelType,this.showClearButton),this.previousElementValue=this.inputElement.value,this.setProperties({value:new Date(this.timeCollections[this.activeIndex])},!0),this.enableMask&&this.createMask()}this.updateIconState()},t.prototype.getFullDateTime=function(){var e=null;return this.isDateObject(this.valueWithMinutes)?e=this.combineDateTime(this.valueWithMinutes):e=this.previousDate,this.validateMinMaxRange(e)},t.prototype.createMask=function(){this.notify("createMask",{module:"MaskedDateTime"})},t.prototype.combineDateTime=function(e){if(this.isDateObject(e)){var i=this.previousDate.getDate(),r=this.previousDate.getMonth(),n=this.previousDate.getFullYear(),s=e.getHours(),l=e.getMinutes(),h=e.getSeconds();return new Date(n,r,i,s,l,h)}else return this.previousDate},t.prototype.onMouseClick=function(e){var i=e.target,r=this.selectedElement=(0,a.oq)(i,"."+ks);r&&r.classList.contains(ks)&&(this.timeValue=r.getAttribute("data-value"),this.hide(e)),this.setSelection(r,e)},t.prototype.setSelection=function(e,i){if(this.isValidLI(e)&&!e.classList.contains(Ls)){this.selectedElement=e;var r=Array.prototype.slice.call(this.liCollections).indexOf(e);this.activeIndex=r,this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),(0,a.cn)([this.selectedElement],Ls),this.selectedElement.setAttribute("aria-selected","true"),this.updateValue(i)}},t.prototype.setTimeActiveClass=function(){var e=(0,a.le)(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper;if(!(0,a.le)(e)){var i=e.querySelectorAll("."+ks);if(i.length){for(var r=0;r<i.length;r++)if(this.timeCollections[r]===+this.valueWithMinutes){i[r].setAttribute("aria-selected","true"),this.selectedElement=i[r],this.activeIndex=r,this.setTimeActiveDescendant();break}}}},t.prototype.setTimeActiveDescendant=function(){(0,a.le)(this.selectedElement)?(0,a.Y4)(this.inputElement,{"aria-activedescendant":"null"}):(0,a.Y4)(this.inputElement,{"aria-activedescendant":this.selectedElement.getAttribute("id")})},t.prototype.addTimeSelection=function(){this.selectedElement=null,this.removeTimeSelection(),this.setTimeActiveClass(),(0,a.le)(this.selectedElement)||((0,a.cn)([this.selectedElement],Ls),this.selectedElement.setAttribute("aria-selected","true"))},t.prototype.removeTimeSelection=function(){if(this.removeTimeHover(Sd),!(0,a.le)(this.dateTimeWrapper)){var e=this.dateTimeWrapper.querySelectorAll("."+Ls);e.length&&((0,a.IV)(e,Ls),e[0].removeAttribute("aria-selected"))}},t.prototype.removeTimeHover=function(e){var i=this.getTimeHoverItem(e);i&&i.length&&(0,a.IV)(i,e)},t.prototype.getTimeHoverItem=function(e){var i=(0,a.le)(this.dateTimeWrapper)?this.listWrapper:this.dateTimeWrapper,r;return(0,a.le)(i)||(r=i.querySelectorAll("."+e)),r},t.prototype.isValidLI=function(e){return e&&e.classList.contains(ks)&&!e.classList.contains(Cd)},t.prototype.calculateStartEnd=function(e,i,r){var n=e.getDate(),s=e.getMonth(),l=e.getFullYear(),h=e.getHours(),c=e.getMinutes(),u=e.getSeconds(),p=e.getMilliseconds();return i?r==="starttime"?new Date(l,s,n,0,0,0):new Date(l,s,n,23,59,59):new Date(l,s,n,h,c,u,p)},t.prototype.startTime=function(e){var i,r,n=this.min,s=e===null?new Date:e;return+s.getDate()==+n.getDate()&&+s.getMonth()==+n.getMonth()&&+s.getFullYear()==+n.getFullYear()||+new Date(s.getFullYear(),s.getMonth(),s.getDate())<=+new Date(n.getFullYear(),n.getMonth(),n.getDate())?(r=!1,i=this.min):+s<+this.max&&+s>+this.min?(r=!0,i=s):+s>=+this.max&&(r=!0,i=this.max),this.calculateStartEnd(i,r,"starttime")},t.prototype.endTime=function(e){var i,r,n=this.max,s=e===null?new Date:e;return+s.getDate()==+n.getDate()&&+s.getMonth()==+n.getMonth()&&+s.getFullYear()==+n.getFullYear()||+new Date(s.getUTCFullYear(),s.getMonth(),s.getDate())>=+new Date(n.getFullYear(),n.getMonth(),n.getDate())?(r=!1,i=this.max):+s<+this.max&&+s>+this.min?(r=!0,i=s):+s<=+this.min&&(r=!0,i=this.min),this.calculateStartEnd(i,r,"endtime")},t.prototype.hide=function(e){var i=this;if(this.popupObj||this.dateTimeWrapper){this.preventArgs={cancel:!1,popup:this.popupObj||this.popupObject,event:e||null};var r=this.preventArgs;(0,a.le)(this.popupObj)?this.trigger("close",r,function(n){i.dateTimeCloseEventCallback(e,n)}):this.dateTimeCloseEventCallback(e,r)}else a.AR.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()},t.prototype.dateTimeCloseEventCallback=function(e,i){this.preventArgs=i,this.preventArgs.cancel||(this.isDatePopupOpen()?o.prototype.hide.call(this,e):this.isTimePopupOpen()&&(this.closePopup(e),(0,a.IV)([document.body],rg),a.AR.isDevice&&this.timeModal&&(this.timeModal.style.display="none",this.timeModal.outerHTML="",this.timeModal=null),this.setTimeActiveDescendant())),a.AR.isDevice&&this.allowEdit&&!this.readonly&&this.inputElement.removeAttribute("readonly"),this.setAllowEdit()},t.prototype.closePopup=function(e){if(this.isTimePopupOpen()&&this.popupObject){var i={name:"FadeOut",duration:ig,delay:0};this.popupObject.hide(new a.fw(i)),this.inputWrapper.container.classList.remove(Jm),(0,a.Y4)(this.inputElement,{"aria-expanded":"false"}),a.bi.remove(document,"mousedown touchstart",this.documentClickHandler)}},t.prototype.preRender=function(){this.checkFormat(),this.dateTimeFormat=this.cldrDateTimeFormat(),o.prototype.preRender.call(this),(0,a.IV)([this.inputElementCopy],[ll])},t.prototype.getProperty=function(e,i){i==="min"?this.setProperties({min:this.validateValue(e.min)},!0):this.setProperties({max:this.validateValue(e.max)},!0)},t.prototype.checkAttributes=function(e){for(var i=e?(0,a.le)(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["style","name","step","disabled","readonly","value","min","max","placeholder","type"],r,n=0,s=i;n<s.length;n++){var l=s[n];if(!(0,a.le)(this.inputElement.getAttribute(l)))switch(l){case"name":this.inputElement.setAttribute("name",this.inputElement.getAttribute(l));break;case"step":this.step=parseInt(this.inputElement.getAttribute(l),10);break;case"readonly":if((0,a.le)(this.dateTimeOptions)||this.dateTimeOptions.readonly===void 0||e){var h=this.inputElement.getAttribute(l)==="disabled"||this.inputElement.getAttribute(l)===""||this.inputElement.getAttribute(l)==="true";this.setProperties({readonly:h},!e)}break;case"placeholder":((0,a.le)(this.dateTimeOptions)||this.dateTimeOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.inputElement.getAttribute(l)},!e);break;case"min":((0,a.le)(this.dateTimeOptions)||this.dateTimeOptions.min===void 0||e)&&(r=new Date(this.inputElement.getAttribute(l)),!this.isNullOrEmpty(r)&&!isNaN(+r)&&this.setProperties({min:r},!e));break;case"disabled":if((0,a.le)(this.dateTimeOptions)||this.dateTimeOptions.enabled===void 0||e){var c=!(this.inputElement.getAttribute(l)==="disabled"||this.inputElement.getAttribute(l)==="true"||this.inputElement.getAttribute(l)==="");this.setProperties({enabled:c},!e)}break;case"value":((0,a.le)(this.dateTimeOptions)||this.dateTimeOptions.value===void 0||e)&&(r=new Date(this.inputElement.getAttribute(l)),!this.isNullOrEmpty(r)&&!isNaN(+r)&&this.setProperties({value:r},!e));break;case"max":((0,a.le)(this.dateTimeOptions)||this.dateTimeOptions.max===void 0||e)&&(r=new Date(this.inputElement.getAttribute(l)),!this.isNullOrEmpty(r)&&!isNaN(+r)&&this.setProperties({max:r},!e));break}}},t.prototype.requiredModules=function(){var e=[];return this&&e.push({args:[this],member:"islamic"}),this.enableMask&&e.push(this.maskedDateModule()),e},t.prototype.maskedDateModule=function(){var e={args:[this],member:"MaskedDateTime"};return e},t.prototype.getTimeActiveElement=function(){return(0,a.le)(this.dateTimeWrapper)?null:this.dateTimeWrapper.querySelectorAll("."+Ls)},t.prototype.createDateObj=function(e){return e instanceof Date?e:null},t.prototype.getDateObject=function(e){if(!this.isNullOrEmpty(e)){var i=this.createDateObj(e),r=this.valueWithMinutes,n=!(0,a.le)(r);if(this.checkDateValue(i)){var s=n?r.getDate():hw,l=n?r.getMonth():cw,h=n?r.getFullYear():uw,c=n?r.getHours():pw,u=n?r.getMinutes():dw,p=n?r.getSeconds():fw,f=n?r.getMilliseconds():vw;return this.scrollInvoked?(this.scrollInvoked=!1,new Date(h,l,s,i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds())):new Date(h,l,s,c,u,p,f)}}return null},t.prototype.findNextTimeElement=function(e){var i=this.inputElement.value,r=(0,a.le)(this.valueWithMinutes)?this.createDateObj(i):this.getDateObject(this.valueWithMinutes),n=null,s=this.liCollections.length;if(!(0,a.le)(this.activeIndex)||!(0,a.le)(this.checkDateValue(r))){if(e.action==="home")n=+this.createDateObj(new Date(this.timeCollections[0])),this.activeIndex=0;else if(e.action==="end")n=+this.createDateObj(new Date(this.timeCollections[this.timeCollections.length-1])),this.activeIndex=this.timeCollections.length-1;else if(e.action==="down"){for(var l=0;l<s;l++)if(+r<this.timeCollections[l]){n=+this.createDateObj(new Date(this.timeCollections[l])),this.activeIndex=l;break}}else for(var l=s-1;l>=0;l--)if(+r>this.timeCollections[l]){n=+this.createDateObj(new Date(this.timeCollections[l])),this.activeIndex=l;break}this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue((0,a.le)(n)?null:new Date(n))}},t.prototype.setTimeValue=function(e,i){var r,n,s=this.validateMinMaxRange(i),l=this.createDateObj(s);return this.getFormattedValue(l)!==((0,a.le)(this.value)?null:this.getFormattedValue(this.value))?(this.valueWithMinutes=(0,a.le)(l)?null:l,n=new Date(+this.valueWithMinutes)):(this.strictMode&&(e=l),this.valueWithMinutes=this.checkDateValue(e),n=new Date(+this.valueWithMinutes)),this.calendarMode==="Gregorian"?r=this.globalize.formatDate(n,{format:(0,a.le)(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:"yMd"}):r=this.globalize.formatDate(n,{format:(0,a.le)(this.formatString)?this.cldrDateTimeFormat():this.formatString,type:"dateTime",skeleton:"yMd",calendar:"islamic"}),!this.strictMode&&(0,a.le)(n)?Ue.setValue(r,this.inputElement,this.floatLabelType,this.showClearButton):Ue.setValue(r,this.inputElement,this.floatLabelType,this.showClearButton),n},t.prototype.timeElementValue=function(e){if(!(0,a.le)(this.checkDateValue(e))&&!this.isNullOrEmpty(e)){var i=e instanceof Date?e:this.getDateObject(e);return this.setTimeValue(i,e)}return null},t.prototype.timeKeyHandler=function(e){if(!((0,a.le)(this.step)||this.step<=0)){var i=this.timeCollections.length;if((0,a.le)(this.getTimeActiveElement())||this.getTimeActiveElement().length===0)this.liCollections.length>0&&((0,a.le)(this.value)&&(0,a.le)(this.activeIndex)?(this.activeIndex=0,this.selectedElement=this.liCollections[0],this.timeElementValue(new Date(this.timeCollections[0]))):this.findNextTimeElement(e));else{var r=void 0;if(e.keyCode>=37&&e.keyCode<=40){var n=e.keyCode===40||e.keyCode===39?++this.activeIndex:--this.activeIndex;this.activeIndex=n=this.activeIndex===i?0:this.activeIndex,this.activeIndex=n=this.activeIndex<0?i-1:this.activeIndex,r=(0,a.le)(this.timeCollections[n])?this.timeCollections[0]:this.timeCollections[n]}else e.action==="home"?(this.activeIndex=0,r=this.timeCollections[0]):e.action==="end"&&(this.activeIndex=i-1,r=this.timeCollections[i-1]);this.selectedElement=this.liCollections[this.activeIndex],this.timeElementValue(new Date(r))}this.isNavigate=!0,this.setTimeHover(this.selectedElement,bw),this.setTimeActiveDescendant(),this.isTimePopupOpen()&&this.selectedElement!==null&&(!e||e.type!=="click")&&this.setTimeScrollPosition()}},t.prototype.timeKeyActionHandle=function(e){if(this.enabled)switch(e.action!=="right"&&e.action!=="left"&&e.action!=="tab"&&e.preventDefault(),e.action){case"up":case"down":case"home":case"end":this.timeKeyHandler(e);break;case"enter":this.isNavigate?(this.selectedElement=this.liCollections[this.activeIndex],this.valueWithMinutes=new Date(this.timeCollections[this.activeIndex]),this.setInputValue("time"),+this.previousDateTime!=+this.value&&(this.changedArgs.value=this.value,this.addTimeSelection(),this.previousDateTime=this.value)):this.updateValue(e),this.hide(e),(0,a.cn)([this.inputWrapper.container],hl),this.isNavigate=!1,e.stopPropagation();break;case"escape":this.hide(e);break;default:this.isNavigate=!1;break}},t.prototype.inputKeyAction=function(e){switch(e.action){case"altDownArrow":this.strictModeUpdate(),this.updateInput(),this.toggle(e);break}},t.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++){var s=n[r];switch(s){case"value":this.isDynamicValueChanged=!0,this.invalidValueString=null,this.checkInvalidValue(e.value),e.value=this.value,e.value=this.validateValue(e.value),Ue.setValue(this.getFormattedValue(e.value),this.inputElement,this.floatLabelType,this.showClearButton),this.valueWithMinutes=e.value,this.setProperties({value:e.value},!0),this.popupObj&&this.popupUpdate(),this.previousDateTime=new Date(this.inputElement.value),this.updateInput(),this.changeTrigger(null),this.preventChange=this.isAngular&&this.preventChange?!this.preventChange:this.preventChange,this.enableMask&&this.value&&this.notify("createMask",{module:"MaskedDateTime"});break;case"min":case"max":this.getProperty(e,s),this.updateInput();break;case"enableRtl":Ue.setEnableRtl(this.enableRtl,[this.inputWrapper.container]);break;case"cssClass":(0,a.le)(i.cssClass)||(i.cssClass=i.cssClass.replace(/\s+/g," ").trim()),(0,a.le)(e.cssClass)||(e.cssClass=e.cssClass.replace(/\s+/g," ").trim()),Ue.setCssClass(e.cssClass,[this.inputWrapper.container],i.cssClass),this.dateTimeWrapper&&Ue.setCssClass(e.cssClass,[this.dateTimeWrapper],i.cssClass);break;case"locale":this.globalize=new a.eC(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),Ue.setPlaceholder(this.l10n.getConstant("placeholder"),this.inputElement),this.dateTimeFormat=this.cldrDateTimeFormat(),o.prototype.updateInput.call(this);break;case"htmlAttributes":this.updateHtmlAttributeToElement(),this.updateHtmlAttributeToWrapper(),this.checkAttributes(!0);break;case"format":this.setProperties({format:e.format},!0),this.checkFormat(),this.dateTimeFormat=this.formatString,this.setValue(),this.enableMask&&(this.notify("createMask",{module:"MaskedDateTime"}),this.value||Ue.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton));break;case"placeholder":Ue.setPlaceholder(e.placeholder,this.inputElement),this.inputElement.setAttribute("aria-placeholder",e.placeholder);break;case"enabled":Ue.setEnabled(this.enabled,this.inputElement),this.enabled||(this.inputElement.tabIndex=-1);break;case"strictMode":this.invalidValueString=null,this.updateInput();break;case"width":this.setWidth(e.width);break;case"readonly":Ue.setReadonly(this.readonly,this.inputElement);break;case"floatLabelType":this.floatLabelType=e.floatLabelType,Ue.removeFloating(this.inputWrapper),Ue.addFloating(this.inputElement,this.floatLabelType,this.placeholder);break;case"scrollTo":this.checkDateValue(new Date(this.checkValue(e.scrollTo)))?(this.dateTimeWrapper&&this.setScrollTo(),this.setProperties({scrollTo:this.checkDateValue(new Date(this.checkValue(e.scrollTo)))},!0)):this.setProperties({scrollTo:null},!0);break;case"enableMask":this.enableMask?(this.notify("createMask",{module:"MaskedDateTime"}),Ue.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton)):this.inputElement.value===this.maskedDateValue&&(this.maskedDateValue="",Ue.setValue(this.maskedDateValue,this.inputElement,this.floatLabelType,this.showClearButton));break;default:o.prototype.onPropertyChanged.call(this,e,i);break}this.isDynamicValueChanged||this.hide(null),this.isDynamicValueChanged=!1}},t.prototype.getModuleName=function(){return"datetimepicker"},t.prototype.restoreValue=function(){this.previousDateTime=this.previousDate,this.currentDate=this.value?this.value:new Date,this.valueWithMinutes=this.value,this.previousDate=this.value,this.previousElementValue=this.previousElementValue=(0,a.le)(this.inputValueCopy)?"":this.getFormattedValue(this.inputValueCopy)},ri([(0,a.Z9)(null)],t.prototype,"timeFormat",void 0),ri([(0,a.Z9)(30)],t.prototype,"step",void 0),ri([(0,a.Z9)(null)],t.prototype,"scrollTo",void 0),ri([(0,a.Z9)(1e3)],t.prototype,"zIndex",void 0),ri([(0,a.Z9)(null)],t.prototype,"value",void 0),ri([(0,a.Z9)(null)],t.prototype,"keyConfigs",void 0),ri([(0,a.Z9)({})],t.prototype,"htmlAttributes",void 0),ri([(0,a.Z9)(!1)],t.prototype,"enablePersistence",void 0),ri([(0,a.Z9)(!0)],t.prototype,"allowEdit",void 0),ri([(0,a.Z9)(!1)],t.prototype,"isMultiSelection",void 0),ri([(0,a.Z9)(null)],t.prototype,"values",void 0),ri([(0,a.Z9)(!0)],t.prototype,"showClearButton",void 0),ri([(0,a.Z9)(null)],t.prototype,"placeholder",void 0),ri([(0,a.Z9)(!1)],t.prototype,"strictMode",void 0),ri([(0,a.Z9)(null)],t.prototype,"serverTimezoneOffset",void 0),ri([(0,a.Z9)(new Date(1900,0,1))],t.prototype,"min",void 0),ri([(0,a.Z9)(new Date(2099,11,31))],t.prototype,"max",void 0),ri([(0,a.Z9)(null)],t.prototype,"firstDayOfWeek",void 0),ri([(0,a.Z9)("Gregorian")],t.prototype,"calendarMode",void 0),ri([(0,a.Z9)("Month")],t.prototype,"start",void 0),ri([(0,a.Z9)("Month")],t.prototype,"depth",void 0),ri([(0,a.Z9)(!1)],t.prototype,"weekNumber",void 0),ri([(0,a.Z9)(!0)],t.prototype,"showTodayButton",void 0),ri([(0,a.Z9)("Short")],t.prototype,"dayHeaderFormat",void 0),ri([(0,a.Z9)(!1)],t.prototype,"openOnFocus",void 0),ri([(0,a.Z9)(!1)],t.prototype,"enableMask",void 0),ri([(0,a.Z9)({day:"day",month:"month",year:"year",hour:"hour",minute:"minute",second:"second",dayOfTheWeek:"day of the week"})],t.prototype,"maskPlaceholder",void 0),ri([(0,a.ju)()],t.prototype,"open",void 0),ri([(0,a.ju)()],t.prototype,"close",void 0),ri([(0,a.ju)()],t.prototype,"cleared",void 0),ri([(0,a.ju)()],t.prototype,"blur",void 0),ri([(0,a.ju)()],t.prototype,"focus",void 0),ri([(0,a.ju)()],t.prototype,"created",void 0),ri([(0,a.ju)()],t.prototype,"destroyed",void 0),t=ri([a.Zl],t),t}(Vm),ww=function(){function o(t){this.intl=new a.eC,(0,a.le)(t)||(this.intl.culture=t)}return o.prototype.getFormatFunction=function(t){return t.type?this.intl.getDateFormat(t):this.intl.getNumberFormat(t)},o.prototype.getParserFunction=function(t){return t.type?this.intl.getDateParser(t):this.intl.getNumberParser(t)},o.prototype.fromView=function(t,e,i){return(i==="date"||i==="datetime"||i==="number")&&!(0,a.le)(e)?e(t):t},o.prototype.toView=function(t,e){var i=t;return!(0,a.le)(e)&&!(0,a.le)(t)&&(i=e(t)),i},o.prototype.setCulture=function(t){(0,a.le)(t)||(0,a.VY)(t)},o}(),ng=function(){function o(t){this.existingPredicate={},this.foreignKeyQuery=new yt.A,this.filterState=!0,this.values={},this.renderEmpty=!1,this.isCheckboxFilterTemplate=!1,this.parent=t,this.id=this.parent.element.id,this.valueFormatter=new ww(this.parent.locale),this.cBoxTrue=os(this.parent.createElement,!1,{checked:!0,label:" "}),this.cBoxFalse=os(this.parent.createElement,!1,{checked:!1,label:" "}),this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild),this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild),this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck"),this.parent.enableRtl&&(0,a.cn)([this.cBoxTrue,this.cBoxFalse],["e-rtl"])}return o.prototype.destroy=function(){this.closeDialog()},o.prototype.wireEvents=function(){a.bi.add(this.dlg,"click",this.clickHandler,this),a.bi.add(this.dlg,"keyup",this.keyupHandler,this),this.searchHandler=(0,a.Ds)(this.searchBoxKeyUp,200);var t=this.dialogObj.element.querySelector(".e-searchinput");t&&a.bi.add(t,"keyup",this.searchHandler,this)},o.prototype.unWireEvents=function(){a.bi.remove(this.dlg,"click",this.clickHandler),a.bi.remove(this.dlg,"keyup",this.keyupHandler);var t=this.dialogObj.element.querySelector(".e-searchinput");t&&a.bi.remove(t,"keyup",this.searchHandler)},o.prototype.foreignKeyFilter=function(t,e,i){var r=this,n={},s=[],l=this.foreignKeyQuery.clone();this.options.column.dataSource.executeQuery(l.where(i)).then(function(h){r.options.column.columnData=h.result,r.parent.notify(ed,{predicate:n,column:r.options.column}),t.ejpredicate=n.predicate.predicates;for(var c=n.predicate.predicates,u=0;u<c.length;u++)s.push({field:c[u].field,predicate:"or",matchCase:c[u].ignoreCase,ignoreAccent:c[u].ignoreAccent,operator:c[u].operator,value:c[u].value,type:r.options.type});t.filterCollection=s.length?s:e.filter(function(p){return p.field=r.options.field}),r.options.handler(t)})},o.prototype.foreignFilter=function(t,e){var i=this.options.isRemote?this.options.column.type==="string"?"contains":"equal":this.options.column.type?"contains":"equal",r=new yt.$(this.options.column.foreignKeyValue,i,e,!0,this.options.ignoreAccent);this.foreignKeyFilter(t,[t.filterCollection],r)},o.prototype.searchBoxClick=function(t){var e=t.target;e.classList.contains("e-searchclear")&&(this.sInput.value="",this.isCheckboxFilterTemplate?this.parent.notify("refreshCheckbox",{event:t}):this.refreshCheckboxes(),this.updateSearchIcon(),this.sInput.focus())},o.prototype.searchBoxKeyUp=function(t){this.isCheckboxFilterTemplate?this.parent.notify("refreshCheckbox",{event:t}):this.refreshCheckboxes(),this.updateSearchIcon()},o.prototype.updateSearchIcon=function(){this.sInput.value.length?(0,a.s1)(this.sIcon,["e-chkcancel-icon"],["e-search-icon"]):(0,a.s1)(this.sIcon,["e-search-icon"],["e-chkcancel-icon"])},o.prototype.getLocalizedLabel=function(t){return this.localeObj.getConstant(t)},o.prototype.updateDataSource=function(){var t=this.options.dataSource,e="object";if(!(t instanceof Oe.h)){for(var i=0;i<t.length;i++)if(typeof t!==e){var r={};r[this.options.field]=t[i],t[i]=r}}},o.prototype.updateModel=function(t){this.options=t,this.existingPredicate=t.actualPredicate||{},this.options.dataSource=t.dataSource,this.options.dataManager=t.dataManager?t.dataManager:t.dataSource,this.updateDataSource(),this.options.type=t.type,this.options.format=t.format||"",this.options.ignoreAccent=t.ignoreAccent||!1,this.options.filteredColumns=t.filteredColumns||this.parent.filterSettings.columns,this.options.query=t.query||new yt.A,this.options.allowCaseSensitive=t.allowCaseSensitive||!1,this.options.uid=t.column.uid,this.values={},this.localeObj=t.localeObj,this.isFiltered=t.filteredColumns.length},o.prototype.getAndSetChkElem=function(t){if(this.dlg=this.parent.createElement("div",{id:this.id+this.options.type+"_excelDlg",attrs:{uid:this.options.column.uid},className:"e-checkboxfilter e-filter-popup"}),this.sBox=this.parent.createElement("div",{className:"e-searchcontainer"}),!t.hideSearchbox){this.sInput=this.parent.createElement("input",{id:this.id+"_SearchBox",className:"e-searchinput"}),this.sIcon=this.parent.createElement("span",{className:"e-searchclear e-search-icon e-icons e-input-group-icon",attrs:{type:"text",title:this.getLocalizedLabel("Search")}}),this.searchBox=this.parent.createElement("span",{className:"e-searchbox e-fields"}),this.searchBox.appendChild(this.sInput),this.sBox.appendChild(this.searchBox);var e={element:this.sInput,floatLabelType:"Never",properties:{placeholder:this.getLocalizedLabel("Search")}};Ue.createInput(e,this.parent.createElement),this.searchBox.querySelector(".e-input-group").appendChild(this.sIcon)}return this.spinner=this.parent.createElement("div",{className:"e-spinner"}),this.cBox=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxList",className:"e-checkboxlist e-fields"}),this.spinner.appendChild(this.cBox),this.sBox.appendChild(this.spinner),this.sBox},o.prototype.showDialog=function(t){var e={requestType:UC,columnName:this.options.field,columnType:this.options.type,cancel:!1},i="filterModel";if(e[i]=this,this.parent.notify(KC,e),e.cancel){t.cancel=e.cancel;return}this.dialogObj=new sl({visible:!1,content:this.sBox,close:this.closeDialog.bind(this),enableRtl:this.parent.enableRtl,width:!(0,a.le)(rn(t.target,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:255,target:this.parent.element,animationSettings:{effect:"None"},buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton"),cssClass:this.parent.cssClass?"e-primary "+this.parent.cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",content:this.getLocalizedLabel(this.isExcel?"CancelButton":"ClearButton")}}],created:this.dialogCreated.bind(this),open:this.dialogOpen.bind(this),cssClass:this.parent.cssClass?this.parent.cssClass:""});var r="isStringTemplate";if(this.dialogObj[r]=!0,this.renderResponsiveFilter(t),this.dlg.setAttribute("aria-label",this.getLocalizedLabel("ExcelFilterDialogARIA")),t.isResponsiveFilter){var n=document.querySelector(".e-responsive-dialog > .e-dlg-content > .e-mainfilterdiv");n.appendChild(this.dlg)}else this.parent.element.appendChild(this.dlg);this.dialogObj.appendTo(this.dlg),this.dialogObj.element.style.maxHeight=t.isResponsiveFilter?"none":this.options.height+"px",this.dialogObj.show();var s=this.dialogObj.element.querySelector(".e-dlg-content");s.appendChild(this.sBox),this.wireEvents(),Ha({target:this.spinner},this.parent.createElement),jn(this.spinner),this.getAllData()},o.prototype.renderResponsiveFilter=function(t){t.isResponsiveFilter&&(this.dialogObj.buttons=[{}],this.dialogObj.position={X:"",Y:""},this.dialogObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-mainfilterdiv"),this.dialogObj.width="100%")},o.prototype.dialogCreated=function(t){this.options.isResponsiveFilter?this.dialogObj.element.style.left="0px":a.AR.isDevice?this.dialogObj.position={X:"center",Y:"center"}:uS(this.options.target,this.dialogObj),this.options.column.showColumnMenu&&this.parent.notify(Zh,t)},o.prototype.openDialog=function(t){this.updateModel(t),this.getAndSetChkElem(t),this.showDialog(t)},o.prototype.closeDialog=function(){if(this.dialogObj&&!this.dialogObj.isDestroyed){this.isBlanks=!1;var t=this.options.columns.filter(function(i){return i.getFilterItemTemplate()}),e=this.parent.registeredTemplate;t.length&&!(0,a.le)(e)&&e.filterItemTemplate&&this.parent.destroyTemplate(["filterItemTemplate"]),(this.parent.isReact||this.parent.isVue)&&this.parent.destroyTemplate!==void 0&&Am(this.parent,["filterItemTemplate"]),this.parent.notify(ZC,{field:this.options.field}),this.dialogObj.destroy(),this.unWireEvents(),(0,a.Od)(this.dlg),this.dlg=null,this.parent.notify(oa,{})}},o.prototype.clearFilter=function(t){var e={instance:this,handler:this.clearFilter,cancel:!1};this.parent.notify(td,e),!e.cancel&&this.options.handler({action:"clear-filter",field:t?t.field:this.options.field})},o.prototype.btnClick=function(t){if(this.filterState){if(t.target.tagName.toLowerCase()==="input"&&t.target.classList.contains("e-searchinput")||t.keyCode===13)this.isCheckboxFilterTemplate||this.fltrBtnHandler();else{var e=t.target.firstChild.textContent.toLowerCase();this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton").toLowerCase()===e?this.isCheckboxFilterTemplate||this.fltrBtnHandler():this.getLocalizedLabel("ClearButton").toLowerCase()===e&&this.clearFilter()}this.closeDialog()}else t.target.tagName.toLowerCase()!=="input"&&(this.clearFilter(),this.closeDialog());this.options.column.showColumnMenu&&this.parent.notify(eS,{})},o.prototype.fltrBtnHandler=function(){var t=this,e=[].slice.call(this.cBox.querySelectorAll(".e-check:not(.e-selectall)")),i=e,r="equal",n=this.dialogObj.element.querySelector(".e-dropdownlist");n&&(this.options.operator=r=n.ej2_instances[0].value),this.isMenuNotEqual=this.options.operator==="notequal";var s;this.options.hideSearchbox||(s=this.searchBox.querySelector(".e-searchinput"));var l=this.options.allowCaseSensitive,h={field:this.options.field,predicate:this.isMenuNotEqual?"and":"or",uid:this.options.uid,operator:r,type:this.options.type,matchCase:l,ignoreAccent:this.options.ignoreAccent},c=this.itemsCnt!==e.length&&this.itemsCnt-e.length<e.length;c&&s&&s.value===""&&(r=this.isMenuNotEqual?"equal":"notequal",e=[].slice.call(this.cBox.querySelectorAll(".e-uncheck:not(.e-selectall)")),h.predicate=this.isMenuNotEqual?"or":"and",h.operator=r);var u,p,f,g,C=[];if(e.length!==this.itemsCnt||s&&s.value&&s.value!==""){for(var L=0;L<e.length;L++){u=this.values[rn(e[L],"e-ftrchk").getAttribute("uid")],g=(0,a.l7)({},{value:u},h),u&&!u.toString().length&&(g.operator=c?"notequal":"equal"),u===""||(0,a.le)(u)?C=C.concat(o.generateNullValuePredicates(h)):C.push(g);var D={instance:this,handler:this.fltrBtnHandler,arg1:g.field,arg2:g.predicate,arg3:g.operator,arg4:g.matchCase,arg5:g.ignoreAccent,arg6:g.value,cancel:!1};if(this.parent.notify(td,D),D.cancel)return}(this.options.type==="date"||this.options.type==="datetime")&&(f=i.length-1,p=this.values[rn(i[f],"e-ftrchk").getAttribute("uid")],(0,a.le)(p)&&c&&C.push({field:h.field,matchCase:h.matchCase,operator:"equal",predicate:"and",value:null})),this.initiateFilter(C)}else{var R=this.options.filteredColumns.some(function(B){return t.options.field===B.field});R&&this.clearFilter()}},o.generateNullValuePredicates=function(t){var e=[];return t.type==="string"&&e.push({field:t.field,ignoreAccent:t.ignoreAccent,matchCase:t.matchCase,operator:t.operator,predicate:t.predicate,value:""}),e.push({field:t.field,matchCase:t.matchCase,operator:t.operator,predicate:t.predicate,value:null}),e.push({field:t.field,matchCase:t.matchCase,operator:t.operator,predicate:t.predicate,value:void 0}),e},o.prototype.initiateFilter=function(t){var e=t[0],i;if(!(0,a.le)(e)){i=e.ejpredicate?e.ejpredicate:new yt.$(e.field,e.operator,e.value,!e.matchCase,e.ignoreAccent);for(var r=1;r<t.length;r++)i=t[r].ejpredicate!==void 0?i[t[r].predicate](t[r].ejpredicate):i[t[r].predicate](t[r].field,t[r].operator,t[r].value,!t[r].matchCase,t[r].ignoreAccent);var n={action:"filtering",filterCollection:t,field:this.options.field,ejpredicate:yt.$.or(i)};this.options.handler(n)}},o.prototype.isForeignColumn=function(t){return t.isForeignColumn?t.isForeignColumn():!1},o.prototype.refreshCheckboxes=function(){var t=this,e=this.sInput.value,i=this.options.column,r=this.isForeignColumn(i)?this.foreignKeyQuery.clone():this.options.query.clone(),n=this.options.query.clone(),s=r.queries.filter(function(H){return H&&H.fn==="onWhere"})[0];r.queries=[],n.queries=[];var l=this.options.type!=="string"&&parseFloat(e)?parseFloat(e):e,h=this.options.isRemote?this.options.type==="string"?"contains":"equal":this.options.type?"contains":"equal",c=!0,u=this.options.ignoreAccent,p=this.isForeignColumn(i)?i.foreignKeyValue:i.field;l=l===""||l===void 0?void 0:l;var f=[],g={field:p,predicate:"or",uid:this.options.uid,operator:"equal",type:this.options.type,matchCase:c,ignoreAccent:u},C,L=this.options.dataManager.adaptor.getModuleName;if(this.options.type==="boolean"&&(l!==void 0&&this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(l.toLowerCase())!==-1?l="true":l!==void 0&&this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(l.toLowerCase())!==-1&&(l="false"),l!==void 0&&this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(l.toLowerCase())!==-1&&L?l=(L(),!0):l!==void 0&&this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(l.toLowerCase())!==-1&&L&&(l=(L(),!1)),h="equal"),(this.options.type==="date"||this.options.type==="datetime")&&this.options.format){var D=new a.eC,R=typeof this.options.format=="string"?this.options.format:this.options.format.format;R?l=D.parseDate(e,{format:R})||new Date(e):l=new Date(e)}this.addDistinct(r);var B={requestType:qC,filterModel:this,columnName:p,column:i,operator:h,matchCase:c,ignoreAccent:u,filterChoiceCount:null,query:r,value:l};this.parent.trigger(sm,B,function(H){if(H.operator=H.operator,C=new yt.$(p,H.operator,l,H.matchCase,H.ignoreAccent),t.options.type==="date"||t.options.type==="datetime"){h="equal";var j={field:p,operator:h,value:l,matchCase:c,ignoreAccent:u};(0,a.le)(l)||(C=Qa(j,t.options.type))}if(e&&typeof e=="string"&&t.isBlanks&&t.getLocalizedLabel("Blanks").toLowerCase().indexOf(e.toLowerCase())>=0){f=f.concat(o.generateNullValuePredicates(g));var W=o.generatePredicate(f);W.predicates.push(C),r.where(W)}else e.length?(C=(0,a.le)(s)?C:C.and(s.e),r.where(C)):(0,a.le)(s)||r.where(s.e);H.filterChoiceCount=(0,a.le)(H.filterChoiceCount)?1e3:H.filterChoiceCount;var ne={};if(jn(t.spinner),t.renderEmpty=!1,t.isForeignColumn(i)&&e.length){var ie="result"in i.dataSource?new Oe.h(i.dataSource.result):i.dataSource;ie.executeQuery(r).then(function(me){var ve=t.options.column.columnData;t.options.column.columnData=me.result,t.parent.notify(ed,{predicate:ne,column:i}),ne.predicate.predicates.length?n.where(ne.predicate):t.renderEmpty=!0,t.options.column.columnData=ve,n.take(H.filterChoiceCount),t.search(H,n)})}else r.take(H.filterChoiceCount),t.search(H,r)})},o.prototype.search=function(t,e){this.parent.dataSource&&"result"in this.parent.dataSource?this.filterEvent(t,e):this.processSearch(e)},o.prototype.getPredicateFromCols=function(t){for(var e=o.getPredicate(t),i=[],r={},n=this.parent.getForeignKeyColumns!==void 0,s=n?this.parent.getForeignKeyColumns():[],l=0,h=Object.keys(e);l<h.length;l++){var c=h[l],u=void 0;n&&!this.parent.getColumnByField(c)&&(u=vm(c,s)),u?(this.parent.notify(ed,{predicate:r,column:u}),r.predicate.predicates.length&&i.push(yt.$.or(r.predicate.predicates))):i.push(e[c])}return i.length&&yt.$.and(i)},o.prototype.getQuery=function(){return this.parent.getQuery?this.parent.getQuery().clone():new yt.A},o.prototype.getAllData=function(){var t=this;this.customQuery=!1;var e=this.getQuery();e.requiresCount(),this.addDistinct(e);var i={requestType:am,query:e,filterChoiceCount:null},r="filterModel";i[r]=this,this.parent.trigger(sm,i,function(n){n.filterChoiceCount=(0,a.le)(n.filterChoiceCount)?1e3:n.filterChoiceCount,e.take(n.filterChoiceCount),n.query.distincts.length||(t.customQuery=!0,t.queryGenerate(e)),t.parent.dataSource&&"result"in t.parent.dataSource?t.filterEvent(n,e):t.processDataOperation(e,!0)})},o.prototype.addDistinct=function(t){var e=vn.j.distinct(this.options.filteredColumns,"field");return e.indexOf(this.options.column.field)<=-1&&(e=e.concat(this.options.column.field)),t.distinct(e),t},o.prototype.filterEvent=function(t,e){var i=this,r=Sm(t,e);this.parent.trigger(om,r.state);var n=r.deffered;n.promise.then(function(s){i.dataSuccess(s)})},o.prototype.processDataOperation=function(t,e){var i=this;this.options.dataSource=this.options.dataSource instanceof Oe.h?this.options.dataSource:new Oe.h(this.options.dataSource);var r=[],n=[];if(this.isForeignColumn(this.options.column)&&e){var s="result"in this.options.column.dataSource?new Oe.h(this.options.column.dataSource.result):this.options.column.dataSource;this.foreignKeyQuery.params=t.params,r.push(s.executeQuery(this.foreignKeyQuery)),n.push(function(h){return i.foreignKeyData=h})}r.push(this.options.dataSource.executeQuery(t)),n.push(this.dataSuccess.bind(this));var l=0;Promise.all(r).then(function(h){for(var c=0;c<h.length;c++)n[l++](h[c].result)})},o.prototype.dataSuccess=function(t){this.fullData=t;var e={dataSource:this.fullData,executeQuery:!0,field:this.options.field};if(this.parent.notify(XC,e),e.executeQuery){var i=new yt.A;this.customQuery||this.queryGenerate(i);var r=new Oe.h(e.dataSource).executeLocal(i),n=this.options.column;this.filteredData=o.getDistinct(r,this.options.field,n,this.foreignKeyData).records||[]}var s=e.executeQuery?this.filteredData:e.dataSource;this.processDataSource(null,!0,s,e),this.sInput&&this.sInput.focus();var l={requestType:WC,columnName:this.options.field,columnType:this.options.type},h="filterModel";l[h]=this,this.parent.notify(lm,l),this.isCheckboxFilterTemplate&&Cs(this.spinner)},o.prototype.queryGenerate=function(t){if(this.parent.searchSettings&&this.parent.searchSettings.key.length){var e=this.parent.searchSettings,i=e.fields.length?e.fields:this.options.columns.map(function(h){return h.field});t.search(e.key,i,e.operator,e.ignoreCase,e.ignoreAccent)}if(this.options.filteredColumns.length){for(var r=[],n=0;n<this.options.filteredColumns.length;n++){var s=this.options.filteredColumns[n];this.options.uid?(s.uid=s.uid||this.parent.getColumnByField(s.field).uid,s.uid!==this.options.uid&&r.push(this.options.filteredColumns[n])):s.field!==this.options.field&&r.push(this.options.filteredColumns[n])}var l=this.getPredicateFromCols(r);l&&t.where(l)}},o.prototype.processDataSource=function(t,e,i,r){jn(this.spinner),this.updateResult();var n={dataSource:this.fullData,isCheckboxFilterTemplate:!1,column:this.options.column,element:this.cBox,type:this.options.type,format:this.options.type,btnObj:this.options.isResponsiveFilter?null:this.dialogObj.btnObj[0],searchBox:this.searchBox};this.parent.notify(tS,n),this.isCheckboxFilterTemplate=n.isCheckboxFilterTemplate,this.isCheckboxFilterTemplate||this.createFilterItems(i,e,r)},o.prototype.processSearch=function(t){this.processDataOperation(t)},o.prototype.updateResult=function(){this.result={};var t=this.getPredicateFromCols(this.options.filteredColumns),e=new yt.A;t&&e.where(t),this.parent.notify(JC,{query:e});for(var i=new Oe.h(this.fullData).executeLocal(e),r=0,n=i;r<n.length;r++){var s=n[r];this.result[mm(this.options.field,s)]=!0}},o.prototype.clickHandler=function(t){var e=t.target,i=rn(e,"e-checkbox-wrapper");if(rn(e,"e-searchbox")&&this.searchBoxClick(t),i&&!this.isCheckboxFilterTemplate){var r=i.querySelector(".e-selectall");r?this.updateAllCBoxes(!r.classList.contains("e-check")):pS(i.parentElement),this.updateIndeterminatenBtn(),i.querySelector(".e-chk-hidden").focus()}this.setFocus(rn(i,"e-ftrchk"))},o.prototype.keyupHandler=function(t){this.setFocus(rn(t.target,"e-ftrchk"))},o.prototype.setFocus=function(t){var e=this.dlg.querySelector(".e-chkfocus");e&&e.classList.remove("e-chkfocus"),t&&t.classList.add("e-chkfocus")},o.prototype.updateAllCBoxes=function(t){for(var e=[].slice.call(this.cBox.getElementsByClassName("e-frame")),i=0,r=e;i<r.length;i++){var n=r[i];dS(n,t),Kh(n.previousSibling,t)}},o.prototype.dialogOpen=function(){this.parent.element.classList.contains("e-device")&&(this.dialogObj.element.querySelector(".e-input-group").classList.remove("e-input-focus"),this.options.isResponsiveFilter||this.dialogObj.element.querySelector(".e-btn").focus())},o.prototype.createCheckbox=function(t,e,i){var r=e?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);Kh(r.querySelector("input"),e);var n=r.querySelector(".e-label"),s=mS({},i,{column:this.options.column,parent:this.parent});if(n.innerHTML=!(0,a.le)(t)&&t.toString().length?t:this.getLocalizedLabel("Blanks"),n.innerHTML===this.getLocalizedLabel("Blanks")&&(this.isBlanks=!0),typeof t=="boolean"&&(n.innerHTML=t===!0?this.getLocalizedLabel("FilterTrue"):this.getLocalizedLabel("FilterFalse")),(0,a.cn)([n],["e-checkboxfiltertext"]),this.options.template&&i[this.options.column.field]!==this.getLocalizedLabel("SelectAll")){n.innerHTML="";var l=this.parent.isReact&&this.options.column.filter&&typeof this.options.column.filter.itemTemplate!="string";l?(this.options.template(s,this.parent,"filterItemTemplate",null,null,null,n),this.parent.renderTemplates()):Gh(n,this.options.template(s,this.parent,"filterItemTemplate"))}return r},o.prototype.updateIndeterminatenBtn=function(){var t=this.cBox.children.length-1,e=[],i=!1,r=this.cBox.querySelector(".e-selectall"),n=this.cBox.querySelectorAll(".e-check:not(.e-selectall)").length,s;this.options.isResponsiveFilter||(s=this.dialogObj.btnObj[0],s.disabled=!1);var l=r.previousSibling;Kh(l,!1),l.indeterminate=!1,t===n?(e=["e-check"],Kh(l,!0)):n?(e=["e-stop"],l.indeterminate=!0):(e=["e-uncheck"],i=!0,s&&(s.disabled=!0)),s&&(this.filterState=!s.disabled,s.dataBind()),(0,a.IV)([r],["e-check","e-stop","e-uncheck"]),(0,a.cn)([r],e),this.parent.notify(hm,{disabled:i})},o.prototype.createFilterItems=function(t,e,i){var r,n=this.parent.createElement("div"),s,l=!1;this.options.isResponsiveFilter||(s=this.dialogObj.btnObj[0]);var h=-1,c="ejValue";i.executeQuery||(c=i.field);for(var u=0;u<t.length;u++){var p=(0,a.NA)(c,t[u]);(p===""||(0,a.le)(p))&&(h=h+1)}if(this.itemsCnt=h!==-1?t.length-h:t.length,t.length&&!this.renderEmpty){var f=this.getLocalizedLabel("SelectAll"),g=this.cBox.querySelector(".e-checkfltrnmdiv");g&&g.classList.remove("e-checkfltrnmdiv");var C=this.createCheckbox(f,!1,(r={},r[this.options.field]=f,r)),L=od(sd("cbox"),C,"e-ftrchk");L.querySelector(".e-frame").classList.add("e-selectall"),n.appendChild(L);var D=new yt.$("field","equal",this.options.field);this.options.foreignKeyValue&&(D=D.or("field","equal",this.options.foreignKeyValue));for(var R=new Oe.h(this.options.filteredColumns).executeLocal(new yt.A().where(D)).length,B=void 0,u=0;u<t.length;u++){var H=sd("cbox");this.values[H]=(0,a.NA)(c,t[u]);var j=(0,a.NA)(this.options.field,t[u]);this.options.formatFn&&(j=this.valueFormatter.toView(j,this.options.formatFn));var W={value:j,column:this.options.column,data:t[u]};if(this.parent.notify(rd,W),j=W.value,j===""||(0,a.le)(j)){if(B)continue;B=!0}var ne=this.createCheckbox(j,this.getCheckedState(R,this.values[H]),(0,a.NA)("dataObj",t[u]));n.appendChild(od(H,ne,"e-ftrchk"))}this.cBox.innerHTML="",Gh(this.cBox,[].slice.call(n.children)),this.updateIndeterminatenBtn(),s&&(s.disabled=!1),l=!1}else n.appendChild(this.parent.createElement("span",{innerHTML:this.getLocalizedLabel("NoResult")})),this.cBox.innerHTML="",this.cBox.appendChild(this.parent.createElement("div",{className:"e-checkfltrnmdiv"})),Gh(this.cBox.children[0],[].slice.call(n.children)),s&&(s.disabled=!0),l=!0;s&&(this.filterState=!s.disabled,s.dataBind());var ie={requestType:am,dataSource:this.renderEmpty?[]:t},me="filterModel";ie[me]=this,this.parent.notify(lm,ie),this.parent.notify(hm,{disabled:l}),Cs(this.spinner)},o.prototype.getCheckedState=function(t,e){if(!this.isFiltered||!t)return!0;var i=this.result[e];return this.options.operator==="notequal"?!i:i},o.getDistinct=function(t,e,i,r){for(var n=t.length,s=[],l,h="ejValue",c={},u=i&&i.isForeignColumn?i.isForeignColumn():!1;n--;)if(l=t[n],l=mm(e,l),!(l in c)){var p={};if(p[h]=l,c[l]=!0,u){var f=fm(i,{},l,r)[0];(0,a.sO)(YC,f,t[n]),l=(0,a.NA)(i.foreignKeyValue,f)}(0,a.sO)(e,(0,a.le)(l)?null:l,p),(0,a.sO)("dataObj",t[n],p),s.push(p)}return vn.j.group(vn.j.sort(s,e,vn.j.fnAscending),"ejValue")},o.getPredicate=function(t){for(var e=vn.j.distinct(t,"field",!0)||[],i=[],r={},n=0;n<e.length;n++)i=new Oe.h(t).executeLocal(new yt.A().where("field","equal",e[n].field)),i.length!==0&&(r[e[n].field]=o.generatePredicate(i));return r},o.generatePredicate=function(t){var e=t?t.length:0,i,r="or",n=o.updateDateFilter(t[0]);n.ignoreAccent=(0,a.le)(n.ignoreAccent)?!1:n.ignoreAccent,n.type==="date"||n.type==="datetime"?i=Qa(n,n.type):i=n.ejpredicate?n.ejpredicate:new yt.$(n.field,n.operator,n.value,!o.getCaseValue(n),n.ignoreAccent);for(var s=1;s<e;s++)t[s]=o.updateDateFilter(t[s]),e>2&&s>1&&t[s].predicate==="or"?t[s].type==="date"||t[s].type==="datetime"?i.predicates.push(Qa(t[s],t[s].type)):i.predicates.push(new yt.$(t[s].field,t[s].operator,t[s].value,!o.getCaseValue(t[s]),t[s].ignoreAccent)):t[s].type==="date"||t[s].type==="datetime"?t[s].predicate==="and"&&t[s].operator==="equal"?i=i[r](Qa(t[s],t[s].type),t[s].type,t[s].ignoreAccent):i=i[t[s].predicate](Qa(t[s],t[s].type),t[s].type,t[s].ignoreAccent):i=t[s].ejpredicate?i[t[s].predicate](t[s].ejpredicate):i[t[s].predicate](t[s].field,t[s].operator,t[s].value,!o.getCaseValue(t[s]),t[s].ignoreAccent);return i||null},o.getCaseValue=function(t){return(0,a.le)(t.matchCase)?!(t.type==="string"||(0,a.le)(t.type)&&typeof t.value=="string"):t.matchCase},o.updateDateFilter=function(t){return(t.type==="date"||t.type==="datetime"||t.value instanceof Date)&&(t.type=t.type||"date"),t},o}(),xO="e-rowcell",EO="e-gridheader",AO="e-gridcontent",TO="e-gridfooter",LO="e-headercontent",kO="e-movablecontent",IO="e-movableheader",DO="e-frozencontent",OO="e-frozenheader",RO="e-content",MO="e-table",PO="e-row",NO="e-gridchkbox",BO="e-editedrow",FO="e-addedrow",HO="changedRecords",VO="addedRecords",zO="deletedRecords",_O="Left-Right",jO="frozen-right",WO="frozen-left",UO="aria-colindex",qO="aria-rowindex",ZO="tbody",xw="colgroup",ic="open",rc="change",nc="focus",YO="created",GO="beforeOpen",KO="downArrow",XO="upArrow",$O="PageUp",QO="PageDown",JO="enter",eR="shiftEnter",tR="tab",iR="shiftTab",Ew=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Aw=function(o){Ew(t,o);function t(e,i){var r=o.call(this,e)||this;return r.childRefs=[],r.eventHandlers={},r.isDevice=!1,r.customFilterOperators=i,r.isExcel=!0,r}return t.prototype.getCMenuDS=function(e,i){var r={number:["Equal","NotEqual","","LessThan","LessThanOrEqual","GreaterThan","GreaterThanOrEqual","Between","","CustomFilter"],string:["Equal","NotEqual","","StartsWith","EndsWith","","Contains","","CustomFilter"]};r.date=r.number,r.datetime=r.number;for(var n=[],s=0;s<r[e].length;s++)r[e][s].length?i?n.push({text:this.getLocalizedLabel(r[e][s])+"...",iconCss:"e-icons e-icon-check "+(i===r[e][s].toLowerCase()?"":"e-emptyicon")}):n.push({text:this.getLocalizedLabel(r[e][s])+"..."}):n.push({separator:!0});return n},t.prototype.destroy=function(){if(this.dlg&&(this.unwireExEvents(),o.prototype.closeDialog.call(this)),!this.isDevice&&this.menuObj){var e=this.menuObj.element.querySelector("li.e-focused");e&&rn(e,"e-excel-menu")||this.destroyCMenu()}this.dlgObj&&!this.dlgObj.isDestroyed&&this.removeDialog()},t.prototype.createMenu=function(e,i,r,n){var s={string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"};this.menu=this.parent.createElement("div",{className:"e-contextmenu-wrapper"}),this.parent.enableRtl?this.menu.classList.add("e-rtl"):this.menu.classList.remove("e-rtl");var l=this.parent.createElement("ul"),h=i?"e-excl-filter-icon e-filtered":"e-excl-filter-icon";if(this.parent.allowSorting&&this.parent.getModuleName()==="grid"&&!this.options.isResponsiveFilter){var c=this.parent.getColumnHeaderByUid(n.uid).getAttribute("aria-sort"),u=this.parent.getColumnByField(n.field).allowSorting,p=!u||c==="ascending"?"e-disabled e-excel-ascending":"e-excel-ascending",f=!u||c==="descending"?"e-disabled e-excel-descending":"e-excel-descending",g=e==="string"?this.getLocalizedLabel("SortAtoZ"):e==="datetime"||e==="date"?this.getLocalizedLabel("SortByOldest"):this.getLocalizedLabel("SortSmallestToLargest"),C=e==="string"?this.getLocalizedLabel("SortZtoA"):e==="datetime"||e==="date"?this.getLocalizedLabel("SortByNewest"):this.getLocalizedLabel("SortLargestToSmallest");l.appendChild(this.createMenuElem(g,p,"e-sortascending")),l.appendChild(this.createMenuElem(C,f,"e-sortdescending"));var L=this.parent.createElement("li",{className:"e-separator e-menu-item e-excel-separator"});l.appendChild(L)}this.options.isResponsiveFilter||l.appendChild(this.createMenuElem(this.getLocalizedLabel("ClearFilter"),i?"":"e-disabled",h)),e!=="boolean"&&l.appendChild(this.createMenuElem(this.getLocalizedLabel(s[e]),"e-submenu",r&&this.ensureTextFilter()?"e-icon-check":h+" e-emptyicon",!0)),this.menu.appendChild(l),this.parent.notify(id,{element:this.menu}),this.parent.notify($C,{isFiltered:i})},t.prototype.createMenuElem=function(e,i,r,n){var s=this.parent.createElement("li",{className:i+" e-menu-item"});return s.innerHTML=e,s.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+r}),s.firstChild),n&&s.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),s},t.prototype.wireExEvents=function(){a.bi.add(this.dlg,"mouseover",this.hoverHandler,this),a.bi.add(this.dlg,"click",this.clickExHandler,this)},t.prototype.unwireExEvents=function(){a.bi.remove(this.dlg,"mouseover",this.hoverHandler),a.bi.remove(this.dlg,"click",this.clickExHandler)},t.prototype.clickExHandler=function(e){var i={string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"},r=rn(e.target,"e-menu-item");r&&(this.getLocalizedLabel("ClearFilter")===r.innerText.trim()?(this.clearFilter(),this.closeDialog()):this.options.isResponsiveFilter&&this.getLocalizedLabel(i[this.options.type])===r.innerText.trim()&&this.hoverHandler(e))},t.prototype.destroyCMenu=function(){this.isCMenuOpen=!1,this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),(0,a.Od)(this.cmenu),this.parent.notify(cm,{target:null,header:"",isOpen:!1,col:this.options.column}))},t.prototype.hoverHandler=function(e){if(!(this.options.isResponsiveFilter&&e.type==="mouseover")){var i=e.target.querySelector(".e-contextmenu"),r=rn(e.target,"e-menu-item"),n=this.menu.querySelector(".e-focused"),s;if(n&&n.classList.remove("e-focused"),r&&(r.classList.add("e-focused"),s=r.classList.contains("e-submenu")),!i){if(!s){var l=this.menu.querySelector(".e-submenu");(0,a.le)(l)||l.classList.remove("e-selected"),this.destroyCMenu()}var h=this.ensureTextFilter();if(!this.isCMenuOpen&&s){r.classList.add("e-selected"),this.isCMenuOpen=!0;var c={items:this.getCMenuDS(this.options.type,h?h.replace(/\s/g,""):void 0),select:this.selectHandler.bind(this),onClose:this.destroyCMenu.bind(this),enableRtl:this.parent.enableRtl,beforeClose:this.preventClose.bind(this),cssClass:this.options.isResponsiveFilter&&this.parent.cssClass?"e-res-contextmenu-wrapper "+this.parent.cssClass:this.options.isResponsiveFilter?"e-res-contextmenu-wrapper":this.parent.cssClass?this.parent.cssClass:""};this.parent.element.appendChild(this.cmenu),this.menuObj=new im(c,this.cmenu);var u=this.menu.querySelector(".e-submenu").getBoundingClientRect(),p={top:0,left:0};if(this.options.isResponsiveFilter){var f={string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"},g=document.querySelector(".e-responsive-dialog > .e-dlg-header-content"),C=g.offsetHeight+4;this.menuObj.element.style.height="calc(100% - "+C+"px)",this.menuObj.open(C,0,document.body);var L=this.getLocalizedLabel(f[this.options.type]);this.parent.notify(cm,{target:this.menuObj.element.parentElement,header:L,isOpen:!0})}else{if(a.AR.isDevice){this.isDevice=!0;var D=this.getContextBounds();p.top=(window.innerHeight-D.height)/2,p.left=(window.innerWidth-D.width)/2,this.closeDialog(),this.isDevice=!1}else p.top=a.AR.isIE?window.pageYOffset+u.top:window.scrollY+u.top,p.left=this.getCMenuYPosition(this.dlg);this.menuObj.open(p.top,p.left,e.target)}Cm(this.parent.element,this.menuObj.element.parentElement)}}}},t.prototype.ensureTextFilter=function(){var e,i=this.existingPredicate[this.options.field];return i&&i.length===2?i[0].operator==="greaterthanorequal"&&i[1].operator==="lessthanorequal"?e="between":e="customfilter":i&&i.length===1&&(this.optrData=this.customFilterOperators[this.options.type+"Operator"],e=i[0].operator),e},t.prototype.preventClose=function(e){if(this.options&&this.options.isResponsiveFilter&&e.event){var i=e.event.target,r=i.classList.contains("e-resfilterback")||i.classList.contains("e-res-back-btn")||i.classList.contains("e-menu-item");e.cancel=!r}else e.event instanceof MouseEvent&&e.event.target.classList.contains("e-submenu")&&(e.cancel=!0)},t.prototype.getContextBounds=function(){return this.menuObj.element.style.display="block",this.menuObj.element.getBoundingClientRect()},t.prototype.getCMenuYPosition=function(e){var i=this.getContextBounds().width,r=e.getBoundingClientRect(),n=r.right+i-this.parent.element.clientWidth,s=e.offsetWidth-e.clientWidth;return s=s?s+1:0,n<1?r.right+1-s:r.left-i-1+s},t.prototype.openDialog=function(e){var i=this;if(this.updateModel(e),this.getAndSetChkElem(e),this.showDialog(e),!e.cancel){this.dialogObj.dataBind();var r=this.existingPredicate[e.field]&&this.existingPredicate[e.field].length||this.options.filteredColumns.filter(function(n){return i.options.field===n.field}).length;this.createMenu(e.type,r>0,r===1||r===2,e),this.dlg.insertBefore(this.menu,this.dlg.firstChild),this.dlg.classList.add("e-excelfilter"),this.parent.enableRtl&&this.dlg.classList.add("e-rtl"),this.dlg.classList.remove("e-checkboxfilter"),this.cmenu=this.parent.createElement("ul",{className:"e-excel-menu"}),e.column.showColumnMenu&&this.parent.notify(Zh,{}),this.wireExEvents()}},t.prototype.closeDialog=function(){this.destroy()},t.prototype.selectHandler=function(e){e.item&&(this.parent.notify(nd,{}),this.menuItem=e.item,this.renderDialogue(e))},t.prototype.renderDialogue=function(e){var i=this,r=e?e.element:void 0,n=this.options.field,s=!(0,a.le)(n)&&As(n),l=!(0,a.le)(n)&&nn(n),h=this.parent.createElement("div",{className:"e-xlfl-maindiv",id:s?l+"-xlflmenu":n+"-xlflmenu"});if(this.dlgDiv=this.parent.createElement("div",{className:"e-xlflmenu",id:s?l+"-xlfldlg":n+"-xlfldlg"}),this.options.isResponsiveFilter){var c=document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv");c.appendChild(this.dlgDiv)}else this.parent.element.appendChild(this.dlgDiv);this.dlgObj=new sl({header:this.getLocalizedLabel("CustomFilter"),isModal:!0,overlayClick:this.removeDialog.bind(this),showCloseIcon:!0,closeOnEscape:!1,target:document.body,visible:!1,enableRtl:this.parent.enableRtl,open:function(){var p=i.dlgObj.element.querySelector("table.e-xlfl-table>tr");i.options.column.filterTemplate&&p.querySelector("#"+i.options.column.field+"-xlfl-frstvalue").focus()},close:this.removeDialog.bind(this),created:this.createdDialog.bind(this,r,n),buttons:[{click:this.filterBtnClick.bind(this,n),buttonModel:{content:this.getLocalizedLabel("OKButton"),isPrimary:!0,cssClass:this.parent.cssClass?"e-xlfl-okbtn "+this.parent.cssClass:"e-xlfl-okbtn"}},{click:this.removeDialog.bind(this),buttonModel:{content:this.getLocalizedLabel("CancelButton"),cssClass:this.parent.cssClass?"e-xlfl-cancelbtn "+this.parent.cssClass:"e-xlfl-cancelbtn"}}],content:h,width:430,animationSettings:{effect:"None"},cssClass:this.parent.cssClass?this.parent.cssClass:""});var u="isStringTemplate";this.dlgObj[u]=!0,this.renderResponsiveDialog(),this.dlgDiv.setAttribute("aria-label",this.getLocalizedLabel("CustomFilterDialogARIA")),this.childRefs.push(this.dlgObj),this.dlgObj.appendTo(this.dlgDiv)},t.prototype.renderResponsiveDialog=function(){if(this.options.isResponsiveFilter){var e=document.querySelector(".e-row-responsive-filter");e&&e.classList.remove("e-row-responsive-filter"),this.dlgObj.buttons=[{}],this.dlgObj.header=void 0,this.dlgObj.position={X:"",Y:""},this.dlgObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv"),this.dlgObj.width="100%",this.dlgObj.isModal=!1,this.dlgObj.showCloseIcon=!1}},t.prototype.removeDialog=function(){this.parent.notify(QC,{}),(this.parent.isReact||this.parent.isVue)&&this.parent.destroyTemplate!==void 0&&Am(this.parent,["filterTemplate"]),this.removeObjects(this.childRefs),(0,a.Od)(this.dlgDiv),this.parent.notify(oa,{})},t.prototype.createdDialog=function(e,i){if(this.renderCustomFilter(e,i),this.dlgObj.element.style.left="0px",!this.options.isResponsiveFilter)this.dlgObj.element.style.top="0px";else{var r=document.querySelector(".e-responsive-dialog > .e-dlg-header-content"),n=r.offsetHeight+4;this.dlgObj.element.style.top=n+"px"}!this.options.isResponsiveFilter&&a.AR.isDevice&&window.innerWidth<440&&(this.dlgObj.element.style.width="90%"),this.parent.notify(GC,{column:i,dialog:this.dialogObj}),this.dlgObj.show(),Cm(this.parent.element,this.dlgObj.element.parentElement)},t.prototype.renderCustomFilter=function(e,i){var r=this.dlgObj.element.querySelector(".e-xlfl-maindiv"),n=this.parent.createElement("div",{innerHTML:this.getLocalizedLabel("ShowRowsWhere"),className:"e-xlfl-dlgfields"});r.appendChild(n);var s=this.parent.createElement("div",{innerHTML:this.options.displayName,className:"e-xlfl-fieldset"});r.appendChild(s),this.renderFilterUI(i,r)},t.prototype.filterBtnClick=function(e){var i=!(0,a.le)(e)&&As(e),r=!(0,a.le)(e)&&nn(e),n=i?r:e,s=this.dlgDiv.querySelector("#"+n+"-xlfl-frstvalue").ej2_instances[0],l=this.dlgDiv.querySelector("#"+n+"-xlfl-frstoptr").ej2_instances[0],h=this.dlgDiv.querySelector("#"+n+"-xlfl-secndvalue").ej2_instances[0],c=this.dlgDiv.querySelector("#"+n+"-xlfl-secndoptr").ej2_instances[0],u;if(this.options.type==="string"){var p=this.dlgDiv.querySelector("#"+n+"-xlflmtcase").ej2_instances[0];u=p.checked}var f=this.dlgDiv.querySelector("#"+n+"e-xlfl-frstpredicate").ej2_instances[0],g=f.checked?"and":"or";h.value===null&&(g="or"),this.filterByColumn(this.options.field,l.value,s.value,g,u,this.options.ignoreAccent,c.value,h.value),this.removeDialog()},t.prototype.filterByColumn=function(e,i,r,n,s,l,h,c){var u=this.parent.getColumnByField?this.parent.getColumnByField(e):this.options.column,p=this.isForeignColumn(u)?u.foreignKeyValue:e,f=[],g;f.push({field:p,predicate:n,matchCase:s,ignoreAccent:l,operator:i,value:r,type:this.options.type});var C={instance:this,handler:this.filterByColumn,arg1:e,arg2:i,arg3:r,arg4:n,arg5:s,arg6:l,arg7:h,arg8:c,cancel:!1};if(this.parent.notify(td,C),!C.cancel){g=new yt.$(p,i.toLowerCase(),r,!s,l),!(0,a.le)(c)&&!(0,a.le)(h)&&(f.push({field:p,predicate:n,matchCase:s,ignoreAccent:l,operator:h,value:c,type:this.options.type}),g=g[n](p,h.toLowerCase(),c,!s,l));var L={action:"filtering",filterCollection:f,field:this.options.field,ejpredicate:g,actualPredicate:f};this.isForeignColumn(u)?this.foreignKeyFilter(L,f,g):this.options.handler(L)}},t.prototype.renderOperatorUI=function(e,i,r,n,s){var l=this.parent.createElement("tr",{className:"e-xlfl-fields",attrs:{role:"row"}});i.appendChild(l);var h=this.parent.createElement("td",{className:"e-xlfl-optr"});l.appendChild(h);var c=this.parent.createElement("div",{className:"e-xlfl-optrdiv"}),u=!(0,a.le)(e)&&As(e),p=!(0,a.le)(e)&&nn(e),f=this.parent.createElement("input",{id:u?p+r:e+r});c.appendChild(f),h.appendChild(c);var g=this.options.type+"Operator",C=this.customFilterOperators[g];this.optrData=C;var L=this.dropSelectedVal(this.options.column,n,s),D="";this.menuItem&&(D=this.menuItem.text.slice(0,-3),D!==this.getLocalizedLabel("CustomFilter")&&(L=s?D:void 0),D===this.getLocalizedLabel("Between")&&(L=this.getLocalizedLabel(s?"GreaterThanOrEqual":"LessThanOrEqual")));var R=this.options.column,B=new mn($a({dataSource:C,fields:{text:"text",value:"value"},text:L,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:null},R.filter.params));this.childRefs.push(B);var H={open:this.dropDownOpen.bind(this),change:this.dropDownValueChange.bind(this)};xm(f.id,[ic,rc],H,this),B.addEventListener(ic,this.eventHandlers[f.id][ic]),B.addEventListener(rc,this.eventHandlers[f.id][rc]),B.appendTo(f);var j=this.getSelectedValue(L);return{fieldElement:l,operator:j}},t.prototype.removeHandlersFromComponent=function(e){e.element.classList.contains("e-dropdownlist")?Em(e,[ic,rc],this):e.element.classList.contains("e-autocomplete")&&Em(e,[qh,nc],this)},t.prototype.dropDownOpen=function(e){e.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()},t.prototype.dropDownValueChange=function(e){e.element.id.includes("-xlfl-frstoptr")?this.firstOperator=e.value.toString():this.secondOperator=e.value.toString()},t.prototype.getFilterUIInfo=function(){return{firstOperator:this.firstOperator,secondOperator:this.secondOperator,field:this.options.field}},t.prototype.getSelectedValue=function(e){var i=new Oe.h(this.optrData).executeLocal(new yt.A().where("text","equal",e));return(0,a.le)(i[0])?"":i[0].value},t.prototype.dropSelectedVal=function(e,i,r){var n;return i&&i.length>0?n=i.length===2?r?i[0].operator:i[1].operator:r?i[0].operator:void 0:r&&e.type==="string"&&!e.filter.operator?n="startswith":n=r?e.filter.operator||"equal":void 0,this.getSelectedText(n)},t.prototype.getSelectedText=function(e){var i=new Oe.h(this.optrData).executeLocal(new yt.A().where("value","equal",e));return(0,a.le)(i[0])?"":i[0].text},t.prototype.renderFilterUI=function(e,i){var r=this.existingPredicate[e],n=this.parent.createElement("table",{className:"e-xlfl-table",attrs:{role:"grid"}});i.appendChild(n);var s=this.parent.createElement(xw);s.innerHTML='<col style="width: 50%"></col><col style="width: 50%"></col>',n.appendChild(s);var l=this.renderOperatorUI(e,n,"-xlfl-frstoptr",r,!0);this.firstOperator=l.operator,this.renderFlValueUI(e,l,"-xlfl-frstvalue",r,!0);var h=this.parent.createElement("tr",{className:"e-xlfl-predicate",attrs:{role:"row"}});n.appendChild(h),this.renderRadioButton(e,h,r),l=this.renderOperatorUI(e,n,"-xlfl-secndoptr",r,!1),this.secondOperator=l.operator,this.renderFlValueUI(e,l,"-xlfl-secndvalue",r,!1)},t.prototype.renderRadioButton=function(e,i,r){var n=this.parent.createElement("td",{className:"e-xlfl-radio",attrs:{colSpan:"2"}});i.appendChild(n);var s=this.parent.createElement("div",{className:"e-xlfl-radiodiv",attrs:{style:"display: inline-block"}}),l=!(0,a.le)(e)&&As(e),h=!(0,a.le)(e)&&nn(e),c=this.parent.createElement("input",{id:l?h+"e-xlfl-frstpredicate":e+"e-xlfl-frstpredicate",attrs:{type:"radio"}}),u=this.parent.createElement("input",{id:l?h+"e-xlfl-secndpredicate":e+"e-xlfl-secndpredicate",attrs:{type:"radio"}});s.appendChild(c),s.appendChild(u),n.appendChild(s),this.options.type==="string"&&this.renderMatchCase(e,i,n,"-xlflmtcase",r);var p=new Uh({label:this.getLocalizedLabel("AND"),name:"default",checked:!0,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.push(p);var f=new Uh({label:this.getLocalizedLabel("OR"),name:"default",enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.push(f);var g=r&&r.length===2?r[1].predicate:"and";g==="and"?(p.checked=!0,f.checked=!1):(f.checked=!0,p.checked=!1),p.appendTo(c),f.appendTo(u),p.element.nextElementSibling.classList.add("e-xlfl-radio-and"),f.element.nextElementSibling.classList.add("e-xlfl-radio-or")},t.prototype.removeObjects=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];n&&!n.isDestroyed&&(this.removeHandlersFromComponent(n),n.destroy())}},t.prototype.renderFlValueUI=function(e,i,r,n,s){var l=this.parent.createElement("td",{className:"e-xlfl-value"});i.fieldElement.appendChild(l);var h=!(0,a.le)(e)&&As(e),c=!(0,a.le)(e)&&nn(e),u=this.parent.createElement("div",{className:"e-xlfl-valuediv"}),p=this.options.filteredColumns.some(function(ne){return e===ne.field}),f=this.options.filteredColumns.filter(function(ne){return ne.field===e});if(this.options.column.filterTemplate){var g={},C=this.options.column;p&&r&&(g=this.getExcelFilterData(r,g,C,n,f));var L=this.parent.isReact&&typeof this.options.column.filterTemplate!="string",D=this.parent.element.id+C.uid+"filterTemplate";if(L)this.options.column.getFilterTemplate()(g,this.parent,"filterTemplate",D,null,null,u),this.parent.renderTemplates();else{var R=this.options.column.getFilterTemplate()(g,this.parent,"filterTemplate",D);Gh(u,R)}(this.parent.isAngular?u.children[0]:u.querySelector("input")).id=h?c+r:e+r,l.appendChild(u)}else{var B=this.parent.createElement("input",{id:h?c+r:e+r});u.appendChild(B),l.appendChild(u);var H=void 0,j=void 0;n&&n.length>0&&(j=n.length===2?s?n[0]:n[1]:s?n[0]:void 0,H=j&&j.operator===i.operator?j.value:void 0,(0,a.le)(H)&&(H=void 0));var W={string:this.renderAutoComplete.bind(this),number:this.renderNumericTextBox.bind(this),date:this.renderDate.bind(this),datetime:this.renderDateTime.bind(this)};W[this.options.type](this.options,e,B,H,this.parent.enableRtl)}},t.prototype.getExcelFilterData=function(e,i,r,n,s){var l=e==="-xlfl-frstvalue"?0:1;if(e==="-xlfl-frstvalue"||s.length>1){i={column:n instanceof Array?n[l]:n};var h=this.options.column.columnData&&s.length>1?this.options.column.columnData.length===1?0:1:l;i[this.options.field]=r.foreignKeyValue?this.options.column.columnData[h][r.foreignKeyValue]:s[h].value,this.options.foreignKeyValue&&(i[this.options.foreignKeyValue]=this.options.column.columnData[h][r.foreignKeyValue])}return i},t.prototype.renderMatchCase=function(e,i,r,n,s){var l=this.parent.createElement("div",{className:"e-xlfl-matchcasediv",attrs:{style:"display: inline-block"}}),h=!(0,a.le)(e)&&As(e),c=!(0,a.le)(e)&&nn(e),u=this.parent.createElement("input",{id:h?c+n:e+n,attrs:{type:"checkbox"}});l.appendChild(u),r.appendChild(l);var p=s&&s.length>0?s&&s.length===2?s[1].matchCase:s[0].matchCase:!1,f=new Yn({label:this.getLocalizedLabel("MatchCase"),enableRtl:this.parent.enableRtl,checked:p,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.push(f),f.appendTo(u)},t.prototype.renderDate=function(e,i,r,n,s){var l=gm(e.format,e.type)||e.format,h=new Vm($a({format:l,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:s,value:new Date(n),locale:this.parent.locale},e.column.filter.params));this.childRefs.push(h),h.appendTo(r)},t.prototype.renderDateTime=function(e,i,r,n,s){var l=gm(e.format,e.type),h=new Sw($a({format:l,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:s,value:new Date(n),locale:this.parent.locale},e.column.filter.params));this.childRefs.push(h),h.appendTo(r)},t.prototype.completeAction=function(e){e.result=cS(e.result)},t.prototype.renderNumericTextBox=function(e,i,r,n,s){var l=new Zn($a({format:e.format,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:s,value:n,locale:this.parent.locale,cssClass:this.parent.cssClass?this.parent.cssClass:null},e.column.filter.params));this.childRefs.push(l),l.appendTo(r)},t.prototype.renderAutoComplete=function(e,i,r,n,s){var l=this.options.column,h=this.isForeignColumn(l),c=h?l.dataSource:e.dataSource,u={value:h?l.foreignKeyValue:i},p=new tm($a({dataSource:c instanceof Oe.h?c:new Oe.h(c),fields:u,query:this.getQuery(),sortOrder:"Ascending",locale:this.parent.locale,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",autofill:!0,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:s,text:n},l.filter.params));if(c&&"result"in c){var f=Sm({requestType:"stringfilterrequest"},this.getQuery());this.parent.trigger(om,f.state);var g=f.deffered;g.promise.then(function(L){p.dataSource=new Oe.h(L)})}this.childRefs.push(p);var C={actionComplete:this.acActionComplete(p,i),focus:this.acFocus(p,i,e,r)};xm(r.id,[qh,nc],C,this),p.addEventListener(nc,this.eventHandlers[r.id][nc]),p.addEventListener(qh,this.eventHandlers[r.id][qh]),p.appendTo(r)},t.prototype.acActionComplete=function(e,i){return function(r){var n=!(0,a.le)(i)&&As(i);r.result=r.result.filter(function(s,l,h){return h.map(function(c){return n?wm(e.fields.value,c):c[e.fields.value]}).indexOf(n?wm(e.fields.value,s):s[e.fields.value])===l})}},t.prototype.acFocus=function(e,i,r,n){var s=this;return function(){var l=!(0,a.le)(i)&&As(i),h=!(0,a.le)(i)&&nn(i),c=l?h:i;e.filterType=s.dlgDiv.querySelector("#"+c+(n.id===c+"-xlfl-frstvalue"?"-xlfl-frstoptr":"-xlfl-secndoptr")).ej2_instances[0].value,e.ignoreCase=r.type==="string"?!s.dlgDiv.querySelector("#"+c+"-xlflmtcase").ej2_instances[0].checked:!0,e.filterType=(0,a.le)(e.filterType)?"equal":e.filterType}},t}(ng),wd=function(){function o(t){this.parent=t,this.filterCollection=new Map,this.filterRange=new Map,this.filterBtn=t.createElement("div",{className:"e-filter-btn e-control e-btn e-lib e-filter-iconbtn e-icon-btn"}),this.filterBtn.appendChild(t.createElement("span",{className:"e-btn-icon e-icons e-filter-icon"})),this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener(),this.filterRange=null,this.filterCollection=null,this.parent=null},o.prototype.addEventListener=function(){this.parent.on(ot.W2,this.filterRangeAlertHandler,this),this.parent.on(E.WG,this.initiateFilterUIHandler,this),this.parent.on(E.uG,this.filterMouseDownHandler,this),this.parent.on(E.Yx,this.renderFilterCellHandler,this),this.parent.on(id,this.beforeFilterMenuOpenHandler,this),this.parent.on(nd,this.closeDialog,this),this.parent.on(E.Zh,this.reapplyFilterHandler,this),this.parent.on(E.FA,this.filterByCellValueHandler,this),this.parent.on(E.Dg,this.clearFilterHandler,this),this.parent.on(E.I2,this.getFilteredColumnHandler,this),this.parent.on(E.MX,this.cMenuBeforeOpenHandler,this),this.parent.on(rd,this.filterCboxValueHandler,this),this.parent.on(E.CT,this.getFilterRangeHandler,this),this.parent.on(E.Em,this.filterCellKeyDownHandler,this),this.parent.on(ot.eM,this.getFilteredCollection,this),this.parent.on(E.eT,this.updateFilter,this),this.parent.on(w.a8y,this.updateFilter,this),this.parent.on(w.x2y,this.beforeInsertHandler,this),this.parent.on(ot.To,this.beforeDeleteHandler,this),this.parent.on(ot.I,this.deleteSheetHandler,this),this.parent.on(w.ZHw,this.clearHandler,this),this.parent.on(Zh,this.filterDialogCreatedHandler,this),this.parent.on(oa,this.removeFilterClass,this),this.parent.on(ot.W$,this.duplicateSheetFilterHandler,this)},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ot.W2,this.filterRangeAlertHandler),this.parent.off(E.WG,this.initiateFilterUIHandler),this.parent.off(E.uG,this.filterMouseDownHandler),this.parent.off(E.Yx,this.renderFilterCellHandler),this.parent.off(id,this.beforeFilterMenuOpenHandler),this.parent.off(nd,this.closeDialog),this.parent.off(E.Zh,this.reapplyFilterHandler),this.parent.off(E.FA,this.filterByCellValueHandler),this.parent.off(E.Dg,this.clearFilterHandler),this.parent.off(E.I2,this.getFilteredColumnHandler),this.parent.off(E.MX,this.cMenuBeforeOpenHandler),this.parent.on(rd,this.filterCboxValueHandler),this.parent.off(E.CT,this.getFilterRangeHandler),this.parent.off(E.Em,this.filterCellKeyDownHandler),this.parent.off(ot.eM,this.getFilteredCollection),this.parent.off(E.eT,this.updateFilter),this.parent.off(w.a8y,this.updateFilter),this.parent.off(w.x2y,this.beforeInsertHandler),this.parent.off(ot.To,this.beforeDeleteHandler),this.parent.off(ot.I,this.deleteSheetHandler),this.parent.off(w.ZHw,this.clearHandler),this.parent.off(Zh,this.filterDialogCreatedHandler),this.parent.off(oa,this.removeFilterClass),this.parent.off(ot.W$,this.duplicateSheetFilterHandler))},o.prototype.getModuleName=function(){return"filter"},o.prototype.isInValidFilterRange=function(t,e){var i=e?(0,w.gaE)((0,w.IRR)(e)):(0,w.gaE)((0,w.IRR)(t.selectedRange));return i[0]>t.usedRange.rowIndex||i[1]>t.usedRange.colIndex},o.prototype.filterRangeAlertHandler=function(t){var e=this,i=this.parent.serviceLocator.getService(Yt);i.show({content:t.error,isModal:!0,height:180,width:400,showCloseIcon:!0,beforeOpen:function(r){var n={dialogName:"FilterRangeDialog",element:r.element,target:r.target,cancel:r.cancel};e.parent.trigger("dialogBeforeOpen",n),n.cancel&&(r.cancel=!0)}}),this.parent.hideSpinner()},o.prototype.beforeFilterMenuOpenHandler=function(t){var e=this.parent.serviceLocator.getService(Ve);t.element.classList.add("e-spreadsheet-contextmenu");var i=t.element.querySelector("ul");this.addMenuItem(i,e.getConstant("SortDescending"),"e-filter-sortdesc","e-sort-desc"),this.addMenuItem(i,e.getConstant("SortAscending"),"e-filter-sortasc","e-sort-asc"),t.element.appendChild(i)},o.prototype.addMenuItem=function(t,e,i,r){var n=this.parent.createElement("li",{className:i+" e-menu-item"});n.innerHTML=e,n.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+r}),n.firstChild),t.insertBefore(n,t.firstChild)},o.prototype.initiateFilterUIHandler=function(t){var e=this,i=t?t.predicates:null,r=t.sIdx;!r&&r!==0&&(r=this.parent.activeSheetIndex);var n;t.promise&&(n=new Oe.B,t.promise=n.promise);var s=function(){n&&n.resolve()},l=t.isInternal||t.isCut;if(this.filterRange.size>0&&this.filterRange.has(r)&&!this.parent.isOpen&&!i){this.removeFilter(r,l,!1),s();return}var h=(0,w.zfV)(this.parent,r);if(this.isInValidFilterRange(h,t.range)){var c=this.parent.serviceLocator.getService(Ve);this.filterRangeAlertHandler({error:c.getConstant("FilterOutOfRangeError")}),s();return}var u=t.range||h.selectedRange,p,f;if(!l){if(p={range:u,sheetIndex:r,cancel:!1},t.predicates?(p.predicates=t.predicates,p.previousPredicates=this.filterCollection.get(r)&&[].slice.call(this.filterCollection.get(r))):p.filterOptions={predicates:t.predicates},p.useFilterRange=!1,f={action:"filter",eventArgs:p},this.parent.notify(w.ya2,f),p.cancel){s();return}delete p.cancel,t.useFilterRange=p.useFilterRange}if(!t.range&&(l||u===p.range)){var g=(0,w.dK5)(u);g[0]===g[2]&&g[1]===g[3]&&(g=(0,w.Oyx)(g[0],g[1],h),u=(0,w.i0K)(g),l||(p.range=u))}else l||(u=p.range);if(i)if(i.length){var C=this.filterRange.get(r);C&&(t.useFilterRange=C.useFilterRange),this.processRange(h,r,u,!0,t.useFilterRange);var L=this.filterRange.get(r).range.slice();L[0]=L[0]+1,t.useFilterRange||(L[2]=h.usedRange.rowIndex),L[1]=L[3]=(0,w.ugT)(i[0].field);var D=h.name+"!"+this.getPredicateRange(L,i.slice(1,i.length)),R=(0,w.i0K)(L);(0,w.YuF)(this.parent,D,!0,!0,null,!0,null,null,!1,R).then(function(B){e.filterSuccessHandler(new Oe.h(B),{action:"filtering",filterCollection:i,field:i[0].field,sIdx:t.sIdx,isInternal:l,prevPredicates:p&&p.previousPredicates}),s()});return}else this.clearFilterHandler({sheetIndex:r}),s();else this.processRange(h,r,u,!1,t.useFilterRange),s();l||this.parent.notify(E.Av,f)},o.prototype.processRange=function(t,e,i,r,n){var s=(0,w.gaE)((0,w.IRR)(i||t.selectedRange));s[0]===s[2]&&s[1]===s[3]?(s[0]=0,s[1]=0,s[2]=t.usedRange.rowIndex,s[3]=t.usedRange.colIndex):s[3]>t.usedRange.colIndex&&(s[3]=t.usedRange.colIndex),this.filterRange.set(e,{useFilterRange:n,range:s}),this.filterCollection.set(e,[]),r||this.refreshFilterRange(s,!1,e)},o.prototype.removeFilter=function(t,e,i){var r=this.filterRange.get(t).range.slice(),n=(0,w.i0K)(r),s;if(!e){if(s={action:"filter",eventArgs:{range:n,sheetIndex:t,cancel:!1}},this.parent.notify(w.ya2,s),s.eventArgs.cancel)return;delete s.eventArgs.cancel}if((this.filterCollection.get(t).length||i)&&this.clearFilterHandler({preventRefresh:i,sheetIndex:t}),this.filterRange.delete(t),this.filterCollection.delete(t),this.refreshFilterRange(r,!0,t),this.parent.filterCollection)for(var l=0,h=void 0,c=0,u=this.parent.filterCollection.length;c<u;c++)h=this.parent.filterCollection[l],h.sheetIndex===t&&h.filterRange===n?this.parent.filterCollection.splice(l,1):l++;e||this.parent.notify(E.Av,s)},o.prototype.filterByCellValueHandler=function(){var t=this,e=this.parent.activeSheetIndex,i=this.parent.getActiveSheet();if(this.isInValidFilterRange(i)){var r=this.parent.serviceLocator.getService(Ve);this.filterRangeAlertHandler({error:r.getConstant("FilterOutOfRangeError")});return}var n=(0,w.dK5)(i.activeCell);this.isFilterRange(e,n[0],n[1])||this.processRange(i,e);var s=this.filterRange.get(e).range.slice();s[0]=s[0]+1,s[2]=i.usedRange.rowIndex,s[1]=s[3]=n[1];var l=(0,w.AH9)(n[1]+1),h=(0,w.ZRw)(this.parent,(0,w.$Su)(n[0],n[1],i));(0,w.hj$)(h)&&(h=parseFloat(h));var c=[{field:l,operator:"equal",type:this.getColumnType(i,n[1],n).type,matchCase:!1,value:h}],u=i.name+"!"+this.getPredicateRange(s,this.filterCollection.get(e)),p=(0,w.i0K)(s);(0,w.YuF)(this.parent,u,!0,!0,null,!0,null,null,!1,p).then(function(f){t.filterSuccessHandler(new Oe.h(f),{action:"filtering",filterCollection:c,field:l,isFilterByValue:!0})})},o.prototype.renderFilterCellHandler=function(t){var e=(0,a.le)(t.sIdx)?this.parent.activeSheetIndex:t.sIdx;if(e===this.parent.activeSheetIndex&&this.isFilterCell(e,t.rowIndex,t.colIndex)){if(!t.td)return;var i=t.td.querySelector(".e-filter-icon");i?i.className="e-btn-icon e-icons e-filter-icon"+this.getFilterSortClassName(t.colIndex,e):(i=this.filterBtn.cloneNode(!0),i.firstElementChild.className+=this.getFilterSortClassName(t.colIndex,e),t.td.insertBefore(i,t.td.firstChild))}},o.prototype.getFilterSortClassName=function(t,e){for(var i=(0,w.AH9)(t+1),r="",n=this.filterCollection.get(e),s=this.parent.sortCollection,l=0;l<n.length;l++)if(n[l].field===i){r=" e-filtered";break}if(s){for(var l=0;l<s.length;l++)if(s[l].sheetIndex===e&&s[l].columnIndex===t){r+=s[l].order==="Ascending"?" e-sortasc-filter":" e-sortdesc-filter";break}}return r},o.prototype.refreshFilterRange=function(t,e,i){var r=i;!r&&r!==0&&(r=this.parent.activeSheetIndex),!t&&!this.filterRange.get(r)&&(t=[0,0,0,0]);for(var n=t||this.filterRange.get(r).range.slice(),s=n[1];s<=n[3];s++){var l=this.parent.getCell(n[0],s);if(e){if(l&&l.hasChildNodes()){var h=l.querySelector(".e-filter-btn");h&&h.parentElement.removeChild(h)}}else this.renderFilterCellHandler({td:l,rowIndex:n[0],colIndex:s,sIdx:r})}this.parent.sortCollection&&this.parent.notify(w.Aed,null)},o.prototype.isFilterCell=function(t,e,i){var r=this.filterRange.get(t)&&this.filterRange.get(t).range;return r&&r[0]===e&&r[1]<=i&&r[3]>=i},o.prototype.isFilterRange=function(t,e,i){var r=this.filterRange.get(t)&&this.filterRange.get(t).range;return r&&r[0]<=e&&r[2]>=e&&r[1]<=i&&r[3]>=i},o.prototype.getFilteredColumnHandler=function(t){var e=(0,a.o8)(t.sheetIndex)?this.parent.activeSheetIndex:t.sheetIndex,i=this.parent.serviceLocator.getService(Ve);if(t.clearFilterText=i.getConstant("ClearFilter"),this.filterRange.has(e)){var r=this.filterCollection.get(e);if(t.isClearAll){t.isFiltered=r&&r.length>0;return}var n=this.filterRange.get(e).range.slice(),s=(0,w.zfV)(this.parent,e),l=(0,w.n53)(s.activeCell);if(this.isFilterRange(e,l[0],l[1])){t.field=(0,w.AH9)(l[1]+1);var h=(0,w.$Su)(n[0],l[1],s),c=this.parent.getDisplayText(h);t.clearFilterText=i.getConstant("ClearFilterFrom")+'"'+(c?c.toString():"Column "+t.field)+'"',r.some(function(u){return t.isFiltered=u.field===t.field,t.isFiltered})}}},o.prototype.cMenuBeforeOpenHandler=function(t){var e=this.parent.element.id+"_cmenu";if(t.parentItem&&t.parentItem.id===e+"_filter"&&t.target===""){var i={isFiltered:!1};this.getFilteredColumnHandler(i),this.parent.enableContextMenuItems([e+"_clearfilter",e+"_reapplyfilter"],!!i.isFiltered,!0)}},o.prototype.closeDialog=function(){var t=document.querySelector(".e-filter-popup");if(t&&t.id.includes(this.parent.element.id)){var e=(0,a.Xr)(t,"dialog");a.bi.remove(t,S(),this.filterMouseDownHandler),e&&e.hide(),this.parent.notify(oa,null)}},o.prototype.removeFilterClass=function(){this.parent.element.style.position==="relative"&&(this.parent.element.style.position=""),this.parent.element.classList.contains("e-filter-open")&&this.parent.element.classList.remove("e-filter-open")},o.prototype.isPopupOpened=function(){var t=document.getElementsByClassName("e-filter-popup")[0];return t&&t.id.includes(this.parent.element.id)&&t.style.display!=="none"},o.prototype.filterCellKeyDownHandler=function(t){var e=this.parent.getActiveSheet(),i=(0,w.n53)(e.activeCell);if(this.isFilterCell(this.parent.activeSheetIndex,i[0],i[1])){if(t.closePopup)this.closeDialog();else if(t.isFilterCell=!0,!this.isPopupOpened()){var r=this.parent.getCell(i[0],i[1]);r&&this.openDialog(r)}}},o.prototype.filterMouseDownHandler=function(t){if(!(a.AR.isDevice&&t.type==="mousedown"||this.parent.getActiveSheet().isProtected)){var e=t.target;if(e.classList.contains("e-filter-icon")||e.classList.contains("e-filter-btn"))this.isPopupOpened()&&this.closeDialog(),this.openDialog(rn(e,"e-cell"));else if(this.isPopupOpened()){var i=e.offsetParent;!e.classList.contains("e-searchinput")&&!e.classList.contains("e-searchclear")&&i&&!i.classList.contains("e-filter-popup")&&!i.classList.contains("e-text-content")&&!i.classList.contains("e-checkboxtree")&&!i.classList.contains("e-checkbox-wrapper")?this.closeDialog():this.selectSortItemHandler(e)}}},o.prototype.initTreeView=function(t,e){var i=this,r=[],n=[],s={},l=[],h=[],c=[],u=[],p,f,g,C,L,D,R,B=["January","February","March","April","May","June","July","August","September","October","November","December"],H,j=!1,W=this.parent.getActiveSheet(),ne=function(Pe){s[D]=!0,(0,w.wDH)(W,Number(Pe.__rowIndex)-1)?j=!0:r.push(D),n.push(D)};t.dataSource.forEach(function(Pe){C=Pe[t.column.field],typeof C=="object"&&!!Date.parse(C.toString())?(p=C.getFullYear().toString(),s[p]||(H={__rowIndex:p,hasChild:!0},H[t.column.field]=p,l.push(H),s[p]=!0),R=C.getMonth(),f=B[R],L=p+" "+f,s[L]||(H={__rowIndex:L,pId:p,hasChild:!0,month:R},H[t.column.field]=f,h.push(H),s[L]=!0),g=C.getDate(),D=L+" "+g.toString(),s[D]||(H={__rowIndex:D,pId:L},H[t.column.field]=g,c.push(H),ne(Pe))):(!Pe[t.column.field]&&Pe[t.column.field]!==0?(D="blanks",p=i.parent.serviceLocator.getService(Ve).getConstant("Blanks")):(D="text "+Pe[t.column.field].toString().toLowerCase(),p=Pe[t.column.field]),s[D]||(H={__rowIndex:D},H[t.column.field]=p,u.push(H),ne(Pe)))}),l=new Oe.h(l).executeLocal(new yt.A().sortBy(t.column.field,"decending")),h=new Oe.h(h).executeLocal(new yt.A().sortBy("month","ascending")),c=new Oe.h(c).executeLocal(new yt.A().sortBy(t.column.field,"ascending")),c=l.concat(h.concat(c)),u.length&&(u=new Oe.h(u).executeLocal(new yt.A().sortBy(t.column.field,"ascending")),c=c.concat(u));var ie=function(Pe){var Ye=[Pe.node];if(Pe.event.target.classList.contains("e-fullrow")||Pe.event.key=="Enter"){var Ze=ke.getNode(Pe.node);Ze.isChecked=="true"?ke.uncheckAll(Ye):ke.checkAll(Ye)}},me=function(){fe.indeterminate=!1,de.classList.contains("e-check")?(ke.uncheckAll(),de.classList.add("e-uncheck"),fe.checked=!1):(ke.checkAll(),de.classList.add("e-check"),fe.checked=!0)},ve=function(){(0,a.IV)([de],["e-check","e-stop","e-uncheck"]),t.btnObj.element.disabled&&(t.btnObj.element.disabled=!1),j?ke.checkedNodes.length?de.classList.add("e-stop"):(de.classList.add("e-uncheck"),t.btnObj.element.disabled=!0):de.classList.add("e-check"),fe.indeterminate=j,fe.checked=!j},Ee={};Ee[t.column.field]=this.parent.serviceLocator.getService(Ve).getConstant("SelectAll");var le=od(sd("cbox"),e.createCheckbox(Ee[t.column.field],!1,Ee),"e-ftrchk");le.classList.add("e-spreadsheet-ftrchk");var de=le.querySelector(".e-frame");de.classList.add("e-selectall"),le.addEventListener("click",me.bind(this)),t.element.appendChild(le);var fe=le.querySelector(".e-chk-hidden"),Le=this.parent.createElement("div"),ke=new av({fields:{dataSource:c,id:"__rowIndex",parentID:"pId",text:t.column.field,hasChildren:"hasChild"},enableRtl:this.parent.enableRtl,showCheckBox:!0,cssClass:"e-checkboxtree",checkedNodes:r,nodeClicked:ie.bind(this),keyPress:ie.bind(this),nodeChecked:function(Pe){Pe.action!=="indeterminate"&&(j=ke.checkedNodes.length!==ke.fields.dataSource.length,ve())}});ke.createElement=this.parent.createElement,ke.appendTo(Le),t.element.appendChild(Le),r=ke.checkedNodes,ve();var Me=function(){ke.checkedNodes.length===c.length?i.filterSuccessHandler(new Oe.h(t.dataSource),{action:"clear-filter",field:t.column.field}):i.generatePredicate(ke.checkedNodes,u.length?"string":t.type,t.column.field,e,n,ke.checkedNodes.length>c.length/2)};t.btnObj.element.addEventListener("click",Me.bind(this));var De=this.refreshCheckbox.bind(this,c,ke,r),Fe=function(){i.parent.off(E.o0,De),i.parent.off(oa,Fe)};this.parent.on(oa,Fe,this),this.parent.on(E.o0,De,this)},o.prototype.generatePredicate=function(t,e,i,r,n,s){var l=[],h,c={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11},u,p,f,g,C=function(){u[0]==="blanks"?l.push(Object.assign({value:"",type:e},h)):u[0]==="text"&&(u.splice(0,1),f=u.join(" "),isNaN(Number(f))?g="string":(f=Number(f),g="number"),l.push(Object.assign({value:f,type:g},h)))},L=function(){p=new Date(Number(u[0]),c[u[1]],Number(u[2])),p.getDate()?l.push(Object.assign({value:p,type:e},h)):C()};if(s){h={field:i,ignoreAccent:!1,matchCase:!1,predicate:"and",operator:"notequal"};for(var D=0,R=n.length;D<R;D++)t.indexOf(n[D])===-1&&(u=n[D].split(" "),L())}else{h={field:i,ignoreAccent:!1,matchCase:!1,predicate:"or",operator:"equal"};for(var D=0,R=t.length;D<R;D++)u=t[D].split(" "),u.length===3?L():C()}r.initiateFilter(l)},o.prototype.refreshCheckbox=function(t,e,i,r){var n;if(r.event.type==="keyup")n=r.event.target.value;else if(r.event.target.classList.contains("e-search-icon"))return;var s,l=function(){if(s.length&&!e.fields.dataSource.length){var W=e.element.parentElement;W.getElementsByClassName("e-spreadsheet-ftrchk")[0].classList.remove("e-hide"),(0,a.og)(W.getElementsByClassName("e-checkfltrnmdiv")[0])}e.fields.dataSource=s,e.dataBind()};if(n){s=new Oe.h(t).executeLocal(new yt.A().where(new yt.$(e.fields.text,"contains",n,!0)));var h={},c=[],u=void 0,p=void 0,f=isNaN(Number(n)),g=void 0,C=void 0;if(f){for(var L=0;L<s.length;L++)!s[L].hasChild||(c.push(new yt.$("pId","equal",s[L].__rowIndex,!1)),u=s[L].pId,h[u]||(c.push(new yt.$("__rowIndex","equal",u,!1)),h[u]=!0));p=s,C=1}else{var D=void 0,R={};g=[];for(var L=0;L<s.length;L++)u=s[L].pId,u?(D=u.split(" ")[0],h[u]||(c.push(new yt.$("__rowIndex","equal",u,!1)),h[u]=!0,g.push(D),g.push(u)),R[D]||(h[D]||(c.push(new yt.$("__rowIndex","equal",D,!1)),h[D]=!0),c.push(new yt.$("__rowIndex","equal",s[L].__rowIndex,!1)))):(u=s[L].__rowIndex,R[u]||(c.push(new yt.$("__rowIndex","contains",u,!1)),R[u]=!0));p=[]}if(s.length){c.length&&(s=p.concat(new Oe.h(t).executeLocal(new yt.A().where(yt.$.or(c))))),l(),e.checkAll();var B=e.animation.expand.duration;e.animation.expand.duration=0,e.expandAll(g,C),e.animation.expand.duration=B}else if(e.fields.dataSource.length){l();var H=e.element.parentElement;H.getElementsByClassName("e-spreadsheet-ftrchk")[0].classList.add("e-hide");var j=this.parent.createElement("div",{className:"e-checkfltrnmdiv"});j.appendChild(this.parent.createElement("span",{innerHTML:this.parent.serviceLocator.getService(Ve).getConstant("NoResult")})),H.appendChild(j)}}else s=t,l(),e.setProperties({checkedNodes:i})},o.prototype.openDialog=function(t){var e=this,i=parseInt(t.getAttribute("aria-colindex"),10),r=(0,w.AH9)(i);this.parent.showSpinner();var n=this.parent.activeSheetIndex,s=this.filterRange.get(n),l=s.range.slice(),h=this.parent.getActiveSheet(),c=(0,w.$Su)(l[0],i-1,h),u=this.parent.getDisplayText(c);l[0]=l[0]+1,s.useFilterRange||(l[2]=h.usedRange.rowIndex);var p=[l[0],i-1,l[2],i-1],f=this.getPredicateRange(p,this.filterCollection.get(n),i-1),g=f.otherColPredicate,C=h.name+"!"+f.address,L=(0,w.i0K)(p),D=this.getColumnType(h,i-1,l),R=D.type,B,H=R.includes("date")||D.isDateAvail;H&&!f.filteredCol&&(B=[]),(0,w.YuF)(this.parent,C,!0,!0,null,!0,null,null,!1,L,null,B).then(function(j){var W;if(e.parent.element.style.position="relative",e.parent.element.classList.add("e-filter-open"),H){if(B||!g.length)W=new Oe.h(B||j);else{var ne=new Oe.h(j).executeLocal(new yt.A().where(yt.$.and(e.getPredicates(g))));W=new Oe.h(ne)}var ie=function(De){e.parent.off(E.HG,ie),De.isCheckboxFilterTemplate=!0,e.initTreeView(De,Ee)};e.parent.on(E.HG,ie,e)}else j.some(function(De,Fe){return De&&(W=new Oe.h(j.slice(Fe))),!!De});var me=t.querySelector(".e-filter-btn"),ve={type:R,field:r,format:R==="date"?e.getDateFormatFromColumn(h,i,l):null,displayName:u||"Column "+r,dataSource:W,height:e.parent.element.classList.contains("e-bigger")?800:500,columns:[],hideSearchbox:!1,filteredColumns:e.filterCollection.get(n),column:{field:r,filter:{}},handler:e.filterSuccessHandler.bind(e,new Oe.h(j)),target:me,position:{X:0,Y:0},localeObj:e.parent.serviceLocator.getService(Ve)},Ee=new Aw(e.parent,e.getLocalizedCustomOperators());Ee.openDialog(ve);var le=document.querySelector(".e-filter-popup");if(le&&le.id.includes(e.parent.element.id)){a.bi.add(le,S(),e.filterMouseDownHandler,e);var de=e.parent.element.getBoundingClientRect(),fe=me.getBoundingClientRect(),Le=le.getBoundingClientRect(),ke=fe.right-de.left-Le.width;ke<0&&(ke=fe.left-de.left),le.style.left=ke+"px",le.style.top="0px",le.style.visibility="hidden",le.classList.contains("e-hide")&&le.classList.remove("e-hide");var Me=fe.bottom-de.top;Le.height-(de.bottom-fe.bottom)>0&&(Me-=Le.height-(de.bottom-fe.bottom),Me<0&&(Me=0)),le.style.top=Me+"px",le.style.visibility=""}e.parent.hideSpinner()})},o.prototype.getPredicateRange=function(t,e,i){var r=(0,w.i0K)(t),n,s=[];if(e&&e.length){var l,h;e.forEach(function(c){c.field&&(l=""+c.field+(t[0]+1)+":"+c.field+(t[2]+1),h=(0,w.ugT)(c.field),r.includes(l)||(r+=","+l,h<t[1]&&(t[1]=h),h>t[3]&&(t[3]=h)),i!==void 0&&(h===i?n=!0:s.push(c)))})}else n=!0;return i===void 0?r:{address:r,filteredCol:n,otherColPredicate:s}},o.prototype.filterDialogCreatedHandler=function(){var t=document.querySelector(".e-filter-popup");t&&t.id.includes(this.parent.element.id)&&t.classList.contains("e-popup-close")&&t.classList.add("e-hide")},o.prototype.filterCboxValueHandler=function(t){if(t.column&&t.data){var e="field",i=t.column[e],r="dataObj",n="__rowIndex";if(t.value){var s=(0,w.n53)(i+t.data[r][n]),l=(0,w.$Su)(s[0],s[1],this.parent.getActiveSheet());l&&l.format&&(t.value=this.parent.getDisplayText(l))}}},o.prototype.selectSortItemHandler=function(t){var e=t.classList.contains("e-filter-sortasc")?"Ascending":t.classList.contains("e-filter-sortdesc")?"Descending":null;if(!!e){var i=this.parent.getActiveSheet(),r=this.parent.activeSheetIndex,n=this.filterRange.get(r),s=n.range.slice();s[0]=s[0]+1,n.useFilterRange||(s[2]=i.usedRange.rowIndex),this.parent.sortCollection=this.parent.sortCollection?this.parent.sortCollection:[];for(var l,h=0;h<this.parent.sortCollection.length;h++)this.parent.sortCollection[h]&&this.parent.sortCollection[h].sheetIndex===r&&(l=this.parent.sortCollection[h],this.parent.sortCollection.splice(h,1));this.parent.sortCollection.push({sortRange:(0,w.i0K)(s),columnIndex:(0,w.IRR)(i.activeCell)[1],order:e,sheetIndex:r}),l||(l={order:""}),this.parent.notify(E.vy,{sortOptions:{sortDescriptors:{order:e},containsHeader:!1},previousSort:l,range:(0,w.i0K)(s)}),this.refreshFilterRange(),this.closeDialog()}},o.prototype.filterSuccessHandler=function(t,e){var i=e.sIdx;!i&&i!==0&&(i=this.parent.activeSheetIndex);var r=e.prevPredicates||[].slice.call(this.filterCollection.get(i));e.isFilterByValue&&!r.length&&(r=void 0);var n=this.filterCollection.get(i);if(this.updatePredicate(n,e.field),!(e.action==="clear-filter"&&n.length===r.length)){if(e.action==="filtering"&&(n=n.concat(e.filterCollection),n.length))for(var s=0;s<n.length;s++)e.field=n[s].field;this.filterCollection.set(i,n);var l={datasource:t,predicates:this.getPredicates(this.filterCollection.get(i))},h=this.filterRange.get(i);h.useFilterRange||(h.range[2]=(0,w.zfV)(this.parent,i).usedRange.rowIndex),this.applyFilter(l,(0,w.i0K)(h.range),i,r,!1,e.isInternal)}},o.prototype.updatePredicate=function(t,e){for(var i=new Oe.h(t),r=new yt.A,n=i.executeLocal(r.where("field","equal",e)),s=0;s<n.length;s++){for(var l=-1,h=0;h<t.length;h++)if(t[h].field===n[s].field){l=h;break}l!==-1&&t.splice(l,1)}},o.prototype.applyFilter=function(t,e,i,r,n,s){var l=this,h={range:e,predicates:[].slice.call(this.filterCollection.get(i)),previousPredicates:r,sheetIndex:i,cancel:!1};if(!(!s&&(this.parent.notify(w.ya2,{action:"filter",eventArgs:h}),h.cancel))){e.indexOf("!")<0&&(e=this.parent.sheets[i].name+"!"+e),this.parent.showSpinner();var c=new Promise(function(p,f){p(function(){}())}),u={args:{range:e,filterOptions:t},promise:c,refresh:n};this.parent.notify(ot.c3,u),u.promise.then(function(p){return l.refreshFilterRange(),l.parent.notify(ot.eM,null),l.parent.hideSpinner(),s||(delete h.cancel,l.parent.notify(E.Av,{action:"filter",eventArgs:h})),Promise.resolve(p)}).catch(function(p){return l.filterRangeAlertHandler({error:p}),Promise.reject(p)})}},o.prototype.getPredicates=function(t){for(var e=[],i=ng.getPredicate(t),r=0,n=Object.keys(i);r<n.length;r++){var s=n[r];e.push(i[s])}return e},o.prototype.getColumnType=function(t,e,i){for(var r=0,n=0,s=0,l=0,h=i[0];h<=i[2];h++){var c=(0,w.$Su)(h,e,t);if(c)if(c.format){var u=(0,w.K2R)(c.format).toLowerCase();switch(u){case"number":case"currency":case"accounting":case"percentage":r++;break;case"shortdate":case"longdate":s++;break;case"time":r++;break;default:(0,w.vnU)(c)?s++:(0,w.hj$)(c.value)?r++:n++;break}}else typeof c.value=="string"||c.value===void 0||c.value===null?n++:r++;else n++}return{type:r>n&&r>s&&r>l?"number":n>=r&&n>=s&&n>=l?"string":s>r&&s>n&&s>l?"date":"datetime",isDateAvail:!!s}},o.prototype.getDateFormatFromColumn=function(t,e,i){for(var r,n=i[0];n<=i[2];n++){var s=(0,w.$Su)(n,e-1,t);if(s&&s.format){r=s.format;break}}return r},o.prototype.clearFilterHandler=function(t){var e=t&&t.sheetIndex!==void 0?t.sheetIndex:this.parent.activeSheetIndex;if(t&&t.field){var i=[].slice.call(this.filterCollection.get(e));i&&i.length&&(this.updatePredicate(i,t.field),this.initiateFilterUIHandler({predicates:i,range:(0,w.i0K)(this.filterRange.get(e).range),sIdx:e}))}else{var r=t&&t.isAction,n={isFiltered:!1,isClearAll:!0,sheetIndex:e};if(this.getFilteredColumnHandler(n),n.isFiltered||t&&t.preventRefresh){var s=void 0,l=(0,w.zfV)(this.parent,e),h=this.filterRange.get(e),c=h.range;if(r&&(s={range:(0,w.i0K)(c),predicates:[],previousPredicates:this.filterCollection.get(e),sheetIndex:e,cancel:!1},this.parent.notify(w.ya2,{action:"filter",eventArgs:s}),s.cancel))return;this.filterCollection.set(e,[]);for(var u=this.parent.filterCollection,p=0,f=u&&u.length;p<f;p++)if(u[p].sheetIndex===e){u.splice(p,1);break}var g=h.useFilterRange?c[2]:l.usedRange.rowIndex;if(this.parent.scrollSettings.enableVirtualization&&g-c[0]+1>this.parent.viewport.rowCount+this.parent.getThreshold("row")*2){for(var p=0;p<=g;p++)(0,w.ZG6)(l,p,{hidden:!1,isFiltered:!1});(!t||!t.preventRefresh)&&this.parent.renderModule.refreshSheet(!1,!1,!0)}else{this.refreshFilterRange(null,null,e);var C={startIndex:c[0],hide:!1,isFiltering:!0,refreshUI:!1,endIndex:h.useFilterRange?c[2]:l.usedRange.rowIndex,sheetIndex:e};this.parent.notify(w.wtl,C),C.refreshUI&&(!t||!t.preventRefresh)&&this.parent.renderModule.refreshSheet(!1,!1,!0)}r&&(delete s.cancel,this.parent.notify(E.Av,{action:"filter",eventArgs:s}))}}},o.prototype.reapplyFilterHandler=function(t,e){var i=this,r=this.parent.activeSheetIndex;if(this.filterRange.has(r)){var n=this.filterCollection.get(r);if(n&&n.length){var s=(0,w.zfV)(this.parent,r),l=this.filterRange.get(this.parent.activeSheetIndex),h=l.range.slice();h[0]=h[0]+1,l.useFilterRange||(h[2]=s.usedRange.rowIndex),h[1]=h[3]=(0,w.ugT)(n[0].field);var c=s.name+"!"+this.getPredicateRange(h,n.slice(1,n.length));(0,w.YuF)(this.parent,c,!0,!0,null,!0,null,null,!1,(0,w.i0K)(h)).then(function(u){var p=i.getPredicates(i.filterCollection.get(r));i.applyFilter({predicates:p,datasource:new Oe.h(u)},(0,w.i0K)(l.range),r,[].slice.call(n),e,t)})}}},o.prototype.getFilterRangeHandler=function(t){var e=t.sheetIdx;this.filterRange&&this.filterRange.has(e)?(t.hasFilter=!0,t.filterRange=this.filterRange.get(e).range):(t.hasFilter=!1,t.filterRange=null)},o.prototype.getLocalizedCustomOperators=function(){var t=this.parent.serviceLocator.getService(Ve),e=[{value:"equal",text:t.getConstant("Equal")},{value:"greaterthan",text:t.getConstant("GreaterThan")},{value:"greaterthanorequal",text:t.getConstant("GreaterThanOrEqual")},{value:"lessthan",text:t.getConstant("LessThan")},{value:"lessthanorequal",text:t.getConstant("LessThanOrEqual")},{value:"notequal",text:t.getConstant("NotEqual")}],i={stringOperator:[{value:"startswith",text:t.getConstant("StartsWith")},{value:"endswith",text:t.getConstant("EndsWith")},{value:"contains",text:t.getConstant("Contains")},{value:"equal",text:t.getConstant("Equal")},{value:"notequal",text:t.getConstant("NotEqual")}],numberOperator:e,dateOperator:e,datetimeOperator:e,booleanOperator:[{value:"equal",text:t.getConstant("Equal")},{value:"notequal",text:t.getConstant("NotEqual")}]};return i},o.prototype.getFilteredCollection=function(){for(var t=this.parent.sheets.length,e=[],i,r=0;r<t;r++){var n=void 0,s=void 0,l={sheetIdx:r,filterRange:n,hasFilter:s};if(this.getFilterRangeHandler(l),l.hasFilter){for(var h=[],c=[],u=[],p=[],f=[],g=this.filterCollection.get(l.sheetIdx),C=0;C<g.length;C++)if(g[C].field&&g[C].operator){var L=(0,w.n53)(g[C].field+"1")[1];h.push(L),c.push(g[C].operator),u.push((0,a.le)(g[C].value)?"":g[C].value),p.push(g[C].type),f.push(g[C].predicate)}var D=(0,w.i0K)(l.filterRange);i={sheetIndex:l.sheetIdx,filterRange:D,hasFilter:l.hasFilter,column:h,criteria:c,value:u,dataType:p,predicates:f},e.push(i)}}i&&(this.parent.filterCollection=e)},o.prototype.updateFilter=function(t){if(this.parent.filterCollection&&(t.initLoad||t.isOpen)){for(var e=0;e<this.parent.filterCollection.length;e++){var i=this.parent.filterCollection[e],r=i.sheetIndex;e===0&&!this.parent.isOpen&&!t.isOpen&&(r=0);var n=[];if(i.column)for(var s=0;s<i.column.length;s++){var l={field:(0,w.qkm)(0,i.column[s]).charAt(0),operator:this.getFilterOperator(i.criteria[s]),value:i.value[s].toString().split("*").join(""),predicate:i.predicates&&i.predicates[s],type:i.dataType&&i.dataType[s]};n.push(l)}for(var h=0;h<n.length-1;h++)n[h].field===n[h+1].field&&(n[h].predicate||(n[h].predicate="or"),n[h+1].predicate||(n[h+1].predicate="or"));this.parent.notify(E.WG,{predicates:n.length?n:void 0,range:i.filterRange,sIdx:r,isInternal:!0})}this.parent.sortCollection&&this.parent.notify(w.Aed,null)}},o.prototype.getFilterOperator=function(t){switch(t){case"BeginsWith":t="startswith";break;case"Less":t="lessthan";break;case"EndsWith":t="endswith";break;case"Equal":t="equal";break;case"Notequal":t="notEqual";break;case"Greater":t="greaterthan";break;case"Contains":t="contains";break;case"LessOrEqual":t="lessthanorequal";break;case"GreaterOrEqual":t="greaterthanorequal";break}return t},o.prototype.beforeInsertHandler=function(t){if(t.modelType==="Column"){var e=(0,a.o8)(t.activeSheetIndex)?this.parent.activeSheetIndex:t.activeSheetIndex;if(this.filterRange.size&&this.filterRange.has(e)){var i=this.filterRange.get(e).range;(this.isFilterCell(e,i[0],t.index)||t.index<i[1])&&(i[3]+=t.model.length,t.index<=i[1]&&(i[1]+=t.model.length),this.filterCollection.get(e).forEach(function(h){var c=(0,w.ugT)(h.field);t.index<=c&&(h.field=(0,w.AH9)(c+t.model.length+1))}),this.parent.sortCollection&&this.parent.sortCollection.forEach(function(h){h.sheetIndex===e&&t.index<=h.columnIndex&&(h.columnIndex+=t.model.length)}),this.getFilteredCollection())}}else if(t.modelType==="Sheet"){for(var r=!1,n=0,s=Array.from(this.filterRange.keys()).sort().reverse();n<s.length;n++){var l=s[n];t.index<=l&&(r=!0,this.filterRange.set(l+t.model.length,this.filterRange.get(l)),this.filterRange.delete(l),this.filterCollection.set(l+t.model.length,this.filterCollection.get(l)),this.filterCollection.delete(l))}this.parent.sortCollection&&this.parent.sortCollection.forEach(function(h){t.index<=h.sheetIndex&&(h.sheetIndex+=t.model.length)}),r&&this.getFilteredCollection()}},o.prototype.beforeDeleteHandler=function(t){if(t.modelType==="Column"){var e=this.parent.activeSheetIndex;if(this.filterRange.size&&this.filterRange.has(e)){var i=!0,r=this.filterRange.get(e).range;if(t.start>=r[1]&&t.end<=r[3]?r[3]-=t.end-t.start+1:t.start<r[1]&&t.end<r[1]?(r[1]-=t.end-t.start+1,r[3]-=t.end-t.start+1):t.start<r[1]&&t.end>r[1]&&t.end<r[3]?(r[1]=t.start,r[3]-=t.end-t.start+1):i=!1,i){for(var n=this.filterCollection.get(e),s=void 0,l=n.length-1;l>=0;l--){var h=(0,w.ugT)(n[l].field);t.end<h?n[l].field=(0,w.AH9)(h-(t.end-t.start+1)+1):t.start<=h&&t.end>=h&&(s=!0,n.splice(l,1))}var c=this.parent.sortCollection;if(c){for(var l=0;l<c.length;l++)if(c[l].sheetIndex===e){if(t.end<c[l].columnIndex){c[l].columnIndex=c[l].columnIndex-(t.end-t.start+1);break}else if(t.start<=c[l].columnIndex&&t.end>=c[l].columnIndex){c.splice(l,1);break}}}r.some(function(u){return u<0})?(this.removeFilter(e,!0,!0),t.refreshSheet=!0):s&&(n&&n.length?(this.reapplyFilterHandler(!0,!0),t.refreshSheet=!1):(this.clearFilterHandler({preventRefresh:!0}),t.refreshSheet=!0)),this.getFilteredCollection()}}}},o.prototype.deleteSheetHandler=function(t){if((0,a.o8)(t.sheetIndex))this.filterRange.get(this.parent.activeSheetIndex)&&(this.filterRange.delete(this.parent.activeSheetIndex),this.filterCollection.delete(this.parent.activeSheetIndex));else{for(var e=void 0,i=0,r=Array.from(this.filterRange.keys()).sort().reverse();i<r.length;i++){var n=r[i];e=!0,t.sheetIndex===n?(this.filterRange.delete(n),this.filterCollection.delete(n)):t.sheetIndex<n?(this.filterRange.set(n-1,this.filterRange.get(n)),this.filterRange.delete(n),this.filterCollection.set(n-1,this.filterCollection.get(n)),this.filterCollection.delete(n)):e=!1}var s=this.parent.sortCollection;if(s)for(var l=s.length-1;l>=0;l--)t.sheetIndex===s[l].sheetIndex?s.splice(l,1):t.sheetIndex<s[l].sheetIndex&&(s[l].sheetIndex-=1);e&&this.getFilteredCollection()}},o.prototype.clearHandler=function(t){var e=this.parent.getAddressInfo(t.range);if(this.filterRange.has(e.sheetIndex)){var i=this.filterRange.get(e.sheetIndex).range.slice();(0,w.Z2v)(e.indices,i[0],i[1])&&(0,w.Z2v)(e.indices,i[0],i[3])&&this.removeFilter(e.sheetIndex)}},o.prototype.duplicateSheetFilterHandler=function(t){this.filterCollection.has(t.sheetIndex)&&this.filterCollection.set(t.newSheetIndex,this.filterCollection.get(t.sheetIndex)),this.filterRange.has(t.sheetIndex)&&this.filterRange.set(t.newSheetIndex,this.filterRange.get(t.sheetIndex))},o}(),xd=function(){function o(t){this.pictureCount=1,this.parent=t,this.addEventListener(),this.renderImageUpload()}return o.prototype.addEventListener=function(){this.parent.on(E.rL,this.insertImage,this),this.parent.on(E.LV,this.refreshImgElem,this),this.parent.on(E.eh,this.refreshImgCellObj,this),this.parent.on(E.oE,this.createImageElement,this),this.parent.on(E.ao,this.deleteImage,this),this.parent.on(E.z0,this.refreshInsDelImagePosition,this)},o.prototype.renderImageUpload=function(){var t=this.parent.element.appendChild(this.parent.createElement("input",{id:this.parent.element.id+"_imageUpload",styles:"display: none;",attrs:{type:"file",accept:".image, .jpg, .png, .gif ,jpeg",name:"fileUpload"}}));t.onchange=this.imageSelect.bind(this)},o.prototype.imageSelect=function(t){var e=t.target.files[0];!e||(e.type.includes("image")?this.insertImage({file:e}):this.parent.serviceLocator.getService(Yt).show({content:this.parent.serviceLocator.getService("spreadsheetLocale").getConstant("UnsupportedFile"),width:"300"}),t.target.value="")},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(E.rL,this.insertImage),this.parent.off(E.eh,this.refreshImgCellObj),this.parent.off(E.oE,this.createImageElement),this.parent.off(E.ao,this.deleteImage),this.parent.off(E.z0,this.refreshInsDelImagePosition))},o.prototype.insertImage=function(t,e){var i=this;this.binaryStringVal(t).then(function(r){return i.createImageElement({options:{src:r},range:e,isPublic:!0})})},o.prototype.binaryStringVal=function(t){return new Promise(function(e,i){var r=new FileReader;r.readAsDataURL(t.file),r.onload=function(){return e(r.result)},r.onerror=function(n){return i(n)}})},o.prototype.createImageElement=function(t){var e=t.range?t.range.indexOf("!")>0?t.range.split("!")[1]:t.range.split("!")[0]:this.parent.getActiveSheet().selectedRange,i=t.range&&t.range.indexOf("!")>0?(0,w.Q8D)(this.parent,t.range.split("!")[0]):this.parent.activeSheetIndex,r=this.parent.serviceLocator.getService(ef),n=t.options.imageId?t.options.imageId:this.parent.element.id+"_overlay_picture_"+this.pictureCount,s=(0,w.dK5)(e),l=(0,a.o8)(i)?this.parent.getActiveSheet():this.parent.sheets[i];if(!document.getElementById(n)){var h={requestType:"beforeInsertImage",range:l.name+"!"+e,imageData:t.options.src,sheetIndex:i};if(t.isPublic&&this.parent.notify("actionBegin",{eventArgs:h,action:"beforeInsertImage"}),!h.cancel){var c=r.insertOverlayElement(n,e,i);c.style.backgroundImage="url('"+t.options.src+"')",(t.options.height||t.options.left)&&(c.style.height=t.options.height+"px",c.style.width=t.options.width+"px",c.style.top=t.options.top+"px",c.style.left=t.options.left+"px"),(l.frozenRows||l.frozenColumns)&&r.adjustFreezePaneSize(t.options,c,e),t.options.imageId||this.pictureCount++;var u={src:t.options.src,id:n,height:parseFloat(c.style.height.replace("px","")),width:parseFloat(c.style.width.replace("px","")),top:l.frozenRows||l.frozenColumns?s[0]?(0,w.EB_)(l,0,s[0]-1):0:parseFloat(c.style.top.replace("px","")),left:l.frozenRows||l.frozenColumns?s[1]?(0,w.pGm)(l,0,s[1]-1):0:parseFloat(c.style.left.replace("px",""))};this.parent.setUsedRange(s[0],s[1]),(t.isPublic||t.isUndoRedo)&&this.parent.notify(w.QLx,{options:[u],range:l.name+"!"+e});var p=(0,w.$Su)(s[0],s[1],l);p.image[p.image.length-1].id||(p.image[p.image.length-1].id=u.id),!t.isUndoRedo&&t.isPublic&&(h={requestType:"insertImage",range:l.name+"!"+e,imageHeight:t.options.height?t.options.height:300,imageWidth:t.options.width?t.options.width:400,imageData:t.options.src,id:n,sheetIndex:i},this.parent.notify("actionComplete",{eventArgs:h,action:"insertImage"}))}}},o.prototype.refreshImgElem=function(){var t=document.getElementsByClassName("e-ss-overlay-active")[0];t&&(0,a.IV)([t],"e-ss-overlay-active")},o.prototype.refreshInsDelImagePosition=function(t){for(var e=t.count,i=t.sheetIdx,r=this.parent.sheets[i],n,s=(0,w.$Su)(t.rowIdx,t.colIdx,r),l=s.image.length,h,c,u=0;u<l;u++)n=document.getElementById(s.image[u].id),h=t.type==="Row"?t.status==="insert"?s.image[u].top+e*20:s.image[u].top-e*20:s.image[u].top,c=t.type==="Column"?t.status==="insert"?s.image[u].left+e*64:s.image[u].left-e*64:s.image[u].left,s.image[u].top=h,s.image[u].left=c,n.style.top=h+"px",n.style.left=c+"px"},o.prototype.refreshImgCellObj=function(t){var e=this.parent.getActiveSheet(),i=(0,w.$Su)(t.prevRowIdx,t.prevColIdx,e),r=(0,w.$Su)(t.currentRowIdx,t.currentColIdx,e),n=i?i.image:[],s,l,h=n&&n.length?n.length:0;if(i&&i.image&&n.length>0){for(var c=0;c<h;c++)n[c]&&n[c].id===t.id&&(s=n[c],s.height=t.currentHeight,s.width=t.currentWidth,s.top=t.currentTop,s.left=t.currentLeft,n.splice(c,1));if(r&&r.image&&(l=r.image,s&&l.push(s)),l?(0,w.Jxt)(t.currentRowIdx,t.currentColIdx,e,{image:l},!0):(0,w.Jxt)(t.currentRowIdx,t.currentColIdx,e,{image:[s]},!0),t.requestType==="imageRefresh"&&!t.isUndoRedo){var u={requestType:"imageRefresh",currentRowIdx:t.currentRowIdx,currentColIdx:t.currentColIdx,prevRowIdx:t.prevRowIdx,prevColIdx:t.prevColIdx,prevTop:t.prevTop,prevLeft:t.prevLeft,currentTop:t.currentTop,currentLeft:t.currentLeft,currentHeight:t.currentHeight,currentWidth:t.currentWidth,prevHeight:t.prevHeight,prevWidth:t.prevWidth,id:t.id,sheetIdx:this.parent.activeSheetIndex};this.parent.notify("actionComplete",{eventArgs:u,action:"imageRefresh"})}}},o.prototype.deleteImage=function(t){var e=this.parent.getActiveSheet(),i=document.getElementById(t.id),r,n,s;if(i){var l=void 0,h=void 0;if(e.frozenRows||e.frozenColumns){var c=i.getBoundingClientRect();l={clientY:c.top},h={clientX:c.left},c.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(l.target=this.parent.getColumnHeaderContent()),c.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(h.target=this.parent.getRowHeaderTable())}else l={clientY:i.offsetTop,isImage:!0},h={clientX:i.offsetLeft,isImage:!0};if(this.parent.notify(E.M7,l),this.parent.notify(E.oU,h),r=l.clientY,n=h.clientX,s=e.name+"!"+(0,w.qkm)(r,n),!t.preventEventTrigger){var u={address:s,cancel:!1};if(this.parent.notify(w.ya2,{action:"deleteImage",eventArgs:u}),u.cancel)return}document.getElementById(t.id).remove()}else{var p=t.range?t.range.indexOf("!")>0?t.range.split("!")[1]:t.range.split("!")[0]:this.parent.getActiveSheet().selectedRange,f=t.range&&t.range.indexOf("!")>0?(0,w.Q8D)(this.parent,t.range.split("!")[0]):this.parent.activeSheetIndex,g=(0,w.dK5)(p);r=g[0],n=g[1],e=this.parent.sheets[f]}for(var C=(0,w.$Su)(r,n,e),L=C.image,D=L.length,R={},B=0;B<D;B++)L[B].id===t.id&&(R=L.splice(B,1)[0]);(0,w.Jxt)(r,n,e,{image:L},!0),t.preventEventTrigger||this.parent.notify(E.Av,{action:"deleteImage",eventArgs:{address:s,id:R.id,imageData:R.src,cancel:!1}})},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.getModuleName=function(){return"spreadsheetImage"},o}(),Mr;(function(o){o.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},o.axisTitleFont={size:"14px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},o.chartTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},o.chartSubTitleFont={size:"11px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},o.crosshairLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},o.tooltipLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},o.legendLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},o.legendTitleFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},o.stripLineLabelFont={size:"12px",fontWeight:"Regular",color:"#353535",fontStyle:"Normal",fontFamily:"Segoe UI"},o.stockEventFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"}})(Mr||(Mr={}));function sg(o){var t;switch(o){case"Fabric":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"Bootstrap4":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"Bootstrap":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"HighContrastLight":case"Highcontrast":case"HighContrast":t=["#79ECE4","#E98272","#DFE6B6","#C6E773","#BA98FF","#FA83C3","#00C27A","#43ACEF","#D681EF","#D8BC6E"];break;case"MaterialDark":t=["#9ECB08","#56AEFF","#C57AFF","#61EAA9","#EBBB3E","#F45C5C","#8A77FF","#63C7FF","#FF84B0","#F7C928"];break;case"FabricDark":t=["#4472c4","#ed7d31","#ffc000","#70ad47","#5b9bd5","#c1c1c1","#6f6fe2","#e269ae","#9e480e","#997300"];break;case"BootstrapDark":t=["#a16ee5","#f7ce69","#55a5c2","#7ddf1e","#ff6ea6","#7953ac","#b99b4f","#407c92","#5ea716","#b91c52"];break;case"Tailwind":t=["#5A61F6","#65A30D","#334155","#14B8A6","#8B5CF6","#0369A1","#F97316","#9333EA","#F59E0B","#15803D"];break;case"TailwindDark":t=["#8B5CF6","#22D3EE","#F87171","#4ADE80","#E879F9","#FCD34D","#F97316","#2DD4BF","#F472B6","#10B981"];break;case"Bootstrap5":t=["#262E0B","#668E1F","#AF6E10","#862C0B","#1F2D50","#64680B","#311508","#4C4C81","#0C7DA0","#862C0B"];break;case"Bootstrap5Dark":t=["#5ECB9B","#A860F1","#EBA844","#557EF7","#E9599B","#BFC529","#3BC6CF","#7A68EC","#74B706","#EA6266"];break;case"FluentDark":t=["#8AB113","#2A72D5","#43B786","#584EC6","#E85F9C","#6E7A89","#EA6266","#EBA844","#26BC7A","#BC4870"];break;case"Fluent":t=["#614570","#4C6FB1","#CC6952","#3F579A","#4EA09B","#6E7A89","#D4515C","#E6AF5D","#639751","#9D4D69"];break;default:t=["#00bdae","#404041","#357cd2","#e56590","#f8b883","#70ad47","#dd8abd","#7f84e8","#7bb4eb","#ea7a57"];break}return t}function ag(o){var t,e=o==="MaterialDark"?"#383838":o==="FabricDark"?"#242424":"#1b1b1b";switch(o){case"HighContrastLight":case"Highcontrast":case"HighContrast":t={axisLabel:"#ffffff",axisTitle:"#ffffff",axisLine:"#ffffff",majorGridLine:"#BFBFBF",minorGridLine:"#969696",majorTickLine:"#BFBFBF",minorTickLine:"#969696",chartTitle:"#ffffff",legendLabel:"#ffffff",background:"#000000",areaBorder:"#ffffff",errorBar:"#ffffff",crosshairLine:"#ffffff",crosshairFill:"#ffffff",crosshairLabel:"#000000",tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696",markerShadow:"#BFBFBF",selectionRectFill:"rgba(255, 217, 57, 0.3)",selectionRectStroke:"#ffffff",selectionCircleStroke:"#FFD939"};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":t={axisLabel:"#DADADA",axisTitle:"#ffffff",axisLine:" #6F6C6C",majorGridLine:"#414040",minorGridLine:"#514F4F",majorTickLine:"#414040",minorTickLine:" #4A4848",chartTitle:"#ffffff",legendLabel:"#DADADA",background:e,areaBorder:" #9A9A9A",errorBar:"#ffffff",crosshairLine:"#F4F4F4",crosshairFill:"#F4F4F4",crosshairLabel:"#282727",tooltipFill:"#F4F4F4",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A",markerShadow:null,selectionRectFill:"rgba(56,169,255, 0.1)",selectionRectStroke:"#38A9FF",selectionCircleStroke:"#282727"};break;case"Bootstrap4":t={axisLabel:"#212529",axisTitle:"#212529",axisLine:"#CED4DA",majorGridLine:"#CED4DA",minorGridLine:"#DEE2E6",majorTickLine:"#ADB5BD",minorTickLine:"#CED4DA",chartTitle:"#212529",legendLabel:"#212529",background:"#FFFFFF",areaBorder:"#DEE2E6",errorBar:"#000000",crosshairLine:"#6C757D",crosshairFill:"#495057",crosshairLabel:"#FFFFFF",tooltipFill:"#020202",tooltipBoldLabel:"rgba(255,255,255)",tooltipLightLabel:"rgba(255,255,255, 0.9)",tooltipHeaderLine:"rgba(255,255,255, 0.2)",markerShadow:null,selectionRectFill:"rgba(255,255,255, 0.1)",selectionRectStroke:"rgba(0, 123, 255)",selectionCircleStroke:"#495057"};break;case"Tailwind":t={axisLabel:"#6B728",axisTitle:"#374151",axisLine:" #D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#374151",legendLabel:"#374151",background:"rgba(255,255,255, 0.0)",areaBorder:" #E5E7EB",errorBar:"#374151",crosshairLine:"#1F2937",crosshairFill:"#111827",crosshairLabel:"#F9FAFB",tooltipFill:"#111827",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;case"TailwindDark":t={axisLabel:"#9CA3AF",axisTitle:"#9CA3AF",axisLine:" #4B5563",majorGridLine:"#374151",minorGridLine:"#374151",majorTickLine:"#4B5563",minorTickLine:" #4B5563",chartTitle:"#D1D5DB",legendLabel:"#D1D5DB",background:"#1f2937",areaBorder:" #374151",errorBar:"#ffffff",crosshairLine:"#9CA3AF",crosshairFill:"#F9FAFB",crosshairLabel:"#1F2937",tooltipFill:"#F9FAFB",tooltipBoldLabel:"#6B7280",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF",markerShadow:null,selectionRectFill:"rgba(34,211,238, 0.1)",selectionRectStroke:"#22D3EE",selectionCircleStroke:"#282727"};break;case"Bootstrap5":t={axisLabel:"#495057",axisTitle:"#343A40",axisLine:"#D1D5DB",majorGridLine:"#E5E7EB",minorGridLine:"#E5E7EB",majorTickLine:"#D1D5DB",minorTickLine:" #D1D5DB",chartTitle:"#343A40",legendLabel:"#343A40",background:"#FFFFFF",areaBorder:" #DEE2E6",errorBar:"#1F2937",crosshairLine:"#1F2937",crosshairFill:"#212529",crosshairLabel:"#F9FAFB",tooltipFill:"#212529",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#9CA3AF",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;case"Bootstrap5Dark":t={axisLabel:"#CED4DA",axisTitle:"#E9ECEF",axisLine:"#495057",majorGridLine:"#343A40",minorGridLine:"#343A40",majorTickLine:"#495057",minorTickLine:" #495057",chartTitle:"#E9ECEF",legendLabel:"#E9ECEF",background:"#212529",areaBorder:" #444C54",errorBar:"#ADB5BD",crosshairLine:"#ADB5BD",crosshairFill:"#E9ECEF",crosshairLabel:"#212529",tooltipFill:"#E9ECEF",tooltipBoldLabel:"#212529",tooltipLightLabel:"#212529",tooltipHeaderLine:"#ADB5BD",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;case"Fluent":t={axisLabel:"#3B3A39",axisTitle:"#201F1E",axisLine:"#D2D0CE",majorGridLine:"#EDEBE9",minorGridLine:"#EDEBE9",majorTickLine:"#D2D0CE",minorTickLine:" #D2D0CE",chartTitle:"#201F1E",legendLabel:"#323130",background:"transparent",areaBorder:"#EDEBE9",errorBar:"#A19F9D",crosshairLine:"#A19F9D",crosshairFill:"#FFFFFF",crosshairLabel:"#323130",tooltipFill:"#FFFFFF",tooltipBoldLabel:"#323130",tooltipLightLabel:"#323130",tooltipHeaderLine:"#D2D0CE",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;case"FluentDark":t={axisLabel:"#C8C6C4",axisTitle:"#F3F2F1",axisLine:"#3B3A39",majorGridLine:"#414040",minorGridLine:"#414040",majorTickLine:"#3B3A39",minorTickLine:"#3B3A39",chartTitle:"#F3F2F1",legendLabel:"#D2D0CE",background:"transparent",areaBorder:"#414040",errorBar:"#D2D0CE",crosshairLine:"#D2D0CE",crosshairFill:"#252423",crosshairLabel:"#F3F2F1",tooltipFill:"#252423",tooltipBoldLabel:"#F3F2F1",tooltipLightLabel:"#F3F2F1",tooltipHeaderLine:"#3B3A39",markerShadow:null,selectionRectFill:"rgba(79,70,229, 0.1)",selectionRectStroke:"#4F46E5",selectionCircleStroke:"#6B7280"};break;default:t={axisLabel:"#686868",axisTitle:"#424242",axisLine:"#b5b5b5",majorGridLine:"#dbdbdb",minorGridLine:"#eaeaea",majorTickLine:"#b5b5b5",minorTickLine:"#d6d6d6",chartTitle:"#424242",legendLabel:"#353535",background:"#FFFFFF",areaBorder:"Gray",errorBar:"#000000",crosshairLine:"#4f4f4f",crosshairFill:"#4f4f4f",crosshairLabel:"#e5e5e5",tooltipFill:"#000816",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff",markerShadow:null,selectionRectFill:"rgba(41, 171, 226, 0.1)",selectionRectStroke:"#29abe2",selectionCircleStroke:"#29abe2"};break}return t}function rR(o){var t;switch(o){case"HighContrastLight":t={backRect:"#333",thumb:"#bfbfbf",circle:"#fff",circleHover:"#685708",arrow:"#333",grip:"#333",arrowHover:"#fff",backRectBorder:"#969696"};break;case"Bootstrap":t={backRect:"#f5f5f5",thumb:"#e6e6e6",circle:"#fff",circleHover:"#eee",arrow:"#8c8c8c",grip:"#8c8c8c"};break;case"Fabric":t={backRect:"#f8f8f8",thumb:"#eaeaea",circle:"#fff",circleHover:"#eaeaea",arrow:"#a6a6a6",grip:"#a6a6a6"};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":case"Bootstrap5Dark":case"TailwindDark":t={backRect:"#252423",thumb:"#323130",circle:"#484644",circleHover:"#323130",arrow:"#A19F9D",grip:"#A19F9D"};break;case"Fluent":t={backRect:"#F3F2F1",thumb:"#E1DFDD",circle:"#FFFFFF",circleHover:"#E1DFDD",arrow:"#605E5C",grip:"#605E5C"};break;case"FluentDark":t={backRect:"#252423",thumb:"#323130",circle:"#484644",circleHover:"#323130",arrow:"#A19F9D",grip:"#A19F9D"};break;default:t={backRect:"#f5f5f5",thumb:"#e0e0e0",circle:"#fff",circleHover:"#eee",arrow:"#9e9e9e",grip:"#9e9e9e"};break}return t}var wr=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),bt=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Ja=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)("Line")],t.prototype,"type",void 0),bt([(0,a.Z9)(null)],t.prototype,"color",void 0),bt([(0,a.Z9)(1)],t.prototype,"width",void 0),bt([(0,a.Z9)(null)],t.prototype,"length",void 0),bt([(0,a.Z9)("")],t.prototype,"dashArray",void 0),t}(a.rt),Pr=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)("Normal")],t.prototype,"fontStyle",void 0),bt([(0,a.Z9)("16px")],t.prototype,"size",void 0),bt([(0,a.Z9)("Normal")],t.prototype,"fontWeight",void 0),bt([(0,a.Z9)("")],t.prototype,"color",void 0),bt([(0,a.Z9)("Center")],t.prototype,"textAlignment",void 0),bt([(0,a.Z9)("Segoe UI")],t.prototype,"fontFamily",void 0),bt([(0,a.Z9)(1)],t.prototype,"opacity",void 0),bt([(0,a.Z9)("Trim")],t.prototype,"textOverflow",void 0),t}(a.rt),xr=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)("")],t.prototype,"color",void 0),bt([(0,a.Z9)(1)],t.prototype,"width",void 0),t}(a.rt),Tw=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)(0)],t.prototype,"x",void 0),bt([(0,a.Z9)(0)],t.prototype,"y",void 0),t}(a.rt),Lw=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Zz)({},xr)],t.prototype,"border",void 0),bt([(0,a.Z9)("transparent")],t.prototype,"background",void 0),bt([(0,a.Z9)(1)],t.prototype,"opacity",void 0),bt([(0,a.Z9)(null)],t.prototype,"backgroundImage",void 0),bt([(0,a.Z9)(null)],t.prototype,"width",void 0),t}(a.rt),sc=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)(10)],t.prototype,"left",void 0),bt([(0,a.Z9)(10)],t.prototype,"right",void 0),bt([(0,a.Z9)(10)],t.prototype,"top",void 0),bt([(0,a.Z9)(10)],t.prototype,"bottom",void 0),t}(a.rt),kw=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)(0)],t.prototype,"left",void 0),bt([(0,a.Z9)(0)],t.prototype,"right",void 0),bt([(0,a.Z9)(0)],t.prototype,"top",void 0),bt([(0,a.Z9)(0)],t.prototype,"bottom",void 0),t}(a.rt),Ed=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)(!0)],t.prototype,"enable",void 0),bt([(0,a.Z9)(1e3)],t.prototype,"duration",void 0),bt([(0,a.Z9)(0)],t.prototype,"delay",void 0),t}(a.rt),og=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)(0)],t.prototype,"series",void 0),bt([(0,a.Z9)(0)],t.prototype,"point",void 0),t}(a.rt),Iw=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)(0)],t.prototype,"topLeft",void 0),bt([(0,a.Z9)(0)],t.prototype,"topRight",void 0),bt([(0,a.Z9)(0)],t.prototype,"bottomLeft",void 0),bt([(0,a.Z9)(0)],t.prototype,"bottomRight",void 0),t}(a.rt),Dw=function(){function o(t,e){this.series=t,this.point=e}return o}(),lg=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)(null)],t.prototype,"fill",void 0),bt([(0,a.Zz)({color:"transparent",width:0},xr)],t.prototype,"border",void 0),bt([(0,a.Z9)("Gap")],t.prototype,"mode",void 0),t}(a.rt),Ow=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)(!1)],t.prototype,"enable",void 0),bt([(0,a.Z9)(null)],t.prototype,"minY",void 0),bt([(0,a.Z9)(null)],t.prototype,"maxY",void 0),bt([(0,a.Z9)(null)],t.prototype,"fill",void 0),t}(a.rt),hg=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)(!1)],t.prototype,"enable",void 0),bt([(0,a.Z9)(!0)],t.prototype,"enableMarker",void 0),bt([(0,a.Z9)(!1)],t.prototype,"shared",void 0),bt([(0,a.Z9)(null)],t.prototype,"fill",void 0),bt([(0,a.Z9)(null)],t.prototype,"header",void 0),bt([(0,a.Z9)(.75)],t.prototype,"opacity",void 0),bt([(0,a.Zz)(Mr.tooltipLabelFont,Pr)],t.prototype,"textStyle",void 0),bt([(0,a.Z9)(null)],t.prototype,"format",void 0),bt([(0,a.Z9)(null)],t.prototype,"template",void 0),bt([(0,a.Z9)(!0)],t.prototype,"enableAnimation",void 0),bt([(0,a.Z9)(300)],t.prototype,"duration",void 0),bt([(0,a.Z9)(1e3)],t.prototype,"fadeOutDuration",void 0),bt([(0,a.Z9)("Move")],t.prototype,"fadeOutMode",void 0),bt([(0,a.Z9)(!1)],t.prototype,"enableTextWrap",void 0),bt([(0,a.Zz)({color:"#cccccc",width:.5},xr)],t.prototype,"border",void 0),t}(a.rt),Rw=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)("Years")],t.prototype,"intervalType",void 0),bt([(0,a.Z9)(1)],t.prototype,"interval",void 0),bt([(0,a.Z9)(null)],t.prototype,"text",void 0),bt([(0,a.Z9)(!1)],t.prototype,"selected",void 0),t}(a.rt),nR=function(o){wr(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return bt([(0,a.Z9)(43)],t.prototype,"height",void 0),bt([(0,a.Z9)("Bottom")],t.prototype,"position",void 0),bt([(0,a.FE)([],Rw)],t.prototype,"periods",void 0),t}(a.rt),Is=function(){function o(t){this.svgLink="http://www.w3.org/2000/svg",this.rootId=t}return o.prototype.getOptionValue=function(t,e){return t[e]},o.prototype.createSvg=function(t){return(0,a.le)(t.id)&&(t.id=this.rootId+"_svg"),this.svgObj=document.getElementById(t.id),(0,a.le)(document.getElementById(t.id))&&(this.svgObj=document.createElementNS(this.svgLink,"svg")),this.svgObj=this.setElementAttributes(t,this.svgObj),this.setSVGSize(t.width,t.height),this.svgObj},o.prototype.setSVGSize=function(t,e){var i=document.getElementById(this.rootId),r=(0,a.le)(i)?null:i.getBoundingClientRect();(0,a.le)(this.width)||this.width<=0?this.svgObj.setAttribute("width",t?t.toString():r.width.toString()):this.svgObj.setAttribute("width",this.width.toString()),(0,a.le)(this.height)||this.height<=0?this.svgObj.setAttribute("height",e?e.toString():"450"):this.svgObj.setAttribute("height",this.height.toString())},o.prototype.drawPath=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"path")),e=this.setElementAttributes(t,e),e},o.prototype.drawLine=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"line")),e=this.setElementAttributes(t,e),e},o.prototype.drawRectangle=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"rect")),e=this.setElementAttributes(t,e),e},o.prototype.drawCircle=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"circle")),e=this.setElementAttributes(t,e),e},o.prototype.drawPolyline=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"polyline")),e=this.setElementAttributes(t,e),e},o.prototype.drawEllipse=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"ellipse")),e=this.setElementAttributes(t,e),e},o.prototype.drawPolygon=function(t){var e=document.getElementById(t.id);return e===null&&(e=document.createElementNS(this.svgLink,"polygon")),e=this.setElementAttributes(t,e),e},o.prototype.drawImage=function(t){var e=document.createElementNS(this.svgLink,"image");return e.setAttributeNS(null,"height",t.height.toString()),e.setAttributeNS(null,"width",t.width.toString()),e.setAttributeNS("http://www.w3.org/1999/xlink","href",t.href),e.setAttributeNS(null,"x",t.x.toString()),e.setAttributeNS(null,"y",t.y.toString()),e.setAttributeNS(null,"id",t.id),e.setAttributeNS(null,"visibility",t.visibility),(0,a.le)(this.getOptionValue(t,"clip-path"))||e.setAttributeNS(null,"clip-path",this.getOptionValue(t,"clip-path")),(0,a.le)(t.preserveAspectRatio)||e.setAttributeNS(null,"preserveAspectRatio",t.preserveAspectRatio),e},o.prototype.createText=function(t,e){var i=document.createElementNS(this.svgLink,"text");return i=this.setElementAttributes(t,i),(0,a.le)(e)||(i.textContent=e),i},o.prototype.createTSpan=function(t,e){var i=document.createElementNS(this.svgLink,"tspan");return i=this.setElementAttributes(t,i),(0,a.le)(e)||(i.textContent=e),i},o.prototype.createTitle=function(t){var e=document.createElementNS(this.svgLink,"title");return e.textContent=t,e},o.prototype.createDefs=function(){var t=document.createElementNS(this.svgLink,"defs");return t},o.prototype.createClipPath=function(t){var e=document.createElementNS(this.svgLink,"clipPath");return e=this.setElementAttributes(t,e),e},o.prototype.createForeignObject=function(t){var e=document.createElementNS(this.svgLink,"foreignObject");return e=this.setElementAttributes(t,e),e},o.prototype.createGroup=function(t){var e=document.createElementNS(this.svgLink,"g");return e=this.setElementAttributes(t,e),e},o.prototype.createPattern=function(t,e){var i=document.createElementNS(this.svgLink,e);return i=this.setElementAttributes(t,i),i},o.prototype.createRadialGradient=function(t,e,i){var r;if((0,a.le)(t[0].colorStop))r=t[0].color.toString();else{var n={id:this.rootId+"_"+e+"radialGradient",cx:i.cx+"%",cy:i.cy+"%",r:i.r+"%",fx:i.fx+"%",fy:i.fy+"%"};this.drawGradient("radialGradient",n,t),r="url(#"+this.rootId+"_"+e+"radialGradient)"}return r},o.prototype.createLinearGradient=function(t,e,i){var r;if((0,a.le)(t[0].colorStop))r=t[0].color.toString();else{var n={id:this.rootId+"_"+e+"linearGradient",x1:i.x1+"%",y1:i.y1+"%",x2:i.x2+"%",y2:i.y2+"%"};this.drawGradient("linearGradient",n,t),r="url(#"+this.rootId+"_"+e+"linearGradient)"}return r},o.prototype.drawGradient=function(t,e,i){var r=this.createDefs(),n=document.createElementNS(this.svgLink,t);n=this.setElementAttributes(e,n);for(var s=0;s<i.length;s++){var l=document.createElementNS(this.svgLink,"stop");l.setAttribute("offset",i[s].colorStop),l.setAttribute("stop-color",i[s].color),l.setAttribute("stop-opacity",i[s].opacity?i[s].opacity:"1"),(0,a.le)(i[s].style)||(l.style.cssText=i[s].style),n.appendChild(l)}return r.appendChild(n),r},o.prototype.drawClipPath=function(t){var e=this.createDefs(),i=this.createClipPath({id:t.id});t.id=t.id+"_Rect";var r=this.drawRectangle(t);return i.appendChild(r),e.appendChild(i),e},o.prototype.drawCircularClipPath=function(t){var e=this.createDefs(),i=this.createClipPath({id:t.id});t.id=t.id+"_Circle";var r=this.drawCircle(t);return i.appendChild(r),e.appendChild(i),e},o.prototype.setElementAttributes=function(t,e){for(var i=Object.keys(t),r=0;r<i.length;r++)i[r]==="style"?e.style.cssText=t[i[r]]:e.setAttribute(i[r],t[i[r]]);return e},o.prototype.createCanvas=function(){return null},o}(),cg=function(){function o(t){this.rootId=t}return o.prototype.getOptionValue=function(t,e){return t[e]},o.prototype.createCanvas=function(t){var e=document.createElement("canvas");return e.setAttribute("id",this.rootId+"_canvas"),this.ctx=e.getContext("2d"),this.canvasObj=e,this.setCanvasSize(t.width,t.height),this.canvasObj},o.prototype.setCanvasSize=function(t,e){var i=document.getElementById(this.rootId),r=(0,a.le)(i)?null:i.getBoundingClientRect();(0,a.le)(this.width)?this.canvasObj.setAttribute("width",t?t.toString():r.width.toString()):this.canvasObj.setAttribute("width",this.width.toString()),(0,a.le)(this.height)?this.canvasObj.setAttribute("height",e?e.toString():"450"):this.canvasObj.setAttribute("height",this.height.toString())},o.prototype.setAttributes=function(t){this.ctx.lineWidth=this.getOptionValue(t,"stroke-width");var e=this.getOptionValue(t,"stroke-dasharray");if(!(0,a.le)(e)){var i=e.split(",");this.ctx.setLineDash([parseInt(i[0],10),parseInt(i[1],10)])}this.ctx.strokeStyle=this.getOptionValue(t,"stroke")},o.prototype.drawLine=function(t){this.ctx.save(),this.ctx.beginPath(),this.ctx.lineWidth=this.getOptionValue(t,"stroke-width"),this.ctx.strokeStyle=t.stroke,this.ctx.moveTo(t.x1,t.y1),this.ctx.lineTo(t.x2,t.y2),this.ctx.stroke(),this.ctx.restore()},o.prototype.drawRectangle=function(t,e){var i=this.ctx,r=t.rx;return this.ctx.save(),this.ctx.beginPath(),e&&this.ctx.translate(e[0],e[1]),this.ctx.globalAlpha=this.getOptionValue(t,"opacity"),this.setAttributes(t),this.ctx.rect(t.x,t.y,t.width,t.height),r!==null&&r>=0?this.drawCornerRadius(t):(t.fill==="none"&&(t.fill="transparent"),this.ctx.fillStyle=t.fill,this.ctx.fillRect(t.x,t.y,t.width,t.height),this.ctx.stroke()),this.ctx.restore(),this.ctx=i,this.canvasObj},o.prototype.drawCornerRadius=function(t){var e=t.rx,i=t.x,r=t.y,n=t.width,s=t.height;t.fill==="none"&&(t.fill="transparent"),this.ctx.fillStyle=t.fill,n<2*e&&(e=n/2),s<2*e&&(e=s/2),this.ctx.beginPath(),this.ctx.moveTo(i+n-e,r),this.ctx.arcTo(i+n,r,i+n,r+s,e),this.ctx.arcTo(i+n,r+s,i,r+s,e),this.ctx.arcTo(i,r+s,i,r,e),this.ctx.arcTo(i,r,i+n,r,e),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke()},o.prototype.drawPath=function(t,e){var i=t.d,r=i.split(" "),n=this.getOptionValue(t,"stroke-width"),s=this.ctx,l=!0;this.ctx.save(),this.ctx.beginPath(),e&&this.ctx.translate(e[0],e[1]),this.ctx.globalAlpha=t.opacity?t.opacity:this.getOptionValue(t,"fill-opacity"),this.setAttributes(t);for(var h=0;h<r.length;h=h+3){var c=parseFloat(r[h+1]),u=parseFloat(r[h+2]);switch(r[h]){case"M":!t.innerR&&!t.cx&&this.ctx.moveTo(c,u);break;case"L":t.innerR||this.ctx.lineTo(c,u);break;case"Q":var p=parseFloat(r[h+3]),f=parseFloat(r[h+4]);this.ctx.quadraticCurveTo(c,u,p,f),h=h+2;break;case"C":var g=parseFloat(r[h+3]),C=parseFloat(r[h+4]),L=parseFloat(r[h+5]),D=parseFloat(r[h+6]);this.ctx.bezierCurveTo(c,u,g,C,L,D),h=h+4;break;case"A":t.innerR?l&&(this.ctx.arc(t.x,t.y,t.radius,t.start,t.end,t.counterClockWise),this.ctx.arc(t.x,t.y,t.innerR,t.end,t.start,!t.counterClockWise),l=!1):t.cx?this.ctx.arc(t.cx,t.cy,t.radius,0,2*Math.PI,t.counterClockWise):(this.ctx.moveTo(t.x,t.y),this.ctx.arc(t.x,t.y,t.radius,t.start,t.end,t.counterClockWise),this.ctx.lineTo(t.x,t.y)),h=h+5;break;case"z":case"Z":this.ctx.closePath(),h=h-2;break}}return t.fill!=="none"&&t.fill!==void 0&&(this.ctx.fillStyle=t.fill,this.ctx.fill()),n>0&&this.ctx.stroke(),this.ctx.restore(),this.ctx=s,this.canvasObj},o.prototype.createText=function(t,e,i,r,n,s){var l=this.getOptionValue(t,"font-weight");!(0,a.le)(l)&&l.toLowerCase()==="regular"&&(l="normal");var h=this.getOptionValue(t,"font-size"),c=this.getOptionValue(t,"font-family"),u=this.getOptionValue(t,"font-style").toLowerCase(),p=u+" "+l+" "+h+" "+c,f=this.getOptionValue(t,"text-anchor"),g=t.opacity!==void 0?t.opacity:1;if(f==="middle"&&(f="center"),this.ctx.save(),this.ctx.fillStyle=t.fill,this.ctx.font=p,this.ctx.textAlign=f,this.ctx.globalAlpha=g,t.baseline&&(this.ctx.textBaseline=t.baseline),!s){var C=0;this.ctx.translate(t.x+C/2+(i||0),t.y+(r||0)),this.ctx.rotate(t.labelRotation*Math.PI/180)}return this.ctx.fillText(e,s?t.x:0,s?n:0),this.ctx.restore(),this.canvasObj},o.prototype.drawCircle=function(t,e){var i=this.ctx;return this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(t.cx,t.cy,t.r,0,2*Math.PI),this.ctx.fillStyle=t.fill,this.ctx.globalAlpha=t.opacity,this.ctx.fill(),e&&this.ctx.translate(e[0],e[1]),this.setAttributes(t),this.ctx.stroke(),this.ctx.restore(),this.ctx=i,this.canvasObj},o.prototype.drawPolyline=function(t){this.ctx.save(),this.ctx.beginPath();for(var e=t.points.split(" "),i=0;i<e.length-1;i++){var r=e[i].split(","),n=parseFloat(r[0]),s=parseFloat(r[1]);i===0?this.ctx.moveTo(n,s):this.ctx.lineTo(n,s)}this.ctx.lineWidth=this.getOptionValue(t,"stroke-width"),this.ctx.strokeStyle=t.stroke,this.ctx.stroke(),this.ctx.restore()},o.prototype.drawEllipse=function(t,e){var i=this.ctx,r=Math.max(t.rx,t.ry),n=t.rx/r,s=t.ry/r;this.ctx.save(),this.ctx.beginPath(),this.ctx.translate(t.cx,t.cy),e&&this.ctx.translate(e[0],e[1]),this.ctx.save(),this.ctx.scale(n,s),this.ctx.arc(0,0,r,0,2*Math.PI,!1),this.ctx.fillStyle=t.fill,this.ctx.fill(),this.ctx.restore(),this.ctx.lineWidth=this.getOptionValue(t,"stroke-width"),this.ctx.strokeStyle=t.stroke,this.ctx.stroke(),this.ctx.restore(),this.ctx=i},o.prototype.drawImage=function(t){this.ctx.save();var e=new Image;(0,a.le)(t.href)||(e.src=t.href,this.ctx.drawImage(e,t.x,t.y,t.width,t.height)),this.ctx.restore()},o.prototype.createLinearGradient=function(t){var e;(0,a.le)(t[0].colorStop)||(e=this.ctx.createLinearGradient(0,0,0,this.canvasObj.height));var i=this.setGradientValues(t,e);return i},o.prototype.createRadialGradient=function(t){var e;(0,a.le)(t[0].colorStop)||(e=this.ctx.createRadialGradient(0,0,0,0,0,this.canvasObj.height));var i=this.setGradientValues(t,e);return i},o.prototype.setGradientValues=function(t,e){var i;if((0,a.le)(t[0].colorStop))i=t[0].color.toString();else{for(var r=0;r<=t.length-1;r++){var n=t[r].color,s=t[r].colorStop.slice(0,-1),l=parseInt(s,10)/100;e.addColorStop(l,n)}i=e.toString()}return i},o.prototype.setElementAttributes=function(t,e){for(var i=Object.keys(t),r=Object.keys(t).map(function(s){return t[s]}),n=0;n<i.length;n++)e.setAttribute(i[n],r[n]);return null},o.prototype.updateCanvasAttributes=function(t){this.setElementAttributes(t,this.canvasObj);var e=this.ctx;if(!(0,a.le)(this.dataUrl)){var i=new Image;i.onload=function(){e.drawImage(i,0,0)},i.src=this.dataUrl}},o.prototype.clearRect=function(t){this.ctx.restore(),this.ctx.clearRect(t.x,t.y,t.width,t.height)},o.prototype.createGroup=function(){return null},o.prototype.drawClipPath=function(){return null},o.prototype.drawCircularClipPath=function(){return null},o.prototype.canvasClip=function(t){this.ctx.save(),this.ctx.fillStyle="transparent",this.ctx.rect(t.x,t.y,t.width,t.height),this.ctx.fill(),this.ctx.clip()},o.prototype.canvasRestore=function(){this.ctx.restore()},o.prototype.drawPolygon=function(){return null},o.prototype.createDefs=function(){return null},o.prototype.createClipPath=function(){return null},o.prototype.createSvg=function(){return null},o}();function Mw(o){var t;switch(o){case"Highcontrast":case"HighContrast":t={tooltipFill:"#ffffff",tooltipBoldLabel:"#000000",tooltipLightLabel:"#000000",tooltipHeaderLine:"#969696"};break;case"MaterialDark":case"FabricDark":case"BootstrapDark":t={tooltipFill:"#F4F4F4",tooltipBoldLabel:"#282727",tooltipLightLabel:"#333232",tooltipHeaderLine:"#9A9A9A"};break;case"Bootstrap4":t={tooltipFill:"#020202",tooltipBoldLabel:"rgba(255, 255, 255)",tooltipLightLabel:"rgba(255, 255, 255, 0.9)",tooltipHeaderLine:"rgba(255, 255, 255, 0.2)"};break;case"Tailwind":t={tooltipFill:"#111827",tooltipBoldLabel:"#D1D5DB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#6B7280"};break;case"TailwindDark":t={tooltipFill:"#F9FAFB",tooltipBoldLabel:"#6B7280",tooltipLightLabel:"#1F2937",tooltipHeaderLine:"#9CA3AF"};break;case"Bootstrap5":t={tooltipFill:"#212529",tooltipBoldLabel:"#F9FAFB",tooltipLightLabel:"#F9FAFB",tooltipHeaderLine:"#9CA3AF"};break;case"Bootstrap5Dark":t={tooltipFill:"#E9ECEF",tooltipBoldLabel:"#212529",tooltipLightLabel:"#212529",tooltipHeaderLine:"#ADB5BD"};break;case"Fluent":t={tooltipFill:"#FFFFFF",tooltipBoldLabel:"#323130",tooltipLightLabel:"#323130",tooltipHeaderLine:"#D2D0CE"};break;case"FluentDark":t={tooltipFill:"#252423",tooltipBoldLabel:"#F3F2F1",tooltipLightLabel:"#F3F2F1",tooltipHeaderLine:"#3B3A39"};break;default:t={tooltipFill:"#000816",tooltipBoldLabel:"#ffffff",tooltipLightLabel:"#dbdbdb",tooltipHeaderLine:"#ffffff"};break}return t}var ug=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();function Pt(o,t){var e=o||"",i=document.getElementById("chartmeasuretext");if(i===null&&(i=(0,a.az)("text",{id:"chartmeasuretext"}),document.body.appendChild(i)),typeof o=="string"&&(o.indexOf("<")>-1||o.indexOf(">")>-1)){for(var r=o.split(" "),n=0;n<r.length;n++)r[n].indexOf("<br/>")===-1&&(r[n]=r[n].replace(/[<>]/g,"&"));o=r.join(" ")}return i.innerHTML=e.indexOf("<br>")>-1||e.indexOf("<br/>")>-1?e:o,i.style.position="fixed",i.style.fontSize=t.size,i.style.fontWeight=t.fontWeight,i.style.fontStyle=t.fontStyle,i.style.fontFamily=t.fontFamily,i.style.visibility="hidden",i.style.top="-100",i.style.left="0",i.style.whiteSpace="nowrap",i.style.lineHeight="normal",new ni(i.clientWidth,i.clientHeight)}function pg(o,t,e,i,r){return i===void 0&&(i=0),r===void 0&&(r=0),o>=e.x-i&&o<=e.x+e.width+i&&t>=e.y-r&&t<=e.y+e.height+r}function Pw(o,t,e,i,r,n,s,l,h,c,u){u===void 0&&(u="");var p="",f=e.x,g=e.y,C=e.x+e.width,L=e.y+e.height;return n?(p=p.concat("M "+f+" "+(g+t)+" Q "+f+" "+g+" "+(f+o)+" "+g+"  L "+(C-o)+" "+g+" Q "+C+" "+g+" "+C+" "+(g+t)),p=p.concat(" L "+C+" "+(L-t)+" Q "+C+" "+L+" "+(C-o)+" "+L),r!==0&&(u==="RangeNavigator"?i.x-r>C/2?(p=p.concat(" L "+(i.x+r)+" "+L),p=p.concat(" L "+(h+r)+" "+(L+r)+" L "+i.x+" "+L)):(p=p.concat(" L "+i.x+" "+L),p=p.concat(" L "+(h-r)+" "+(L+r)+" L "+(i.x-r)+" "+L)):(p=p.concat(" L "+(i.x+r)+" "+L),p=p.concat(" L "+h+" "+(L+r)+" L "+(i.x-r)+" "+L))),i.x-r>f||r===0?p=p.concat(" L "+(f+o)+" "+L+" Q "+f+" "+L+" "+f+" "+(L-t)+" z"):p=p.concat(" L "+f+" "+(L+t)+" z")):s?(p=p.concat("M "+f+" "+(g+t)+" Q "+f+" "+g+" "+(f+o)+" "+g+" L "+(i.x-r)+" "+g),p=p.concat(" L "+h+" "+i.y),p=p.concat(" L "+(i.x+r)+" "+g),p=p.concat(" L "+(C-o)+" "+g+" Q "+C+" "+g+" "+C+" "+(g+t)),p=p.concat(" L "+C+" "+(L-t)+" Q "+C+" "+L+" "+(C-o)+" "+L+" L "+(f+o)+" "+L+" Q "+f+" "+L+" "+f+" "+(L-t)+" z")):l?(p=p.concat("M "+f+" "+(g+t)+" Q "+f+" "+g+" "+(f+o)+" "+g),p=p.concat(" L "+(C-o)+" "+g+" Q "+C+" "+g+" "+C+" "+(g+t)+" L "+C+" "+(i.y-r)),p=u==="RangeNavigator"?p.concat(" L "+(C+r)+" "+(c-r)):p.concat(" L "+(C+r)+" "+c),p=u==="RangeNavigator"?p.concat(" L "+C+" "+i.y):p.concat(" L "+C+" "+(i.y+r)),p=p.concat(" L "+C+" "+(L-t)+" Q "+C+" "+L+" "+(C-o)+" "+L),p=p.concat(" L "+(f+o)+" "+L+" Q "+f+" "+L+" "+f+" "+(L-t)+" z")):(p=p.concat("M "+(f+o)+" "+g+" Q "+f+" "+g+" "+f+" "+(g+t)+" L "+f+" "+(i.y-r)),p=u==="RangeNavigator"?p.concat(" L "+(f-r)+" "+(c-r)):p.concat(" L "+(f-r)+" "+c),p=u==="RangeNavigator"?p.concat(" L "+f+" "+i.y):p.concat(" L "+f+" "+(i.y+r)),p=p.concat(" L "+f+" "+(L-t)+" Q "+f+" "+L+" "+(f+o)+" "+L),p=p.concat(" L "+(C-o)+" "+L+" Q "+C+" "+L+" "+C+" "+(L-t)+" L "+C+" "+(g+t)+" Q "+C+" "+g+" "+(C-o)+" "+g+" z")),p}var ni=function(){function o(t,e){this.width=t,this.height=e}return o}(),ft=function(){function o(t,e,i,r){this.x=t,this.y=e,this.width=i,this.height=r}return o}(),Nw=function(){function o(t,e){this.isRight=e,this.isBottom=t}return o}(),dg=function(){function o(t){this.id=t}return o}(),fr=function(o){ug(t,o);function t(e,i,r,n,s,l,h,c){l===void 0&&(l="");var u=o.call(this,e)||this;return u.transform="",u.baseLine="auto",u.labelRotation=0,u.x=i,u.y=r,u.anchor=n,u.text=s,u.transform=l,u.baseLine=h,u.labelRotation=c,u}return t}(dg);function Nr(o){return document.getElementById(o)}function ac(o){var t=Nr(o);t&&(0,a.Od)(t)}function Bw(o,t,e,i,r,n){var s=new Is(""),l=Fw(o,e,t,r,i),h=s["draw"+l.functionName](l.renderOption);return h.setAttribute("aria-label",n),h}function Fw(o,t,e,i,r){var n,s="Path",l=t.width,h=t.height,c=o.x,u=o.y,p=o.x+-l/2,f=o.y+-h/2;switch(e){case"Circle":case"Bubble":s="Ellipse",(0,a.TS)(i,{rx:l/2,ry:h/2,cx:c,cy:u});break;case"Cross":n="M "+p+" "+u+" L "+(c+l/2)+" "+u+" M "+c+" "+(u+h/2)+" L "+c+" "+(u+-h/2),(0,a.TS)(i,{d:n});break;case"HorizontalLine":n="M "+p+" "+u+" L "+(c+l/2)+" "+u,(0,a.TS)(i,{d:n});break;case"VerticalLine":n="M "+c+" "+(u+h/2)+" L "+c+" "+(u+-h/2),(0,a.TS)(i,{d:n});break;case"Diamond":n="M "+p+" "+u+" L "+c+" "+(u+-h/2)+" L "+(c+l/2)+" "+u+" L "+c+" "+(u+h/2)+" L "+p+" "+u+" z",(0,a.TS)(i,{d:n});break;case"Rectangle":n="M "+p+" "+(u+-h/2)+" L "+(c+l/2)+" "+(u+-h/2)+" L "+(c+l/2)+" "+(u+h/2)+" L "+p+" "+(u+h/2)+" L "+p+" "+(u+-h/2)+" z",(0,a.TS)(i,{d:n});break;case"Triangle":n="M "+p+" "+(u+h/2)+" L "+c+" "+(u+-h/2)+" L "+(c+l/2)+" "+(u+h/2)+" L "+p+" "+(u+h/2)+" z",(0,a.TS)(i,{d:n});break;case"InvertedTriangle":n="M "+(c+l/2)+" "+(u-h/2)+" L "+c+" "+(u+h/2)+" L "+(c-l/2)+" "+(u-h/2)+" L "+(c+l/2)+" "+(u-h/2)+" z",(0,a.TS)(i,{d:n});break;case"Pentagon":for(var g=72,C=void 0,L=void 0,D=0;D<=5;D++)C=l/2*Math.cos(Math.PI/180*(D*g)),L=h/2*Math.sin(Math.PI/180*(D*g)),D===0?n="M "+(c+C)+" "+(u+L)+" ":n=n.concat("L "+(c+C)+" "+(u+L)+" ");n=n.concat("Z"),(0,a.TS)(i,{d:n});break;case"Image":s="Image",(0,a.TS)(i,{href:r,height:h,width:l,x:p,y:f});break}return{renderOption:i,functionName:s}}var er=function(o){ug(t,o);function t(e,i,r,n,s,l,h){var c=o.call(this,e)||this;return c.opacity=s,c.fill=i,c.stroke=n,c["stroke-width"]=r,c["stroke-dasharray"]=l,c.d=h,c}return t}(dg);function Hw(o,t,e,i){var r={},n=new Is("");r={id:o.id,x:o.x,y:o.y,fill:e,"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight,"text-anchor":o.anchor,transform:o.transform,opacity:t.opacity,"dominant-baseline":o.baseLine};var s=typeof o.text=="string"?o.text:o.text[0],l=n.createText(r,s);return l.style.fontFamily=t.fontFamily,l.style.fontStyle=t.fontStyle,l.style.fontSize=t.size,l.style.fontWeight=t.fontWeight,l.style.color=t.color,i.appendChild(l),l}var vr=function(){function o(t,e){this.x=t,this.y=e}return o}(),cl=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Tt=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Vw=function(o){cl(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Tt([(0,a.Z9)(null)],t.prototype,"size",void 0),Tt([(0,a.Z9)("")],t.prototype,"color",void 0),Tt([(0,a.Z9)("Segoe UI")],t.prototype,"fontFamily",void 0),Tt([(0,a.Z9)("Normal")],t.prototype,"fontWeight",void 0),Tt([(0,a.Z9)("Normal")],t.prototype,"fontStyle",void 0),Tt([(0,a.Z9)(1)],t.prototype,"opacity",void 0),t}(a.rt),zw=function(o){cl(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Tt([(0,a.Z9)("")],t.prototype,"color",void 0),Tt([(0,a.Z9)(1)],t.prototype,"width",void 0),Tt([(0,a.Z9)("")],t.prototype,"dashArray",void 0),t}(a.rt),_w=function(o){cl(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Tt([(0,a.Z9)(0)],t.prototype,"x",void 0),Tt([(0,a.Z9)(0)],t.prototype,"y",void 0),Tt([(0,a.Z9)(0)],t.prototype,"width",void 0),Tt([(0,a.Z9)(0)],t.prototype,"height",void 0),t}(a.rt),fg=function(o){cl(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Tt([(0,a.Z9)(0)],t.prototype,"x",void 0),Tt([(0,a.Z9)(0)],t.prototype,"y",void 0),t}(a.rt),jw=function(o){cl(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){this.allowServerDataBinding=!1,this.initPrivateVariable(),this.isCanvas||this.removeSVG(),this.createTooltipElement()},t.prototype.initPrivateVariable=function(){this.renderer=new Is(this.element.id),this.themeStyle=Mw(this.theme),this.formattedText=[],this.padding=5,this.areaMargin=10,this.isFirst=!0,this.markerPoint=[]},t.prototype.removeSVG=function(){var e=document.getElementById(this.element.id+"_svg"),i=document.getElementById(this.element.id+"parent_template");this.blazorTemplate&&(0,a.oL)(this.element.id+"parent_template_blazorTemplate"),e&&e.parentNode&&(0,a.Od)(e),i&&i.parentNode&&(0,a.Od)(i)},t.prototype.render=function(){if(this.fadeOuted=!1,this.template)this.updateTemplateFn(),this.createTemplate(this.areaBounds,this.location);else{this.renderText(this.isFirst);var e={cancel:!1,name:"tooltipRender",tooltip:this};this.trigger("tooltipRender",e);var i=this.renderTooltipElement(this.areaBounds,this.location);this.drawMarker(i.isBottom,i.isRight,this.markerSize)}this.trigger("loaded",{tooltip:this});var r=document.getElementById("chartmeasuretext");r&&(0,a.Od)(r),this.allowServerDataBinding=!0},t.prototype.createTooltipElement=function(){if(this.textElements=[],!this.template||this.shared){this.enableRTL&&this.element.setAttribute("dir","ltr");var e=this.renderer.createSvg({id:this.element.id+"_svg"});this.element.appendChild(e);var i=document.getElementById(this.element.id+"_group");i||(i=this.renderer.createGroup({id:this.element.id+"_group"}),i.setAttribute("transform","translate(0,0)")),e.appendChild(i);var r=this.renderer.drawPath({id:this.element.id+"_path","stroke-width":this.border.width,fill:this.fill||this.themeStyle.tooltipFill,opacity:(this.theme==="TailwindDark"||this.theme==="Tailwind"||this.theme==="Bootstrap5"||this.theme==="Bootstrap5Dark")&&this.opacity===.75?1:this.opacity,stroke:this.border.color});i.appendChild(r)}},t.prototype.drawMarker=function(e,i,r){if(this.shapes.length<=0)return null;for(var n,s=0,l=this.renderer.createGroup({id:this.element.id+"_trackball_group"}),h=Nr(this.element.id+"_group"),c=(this.enableRTL?this.elementSize.width-r/2:this.marginX*2+r/2)+(i?this.arrowPadding:0),u=0,p=this.shapes;u<p.length;u++){var f=p[u];f!=="None"&&(n=new er(this.element.id+"_Trackball_"+s,this.palette[s],1,"#cccccc",1,null),this.markerPoint[s]&&l.appendChild(Bw(new vr(c,this.markerPoint[s]-this.padding+(e?this.arrowPadding:0)),f,new ni(r,r),"",n,null)),s++)}h.appendChild(l)},t.prototype.renderTooltipElement=function(e,i){var r=Nr(this.element.id),n=new vr(0,0),s=new vr(0,0),l=Nr(this.element.id+"_svg"),h=Nr(this.element.id+"_group"),c=Nr(this.element.id+"_path"),u,p=!1,f=!1,g=!1,C=0,L=0;if(this.header!==""&&(this.elementSize.height+=this.marginY),this.content.length>1?(u=this.sharedTooltipLocation(e,this.location.x,this.location.y),p=!0):(u=this.tooltipLocation(e,i,n,s),this.inverted?(f=u.x<i.x+this.clipBounds.x,C=f?0:this.arrowPadding):(p=u.y<i.y+this.clipBounds.y,g=!p,L=p?0:this.arrowPadding)),this.header!==""){var D=2,R=this.isWrap?this.wrappedText:this.header;if(this.isWrap&&typeof R=="string"&&(R.indexOf("<")>-1||R.indexOf(">")>-1)){var B=R.split("<br>");D=B.length}var H=Pt(this.isWrap?this.wrappedText:this.header,this.textStyle).height+this.marginY*D+(g?this.arrowPadding:0)+(this.isWrap?5:0),j=this.marginX*3+(!f&&!p&&!g?this.arrowPadding:0),W="M "+j+" "+H+"L "+(u.width+(!f&&!p&&!g?this.arrowPadding:0)-this.marginX*2)+" "+H,ne=this.renderer.drawPath({id:this.element.id+"_header_path","stroke-width":1,fill:null,opacity:.8,stroke:this.themeStyle.tooltipHeaderLine,d:W});h.appendChild(ne)}var ie=this.border.width/2,me=new ft(ie+C,ie+L,u.width-ie,u.height-ie);if(h.setAttribute("opacity","1"),this.enableAnimation&&!this.isFirst&&!this.crosshair?this.animateTooltipDiv(r,u):this.updateDiv(r,u.x,u.y),l.setAttribute("height",(u.height+this.border.width+(this.inverted?0:this.arrowPadding)+5).toString()),l.setAttribute("width",(u.width+this.border.width+(this.inverted?this.arrowPadding:0)+5).toString()),l.setAttribute("opacity","1"),(0,a.le)(this.tooltipPlacement)||(p=this.tooltipPlacement.indexOf("Top")>-1,g=this.tooltipPlacement.indexOf("Bottom")>-1,f=this.tooltipPlacement.indexOf("Left")>-1),c.setAttribute("d",Pw(this.rx,this.ry,me,n,this.arrowPadding,p,g,f,s.x,s.y,this.controlName)),this.enableShadow&&this.theme!=="Bootstrap4"){var ve=this.element.id+"_shadow";this.theme==="Tailwind"||this.theme==="TailwindDark"||this.theme==="Bootstrap5"||this.theme==="Bootstrap5Dark"?c.setAttribute("box-shadow","0px 1px 2px rgba(0, 0, 0, 0.06), 0px 1px 3px rgba(0, 0, 0, 0.1)"):c.setAttribute("filter",a.AR.isIE?"":"url(#"+ve+")");var Ee='<filter id="'+ve+'" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="3"/>';Ee+='<feOffset dx="3" dy="3" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.5"/>',Ee+='</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';var le=this.renderer.createDefs();le.setAttribute("id",this.element.id+"SVG_tooltip_definition"),h.appendChild(le),le.innerHTML=Ee}var de=this.theme==="Fluent"?"#FFFFFF":this.theme==="FluentDark"?"#323130":this.border.color;return c.setAttribute("stroke",de),(0,a.le)(this.border.dashArray)||c.setAttribute("stroke-dasharray",this.border.dashArray),this.changeText(new vr(C,L),g,!f&&!p&&!g),this.revert&&(this.inverted=!this.inverted,this.revert=!1),new Nw(g,!f&&!p&&!g)},t.prototype.changeText=function(e,i,r){var n=document.getElementById(this.element.id+"_text");i&&n.setAttribute("transform","translate(0,"+this.arrowPadding+")"),r&&n.setAttribute("transform","translate("+this.arrowPadding+" 0)")},t.prototype.findFormattedText=function(){this.formattedText=[],this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""&&(this.formattedText=this.formattedText.concat(this.header)),this.formattedText=this.formattedText.concat(this.content)},t.prototype.renderText=function(e){var i=0,r=0,n=0,s,l="properties",h=(0,a.l7)({},this.textStyle,null,!0)[l],c=Nr(this.element.id+"_group"),u,p,f="",g,C;this.findFormattedText(),this.isWrap=!1;var L=document.body.getAttribute("dir")==="rtl",D=L&&!this.enableRTL?"end":"start";this.leftSpace=this.areaBounds.x+this.location.x,this.rightSpace=this.areaBounds.x+this.areaBounds.width-this.leftSpace;var R=this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim(),B=this.header.indexOf("<b>")>-1&&this.header.indexOf("</b>")>-1,H=Pt(this.formattedText[0],h).width+2*this.marginX+this.arrowPadding,j=this.location.x-H<this.location.x,W=this.areaBounds.x+this.areaBounds.width<this.location.x+H,ne,ie=R!==""?this.marginY:0,me=!0,ve=!0;this.markerPoint=[];var Ee=this.shapes.length>0?10:0,le=this.shapes.length>0?5:0,de=4,fe,Le="13px",ke="Normal",Me=this.themeStyle.tooltipLightLabel,De=22/parseFloat(Le)*parseFloat(h.size),Fe=[];(!e||this.isCanvas)&&(ac(this.element.id+"_text"),ac(this.element.id+"_header_path"),ac(this.element.id+"_trackball_group"),ac(this.element.id+"SVG_tooltip_definition"));for(var Pe=new fr(this.element.id+"_text",this.marginX*2,this.marginY*2+this.padding*2+(this.marginY===2?3:0),D,""),Ye=Hw(Pe,h,null,c),Ze=this.formattedText.length===1&&this.formattedText[0].indexOf(" : <b>")>-1,nt=this.header!=="",it=nt&&B?16:13,et=0,at=this.formattedText.length;et<at;et++)if(p=this.formattedText[et].replace(/<(b|strong)>/g,"<b>").replace(/<\/(b|strong)>/g,"</b>").split(/<br.*?>/g),et===0&&!Ze&&this.isTextWrap&&(this.leftSpace<H||j)&&(this.rightSpace<H||W)&&(fe=Math.round(this.leftSpace>this.rightSpace?this.leftSpace/it:this.rightSpace/it),ne=R!==""?R:this.formattedText[et],p=ne.match(new RegExp(".{1,"+fe+"}","g")),this.wrappedText=B?"<b>"+p.join("<br>")+"</b>":p.join("<br>"),this.isWrap=p.length>1),p[0]!==""){(et!==0||R==="")&&this.markerPoint.push((R!==""?this.marginY:0)+Pe.y+i);for(var Ge=0,gt=p.length;Ge<gt;Ge++){s=p[Ge].replace(/<b>/g,"<br><b>").replace(/<\/b>/g,"</b><br>").replace(/:/g,this.enableRTL?"<br>\u200E: <br>":"<br>\u200E:<br>").split("<br>"),this.enableRTL&&s.length>0&&p[Ge].match(/:/g)&&(s[0]=s[0].trim(),s.reverse()),n=0,ve=!0,i+=De;for(var ge=0,xe=s.length;ge<xe;ge++)g=s[ge],this.enableRTL&&g!==""&&this.isRTLText(g)&&(g=g.concat("\u200E")),!/\S/.test(g)&&g!==""&&(g=" "),(!ve&&g===" "||g.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!=="")&&(n+=g!==" "?de:0,ve&&!me?(C={x:this.marginX*2+(Ee+le),dy:De+(ve?ie:0),fill:""},ie=null):me&&ve?C={x:R===""?this.marginX*2+(Ee+le):this.marginX*2+(this.isWrap?Ee+le:0)}:C={},ve=!1,u=this.renderer.createTSpan(C,""),Ye.appendChild(u),g.indexOf("<b>")>-1||B&&ge===0&&et===0&&(nt||this.isWrap)?(ke="bold",Me=this.themeStyle.tooltipBoldLabel,f="font-weight:"+ke,h.fontWeight=ke,u.setAttribute("fill",this.textStyle.color||Me)):(f=ke==="bold"?"font-weight:"+ke:"",h.fontWeight=ke,u.setAttribute("fill",this.textStyle.color||Me)),(g.indexOf("</b>")>-1||B&&ge===xe-1&&et===0&&(nt||this.isWrap))&&(ke="Normal",Me=this.themeStyle.tooltipLightLabel),u.textContent=g=this.getTooltipTextContent(g),n+=Pt(g,h).width,f!==""&&(u.style.fontWeight=f.split("font-weight:")[1],u.style.color=u.getAttribute("fill")),u.style.fontFamily="inherit",u.style.fontStyle="inherit",u.style.fontSize="inherit",me=!1);n-=de,r=Math.max(r,n),Fe.push(n)}}this.elementSize=new ni(r+(r>0?2*this.marginX:0),i),this.elementSize.width+=Ee+le;var je=Ye.childNodes[0];if(R!==""&&je&&!this.isWrap){h.fontWeight="bold";var Je=(this.elementSize.width+2*this.padding)/2-Pt(R,h).width/2;je.setAttribute("x",Je.toString())}this.renderContentRTL(Ye,nt,Ee+le,Fe)},t.prototype.renderContentRTL=function(e,i,r,n){if(this.enableRTL)for(var s=void 0,l=i?1:0,h=0;h<e.childNodes.length;h++)s=e.childNodes[h],(!i||h>0)&&!(0,a.le)(s.getAttribute("x"))&&(s.setAttribute("x",(this.elementSize.width-(r+n[l])).toString()),l++)},t.prototype.getTooltipTextContent=function(e){var i=e.match(/<[a-zA-Z\/](.|\n)*?>/g);if((0,a.le)(i))return e;for(var r=this.isRTLText(e),n=0;n<i.length;n++)this.isValidHTMLElement(i[n].replace("<","").replace("/","").replace(">","").trim())&&(e=e.replace(i[n],r?"\u200E":""));return e},t.prototype.isValidHTMLElement=function(e){return document.createElement(e).toString()!="[object HTMLUnknownElement]"},t.prototype.isRTLText=function(e){return/[\u0590-\u07FF\u200F\u202B\u202E\uFB1D-\uFDFD\uFE70-\uFEFC]/.test(e)},t.prototype.createTemplate=function(e,i){var r={cancel:!1,name:"tooltipRender",tooltip:this};this.trigger("tooltipRender",r);var n=document.getElementById(this.element.id);this.isCanvas&&this.removeSVG();var s=n.firstElementChild;if(s&&(0,a.Od)(s),r.cancel)(0,a.Od)(Nr(this.element.id+"_tooltip"));else{for(var l=(0,a.az)("div",{id:this.element.id+"parent_template"}),h=this.templateFn(this.data,this.controlInstance,l.id,l.id+"_blazorTemplate","");h&&h.length>0;)(0,a.xr)()||h.length===1?(l.appendChild(h[0]),h=null):l.appendChild(h[0]);n.appendChild(l);var c=this.isCanvas?l:this.element,u=c.getBoundingClientRect();this.padding=0,this.elementSize=new ni(u.width,u.height);var p=this.shared?this.sharedTooltipLocation(e,this.location.x,this.location.y):this.tooltipLocation(e,i,new vr(0,0),new vr(0,0));if(this.enableAnimation&&!this.isFirst&&!this.crosshair?this.animateTooltipDiv(this.element,p):this.updateDiv(c,p.x,p.y),this.blazorTemplate){var f=function(){var C=Nr(g.element.id).getBoundingClientRect();g.elementSize=new ni(C.width,C.height);var L=g.tooltipLocation(e,i,new vr(0,0),new vr(0,0));g.updateDiv(Nr(g.element.id),L.x,L.y)},g=this;f.bind(g,e,i),(0,a.tx)(this.element.id+"parent_template_blazorTemplate",this.blazorTemplate.name,this.blazorTemplate.parent,void 0,f)}}},t.prototype.sharedTooltipLocation=function(e,i,r){var n=this.elementSize.width+2*this.marginX,s=this.elementSize.height+2*this.marginY,l=new ft(i+2*this.padding,r-s-this.padding,n,s);return l.y<e.y&&(l.y+=l.height+2*this.padding),l.x+l.width>e.x+e.width&&(l.x-=l.width+4*this.padding),l},t.prototype.getCurrentPosition=function(e,i,r,n){var s=this.tooltipPlacement,l=this.clipBounds.x,h=this.clipBounds.y,c=this.offset,u=this.elementSize.width+2*this.marginX,p=this.elementSize.height+2*this.marginY,f=new vr(i.x,i.y);return s==="Top"||s==="Bottom"?(f=new vr(f.x+l-this.elementSize.width/2-this.padding,f.y+h-this.elementSize.height-2*this.padding-this.arrowPadding-c),r.x=n.x=u/2,s==="Bottom"&&(f.y=i.y+h+c),e.x+e.width<f.x+u?(f.x=e.width>u?e.x+e.width-u+6:e.x,r.x=n.x=e.width>u?e.x+i.x-f.x:i.x):e.x>f.x&&(f.x=e.x,r.x=n.x=i.x)):(f=new vr(f.x+l+c,f.y+h-this.elementSize.height/2-this.padding),r.y=n.y=p/2,s==="Left"&&(f.x=i.x+l-c-(u+this.arrowPadding)),e.y+e.height<f.y+p?(f.y=e.height>p?e.y+e.height-p+6:e.y,r.y=n.y=e.height>p?e.y+i.y-f.y:i.y):e.y>f.y&&(f.y=e.y,r.y=n.y=i.y)),new ft(f.x,f.y,u,p)},t.prototype.tooltipLocation=function(e,i,r,n){if(!(0,a.le)(this.tooltipPlacement)){var s=this.getCurrentPosition(e,i,r,n);return s}var l=new vr(i.x,i.y),h=this.elementSize.width+2*this.marginX,c=this.elementSize.height+2*this.marginY,u=this.offset,p=this.clipBounds.x,f=this.clipBounds.y,g=e.x,C=e.y;return this.outOfBounds=!1,this.inverted?(l=new vr(l.x+p+u,l.y+f-this.elementSize.height/2-this.padding),r.y=n.y=c/2,(l.x+h+this.arrowPadding>g+e.width||this.isNegative)&&(l.x=(i.x>e.width+e.x?e.width:i.x)+p-u-(h+this.arrowPadding)),l.x<g&&(l.x=(i.x<0?0:i.x)+p+u),l.y<=C&&(r.y-=C-l.y,n.y-=C-l.y,l.y=C),l.y+c>=C+e.height&&(r.y+=l.y+c-(C+e.height),n.y+=l.y+c-(C+e.height),l.y-=l.y+c-(C+e.height)),r.y+this.arrowPadding>c-this.ry&&(r.y=c-this.ry-this.arrowPadding,n.y=c),r.y-this.arrowPadding<this.ry&&(r.y=n.y=this.ry+this.arrowPadding),this.controlName==="Chart"&&((l.y+r.y<this.areaMargin+this.arrowPadding||e.y+e.height-(l.y+r.y)<this.areaMargin+this.arrowPadding)&&(this.outOfBounds=!0),(!pg(l.x,l.y,e)||this.outOfBounds)&&(this.inverted=!this.inverted,l=new vr(i.x+p-this.padding-this.elementSize.width/2,i.y+f-this.elementSize.height-2*this.padding-u-this.arrowPadding),this.revert=!0,n.x=r.x=h/2,n.y=r.y=0,(l.y<C||this.isNegative)&&(l.y=(i.y<0?0:i.y)+u+f),l.y+this.arrowPadding+c>C+e.height&&(l.y=Math.min(i.y,C+e.height)+f-this.elementSize.height-2*this.padding-u-this.arrowPadding),n.x=h/2,l.x<g&&(n.x-=g-l.x,r.x-=g-l.x,l.x=g),l.x+h>e.width+g&&(r.x+=l.x+h-(e.width+g),n.x+=l.x+h-(e.width+g),l.x-=l.x+h-(e.width+g)),this.arrowPadding+r.x>h-this.rx&&(n.x=h-this.rx-this.arrowPadding,r.x=h-this.rx-this.arrowPadding),r.x-this.arrowPadding<this.rx&&(r.x=n.x=this.rx+this.arrowPadding)))):(l=new vr(l.x+p-this.elementSize.width/2-this.padding,l.y+f-this.elementSize.height-2*this.padding-this.arrowPadding-u),r.x=n.x=h/2,(l.y<C||this.isNegative)&&(l.y=(i.y<0?0:i.y)+f+u),l.y+c+this.arrowPadding>C+e.height&&(l.y=Math.min(i.y,C+e.height)+f-this.elementSize.height-2*this.padding-this.arrowPadding-u),n.x=h/2,l.x<g&&(r.x-=g-l.x,n.x-=g-l.x,l.x=g),l.x+h>g+e.width&&(r.x+=l.x+h-(g+e.width),n.x+=l.x+h-(g+e.width),l.x-=l.x+h-(g+e.width)),r.x+this.arrowPadding>h-this.rx&&(r.x=h-this.rx-this.arrowPadding,n.x=h-this.rx-this.arrowPadding),r.x-this.arrowPadding<this.rx&&(r.x=n.x=this.rx+this.arrowPadding),this.controlName==="Chart"&&((e.x+e.width-(l.x+r.x)<this.areaMargin+this.arrowPadding||l.x+r.x<this.areaMargin+this.arrowPadding)&&(this.outOfBounds=!0),(!pg(l.x,l.y,e)||this.outOfBounds)&&(this.inverted=!this.inverted,this.revert=!0,l=new vr(i.x+u+p,i.y+f-this.elementSize.height/2-this.padding),n.x=r.x=0,n.y=r.y=c/2,(l.x+this.arrowPadding+h>g+e.width||this.isNegative)&&(l.x=(i.x>e.width?e.width:i.x)+p-u-(this.arrowPadding+h)),l.x<g&&(l.x=(i.x<0?0:i.x)+u+p),l.y<=C&&(n.y-=C-l.y,r.y-=C-l.y,l.y=C),l.y+c>=e.height+C&&(r.y+=l.y+c-(e.height+C),n.y+=l.y+c-(e.height+C),l.y-=l.y+c-(e.height+C)),this.arrowPadding+r.y>c-this.ry&&(r.y=c-this.arrowPadding-this.ry,n.y=c),r.y-this.arrowPadding<this.ry&&(r.y=this.arrowPadding+this.ry,n.y=0)))),new ft(l.x,l.y,h,c)},t.prototype.animateTooltipDiv=function(e,i){var r=this,n=parseFloat(e.style.left),s=parseFloat(e.style.top),l;new a.fw({}).animate(e,{duration:this.duration,progress:function(h){l=h.timeStamp/h.duration,e.style.animation=null,r.controlName==="Chart"&&r.shared&&!r.enableRTL?(e.style.transition="transform "+.1+"s",e.style.transform="translate("+(n+l*(i.x-n))+"px,"+(s+l*(i.y-s))+"px)"):(e.style.left=n+l*(i.x-n)+"px",e.style.top=s+l*(i.y-s)+"px")},end:function(h){r.updateDiv(e,i.x,i.y),r.trigger("animationComplete",{tooltip:r})}})},t.prototype.updateDiv=function(e,i,r){this.controlName==="Chart"&&this.shared&&!this.crosshair&&!this.enableRTL?e.style.transform="translate("+i+"px,"+r+"px)":(e.style.left=i+"px",e.style.top=r+"px")},t.prototype.updateTemplateFn=function(){if(this.template)try{document.querySelectorAll(this.template).length?this.templateFn=(0,a.MY)(document.querySelector(this.template).innerHTML.trim()):this.templateFn=(0,a.MY)(this.template)}catch(e){this.templateFn=(0,a.MY)(this.template)}},t.prototype.fadeOut=function(){var e=this,i=this.isCanvas&&!this.template?Nr(this.element.id+"_svg"):Nr(this.element.id),r=Nr(this.element.id);if(i){var n=i.firstChild;if(n.nodeType!=Node.ELEMENT_NODE&&(n=i.firstElementChild),this.isCanvas&&!this.template&&(n=document.getElementById(this.element.id+"_group")?document.getElementById(this.element.id+"_group"):n),!n)return null;var s=parseFloat(n.getAttribute("opacity"));s=(0,a.le)(s)?1:s,new a.fw({}).animate(n,{duration:200,progress:function(l){e.progressAnimation(n,s,l.timeStamp/l.duration)},end:function(){e.fadeOuted=!0,e.endAnimation(n),r.style.transition=""}})}},t.prototype.progressAnimation=function(e,i,r){e.style.animation="",e.setAttribute("opacity",(i-r).toString())},t.prototype.endAnimation=function(e){e.setAttribute("opacity","0"),this.template&&(e.style.display="none"),this.trigger("animationComplete",{tooltip:this})},t.prototype.getPersistData=function(){var e=[];return this.addOnPersist(e)},t.prototype.getModuleName=function(){return"tooltip"},t.prototype.destroy=function(){o.prototype.destroy.call(this),this.element.classList.remove("e-tooltip")},t.prototype.onPropertyChanged=function(e,i){this.blazorTemplate&&(0,a.oL)(this.element.id+"parent_template_blazorTemplate"),this.isFirst=!1,this.render()},Tt([(0,a.Z9)(!1)],t.prototype,"enable",void 0),Tt([(0,a.Z9)(!1)],t.prototype,"shared",void 0),Tt([(0,a.Z9)(!1)],t.prototype,"crosshair",void 0),Tt([(0,a.Z9)(!0)],t.prototype,"enableShadow",void 0),Tt([(0,a.Z9)(null)],t.prototype,"fill",void 0),Tt([(0,a.Z9)("")],t.prototype,"header",void 0),Tt([(0,a.Z9)(.75)],t.prototype,"opacity",void 0),Tt([(0,a.Zz)({size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},Vw)],t.prototype,"textStyle",void 0),Tt([(0,a.Z9)(null)],t.prototype,"template",void 0),Tt([(0,a.Z9)(!0)],t.prototype,"enableAnimation",void 0),Tt([(0,a.Z9)(300)],t.prototype,"duration",void 0),Tt([(0,a.Z9)(!1)],t.prototype,"inverted",void 0),Tt([(0,a.Z9)(!1)],t.prototype,"isNegative",void 0),Tt([(0,a.Zz)({color:"#cccccc",width:.5},zw)],t.prototype,"border",void 0),Tt([(0,a.Z9)([])],t.prototype,"content",void 0),Tt([(0,a.Z9)(10)],t.prototype,"markerSize",void 0),Tt([(0,a.Zz)({x:0,y:0},fg)],t.prototype,"clipBounds",void 0),Tt([(0,a.Z9)([])],t.prototype,"palette",void 0),Tt([(0,a.Z9)([])],t.prototype,"shapes",void 0),Tt([(0,a.Zz)({x:0,y:0},fg)],t.prototype,"location",void 0),Tt([(0,a.Z9)(0)],t.prototype,"offset",void 0),Tt([(0,a.Z9)(4)],t.prototype,"rx",void 0),Tt([(0,a.Z9)(4)],t.prototype,"ry",void 0),Tt([(0,a.Z9)(5)],t.prototype,"marginX",void 0),Tt([(0,a.Z9)(5)],t.prototype,"marginY",void 0),Tt([(0,a.Z9)(7)],t.prototype,"arrowPadding",void 0),Tt([(0,a.Z9)(null)],t.prototype,"data",void 0),Tt([(0,a.Z9)("Material")],t.prototype,"theme",void 0),Tt([(0,a.Zz)({x:0,y:0,width:0,height:0},_w)],t.prototype,"areaBounds",void 0),Tt([(0,a.Z9)(null)],t.prototype,"availableSize",void 0),Tt([(0,a.Z9)()],t.prototype,"blazorTemplate",void 0),Tt([(0,a.Z9)(!1)],t.prototype,"isCanvas",void 0),Tt([(0,a.Z9)(!1)],t.prototype,"isTextWrap",void 0),Tt([(0,a.Z9)(null)],t.prototype,"tooltipPlacement",void 0),Tt([(0,a.Z9)(null)],t.prototype,"controlInstance",void 0),Tt([(0,a.Z9)("")],t.prototype,"controlName",void 0),Tt([(0,a.ju)()],t.prototype,"tooltipRender",void 0),Tt([(0,a.ju)()],t.prototype,"loaded",void 0),Tt([(0,a.ju)()],t.prototype,"animationComplete",void 0),Tt([(0,a.Z9)(!1)],t.prototype,"enableRTL",void 0),t=Tt([a.Zl],t),t}(a.wA),In=function(){function o(t,e){t<e?(this.mStart=t,this.mEnd=e):(this.mStart=e,this.mEnd=t)}return Object.defineProperty(o.prototype,"start",{get:function(){return this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"end",{get:function(){return this.mEnd},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"delta",{get:function(){return this.mEnd-this.mStart},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"median",{get:function(){return this.mStart+(this.mEnd-this.mStart)/2},enumerable:!0,configurable:!0}),o}(),vg=function(){function o(t){this.isColumn=0,this.chart=t}return o.prototype.calculateNumericNiceInterval=function(t,e,i){var r=Vg(i,t),n=e/r;if(!(0,a.le)(t.desiredIntervals))return n;for(var s=Math.pow(10,Math.floor(Os(n,10))),l=0,h=t.intervalDivs;l<h.length;l++){var c=h[l],u=s*c;if(r<e/u)break;n=u}return n},o.prototype.getActualRange=function(t,e){this.initializeDoubleRange(t),!t.startFromZero&&this.isColumn>0?(t.actualRange.interval=t.interval||this.calculateNumericNiceInterval(t,t.doubleRange.delta,e),t.actualRange.max=t.doubleRange.end+t.actualRange.interval,t.doubleRange.start-t.actualRange.interval<0&&t.doubleRange.start>0?t.actualRange.min=0:t.actualRange.min=t.doubleRange.start-t.actualRange.interval):(t.actualRange.interval=t.interval||this.calculateNumericNiceInterval(t,t.doubleRange.delta,e),t.actualRange.min=t.doubleRange.start,t.actualRange.max=t.doubleRange.end)},o.prototype.initializeDoubleRange=function(t){t.minimum!==null?this.min=t.minimum:(this.min===null||this.min===Number.POSITIVE_INFINITY)&&(this.min=0),t.maximum!==null?this.max=t.maximum:(this.max===null||this.max===Number.NEGATIVE_INFINITY)&&(this.max=5),this.min===this.max&&(this.max=t.valueType.indexOf("Category")>-1?this.max:this.min+1),t.doubleRange=new In(this.min,this.max),t.actualRange={}},o.prototype.calculateRangeAndInterval=function(t,e){this.calculateRange(e),this.getActualRange(e,t),this.applyRangePadding(e,t),this.calculateVisibleLabels(e,this.chart)},o.prototype.calculateRange=function(t){/*! Generate axis range */if(this.min=null,this.max=null,!Ld(t))for(var e=0,i=t.series;e<i.length;e++){var r=i[e];!r.visible||(this.paddingInterval=0,(0,a.le)(r.points)||(t.maxPointLength=r.points.length),((r.type.indexOf("Column")>-1||r.type.indexOf("Histogram")>-1)&&t.orientation==="Horizontal"||r.type.indexOf("Bar")>-1&&t.orientation==="Vertical")&&(r.xAxis.valueType==="Double"||r.xAxis.valueType==="DateTime")&&r.xAxis.rangePadding==="Auto"&&(this.paddingInterval=Hg(r.xAxis,t.series)*.5),t.orientation==="Horizontal"&&(this.chart.requireInvertedAxis?this.yAxisRange(t,r):this.findMinMax(r.xMin-this.paddingInterval,r.xMax+this.paddingInterval)),t.orientation==="Vertical"&&(this.isColumn+=r.type==="Column"||r.type==="Bar"||r.drawType==="Column"?1:0,this.chart.requireInvertedAxis?this.findMinMax(r.xMin-this.paddingInterval,r.xMax+this.paddingInterval):this.yAxisRange(t,r)))}},o.prototype.yAxisRange=function(t,e){e.dragSettings.enable&&this.chart.dragY&&(this.chart.dragY>=t.visibleRange.max&&(e.yMax=this.chart.dragY+t.visibleRange.interval),this.chart.dragY<=t.visibleRange.min&&(e.yMin=this.chart.dragY-t.visibleRange.interval)),this.findMinMax(e.yMin,e.yMax)},o.prototype.findMinMax=function(t,e){(this.min===null||this.min>t)&&(this.min=t),(this.max===null||this.max<e)&&(this.max=e),this.max===this.min&&this.max<0&&this.min<0&&(this.max=0)},o.prototype.applyRangePadding=function(t,e){var i=t.actualRange.min,r=t.actualRange.max;if(!Ld(t)){var n=t.actualRange.interval,s=t.getRangePadding(this.chart);s==="Additional"||s==="Round"?this.findAdditional(t,i,r,n,e):s==="Normal"?this.findNormal(t,i,r,n,e):this.updateActualRange(t,i,r,n)}t.actualRange.delta=t.actualRange.max-t.actualRange.min,this.calculateVisibleRange(e,t)},o.prototype.updateActualRange=function(t,e,i,r){t.actualRange={min:t.minimum!=null?t.minimum:e,max:t.maximum!=null?t.maximum:i,interval:t.interval!=null?t.interval:r,delta:t.actualRange.delta}},o.prototype.findAdditional=function(t,e,i,r,n){var s,l;if(s=Math.floor(e/r)*r,l=Math.ceil(i/r)*r,t.rangePadding==="Additional"&&(s-=r,l+=r),!(0,a.le)(t.desiredIntervals)){var h=l-s;r=this.calculateNumericNiceInterval(t,h,n)}this.updateActualRange(t,s,l,r)},o.prototype.findNormal=function(t,e,i,r,n){var s,l,h,c=e;e<0?(c=0,l=e+e*.05,s=r+l%r,.365*r>=s&&(l-=r),l%r<0&&(l=l-r-l%r)):(l=e<5/6*i?0:e-(i-e)*.5,l%r>0&&(l-=l%r)),h=i>0?i+(i-c)*.05:i-(i-c)*.05,s=r-h%r,.365*r>=s&&(h+=r),h%r>0&&(h=h+r-h%r),t.doubleRange=new In(l,h),l===0&&(r=this.calculateNumericNiceInterval(t,t.doubleRange.delta,n),h=Math.ceil(h/r)*r),this.updateActualRange(t,l,h,r)},o.prototype.calculateVisibleRange=function(t,e){if(e.visibleRange={max:e.actualRange.max,min:e.actualRange.min,delta:e.actualRange.delta,interval:e.actualRange.interval},this.chart.chartAreaType==="Cartesian"){var i=(0,a.le)(e.zoomingScrollBar)?!1:e.zoomingScrollBar.isLazyLoad;(e.zoomFactor<1||e.zoomPosition>0)&&!i&&(e.calculateVisibleRangeOnZooming(t),e.calculateAxisRange(t,this.chart),e.visibleRange.interval=e.enableAutoIntervalOnZooming&&e.valueType!=="Category"?this.calculateNumericNiceInterval(e,e.doubleRange.delta,t):e.visibleRange.interval)}e.triggerRangeRender(this.chart,e.visibleRange.min,e.visibleRange.max,e.visibleRange.interval)},o.prototype.calculateVisibleLabels=function(t,e){/*! Generate axis labels */t.visibleLabels=[];var i=t.visibleRange.min,r,n=e.getModuleName(),s=n==="chart"&&e.chartAreaType==="PolarRadar";!s&&(t.zoomFactor<1||t.zoomPosition>0||this.paddingInterval)&&(i=t.visibleRange.min-t.visibleRange.min%t.visibleRange.interval);var l=this.getFormat(t),h=l.match("{value}")!==null,c=0,u=0;t.labelFormat&&t.labelFormat.indexOf("n")>-1&&(u=parseInt(t.labelFormat.substring(1,t.labelFormat.length),10)),t.format=e.intl.getNumberFormat({format:h?"":l,useGrouping:e.useGroupingSeparator}),t.startLabel=t.format(t.visibleRange.min),t.endLabel=t.format(t.visibleRange.max),t.visibleRange.interval&&(t.visibleRange.interval+"").indexOf(".")>=0&&(c=(t.visibleRange.interval+"").split(".")[1].length);for(var p;i<=t.visibleRange.max&&p!==i;i+=t.visibleRange.interval)p=i,r=(0,a.l7)({},(0,a.NA)("properties",t.labelStyle),null,!0),pa(i,t.visibleRange)&&Td(e,i,this.formatValue(t,h,l,i),r,t);i&&(i+"").indexOf(".")>=0&&(i+"").split(".")[1].length>10&&(i=(i+"").split(".")[1].length>(u||c)?+i.toFixed(u||c):i,i<=t.visibleRange.max&&Td(e,i,this.formatValue(t,h,l,i),r,t)),t.getMaxLabelWidth&&t.getMaxLabelWidth(this.chart)},o.prototype.getFormat=function(t){return t.labelFormat?t.labelFormat.indexOf("p")===0&&t.labelFormat.indexOf("{value}")===-1&&t.isStack100?"{value}%":t.labelFormat:t.isStack100?"{value}%":""},o.prototype.formatValue=function(t,e,i,r){return e?i.replace("{value}",t.format(r)):t.format(r)},o}(),sR="loaded",eo="legendClick",oc="load",Ww="animationComplete",mg="legendRender",lc="textRender",Ds="pointRender",aR="sharedTooltipRender",hc="seriesRender",gg="axisLabelRender",Uw="axisLabelClick",yg="axisRangeCalculated",oR="axisMultiLabelRender",bg="tooltipRender",Cg="chartMouseMove",Sg="chartMouseClick",wg="chartDoubleClick",xg="pointClick",qw="pointDoubleClick",Eg="pointMove",Ag="chartMouseLeave",Tg="chartMouseDown",Lg="chartMouseUp",lR="zoomComplete",hR="dragComplete",cR="selectionComplete",cc="resized",kg="beforeResize",Ig="beforePrint",uR="annotationRender",pR="scrollStart",dR="scrollEnd",fR="scrollChanged",vR="stockEventRender",mR="multiLevelLabelClick",gR="dragStart",yR="drag",bR="dragEnd",uc=/~\d+~/g,Dg=/\^\d+\^/g,CR="beforeExport",pc="afterExport",SR="bulletChartMouseClick",wR="onZooming",ha=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ot=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Zw=function(o){ha(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ot([(0,a.Z9)("0")],t.prototype,"x",void 0),Ot([(0,a.Z9)("0")],t.prototype,"y",void 0),Ot([(0,a.Z9)(null)],t.prototype,"content",void 0),Ot([(0,a.Z9)("Center")],t.prototype,"horizontalAlignment",void 0),Ot([(0,a.Z9)("Pixel")],t.prototype,"coordinateUnits",void 0),Ot([(0,a.Z9)("Chart")],t.prototype,"region",void 0),Ot([(0,a.Z9)("Middle")],t.prototype,"verticalAlignment",void 0),Ot([(0,a.Z9)(null)],t.prototype,"xAxisName",void 0),Ot([(0,a.Z9)(null)],t.prototype,"yAxisName",void 0),Ot([(0,a.Z9)(null)],t.prototype,"description",void 0),t}(a.rt),Og=function(o){ha(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ot([(0,a.Z9)("")],t.prototype,"color",void 0),Ot([(0,a.Z9)(1)],t.prototype,"width",void 0),Ot([(0,a.Z9)("Rectangle")],t.prototype,"type",void 0),t}(a.rt),Yw=function(o){ha(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ot([(0,a.Z9)(null)],t.prototype,"start",void 0),Ot([(0,a.Z9)(null)],t.prototype,"end",void 0),Ot([(0,a.Z9)("")],t.prototype,"text",void 0),Ot([(0,a.Z9)(null)],t.prototype,"maximumTextWidth",void 0),Ot([(0,a.Z9)(null)],t.prototype,"customAttributes",void 0),Ot([(0,a.Z9)("")],t.prototype,"type",void 0),t}(a.rt),Gw=function(o){ha(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ot([(0,a.Z9)(!0)],t.prototype,"visible",void 0),Ot([(0,a.Z9)(!1)],t.prototype,"startFromAxis",void 0),Ot([(0,a.Z9)(null)],t.prototype,"start",void 0),Ot([(0,a.Z9)(null)],t.prototype,"end",void 0),Ot([(0,a.Z9)(null)],t.prototype,"size",void 0),Ot([(0,a.Z9)("#808080")],t.prototype,"color",void 0),Ot([(0,a.Z9)(null)],t.prototype,"dashArray",void 0),Ot([(0,a.Z9)("Auto")],t.prototype,"sizeType",void 0),Ot([(0,a.Z9)(!1)],t.prototype,"isRepeat",void 0),Ot([(0,a.Z9)(null)],t.prototype,"repeatEvery",void 0),Ot([(0,a.Z9)(null)],t.prototype,"repeatUntil",void 0),Ot([(0,a.Z9)(!1)],t.prototype,"isSegmented",void 0),Ot([(0,a.Z9)(null)],t.prototype,"segmentStart",void 0),Ot([(0,a.Z9)(null)],t.prototype,"segmentEnd",void 0),Ot([(0,a.Z9)(null)],t.prototype,"segmentAxisName",void 0),Ot([(0,a.Zz)({color:"transparent",width:1},xr)],t.prototype,"border",void 0),Ot([(0,a.Z9)("")],t.prototype,"text",void 0),Ot([(0,a.Z9)(null)],t.prototype,"rotation",void 0),Ot([(0,a.Z9)("Middle")],t.prototype,"horizontalAlignment",void 0),Ot([(0,a.Z9)("Middle")],t.prototype,"verticalAlignment",void 0),Ot([(0,a.Zz)(Mr.stripLineLabelFont,Pr)],t.prototype,"textStyle",void 0),Ot([(0,a.Z9)("Behind")],t.prototype,"zIndex",void 0),Ot([(0,a.Z9)(1)],t.prototype,"opacity",void 0),t}(a.rt),Kw=function(o){ha(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ot([(0,a.Z9)("Center")],t.prototype,"alignment",void 0),Ot([(0,a.Z9)("Wrap")],t.prototype,"overflow",void 0),Ot([(0,a.Zz)(Mr.axisLabelFont,Pr)],t.prototype,"textStyle",void 0),Ot([(0,a.Zz)({color:null,width:1,type:"Rectangle"},Og)],t.prototype,"border",void 0),Ot([(0,a.FE)([],Yw)],t.prototype,"categories",void 0),t}(a.rt),Xw=function(o){ha(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ot([(0,a.Z9)(null)],t.prototype,"minimum",void 0),Ot([(0,a.Z9)(null)],t.prototype,"maximum",void 0),t}(a.rt),$w=function(o){ha(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ot([(0,a.Z9)(!1)],t.prototype,"enable",void 0),Ot([(0,a.Z9)(null)],t.prototype,"pointsLength",void 0),Ot([(0,a.Zz)({},Xw)],t.prototype,"range",void 0),t}(a.rt),es=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ut=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Qw=function(o){es(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.axes=[],e.nearSizes=[],e.farSizes=[],e}return t.prototype.computeSize=function(e,i){var r=0,n=5;e.visible&&e.internalVisibility&&(r+=e.findTickSize(e.crossInAxis)+i+e.findLabelSize(e.crossInAxis,n)+e.lineStyle.width*.5),e.isAxisOpposedPosition?this.farSizes.push(r):this.nearSizes.push(r)},ut([(0,a.Z9)("100%")],t.prototype,"height",void 0),ut([(0,a.Zz)({},xr)],t.prototype,"border",void 0),t}(a.rt),Jw=function(o){es(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.axes=[],e.nearSizes=[],e.farSizes=[],e.padding=0,e}return t.prototype.computeSize=function(e,i){var r=0,n=5;e.visible&&e.internalVisibility&&(r+=e.findTickSize(e.crossInAxis)+i+e.findLabelSize(e.crossInAxis,n)+e.lineStyle.width*.5),e.isAxisOpposedPosition?this.farSizes.push(r):this.nearSizes.push(r)},ut([(0,a.Z9)("100%")],t.prototype,"width",void 0),ut([(0,a.Zz)({},xr)],t.prototype,"border",void 0),t}(a.rt),ex=function(o){es(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ut([(0,a.Z9)(1)],t.prototype,"width",void 0),ut([(0,a.Z9)("")],t.prototype,"dashArray",void 0),ut([(0,a.Z9)(null)],t.prototype,"color",void 0),t}(a.rt),tx=function(o){es(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ut([(0,a.Z9)(.7)],t.prototype,"width",void 0),ut([(0,a.Z9)("")],t.prototype,"dashArray",void 0),ut([(0,a.Z9)(null)],t.prototype,"color",void 0),t}(a.rt),ix=function(o){es(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ut([(0,a.Z9)(1)],t.prototype,"width",void 0),ut([(0,a.Z9)("")],t.prototype,"dashArray",void 0),ut([(0,a.Z9)(null)],t.prototype,"color",void 0),t}(a.rt),rx=function(o){es(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ut([(0,a.Z9)(1)],t.prototype,"width",void 0),ut([(0,a.Z9)(5)],t.prototype,"height",void 0),ut([(0,a.Z9)(null)],t.prototype,"color",void 0),t}(a.rt),nx=function(o){es(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ut([(0,a.Z9)(.7)],t.prototype,"width",void 0),ut([(0,a.Z9)(5)],t.prototype,"height",void 0),ut([(0,a.Z9)(null)],t.prototype,"color",void 0),t}(a.rt),sx=function(o){es(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ut([(0,a.Z9)(!1)],t.prototype,"enable",void 0),ut([(0,a.Z9)(null)],t.prototype,"fill",void 0),ut([(0,a.Zz)(Mr.crosshairLabelFont,Pr)],t.prototype,"textStyle",void 0),t}(a.rt),dc=function(o){es(t,o);function t(e,i,r,n){var s=o.call(this,e,i,r,n)||this;return s.visibleLabels=[],s.series=[],s.rect=new ft(void 0,void 0,0,0),s.axisBottomLine=null,s.intervalDivs=[10,5,2,1],s.isStack100=!1,s.crossAt=null,s.updatedRect=null,s.multiLevelLabelHeight=0,s.isChart=!0,s.isIntervalInDecimal=!0,s.titleCollection=[],s.titleSize=new ni(0,0),s.internalVisibility=!0,s.isRTLEnabled=!1,s.angle=s.labelRotation,s}return t.prototype.findTickSize=function(e){return this.tickPosition==="Inside"||e&&(!e.visibleRange||this.isInside(e.visibleRange))?0:this.majorTickLines.height},t.prototype.isInside=function(e){return ul(this.crossAt,e)||!this.isAxisOpposedPosition&&this.crossAt>=e.max||this.isAxisOpposedPosition&&this.crossAt<=e.min},t.prototype.findLabelSize=function(e,i){var r=0,n=this.orientation==="Horizontal";if(this.title&&(this.titleSize=Pt(this.title,this.titleStyle),r=this.titleSize.height+i,this.rect.width||this.rect.height)){var s=n?this.rect.width:this.rect.height;this.titleCollection=io(this.title,this.titleStyle,s),r=r*this.titleCollection.length}if(this.labelPosition==="Inside")return r+i;var l,h,c=r+i+this.titlePadding+this.labelPadding+(this.orientation==="Vertical"?this.maxLabelSize.width:this.maxLabelSize.height)+this.multiLevelLabelHeight;if(e&&this.placeNextToAxisLine){var u=e.visibleRange,p=e.orientation==="Horizontal"?e.rect.width:e.rect.height;if(!u||!p)return 0;this.isInside(u)&&(h=this.findDifference(e),l=h*(p/u.delta),l=h*((p-(l<c?c-l:0))/u.delta),c=l<c?c-l:0)}return c},t.prototype.updateCrossValue=function(){var e=this.crossAt;if(e===null||!this.isInside(this.crossInAxis.visibleRange))return this.updatedRect=this.rect,null;var i=this.crossInAxis.visibleRange;this.isAxisOpposedPosition?this.crossAt<i.min&&(e=i.min):this.crossAt>i.max&&(e=i.max),this.updatedRect=(0,a.l7)({},this.rect,null,!0),this.orientation==="Horizontal"?(e=this.crossInAxis.rect.height-Er(e,this.crossInAxis)*this.crossInAxis.rect.height,this.updatedRect.y=this.crossInAxis.rect.y+e):(e=Er(e,this.crossInAxis)*this.crossInAxis.rect.width,this.updatedRect.x=this.crossInAxis.rect.x+e)},t.prototype.findDifference=function(e){var i=0;return this.isAxisOpposedPosition?i=e.isAxisInverse?e.visibleRange.min:e.visibleRange.max:i=e.isAxisInverse?e.visibleRange.max:e.visibleRange.min,Math.abs(this.crossAt-i)},t.prototype.calculateVisibleRangeOnZooming=function(e){if(vl(this)){var i=this.actualRange,r=void 0,n=void 0;this.isAxisInverse?(r=this.actualRange.max-this.zoomPosition*this.actualRange.delta,n=r-this.zoomFactor*this.actualRange.delta):(r=this.actualRange.min+this.zoomPosition*this.actualRange.delta,n=r+this.zoomFactor*this.actualRange.delta),r<i.min&&(n=n+(i.min-r),r=i.min),n>i.max&&(r=r-(n-i.max),n=i.max),this.doubleRange=new In(r,n),this.visibleRange={min:this.doubleRange.start,max:this.doubleRange.end,delta:this.doubleRange.delta,interval:this.visibleRange.interval}}},t.prototype.calculateAxisRange=function(e,i){if(i.enableAutoIntervalOnBothAxis){if(this.orientation==="Horizontal"&&i.zoomSettings.mode==="X")for(var r=0;r<this.series.length;r++){for(var n=[],s=0,l=this.series[r].visiblePoints;s<l.length;s++){var h=l[s];h.xValue>this.visibleRange.min&&h.xValue<this.visibleRange.max&&n.push(h.yValue)}for(var c=0,u=i.axisCollections;c<u.length;c++){var p=u[c];p.orientation==="Vertical"&&!(0,a.le)(p.series[r])&&(p.series[r].yMin=Math.min.apply(Math,n),p.series[r].yMax=Math.max.apply(Math,n),p.baseModule.calculateRangeAndInterval(e,p))}}if(this.orientation==="Vertical"&&i.zoomSettings.mode==="Y")for(var r=0;r<this.series.length;r++){for(var f=[],g=0,C=this.series[r].visiblePoints;g<C.length;g++){var h=C[g];h.yValue>this.visibleRange.min&&h.yValue<this.visibleRange.max&&f.push(h.xValue)}for(var L=0,D=i.axisCollections;L<D.length;L++){var p=D[L];p.orientation==="Horizontal"&&!(0,a.le)(p.series[r])&&(p.series[r].xMin=Math.min.apply(Math,f),p.series[r].xMax=Math.max.apply(Math,f),p.baseModule.calculateRangeAndInterval(e,p))}}}},t.prototype.triggerRangeRender=function(e,i,r,n){var s={cancel:!1,name:yg,axis:this,minimum:i,maximum:r,interval:n};e.trigger(yg,s),s.cancel||(this.visibleRange={min:s.minimum,max:s.maximum,interval:s.interval,delta:s.maximum-s.minimum})},t.prototype.getRangePadding=function(e){var i=this.rangePadding;if(i!=="Auto")return i;switch(this.orientation){case"Horizontal":e.requireInvertedAxis?i=this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal":i="None";break;case"Vertical":e.requireInvertedAxis?i="None":i=this.isStack100||this.baseModule.chart.stockChart?"Round":"Normal";break}return i},t.prototype.getMaxLabelWidth=function(e){var i,r=0,n=!1,s;this.angle=this.labelRotation,this.maxLabelSize=new ni(0,0);for(var l=this.labelIntersectAction,h,c=0,u=this.visibleLabels.length;c<u;c++){h=this.visibleLabels[c],s=ca(h.originalText),s?(h.size=Pt(h.originalText.replace(/<br>/g," "),this.labelStyle),h.breakLabelSize=Pt(this.enableTrim?h.text.join("<br>"):h.originalText,this.labelStyle)):h.size=Pt(h.text,this.labelStyle);var p=s?h.breakLabelSize.width:h.size.width;p>this.maxLabelSize.width&&(this.maxLabelSize.width=p,this.rotatedLabel=h.text);var f=s?h.breakLabelSize.height:h.size.height;if(f>this.maxLabelSize.height&&(this.maxLabelSize.height=f),s&&(h.text=this.enableTrim?h.text:h.originalText.split("<br>")),!(l==="None"||l==="Hide"||l==="Trim")&&(l!=="None"||this.angle%360==0)&&this.orientation==="Horizontal"&&this.rect.width>0&&!n){var g=s?h.breakLabelSize.width:h.size.width;switch(i=Er(h.value,this)*this.rect.width+this.rect.x,i-=g/2,this.edgeLabelPlacement==="Shift"&&(c===0&&i<this.rect.x&&(i=this.rect.x),c===this.visibleLabels.length-1&&i+g>this.rect.x+this.rect.width&&(i=this.rect.x+this.rect.width-g)),l){case"MultipleRows":c>0&&this.findMultiRows(c,i,h,s);break;case"Rotate45":case"Rotate90":c>0&&(this.isAxisInverse?i+g>=r:i<=r)&&(this.angle=l==="Rotate45"?45:90,n=!0);break;default:if(s){for(var C=void 0,L=[],D=void 0,R=0;R<h.text.length;R++)if(C=yl(h.text[R],this.rect.width/this.visibleLabels.length,this.labelStyle),C.length>1)for(var B=0;B<C.length;B++)D=C[B],L.push(D);else L.push(C[0]);h.text=L}else h.text=yl(h.text,this.rect.width/this.visibleLabels.length,this.labelStyle);var H=h.size.height*h.text.length;H>this.maxLabelSize.height&&(this.maxLabelSize.height=H);break}r=this.isAxisInverse?i:i+g}}if(this.angle!==0&&this.orientation==="Horizontal"){this.rotatedLabel=(0,a.le)(this.rotatedLabel)?"":this.rotatedLabel;var j=this.angle===-360||this.angle===0||this.angle===-180||this.angle===180||this.angle===360;this.labelPosition==="Outside"&&!j&&ca(this.rotatedLabel)?this.maxLabelSize=new ni(this.maxLabelSize.height,this.maxLabelSize.width):this.maxLabelSize=Pg(this.labelStyle,this.rotatedLabel,this.angle,e)}else if(this.angle!==0&&this.orientation==="Vertical"){this.rotatedLabel=(0,a.le)(this.rotatedLabel)?"":this.rotatedLabel;var j=this.angle===-360||this.angle===0||this.angle===-180||this.angle===180||this.angle===360;this.labelPosition==="Outside"&&!j&&ca(this.rotatedLabel)?this.maxLabelSize=new ni(this.maxLabelSize.height,this.maxLabelSize.width):this.maxLabelSize=Pg(this.labelStyle,this.rotatedLabel,this.angle,e)}e.multiLevelLabelModule&&this.multiLevelLabels.length>0&&e.multiLevelLabelModule.getMultilevelLabelsHeight(this)},t.prototype.findMultiRows=function(e,i,r,n){for(var s,l,h,c=[],u,p=e-1;p>=0;p--)s=this.visibleLabels[p],h=n?s.breakLabelSize.width:s.size.width,l=Er(s.value,this)*this.rect.width+this.rect.x,u=this.isAxisInverse?i+r.size.width>l-h*.5:i<l+h*.5,u?(c.push(s.index),r.index=r.index>s.index?r.index:s.index+1):r.index=c.indexOf(s.index)>-1?r.index:s.index;var f=(n?r.breakLabelSize.height:r.size.height)*r.index+5*(r.index-1);f>this.maxLabelSize.height&&(this.maxLabelSize.height=f)},t.prototype.getModule=function(e){this.valueType==="Double"?this.baseModule=new vg(e):this.baseModule=e[On(this.valueType)+"Module"]},t.prototype.setIsInversedAndOpposedPosition=function(e){e===void 0&&(e=!1),this.isAxisOpposedPosition=this.opposedPosition||!e&&this.isRTLEnabled&&this.orientation=="Vertical",this.isAxisInverse=this.isInversed||this.isRTLEnabled&&this.orientation=="Horizontal"},ut([(0,a.Zz)(Mr.axisLabelFont,Pr)],t.prototype,"labelStyle",void 0),ut([(0,a.Zz)({},sx)],t.prototype,"crosshairTooltip",void 0),ut([(0,a.Z9)("")],t.prototype,"title",void 0),ut([(0,a.Zz)(Mr.axisTitleFont,Pr)],t.prototype,"titleStyle",void 0),ut([(0,a.Z9)("")],t.prototype,"labelFormat",void 0),ut([(0,a.Z9)("")],t.prototype,"skeleton",void 0),ut([(0,a.Z9)("DateTime")],t.prototype,"skeletonType",void 0),ut([(0,a.Z9)("Center")],t.prototype,"lineBreakAlignment",void 0),ut([(0,a.Z9)(0)],t.prototype,"plotOffset",void 0),ut([(0,a.Z9)(null)],t.prototype,"plotOffsetLeft",void 0),ut([(0,a.Z9)(null)],t.prototype,"plotOffsetTop",void 0),ut([(0,a.Z9)(null)],t.prototype,"plotOffsetRight",void 0),ut([(0,a.Z9)(null)],t.prototype,"plotOffsetBottom",void 0),ut([(0,a.Z9)(!1)],t.prototype,"isIndexed",void 0),ut([(0,a.Z9)(10)],t.prototype,"logBase",void 0),ut([(0,a.Z9)(0)],t.prototype,"columnIndex",void 0),ut([(0,a.Z9)(0)],t.prototype,"rowIndex",void 0),ut([(0,a.Z9)(1)],t.prototype,"span",void 0),ut([(0,a.Z9)(null)],t.prototype,"desiredIntervals",void 0),ut([(0,a.Z9)(3)],t.prototype,"maximumLabels",void 0),ut([(0,a.Z9)(1)],t.prototype,"zoomFactor",void 0),ut([(0,a.Z9)(0)],t.prototype,"zoomPosition",void 0),ut([(0,a.Z9)(!0)],t.prototype,"enableScrollbarOnZooming",void 0),ut([(0,a.Z9)(!1)],t.prototype,"opposedPosition",void 0),ut([(0,a.Z9)(!0)],t.prototype,"enableAutoIntervalOnZooming",void 0),ut([(0,a.Z9)("Auto")],t.prototype,"rangePadding",void 0),ut([(0,a.Z9)("Double")],t.prototype,"valueType",void 0),ut([(0,a.Z9)("None")],t.prototype,"edgeLabelPlacement",void 0),ut([(0,a.Z9)("Auto")],t.prototype,"intervalType",void 0),ut([(0,a.Z9)("BetweenTicks")],t.prototype,"labelPlacement",void 0),ut([(0,a.Z9)("Outside")],t.prototype,"tickPosition",void 0),ut([(0,a.Z9)("Outside")],t.prototype,"labelPosition",void 0),ut([(0,a.Z9)("")],t.prototype,"name",void 0),ut([(0,a.Z9)(!0)],t.prototype,"visible",void 0),ut([(0,a.Z9)(0)],t.prototype,"minorTicksPerInterval",void 0),ut([(0,a.Z9)(0)],t.prototype,"labelRotation",void 0),ut([(0,a.Z9)(null)],t.prototype,"crossesAt",void 0),ut([(0,a.Z9)(!0)],t.prototype,"placeNextToAxisLine",void 0),ut([(0,a.Z9)(null)],t.prototype,"crossesInAxis",void 0),ut([(0,a.Z9)(null)],t.prototype,"minimum",void 0),ut([(0,a.Z9)(null)],t.prototype,"maximum",void 0),ut([(0,a.Z9)(null)],t.prototype,"interval",void 0),ut([(0,a.Z9)(34)],t.prototype,"maximumLabelWidth",void 0),ut([(0,a.Z9)(!1)],t.prototype,"enableTrim",void 0),ut([(0,a.Z9)(5)],t.prototype,"labelPadding",void 0),ut([(0,a.Z9)(5)],t.prototype,"titlePadding",void 0),ut([(0,a.Zz)({},rx)],t.prototype,"majorTickLines",void 0),ut([(0,a.Zz)({},nx)],t.prototype,"minorTickLines",void 0),ut([(0,a.Zz)({},ex)],t.prototype,"majorGridLines",void 0),ut([(0,a.Zz)({},tx)],t.prototype,"minorGridLines",void 0),ut([(0,a.Zz)({},ix)],t.prototype,"lineStyle",void 0),ut([(0,a.Z9)("Trim")],t.prototype,"labelIntersectAction",void 0),ut([(0,a.Z9)(!1)],t.prototype,"isInversed",void 0),ut([(0,a.Z9)(100)],t.prototype,"coefficient",void 0),ut([(0,a.Z9)(0)],t.prototype,"startAngle",void 0),ut([(0,a.Z9)(!0)],t.prototype,"startFromZero",void 0),ut([(0,a.Z9)(null)],t.prototype,"description",void 0),ut([(0,a.Z9)(2)],t.prototype,"tabIndex",void 0),ut([(0,a.FE)([],Gw)],t.prototype,"stripLines",void 0),ut([(0,a.FE)([],Kw)],t.prototype,"multiLevelLabels",void 0),ut([(0,a.Zz)({color:null,width:0,type:"Rectangle"},Og)],t.prototype,"border",void 0),ut([(0,a.Zz)({},$w)],t.prototype,"scrollbarSettings",void 0),t}(a.rt),ax=function(){function o(t,e,i,r,n,s,l){n===void 0&&(n=new ni(0,0)),s===void 0&&(s=new ni(0,0)),l===void 0&&(l=1),this.text=t,this.originalText=r,this.value=e,this.labelStyle=i,this.size=n,this.breakLabelSize=s,this.index=l}return o}(),Rg=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}();function Mg(o,t,e){var i=(0,a.l7)([],o,null);return i.sort(function(r,n){for(var s=0,l=0,h=0;h<t.length;h++)s+=r[t[h]],l+=n[t[h]];return!e&&s<l||e&&s>l?-1:s===l?0:1}),i}function ca(o){return o.indexOf("<br>")!==-1}function ua(o){for(var t=(0,a.l7)([],o.points,null,!0),e=[],i,r=0,n=0;n<t.length;n++)i=t[n],!((0,a.le)(i.x)||i.x==="")&&(i.index=r++,e.push(i));return e}function Pg(o,t,e,i){var r=new Is(i.element.id),n,s=[],l,h,c,u,p={id:"rotate_text",x:i.initialClipRect.x,y:i.initialClipRect.y,"font-size":o.size,"font-style":o.fontStyle,"font-family":o.fontFamily,"font-weight":o.fontWeight,transform:"rotate("+e+", 0, 0)","text-anchor":"middle"};ca(t)?(s=t.split("<br>"),n=s[0]):n=t;var f=r.createText(p,n);if(!i.delayRedraw&&!i.redraw&&i.element.appendChild(i.svgObject),typeof s!="string"&&s.length>1)for(var g=1,C=s.length;g<C;g++)l=Pt(s[g],o).height,h=p.y+g*l,c=s[g],u=r.createTSpan({x:p.x,id:p.id,y:h},c),f.appendChild(u);i.svgObject.appendChild(f);var L=f.getBoundingClientRect();return(0,a.Od)(f),!i.delayRedraw&&!i.redraw&&(0,a.Od)(i.svgObject),new ni(L.right-L.left,L.bottom-L.top)}function ui(o){if(!o)return null;var t=typeof o=="string"?xt(o):o;t&&(0,a.Od)(t)}function Os(o,t){return Math.log(o)/Math.log(t)}function to(o,t,e,i,r,n,s,l){var h=document.getElementById(r),c=Pt(o,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"}),u=c.width+5;if(t=t+u>i?t-(u+15):t,e=l?e-c.height/2:e+15,h)h.innerHTML=o,h.style.top=e.toString()+"px",h.style.left=(t+15).toString()+"px";else{h=(0,a.az)("div",{innerHTML:o,id:r,styles:"top:"+e.toString()+"px;left:"+(t+15).toString()+'px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: "Segoe UI"'}),n.appendChild(h);var p=parseInt(h.style.left.replace("px",""),10);p<0&&(h.style.left="0px")}s&&setTimeout(function(){ui(r)},1500)}function ul(o,t){return o<t.max&&o>t.min}function pa(o,t){return o<=t.max&&o>=t.min}function pl(o,t){return t.valueType==="Logarithmic"?Os(o,t.logBase):o}function ts(o,t,e,i){var r=pl(t.xValue,i.xAxis),n=o?pl(o.xValue,i.xAxis):r,s=e?pl(e.xValue,i.xAxis):r,l=Math.floor(i.xAxis.visibleRange.min),h=Math.ceil(i.xAxis.visibleRange.max);return n>=l&&n<=h||r>=l&&r<=h||s>=l&&s<=h||l>=n&&l<=s}function Ur(o){for(var t=0,e=0,i=o;e<i.length;e++){var r=i[e];t+=r}return t}function xR(o,t,e,i,r){var n=0;if(i!==null)for(var s=t+1;s<e;s++)i.indexOf(s)===-1&&(n+=o[s][r.yName]);else for(var s=t+1;s<e;s++)isNullOrUndefined(o[s][r.yName])||(n+=o[s][r.yName]);return n}function Dn(o,t){return o.x+=t.left,o.y+=t.top,o.width-=t.left+t.right,o.height-=t.top+t.bottom,o}function ox(o,t){return o.x+=t.x,o.y+=t.y,o.width-=t.x+t.width,o.height-=t.y+t.height,o}function cr(o,t,e){var i=o*Math.PI/180;return new Rt(Math.cos(i)*t+e.x,Math.sin(i)*t+e.y)}function fc(o){return o*(Math.PI/180)}function Ng(o,t,e,i){for(var r=[],n=0;n<4;n++){var s=o[n],l=s.x-t,h=s.y-e,c=l*Math.cos(fc(i))-h*Math.sin(fc(i)),u=l*Math.sin(fc(i))+h*Math.cos(fc(i));s.x=c+t,s.y=u+e,r.push(new Rt(s.x,s.y))}return r}function Bg(o,t){var e=[o,t],i,r,n,s,l,h,c,u;for(s=0;s<e.length;s++){var p=e[s];for(l=0;l<p.length;l++){var f=(l+1)%p.length,g=p[l],C=p[f],L=new Rt(C.y-g.y,g.x-C.x);for(i=r=void 0,h=0;h<o.length;h++)n=L.x*o[h].x+L.y*o[h].y,((0,a.le)(i)||n<i)&&(i=n),((0,a.le)(r)||n>r)&&(r=n);for(c=u=void 0,h=0;h<t.length;h++)n=L.x*t[h].x+L.y*t[h].y,((0,a.le)(c)||n<c)&&(c=n),((0,a.le)(u)||n>u)&&(u=n);if(r<c||u<i)return!1}}return!0}function lx(o,t,e,i,r,n){var s=cr(270,e,new Rt(o,t)),l=cr(270,e,new Rt(o+r/10,t));return"M "+o+" "+t+" L "+(o+e)+" "+t+" A "+e+" "+e+" "+0+" "+1+" "+1+" "+s.x+" "+s.y+" Z M "+(o+r/10)+" "+(t-i/10)+" L"+(o+e)+" "+(t-i/10)+" A "+e+" "+e+" "+0+" "+0+" "+0+" "+l.x+" "+l.y+" Z"}function hx(o,t){var e=Math.atan2(t.y-o.y,t.x-o.x);return e=e<0?6.283+e:e,e*(180/Math.PI)}function vc(o,t){for(var e=[],i=0;i<=t-1;i++)e.push(o[i]);return e}function Er(o,t){var e=t.visibleRange,i=(o-e.min)/e.delta,r=t.isChart?t.isAxisInverse:t.isInversed;return r?1-i:i}function dl(o,t,e,i,r,n){o=e.valueType==="Logarithmic"?Os(o>1?o:1,e.logBase):o,t=i.valueType==="Logarithmic"?Os(t>1?t:1,i.logBase):t,o+=e.valueType==="Category"&&e.labelPlacement==="BetweenTicks"&&n.type!=="Radar"?.5:0;var s=n.chart.radius*Er(t,i),l=cx(ux(o,e),n.chart.primaryXAxis.startAngle);return{x:n.clipRect.width/2+n.clipRect.x+s*l.x,y:n.clipRect.height/2+n.clipRect.y+s*l.y}}function mc(o,t){t===void 0&&(t=!1);var e=["NaN","NaN"];return o.indexOf("_Point_")>-1?e=o.split("_Series_")[1].split("_Point_"):o.indexOf("_shape_")>-1&&(!t||t&&o.indexOf("_legend_")===-1)?(e=o.split("_shape_"),e[0]="0"):o.indexOf("_text_")>-1&&(!t||t&&o.indexOf("_legend_")===-1)&&(e=o.split("_text_"),e[0]="0"),new Dw(parseInt(e[0],10),parseInt(e[1],10))}function cx(o,t){t=t<0?t+360:t;var e=Math.PI*(1.5-2*o);return e=e+t*Math.PI/180,{x:Math.cos(e),y:Math.sin(e)}}function ux(o,t){var e=t.visibleRange,i,r;return t.valueType!=="Category"?(i=e.max-(t.valueType==="DateTime"?t.dateTimeInterval:e.interval)-e.min,r=t.visibleLabels.length-1,i=i===0?1:i):(i=t.visibleLabels.length===1?1:t.visibleLabels[t.visibleLabels.length-1].value-t.visibleLabels[0].value,r=t.visibleLabels.length),t.isAxisInverse?(o-e.min)/i*(1-1/r):1-(o-e.min)/i*(1-1/r)}var ER=function(){function o(t,e,i,r,n,s){this.verticalStandardMean=t,this.horizontalStandardMean=i,this.verticalSquareRoot=e,this.horizontalSquareRoot=r,this.verticalMean=n,this.horizontalMean=s}return o}(),AR=function(){function o(t,e,i,r,n){this.startAngle=t,this.endAngle=e,this.innerRadius=i,this.radius=r,this.currentXPosition=n}return o}();function TR(o,t,e,i,r){var n=xt(o),s="top:"+e.toString()+"px;left:"+i.toString()+"px;color:black !important; background:#FFFFFF !important; position:absolute;border:1px solid #707070;font-size:"+r+";border-radius:2px; z-index:1";n?(n.setAttribute("innerHTML","&nbsp;"+t+"&nbsp;"),n.setAttribute("styles",s)):(n=createElement("div",{id:o,innerHTML:"&nbsp;"+t+"&nbsp;",styles:s}),document.body.appendChild(n))}function px(o,t,e,i,r,n){for(var s=5,l=t.isAxisOpposedPosition,h=r?"start":"auto",c,u=o.availableSize.width,p,f,g,C=3,L,D,R=t.scrollbarSettings.enable||t.zoomingScrollBar&&t.zoomingScrollBar.svgObject?t.scrollBarHeight:0,B=0;B<2;B++){if(c=Pt(B?t.endLabel:t.startLabel,t.labelStyle),r?(L=B?new Rt(n.x-R,n.y+C):new Rt(t.rect.x-R,n.y+n.height-C),f=n.x+(l?n.width+s+R:-(c.width+s+s+R)),g=n.y+(B?0:n.height-c.height-s),f+=f<0||u<f+c.width+s?l?-(c.width/2):c.width/2:0,D=Fg(C,C,new ft(f,g,c.width+s,c.height+s),L,s,!1,!1,!l,L.x,L.y+(B?-C:C))):(L=B?new Rt(n.x+n.width-C,n.y+n.height+R):new Rt(n.x+C,n.y+n.height+R),f=n.x+(B?n.width-c.width-s:0),g=l?n.y-c.height-10-R:n.y+n.height+s+R,D=Fg(C,C,new ft(f,g,c.width+s,c.height+s),L,s,l,!l,!1,L.x+(B?C:-C),L.y)),f=f+s/2,g=g+3*(c.height/4)+s/2,p=o.renderer.drawPath({id:o.element.id+"_Zoom_"+i+"_AxisLabel_Shape_"+B,fill:o.themeStyle.crosshairFill,width:2,color:o.themeStyle.crosshairFill,opacity:1,"stroke-dasharray":null,d:D},null),e.appendChild(p),o.theme==="Fluent"||o.theme==="FluentDark"){var H=o.element.id+"_shadow";p.setAttribute("filter",a.AR.isIE?"":"url(#"+H+")");var j='<filter id="'+H+'" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="3"/>';j+='<feOffset dx="3" dy="3" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="0.5"/>',j+='</feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';var W=o.renderer.createDefs();W.setAttribute("id",o.element.id+"SVG_tooltip_definition"),e.appendChild(W),W.innerHTML=j,p.setAttribute("stroke","#cccccc"),p.setAttribute("stroke-width","0.5")}mr(o.renderer,new fr(o.element.id+"_Zoom_"+i+"_AxisLabel_"+B,f,g,h,B?t.endLabel:t.startLabel),{color:o.themeStyle.crosshairLabel,fontFamily:"Segoe UI",fontWeight:"Regular",size:"11px"},o.themeStyle.crosshairLabel,e)}return e}function Fg(o,t,e,i,r,n,s,l,h,c){var u="",p=e.x,f=e.y,g=e.x+e.width,C=e.y+e.height;return n?(u=u.concat("M "+p+" "+(f+t)+" Q "+p+" "+f+" "+(p+o)+" "+f),u=u.concat(" L "+(g-o)+" "+f+" Q "+g+" "+f+" "+g+" "+(f+t)),u=u.concat(" L "+g+" "+(C-t)+" Q "+g+" "+C+" "+(g-o)+" "+C),r!==0&&(u=u.concat(" L "+(i.x+r/2)+" "+C),u=u.concat(" L "+h+" "+(C+r)+" L "+(i.x-r/2)+" "+C)),i.x-r/2>p||r===0?u=u.concat(" L "+(p+o)+" "+C+" Q "+p+" "+C+" "+p+" "+(C-t)+" z"):u=u.concat(" L "+p+" "+(C+t)+" z")):s?(u=u.concat("M "+p+" "+(f+t)+" Q "+p+" "+f+" "+(p+o)+" "+f+" L "+(i.x-r/2)+" "+f),u=u.concat(" L "+h+" "+i.y),u=u.concat(" L "+(i.x+r/2)+" "+f),u=u.concat(" L "+(g-o)+" "+f+" Q "+g+" "+f+" "+g+" "+(f+t)),u=u.concat(" L "+g+" "+(C-t)+" Q "+g+" "+C+" "+(g-o)+" "+C),u=u.concat(" L "+(p+o)+" "+C+" Q "+p+" "+C+" "+p+" "+(C-t)+" z")):l?(u=u.concat("M "+p+" "+(f+t)+" Q "+p+" "+f+" "+(p+o)+" "+f),u=u.concat(" L "+(g-o)+" "+f+" Q "+g+" "+f+" "+g+" "+(f+t)+" L "+g+" "+(i.y-r/2)),u=u.concat(" L "+(g+r)+" "+c),u=u.concat(" L "+g+" "+(i.y+r/2)),u=u.concat(" L "+g+" "+(C-t)+" Q "+g+" "+C+" "+(g-o)+" "+C),u=u.concat(" L "+(p+o)+" "+C+" Q "+p+" "+C+" "+p+" "+(C-t)+" z")):(u=u.concat("M "+(p+o)+" "+f+" Q "+p+" "+f+" "+p+" "+(f+t)+" L "+p+" "+(i.y-r/2)),u=u.concat(" L "+(p-r)+" "+c),u=u.concat(" L "+p+" "+(i.y+r/2)),u=u.concat(" L "+p+" "+(C-t)+" Q "+p+" "+C+" "+(p+o)+" "+C),u=u.concat(" L "+(g-o)+" "+C+" Q "+g+" "+C+" "+g+" "+(C-t)),u=u.concat(" L "+g+" "+(f+t)+" Q "+g+" "+f+" "+(g-o)+" "+f+" z")),u}function sn(o,t,e,i,r){return i===void 0&&(i=0),r===void 0&&(r=0),o>=e.x-i&&o<=e.x+e.width+i&&t>=e.y-r&&t<=e.y+e.height+r}function dx(o,t,e){var i=e.isAxisInverse?1-o/t:o/t;return i*e.visibleRange.delta+e.visibleRange.min}function fx(o,t,e){var i=e.isAxisInverse?o/t:1-o/t;return i*e.visibleRange.delta+e.visibleRange.min}function vx(o,t){t===void 0&&(t=!1);var e=o.clipRect;t&&o.chart.chartAreaType==="PolarRadar"?o.drawType==="Scatter"?(e.x=o.xAxis.rect.x,e.y=o.yAxis.rect.y,e.width=o.xAxis.rect.width,e.height=o.yAxis.rect.height):(e.x=o.xAxis.rect.x/2,e.y=o.yAxis.rect.y/2,e.width=o.xAxis.rect.width,e.height=o.yAxis.rect.height):o.chart.requireInvertedAxis?(e.x=o.yAxis.rect.x,e.y=o.xAxis.rect.y,e.width=o.yAxis.rect.width,e.height=o.xAxis.rect.height):(e.x=o.xAxis.rect.x,e.y=o.yAxis.rect.y,e.width=o.xAxis.rect.width,e.height=o.yAxis.rect.height)}function On(o){return o.substr(0,1).toLowerCase()+o.substr(1)}function LR(o,t,e){var i,r,n,s;return e?(i=t.rect.x,r=o.rect.y,n=t.rect.width,s=o.rect.height):(i=o.rect.x,r=t.rect.y,n=o.rect.width,s=t.rect.height),new Rect(i,r,n,s)}function Hg(o,t){for(var e=Number.MAX_VALUE,i,r,n,s=0;s<t.length;s++){var l=t[s];if(i=[],l.visible&&(o.name===l.xAxisName||o.name==="primaryXAxis"&&l.xAxisName===null||o.name===l.chart.primaryXAxis.name&&!l.xAxisName))if(i=l.points.map(function(u){return u.xValue}),i.sort(function(u,p){return u-p}),i.length===1)n=o.valueType==="DateTime"&&l.xMin===l.xMax?l.xMin-2592e6:l.xMin,r=i[0]-((0,a.le)(n)?o.visibleRange.min:n),r!==0&&(e=Math.min(e,r));else for(var h=0;h<i.length;h++){var c=i[h];h>0&&c&&(r=c-i[h-1],r!==0&&(e=Math.min(e,r)))}}return e===Number.MAX_VALUE&&(e=1),e}function Ad(o){var t;switch(o){case"Linear":t=ur;break}return t}function ur(o,t,e,i){return-e*Math.cos(o/i*(Math.PI/2))+e+t}function fl(o,t,e,i,r,n,s){var l=n.x,h=n.y,c=0;o.style.visibility="hidden",new a.fw({}).animate(o,{duration:e,delay:t,progress:function(u){u.timeStamp>u.delay&&(u.element.style.visibility="visible",c=(u.timeStamp-u.delay)/u.duration,o.setAttribute("transform","translate("+l+" "+h+") scale("+c+") translate("+-l+" "+-h+")"))},end:function(){o.style.visibility="",(i.type==="Scatter"||i.type==="Bubble")&&!s&&r===i.points.length-1&&i.chart.trigger("animationComplete",{series:i.chart.isBlazor?{}:i})}})}function mx(o,t,e,i,r){var n=function(s){o.setAttribute("x",s.x+""),o.setAttribute("y",s.y+""),o.setAttribute("width",s.width+""),o.setAttribute("height",s.height+"")};new a.fw({}).animate((0,a.az)("div"),{duration:e,delay:t,progress:function(s){n(new ft(ur(s.timeStamp,r.x,i.x-r.x,s.duration),ur(s.timeStamp,r.y,i.y-r.y,s.duration),ur(s.timeStamp,r.width,i.width-r.width,s.duration),ur(s.timeStamp,r.height,i.height-r.height,s.duration)))},end:function(){n(i)}})}function gc(o,t,e,i,r){if(!e||!i&&!o)return null;var n=300;r&&(n=r);var s=i||o.getAttribute("d"),l=s.split(/(?=[LMCZAQ])/),h=t.split(/(?=[LMCZAQ])/),c,u=[],p=[],f,g;o.setAttribute("d",s),new a.fw({}).animate((0,a.az)("div"),{duration:n,progress:function(C){c="",l.map(function(L,D){if(u=L.split(" "),p=h[D]?h[D].split(" "):u,u[0]==="Z"?c+="Z ":c+=u[0]+" "+ur(C.timeStamp,+u[1],+p[1]-+u[1],C.duration)+" "+ur(C.timeStamp,+u[2],+p[2]-+u[2],C.duration)+" ",u[0]==="C"||u[0]==="Q")for(f=3,g=u[0]==="Q"?4:6;f<g;)c+=ur(C.timeStamp,+u[f],+p[f]-+u[f],C.duration)+" "+ur(C.timeStamp,+u[++f],+p[f]-+u[f],C.duration)+" ",++f;u[0]==="A"&&(c+=0+" "+0+" "+1+" "+ur(C.timeStamp,+u[6],+p[6]-+u[6],C.duration)+" "+ur(C.timeStamp,+u[7],+p[7]-+u[7],C.duration)+" ")}),o.setAttribute("d",c)},end:function(){o.setAttribute("d",t)}})}function da(o,t,e,i){i===void 0&&(i="drawClipPath");var r=is(o,t.id,t,e);if(r){var n=e.createDefs();return n.appendChild(r),n}else return e[i](t)}function Td(o,t,e,i,r){var n={cancel:!1,name:gg,axis:r,text:e,value:t,labelStyle:i};if(o.trigger(gg,n),!n.cancel){var s=n.text.indexOf("<br>")!==-1,l=r.enableTrim?s?Tx(r.maximumLabelWidth,n.text,r.labelStyle):Rn(r.maximumLabelWidth,n.text,r.labelStyle):n.text;r.visibleLabels.push(new ax(l,n.value,n.labelStyle,n.text))}}function Ld(o){return o.minimum!=null&&o.maximum!=null}function vl(o){return o.zoomFactor<1&&o.zoomPosition>=0}function Vg(o,t){var e=t.orientation==="Horizontal"?o.width:o.height;if((0,a.le)(t.desiredIntervals)){var i=(t.orientation==="Horizontal"?.533:1)*t.maximumLabels;return i=Math.max(e*(i/100),1),i}else return t.desiredIntervals}function kd(o,t,e,i,r){new a.fw({}).animate(o,{duration:e,delay:t,name:i,progress:function(n){n.element.style.visibility="visible"},end:function(n){r?(0,a.Od)(n.element):n.element.style.visibility="visible"}})}function qr(o,t,e,i,r,n,s,l,h,c){var u=s||new Is(""),p=gx(o,e,t,r,i,h,c),f=u["draw"+p.functionName](p.renderOption,l?new Int32Array([l.x,l.y]):null);return f}function gx(o,t,e,i,r,n,s){var l,h="Path",c=n,u=c&&e==="Circle"?t.width-2:t.width,p=c&&e==="Circle"?t.height-2:t.height,f=c?s.targetWidth:0,g=o.x,C=o.y,L=o.y+-p/2,D=o.x+-u/2,R=72,B,H;switch(e){case"Bubble":case"Circle":h="Ellipse",(0,a.TS)(i,{rx:u/2,ry:p/2,cx:g,cy:C});break;case"Cross":l="M "+D+" "+C+" L "+(g+u/2)+" "+C+" M "+g+" "+(C+p/2)+" L "+g+" "+(C+-p/2),(0,a.TS)(i,{d:l,stroke:i.fill});break;case"Multiply":l="M "+(g-f)+" "+(C-f)+" L "+(g+f)+" "+(C+f)+" M "+(g-f)+" "+(C+f)+" L "+(g+f)+" "+(C-f),(0,a.TS)(i,{d:l,stroke:i.fill});break;case"HorizontalLine":l="M "+D+" "+C+" L "+(g+u/2)+" "+C,(0,a.TS)(i,{d:l});break;case"VerticalLine":l="M "+g+" "+(C+p/2)+" L "+g+" "+(C+-p/2),(0,a.TS)(i,{d:l});break;case"Diamond":l="M "+D+" "+C+" L "+g+" "+(C+-p/2)+" L "+(g+u/2)+" "+C+" L "+g+" "+(C+p/2)+" L "+D+" "+C+" z",(0,a.TS)(i,{d:l});break;case"ActualRect":l="M "+D+" "+(C+-p/8)+" L "+(g+f)+" "+(C+-p/8)+" L "+(g+f)+" "+(C+p/8)+" L "+D+" "+(C+p/8)+" L "+D+" "+(C+-p/8)+" z",(0,a.TS)(i,{d:l});break;case"TargetRect":l="M "+(D+f)+" "+(C+-p/2)+" L "+(g+f/2)+" "+(C+-p/2)+" L "+(g+f/2)+" "+(C+p/2)+" L "+(D+f)+" "+(C+p/2)+" L "+(D+f)+" "+(C+-p/2)+" z",(0,a.TS)(i,{d:l});break;case"Rectangle":case"Hilo":case"HiloOpenClose":case"Candle":case"Waterfall":case"BoxAndWhisker":case"StepArea":case"StackingStepArea":case"Square":case"Flag":l="M "+D+" "+(C+-p/2)+" L "+(g+u/2)+" "+(C+-p/2)+" L "+(g+u/2)+" "+(C+p/2)+" L "+D+" "+(C+p/2)+" L "+D+" "+(C+-p/2)+" z",(0,a.TS)(i,{d:l});break;case"Pyramid":case"Triangle":l="M "+D+" "+(C+p/2)+" L "+g+" "+(C+-p/2)+" L "+(g+u/2)+" "+(C+p/2)+" L "+D+" "+(C+p/2)+" z",(0,a.TS)(i,{d:l});break;case"Funnel":case"InvertedTriangle":l="M "+(g+u/2)+" "+(C-p/2)+" L "+g+" "+(C+p/2)+" L "+(g-u/2)+" "+(C-p/2)+" L "+(g+u/2)+" "+(C-p/2)+" z",(0,a.TS)(i,{d:l});break;case"Pentagon":for(var j=0;j<=5;j++)B=u/2*Math.cos(Math.PI/180*(j*R)),H=p/2*Math.sin(Math.PI/180*(j*R)),j===0?l="M "+(g+B)+" "+(C+H)+" ":l=l.concat("L "+(g+B)+" "+(C+H)+" ");l=l.concat("Z"),(0,a.TS)(i,{d:l});break;case"Image":h="Image",(0,a.TS)(i,{href:r,height:p,width:u,x:D,y:L});break}return i=Ax(o,new ni(u,p),e,i).renderOption,{renderOption:i,functionName:h}}function kR(o,t,e){var i=t.x<e.x?e.x:t.x>e.x+e.width?e.x+e.width:t.x,r=t.y<e.y?e.y:t.y>e.y+e.height?e.y+e.height:t.y;return new Rect(i>o.x?o.x:i,r>o.y?o.y:r,Math.abs(i-o.x),Math.abs(r-o.y))}function IR(o,t,e){return o>e?e:o<t?t:o}function xt(o){return document.getElementById(o)}function yx(o){var t=null;try{document.querySelectorAll(o).length?t=(0,a.MY)(document.querySelector(o).innerHTML.trim()):t=(0,a.MY)(o)}catch(e){t=(0,a.MY)(o)}return t}function bx(o,t,e,i,r,n,s,l,h,c){var u=o.getBoundingClientRect();t.accumulationDataLabelModule.calculateLabelSize(e,o,n,i,r,s,l,h,c,u,!0)}function Cx(o,t,e,i,r,n){var s=document.getElementById(t.element.id+"_Series_"+(i.index===void 0?i.category:i.index)+"_DataLabelCollections");s&&(e.index===0&&(t.dataLabelCollections=[]),t.dataLabelModule.calculateTemplateLabelSize(s,o,e,i,i.marker.dataLabel,r,i.clipRect,n,!0))}function zg(o,t,e,i,r,n,s,l,h,c,u,p,f,g,C){var L=yx(e),D;try{var R="Blazor",B=window[R]?s?r:{point:r}:{chart:i,series:n,point:r},H=s?s+"_template":"template",j=L?L(B,i,H,s||o.id.replace(/[^a-zA-Z0-9]/g,"")):[];if(j.length){D=Array.prototype.slice.call(j);for(var W=D.length,ne=0;ne<W;ne++)o.appendChild(D[ne])}var ie=void 0;i.getModuleName()==="accumulationchart"?(ie=bx.bind(this,o,i,c,u,h,u[t],p,f,g,C),i.isReact&&i.renderReactTemplates(ie)):i.getModuleName()==="chart"&&(ie=r&&n?Cx.bind(this,o,i,r,n,l,C):ie,i.isReact&&i.renderReactTemplates(ie))}catch(me){return o}return o}function _g(o){var t="";return t="font-size:"+o.size+"; font-style:"+o.fontStyle+"; font-weight:"+o.fontWeight+"; font-family:"+o.fontFamily+";opacity:"+o.opacity+"; color:"+o.color+";",t}function jg(o,t,e){t===void 0&&(t=!1),e||document.body.appendChild(o);var i=o.getBoundingClientRect();return t?(0,a.Od)(o):e||ui(o.id),i}function Sx(o,t){for(var e,i=0,r=o.length;i<r;i++)if(o[i].id.indexOf(t)>-1){e=o[i];continue}return e}function Ar(o,t,e,i,r){o=e.valueType==="Logarithmic"?Os(o>0?o:Math.pow(e.logBase,e.visibleRange.min),e.logBase):o,t=i.valueType==="Logarithmic"?Os(t>0?t:Math.pow(i.logBase,i.visibleRange.min),i.logBase):t,o=Er(o,e),t=Er(t,i);var n=r?e.rect.height:e.rect.width,s=r?i.rect.width:i.rect.height,l=r?t*s:o*n,h=r?(1-o)*n:(1-t)*s;return new Rt(l,h)}function DR(o,t,e,i,r,n){if(e===void 0&&(e=!1),i===void 0&&(i=!1),r===void 0&&(r="x"),n===void 0&&(n="y"),o&&o.hasChildNodes()&&t)Nt(!1,t,o,e,i,r,n);else return null}function Nt(o,t,e,i,r,n,s,l,h,c,u,p,f){if(r===void 0&&(r=!1),n===void 0&&(n="x"),s===void 0&&(s="y"),c===void 0&&(c=!1),u===void 0&&(u=!1),p===void 0&&(p=null),o)return null;var g=t.querySelector("#"+e.id),C=g||xt(e.id),L=e,D=f||300;if(i&&r&&C)if(l=l||(C.tagName==="DIV"?new Rt(+C.style[n].split("px")[0],+C.style[s].split("px")[0]):new Rt(+C.getAttribute(n),+C.getAttribute(s))),h&&h!=="undefined")gc(e,e.getAttribute("d"),i,h,D);else if(u&&p)mx(L,0,D,new ft(+C.getAttribute("x"),+C.getAttribute("y"),+C.getAttribute("width"),+C.getAttribute("height")),p);else{var R=L.tagName==="DIV"?new Rt(+L.style[n].split("px")[0],+L.style[s].split("px")[0]):new Rt(+L.getAttribute(n),+L.getAttribute(s));Lx(L,D,l,R,n,s)}else i&&r&&!C&&c&&kd(L,0,600,"FadeIn");g?t.replaceChild(L,C):t.appendChild(L)}function OR(o,t,e,i,r){var n=Math.abs(o-e),s=Math.abs(t-i),l=Math.max(Wg(Math.min(o,e),n,r.x,r.width),r.x),h=Math.max(Wg(Math.min(t,i),s,r.y,r.height),r.y);return new Rect(l,h,Math.min(n,r.width),Math.min(s,r.height))}function Wg(o,t,e,i){return o<e?o=e:o+t>i+e&&(o=i+e-t),o}function wx(o,t,e){var i=t.yAxis.labelFormat,r=[],n=i.match("{value}")!==null;switch(t.seriesType){case"XY":t.chart.chartAreaType==="PolarRadar"?t.drawType.indexOf("Stacking")!==-1?(t.yAxis.valueType==="Logarithmic"&&pl(t.stackedValues.endValues[o.index],t.yAxis)||pa(t.stackedValues.endValues[o.index],t.yAxis.visibleRange))&&r.push(o.text||o.yValue.toString()):(t.yAxis.valueType==="Logarithmic"&&pl(o.yValue,t.yAxis)||pa(o.yValue,t.yAxis.visibleRange))&&r.push(o.text||o.yValue.toString()):r.push(o.text||o.yValue.toString());break;case"HighLow":r.push(o.text||Math.max(o.high,o.low).toString()),r.push(o.text||Math.min(o.high,o.low).toString());break;case"HighLowOpenClose":r.push(o.text||Math.max(o.high,o.low).toString()),r.push(o.text||Math.min(o.high,o.low).toString()),r.push(o.text||Math.max(o.open,o.close).toString()),r.push(o.text||Math.min(o.open,o.close).toString());break;case"BoxPlot":r.push(o.text||o.median.toString()),r.push(o.text||o.maximum.toString()),r.push(o.text||o.minimum.toString()),r.push(o.text||o.upperQuartile.toString()),r.push(o.text||o.lowerQuartile.toString());for(var s=0,l=o.outliers;s<l.length;s++){var h=l[s];r.push(o.text||h.toString())}break}if(i&&!o.text){t.yAxis.format=e.intl.getNumberFormat({format:n?"":i,useGrouping:e.useGroupingSeparator});for(var c=0;c<r.length;c++)r[c]=n?i.replace("{value}",t.yAxis.format(parseFloat(r[c]))):t.yAxis.format(parseFloat(r[c]))}return r}function Ug(o){window.clearInterval(o)}function ml(o,t,e){var i=new ft(o.x+e.x,o.y+e.y,o.width,o.height),r=t.some(function(n){return i.x<n.x+n.width&&i.x+i.width>n.x&&i.y<n.y+n.height&&i.height+i.y>n.y});return r}function pr(o,t){return o.x<t.x+t.width&&o.x+o.width>t.x&&o.y<t.y+t.height&&o.height+o.y>t.y}function xx(o,t){return o.x<=t.x&&o.x+o.width>=t.x+t.width&&o.y<=t.y&&o.height+o.y>=t.y+t.height}function yc(o,t,e){return new ft(o.x-t.width/2-e.left,o.y-t.height/2-e.top,t.width+e.left+e.right,t.height+e.top+e.bottom)}function qg(o){return"#"+Id(o.r)+Id(o.g)+Id(o.b)}function Id(o){var t=o.toString(16);return t.length===1?"0"+t:t}function bc(o){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(o);return t?new Sc(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)):new Sc(255,255,255)}function Zr(o){o=o==="transparent"?"white":o,document.body.appendChild((0,a.az)("text",{id:"chartmeasuretext"}));var t=document.getElementById("chartmeasuretext");t.style.color=o,o=window.getComputedStyle(t).color,(0,a.Od)(t);var e=/^(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/,i=e.exec(o);return qg(new Sc(parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10)))}function Ex(o,t){o=Zr(o),o=o.replace(/[^0-9a-f]/gi,""),o.length<6&&(o=o[0]+o[0]+o[1]+o[1]+o[2]+o[2]),t=t||0;for(var e="#",i,r=0;r<3;r++)i=parseInt(o.substr(r*2,2),16),i=Math.round(Math.min(Math.max(0,i+i*t),255)),e+=("00"+i.toString(16)).substr(i.toString(16).length);return e}function RR(o){var t=Math.floor(o.length/2);return o.length%2?o[t]:(o[t-1]+o[t])/2}function Ax(o,t,e,i){var r=10,n="",s=2,l=t.height,h=t.width,c=o.x,u=o.y;switch(e){case"MultiColoredLine":case"Line":case"StackingLine":case"StackingLine100":n="M "+(c+-h/2)+" "+u+" L "+(c+h/2)+" "+u,(0,a.TS)(i,{d:n});break;case"StepLine":i.fill="transparent",n="M "+(c+-h/2-r/4)+" "+(u+l/2)+" L "+(c+-h/2+h/10)+" "+(u+l/2)+" L "+(c+-h/2+h/10)+" "+u+" L "+(c+-h/10)+" "+u+" L "+(c+-h/10)+" "+(u+l/2)+" L "+(c+h/5)+" "+(u+l/2)+" L "+(c+h/5)+" "+(u+-l/2)+" L "+(c+h/2)+" "+(u+-l/2)+"L "+(c+h/2)+" "+(u+l/2)+" L"+(c+h/2+r/4)+" "+(u+l/2),(0,a.TS)(i,{d:n});break;case"UpArrow":i.fill=i.stroke,i.stroke="transparent",n="M "+(c+-h/2)+" "+(u+l/2)+" L "+c+" "+(u-l/2)+" L "+(c+h/2)+" "+(u+l/2)+"L "+(c+h/2-s)+" "+(u+l/2)+" L "+c+" "+(u-l/2+2*s)+"L"+(c-h/2+s)+" "+(u+l/2)+" Z",(0,a.TS)(i,{d:n});break;case"DownArrow":n="M "+(c-h/2)+" "+(u-l/2)+" L "+c+" "+(u+l/2)+" L "+(c+h/2)+" "+(u-l/2)+"L "+(c+h/2-s)+" "+(u-l/2)+" L "+c+" "+(u+l/2-2*s)+"L"+(c-h/2+s)+" "+(u-l/2)+" Z",(0,a.TS)(i,{d:n});break;case"RightArrow":n="M "+(c+-h/2)+" "+(u-l/2)+" L "+(c+h/2)+" "+u+" L "+(c+-h/2)+" "+(u+l/2)+" L "+(c+-h/2)+" "+(u+l/2-s)+" L "+(c+h/2-2*s)+" "+u+" L"+(c+-h/2)+" "+(u-l/2+s)+" Z",(0,a.TS)(i,{d:n});break;case"LeftArrow":i.fill=i.stroke,i.stroke="transparent",n="M "+(c+h/2)+" "+(u-l/2)+" L "+(c+-h/2)+" "+u+" L "+(c+h/2)+" "+(u+l/2)+" L "+(c+h/2)+" "+(u+l/2-s)+" L "+(c+-h/2+2*s)+" "+u+" L"+(c+h/2)+" "+(u-l/2+s)+" Z",(0,a.TS)(i,{d:n});break;case"Column":case"Pareto":case"StackingColumn":case"StackingColumn100":case"RangeColumn":case"Histogram":n="M "+(c-3*(h/5))+" "+(u-l/5)+" L "+(c+3*(-h/10))+" "+(u-l/5)+" L "+(c+3*(-h/10))+" "+(u+l/2)+" L "+(c-3*(h/5))+" "+(u+l/2)+" Z M "+(c+-h/10-h/20)+" "+(u-l/4-r/2)+" L "+(c+h/10+h/20)+" "+(u-l/4-r/2)+" L "+(c+h/10+h/20)+" "+(u+l/2)+" L "+(c+-h/10-h/20)+" "+(u+l/2)+" Z M "+(c+3*(h/10))+" "+u+" L "+(c+3*(h/5))+" "+u+" L "+(c+3*(h/5))+" "+(u+l/2)+" L "+(c+3*(h/10))+" "+(u+l/2)+" Z",(0,a.TS)(i,{d:n});break;case"Bar":case"StackingBar":case"StackingBar100":n="M "+(c+-h/2+-r/4)+" "+(u-3*(l/5))+" L "+(c+3*(h/10))+" "+(u-3*(l/5))+" L "+(c+3*(h/10))+" "+(u-3*(l/10))+" L "+(c-h/2+-r/4)+" "+(u-3*(l/10))+" Z M "+(c+-h/2+-r/4)+" "+(u-l/5+r/20)+" L "+(c+h/2+r/4)+" "+(u-l/5+r/20)+" L "+(c+h/2+r/4)+" "+(u+l/10+r/20)+" L "+(c-h/2+-r/4)+" "+(u+l/10+r/20)+" Z M "+(c-h/2+-r/4)+" "+(u+l/5+r/10)+" L "+(c+-h/4)+" "+(u+l/5+r/10)+" L "+(c+-h/4)+" "+(u+l/2+r/10)+" L "+(c-h/2+-r/4)+" "+(u+l/2+r/10)+" Z",(0,a.TS)(i,{d:n});break;case"Spline":i.fill="transparent",n="M "+(c-h/2)+" "+(u+l/5)+" Q "+c+" "+(u-l)+" "+c+" "+(u+l/5)+" M "+c+" "+(u+l/5)+" Q "+(c+h/2)+" "+(u+l/2)+" "+(c+h/2)+" "+(u-l/2),(0,a.TS)(i,{d:n});break;case"Area":case"MultiColoredArea":case"RangeArea":case"StackingArea":case"StackingArea100":n="M "+(c-h/2-r/4)+" "+(u+l/2)+" L "+(c+-h/4+-r/8)+" "+(u-l/2)+" L "+c+" "+(u+l/4)+" L "+(c+h/4+r/8)+" "+(u+-l/2+l/4)+" L "+(c+l/2+r/4)+" "+(u+l/2)+" Z",(0,a.TS)(i,{d:n});break;case"SplineArea":case"SplineRangeArea":n="M "+(c-h/2)+" "+(u+l/5)+" Q "+c+" "+(u-l)+" "+c+" "+(u+l/5)+" Z M "+c+" "+(u+l/5)+" Q "+(c+h/2)+" "+(u+l/2)+" "+(c+h/2)+" "+(u-l/2)+"  Z",(0,a.TS)(i,{d:n});break;case"Pie":case"Doughnut":i.stroke="transparent";var p=Math.min(l,h)/2;n=lx(c,u,p,l,h,e),(0,a.TS)(i,{d:n});break}return{renderOption:i}}function Rn(o,t,e){var i=t,r=Pt(t,e).width;if(r>o){for(var n=t.length,s=n-1;s>=0;--s)if(i=t.substring(0,s)+"...",r=Pt(i,e).width,r<=o)return i}return i}function Tx(o,t,e){for(var i=[],r=t.split("<br>"),n=0;n<r.length;n++){t=r[n];var s=Pt(t,e).width;if(s>o){for(var l=t.length,h=l-1;h>=0;--h)if(t=t.substring(0,h)+"...",s=Pt(t,e).width,s<=o){i.push(t);break}}else i.push(t)}return i}function yi(o,t){return o!=null?o.indexOf("%")!==-1?t/100*parseInt(o,10):parseInt(o,10):null}function is(o,t,e,i){if(!o)return null;var r=xt(t);return r&&e&&i.setElementAttributes(e,r.tagName==="clipPath"?r.childNodes[0]:r),r}function Lx(o,t,e,i,r,n){r===void 0&&(r="x"),n===void 0&&(n="y");var s=o.tagName==="DIV",l=function(h,c){s?(o.style[r]=h+"px",o.style[n]=c+"px"):(o.setAttribute(r,h+""),o.setAttribute(n,c+""))};l(e.x,e.y),new a.fw({}).animate((0,a.az)("div"),{duration:t,progress:function(h){l(ur(h.timeStamp,e.x,i.x-e.x,h.duration),ur(h.timeStamp,e.y,i.y-e.y,h.duration))},end:function(){l(i.x,i.y)}})}function mr(o,t,e,i,r,n,s,l,h,c,u,p,f,g){n===void 0&&(n=!1),h===void 0&&(h=!1);var C={},L,D,R,B;C={id:t.id,x:t.x,y:t.y,fill:i||"black","font-size":e.size,"font-style":e.fontStyle,"font-family":e.fontFamily,"font-weight":e.fontWeight,"text-anchor":t.anchor,labelRotation:t.labelRotation,transform:t.transform,opacity:e.opacity,"dominant-baseline":t.baseLine};var H=typeof t.text=="string"?t.text:n?t.text[t.text.length-1]:t.text[0],j=u?u.x:0,W=u?u.y:0,ne=o.createText(C,H,j,W);if(ne.style.fontFamily=e.fontFamily,ne.style.fontStyle=e.fontStyle,ne.style.fontSize=e.size,ne.style.fontWeight=e.fontWeight,ne.style.color=e.color,ne.style.textAnchor=t.anchor,typeof t.text!="string"&&t.text.length>1)for(var ie=1,me=t.text.length;ie<me;ie++)D=Pt(t.text[ie],e).height,R=t.y+(n?-(ie*D):ie*D),B=n?t.text[t.text.length-(ie+1)]:t.text[ie],g?L=o.createText(C,B,null,null,R,!0):(L=o.createTSpan({x:t.x,id:t.id,y:R},B),ne.appendChild(L));return f||Nt(o instanceof cg,r,ne,s,l,"x","y",null,null,h,!1,null,c),ne}function Dd(o){var t=o.element.clientWidth||o.element.offsetWidth,e=o.element.clientHeight;o.stockChart&&(t=o.stockChart.availableSize.width,e=o.stockChart.availableSize.height);var i=450,r;if(o.getModuleName()==="rangeNavigator"){var n=o,s=n.tooltip.enable?35:0,l=n.periodSelectorSettings.periods.length?n.periodSelectorSettings.height:0;r=n.margin.top+n.margin.bottom+s;var h=Pt("tempString",n.labelStyle).height,c=15;i=(o.series.length?a.AR.isDevice?80:120:(n.enableGrouping?40+c+h:40)+r)+l,n.disableRangeSelector&&(i=l)}if(o.availableSize=new ni(yi(o.width,t)||t||600,yi(o.height,e||i)||e||i),o.getModuleName()==="chart"){var u=1,p=1;(o.width===""||o.width===null||o.width==="100%")&&(u=o.element.getBoundingClientRect().width>0?o.element.getBoundingClientRect().width/o.availableSize.width:1,p=o.element.getBoundingClientRect().height>0?o.element.getBoundingClientRect().height/o.availableSize.height:1,o.availableSize.width=o.availableSize.width*u,o.availableSize.height=o.availableSize.height*p,o.scaleX=u,o.scaleY=p)}}function Zg(o){o.canvasRender=new cg(o.element.id),o.renderer=o.enableCanvas?o.canvasRender:new Is(o.element.id),Dd(o),o.stockChart&&o.getModuleName()==="chart"?o.svgObject=o.stockChart.chartObject:o.stockChart&&o.getModuleName()==="rangeNavigator"?o.svgObject=o.stockChart.selectorObject:o.enableCanvas?o.svgObject=o.renderer.createCanvas({id:o.element.id+"_canvas",width:o.availableSize.width,height:o.availableSize.height}):o.svgObject=o.renderer.createSvg({id:o.element.id+"_svg",width:o.availableSize.width,height:o.availableSize.height}),o.enableCanvas&&(o.renderer.ctx.direction=o.enableRtl?"rtl":"ltr")}function io(o,t,e){var i=[];switch(t.textOverflow){case"Wrap":i=yl(o,e,t);break;case"Trim":i.push(Rn(e,o,t));break;default:i.push(o);break}return i}function gl(o,t){var e;return t.textAlignment==="Near"?e=o.x:t.textAlignment==="Center"?e=o.x+o.width/2:e=o.x+o.width,e}function yl(o,t,e){for(var i=o.split(" "),r="",n=[],s,l=0,h=i.length;l<h;l++)s=i[l],Pt(r.concat(r===""?"":" "+s),e).width<t?r=r.concat((r===""?"":" ")+s):r!==""?(n.push(Rn(t,r,e)),r=s):(n.push(Rn(t,s,e)),s=""),r&&l===h-1&&n.push(Rn(t,r,e));return n}function Yg(o,t){for(var e=o.replace(t," "),i=o.match(t),r=" ",n=" ",s=0,l={"0":"\u2080","1":"\u2081","2":"\u2082","3":"\u2083","4":"\u2084","5":"\u2085","6":"\u2086","7":"\u2087","8":"\u2088","9":"\u2089"},h={"0":"\u2070","1":"\xB9","2":"\xB2","3":"\xB3","4":"\u2074","5":"\u2075","6":"\u2076","7":"\u2077","8":"\u2078","9":"\u2079"},c=0;c<=e.length-1;c++)if(e[c]===" "){r=t===uc?i[s].replace(/~/g,""):i[s].replace(/\^/g,"");for(var u=0;u<r.length;u++)n+=t===uc?l[r[u]]:h[r[u]];s++}else n+=e[c];return n.trim()}function Cc(o){for(var t=0;t<o.annotations.length;t++)(0,a.oL)((o.element.id+"_Annotation_"+t).replace(/[^a-zA-Z0-9]/g,""),"ContentTemplate");(0,a.oL)(o.element.id+"_tooltipparent_template_blazorTemplate","Template"),(0,a.oL)(o.element.id+"_DataLabel")}var MR=function(){function o(t){this.id=t}return o}(),kx=function(){function o(t,e){this.startValues=t,this.endValues=e}return o}(),Sn=function(o){Rg(t,o);function t(e,i,r,n,s,l,h,c,u){var p=o.call(this,e,i,r.width,r.color,n,u)||this;return p.y=s.y,p.x=s.x,p.height=s.height,p.width=s.width,p.rx=l||0,p.ry=h||0,p.transform=c||"",p.stroke=r.width!==0&&p.stroke!==""?r.color:"transparent",p}return t}(er),Od=function(){function o(t,e,i,r,n,s,l,h){this.height=t,this.width=e,this.href=i,this.x=r,this.y=n,this.id=s,this.visibility=l,this.preserveAspectRatio=h}return o}(),Gg=function(o){Rg(t,o);function t(e,i,r,n,s,l,h){var c=o.call(this,e,i,r.width,r.color,n)||this;return c.cy=l,c.cx=s,c.r=h,c}return t}(er),PR=function(){function o(t,e,i){this.id=t,this.points=e,this.fill=i}return o}(),Rt=function(){function o(t,e){this.x=t,this.y=e}return o}(),NR=function(){function o(t,e){this.x=0,this.y=0,this.x=t,this.y=e}return o}(),Mn=function(){function o(t,e,i,r){this.left=t,this.right=e,this.top=i,this.bottom=r}return o}(),Sc=function(){function o(t,e,i){this.r=t,this.g=e,this.b=i}return o}(),wc=function(){function o(t,e,i){i===void 0&&(i=0),this.point=t,this.series=e,this.lierIndex=i}return o}(),Kg=function(){function o(t,e,i){i===void 0&&(i=0),this.point=t,this.series=e,this.index=i}return o}(),BR=function(){function o(t,e){this.controlPoint1=t,this.controlPoint2=e}return o}();function Ix(o,t){var e="",i;return Number(t)===o.start?e=o.colors[0]:Number(t)===o.end?e=o.colors[o.colors.length-1]:(i=Dx(Number(t),o),e=qg(i)),e}function Dx(o,t){var e=t.start,i=t.end,r=0,n=i-e,s;r=(o-e)/n;var l,h;if(t.colors.length<=2)l=t.colors[0].charAt(0)==="#"?t.colors[0]:Zr(t.colors[0]),h=t.colors[t.colors.length-1].charAt(0)==="#"?t.colors[t.colors.length-1]:Zr(t.colors[t.colors.length-1]);else{l=t.colors[0].charAt(0)==="#"?t.colors[0]:Zr(t.colors[0]),h=t.colors[t.colors.length-1].charAt(0)==="#"?t.colors[t.colors.length-1]:Zr(t.colors[t.colors.length-1]);for(var c=n/(t.colors.length-1),u=void 0,p=void 0,f=t.colors.length-1,g=[],C={},L=1;L<f;L++)p=L*c,u=e+p,C={b:u,color:t.colors[L]},g.push(C);for(var D=0;D<g.length;D++)e<=o&&o<=g[D].b&&D===0?(s=g[D].color.charAt(0)==="#"?g[D].color:Zr(g[D].color),h=s,r=o<=g[D].b?1-Math.abs((o-g[D].b)/c):(o-g[D].b)/c):g[D].b<=o&&o<=i&&D===g.length-1&&(s=g[D].color.charAt(0)==="#"?g[D].color:Zr(g[D].color),l=s,r=o<g[D].b?1-Math.abs((o-g[D].b)/c):(o-g[D].b)/c),D!==g.length-1&&D<g.length&&g[D].b<=o&&o<=g[D+1].b&&(s=g[D].color.charAt(0)==="#"?g[D].color:Zr(g[D].color),l=s,h=g[D+1].color.charAt(0)==="#"?g[D+1].color:Zr(g[D+1].color),r=Math.abs(o-g[D+1].b)/c)}return Ox(r,l,h)}function Ox(o,t,e){var i=e.split("#")[1],r=t.split("#")[1],n=Rd(o,parseInt(r.substr(0,2),16),parseInt(i.substr(0,2),16)),s=Rd(o,parseInt(r.substr(2,2),16),parseInt(i.substr(2,2),16)),l=Rd(o,parseInt(r.substr(4,2),16),parseInt(i.substr(4,2),16));return new Sc(n,s,l)}function Rd(o,t,e){var i=e-t;return Math.round(t+i*o)}function bl(o,t){switch(o){case"Near":return t?"end":"start";case"Far":return t?"start":"end";default:return"middle"}}var Xg=10,Rx=function(){function o(t){this.chart=t,this.padding=5}return o.prototype.measureAxis=function(t){var e=this.chart,i=e.chartArea.width?yi(e.chartArea.width,e.availableSize.width):null;this.crossAt(e),this.seriesClipRect=new ft(t.x,t.y,t.width,t.height),this.initialClipRect=t,this.leftSize=0,this.rightSize=0,this.topSize=0,this.bottomSize=0,this.measureRowAxis(e,this.initialClipRect),this.initialClipRect=Dn(this.initialClipRect,new Mn(this.leftSize,this.rightSize,0,0)),this.measureColumnAxis(e,this.initialClipRect),this.initialClipRect=Dn(this.initialClipRect,new Mn(0,0,this.topSize,this.bottomSize)),this.chart.delayRedraw||this.calculateAxisSize(this.initialClipRect),this.leftSize=0,this.rightSize=0,this.topSize=0,this.bottomSize=0,this.measureRowAxis(e,this.initialClipRect),this.seriesClipRect=Dn(this.seriesClipRect,new Mn(this.leftSize,this.rightSize,0,0)),this.measureColumnAxis(e,this.initialClipRect),this.seriesClipRect=Dn(this.seriesClipRect,new Mn(0,0,this.topSize,this.bottomSize)),i&&this.calculateFixedChartArea(e,i),this.chart.delayRedraw||(e.refreshAxis(),this.calculateAxisSize(this.seriesClipRect))},o.prototype.calculateFixedChartArea=function(t,e){this.seriesClipRect.width=e,this.seriesClipRect.x=t.availableSize.width-t.margin.right-e-(t.legendSettings.position==="Right"?t.legendModule.legendBounds.width:0);for(var i=0,r=t.rows;i<r.length;i++){var n=r[i];this.seriesClipRect.x-=Ur(n.farSizes)}},o.prototype.measureRowAxis=function(t,e){var i;this.calculateRowSize(e);for(var r=0,n=t.rows;r<n.length;r++){var s=n[r];i=s,i.nearSizes=[],i.farSizes=[],this.arrangeAxis(i),this.measureDefinition(i,t,new ni(t.availableSize.width,i.computedHeight)),this.leftSize<Ur(i.nearSizes)&&(this.leftSize=Ur(i.nearSizes)),this.rightSize<Ur(i.farSizes)&&(this.rightSize=Ur(i.farSizes))}},o.prototype.measureColumnAxis=function(t,e){var i;this.calculateColumnSize(e);for(var r=0,n=t.columns;r<n.length;r++){var s=n[r];i=s,i.farSizes=[],i.nearSizes=[],this.arrangeAxis(i),this.measureDefinition(i,t,new ni(i.computedWidth,t.availableSize.height)),this.bottomSize<Ur(i.nearSizes)&&(this.bottomSize=Ur(i.nearSizes)),this.topSize<Ur(i.farSizes)&&(this.topSize=Ur(i.farSizes))}},o.prototype.measureDefinition=function(t,e,i){for(var r=16,n=0,s=t.axes;n<s.length;n++){var l=s[n];l.scrollBarHeight=e.scrollBarModule&&e.zoomModule&&e.zoomSettings.enableScrollbar&&l.enableScrollbarOnZooming&&e.zoomModule.isZoomed&&(l.zoomFactor<1||l.zoomPosition>0)?r:0,l.scrollBarHeight=e.scrollBarModule&&(e.zoomModule&&e.zoomSettings.enableScrollbar&&l.enableScrollbarOnZooming&&e.zoomModule.isZoomed&&(l.zoomFactor<1||l.zoomPosition>0)||l.scrollbarSettings.enable)?r:0,l.getModule(e),l.baseModule.calculateRangeAndInterval(i,l),t.computeSize(l,l.scrollBarHeight)}t.farSizes.length>0&&(t.farSizes[t.farSizes.length-1]-=Xg),t.nearSizes.length>0&&(t.nearSizes[t.nearSizes.length-1]-=Xg)},o.prototype.calculateAxisSize=function(t){var e=this.chart,i,r,n,s,l=0,h=0,c=0,u,p,f;this.calculateRowSize(t);for(var g=0,C=e.rows.length;g<C;g++){i=e.rows[g],l=0,h=0;for(var L=0,D=i.axes.length;L<D;L++){if(s=i.axes[L],f=s.plotOffset,s.rect.height===0){s.rect.height=i.computedHeight,c=0;for(var R=g+1,B=g+s.span;R<B;R++)n=e.rows[R],c+=n.computedHeight;s.rect.y=i.computedTop-c+(s.plotOffsetTop?s.plotOffsetTop:f),s.rect.height=s.rect.height+c-this.getAxisOffsetValue(s.plotOffsetTop,s.plotOffsetBottom,s.plotOffset),s.rect.width=0}s.isAxisOpposedPosition?(u=t.x+t.width+Ur(vc(i.farSizes,h)),s.rect.x=s.rect.x>=u?s.rect.x:u,h++):(u=t.x-Ur(vc(i.nearSizes,l)),s.rect.x=s.rect.x<=u?s.rect.x:u,l++)}}this.calculateColumnSize(t);for(var g=0,C=e.columns.length;g<C;g++){r=e.columns[g],l=0,h=0;for(var L=0,H=r.axes.length;L<H;L++){if(s=r.axes[L],f=s.plotOffset,s.rect.width===0){for(var R=g,j=g+s.span;R<j;R++)n=e.columns[R],s.rect.width+=n.computedWidth;s.rect.x=r.computedLeft+(s.plotOffsetLeft?s.plotOffsetLeft:f),s.rect.width-=this.getAxisOffsetValue(s.plotOffsetLeft,s.plotOffsetRight,s.plotOffset),s.rect.height=0}s.isAxisOpposedPosition?(p=t.y-Ur(vc(r.farSizes,h)),s.rect.y=s.rect.y<=p?s.rect.y:p,h++):(p=t.y+t.height+Ur(vc(r.nearSizes,l)),s.rect.y=s.rect.y>=p?s.rect.y:p,l++)}}},o.prototype.measure=function(){for(var t=this.chart,e,i,r,n,s,l=0,h=t.axisCollections;l<h.length;l++){var c=h[l];if(c.orientation==="Vertical"){t.verticalAxes.push(c),n=this.getActualRow(c),e=t.rows[n],this.pushAxis(e,c),s=n+c.span>t.rows.length?t.rows.length:n+c.span;for(var u=n+1;u<s;u++)r=t.rows[u],r.axes[e.axes.length-1]=c,t.rows[u]=r;t.rows[n]=e}else{t.horizontalAxes.push(c),n=this.getActualColumn(c),i=t.columns[n],this.pushAxis(i,c),s=n+c.span>t.columns.length?t.columns.length:n+c.span;for(var u=n+1;u<s;u++)r=t.columns[u],r.axes[i.axes.length-1]=c,t.columns[u]=r;t.columns[n]=i}c.isRTLEnabled=t.enableRtl,c.setIsInversedAndOpposedPosition()}},o.prototype.getAxisOffsetValue=function(t,e,i){var r=t?t+(e||i):e?e+i:2*i;return r},o.prototype.crossAt=function(t){for(var e=0,i=t.axisCollections;e<i.length;e++){var r=i[e];if(r.crossesAt!==null)if(r.crossesInAxis){for(var n=2,s=t.axisCollections.length;n<s;n++)if(r.crossesInAxis===t.axisCollections[n].name){r.crossInAxis=t.axisCollections[n],r.crossAt=this.updateCrossAt(r.crossInAxis,r.crossesAt);continue}}else{t.requireInvertedAxis?r.crossInAxis=r.orientation==="Horizontal"?t.primaryXAxis:t.primaryYAxis:r.crossInAxis=r.orientation==="Horizontal"?t.primaryYAxis:t.primaryXAxis,r.crossAt=this.updateCrossAt(r.crossInAxis,r.crossesAt);continue}}},o.prototype.updateCrossAt=function(t,e){switch(t.valueType){case"DateTime":var i={skeleton:"full",type:"dateTime"},r=this.chart.intl.getDateParser(i),n=this.chart.intl.getDateFormat(i);return Date.parse(r(n(new Date(vn.j.parse.parseJson({val:e}).val))));case"Category":return parseFloat(e)?parseFloat(e):t.labels.indexOf(e);case"Logarithmic":return Os(e,t.logBase);default:return e}},o.prototype.pushAxis=function(t,e){for(var i=0,r=t.axes.length;i<=r;i++)if(!t.axes[i]){t.axes[i]=e;break}},o.prototype.arrangeAxis=function(t){for(var e=[],i=0,r=t.axes.length;i<=r;i++)t.axes[i]&&e.push(t.axes[i]);t.axes=e},o.prototype.getActualColumn=function(t){var e=this.chart.columns.length,i=t.columnIndex,r=i>=e?e-1:i<0?0:i;return r},o.prototype.getActualRow=function(t){var e=this.chart.rows.length,i=t.rowIndex,r=i>=e?e-1:i<0?0:i;return r},o.prototype.calculateRowSize=function(t){/*! Calculate row size */for(var e=this.chart,i,r=t.y+t.height,n=0,s=Math.max(0,t.height),l=0,h=e.rows.length;l<h;l++)i=e.rows[l],i.height.indexOf("%")!==-1?n=Math.min(s,t.height*parseInt(i.height,10)/100):n=Math.min(s,parseInt(i.height,10)),n=l!==h-1?n:s,i.computedHeight=n,r-=n,i.computedTop=r,s-=n},o.prototype.calculateColumnSize=function(t){/*! Calculate column size */for(var e=this.chart,i,r=t.x,n=0,s=Math.max(0,t.width),l=0,h=e.columns.length;l<h;l++)i=e.columns[l],i.width.indexOf("%")!==-1?n=Math.min(s,t.width*parseInt(i.width,10)/100):n=Math.min(s,parseInt(i.width,10)),n=l!==h-1?n:s,i.computedWidth=n,i.computedLeft=r,r+=n,s-=n},o.prototype.renderAxes=function(){for(var t=this.chart,e,i=t.renderer.createGroup({id:t.element.id+"AxisInsideCollection"}),r=t.renderer.createGroup({id:t.element.id+"AxisOutsideCollection"}),n,s,l=0,h=t.axisCollections.length;l<h;l++){var c=!0;e=t.axisCollections[l],this.element=t.renderer.createGroup({id:t.element.id+"AxisGroup"+l+"Inside"}),n=t.renderer.createGroup({id:t.element.id+"AxisGroup"+l+"Outside"});for(var u=0,p=this.chart.series;u<p.length;u++){var f=p[u];if(e.name===f.yAxisName||e.name===f.xAxisName){if(c=f.visible,c)break;continue}}if(!c)break;s=this.findAxisPosition(e),e.orientation==="Horizontal"?(e.updateCrossValue(),e.visible&&e.internalVisibility&&e.lineStyle.width>0&&this.drawAxisLine(e,l,e.plotOffset,0,0,0,e.plotOffsetLeft,e.plotOffsetRight,s?n:this.element,e.updatedRect),(e.majorGridLines.width>0||e.majorTickLines.width>0)&&this.drawXAxisGridLine(e,l,s||e.tickPosition==="Inside"?n:this.element,e.updatedRect),e.visible&&e.internalVisibility&&(this.drawXAxisLabels(e,l,s||e.labelPosition==="Inside"?n:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect),this.drawXAxisBorder(e,l,s||e.labelPosition==="Inside"?n:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect),this.drawXAxisTitle(e,l,s?n:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect))):(e.updateCrossValue(),e.visible&&e.internalVisibility&&e.lineStyle.width>0&&this.drawAxisLine(e,l,0,e.plotOffset,e.plotOffsetBottom,e.plotOffsetTop,0,0,s?n:this.element,e.updatedRect),(e.majorGridLines.width>0||e.majorTickLines.width>0)&&this.drawYAxisGridLine(e,l,s||e.tickPosition==="Inside"?n:this.element,e.updatedRect),e.visible&&e.internalVisibility&&(this.drawYAxisLabels(e,l,s||e.labelPosition==="Inside"?n:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect),this.drawYAxisBorder(e,l,s||e.labelPosition==="Inside"?n:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect),this.drawYAxisTitle(e,l,s?n:this.element,e.placeNextToAxisLine?e.updatedRect:e.rect))),this.chart.enableCanvas||(i.appendChild(this.element),n&&n.childNodes.length>0&&r.appendChild(n)),t.scrollBarModule&&(t.zoomSettings.enableScrollbar&&e.enableScrollbarOnZooming||e.scrollbarSettings.enable)&&this.renderScrollbar(t,e)}this.element=t.renderer.createGroup({id:t.element.id+"DefinitionLine"});for(var g=0,h=t.rows.length;g<h;g++){var C=t.rows[g];C.border.color&&this.drawBottomLine(C,g,!0)}for(var g=0,h=t.columns.length;g<h;g++){var L=t.columns[g];L.border.color&&this.drawBottomLine(L,g,!1)}return this.chart.enableCanvas||i.appendChild(this.element),Nt(t.enableCanvas,t.svgObject,i,t.redraw),r},o.prototype.renderScrollbar=function(t,e){var i=(0,a.le)(t.zoomModule)?!1:t.zoomModule.isZoomed;(i&&(e.zoomFactor<1||e.zoomPosition>0)||e.scrollbarSettings.enable&&(e.zoomFactor<=1||e.zoomPosition>=0))&&(!e.zoomingScrollBar.isScrollUI||t.visibleSeries[0].type.indexOf("Bar")>=0)?(t.scrollElement||(t.scrollElement=is(t.redraw,t.element.id+"_scrollElement")||(0,a.az)("div",{id:t.element.id+"_scrollElement"})),Nt(!1,t.scrollElement,e.zoomingScrollBar.render(!0),!0)):e.zoomFactor===1&&e.zoomPosition===0&&e.zoomingScrollBar.svgObject&&!e.scrollbarSettings.enable&&e.zoomingScrollBar.destroy(),e.zoomingScrollBar.isScrollUI&&(e.zoomingScrollBar.isScrollUI=!1)},o.prototype.findAxisPosition=function(t){return t.crossAt!==null&&t.isInside(t.crossInAxis.visibleRange)},o.prototype.drawBottomLine=function(t,e,i){var r=this.chart,n={},s,l,h,c,u;i?(t=t,h=c=t.computedTop+t.computedHeight,s=this.seriesClipRect.x,l=s+this.seriesClipRect.width,u="Row"):(t=t,s=l=t.computedLeft,h=this.seriesClipRect.y,c=h+this.seriesClipRect.height,u="Column"),n={id:r.element.id+"_AxisBottom_"+u+e,x1:s,y1:h,x2:l,y2:c,"stroke-width":t.border.width,stroke:t.border.color},this.htmlObject=r.renderer.drawLine(n),this.element.appendChild(this.htmlObject)},o.prototype.drawAxisLine=function(t,e,i,r,n,s,l,h,c,u){var p=this.chart,f={},g=xt(p.element.id+"AxisLine_"+e),C=g?g.getAttribute("d"):"";g=null,f={id:p.element.id+"AxisLine_"+e,d:"M "+(u.x-i-l)+" "+(u.y-r-s)+" L "+(u.x+u.width+i+h)+" "+(u.y+u.height+r+n),"stroke-dasharray":t.lineStyle.dashArray,"stroke-width":t.lineStyle.width,stroke:t.lineStyle.color||p.themeStyle.axisLine},this.htmlObject=p.renderer.drawPath(f),Nt(p.enableCanvas,c,this.htmlObject,p.redraw,!0,"x","y",null,C)},o.prototype.drawYAxisGridLine=function(t,e,i,r){var n=t.valueType==="Logarithmic",s=t.valueType.indexOf("Category")>-1,l,h=0,c="",u="",p,f=t.isAxisOpposedPosition,g=f?t.majorTickLines.height:-t.majorTickLines.height,C=f?t.lineStyle.width*.5:-t.lineStyle.width*.5,L=t.valueType==="Category"&&t.labelPlacement==="BetweenTicks"?.5:0,D=(0,a.le)(t.crossesAt)?f?t.scrollBarHeight:-t.scrollBarHeight:0,R=t.tickPosition==="Inside",B=R?r.x-g-C:r.x+g+C+D,H=t.visibleLabels.length,j=this.chart.themeStyle;t.valueType.indexOf("Category")>-1&&t.labelPlacement==="BetweenTicks"&&H>0&&(H+=1);for(var W=t.minorGridLines,ne=t.minorTickLines,ie=0;ie<H;ie++)l=t.visibleLabels[ie]?t.visibleLabels[ie].value-L:t.visibleLabels[ie-1].value+t.visibleRange.interval-L,h=Er(l,t)*r.height,h=h*-1+(r.y+r.height),h>=r.y&&r.y+r.height>=h&&((ul(l,t.visibleRange)||this.isBorder(t,ie,h))&&(c="M "+this.seriesClipRect.x+" "+h+" L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+h,this.renderGridLine(t,e,c,t.majorGridLines,"_MajorGridLine_",ie,this.element,j.majorGridLine,t.majorGridLines.dashArray)),u="M "+(r.x+C+(R?D:0))+" "+h+" L "+B+" "+h,this.renderGridLine(t,e,u,t.majorTickLines,"_MajorTickLine_",ie,i,j.majorTickLine),(W.width>0||ne.width>0)&&t.minorTicksPerInterval>0&&(ie===0&&vl(t)&&!n&&!s&&this.renderMinorGridOnZooming(t,l,r,ie,e,j,i),p=this.drawAxisMinorLine(t,l,r,ie),this.renderGridLine(t,e,p[0],W,"_MinorGridLine_",ie,this.element,j.minorGridLine,W.dashArray),this.renderGridLine(t,e,p[1],ne,"_MinorTickLine_",ie,i,j.minorTickLine),ie===H-1&&vl(t)&&n&&!s&&this.renderMinorGridOnZooming(t,l+t.visibleRange.interval,r,ie,e,j,i)))},o.prototype.isBorder=function(t,e,i){var r=this.chart.chartArea.border,n=this.seriesClipRect,s=t.orientation,l=s==="Horizontal"?n.x:n.y,h=s==="Horizontal"?n.width:n.height,c=s==="Horizontal"?0:t.visibleLabels.length-1,u=s==="Horizontal"?t.visibleLabels.length-1:0;return t.plotOffset>0||(i===l||i===l+h)&&(r.width<=0||r.color==="transparent")?!0:i!==l&&e===c||i!==l+h&&e===u},o.prototype.drawYAxisLabels=function(t,e,i,r){var n=this.chart,s,l=0,h=0,c,u=t.labelPadding,p,f,g=t.labelPosition==="Inside",C=t.isAxisOpposedPosition,L=t.labelPosition===t.tickPosition?t.majorTickLines.height:0,D=L+u+t.lineStyle.width*.5,R=t.angle%360,B=R===-90||R===90||R===270||R===-270;D+=B?g?5:-5:0,D=C?D:-D;var H=n.renderer.createGroup({id:n.element.id+"AxisLabels"+e}),j=(0,a.le)(t.crossesAt)?t.scrollBarHeight*(C?1:-1):0,W,ne,ie,me=10,ve=t.isAxisInverse,Ee=ve?r.y:r.y+r.height,le,de,fe,Le,ke=!C&&!g||C&&g;g?le=ke?D:-D:le=ke?D+j:-D+j;var Me=[],De=[];t.visibleLabels.map(function(et){Me.push(et.size.width),De.push(et.breakLabelSize.width)});for(var Fe=Math.max.apply(Math,Me),Pe=Math.max.apply(Math,De),Ye=0,Ze=t.visibleLabels.length;Ye<Ze;Ye++){switch(s=t.visibleLabels[Ye],f=ca(t.visibleLabels[Ye].originalText),c=f?t.visibleLabels[Ye].breakLabelSize:t.visibleLabels[Ye].size,h=Er(t.visibleLabels[Ye].value,t)*r.height+(n.stockChart?7:0),h=Math.floor(h*-1+(r.y+r.height)),W=c.height/8*t.visibleLabels[Ye].text.length/2,ne=c.height/4*3+3,de=r.height/t.visibleLabels.length,fe=(t.labelIntersectAction==="Trim"||t.labelIntersectAction==="Wrap")&&R!==0&&c.width>de?de:c.width,h=f?t.labelPosition==="Inside"?h-c.height/2-W+ne:h-W:t.labelPosition==="Inside"?h+ne:h,t.majorGridLines.width>t.majorTickLines.width?ie=t.majorGridLines.width:ie=t.majorTickLines.width,t.labelStyle.textAlignment==="Far"?h=h-ie-me:t.labelStyle.textAlignment==="Near"?h=h+ie+me:t.labelStyle.textAlignment==="Center"&&(h=h),g?Le=le+(R===0?c.width:f?Pe:Fe)/2:Le=le-(R===0?c.width:f?Pe:Fe)/2,l=C?r.x-Le:r.x+Le,B&&(l+=C?-10:10),Le=le,p=new fr(n.element.id+e+"_AxisLabel_"+Ye,l,h,"middle",s.text,"","middle"),t.edgeLabelPlacement){case"None":break;case"Hide":((Ye===0||ve&&Ye===Ze-1)&&p.y>r.y||(Ye===Ze-1||ve&&Ye===0)&&p.y-c.height*.5<r.y)&&(p.text="");break;case"Shift":(Ye===0||ve&&Ye===Ze-1)&&p.y>r.y?p.y=h=r.y+r.height:(Ye===Ze-1||ve&&Ye===0)&&p.y-c.height*.5<r.y&&(p.y=h=r.y+c.height*.5);break}var nt=p.y,it=p.y-fe;f&&(nt=p.y-fe/2,it=p.y+fe/2),!((R===90||R===270)&&t.labelIntersectAction==="Hide"&&Ye!==0&&(ve?it<=Ee:nt>=Ee))&&(Ee=ve?nt:it,p.transform="rotate("+R+","+l+","+h+")",mr(n.renderer,p,s.labelStyle,s.labelStyle.color||n.themeStyle.axisLabel,H,!1,n.redraw,!0,!0,null,null,null,null,n.enableCanvas))}this.chart.enableCanvas||(n.delayRedraw?t.visible&&t.internalVisibility&&this.createZoomingLabel(this.chart,H,t,e,r):Nt(n.enableCanvas,i,H,n.redraw))},o.prototype.getAxisLabelXvalue=function(t,e,i){var r=e.lineBreakAlignment,n=e.labelPosition==="Inside",s=e.isAxisOpposedPosition;return s&&n||!s&&!n?r==="Right"?t:r==="Center"?t-i/2:t-i:r==="Left"?t:r==="Center"?t+i/2:t+i},o.prototype.drawYAxisBorder=function(t,e,i,r){if(t.border.width>0){var n=void 0,s=void 0,l=t.labelPosition==="Outside"?t.scrollBarHeight:0,h=t.isAxisOpposedPosition;l=(h?1:-1)*l;for(var c=r.height/t.visibleRange.delta*(t.valueType==="DateTime"?t.dateTimeInterval:t.visibleRange.interval),u=void 0,p=t.maxLabelSize.width+10+(t.tickPosition===t.labelPosition?t.majorTickLines.height:0),f="",g=t.valueType==="Category"&&t.labelPlacement==="BetweenTicks"?-.5:0,C=h&&t.labelPosition==="Inside"||!h&&t.labelPosition==="Outside"?r.x-p+l:r.x+p+l,L=0,D=t.visibleLabels.length;L<D;L++)switch(s=Er(t.visibleLabels[L].value+g,t),s=(t.isAxisInverse?1-s:s)*r.height,t.valueType==="Category"&&t.labelPlacement==="BetweenTicks"?(n=s*-1+(r.y+r.height),u=s*-1-c+(r.y+r.height)):(n=s*-1+c/2+(r.y+r.height),u=s*-1-c/2+(r.y+r.height)),t.border.type){case"Rectangle":case"WithoutTopBorder":n>r.y+r.height?f+="M "+C+" "+(r.y+r.height)+" L "+C+" "+u+" ":Math.floor(r.y)>u?f+="M "+(r.x+l)+" "+n+" L "+C+" "+n+" L "+C+" "+r.y+" ":(f+="M "+(r.x+l)+" "+n+" L "+C+" "+n+" L "+C+" "+u+" ",L===t.visibleLabels.length-1&&(f+="M "+(r.x+l)+" "+u+" L "+C+" "+u+" "));break;case"WithoutTopandBottomBorder":!(n>r.y+r.height)&&!(u<Math.floor(r.y))&&(f+="M "+(r.x+l)+" "+n+" L "+C+" "+n+" M "+C+" "+u+" L "+(r.x+l)+" "+u);break}f+=t.border.type==="Rectangle"?"M "+(r.x+l)+" "+r.y+" L "+(r.x+l)+" "+(r.y+r.height)+" ":"",f!==""&&this.createAxisBorderElement(t,e,f,i)}t.multiLevelLabels.length>0&&this.chart.multiLevelLabelModule&&this.chart.multiLevelLabelModule.renderYAxisMultiLevelLabels(t,e,i,r)},o.prototype.drawYAxisTitle=function(t,e,i,r){if(t.title){var n=this.chart,s=t.isAxisOpposedPosition,l=s?90:-90,h=(t.tickPosition==="Inside"?0:t.majorTickLines.height+t.titlePadding)+(t.labelPosition==="Inside"?0:t.maxLabelSize.width+t.multiLevelLabelHeight+this.padding);h=s?h+t.scrollBarHeight:-h-t.scrollBarHeight;var c=r.x+h,u=r.y+r.height*.5,p=t.titleSize.height*(t.titleCollection.length-1),f=new fr(n.element.id+"_AxisTitle_"+e,c,u-t.labelPadding-p,"middle",t.titleCollection,"rotate("+l+","+c+","+u+")",null,l),g=mr(n.renderer,f,t.titleStyle,t.titleStyle.color||n.themeStyle.axisTitle,i,null,null,null,null,null,null,null,null,n.enableCanvas);g.setAttribute("tabindex",t.tabIndex.toString()),g.setAttribute("aria-label",t.description||t.title)}},o.prototype.drawXAxisGridLine=function(t,e,i,r){var n=t.valueType==="Logarithmic",s=t.valueType.indexOf("Category")>-1,l,h=0,c="",u="",p,f=t.isAxisOpposedPosition,g=f?-t.majorTickLines.height:t.majorTickLines.height,C=f?-t.lineStyle.width*.5:t.lineStyle.width*.5,L=(0,a.le)(t.crossesAt)?f?-t.scrollBarHeight:t.scrollBarHeight:0,D=t.valueType.indexOf("Category")>-1&&t.labelPlacement==="BetweenTicks"?.5:0,R=t.visibleLabels.length,B=t.tickPosition==="Inside",H=B?r.y-g-C:r.y+g+C+L,j=this.chart.themeStyle;t.valueType.indexOf("Category")>-1&&R>0&&t.labelPlacement==="BetweenTicks"&&(R+=1);for(var W=0;W<R;W++)t.valueType!=="DateTimeCategory"?l=t.visibleLabels[W]?t.visibleLabels[W].value-D:t.visibleLabels[W-1].value+t.visibleRange.interval-D:l=t.visibleLabels[W]?t.visibleLabels[W].value-D:t.visibleRange.max,h=Er(l,t)*r.width+r.x,h>=r.x&&r.x+r.width>=h&&((ul(l,t.visibleRange)||this.isBorder(t,W,h))&&(c="M "+h+" "+(this.seriesClipRect.y+this.seriesClipRect.height)+" L "+h+" "+this.seriesClipRect.y,this.renderGridLine(t,e,c,t.majorGridLines,"_MajorGridLine_",W,this.element,j.majorGridLine,t.majorGridLines.dashArray)),u="M "+h+" "+(r.y+C+(B?L:0))+" L "+h+" "+H,this.renderGridLine(t,e,u,t.majorTickLines,"_MajorTickLine_",W,i,j.majorTickLine),t.minorTicksPerInterval>0&&(t.minorGridLines.width>0||t.minorTickLines.width>0)&&(W===0&&vl(t)&&!n&&!s&&this.renderMinorGridOnZooming(t,l,r,W,e,j,i),p=this.drawAxisMinorLine(t,l,r,W),this.renderGridLine(t,e,p[0],t.minorGridLines,"_MinorGridLine_",W,this.element,j.minorGridLine,t.minorGridLines.dashArray),this.renderGridLine(t,e,p[1],t.minorTickLines,"_MinorTickLine_",W,i,j.minorTickLine),W===R-1&&vl(t)&&n&&!s&&this.renderMinorGridOnZooming(t,l+t.visibleRange.interval,r,W,e,j,i)))},o.prototype.renderMinorGridOnZooming=function(t,e,i,r,n,s,l){var h=this.drawAxisMinorLine(t,e,i,r,!0);this.renderGridLine(t,n,h[0],t.minorGridLines,"_MinorGridLine_",-1,this.element,s.minorGridLine,t.minorGridLines.dashArray),this.renderGridLine(t,n,h[1],t.minorTickLines,"_MinorTickLine_",-1,l,s.minorTickLine)},o.prototype.drawAxisMinorLine=function(t,e,i,r,n){var s=e,l=0,h=0,c=t.visibleRange,u=t.tickPosition==="Inside",p=[],f=t.isAxisOpposedPosition?-t.minorTickLines.height:t.minorTickLines.height,g,C,L=1,D=1,R=u?i.y-f:i.y+f,B=u?i.x+f:i.x-f,H="",j="",W=t.isAxisInverse;if(t.valueType==="Logarithmic"&&(g=Math.pow(t.logBase,s-c.interval),C=Math.pow(t.logBase,s),L=(C-g)/(t.minorTicksPerInterval+1),D=g+L),t.orientation==="Horizontal")for(var ne=0;ne<t.minorTicksPerInterval;ne++)s=this.findLogNumeric(t,D,s,r,n),D+=L,ul(s,c)&&(h=(s-c.min)/(c.max-c.min),h=Math.ceil((W?1-h:h)*i.width),l=Math.floor(h+i.x),H=H.concat("M "+l+" "+this.seriesClipRect.y+"L "+l+" "+(this.seriesClipRect.y+this.seriesClipRect.height)),l=Math.floor(h+i.x),j=j.concat("M "+l+" "+i.y+"L "+l+" "+(R+t.scrollBarHeight)));else for(var ne=0;ne<t.minorTicksPerInterval;ne++)s=this.findLogNumeric(t,D,s,r,n),ul(s,c)&&(h=(s-c.min)/(c.max-c.min),h=Math.ceil((W?1-h:h)*i.height)*-1,l=Math.floor(h+i.y+i.height),H=H.concat("M "+this.seriesClipRect.x+" "+l+"L "+(this.seriesClipRect.x+this.seriesClipRect.width)+" "+l+" "),l=Math.floor(h+i.y+i.height),j=j.concat("M "+i.x+" "+l+"L "+(B-t.scrollBarHeight)+" "+l+" ")),D+=L;return p.push(H),p.push(j),p},o.prototype.findLogNumeric=function(t,e,i,r,n){var s=t.visibleRange,l;if(t.valueType==="Logarithmic")i=Os(e,t.logBase);else if(t.valueType==="DateTime")l=t.dateTimeInterval/(t.minorTicksPerInterval+1),i=n?i-l:i+l;else if(t.valueType==="DateTimeCategory"){var h=t.labelPlacement==="BetweenTicks"?.5:0;i+=((t.visibleLabels[r+1]?t.visibleLabels[r+1].value-h:t.visibleRange.max)-(t.visibleLabels[r]?t.visibleLabels[r].value-h:t.visibleRange.min))/(t.minorTicksPerInterval+1)}else l=s.interval/(t.minorTicksPerInterval+1),i=n?i-l:i+l;return i},o.prototype.drawXAxisLabels=function(t,e,i,r){var n=this.chart,s=0,l=0,h=t.labelPadding,c,u,p,f,g=10,C=n.renderer.createGroup({id:n.element.id+"AxisLabels"+e}),L=t.labelPosition==="Inside",D=t.isAxisOpposedPosition,R=t.labelPosition===t.tickPosition?t.majorTickLines.height:0,B=R+h+t.lineStyle.width*.5,H=t.angle%360,j=H===0||H===-180||H===180,W,ne,ie=t.isAxisInverse,me=ie?r.x+r.width:r.x,ve=0,Ee=t.visibleLabels.length,le,de,fe,Le=t.scrollbarSettings.enable||!L&&(0,a.le)(t.crossesAt)&&(t.zoomFactor<1||t.zoomPosition>0)?t.scrollBarHeight:0,ke=[],Me=!1;B+=H===90||H===270||H===-90||H===-270?L?5:-5:0;for(var De=!D&&!L||D&&L,Fe=De?360>=H&&H>=180||-1>=H&&H>=-180:1<=H&&H<=180||-181>=H&&H>=-360,Pe=0,Ye=Ee;Pe<Ye;Pe++){de=t.visibleLabels[Pe],fe=ca(de.originalText),s=Er(de.value,t)*r.width+r.x,u=de.size,le=r.width/Ee,ne=fe?de.breakLabelSize.width:u.width,ve=(t.labelIntersectAction==="Trim"||t.labelIntersectAction==="Wrap")&&H===0&&ne>le?le:ne,c=u.height/4,s-=fe||H!==0?0:ve/2,H!==0&&(fe?s-=t.lineBreakAlignment==="Left"?de.breakLabelSize.width/2:t.lineBreakAlignment==="Right"?-(de.breakLabelSize.width/2):0:s-=H===-90||H===270?-c:H===90||H===-270?c:0),t.labelStyle.textAlignment==="Far"?s=s+ve-g:t.labelStyle.textAlignment==="Near"?s=s-ve+g:t.labelStyle.textAlignment==="Center"&&(s=s),fe&&t.lineBreakAlignment!=="Center"&&H===0&&(s+=t.lineBreakAlignment==="Left"?-(ve/2):ve/2);var Ze=fe?j?u.height:de.breakLabelSize.width/2:0;if(B=fe?R+h+t.lineStyle.width*.5:B,L&&H?fe?l=D?r.y+B+Ze:r.y-B-Ze:l=D?r.y+B+c:r.y-B-c:(fe?p=De?B+Le+(H?Ze:3*c):-(B+Le+Ze):p=De?B+Le+(H?1:3)*c:-(B+Le+(H?c:de.index>1?2*c:0)),l=r.y+p*de.index),fe?f=this.getAnchor(t):f=n.enableRtl?Fe?"":"end":n.isRtlEnabled||Fe?"end":"",W=new fr(n.element.id+e+"_AxisLabel_"+Pe,s,l,f),t.edgeLabelPlacement)switch(t.edgeLabelPlacement){case"None":break;case"Hide":if((Pe===0||ie&&Pe===Ye-1)&&W.x<r.x||(Pe===Ye-1||ie&&Pe===0)&&W.x+ve>r.x+r.width)continue;break;case"Shift":(Pe===0||ie&&Pe===Ye-1)&&W.x<r.x?(le-=r.x-W.x,W.x=s=r.x):(Pe===Ye-1||ie&&Pe===0)&&W.x+ve>r.x+r.width&&(u.width>le&&t.labelIntersectAction==="Trim"?le-=W.x+ve-(r.x+r.width):le=ve,W.x=s=r.x+r.width-le);break}W.text=this.getLabelText(de,t,le);var nt=void 0,it=void 0;if(fe&&H===0?t.lineBreakAlignment==="Right"?(nt=W.x-ve,it=W.x):t.lineBreakAlignment==="Center"?(nt=W.x-ve/2,it=W.x+ve/2):(nt=W.x,it=W.x+ve):(nt=W.x,it=W.x+ve),!(H===0&&t.labelIntersectAction==="Hide"&&Pe!==0&&(ie?it>=me:nt<=me))){if(fe?t.lineBreakAlignment==="Right"?me=ie?W.x-ve:W.x:t.lineBreakAlignment==="Center"?me=ie?W.x-ve/2:W.x+ve/2:me=ie?W.x:W.x+ve:me=ie?W.x:W.x+ve,H!==0){var et=void 0,at=void 0;if(fe){var Ge=0,gt=0;et=de.breakLabelSize.height,gt=de.breakLabelSize.height-4,t.lineBreakAlignment==="Center"?Ge=-(de.breakLabelSize.width/2):t.lineBreakAlignment==="Right"&&(Ge=-de.breakLabelSize.width),De&&(gt=de.breakLabelSize.height/(W.text.length+1)),at=new ft(W.x+Ge,W.y-gt,de.breakLabelSize.width,et)}else et=l-(W.y-(de.size.height/2+10)),at=new ft(W.x,W.y-(de.size.height/2-5),de.size.width,et);var ge=this.getRectanglePoints(at),xe=fe?at.x+at.width/2:s,je=fe?at.y+at.height/2:l-et/2;if(fe?W.transform="rotate("+H+","+xe+","+je+")":W.transform="rotate("+H+","+s+","+l+")",ke.push(Ng(ge,xe,je,H)),Me=!1,t.labelIntersectAction!=="None"){for(var Je=Pe;Je>0;Je--)if(ke[Pe]&&ke[Je-1]&&Bg(ke[Pe],ke[Je-1])){Me=!0,ke[Pe]=null;break}}}mr(n.renderer,W,de.labelStyle,de.labelStyle.color||n.themeStyle.axisLabel,C,t.isAxisOpposedPosition!==(t.labelPosition==="Inside"),n.redraw,!0,null,null,null,de.size,Me,n.enableCanvas)}}this.chart.enableCanvas||(n.delayRedraw?t.visible&&t.internalVisibility&&this.createZoomingLabel(this.chart,C,t,e,r):i.appendChild(C))},o.prototype.getAnchor=function(t){return t.lineBreakAlignment==="Center"?"middle":this.chart.enableRtl?t.lineBreakAlignment==="Left"?"end":"start":t.lineBreakAlignment==="Left"?"start":"end"},o.prototype.getRectanglePoints=function(t){var e=new Rt(t.x,t.y),i=new Rt(t.x+t.width,t.y),r=new Rt(t.x+t.width,t.y+t.height),n=new Rt(t.x,t.y+t.height);return[e,i,r,n]},o.prototype.getLabelText=function(t,e,i){if(ca(t.originalText)){for(var r=[],n=void 0,s=0;s<t.text.length;s++)n=this.findAxisLabel(e,t.text[s],i),r.push(n);return r}else return this.findAxisLabel(e,t.text,i)},o.prototype.drawXAxisBorder=function(t,e,i,r){if(t.border.width>0){for(var n=t.labelPosition==="Outside"?t.scrollBarHeight:0,s=t.isAxisOpposedPosition,l=void 0,h=r.y+(s?-1:1)*n,c=10,u=void 0,p=r.width/t.visibleRange.delta*(t.valueType==="DateTime"?t.dateTimeInterval:t.visibleRange.interval),f=void 0,g=t.maxLabelSize.height+(t.tickPosition===t.labelPosition?t.majorTickLines.height:0),C="",L=t.valueType==="Category"&&t.labelPlacement==="BetweenTicks"?-.5:0,D=s&&t.labelPosition==="Inside"||!s&&t.labelPosition==="Outside"?r.y+g+c+n:r.y-g-c-n,R=0,B=t.visibleLabels.length;R<B;R++)switch(u=Er(t.visibleLabels[R].value+L,t),u=(t.isAxisInverse?1-u:u)*r.width,t.valueType==="Category"&&t.labelPlacement==="BetweenTicks"?(l=u+r.x,f=u+p+r.x):(l=u-p*.5+r.x,f=u+p*.5+r.x),t.border.type){case"Rectangle":case"WithoutTopBorder":l<r.x?C+="M "+r.x+" "+D+" L "+f+" "+D+" ":Math.floor(f)>r.width+r.x&&t.visibleLabels.length!==1?C+="M "+l+" "+h+" L "+l+" "+D+" L "+(r.width+r.x)+" "+D+" ":(C+="M "+l+" "+h+" L "+l+" "+D+" L "+f+" "+D+" ",R===0&&(C+="M "+l+" "+h+" L "+l+" "+D+" M "+l+" "+D+" L "+r.x+" "+D),R===t.visibleLabels.length-1&&(C+="M "+f+" "+h+" L "+f+" "+D+" M "+f+" "+D+" L "+(r.width+r.x)+" "+D));break;case"WithoutTopandBottomBorder":!(l<r.x)&&!(Math.floor(f)>r.width+r.x)&&(C+="M "+l+" "+h+" L "+l+" "+D+" M "+f+" "+h+" L "+f+" "+D);break}C+=t.border.type==="Rectangle"?"M  "+r.x+" "+h+"L "+(r.x+r.width)+" "+h:"",C!==""&&this.createAxisBorderElement(t,e,C,i)}this.chart.multiLevelLabelModule&&t.multiLevelLabels.length>0&&this.chart.multiLevelLabelModule.renderXAxisMultiLevelLabels(t,e,i,r)},o.prototype.createAxisBorderElement=function(t,e,i,r){var n=xt(this.chart.element.id+"_BorderLine_"+e),s=n?n.getAttribute("d"):"",l=this.chart.renderer.drawPath(new er(this.chart.element.id+"_BorderLine_"+e,"transparent",t.border.width,t.border.color||this.chart.themeStyle.axisLine,1,"",i));l.style.pointerEvents="none",Nt(this.chart.enableCanvas,r,l,this.chart.redraw,!0,"x","y",null,s,!0)},o.prototype.findAxisLabel=function(t,e,i){return t.labelIntersectAction==="Trim"&&t.angle%360==0&&!t.enableTrim?Rn(i,e,t.labelStyle):e},o.prototype.drawXAxisTitle=function(t,e,i,r){if(t.title){var n=this.chart,s=Pt(t.title,t.titleStyle),l=(0,a.le)(t.crossesAt)?t.scrollBarHeight:0,h=(t.tickPosition==="Inside"?0:t.majorTickLines.height+t.titlePadding)+(t.labelPosition==="Inside"?0:t.maxLabelSize.height+t.multiLevelLabelHeight+t.labelPadding),c=t.titleSize.height*(t.titleCollection.length-1);h=t.isAxisOpposedPosition?-(h+s.height/4+l+c):h+3*s.height/4+l;var u=new fr(n.element.id+"_AxisTitle_"+e,r.x+r.width*.5,r.y+h,"middle",t.titleCollection),p=mr(n.renderer,u,t.titleStyle,t.titleStyle.color||n.themeStyle.axisTitle,i,null,null,null,null,null,null,null,null,n.enableCanvas);p.setAttribute("aria-label",t.description||t.title),p.setAttribute("tabindex",t.tabIndex.toString())}},o.prototype.renderGridLine=function(t,e,i,r,n,s,l,h,c){c===void 0&&(c=null);var u=this.chart,p,f;r.width>0&&t.visible&&t.internalVisibility&&i&&(f=xt(u.element.id+n+e+"_"+s),p=f?f.getAttribute("d"):null,f=null,this.htmlObject=u.renderer.drawPath(new er(u.element.id+n+e+"_"+s,"transparent",r.width,r.color||h,null,c,i)),Nt(u.enableCanvas,l,this.htmlObject,u.redraw,!0,"x","y",null,p,!0))},o.prototype.findParentNode=function(t,e,i){return document.getElementById(t+"AxisGroup"+i+"Inside").contains(document.getElementById(e.id))?document.getElementById(t+"AxisGroup"+i+"Inside"):document.getElementById(t+"AxisGroup"+i+"Outside")},o.prototype.createZoomingLabel=function(t,e,i,r,n){var s=this.findParentNode(t.element.id,e,r);e.setAttribute("opacity","0.3");var l=t.renderer.createGroup({id:t.element.id+"AxisLabels_Zoom"+r});l=px(t,i,l,r,i.orientation==="Vertical",n),s.replaceChild(e,document.getElementById(e.id)),xt(t.element.id+"AxisLabels_Zoom"+r)?s.replaceChild(l,document.getElementById(l.id)):s.appendChild(l)},o}(),Md=function(){function o(t){this.currentPoints=[],this.previousPoints=[],this.insideRegion=!1,this.commonXvalues=[],this.chart=t,this.lierIndex=0}return o.prototype.getData=function(){for(var t=this.chart,e=null,i=null,r,n,s,l,h=t.visibleSeries.length,c=h-1;c>=0;c--){if(i=t.visibleSeries[c],r=i.type==="Scatter"||i.drawType==="Scatter"||i.marker.visible?(i.marker.height+5)/2:0,n=i.type==="Scatter"||i.drawType==="Scatter"||i.marker.visible?(i.marker.width+5)/2:0,s=t.mouseX,l=t.mouseY,i.dragSettings.enable&&i.isRectSeries)if(!(i.type==="Bar"&&t.isTransposed)&&(t.isTransposed||i.type==="Bar")){var u=i.marker.width/2;s=i.yAxis.isAxisInverse?s+u:s-u}else{var p=i.marker.height/2;l=i.yAxis.isAxisInverse?l-p:l+p}if(i.visible&&sn(s,l,i.clipRect,r,n)&&(e=this.getRectPoint(i,i.clipRect,s,l)),e)return new wc(e,i)}return new wc(e,i)},o.prototype.isSelected=function(t){return(t.selectionMode.indexOf("Drag")>-1||t.selectionMode.indexOf("Lasso")>-1)&&t.selectionModule&&t.selectionModule.rectPoints!==null},o.prototype.getRectPoint=function(t,e,i,r){var n=this.chart,s,l,h,c=0,u,p,f;if(n.isScrolling)return null;for(var g=0,C=t.points;g<C.length;g++){var L=C[g];if(!(!L.regionData&&(!L.regions||!L.regions.length))){if(L.regionData&&this.chart.chartAreaType==="PolarRadar"&&t.drawType.indexOf("Column")>-1&&(s=i-(t.clipRect.width/2+t.clipRect.x),l=r-(t.clipRect.height/2+t.clipRect.y),c=2*Math.PI*(L.regionData.currentXPosition<0?1+L.regionData.currentXPosition:L.regionData.currentXPosition),h=(Math.atan2(l,s)+.5*Math.PI-c)%(2*Math.PI),h=h<0?2*Math.PI+h:h,h=h+2*Math.PI*t.chart.primaryXAxis.startAngle,u=L.regionData.startAngle,u-=c,u=u<0?2*Math.PI+u:u,p=L.regionData.endAngle,p-=c,p=p<0?2*Math.PI+p:p,f=Math.sqrt(Math.pow(Math.abs(s),2)+Math.pow(Math.abs(l),2)),h>=u&&h<=p&&(f>=L.regionData.innerRadius&&f<=L.regionData.radius||f<=L.regionData.innerRadius&&f>=L.regionData.radius)&&f<=t.chart.radius))return L;if((t.dragSettings.enable&&t.isRectSeries||t.isRectSeries&&t.marker.visible)&&this.isPointInThresholdRegion(i,r,L,e,t))return this.insideRegion=!0,L;if(!this.insideRegion&&this.checkRegionContainsPoint(L.regions,e,i,r))return L;if(this.insideRegion&&this.checkRegionContainsPoint(L.regions,e,i,r))return L}}return null},o.prototype.checkRegionContainsPoint=function(t,e,i,r){var n=this;return t.some(function(s,l){return n.lierIndex=l,sn(i,r,new ft((n.chart.chartAreaType==="Cartesian"?e.x:0)+s.x,(n.chart.chartAreaType==="Cartesian"?e.y:0)+s.y,s.width,s.height))})},o.prototype.isPointInThresholdRegion=function(t,e,i,r,n){var s=this,l=n.type==="Bar",h=n.yAxis.isAxisInverse,c=n.chart.isTransposed,u=10,p=0,f=0,g,C=g=2*u;return h&&c?l?(p=i.regions[0].height-u,g=i.regions[0].width):(f=-u,C=i.regions[0].height):h||i.yValue<0?l?(f=-u,C=i.regions[0].height):(p=i.regions[0].height-u,g=i.regions[0].width):c?l?(p=-u,g=i.regions[0].width):(f=i.regions[0].width-u,C=i.regions[0].height):l?(f=i.regions[0].width-u,C=i.regions[0].height):(p=-u,g=i.regions[0].width),i.regions.some(function(L){return sn(t,e,new ft((s.chart.chartAreaType==="Cartesian"?r.x:0)+L.x+f,(s.chart.chartAreaType==="Cartesian"?r.y:0)+L.y+p,g,C))})},o.prototype.getClosest=function(t,e,i){var r,n,s=i||t.xData,l=s.length;if(e>=t.xMin-.5&&e<=t.xMax+.5)for(var h=0;h<l;h++)n=s[h],(r==null||Math.abs(n-e)<Math.abs(r-e))&&(r=n);var c=t.xData.indexOf(r)!==-1;return c?r:null},o.prototype.binarySearch=function(t,e){for(var i=0,r=e.length,n=-1,s=!1,l;s==!1&&i<=r;)l=Math.floor((i+r)/2),e[l].xValue==t?(s=!0,n=l):e[l].xValue>t?r=l-1:i=l+1;return n!==-1?e[n]:null},o.prototype.getClosestX=function(t,e,i){var r,n=e.clipRect;t.requireInvertedAxis?r=fx(t.mouseY-n.y,n.height,e.xAxis):r=dx(t.mouseX-n.x,n.width,e.xAxis);var s=this.getClosest(e,r,i),l=s||s===0?this.binarySearch(s,Mg(e.points,["xValue"])):null;return l&&l.visible?new wc(l,e):null},o.prototype.mergeXvalues=function(t){if(t.length&&(!this.commonXvalues.length||this.commonXvalues.length!==t[0].xData.length)){this.commonXvalues=t[0].xData;for(var e=1;e<t.length;e++)this.commonXvalues=this.getDistinctValues(this.commonXvalues,t[e].xData)}return this.commonXvalues},o.prototype.getDistinctValues=function(t,e){e===void 0&&(e=[]);var i={},r=[],n;for(n=0;n<t.length;n++){var s=t[n];i[s]||(i[s]=!0,r.push(s))}for(n=0;n<e.length;n++){var s=e[n];i[s]||(i[s]=!0,r.push(s))}return r},o}(),Rs=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),qe=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},Mx=function(o){Rs(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return qe([(0,a.Z9)(!1)],t.prototype,"visible",void 0),qe([(0,a.Z9)(!0)],t.prototype,"showZero",void 0),qe([(0,a.Z9)(null)],t.prototype,"name",void 0),qe([(0,a.Z9)("transparent")],t.prototype,"fill",void 0),qe([(0,a.Z9)(1)],t.prototype,"opacity",void 0),qe([(0,a.Z9)(0)],t.prototype,"angle",void 0),qe([(0,a.Z9)(!1)],t.prototype,"enableRotation",void 0),qe([(0,a.Z9)("Auto")],t.prototype,"position",void 0),qe([(0,a.Z9)(5)],t.prototype,"rx",void 0),qe([(0,a.Z9)(5)],t.prototype,"ry",void 0),qe([(0,a.Z9)("Center")],t.prototype,"alignment",void 0),qe([(0,a.Zz)({width:null,color:null},xr)],t.prototype,"border",void 0),qe([(0,a.Zz)({left:5,right:5,top:5,bottom:5},sc)],t.prototype,"margin",void 0),qe([(0,a.Zz)({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},Pr)],t.prototype,"font",void 0),qe([(0,a.Z9)(null)],t.prototype,"template",void 0),qe([(0,a.Z9)("Hide")],t.prototype,"labelIntersectAction",void 0),t}(a.rt),$g=function(o){Rs(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return qe([(0,a.Z9)(!1)],t.prototype,"visible",void 0),qe([(0,a.Z9)("Circle")],t.prototype,"shape",void 0),qe([(0,a.Z9)("")],t.prototype,"imageUrl",void 0),qe([(0,a.Z9)(5)],t.prototype,"height",void 0),qe([(0,a.Z9)(5)],t.prototype,"width",void 0),qe([(0,a.Zz)({width:2,color:null},xr)],t.prototype,"border",void 0),qe([(0,a.Zz)({x:0,y:0},Tw)],t.prototype,"offset",void 0),qe([(0,a.Z9)(null)],t.prototype,"fill",void 0),qe([(0,a.Z9)(1)],t.prototype,"opacity",void 0),qe([(0,a.Zz)({},Mx)],t.prototype,"dataLabel",void 0),t}(a.rt),Qg=function(){function o(){this.symbolLocations=null,this.regions=null,this.percentage=null,this.regionData=null,this.isSelect=!1,this.marker={visible:!1},this.isPointInRange=!0}return o}(),Px=function(o){Rs(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.clipRect=new ft(0,0,0,0),e}return t.prototype.setDataSource=function(e,i){e&&(this.points=e.points),i.trendLineModule.initDataSource(this),i.visibleSeriesCount++},qe([(0,a.Z9)("")],t.prototype,"name",void 0),qe([(0,a.Z9)("0")],t.prototype,"dashArray",void 0),qe([(0,a.Z9)(!0)],t.prototype,"visible",void 0),qe([(0,a.Z9)("Linear")],t.prototype,"type",void 0),qe([(0,a.Z9)(2)],t.prototype,"period",void 0),qe([(0,a.Z9)(2)],t.prototype,"polynomialOrder",void 0),qe([(0,a.Z9)(0)],t.prototype,"backwardForecast",void 0),qe([(0,a.Z9)(0)],t.prototype,"forwardForecast",void 0),qe([(0,a.Zz)({},Ed)],t.prototype,"animation",void 0),qe([(0,a.Zz)({},$g)],t.prototype,"marker",void 0),qe([(0,a.Z9)(!0)],t.prototype,"enableTooltip",void 0),qe([(0,a.Z9)(null)],t.prototype,"intercept",void 0),qe([(0,a.Z9)("")],t.prototype,"fill",void 0),qe([(0,a.Z9)(1)],t.prototype,"width",void 0),qe([(0,a.Z9)("SeriesType")],t.prototype,"legendShape",void 0),t}(a.rt),Nx=function(o){Rs(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return qe([(0,a.Z9)(1)],t.prototype,"width",void 0),qe([(0,a.Z9)(10)],t.prototype,"length",void 0),qe([(0,a.Z9)(null)],t.prototype,"color",void 0),qe([(0,a.Z9)(1)],t.prototype,"opacity",void 0),t}(a.rt),Bx=function(o){Rs(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return qe([(0,a.Z9)(null)],t.prototype,"value",void 0),qe([(0,a.Z9)(null)],t.prototype,"color",void 0),qe([(0,a.Z9)("0")],t.prototype,"dashArray",void 0),t}(a.rt),Fx=function(o){Rs(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return qe([(0,a.Z9)(!1)],t.prototype,"visible",void 0),qe([(0,a.Z9)("Fixed")],t.prototype,"type",void 0),qe([(0,a.Z9)("Both")],t.prototype,"direction",void 0),qe([(0,a.Z9)("Vertical")],t.prototype,"mode",void 0),qe([(0,a.Z9)(null)],t.prototype,"color",void 0),qe([(0,a.Z9)(1)],t.prototype,"verticalError",void 0),qe([(0,a.Z9)(1)],t.prototype,"width",void 0),qe([(0,a.Z9)(1)],t.prototype,"horizontalError",void 0),qe([(0,a.Z9)(3)],t.prototype,"verticalPositiveError",void 0),qe([(0,a.Z9)(3)],t.prototype,"verticalNegativeError",void 0),qe([(0,a.Z9)(1)],t.prototype,"horizontalPositiveError",void 0),qe([(0,a.Z9)(1)],t.prototype,"horizontalNegativeError",void 0),qe([(0,a.Zz)(null,Nx)],t.prototype,"errorBarCap",void 0),t}(a.rt),Jg=function(o){Rs(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.isAdvancedColor=void 0,e.currentViewData=[],e.clipRect=new ft(0,0,0,0),e.seriesType="XY",e.isRectTypeSeries=!1,e}return t.prototype.processJsonData=function(){var e=0,i=new Qg,r=this instanceof Ki&&this.type==="Histogram"?"x":this.xName,n=this instanceof Ki&&this.marker.dataLabel.name?this.marker.dataLabel.name:"";this instanceof Ki&&((this.type==="Waterfall"||this.type==="Histogram")&&(this.currentViewData=this.chart[On(this.type)+"SeriesModule"].processInternalData((0,a.l7)([],this.currentViewData,null,!0),this)),this.category==="Pareto"&&(this.currentViewData=Mg((0,a.l7)([],this.currentViewData,null,!0),[this.yName],!0),this.type==="Line"&&(this.currentViewData=this.chart.paretoSeriesModule.performCumulativeCalculation(this.currentViewData,this))),this.isRectTypeSeries=this.type.indexOf("Column")>-1||this.type.indexOf("Bar")>-1||this.type.indexOf("Histogram")>-1);var s=(this.currentViewData||[]).length;if(this.points=[],this.xMin=Infinity,this.xMax=-Infinity,this.yMin=Infinity,this.yMax=-Infinity,this.sizeMax=-Infinity,this.getSeriesType(),this.xAxis.valueType==="Category")for(;e<s;)i=this.dataPoint(e,n,r),this.pushCategoryData(i,e,i.x),this.pushData(i,e),this.setEmptyPoint(i,e),e++;else if(this.xAxis.valueType.indexOf("DateTime")>-1)for(var l={skeleton:"full",type:"dateTime"},h=this.chart.intl.getDateParser(l),c=this.chart.intl.getDateFormat(l);e<s;)i=this.dataPoint(e,n,r),!(0,a.le)(i.x)&&i.x!==""?(i.x=new Date(vn.j.parse.parseJson({val:i.x}).val),this.xAxis.valueType==="DateTime"?i.xValue=Date.parse(i.x.toString()):this.chart.isBlazor?this.pushCategoryData(i,e,Date.parse(i.x.toString()).toString()):this.pushCategoryData(i,e,Date.parse(h(c(i.x))).toString()),this.pushData(i,e),this.setEmptyPoint(i,e)):i.visible=!1,e++;else for(;e<s;)i=this.dataPoint(e,n,r),i.xValue=i.x,this.pushData(i,e),this.setEmptyPoint(i,e),e++;if(this instanceof Ki){if(this.type.indexOf("Spline")>-1||this.drawType.indexOf("Spline")>-1&&this.chart.chartAreaType==="PolarRadar"){var u=this.type.indexOf("Area")>-1||this.drawType.indexOf("Area")>-1,p=this.type.indexOf("Range")>-1;this.chart["spline"+(u?p?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(this)}else this.type.indexOf("Histogram")>-1&&(this.xAxis.maximum||this.xAxis.minimum)&&this.chart.histogramSeriesModule.calculateBinValues(this);this.type.indexOf("Histogram")>-1&&this.points.length==1&&(this.xMin=this.xMin-this.histogramValues.binWidth,this.xMax=this.xMax+this.histogramValues.binWidth)}},t.prototype.pushData=function(e,i){e.index=i,e.yValue=e.y,this.xMin=Math.min(this.xMin,e.xValue),this.xMax=Math.max(this.xMax,e.xValue),this.xData.push(e.xValue)},t.prototype.dataPoint=function(e,i,r){this.points[e]=new Qg;var n=this.points[e],s=this.currentViewData[e],l=this.enableComplexProperty?a.NA:this.getObjectValue;return n.x=l(r,s),n.high=l(this.high,s),n.low=l(this.low,s),n.open=l(this.open,s),n.close=l(this.close,s),n.volume=l(this.volume,s),n.interior=l(this.pointColorMapping,s),this instanceof Ki&&(n.y=l(this.yName,s),n.size=l(this.size,s),n.text=l(i,s),n.tooltip=l(this.tooltipMappingName,s),this.isAdvancedColorSupported()&&(this.rangeColorName=this.colorName.length>0?this.colorName:this.yName,n.colorValue=l(this.rangeColorName,s),n.interior=this.getPointFillColor(n.interior,n.colorValue))),n},t.prototype.isAdvancedColorSupported=function(){return(0,a.le)(this.isAdvancedColor)&&(this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0&&this.chart.visibleSeries.length===1&&(this.chart.series[0].type==="Column"||this.chart.series[0].type==="Bar"||this.chart.series[0].type==="Scatter"||this.chart.series[0].type==="Bubble")?this.isAdvancedColor=!0:this.isAdvancedColor=!1),this.isAdvancedColor},t.prototype.getPointFillColor=function(e,i){var r=e;if(i&&this.chart.rangeColorSettings&&this.chart.rangeColorSettings.length>0)for(var n=0,s=this.chart.rangeColorSettings;n<s.length;n++){var l=s[n];i>=l.start&&i<=l.end&&(l.colors.length>1?r=Ix(l,i):r=l.colors[0])}return r},t.prototype.getObjectValue=function(e,i){return i[e]},t.prototype.setEmptyPoint=function(e,i){if(!this.findVisibility(e))return e.visible=!0,null;e.isEmpty=!0;var r=this instanceof Ki&&e.isPointInRange?this.emptyPointSettings.mode:"Drop";switch(r){case"Zero":e.visible=!0,this instanceof Ki&&this.seriesType.indexOf("HighLow")>-1?(e.high=e.low=0,this.seriesType.indexOf("HighLowOpenClose")>-1&&(e.open=e.close=0)):e.y=e.yValue=this.yData[i]=0;break;case"Average":this instanceof Ki&&(this.seriesType.indexOf("HighLow")>-1?(e.high=(0,a.le)(e.high)||isNaN(+e.high)?this.getAverage(this.high,i):e.high,e.low=(0,a.le)(e.low)||isNaN(+e.low)?this.getAverage(this.low,i):e.low,this.seriesType.indexOf("HighLowOpenClose")>-1&&(e.open=(0,a.le)(e.open)||isNaN(+e.open)?this.getAverage(this.open,i):e.open,e.close=(0,a.le)(e.close)||isNaN(+e.close)?this.getAverage(this.close,i):e.close)):e.y=e.yValue=this.yData[i]=this.getAverage(this.yName,i)),e.visible=!0;break;case"Drop":case"Gap":this.yData[i]=null,e.visible=!1;break}},t.prototype.findVisibility=function(e){var i=this instanceof Ki?this.seriesType:"HighLowOpenClose",r,n=this.yAxis.minimum,s=this.yAxis.maximum;switch(i){case"XY":return this.chart.chartAreaType==="PolarRadar"&&(!(0,a.le)(n)&&e.yValue<n||!(0,a.le)(s)&&e.yValue>s)?(e.isPointInRange=!1,!0):(this.setXYMinMax(e.yValue),this.yData.push(e.yValue),this instanceof Ki&&this.type==="Bubble"&&(this.sizeMax=Math.max(this.sizeMax,(0,a.le)(e.size)||isNaN(+e.size)?this.sizeMax:e.size)),(0,a.le)(e.x)||(0,a.le)(e.y)||isNaN(+e.y));case"HighLow":return this.setHiloMinMax(e.high,e.low),(0,a.le)(e.x)||(0,a.le)(e.low)||isNaN(+e.low)||(0,a.le)(e.high)||isNaN(+e.high);case"HighLowOpenClose":return this.setHiloMinMax(e.high,e.low),(0,a.le)(e.x)||(0,a.le)(e.low)||isNaN(+e.low)||(0,a.le)(e.open)||isNaN(+e.open)||(0,a.le)(e.close)||isNaN(+e.close)||(0,a.le)(e.high)||isNaN(+e.high);case"BoxPlot":return r=(e.y||[null]).filter(function(l){return!(0,a.le)(l)&&!isNaN(l)}).sort(function(l,h){return l-h}),e.y=r,this.yMin=Math.min(this.yMin,Math.min.apply(Math,r)),this.yMax=Math.max(this.yMax,Math.max.apply(Math,r)),!r.length}},t.prototype.setXYMinMax=function(e){var i=this.yAxis.valueType==="Logarithmic"||this.xAxis.valueType==="Logarithmic",r=e<0||this.yAxis.rangePadding==="None",n;this.isRectTypeSeries&&!Ld(this.yAxis)?n=i||r?e:0:n=e,this.yMin=i?Math.min(this.yMin,(0,a.le)(n)||isNaN(n)||n===0||n.toString()==="0"||n.toString()===""?this.yMin:n):Math.min(this.yMin,(0,a.le)(n)||isNaN(n)?this.yMin:n),this.yMax=Math.max(this.yMax,(0,a.le)(e)||isNaN(e)?this.yMax:e)},t.prototype.setHiloMinMax=function(e,i){this.yMin=Math.min(this.yMin,Math.min((0,a.le)(i)||isNaN(i)?this.yMin:i,(0,a.le)(e)||isNaN(e)?this.yMin:e)),this.yMax=Math.max(this.yMax,Math.max((0,a.le)(i)||isNaN(i)?this.yMax:i,(0,a.le)(e)||isNaN(e)?this.yMax:e))},t.prototype.getSeriesType=function(){var e;if(this instanceof Ki){var i=this.chart.chartAreaType==="PolarRadar"?this.drawType:this.type;if(i)switch(i){case"RangeColumn":case"RangeArea":case"SplineRangeArea":case"Hilo":e="HighLow";break;case"HiloOpenClose":case"Candle":e="HighLowOpenClose";break;case"BoxAndWhisker":e="BoxPlot";break;default:e="XY"}}this.seriesType=e},t.prototype.pushCategoryData=function(e,i,r){if(!this.chart.tooltip.shared&&!this.visible)return null;this.xAxis.isIndexed?(this.xAxis.labels[i]?this.xAxis.labels[i]+=", "+r:this.xAxis.labels.push(r),e.xValue=i):(this.xAxis.indexLabels[r]===void 0&&(this.xAxis.indexLabels[r]=this.xAxis.labels.length,this.xAxis.labels.push(r)),e.xValue=this.xAxis.indexLabels[r])},t.prototype.getAverage=function(e,i,r){r===void 0&&(r=this.currentViewData);var n=r[i-1]&&r[i-1][e]||0,s=r[i+1]&&r[i+1][e]||0;return(n+s)/2},t.prototype.refreshDataManager=function(e,i){var r=this;this.chart=e;var n,s="isAngular";if(e[s]?n=Object.keys(this.dataSource).length?this.dataSource:e.dataSource:n=this.dataSource||e.dataSource,!(n instanceof Oe.h)&&(0,a.le)(this.query)){i.points=[],this.dataManagerSuccess({result:n,count:n.length},!1);return}if((0,a.le)(i.points)){var l=this.dataModule.getData(this.dataModule.generateQuery().requiresCount());l.then(function(h){return r.dataManagerSuccess(h)})}else e.visibleSeriesCount++},t.prototype.dataManagerSuccess=function(e,i){if(i===void 0&&(i=!0),this.currentViewData=e.count?e.result:[],this.chart.allowServerDataBinding=!1,this instanceof Ki){this.chart.stockChart&&(this.chart.stockChart.series[this.index].localData=this.currentViewData);var r={name:hc,series:this,data:this.currentViewData,fill:this.interior};this.chart.trigger(hc,r),this.interior=r.fill,this.currentViewData=r.data}this.chart.stockChart&&!(this instanceof Ki)&&(this.currentViewData=this.chart.stockChart.findCurrentData(this.chart.stockChart.series[0].localData,this.chart.stockChart.series[0].xName)),this.processJsonData(),this.recordsCount=e.count,this.refreshChart(i),this.currentViewData=null},t.prototype.refreshChart=function(e){var i=this.chart;if(this instanceof Ki&&(i.visibleSeriesCount+=e?1:0),i.refreshTechnicalIndicator(this),this instanceof Ki&&this.category!=="TrendLine")for(var r=0,n=this.trendlines;r<n.length;r++){var s=n[r];s.setDataSource(this,i)}i.visibleSeries.length===i.visibleSeriesCount&&(i.refreshBound(),i.trigger("loaded",{chart:i.isBlazor?{}:i}),this.chart.stockChart&&this.chart.stockChart.initialRender&&(this.chart.stockChart.initialRender=!1,this.chart.stockChart.stockChartDataManagerSuccess())),this instanceof Ki&&(i.visibleSeriesCount+=e?0:1)},qe([(0,a.Z9)("")],t.prototype,"xName",void 0),qe([(0,a.Z9)("")],t.prototype,"colorName",void 0),qe([(0,a.Z9)("")],t.prototype,"high",void 0),qe([(0,a.Z9)("")],t.prototype,"low",void 0),qe([(0,a.Z9)("")],t.prototype,"open",void 0),qe([(0,a.Z9)("")],t.prototype,"close",void 0),qe([(0,a.Z9)("")],t.prototype,"volume",void 0),qe([(0,a.Z9)("")],t.prototype,"pointColorMapping",void 0),qe([(0,a.Z9)(!0)],t.prototype,"visible",void 0),qe([(0,a.Z9)(null)],t.prototype,"xAxisName",void 0),qe([(0,a.Z9)(null)],t.prototype,"yAxisName",void 0),qe([(0,a.Zz)(null,Ed)],t.prototype,"animation",void 0),qe([(0,a.Z9)(null)],t.prototype,"fill",void 0),qe([(0,a.Z9)(1)],t.prototype,"width",void 0),qe([(0,a.Z9)("0")],t.prototype,"dashArray",void 0),qe([(0,a.Z9)("")],t.prototype,"dataSource",void 0),qe([(0,a.Z9)()],t.prototype,"query",void 0),qe([(0,a.FE)([],Bx)],t.prototype,"segments",void 0),qe([(0,a.Z9)("X")],t.prototype,"segmentAxis",void 0),qe([(0,a.Z9)(!1)],t.prototype,"enableComplexProperty",void 0),t}(a.rt),Ki=function(o){Rs(t,o);function t(e,i,r,n){var s=o.call(this,e,i,r,n)||this;return s.visibleSeriesCount=0,s.category="Series",s.isRectSeries=!1,s.drawPoints=[],s.lowDrawPoints=[],s.delayedAnimation=!1,s.rangeColorName=s.colorName.length>0?s.colorName:s.yName,s}return t.prototype.refreshAxisLabel=function(){if(this.xAxis.valueType!=="Category")return null;this.xAxis.labels=[],this.xAxis.indexLabels={};for(var e=0,i=this.xAxis.series;e<i.length;e++){var r=i[e];if(r.visible&&r.category!=="TrendLine"){r.xMin=Infinity,r.xMax=-Infinity;for(var n=0,s=r.points;n<s.length;n++){var l=s[n];r.pushCategoryData(l,l.index,l.x),r.xMin=Math.min(r.xMin,l.xValue),r.xMax=Math.max(r.xMax,l.xValue)}}}},t.prototype.findSeriesCollection=function(e,i,r){for(var n=[],s=0,l=i.axes;s<l.length;s++)for(var h=l[s],c=0,u=h.series;c<u.length;c++)for(var p=u[c],f=0,g=e.axes;f<g.length;f++)for(var C=g[f],L=0,D=C.series;L<D.length;L++){var R=D[L];R===p&&R.visible&&this.rectSeriesInChart(R,r)&&n.push(R)}return n},t.prototype.rectSeriesInChart=function(e,i){var r=e.type.toLowerCase();return r.indexOf("column")!==-1||r.indexOf("bar")!==-1||r.indexOf("histogram")!==-1||r.indexOf("hiloopenclose")!==-1||r.indexOf("candle")!==-1||r.indexOf("pareto")!==-1||r.indexOf("hilo")!==-1||e.drawType.indexOf("Column")!==-1||r.indexOf("waterfall")!==-1||r.indexOf("boxandwhisker")!==-1||i},t.prototype.calculateStackedValue=function(e,i){for(var r=0,n=i.columns;r<n.length;r++)for(var s=n[r],l=0,h=i.rows;l<h.length;l++){var c=h[l];this.calculateStackingValues(this.findSeriesCollection(s,c,!0),e)}},t.prototype.calculateStackingValues=function(e,i){var r,n,s=[],l=[],h=[],c,u,p,f=[];i&&(f=this.findFrequencies(e));for(var g=[],C=[],L=[],D=0,R=e;D<R.length;D++){var B=R[D];if(B.type.indexOf("Stacking")!==-1||B.drawType.indexOf("Stacking")!==-1&&B.chart.chartAreaType==="PolarRadar"){c=B.type.indexOf("StackingArea")!==-1?"StackingArea100":B.type.indexOf("StackingLine")!==-1?"StackingLine100":B.stackingGroup,l[c]||(l[c]=[],h[c]=[]),s=B.yData,r=[],n=[],g.push(B),L=ua(B);for(var H=0,j=L.length;H<j;H++)u=0,p=+s[H],l[c][L[H].xValue]===void 0&&(l[c][L[H].xValue]=0),h[c][L[H].xValue]===void 0&&(h[c][L[H].xValue]=0),i?(p=p/f[c][L[H].xValue]*100,p=isNaN(p)?0:p,L[H].percentage=+p.toFixed(2)):C[H]=C[H]?C[H]+Math.abs(p):Math.abs(p),p>=0?(u=l[c][L[H].xValue],l[c][L[H].xValue]+=p):(u=h[c][L[H].xValue],h[c][L[H].xValue]+=p),r.push(u),n.push(p+u),i&&n[H]>100&&(n[H]=100);B.stackedValues=new kx(r,n);var W=B.yAxis.valueType==="Logarithmic",ne=B.type.indexOf("Column")!==-1||B.type.indexOf("Bar")!==-1;B.yMin=W&&ne&&B.yMin<1?B.yMin:Math.min.apply(0,r),B.yMax=Math.max.apply(0,n),B.yMin>Math.min.apply(0,n)&&(B.yMin=i?-100:W&&ne&&B.yMin<1?B.yMin:Math.min.apply(0,n)),B.yMax<Math.max.apply(0,r)&&(B.yMax=0)}}this.findPercentageOfStacking(g,C,i)},t.prototype.findPercentageOfStacking=function(e,i,r){for(var n=0,s=e;n<s.length;n++){var l=s[n];if(r)return null;for(var h=0,c=ua(l);h<c.length;h++){var u=c[h];u.percentage=Math.abs(+(u.y/i[u.index]*100).toFixed(2))}}},t.prototype.findFrequencies=function(e){for(var i=[],r,n=[],s=0,l=e;s<l.length;s++){var h=l[s];if(h.yAxis.isStack100=h.type.indexOf("100")!==-1,n=ua(h),h.type.indexOf("Stacking")!==-1){r=h.type.indexOf("StackingArea")!==-1?"StackingArea100":h.type.indexOf("StackingLine")!==-1?"StackingLine100":h.stackingGroup,i[r]||(i[r]=[]);for(var c=0,u=n.length;c<u;c++)i[r][n[c].xValue]===void 0&&(i[r][n[c].xValue]=0),h.yData[c]>0?i[r][n[c].xValue]+=h.yData[c]:i[r][n[c].xValue]-=h.yData[c]}}return i},t.prototype.renderSeries=function(e){var i=On(this.type);i=i.replace("100",""),e[i+"SeriesModule"]&&(this.category!=="Indicator"&&this.category!=="TrendLine"&&this.createSeriesElements(e),this.visiblePoints=ua(this),e[i+"SeriesModule"].render(this,this.xAxis,this.yAxis,e.requireInvertedAxis),this.category!=="Indicator"&&(this.errorBar.visible&&this.chart.errorBarModule.render(this),this.marker.dataLabel.visible&&e.dataLabelModule.render(this,this.chart,this.marker.dataLabel),this.appendSeriesElement(e.seriesElements,e)),this.chart.enableCanvas||this.performAnimation(e,i,this.errorBar,this.marker,this.marker.dataLabel))},t.prototype.createSeriesElements=function(e){if(this.category!=="Indicator"){var i=e.element.id,r=this.marker.border.width+8+5,n=this.type==="Scatter"||this.type==="Bubble"||this.drawType==="Scatter"?e.svgRenderer:e.renderer,s=this.index===void 0?this.category:this.index,l=void 0,h=void 0,c=void 0;if(this.type==="Scatter"||this.drawType==="Scatter"?(l=e.primaryYAxis.maximum||e.primaryXAxis.maximum?0:(this.marker.height+r)/2,h=e.primaryYAxis.maximum||e.primaryXAxis.maximum?0:(this.marker.width+r)/2):(l=0,h=0),e.chartAreaType==="PolarRadar"){var u=this.drawType==="Scatter"?Math.max(this.marker.width,this.marker.height):0;c=new Gg(i+"_ChartSeriesClipRect_"+s,"transparent",{width:1,color:"Gray"},1,this.clipRect.width/2+this.clipRect.x,this.clipRect.height/2+this.clipRect.y,e.radius+u),this.clipRectElement=da(e.redraw,c,n,"drawCircularClipPath")}else c=new Sn(i+"_ChartSeriesClipRect_"+s,"transparent",{width:1,color:"Gray"},1,{x:-h,y:-l,width:this.clipRect.width+h*2,height:this.clipRect.height+l*2}),this.clipRectElement=da(e.redraw,c,n);var p=e.chartAreaType==="Cartesian"?"translate("+this.clipRect.x+","+this.clipRect.y+")":"";this.symbolElement=null,this.seriesElement=n.createGroup({id:i+"SeriesGroup"+s,transform:p,"clip-path":"url(#"+i+"_ChartSeriesClipRect_"+s+")"}),(!this.chart.enableCanvas||this.type==="Scatter"||this.type==="Bubble"||this.drawType==="Scatter")&&this.seriesElement.appendChild(this.clipRectElement)}},t.prototype.appendSeriesElement=function(e,i){var r=this.marker,n=r.dataLabel,s=i.redraw;if(this.category!=="TrendLine"){Nt(i.enableCanvas,i.seriesElements,this.seriesElement,s);var l=this.errorBar;l.visible&&(i.chartAreaType==="PolarRadar"?Nt(i.enableCanvas,i.seriesElements,this.seriesElement,s):Nt(i.enableCanvas,i.seriesElements,this.errorBarElement,s)),(this.type==="Scatter"||this.type==="Bubble"||this.drawType==="Scatter")&&Nt(!1,i.seriesElements,this.seriesElement,s)}r.visible&&(i.chartAreaType==="Cartesian"||this.drawType!=="Scatter"&&i.chartAreaType==="PolarRadar")&&this.type!=="Scatter"&&this.type!=="Bubble"&&this.type!=="Candle"&&this.type!=="Hilo"&&this.type!=="HiloOpenClose"&&this.symbolElement&&Nt(i.enableCanvas,i.seriesElements,this.symbolElement,s),n.visible&&this.textElement&&(Nt(i.enableCanvas,i.dataLabelElements,this.shapeElement,s),Nt(i.enableCanvas,i.dataLabelElements,this.textElement,s)),!i.enableCanvas&&i.dataLabelElements.hasChildNodes()&&i.seriesElements.appendChild(i.dataLabelElements)},t.prototype.performAnimation=function(e,i,r,n,s){this.animation.enable&&e.animateSeries&&(e[i+"SeriesModule"].doAnimation(this),r.visible&&e.errorBarModule.doErrorBarAnimation(this),n.visible&&e.markerRender.doMarkerAnimation(this),s.visible&&a.AR.info.name!=="edge"&&!a.AR.isIE&&e.dataLabelModule.doDataLabelAnimation(this))},t.prototype.setPointColor=function(e,i){return i=e.interior||i,e.isEmpty&&this.emptyPointSettings.fill||i},t.prototype.setBorderColor=function(e,i){return i.width=e.isEmpty&&this.emptyPointSettings.border.width||i.width,i.color=e.isEmpty&&this.emptyPointSettings.border.color||i.color,i},qe([(0,a.Z9)("")],t.prototype,"name",void 0),qe([(0,a.Z9)("")],t.prototype,"yName",void 0),qe([(0,a.Z9)("Line")],t.prototype,"drawType",void 0),qe([(0,a.Z9)(!0)],t.prototype,"isClosed",void 0),qe([(0,a.Z9)("#2ecd71")],t.prototype,"bearFillColor",void 0),qe([(0,a.Z9)("#e74c3d")],t.prototype,"bullFillColor",void 0),qe([(0,a.Z9)(!1)],t.prototype,"enableSolidCandles",void 0),qe([(0,a.Z9)("")],t.prototype,"size",void 0),qe([(0,a.Z9)(null)],t.prototype,"binInterval",void 0),qe([(0,a.Z9)(!1)],t.prototype,"showNormalDistribution",void 0),qe([(0,a.Z9)("")],t.prototype,"stackingGroup",void 0),qe([(0,a.Zz)({color:"transparent",width:0},xr)],t.prototype,"border",void 0),qe([(0,a.Z9)(1)],t.prototype,"opacity",void 0),qe([(0,a.Z9)(0)],t.prototype,"zOrder",void 0),qe([(0,a.Z9)("")],t.prototype,"groupName",void 0),qe([(0,a.Z9)("Line")],t.prototype,"type",void 0),qe([(0,a.Zz)(null,Fx)],t.prototype,"errorBar",void 0),qe([(0,a.Zz)(null,$g)],t.prototype,"marker",void 0),qe([(0,a.Zz)({},Ow)],t.prototype,"dragSettings",void 0),qe([(0,a.FE)([],Px)],t.prototype,"trendlines",void 0),qe([(0,a.Z9)(!0)],t.prototype,"enableTooltip",void 0),qe([(0,a.Z9)("")],t.prototype,"tooltipFormat",void 0),qe([(0,a.Z9)("")],t.prototype,"tooltipMappingName",void 0),qe([(0,a.Z9)("SeriesType")],t.prototype,"legendShape",void 0),qe([(0,a.Z9)("")],t.prototype,"legendImageUrl",void 0),qe([(0,a.Z9)(null)],t.prototype,"selectionStyle",void 0),qe([(0,a.Z9)(null)],t.prototype,"unSelectedStyle",void 0),qe([(0,a.Z9)(null)],t.prototype,"nonHighlightStyle",void 0),qe([(0,a.Z9)(1)],t.prototype,"minRadius",void 0),qe([(0,a.Z9)(3)],t.prototype,"maxRadius",void 0),qe([(0,a.Z9)("Natural")],t.prototype,"splineType",void 0),qe([(0,a.Z9)(.5)],t.prototype,"cardinalSplineTension",void 0),qe([(0,a.Zz)(null,lg)],t.prototype,"emptyPointSettings",void 0),qe([(0,a.Z9)(!0)],t.prototype,"showMean",void 0),qe([(0,a.Z9)("Normal")],t.prototype,"boxPlotMode",void 0),qe([(0,a.Z9)(null)],t.prototype,"columnWidth",void 0),qe([(0,a.Z9)(null)],t.prototype,"columnWidthInPixel",void 0),qe([(0,a.Z9)(0)],t.prototype,"columnSpacing",void 0),qe([(0,a.Z9)("#C64E4A")],t.prototype,"negativeFillColor",void 0),qe([(0,a.Z9)("#4E81BC")],t.prototype,"summaryFillColor",void 0),qe([(0,a.Z9)()],t.prototype,"intermediateSumIndexes",void 0),qe([(0,a.Z9)()],t.prototype,"sumIndexes",void 0),qe([(0,a.Zz)({color:"black",width:2},Ja)],t.prototype,"connector",void 0),qe([(0,a.Zz)(null,Iw)],t.prototype,"cornerRadius",void 0),t}(Jg),e0=function(){function o(t,e){this.initDataManager(t,e)}return o.prototype.initDataManager=function(t,e){this.dataManager=t instanceof Oe.h?t:new Oe.h(t),this.query=e instanceof yt.A?e:new yt.A},o.prototype.generateQuery=function(){var t=this.query.clone();return t},o.prototype.getData=function(t){var e=this;if(this.dataManager.ready){var i=new Oe.B,r=this.dataManager.ready;return r.then(function(){e.dataManager.executeQuery(t).then(function(n){i.resolve(n)})}).catch(function(n){i.reject(n)}),i.promise}else return this.dataManager.executeQuery(t)},o}(),Hx=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Vx=function(o){Hx(t,o);function t(e){var i=o.call(this,e)||this;return i.elementId=e.element.id,i.commonXvalues=[],i}return t.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(a.AR.touchMoveEvent,this.mouseMoveHandler,this),this.chart.on(a.AR.touchEndEvent,this.mouseUpHandler,this))},t.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(a.AR.touchMoveEvent,this.mouseMoveHandler),this.chart.off(a.AR.touchEndEvent,this.mouseUpHandler))},t.prototype.mouseUpHandler=function(){var e=this.chart;e.isTouch&&!e.crosshair.enable&&!this.isSelected(e)&&this.markerMove(!0)},t.prototype.mouseMoveHandler=function(){var e=this.chart;(e.highlightMode!="None"||e.tooltip.enable)&&(!e.isTouch||e.startMove)&&!this.isSelected(e)&&this.markerMove(!1)},t.prototype.markerMove=function(e){var i=this,r=this.chart;this.currentPoints=[];var n,s,l,h;if(!r.tooltip.shared||!r.tooltip.enable)n=this.getData(),h=n.series,s=this.previousPoints[0],l=h&&(h.type==="Bubble"||h.drawType==="Scatter"||h.type==="Scatter"||h.type!=="Candle"&&h.type!=="Hilo"&&h.type!=="HiloOpenClose"&&h.marker.visible&&h.marker.width!==0&&h.marker.height!==0),n.lierIndex=this.lierIndex,n.point&&l&&(!s||s.point!==n.point||s&&s.lierIndex>3&&s.lierIndex!==this.lierIndex)&&this.currentPoints.push(n),n.point&&l&&r.isPointMouseDown&&this.currentPoints.push(n);else{if(!sn(r.mouseX,r.mouseY,r.chartAxisLayoutPanel.seriesClipRect))return null;if(r.tooltip.enable)for(var c=r.chartAreaType==="PolarRadar"?this.getData():null,u=this.mergeXvalues(this.chart.visibleSeries),p=0,f=r.visibleSeries;p<f.length;p++){var g=f[p];!g.enableTooltip||g.category==="Indicator"||(r.chartAreaType==="Cartesian"&&g.visible?n=this.getClosestX(r,g,u):r.chartAreaType==="PolarRadar"&&g.visible&&c.point!==null&&(n=new wc(g.points[c.point.index],g)),n&&(this.currentPoints.push(n),n=null))}}var C=this.previousPoints.length;if(this.currentPoints.length>0&&(C===0||r.isPointMouseDown||C>0&&this.previousPoints[0].point!==this.currentPoints[0].point)){if(this.previousPoints.length>0)for(var L=0,D=this.previousPoints;L<D.length;L++){var R=D[L];(0,a.le)(R)||this.removeHighlightedMarker(R.series,R.point)}for(var B=function(ie){(ie&&ie.point||h.type!=="Candle"&&h.type!=="Hilo"&&h.type!=="HiloOpenClose")&&(Ug(H.markerExplode),H.isRemove=!0,ie.point.symbolLocations.map(function(me,ve){(!ie.series.isRectSeries||ie.point.marker.visible)&&i.drawTrackBall(ie.series,ie.point,me,ve)}))},H=this,j=0,W=this.currentPoints;j<W.length;j++){var ne=W[j];B(ne)}this.previousPoints=(0,a.l7)([],this.currentPoints,null,!0)}!r.tooltip.enable&&(this.currentPoints.length===0&&this.isRemove||e&&this.isRemove||!sn(r.mouseX,r.mouseY,r.chartAxisLayoutPanel.seriesClipRect))&&(this.isRemove=!1,(0,a.le)(this.previousPoints[0])||(this.markerExplode=+setTimeout(function(){i.removeHighlightedMarker(i.previousPoints[0].series,i.previousPoints[0].point)},2e3))),this.currentPoints=[]},t.prototype.animationDuration=function(){var e=200;return this.chart.maxPointCount>100?e=10:this.chart.maxPointCount>50&&(e=100),e},t.prototype.drawTrackBall=function(e,i,r,n){var s=i.marker,l=e.marker,h=s.shape||l.shape;if(h==="None")return null;var c=e.symbolElement||e.seriesElement,u;this.chart.highlightModule&&this.chart.highlightMode!=="None"&&(u=this.chart.highlightModule.generateStyle(e)),this.chart.selectionModule&&this.chart.selectionMode!=="None"&&(u=this.chart.selectionModule.generateStyle(e));var p=this.elementId+"_Series_"+e.index+"_Point_"+i.index+"_Trackball"+(n||""),f=new ni((s.width||l.width)+5,(s.height||l.height)+5),g=s.border||e.border,C=e.type==="BoxAndWhisker"||e.type==="Bubble"||e.type==="Scatter",L=g.color&&g.color!=="transparent"?g.color:s.fill||i.interior||(C?i.color:e.interior),D=bc(Zr(L)),R=s.border?s.border.width:l.border.width,B=e.chart.themeStyle.markerShadow||"rgba("+D.r+","+D.g+","+D.b+",0.2)",H=document.getElementById(this.elementId+"_Series_"+e.index+"_Point_"+i.index+"_Symbol");(0,a.le)(H)||H.setAttribute("visibility","hidden");for(var j=0;j<2;j++){var W=new er(p+"_"+j,j?s.fill||i.color||(C?e.interior:"#ffffff"):"transparent",R+(j?0:8),j?L:B,s.opacity||l.opacity,null,null),ne=qr(r,h,f,s.imageUrl,W,"",this.chart.svgRenderer,e.clipRect);ne.setAttribute("class","EJ2-Trackball_Series_"+e.index+"_Point_"+i.index);var ie=c.id.indexOf("Symbol")!==-1?"_Symbol":"",me=document.getElementById(this.elementId+"_Series_"+e.index+"_Point_"+i.index+ie);u!==""&&!(0,a.le)(u)&&!(0,a.le)(me)&&me.hasAttribute("class")&&u===me.getAttribute("class")&&ne.classList.add(u),ne.setAttribute("clip-path",c.getAttribute("clip-path")),ne.setAttribute("transform",c.getAttribute("transform")),this.chart.svgObject.appendChild(ne)}this.doAnimation(e,i,!1)},t.prototype.doAnimation=function(e,i,r){r===void 0&&(r=!1);for(var n=this.animationDuration(),s=e.animation.delay,l=document.getElementsByClassName("EJ2-Trackball_Series_"+e.index+"_Point_"+i.index),h=0,c=l.length;h<c;h++)this.trackballAnimate(l[h],s,n,e,i.index,i.symbolLocations[0],!1,r)},t.prototype.trackballAnimate=function(e,i,r,n,s,l,h,c){var u=l.x,p=l.y,f=n.type!=="Polar"&&n.type!=="Radar"?n.clipRect.x:0,g=n.type!=="Polar"&&n.type!=="Radar"?n.clipRect.y:0,C=0;e.style.visibility="hidden";var L=c?-8:1;new a.fw({}).animate(e,{duration:r,delay:i,progress:function(D){D.timeStamp>D.delay&&(D.element.style.visibility="visible",C=(D.timeStamp-D.delay)/D.duration,e.setAttribute("transform","translate("+(u+f)+" "+(p+g)+") scale("+C/L+") translate("+-u+" "+-p+")"))},end:function(){e.style.visibility="",!h&&s===n.points.length-1&&n.chart.trigger("animationComplete",{series:n.chart.isBlazor?{}:n}),c&&(0,a.Od)(e)}})},t.prototype.removeHighlightedMarker=function(e,i,r){if(e===void 0&&(e=null),i===void 0&&(i=null),r===void 0&&(r=!1),!(0,a.le)(e)&&!(0,a.le)(i)){for(var n=document.getElementById(this.elementId+"_Series_"+e.index+"_Point_"+i.index+"_Symbol"),s=document.getElementsByClassName("EJ2-Trackball_Series_"+e.index+"_Point_"+i.index),l=0,h=s.length;l<h;l++)(0,a.Od)(s[0]);(0,a.le)(n)||n.setAttribute("visibility","visible")}else for(var c=0,u=e.points;c<u.length;c++)for(var p=u[c],f=document.getElementsByClassName("EJ2-Trackball_Series_"+e.index+"_Point_"+p.index),n=document.getElementById(this.elementId+"_Series_"+e.index+"_Point_"+p.index+"_Symbol"),l=0,h=f.length;l<h;l++)(0,a.le)(n)||n.setAttribute("visibility","visible"),(0,a.Od)(f[0]);r&&(this.previousPoints=[])},t}(Md),zx=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),_x=function(o){zx(t,o);function t(e){var i=o.call(this,e)||this;return i.addEventListener(),i}return t.prototype.render=function(e){var i=this,r=e.chart.redraw;this.createElement(e,r);for(var n=function(c){c.visible&&c.symbolLocations&&c.symbolLocations.length&&c.symbolLocations.map(function(u,p){e.marker.shape!=="None"&&i.renderMarker(e,c,u,p,r)})},s=0,l=e.points;s<l.length;s++){var h=l[s];n(h)}},t.prototype.renderMarker=function(e,i,r,n,s){var l=e.index===void 0?e.category:e.index,h=e.marker,c={color:h.border.color,width:h.border.width},u=h.border.color,p,f,g,C;r.x=r.x+h.offset.x,r.y=r.y-h.offset.y;var L=e.type==="BoxAndWhisker",D=h.fill||(L?i.interior||e.interior:"#ffffff"),R,B=L?Sx(e.seriesElement.childNodes,"Series_"+e.index+"_Point_"+i.index):e.symbolElement;c.color=u||e.setPointColor(i,e.interior);var H=this.elementId+"_Series_"+l+"_Point_"+i.index+"_Symbol"+(n||""),j={cancel:!1,name:Ds,series:e,point:i,fill:i.isEmpty&&e.emptyPointSettings.fill||D,border:{color:e.type==="BoxAndWhisker"?!(0,a.le)(u)&&u!=="transparent"?u:Ex(D,-.6):c.color,width:c.width},height:h.height,width:h.width,shape:h.shape};if(j.border=e.setBorderColor(i,{width:j.border.width,color:j.border.color}),(!e.isRectSeries||e.type==="BoxAndWhisker")&&(this.chart.trigger(Ds,j),i.color=j.fill),i.color=j.fill,j.cancel)r=null,i.marker={visible:!1};else{var W=void 0;e.type==="RangeArea"||e.type==="RangeColumn"||e.drawType==="RangeColumn"||e.type==="SplineRangeArea"?W=n?i.low:i.high:L?W=i.outliers[n]:W=i.y;var ne=j.point.marker.fill||j.fill,ie=void 0;(0,a.le)(j.point.marker.border)?ie={color:j.border.color,width:j.border.width}:ie={color:j.point.marker.border.color||j.border.color,width:j.point.marker.border.width||j.border.width};var me=j.point.marker.width||j.width,ve=j.point.marker.height||j.height,Ee=j.point.marker.opacity||h.opacity,le=j.point.marker.shape||j.shape,de=j.point.marker.imageUrl||h.imageUrl;C=new er(H,ne,ie.width,ie.color,Ee,null),(B!=null||this.chart.enableCanvas)&&(s&&xt(C.id)&&(R=xt(C.id),g=le==="Circle"?"c":"",p={x:+R.getAttribute(g+"x"),y:+R.getAttribute(g+"y")},f=R.getAttribute("d")),R=qr(r,le,new ni(me,ve),de,C,i.x.toString()+":"+W.toString(),this.chart.renderer,e.clipRect),Nt(this.chart.enableCanvas,B,R,s,!0,g+"x",g+"y",p,f,!1,!1,null,e.chart.duration)),i.marker={border:ie,fill:ne,height:ve,visible:!0,shape:le,width:me,imageUrl:de}}},t.prototype.createElement=function(e,i){var r,n=e.marker,s=n.border.width+8+5,l=e.chart.svgRenderer,h=e.index===void 0?e.category:e.index,c,u=e.chart.chartAreaType==="Cartesian"?"translate("+e.clipRect.x+","+e.clipRect.y+")":"";if(n.visible){var p=(n.height+s)/2,f=(n.width+s)/2;if(e.chart.chartAreaType==="Cartesian"?(c=new Sn(this.elementId+"_ChartMarkerClipRect_"+h,"transparent",{width:1,color:"Gray"},1,{x:-f,y:-p,width:e.clipRect.width+f*2,height:e.clipRect.height+p*2}),r=da(i,c,l)):(c=new Gg(this.elementId+"_ChartMarkerClipRect_"+h,"transparent",{width:1,color:"Gray"},1,e.clipRect.width/2+e.clipRect.x,e.clipRect.height/2+e.clipRect.y,e.chart.radius+Math.max(p,f)),r=da(i,c,l,"drawCircularClipPath")),c={id:this.elementId+"SymbolGroup"+h,transform:u,"clip-path":"url(#"+this.elementId+"_ChartMarkerClipRect_"+h+")"},e.symbolElement=l.createGroup(c),e.symbolElement.appendChild(r),this.chart.enableCanvas){var g=document.getElementById(this.chart.element.id+"_tooltip_svg");g.appendChild(e.symbolElement)}}},t.prototype.getRangeLowPoint=function(e,i){var r=e.x,n=e.y;return i.chart.requireInvertedAxis?(n+=e.height/2,r+=i.yAxis.isAxisInverse?e.width:0):(n+=i.yAxis.isAxisInverse?0:e.height,r+=e.width/2),{x:r,y:n}},t.prototype.doMarkerAnimation=function(e){if(!(e.type==="Scatter"||e.type==="Bubble"||e.type==="Candle"||e.type==="Hilo"||e.type==="HiloOpenClose"||e.chart.chartAreaType==="PolarRadar"&&e.drawType==="Scatter")){for(var i=e.symbolElement.childNodes,r=e.animation.delay+e.animation.duration,n=e.chart.animated?e.chart.duration:200,s=1,l=e.type==="RangeArea"||e.type==="RangeColumn"||e.type==="SplineRangeArea"?2:1,h=0;h<e.points.length;h++)if(e.points[h].symbolLocations){if(!e.points[h].symbolLocations.length||!i[s])continue;if(fl(i[s],r,n,e,h,e.points[h].symbolLocations[0],!1),l===2){var c=this.getRangeLowPoint(e.points[h].regions[0],e);fl(i[s+1],r,n,e,h,c,!1)}s+=l}}},t}(Vx),t0=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),li=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},jx=function(o){t0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return li([(0,a.Z9)(0)],t.prototype,"x",void 0),li([(0,a.Z9)(0)],t.prototype,"y",void 0),t}(a.rt),i0=function(o){t0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return li([(0,a.Z9)(!0)],t.prototype,"visible",void 0),li([(0,a.Z9)(null)],t.prototype,"height",void 0),li([(0,a.Z9)(null)],t.prototype,"width",void 0),li([(0,a.Zz)({x:0,y:0},jx)],t.prototype,"location",void 0),li([(0,a.Z9)("Auto")],t.prototype,"position",void 0),li([(0,a.Z9)("Series")],t.prototype,"mode",void 0),li([(0,a.Z9)(8)],t.prototype,"padding",void 0),li([(0,a.Z9)("Center")],t.prototype,"alignment",void 0),li([(0,a.Zz)(Mr.legendLabelFont,Pr)],t.prototype,"textStyle",void 0),li([(0,a.Z9)(10)],t.prototype,"shapeHeight",void 0),li([(0,a.Z9)(10)],t.prototype,"shapeWidth",void 0),li([(0,a.Zz)({},xr)],t.prototype,"border",void 0),li([(0,a.Zz)({left:0,right:0,top:0,bottom:0},sc)],t.prototype,"margin",void 0),li([(0,a.Zz)({left:0,right:0,top:0,bottom:0},kw)],t.prototype,"containerPadding",void 0),li([(0,a.Z9)(5)],t.prototype,"shapePadding",void 0),li([(0,a.Z9)("transparent")],t.prototype,"background",void 0),li([(0,a.Z9)(1)],t.prototype,"opacity",void 0),li([(0,a.Z9)(!0)],t.prototype,"toggleVisibility",void 0),li([(0,a.Z9)(null)],t.prototype,"description",void 0),li([(0,a.Z9)(3)],t.prototype,"tabIndex",void 0),li([(0,a.Z9)(null)],t.prototype,"title",void 0),li([(0,a.Zz)(Mr.legendTitleFont,Pr)],t.prototype,"titleStyle",void 0),li([(0,a.Z9)("Top")],t.prototype,"titlePosition",void 0),li([(0,a.Z9)("Normal")],t.prototype,"textWrap",void 0),li([(0,a.Z9)("Ellipsis")],t.prototype,"textOverflow",void 0),li([(0,a.Z9)(100)],t.prototype,"maximumTitleWidth",void 0),li([(0,a.Z9)(null)],t.prototype,"maximumLabelWidth",void 0),li([(0,a.Z9)(!0)],t.prototype,"enablePages",void 0),li([(0,a.Z9)(!1)],t.prototype,"isInversed",void 0),li([(0,a.Z9)(!1)],t.prototype,"reverse",void 0),t}(a.rt),r0=function(){function o(t){this.maxItemHeight=0,this.rowHeights=[],this.pageHeights=[],this.columnHeights=[],this.pageXCollections=[],this.chartRowCount=1,this.legendTitleCollections=[],this.legendRegions=[],this.pagingRegions=[],this.chart=t,this.legend=t.legendSettings,this.legendID=t.element.id+"_chart_legend",this.isChartControl=t.getModuleName()==="chart",this.isAccChartControl=t.getModuleName()==="accumulationchart",this.isBulletChartControl=t.getModuleName()==="bulletChart",this.isStockChartControl=t.getModuleName()==="stockChart",this.bulletChart=this.chart,this.fivePixel=5,this.rowCount=0,this.pageButtonSize=8,this.maxColumns=0,this.maxWidth=0,this.currentPage=1,this.backwardArrowOpacity=0,this.forwardArrowOpacity=1,this.arrowWidth=2*(this.fivePixel+this.pageButtonSize+this.fivePixel),this.arrowHeight=this.arrowWidth,this.isTop=!1,this.isTitle=!1,this.currentPageNumber=1}return o.prototype.calculateLegendBounds=function(t,e,i){var r=this.legend,n=this.isBulletChartControl?"40%":"20%";this.getPosition(r.position,e),this.legendBounds=new ft(t.x,t.y,0,0),this.isVertical=this.position==="Left"||this.position==="Right",this.isVertical?(this.legendBounds.height=yi(r.height,e.height-(t.y-this.chart.margin.top))||t.height,this.legendBounds.width=yi(r.width||n,e.width)):(this.legendBounds.width=yi(r.width,e.width)||t.width,this.legendBounds.height=yi(r.height||n,e.height)),this.library.getLegendBounds(e,this.legendBounds,r),this.isBulletChartControl||(this.legendBounds.width+=this.legend.containerPadding.left+this.legend.containerPadding.right,this.legendBounds.height+=this.legend.containerPadding.top+this.legend.containerPadding.bottom),this.getLocation(this.position,r.alignment,this.legendBounds,t,e,i)},o.prototype.getPosition=function(t,e){var i=this.chart,r=this.chart;this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.position=t!=="Auto"?t:"Bottom":(t==="Auto"&&((i||r).visibleSeries&&(i||r).visibleSeries[0].type==="Funnel"||(i||r).visibleSeries[0].type==="Pyramid")&&(t="Top"),this.position=t!=="Auto"?t:e.width>e.height?"Right":"Bottom")},o.prototype.setBounds=function(t,e,i,r){var n=i.title&&i.titlePosition==="Top"?this.legendTitleSize.height+this.fivePixel:0;this.isVertical&&this.isPaging&&!i.enablePages&&!this.isBulletChartControl&&(n=i.title&&i.titlePosition==="Top"?this.legendTitleSize.height+this.fivePixel:0,n+=this.pageButtonSize+this.fivePixel),t=Math.min(t,r.width),e=Math.min(e,r.height),i.mode==="Gradient"?(r.width=i.width?r.width:this.isVertical?t:.75*r.width,r.height=i.height?r.height:this.isVertical?.75*r.height:e):(r.width=i.width?r.width:t,r.height=i.height?r.height:e),this.isBulletChartControl||this.isTop&&i.titleStyle.textOverflow!=="None"&&(this.calculateLegendTitle(i,r),r.height+=i.titleStyle.textOverflow==="Wrap"&&this.legendTitleCollections.length>1?this.legendTitleSize.height-this.legendTitleSize.height/this.legendTitleCollections.length:0),this.rowCount=Math.max(1,Math.ceil((r.height-i.padding-n)/(this.maxItemHeight+i.padding)))},o.prototype.getLocation=function(t,e,i,r,n,s){var l=this.legend.border.width,h=this.isBulletChartControl,c=this.bulletChart,u=c.labelPosition==="Inside",p=c.tickPosition==="Inside",f=c.orientation==="Vertical",g=h&&c.categoryField!==""?s.width+this.chart.border.width+l*3:0,C=this.chart.margin.bottom,L=i.height+l+this.legend.margin.top+this.legend.margin.bottom,D=i.width+l+this.legend.margin.left+this.legend.margin.right;t==="Bottom"?(i.x=this.alignLegend(i.x,n.width,i.width,e),i.y=r.y+(r.height-L)+l+this.legend.margin.top,i.y+=h&&!c.opposedPosition&&!u&&!p&&!f?c.majorTickLines.height+C+this.legend.border.width+l*2:f&&c.categoryField!==""?s.height+l*2:0,Dn(r,new Mn(0,0,0,L))):t==="Top"?(i.x=this.alignLegend(i.x,n.width,i.width,e),i.y=r.y+l+this.legend.margin.top,i.y-=h&&c.opposedPosition&&!u&&!p&&!f?c.majorTickLines.height+this.chart.margin.top:0,L-=h?-l*2:0,Dn(r,new Mn(0,0,L,0))):t==="Right"?(i.x=r.x+(r.width-i.width)-this.legend.margin.right,i.y=r.y+this.alignLegend(0,n.height-(r.y+C),i.height,e),D+=h&&c.opposedPosition&&!u&&!p&&f?this.chart.margin.left+this.chart.margin.right+c.majorTickLines.height:0,Dn(r,new Mn(0,D,0,0))):t==="Left"?(i.x=i.x+this.legend.margin.left,i.y=r.y+this.alignLegend(0,n.height-(r.y+C),i.height,e),D+=h&&!c.opposedPosition&&!u&&!p&&f?i.x-this.chart.margin.left+l+c.majorTickLines.height:c.orientation!=="Vertical"&&c.categoryField!==""?g:0,Dn(r,new Mn(D,0,0,0))):(i.x=this.legend.location.x,i.y=this.legend.location.y,Dn(r,new Mn(0,0,0,0)))},o.prototype.alignLegend=function(t,e,i,r){switch(r){case"Far":t=e-i-t;break;case"Center":t=(e-i)/2;break}return t},o.prototype.renderLegend=function(t,e,i,r){var n=0,s=0,l=new ft(0,0,0,0),h=new ft(0,0,0,0),c=this.findFirstLegendPosition(this.legendCollections),u=e.padding,p=e.enablePages,f=e.titlePosition,g=this.isPaging&&!e.enablePages&&this.isVertical?this.pageButtonSize:0,C=t.renderer.createGroup({id:this.legendID+"_g"}),L=this.createLegendElements(t,i,C,e,this.legendID,r);this.legendRegions=[],this.chartRowCount=1;var D=0;if(n=this.isTitle&&(this.isTop||this.isVertical)?this.legendTitleSize.height:0,this.isChartControl||this.isAccChartControl&&!this.isVertical){for(var R=1,B=this.rowHeights[0]+u,H=1;H<this.rowHeights.length;H++)B+this.rowHeights[H]+u>this.legendBounds.height-this.pageButtonSize-this.maxItemHeight/2&&(this.pageHeights[R-1]=B+n,R++,B=0),B+=this.rowHeights[H]+u;this.pageHeights[R-1]=B+n,this.totalPages=R}for(var H=0;H<this.legendCollections.length;H++)if(this.legendCollections[H].text!==""){D=Math.max(this.legendCollections[H].textSize.height,D);break}else continue;if(!this.isChartControl&&!this.isAccChartControl&&(this.maxItemHeight=Math.max(D,e.shapeHeight)),!p&&this.isPaging&&!this.isVertical?(s=this.isTitle&&f==="Left"?this.legendTitleSize.width:0,s+=this.pageButtonSize+2*this.fivePixel):this.isTitle&&!this.isPaging&&!this.isVertical&&(s=f===(this.isRtlEnable?"Right":"Left")?this.fivePixel+this.legendTitleSize.width:0),t.legendSettings.mode==="Gradient"&&this.legendCollections.length>1)this.getLinearLegend(i,t,e,L),this.totalPages=1;else if(c!==this.legendCollections.length){var j=void 0,W=0,ne=this.legendCollections[c],ie=this.isBulletChartControl?0:s+u+e.shapeWidth/2+e.containerPadding.left,me=this.isBulletChartControl?i.x+s+u+e.shapeWidth/2:this.isRtlEnable?i.x+(this.chart.getModuleName()==="accumulationchart"&&this.isVertical?this.maxWidth:i.width)-ie:i.x+ie,ve=new Rt(me,this.isBulletChartControl?i.y+n+g+u+this.maxItemHeight/2:i.y+n+g+u+this.maxItemHeight/2+e.containerPadding.top),Ee=t.isRtlEnabled||t.enableRtl?"end":"start",le=new fr("",ve.x,ve.y,Ee),de=e.shapePadding+u+e.shapeWidth;this.totalPages=this.totalPages=this.isAccChartControl||this.isChartControl||this.isBulletChartControl||this.isStockChartControl?this.totalPages:0,this.pageXCollections=[],this.legendCollections[c].location=ve;var fe=void 0;if(!e.enablePages&&this.isPaging){var Le=ve.x-this.fivePixel,ke=ve.y-this.fivePixel,Me=this.isTitle&&!this.isVertical&&f==="Left"?this.legendTitleSize.width+this.fivePixel:0,De=this.isVertical?this.pageButtonSize+Math.abs(ke-i.y):0,Fe=this.isTitle&&!this.isVertical&&f==="Right"?this.legendTitleSize.width+this.fivePixel:0;Fe+=this.isVertical?0:this.fivePixel+this.pageButtonSize+this.fivePixel,l=new ft(Le,ke,i.width-Fe-Me,i.height-De),h=l}else h=i;for(var Pe=0,Ye=this.legendCollections;Pe<Ye.length;Pe++){var Ze=Ye[Pe];fe=this.isReverse?this.legendCollections.length-1-W:W,this.chart.getModuleName()==="accumulationchart"&&(Ze.fill=(this.chart||this.chart||this.chart).visibleSeries[0].points[Ze.pointIndex].color),this.chart.getModuleName()==="stockChart"&&(Ze.type=this.chart.visibleSeries[W].type),this.accessbilityText=this.isBulletChartControl?"Legend of bullet chart"+Ze.text:"Click to show or hide the "+Ze.text+" series",Ze.render&&Ze.text!==""&&(j=t.renderer.createGroup({id:this.legendID+this.generateId(Ze,"_g_",fe)}),j&&(j.setAttribute("tabindex",e.tabIndex.toString()),j.setAttribute("aria-label",e.description||this.accessbilityText)),this.library.getRenderPoint(Ze,ve,de,ne,h,W,c),this.renderSymbol(Ze,j,fe),this.renderText(t,Ze,j,le,W,fe),j&&(j.style.cssText="outline: none; cursor: "+(!e.toggleVisibility&&(t.selectionMode==="None"||t.highlightMode==="None"||t.selectionMode==="None")||this.isBulletChartControl?"auto":"pointer")),L&&L.appendChild(j),ne=Ze),W++}this.isPaging?this.renderPagingElements(t,i,le,C):this.totalPages=1}Nt(t.enableCanvas,t.svgObject,C,r)},o.prototype.getLinearLegend=function(t,e,i,r){var n="http://www.w3.org/2000/svg",s=this.legendCollections[0],l=this.legendCollections[1],h=this.chart.renderer.createDefs(),c=0,u=document.createElementNS(n,"linearGradient"),p=1,f=[],g=[];i.title&&(this.isVertical?(t.y+=this.legendTitleSize.height,t.height-=this.legendTitleSize.height):i.titlePosition==="Left"?(t.x+=this.legendTitleSize.width,t.width-=this.legendTitleSize.width):i.titlePosition==="Right"?t.width-=this.legendTitleSize.width:i.titlePosition==="Top"&&(t.y+=this.legendTitleSize.height,t.height-=this.legendTitleSize.height));for(var C=0,L=this.chart.rangeColorSettings;C<L.length;C++){var D=L[C];if(g.indexOf(D.start)<0&&g.push(D.start),D.colors.length>2){var R=D.end-D.start,B=D.colors.length-1;if(R>0){R=R/B;for(var H=1;H<B;H++){var j=D.start+R*H;g.push(j)}}else for(var H=1;H<B;H++)g.push(D.start)}g.indexOf(D.end)<0&&g.push(D.end);for(var W=0,ne=D.colors;W<ne.length;W++){var ie=ne[W];f.indexOf(ie)<0&&f.push(ie)}D.colors.length>0&&D.colors.length<2&&f.push(D.colors[0])}var me=this.isRtlEnable&&!this.isVertical?"100%":"0%",ve=this.isVertical||this.isRtlEnable?"0%":"100%",Ee=this.isVertical?"100%":"0%";u.setAttribute("id",this.generateId(s,"linearGradient",c)),u.setAttribute("x1",me),u.setAttribute("y1","0%"),u.setAttribute("x2",ve),u.setAttribute("y2",Ee);for(var le=g[g.length-1]-g[0],de=0;de<f.length;de++){var fe=g[de]-g[0];fe=fe/le;var Le=document.createElementNS(n,"stop");Le.setAttribute("offset",fe.toString()),Le.setAttribute("stop-color",f[de]),Le.setAttribute("stop-opacity",p.toString()),u.appendChild(Le)}var ke=s.text.toString(),Me=l.text.toString(),De=Pt(ke,i.textStyle),Fe=Pt(Me,i.textStyle),Pe=De.width>Fe.width?De.width:Fe.width,Ye=De.height>Fe.height?De.height:Fe.height,Ze=2*Pe+4*i.padding,nt=t.width,it=t.height,et=t.x+Pe+2*i.padding,at=t.y+i.padding,Ge,gt,ge,xe;if(this.isVertical){if(Ze=2*Ye+4*i.padding,nt=t.width-2*i.padding,it=t.height-Ze,et=t.x+i.padding,at=t.y+Ye+2*i.padding,Ge=t.y+i.padding+Ye,gt=at+it+Ye,ge=t.x+t.width*.5-Pe*.5,xe=ge,nt>30){var je=nt-30;nt=30,et=et+je/2}}else if(nt=t.width-Ze,it=t.height-2*i.padding,ge=t.x+(this.isRtlEnable?nt+3*i.padding+Pe:i.padding+(Pe-De.width)),xe=t.x+(this.isRtlEnable?i.padding+(Pe-Fe.width):nt+3*i.padding+Pe),Ge=t.y+t.height*.5+Ye*.25,gt=Ge,it>30){var Je=it-30;it=30,at=at+Je/2}var lt=e.enableRtl?"end":"",Qe=new fr("",ge,Ge,lt,ke),Bt="#D3D3D3";Qe.id=this.legendID+this.generateId(s,"_text_",1);var pi=s.visible?i.textStyle.color||e.themeStyle.legendLabel:Bt,si=this.isStockChartControl?!1:this.chart.enableCanvas;mr(e.renderer,Qe,i.textStyle,pi,r,!1,!1,!1,!1,null,this.currentPageNumber&&si?new ft(0,-this.translatePage(si,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null),Qe=new fr("",xe,gt,lt,Me),Qe.id=this.legendID+this.generateId(s,"_text_",2),mr(e.renderer,Qe,i.textStyle,pi,r,!1,!1,!1,!1,null,this.currentPageNumber&&si?new ft(0,-this.translatePage(si,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);var Gt=e.renderer.drawRectangle({width:nt,height:it,x:et,y:at,fill:"url(#"+this.generateId(s,"linearGradient",c)+")"});h.appendChild(u),r.appendChild(h),r.appendChild(Gt)},o.prototype.findFirstLegendPosition=function(t){for(var e=0,i=0,r=t;i<r.length;i++){var n=r[i];if(n.render&&n.text!=="")break;e++}return e},o.prototype.calculateLegendTitle=function(t,e){if(t.title){this.isTop=t.titlePosition==="Top";var i=t.titleStyle.textOverflow==="Trim"?2*t.padding:0;this.isTop||this.isVertical?this.legendTitleCollections=io(t.title,t.titleStyle,e.width-i):this.legendTitleCollections[0]=Rn(t.maximumTitleWidth,t.title,t.titleStyle);var r=this.isTop?t.title:this.legendTitleCollections[0];this.legendTitleSize=Pt(r,t.titleStyle),this.legendTitleSize.height*=this.legendTitleCollections.length}else this.legendTitleSize=new ni(0,0)},o.prototype.renderLegendTitle=function(t,e,i,r){var n=e.padding,s=e.titleStyle.textAlignment;this.isTop=e.titlePosition==="Top";var l=bl(e.titleStyle.textAlignment,t.enableRtl),h=gl(i,e.titleStyle);l=this.isTop||this.isVertical?l:t.enableRtl?"end":"",h=s==="Near"?h+n:s==="Far"?h-n:h,h=this.isTop||this.isVertical?h:i.x+(e.titlePosition==="Left"?5:i.width-this.legendTitleSize.width-5);var c=i.height/2+this.legendTitleSize.height/4,u=i.y+(!this.isTop&&!this.isVertical?c:this.legendTitleSize.height/this.legendTitleCollections.length),p=new fr(this.legendID+"_title",h,u,l,this.legendTitleCollections);mr(t.renderer,p,e.titleStyle,e.titleStyle.color,r)},o.prototype.createLegendElements=function(t,e,i,r,n,s){var l=r.padding,h=new Sn(n+"_element",r.background,r.border,r.opacity,e),c=t.renderer.createGroup({id:n+"_collections"}),u=this.isStockChartControl?!1:t.enableCanvas,p=t.renderer.createClipPath({id:n+"_clipPath"});return h.width=this.isRtlEnable&&this.chart.getModuleName()==="accumulationchart"&&this.isVertical?this.maxWidth:e.width,i?i.appendChild(t.renderer.drawRectangle(h)):t.renderer.drawRectangle(h),r.title&&this.renderLegendTitle(t,r,e,i),u||i.appendChild(c),this.legendTranslateGroup=t.renderer.createGroup({id:n+"_translate_g"}),u||c.appendChild(this.legendTranslateGroup),h.y+=l+(this.isTop?this.legendTitleSize.height:0),h.id+="_clipPath_rect",h.width=!this.isChartControl&&t.getModuleName()!=="bulletChart"&&!this.isStockChartControl&&this.isVertical?this.maxWidth-l+r.containerPadding.left+r.containerPadding.right:e.width,u?this.pagingClipRect=h:(this.clipRect=t.renderer.drawRectangle(h),p.appendChild(this.clipRect)),Nt(u,t.svgObject,p,s),u||(c.style.cssText="clip-path:url(#"+p.id+")"),this.legendTranslateGroup},o.prototype.renderSymbol=function(t,e,i){var r=this.isBulletChartControl?this.chart:null,n=t.visible?t.fill:"#D3D3D3",s=(this.chart.getModuleName()==="chart"||this.chart.getModuleName()==="stockChart")&&t.shape==="SeriesType"&&t.type.toLowerCase().indexOf("line")>-1&&t.type.toLowerCase().indexOf("area")===-1,l=(this.chart.getModuleName()==="chart"||this.chart.getModuleName()==="stockChart")&&(t.type==="Scatter"||t.type==="Bubble"),h=this.isStockChartControl?!1:this.chart.enableCanvas,c,u=t.shape==="SeriesType"?t.type:t.shape,p=s?this.legend.mode==="Series"?this.chart.visibleSeries[i].width:this.chart.visibleSeries[0].width:this.isBulletChartControl&&t.shape==="Multiply"?4:1,f;if(u=u==="Scatter"?t.markerShape:u,l&&i<this.chart.visibleSeries.length){var g=this.chart.visibleSeries[i].border;c=g.color?g.color:n,p=g.width?g.width:1}var C=new er(this.legendID+this.generateId(t,"_shape_",i),n,p,l?c:n,1,"",""),L=Pt(t.text,this.legend.textStyle),D=this.legend.isInversed&&!this.isRtlEnable?t.location.x+L.width+this.legend.shapePadding:t.location.x,R=t.location.y;h?(f=-this.translatePage(h,null,this.currentPageNumber-1,this.currentPageNumber),qr({x:D,y:R},u,new ni(this.legend.shapeWidth,this.legend.shapeHeight),"",C,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new ft(0,f,0,0):null,this.isBulletChartControl,r),this.legendRegions.push({rect:new ft(t.location.x,t.location.y,this.legend.shapeWidth,this.legend.shapeHeight+f),index:i})):e.appendChild(qr({x:D,y:R},u,new ni(this.legend.shapeWidth,this.legend.shapeHeight),t.url,C,this.accessbilityText,this.chart.renderer,null,this.isBulletChartControl,r)),(u==="Line"&&t.markerVisibility&&t.markerShape!=="Image"||t.type==="Doughnut"&&u==="Doughnut")&&(C.id=this.legendID+this.generateId(t,"_shape_marker_",i),u=t.type==="Doughnut"?"Circle":t.markerShape,C.fill=t.type==="Doughnut"?"#FFFFFF":C.fill,h?qr({x:D,y:R},u,new ni(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",C,this.accessbilityText,this.chart.renderer,this.currentPageNumber?new ft(0,-this.translatePage(h,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null,this.isBulletChartControl,r):e.appendChild(qr({x:D,y:R},u,new ni(this.legend.shapeWidth/2,this.legend.shapeHeight/2),"",C,this.accessbilityText,null,null,this.isBulletChartControl,r)))},o.prototype.renderText=function(t,e,i,r,n,s){var l=t.legendSettings,h="#D3D3D3",c=e.visible?l.textStyle.color||t.themeStyle.legendLabel:h,u=this.isStockChartControl?!1:this.chart.enableCanvas;r.id=this.legendID+this.generateId(e,"_text_",s),r.text=e.textCollection.length>0?e.textCollection:e.text,l.isInversed&&!this.isRtlEnable?r.x=e.location.x-l.shapeWidth/2:this.isRtlEnable?r.x=e.location.x-(Pt(e.text,l.textStyle).width+l.shapeWidth/2+l.shapePadding):r.x=e.location.x+l.shapeWidth/2+l.shapePadding,r.y=e.location.y+this.maxItemHeight/4;var p=mr(t.renderer,r,l.textStyle,c,i,!1,!1,!1,!1,null,this.currentPageNumber&&u?new ft(0,-this.translatePage(u,null,this.currentPageNumber-1,this.currentPageNumber),0,0):null);if(p&&p.setAttribute("aria-label",l.description||this.accessbilityText),u){var f=Pt(e.text,l.textStyle);this.legendRegions[n].rect.y=r.y<this.legendRegions[n].rect.y?r.y:this.legendRegions[n].rect.y,this.legendRegions[n].rect.width+=f.width,this.legendRegions[n].rect.height=f.height,this.legendRegions[n].rect.y-=f.height*.5,this.legendRegions[n].rect.x-=this.isRtlEnable?this.legendRegions[n].rect.width:0}},o.prototype.renderPagingElements=function(t,e,i,r){var n=t.renderer.createGroup({id:this.legendID+"_navigation"}),s=this.isStockChartControl?!1:t.enableCanvas,l=this.isBulletChartControl?0:this.legendTitleSize.height,h=this.chart.theme.indexOf("Dark")>-1?"#FFFFFF":"#545454",c=t.legendSettings,u=8,p=this.legendID+(this.isRtlEnable?"_pagedown":"_pageup"),f=this.legendID+(this.isRtlEnable?"_pageup":"_pagedown"),g=new er(p,"transparent",5,h,1,"",""),C=this.pageButtonSize,L=!c.enablePages&&this.isPaging&&!this.isVertical&&!this.isBulletChartControl?1:this.rowCount-1,D=this.isTitle&&c.titlePosition==="Left"?this.legendTitleSize.width:0;this.pagingRegions=[],this.backwardArrowOpacity=this.currentPage!==1?1:0,this.forwardArrowOpacity=this.currentPage===this.totalPages?0:1,s||r.appendChild(n),!this.isChartControl&&!this.isAccChartControl&&(this.isBulletChartControl||this.isStockChartControl||!this.isVertical?this.totalPages=Math.ceil(this.totalPages/Math.max(1,this.rowCount-1)):this.totalPages=Math.ceil(this.totalPages/this.maxColumns)),n&&(n.style.cursor="pointer"),(this.isChartControl||this.isAccChartControl)&&!(!c.enablePages&&this.isPaging)?this.clipPathHeight=this.pageHeights[0]:this.clipPathHeight=L*(this.maxItemHeight+c.padding),s?(this.pagingClipRect.height=this.legendBounds.height-this.clipPathHeight-(this.pagingClipRect.y-this.legendBounds.y)-c.border.width,this.pagingClipRect.y=this.pagingClipRect.y+this.clipPathHeight,this.pagingClipRect.x+=c.border.width,this.pagingClipRect.width-=c.border.width+c.border.width/2,this.chart.renderer.clearRect(new ft(this.pagingClipRect.x,this.pagingClipRect.y,this.pagingClipRect.width,this.pagingClipRect.height))):this.clipRect.setAttribute("height",this.clipPathHeight.toString());var R,B=e.x+C/2,H=e.y+this.clipPathHeight+(l+e.height-this.clipPathHeight)/2;this.isPaging&&!c.enablePages&&!this.isVertical&&!this.isBulletChartControl&&(B=e.x+this.fivePixel+this.pageButtonSize+D,H=c.title&&this.isTop?e.y+u+l+C/1+.5:e.y+u+C+.5);var j=Pt(this.totalPages+"/"+this.totalPages,c.textStyle),W=this.isRtlEnable?c.border.width+C/2:e.width-(2*(C+u)+u+j.width);s?qr({x:B,y:H},"LeftArrow",new ni(C,C),"",g,"LeftArrow",this.chart.renderer,new ft(W,0,0,0)):this.isVertical&&!c.enablePages&&!this.isBulletChartControl?(B=e.x+e.width/2,H=e.y+C/2+u+l,g.opacity=this.backwardArrowOpacity,n.appendChild(qr({x:B,y:H},"UpArrow",new ni(C,C),"",g,"UpArrow"))):(g.opacity=this.isBulletChartControl?g.opacity:c.enablePages?1:this.isRtlEnable?this.forwardArrowOpacity:this.backwardArrowOpacity,n.appendChild(qr({x:B,y:H},"LeftArrow",new ni(C,C),"",g,"LeftArrow"))),this.pagingRegions.push(new ft(this.isRtlEnable?B:B+e.width-(2*(C+u)+u+j.width)-C*.5,H-C*.5,C,C)),i.x=B+C/2+u,i.y=H+j.height/4,i.id=this.legendID+"_pagenumber",i.text=this.isRtlEnable?this.totalPages+"/1":"1/"+this.totalPages;var ne=this.chart.theme.indexOf("Dark")>-1?"#FFFFFF":c.textStyle.color;s&&this.totalNoOfPages&&(i.text=this.isRtlEnable?this.totalNoOfPages+"/"+this.currentPageNumber:this.currentPageNumber+"/"+this.totalNoOfPages),(c.enablePages||this.isBulletChartControl)&&(R=mr(t.renderer,i,c.textStyle,ne,n,!1,!1,!1,!1,null,new ft(W,0,0,0))),B=i.x+u+C/2+j.width,this.isPaging&&!c.enablePages&&!this.isVertical&&(B=e.x+e.width-this.fivePixel-this.pageButtonSize-(c.title&&c.titlePosition==="Right"?this.legendTitleSize.width+this.fivePixel:0)),g.id=f,g.opacity=c.enablePages?1:this.isRtlEnable?this.backwardArrowOpacity:this.forwardArrowOpacity,s?qr({x:B,y:H},"RightArrow",new ni(C,C),"",g,"RightArrow",this.chart.renderer,new ft(W,0,0,0)):this.isVertical&&!c.enablePages&&!this.isBulletChartControl?(B=e.x+e.width/2,H=e.y+e.height-C/2-u,n.appendChild(qr({x:B,y:H},"DownArrow",new ni(C,C),"",g,"DownArrow"))):n.appendChild(qr({x:B,y:H},"RightArrow",new ni(C,C),"",g,"RightArrow")),this.pagingRegions.push(new ft(this.isRtlEnable?B:B+(e.width-(2*(C+u)+u+j.width)-C*.5),H-C*.5,C,C)),!s&&(c.enablePages||this.isBulletChartControl)?n.setAttribute("transform","translate("+W+", "+0+")"):(this.currentPageNumber===1&&this.calTotalPage&&(c.enablePages||this.isBulletChartControl)&&(this.totalNoOfPages=this.totalPages,this.calTotalPage=!1),!c.enablePages&&!this.isBulletChartControl&&this.translatePage(s,null,this.currentPage-1,this.currentPage,c)),(c.enablePages||this.isBulletChartControl)&&this.translatePage(s,R,this.currentPage-1,this.currentPage,c)},o.prototype.getPageHeight=function(t,e){for(var i=0,r=0;r<e;r++)i+=t[r];return i},o.prototype.translatePage=function(t,e,i,r,n){var s=this.isChartControl||this.isAccChartControl?i?this.getPageHeight(this.pageHeights,i):0:this.clipPathHeight*i;!t&&(this.isChartControl||this.isAccChartControl)&&this.clipRect.setAttribute("height",this.pageHeights[i].toString());var l="translate(0,-"+s+")";if(!this.isChartControl&&!this.isBulletChartControl&&!this.isStockChartControl&&this.isVertical){var h=this.pageXCollections[i*this.maxColumns];s=this.isRtlEnable?this.legendBounds.x+this.maxWidth-h:h-this.legendBounds.x,s=s<0?0:s,l=(this.isRtlEnable?"translate(":"translate(-")+s+",0)"}return this.chart.enableCanvas||this.legendTranslateGroup.setAttribute("transform",l),!this.chart.enableCanvas&&(n.enablePages||this.isBulletChartControl)&&(e.textContent=this.isRtlEnable?this.totalPages+"/"+r:r+"/"+this.totalPages),this.currentPage=r,s},o.prototype.changePage=function(t,e){var i=this.chart.legendSettings,r=document.getElementById(this.legendID+"_pageup"),n=document.getElementById(this.legendID+"_pagedown"),s=this.isStockChartControl?!1:this.chart.enableCanvas,l=i.enablePages||this.isBulletChartControl?document.getElementById(this.legendID+"_pagenumber"):null,h=i.enablePages||this.isBulletChartControl?parseInt(l.textContent.split("/")[this.isRtlEnable?1:0],10):this.currentPage;e&&h>1?this.translatePage(s,l,h-2,h-1,i):!e&&h<this.totalPages&&this.translatePage(s,l,h,h+1,i),this.isPaging&&!i.enablePages&&!this.isBulletChartControl&&(this.currentPage===this.totalPages?this.hideArrow(n):this.showArrow(n),this.currentPage===1?this.hideArrow(r):this.showArrow(r))},o.prototype.hideArrow=function(t){t.setAttribute("opacity","0")},o.prototype.showArrow=function(t){t.setAttribute("opacity","1")},o.prototype.generateId=function(t,e,i){return this.isChartControl||this.isStockChartControl?e+i:e+t.pointIndex},o.prototype.move=function(t){var e=this,i=this.chart.mouseX,r=this.chart.mouseY;if(t.target.textContent.indexOf("...")>-1){var n=t.target.id.split(this.legendID+"_text_");if(n.length===2){var s=parseInt(n[1],10),l=this.chart.element;if(!isNaN(s))if(this.chart.isTouch&&ui(this.chart.element.id+"_EJ2_Legend_Tooltip"),this.isChartControl){var h=this.chart.legendSettings.mode=="Point"?this.chart.visibleSeries[0].points[s].x.toString():this.chart.series[s].name;to(h,i,r,l.offsetWidth,l.id+"_EJ2_Legend_Tooltip",xt(this.chart.element.id+"_Secondary_Element"))}else to(this.chart.visibleSeries[0].points[s].x.toString(),i+10,r+10,l.offsetWidth,l.id+"_EJ2_Legend_Tooltip",xt(this.chart.element.id+"_Secondary_Element"))}}else ui(this.chart.element.id+"_EJ2_Legend_Tooltip");this.chart.isTouch&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout(function(){ui(e.chart.element.id+"_EJ2_Legend_Tooltip")},1e3))},o}(),ro=function(){function o(t,e,i,r,n,s,l,h,c,u){this.location={x:0,y:0},this.textCollection=[],this.text=t,this.fill=e,this.shape=i,this.url=s,this.visible=r,this.type=n,this.markerVisibility=h,this.markerShape=l,this.pointIndex=c,this.seriesIndex=u}return o}(),Wx=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Xi=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},n0=function(o){Wx(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.clipRect=new ft(0,0,0,0),e}return t.prototype.setDataSource=function(e,i){e&&(this.xData=e.xData,this.yData=e.yData,this.points=e.points);var r=On(this.type);i[r+"IndicatorModule"].initDataSource(this,i),i.visibleSeriesCount+=this.targetSeries.length},Xi([(0,a.Z9)("Sma")],t.prototype,"type",void 0),Xi([(0,a.Z9)(14)],t.prototype,"period",void 0),Xi([(0,a.Z9)(14)],t.prototype,"kPeriod",void 0),Xi([(0,a.Z9)(3)],t.prototype,"dPeriod",void 0),Xi([(0,a.Z9)(80)],t.prototype,"overBought",void 0),Xi([(0,a.Z9)(20)],t.prototype,"overSold",void 0),Xi([(0,a.Z9)(2)],t.prototype,"standardDeviation",void 0),Xi([(0,a.Z9)("Close")],t.prototype,"field",void 0),Xi([(0,a.Z9)(12)],t.prototype,"slowPeriod",void 0),Xi([(0,a.Z9)(26)],t.prototype,"fastPeriod",void 0),Xi([(0,a.Z9)(!0)],t.prototype,"showZones",void 0),Xi([(0,a.Zz)({color:"#ff9933",width:2},Ja)],t.prototype,"macdLine",void 0),Xi([(0,a.Z9)("Both")],t.prototype,"macdType",void 0),Xi([(0,a.Z9)("#2ecd71")],t.prototype,"macdPositiveColor",void 0),Xi([(0,a.Z9)("#e74c3d")],t.prototype,"macdNegativeColor",void 0),Xi([(0,a.Z9)("rgba(211,211,211,0.25)")],t.prototype,"bandColor",void 0),Xi([(0,a.Zz)({color:"#ffb735",width:1},Ja)],t.prototype,"upperLine",void 0),Xi([(0,a.Zz)({color:"#f2ec2f",width:1},Ja)],t.prototype,"lowerLine",void 0),Xi([(0,a.Zz)({color:"#f2ec2f",width:1},Ja)],t.prototype,"periodLine",void 0),Xi([(0,a.Z9)("")],t.prototype,"seriesName",void 0),t}(Jg),fa;(function(o){o[o.Portrait=0]="Portrait",o[o.Landscape=1]="Landscape"})(fa||(fa={}));var Pd;(function(o){o[o.RotateAngle0=0]="RotateAngle0",o[o.RotateAngle90=1]="RotateAngle90",o[o.RotateAngle180=2]="RotateAngle180",o[o.RotateAngle270=3]="RotateAngle270"})(Pd||(Pd={}));var s0;(function(o){o[o.None=0]="None",o[o.Numeric=1]="Numeric",o[o.LowerLatin=2]="LowerLatin",o[o.LowerRoman=3]="LowerRoman",o[o.UpperLatin=4]="UpperLatin",o[o.UpperRoman=5]="UpperRoman"})(s0||(s0={}));var _i;(function(o){o[o.None=0]="None",o[o.Bottom=1]="Bottom",o[o.Top=2]="Top",o[o.Left=3]="Left",o[o.Right=4]="Right",o[o.Fill=5]="Fill"})(_i||(_i={}));var Zt;(function(o){o[o.None=0]="None",o[o.TopLeft=1]="TopLeft",o[o.TopCenter=2]="TopCenter",o[o.TopRight=3]="TopRight",o[o.MiddleLeft=4]="MiddleLeft",o[o.MiddleCenter=5]="MiddleCenter",o[o.MiddleRight=6]="MiddleRight",o[o.BottomLeft=7]="BottomLeft",o[o.BottomCenter=8]="BottomCenter",o[o.BottomRight=9]="BottomRight"})(Zt||(Zt={}));var ti;(function(o){o[o.None=0]="None",o[o.Top=1]="Top",o[o.Bottom=2]="Bottom",o[o.Left=3]="Left",o[o.Right=4]="Right"})(ti||(ti={}));var Ux=function(){function o(t){this.streamWriter=t}return Object.defineProperty(o.prototype,"document",{get:function(){return this.pdfDocument},set:function(t){this.pdfDocument=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"position",{get:function(){return this.streamWriter.buffer.size},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"length",{get:function(){return this.streamWriter.buffer.size},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"stream",{get:function(){var t=this.streamWriter;return t},enumerable:!0,configurable:!0}),o.prototype.write=function(t){var e=[],i=t;this.streamWriter.write(i)},o}();function qx(o){return Object.prototype.toString.call(o)==="[object String]"?"$s"+o:"$o"+o.toString()}var Ii=function(){function o(t){this.table={},this.nElements=0,this.toStr=t||qx}return o.prototype.getValue=function(t){var e=this.table["$"+this.toStr(t)];if(typeof e!="undefined")return e.value},o.prototype.setValue=function(t,e){var i,r="$"+this.toStr(t),n=this.table[r];return this.nElements++,i=void 0,this.table[r]={key:t,value:e},i},o.prototype.remove=function(t){var e="$"+this.toStr(t),i=this.table[e];return delete this.table[e],this.nElements--,i.value},o.prototype.keys=function(){for(var t=[],e=Object.keys(this.table),i=0;i<e.length;i++){var r=this.table[e[i]];t.push(r.key)}return t},o.prototype.values=function(){for(var t=[],e=Object.keys(this.table),i=0;i<e.length;i++){var r=this.table[e[i]];t.push(r.value)}return t},o.prototype.containsKey=function(t){var e=!0;return typeof this.getValue(t)=="undefined"?e=!0:e=!1,!e},o.prototype.clear=function(){this.table={},this.nElements=0},o.prototype.size=function(){return this.nElements},o}(),Cl;(function(o){o[o.None=0]="None",o[o.Registered=1]="Registered"})(Cl||(Cl={}));var Zx=function(){function o(){this.objectCollections=[],this.mainObjectCollection=new Ii,this.primitiveObjectCollection=new Ii}return Object.defineProperty(o.prototype,"count",{get:function(){return this.objectCollections.length},enumerable:!0,configurable:!0}),o.prototype.items=function(t){return this.objectCollections[t]},Object.defineProperty(o.prototype,"outIsNew",{get:function(){return this.isNew},enumerable:!0,configurable:!0}),o.prototype.add=function(t){var e=new Yx(t);this.objectCollections.push(e),this.primitiveObjectCollection.containsKey(t)||this.primitiveObjectCollection.setValue(t,this.objectCollections.length-1),t.position=this.index=this.objectCollections.length-1,t.status=Cl.Registered},o.prototype.lookFor=function(t){var e=-1;if(t.position!==-1)return t.position;if(this.primitiveObjectCollection.containsKey(t)&&this.count===this.primitiveObjectCollection.size())e=this.primitiveObjectCollection.getValue(t);else for(var i=this.count-1;i>=0;i--){var r=this.objectCollections[i];if(r.object===t){e=i;break}}return e},o.prototype.getReference=function(t,e){this.index=this.lookFor(t);var i;this.isNew=!1;var r=this.objectCollections[this.index];i=r.reference;var n={reference:i,wasNew:e};return n},o.prototype.trySetReference=function(t,e,i){var r=!0;i=!0,this.index=this.lookFor(t);var n=this.objectCollections[this.index];return n.setReference(e),r},o.prototype.destroy=function(){for(var t=0,e=this.objectCollections;t<e.length;t++){var i=e[t];i!==void 0&&(i.pdfObject.position=-1,i.pdfObject.isSaving=void 0,i.pdfObject.objectCollectionIndex=void 0,i.pdfObject.position=void 0)}this.objectCollections=[],this.mainObjectCollection=new Ii,this.primitiveObjectCollection=new Ii},o}(),Yx=function(){function o(t,e){this.pdfObject=t,this.pdfReference=e}return Object.defineProperty(o.prototype,"object",{get:function(){return this.pdfObject},set:function(t){this.pdfObject=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"reference",{get:function(){return this.pdfReference},enumerable:!0,configurable:!0}),o.prototype.setReference=function(t){this.pdfReference=t},o}(),Sl=function(){function o(t){this.emitBOM=!0,this.encodingType="Ansi",this.initBOM(t)}return Object.defineProperty(o.prototype,"includeBom",{get:function(){return this.emitBOM},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"type",{get:function(){return this.encodingType},set:function(t){this.encodingType=t},enumerable:!0,configurable:!0}),o.prototype.initBOM=function(t){t==null?this.emitBOM=!0:this.emitBOM=t},o.prototype.getByteCount=function(t){var e=0;if(rs(t,"string"),t===""){var i=this.utf8Len(t.charCodeAt(0));return i}return(this.type===null||this.type===void 0)&&(this.type="Ansi"),this.getByteCountInternal(t,0,t.length)},o.prototype.utf8Len=function(t){var e=t<=127?1:t<=2047?2:t<=65535?3:t<=2097151?4:0;return e},o.prototype.isHighSurrogate=function(t){return t>=55296&&t<=56319},o.prototype.toCodepoint=function(t,e){t=(1023&t)<<10;var i=t|1023&e;return i+65536},o.prototype.getByteCountInternal=function(t,e,i){var r=0;if(this.encodingType==="Utf8"||this.encodingType==="Unicode"){for(var n=this.encodingType==="Utf8",s=0;s<i;s++){var l=t.charCodeAt(n?e:e++);if(this.isHighSurrogate(l))if(n){var h=l,c=t.charCodeAt(++e);r+=this.utf8Len(this.toCodepoint(h,c))}else r+=4,++s;else n?r+=this.utf8Len(l):r+=2;n&&e++}return r}else return r=i,r},o.prototype.getBytes=function(t,e,i){if(rs(t,"string"),rs(e,"charIndex"),rs(i,"charCount"),e<0||i<0)throw new RangeError("Argument Out Of Range Exception: charIndex or charCount is less than zero");if(t.length-e<i)throw new RangeError("Argument Out Of Range Exception: charIndex and charCount do not denote a valid range in string");var r;if(t==="")return r=new ArrayBuffer(0),r;(this.type===null||this.type===void 0)&&(this.type="Ansi");var n=this.getByteCountInternal(t,e,i);switch(this.type){case"Utf8":return r=this.getBytesOfUtf8Encoding(n,t,e,i),r;case"Unicode":return r=this.getBytesOfUnicodeEncoding(n,t,e,i),r;default:return r=this.getBytesOfAnsiEncoding(n,t,e,i),r}},o.prototype.getString=function(t,e,i){if(rs(t,"bytes"),rs(e,"index"),rs(i,"count"),e<0||i<0)throw new RangeError("Argument Out Of Range Exception: index or count is less than zero");if(t.byteLength-e<i)throw new RangeError("Argument Out Of Range Exception: index and count do not denote a valid range in bytes");if(t.byteLength===0||i===0)return"";(this.type===null||this.type===void 0)&&(this.type="Ansi");var r="",n=new Uint8Array(t);switch(this.type){case"Utf8":var s=this.getStringOfUtf8Encoding(n,e,i);return s;case"Unicode":var l=new Uint16Array(t);return r=this.getStringofUnicodeEncoding(l,e,i),r;default:for(var h=e,c=0;c<i;c++){var u=n[h];r+=String.fromCharCode(u),h++}return r}},o.prototype.getBytesOfAnsiEncoding=function(t,e,i,r){for(var n=new ArrayBuffer(t),s=new Uint8Array(n),l=0,h=0;h<r;h++){var c=e.charCodeAt(i++);c<2048?s[l]=c:s[l]=63,l++}return n},o.prototype.getBytesOfUtf8Encoding=function(t,e,i,r){for(var n=new ArrayBuffer(t),s=new Uint8Array(n),l=i,h=0,c=0;c<r;c++){var u=e.charCodeAt(l);u<=127?s[h]=u:u<2048?(s[h]=192|u>>6,s[++h]=128|u&63):u<55296||u>=57344?(s[h]=224|u>>12,s[++h]=128|u>>6&63,s[++h]=128|u&63):(s[h]=239,s[++h]=191,s[++h]=189),++h,++l}return n},o.prototype.getBytesOfUnicodeEncoding=function(t,e,i,r){for(var n=new ArrayBuffer(t),s=new Uint16Array(n),l=0;l<r;l++){var h=e.charCodeAt(l);s[l]=h}return n},o.prototype.getStringOfUtf8Encoding=function(t,e,i){var r=0,n=e,s="";for(r;r<i;r++){for(var l=t[n++];n>t.length;)return s;l>127&&(l>191&&l<224&&n<i?l=(l&31)<<6|t[n]&63:l>223&&l<240&&n<t.byteLength?l=(l&15)<<12|(t[n]&63)<<6|t[++n]&63:l>239&&l<248&&n<t.byteLength&&(l=(l&7)<<18|(t[n]&63)<<12|(t[++n]&63)<<6|t[++n]&63),++n),s+=String.fromCharCode(l)}return s},o.prototype.getStringofUnicodeEncoding=function(t,e,i){if(i>t.length)throw new RangeError("ArgumentOutOfRange_Count");for(var r=new Uint16Array(i),n="",s=0;s<i&&s<t.length;s++)r[s]=t[e++];return n=String.fromCharCode.apply(null,r),n},o.prototype.destroy=function(){this.emitBOM=void 0,this.encodingType=void 0},o}();function rs(o,t){if(o==null)throw new Error("ArgumentException: "+t+" cannot be null or undefined")}var a0=function(){function o(){}return o.save=function(t,e){if(t==null||t==="")throw new Error("ArgumentException: fileName cannot be undefined, null or empty");var i=t.substring(t.lastIndexOf(".")+1,t.length),r=this.getMimeType(i);if(r!==""&&(e=new Blob([e],{type:r})),this.isMicrosoftBrowser)navigator.msSaveBlob(e,t);else{var n=document.createElementNS("http://www.w3.org/1999/xhtml","a");this.saveInternal(t,i,e,n,"download"in n)}},o.saveInternal=function(t,e,i,r,n){if(n){r.download=t;var s=window.URL.createObjectURL(i);r.href=s;var l=document.createEvent("MouseEvent");l.initEvent("click",!0,!0),r.dispatchEvent(l),setTimeout(function(){window.URL.revokeObjectURL(s),s=void 0})}else if(e!=="docx"&&e!=="xlsx"){var h=window.URL.createObjectURL(i),c=window.open(h,"_blank");c||(window.location.href=h)}else{var u=new FileReader;u.onloadend=function(){var p=window.open(u.result,"_blank");p||(window.location.href=u.result)},u.readAsDataURL(i)}},o.getMimeType=function(t){var e="";switch(t){case"html":e="text/html";break;case"pdf":e="application/pdf";break;case"docx":e="application/vnd.openxmlformats-officedocument.wordprocessingml.document";break;case"xlsx":e="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";break;case"txt":e="text/plain";break}return e},o}(),o0=function(){function o(t){this.bufferBlob=new Blob([""]),this.bufferText="",this.init(t),a0.isMicrosoftBrowser=!!navigator.msSaveBlob}return Object.defineProperty(o.prototype,"buffer",{get:function(){return this.flush(),this.bufferBlob},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"encoding",{get:function(){return this.enc},enumerable:!0,configurable:!0}),o.prototype.init=function(t){t==null?(this.enc=new Sl(!1),this.enc.type="Utf8"):(this.enc=t,this.setBomByte())},o.prototype.setBomByte=function(){if(this.encoding.includeBom)switch(this.encoding.type){case"Unicode":var t=new ArrayBuffer(2),e=new Uint8Array(t);e[0]=255,e[1]=254,this.bufferBlob=new Blob([t]);break;case"Utf8":var i=new ArrayBuffer(3),r=new Uint8Array(i);r[0]=239,r[1]=187,r[2]=191,this.bufferBlob=new Blob([i]);break;default:this.bufferBlob=new Blob([""]);break}},o.prototype.save=function(t){this.bufferText!==""&&this.flush(),a0.save(t,this.buffer)},o.prototype.write=function(t){if(this.encoding===void 0)throw new Error("Object Disposed Exception: current writer is disposed");rs(t,"string"),this.bufferText+=t,this.bufferText.length>=10240&&this.flush()},o.prototype.flush=function(){if(!(this.bufferText===void 0||this.bufferText===null||this.bufferText.length===0)){var t=this.encoding.getBytes(this.bufferText,0,this.bufferText.length);this.bufferText="",this.bufferBlob=new Blob([this.bufferBlob,t])}},o.prototype.writeLine=function(t){if(this.encoding===void 0)throw new Error("Object Disposed Exception: current writer is disposed");rs(t,"string"),this.bufferText=this.bufferText+t+`\r
`,this.bufferText.length>=10240&&this.flush()},o.prototype.destroy=function(){this.bufferBlob=void 0,this.bufferText=void 0,this.enc instanceof Sl&&this.enc.destroy(),this.enc=void 0},o}(),Gx=function(){function o(t){this.isStreamCopied=!1,t instanceof Ic&&(this.document=t)}return Object.defineProperty(o.prototype,"pdfObjects",{get:function(){return this.objects},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"crossTable",{get:function(){return this.pdfCrossTable},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"currentSavingObj",{get:function(){return this.currentSavingObject},set:function(t){this.currentSavingObject=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"catalog",{get:function(){return this.pdfCatalog},set:function(t){this.pdfCatalog=t},enumerable:!0,configurable:!0}),o.prototype.setMainObjectCollection=function(t){this.objects=t},o.prototype.setCrossTable=function(t){this.pdfCrossTable=t},o.prototype.setCatalog=function(t){this.pdfCatalog=t},o.prototype.save=function(t){var e=this,i=new Sl(!0),r=new o0(i);if(typeof t=="undefined"){var n=new Sl(!0),s=new o0(n);return new Promise(function(l,h){var c={};c.blobData=new Blob([e.document.docSave(s,!0)],{type:"application/pdf"}),l(c)})}else this.document.docSave(r,t,!0)},o.prototype.clone=function(){return this.document},o}(),$t=function(){function o(t){this.stringStartMark="/",this.internalValue="",this.isSaving6=!1,this.position6=-1,this.internalValue=this.normalizeValue(t)}return Object.defineProperty(o.prototype,"status",{get:function(){return this.status6},set:function(t){this.status6=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isSaving",{get:function(){return this.isSaving6},set:function(t){this.isSaving6=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"objectCollectionIndex",{get:function(){return this.index6},set:function(t){this.index6=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"position",{get:function(){return this.position6},set:function(t){this.position6=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"clonedObject",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"value",{get:function(){return this.internalValue},set:function(t){var e=t;t!==null&&t.length>0?(e=t,this.internalValue=this.normalizeValue(e)):this.internalValue=e},enumerable:!0,configurable:!0}),o.prototype.save=function(t){t.write(this.toString())},o.prototype.toString=function(){return this.stringStartMark+this.escapeString(this.value)},o.prototype.clone=function(t){var e=new o;return e.value=this.internalValue,e},o.prototype.escapeString=function(t){for(var e="",i=0,r=0,n=t.length;r<n;r++){var s=t[r],l=o.delimiters.indexOf(s);e=e+s}return e},o.prototype.normalizeValue=function(t,e){var i="#{0:X}";return t},o.delimiters="()<>[]{}/%}",o.replacements=[" ","	",`
`,"\r"],o}(),_e=function(){function o(){this.forTest="test",this.forTest=o.obj}return o.obj="obj",o.endObj="endobj",o.r="R",o.whiteSpace=" ",o.slash="/",o.newLine=`\r
`,o.stream="stream",o.endStream="endstream",o.xref="xref",o.f="f",o.n="n",o.trailer="trailer",o.startxref="startxref",o.eof="%%EOF",o.header="%PDF-1.5",o.beginText="BT",o.endText="ET",o.beginPath="m",o.appendLineSegment="l",o.stroke="S",o.fill="f",o.fillEvenOdd="f*",o.fillStroke="B",o.fillStrokeEvenOdd="B*",o.appendbeziercurve="c",o.appendRectangle="re",o.saveState="q",o.restoreState="Q",o.paintXObject="Do",o.modifyCtm="cm",o.modifyTM="Tm",o.setLineWidth="w",o.setLineCapStyle="J",o.setLineJoinStyle="j",o.setDashPattern="d",o.setFlatnessTolerance="i",o.closePath="h",o.closeStrokePath="s",o.closeFillStrokePath="b",o.setCharacterSpace="Tc",o.setWordSpace="Tw",o.setHorizontalScaling="Tz",o.setTextLeading="TL",o.setFont="Tf",o.setRenderingMode="Tr",o.setTextRise="Ts",o.setTextScaling="Tz",o.setCoords="Td",o.goToNextLine="T*",o.setText="Tj",o.setTextWithFormatting="TJ",o.setTextOnNewLine="'",o.selectcolorspaceforstroking="CS",o.selectcolorspacefornonstroking="cs",o.setrbgcolorforstroking="RG",o.setrbgcolorfornonstroking="rg",o.setcmykcolorforstroking="K",o.setcmykcolorfornonstroking="k",o.setgraycolorforstroking="G",o.setgraycolorfornonstroking="g",o.clipPath="W",o.clipPathEvenOdd="W*",o.endPath="n",o.setGraphicsState="gs",o.comment="%",o.evenOdd="*",o.setMiterLimit="M",o.setColorAndPattern="scn",o.setColorAndPatternStroking="SCN",o}(),$i=function(){function o(){this.pages="Pages",this.kids="Kids",this.count="Count",this.resources="Resources",this.type="Type",this.size="Size",this.mediaBox="MediaBox",this.parent="Parent",this.root="Root",this.decodeParms="DecodeParms",this.filter="Filter",this.font="Font",this.type1="Type1",this.baseFont="BaseFont",this.encoding="Encoding",this.subtype="Subtype",this.contents="Contents",this.procset="ProcSet",this.colorSpace="ColorSpace",this.extGState="ExtGState",this.pattern="Pattern",this.xObject="XObject",this.length="Length",this.width="Width",this.height="Height",this.bitsPerComponent="BitsPerComponent",this.image="Image",this.dctdecode="DCTDecode",this.columns="Columns",this.blackIs1="BlackIs1",this.k="K",this.s="S",this.predictor="Predictor",this.deviceRgb="DeviceRGB",this.next="Next",this.action="Action",this.link="Link",this.a="A",this.annot="Annot",this.p="P",this.c="C",this.rect="Rect",this.uri="URI",this.annots="Annots",this.ca="ca",this.CA="CA",this.xyz="XYZ",this.fit="Fit",this.dest="Dest",this.BM="BM",this.flatedecode="FlateDecode",this.rotate="Rotate",this.bBox="BBox",this.form="Form",this.w="W",this.cIDFontType2="CIDFontType2",this.cIDToGIDMap="CIDToGIDMap",this.identity="Identity",this.dw="DW",this.fontDescriptor="FontDescriptor",this.cIDSystemInfo="CIDSystemInfo",this.fontName="FontName",this.flags="Flags",this.fontBBox="FontBBox",this.missingWidth="MissingWidth",this.stemV="StemV",this.italicAngle="ItalicAngle",this.capHeight="CapHeight",this.ascent="Ascent",this.descent="Descent",this.leading="Leading",this.avgWidth="AvgWidth",this.fontFile2="FontFile2",this.maxWidth="MaxWidth",this.xHeight="XHeight",this.stemH="StemH",this.registry="Registry",this.ordering="Ordering",this.supplement="Supplement",this.type0="Type0",this.identityH="Identity-H",this.toUnicode="ToUnicode",this.descendantFonts="DescendantFonts",this.background="Background",this.shading="Shading",this.matrix="Matrix",this.antiAlias="AntiAlias",this.function="Function",this.extend="Extend",this.shadingType="ShadingType",this.coords="Coords",this.domain="Domain",this.range="Range",this.functionType="FunctionType",this.bitsPerSample="BitsPerSample",this.patternType="PatternType",this.paintType="PaintType",this.tilingType="TilingType",this.xStep="XStep",this.yStep="YStep"}return o}(),Ei=function(){function o(t){if(this.position7=-1,this.primitiveItems=new Ii,this.prefix="<<",this.suffix=">>",this.resources=[],this.object=null,this.archive=!0,this.isFont=!1,typeof t=="undefined")this.primitiveItems=new Ii,this.encrypt=!0,this.dictionaryProperties=new $i;else{this.primitiveItems=new Ii;for(var e=t.items.keys(),i=t.items.values(),r=0;r<t.items.size();r++)this.primitiveItems.setValue(e[r],i[r]);this.status=t.status,this.freezeChanges(this),this.encrypt=!0,this.dictionaryProperties=new $i}}return Object.defineProperty(o.prototype,"items",{get:function(){return this.primitiveItems},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"status",{get:function(){return this.status7},set:function(t){this.status7=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isSaving",{get:function(){return this.isSaving7},set:function(t){this.isSaving7=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"objectCollectionIndex",{get:function(){return this.index7},set:function(t){this.index7=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"clonedObject",{get:function(){return this.object},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"position",{get:function(){return this.position7},set:function(t){this.position7=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"Count",{get:function(){return this.primitiveItems.size()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"Dictionary",{get:function(){return this},enumerable:!0,configurable:!0}),o.prototype.getArchive=function(){return this.archive},o.prototype.setArchive=function(t){this.archive=t},o.prototype.setEncrypt=function(t){this.encrypt=t,this.modify()},o.prototype.getEncrypt=function(){return this.encrypt},o.prototype.freezeChanges=function(t){this.bChanged=!1},o.prototype.clone=function(t){var e=new o;return e},o.prototype.modify=function(){this.bChanged=!0},o.prototype.remove=function(t){typeof t!="string"?(this.primitiveItems.remove(t.value),this.modify()):this.remove(new $t(t))},o.prototype.containsKey=function(t){var e=!1;return e=this.primitiveItems.containsKey(t.toString()),e},o.prototype.onBeginSave=function(){this.beginSave.sender.beginSave()},o.prototype.onFontDictionaryBeginSave=function(){this.fontDictionaryBeginSave.sender.fontDictionaryBeginSave()},o.prototype.onDescendantFontBeginSave=function(){this.descendantFontBeginSave.sender.descendantFontBeginSave()},o.prototype.onTemplateBeginSave=function(){this.pageBeginDrawTemplate.sender.pageBeginSave()},o.prototype.onBeginAnnotationSave=function(){this.annotationBeginSave.sender.beginSave()},o.prototype.onSectionBeginSave=function(t){var e=this.sectionBeginSave;e.sender.beginSave(e.state,t)},o.prototype.save=function(t,e){typeof e=="undefined"?this.save(t,!0):(t.write(this.prefix),typeof this.beginSave!="undefined"&&this.onBeginSave(),typeof this.descendantFontBeginSave!="undefined"&&this.onDescendantFontBeginSave(),typeof this.fontDictionaryBeginSave!="undefined"&&this.onFontDictionaryBeginSave(),typeof this.annotationBeginSave!="undefined"&&this.onBeginAnnotationSave(),typeof this.sectionBeginSave!="undefined"&&this.onSectionBeginSave(t),typeof this.pageBeginDrawTemplate!="undefined"&&this.onTemplateBeginSave(),this.Count>0&&this.saveItems(t),t.write(this.suffix),t.write(_e.newLine))},o.prototype.saveItems=function(t){t.write(_e.newLine);for(var e=this.primitiveItems.keys(),i=this.primitiveItems.values(),r=0;r<e.length;r++){var n=e[r],s=new $t(n);s.save(t),t.write(_e.whiteSpace);var l=i[r];l.save(t),t.write(_e.newLine)}},o}(),Kx=function(){function o(t){this.sender=t}return o}(),Xx=function(){function o(t){this.sender=t}return o}(),$x=function(){function o(t){this.sender=t}return o}(),FR=function(){function o(t){this.sender=t}return o}(),Qx=function(){function o(t,e){this.sender=t,this.state=e}return o}(),Jx=function(){function o(t){this.sender=t}return o}(),It=function(){function o(t){this.position5=-1,this.value=t}return Object.defineProperty(o.prototype,"intValue",{get:function(){return this.value},set:function(t){this.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isInteger",{get:function(){return this.integer},set:function(t){this.integer=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"status",{get:function(){return this.status5},set:function(t){this.status5=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isSaving",{get:function(){return this.isSaving5},set:function(t){this.isSaving5=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"objectCollectionIndex",{get:function(){return this.index5},set:function(t){this.index5=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"position",{get:function(){return this.position5},set:function(t){this.position5=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"clonedObject",{get:function(){var t=null;return t},enumerable:!0,configurable:!0}),o.prototype.save=function(t){t.write(this.intValue.toString())},o.prototype.clone=function(t){var e=new o(this.value);return e},o.floatToString=function(t){var e=t.toFixed(2);return e==="0.00"&&(e=".00"),e},o.min=function(t,e,i){var r=Math.min(t,e);return Math.min(i,r)},o}(),Zi=function(){function o(t){if(this.startMark="[",this.endMark="]",this.position9=-1,this.clonedObject9=null,this.isFont=!1,typeof t=="undefined")this.internalElements=[];else if(typeof t!="undefined"&&!(t instanceof o))for(var e=t,i=0;i<e.length;i++){var r=new It(e[i]);this.add(r)}else{var n=t;this.internalElements=[];for(var i=0;i<n.elements.length;i++)this.internalElements.push(n.elements[i])}}return o.prototype.items=function(t){return this.internalElements[t]},Object.defineProperty(o.prototype,"count",{get:function(){return this.internalElements.length},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"status",{get:function(){return this.status9},set:function(t){this.status9=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isSaving",{get:function(){return this.isSaving9},set:function(t){this.isSaving9=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"clonedObject",{get:function(){return this.clonedObject9},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"position",{get:function(){return this.position9},set:function(t){this.position9=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"objectCollectionIndex",{get:function(){return this.index9},set:function(t){this.index9=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"CrossTable",{get:function(){return this.pdfCrossTable},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"elements",{get:function(){return this.internalElements},enumerable:!0,configurable:!0}),o.prototype.add=function(t){typeof this.internalElements=="undefined"&&(this.internalElements=[]),this.internalElements.push(t),this.markedChange()},o.prototype.markedChange=function(){this.bChanged=!0},o.prototype.contains=function(t){for(var e=!1,i=0;i<this.internalElements.length;i++){var r=this.internalElements[i],n=t;if(r!=null&&typeof r!="undefined"&&n!=null&&typeof n!="undefined"&&r.value===n.value)return!0}return e},o.prototype.getItems=function(t){return this.internalElements[t]},o.prototype.save=function(t){t.write(this.startMark);for(var e=0,i=this.count;e<i;e++)this.getItems(e).save(t),e+1!==i&&t.write(_e.whiteSpace);t.write(this.endMark)},o.prototype.clone=function(t){this.clonedObject9=null;for(var e=new o,i=0;i<this.internalElements.length;i++){var r=this.internalElements[i];e.add(r.clone(t))}return e.pdfCrossTable=t,this.clonedObject9=e,e},o.fromRectangle=function(t){var e=[t.x,t.y,t.width,t.height],i=new o(e);return i},o.prototype.insert=function(t,e){if(t<this.internalElements.length&&t>0){for(var i=[],r=0;r<t;r++)i.push(this.internalElements[r]);i.push(e);for(var r=t;r<this.internalElements.length;r++)i.push(this.internalElements[r]);this.internalElements=i}else this.internalElements.push(e);this.markChanged()},o.prototype.indexOf=function(t){return this.internalElements.indexOf(t)},o.prototype.remove=function(t){var e=this.internalElements.indexOf(t);this.internalElements[e]=null,this.markChanged()},o.prototype.removeAt=function(t){if(this.internalElements.length>t){for(var e=[],i=0;i<t;i++)e.push(this.internalElements[i]);for(var i=t+1;i<this.internalElements.length;i++)e.push(this.internalElements[i]);this.internalElements=e}this.markChanged()},o.prototype.clear=function(){this.internalElements=[],this.markChanged()},o.prototype.markChanged=function(){this.bChanged=!0},o}(),wl=new Int16Array(286),no=new Uint8Array(286),l0=new Int16Array(30),Nd=new Uint8Array(30),eE=function(){function o(t){this.pendingBuffer=new Uint8Array(1<<16),this.pendingBufLength=0,this.pendingBufCache=0,this.pendingBufBitsInCache=0,this.bufferPosition=0,this.extraBits=0,this.currentHash=0,this.matchStart=0,this.matchLength=0,this.matchPrevAvail=!1,this.blockStart=0,this.stringStart=0,this.lookAhead=0,this.totalBytesIn=0,this.inputOffset=0,this.inputEnd=0,this.windowSize=1<<15,this.windowMask=this.windowSize-1,this.hashSize=1<<15,this.hashMask=this.hashSize-1,this.hashShift=Math.floor((15+3-1)/3),this.maxDist=this.windowSize-262,this.checkSum=1,this.noWrap=!1,o.isHuffmanTreeInitiated||(o.initHuffmanTree(),o.isHuffmanTreeInitiated=!0),this.treeLiteral=new Pn(this,286,257,15),this.treeDistances=new Pn(this,30,1,15),this.treeCodeLengths=new Pn(this,19,4,7),this.arrDistances=new Uint16Array(1<<14),this.arrLiterals=new Uint8Array(1<<14),this.stream=[],this.dataWindow=new Uint8Array(2*this.windowSize),this.hashHead=new Int16Array(this.hashSize),this.hashPrevious=new Int16Array(this.windowSize),this.blockStart=this.stringStart=1,this.noWrap=t,t||this.writeZLibHeader()}return Object.defineProperty(o.prototype,"compressedData",{get:function(){return this.stream},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"getCompressedString",{get:function(){var t="";if(this.stream!==void 0)for(var e=0;e<this.stream.length;e++)t+=String.fromCharCode.apply(null,this.stream[e]);return t},enumerable:!0,configurable:!0}),o.prototype.write=function(t,e,i){if(t==null)throw new Error("ArgumentException: data cannot null or undefined");var r=e+i;if(0>e||e>r||r>t.length)throw new Error("ArgumentOutOfRangeException: Offset or length is incorrect");if(typeof t=="string"){var n=new Sl(!1);n.type="Utf8",t=new Uint8Array(n.getBytes(t,0,t.length)),r=e+t.length}for(this.inputBuffer=t,this.inputOffset=e,this.inputEnd=r,this.noWrap||(this.checkSum=tE.checksumUpdate(this.checkSum,this.inputBuffer,this.inputOffset,r));this.inputEnd!==this.inputOffset||this.pendingBufLength!==0;)this.pendingBufferFlush(),this.compressData(!1)},o.prototype.writeZLibHeader=function(){var t=8+(7<<4)<<8;t|=(5>>2&3)<<6,t+=31-t%31,this.pendingBufferWriteShortBytes(t)},o.prototype.pendingBufferWriteShortBytes=function(t){this.pendingBuffer[this.pendingBufLength++]=t>>8,this.pendingBuffer[this.pendingBufLength++]=t},o.prototype.compressData=function(t){var e;do{this.fillWindow();var i=t&&this.inputEnd===this.inputOffset;e=this.compressSlow(i,t)}while(this.pendingBufLength===0&&e);return e},o.prototype.compressSlow=function(t,e){if(this.lookAhead<262&&!t)return!1;for(;this.lookAhead>=262||t;){if(this.lookAhead===0)return this.lookAheadCompleted(e);this.stringStart>=2*this.windowSize-262&&this.slideWindow();var i=this.matchStart,r=this.matchLength;if(this.lookAhead>=3&&this.discardMatch(),r>=3&&this.matchLength<=r?r=this.matchPreviousBest(i,r):this.matchPreviousAvailable(),this.bufferPosition>=1<<14)return this.huffmanIsFull(e)}return!0},o.prototype.discardMatch=function(){var t=this.insertString();t!==0&&this.stringStart-t<=this.maxDist&&this.findLongestMatch(t)&&this.matchLength<=5&&this.matchLength===3&&this.stringStart-this.matchStart>4096&&(this.matchLength=3-1)},o.prototype.matchPreviousAvailable=function(){this.matchPrevAvail&&this.huffmanTallyLit(this.dataWindow[this.stringStart-1]&255),this.matchPrevAvail=!0,this.stringStart++,this.lookAhead--},o.prototype.matchPreviousBest=function(t,e){this.huffmanTallyDist(this.stringStart-1-t,e),e-=2;do this.stringStart++,this.lookAhead--,this.lookAhead>=3&&this.insertString();while(--e>0);return this.stringStart++,this.lookAhead--,this.matchPrevAvail=!1,this.matchLength=3-1,e},o.prototype.lookAheadCompleted=function(t){return this.matchPrevAvail&&this.huffmanTallyLit(this.dataWindow[this.stringStart-1]&255),this.matchPrevAvail=!1,this.huffmanFlushBlock(this.dataWindow,this.blockStart,this.stringStart-this.blockStart,t),this.blockStart=this.stringStart,!1},o.prototype.huffmanIsFull=function(t){var e=this.stringStart-this.blockStart;this.matchPrevAvail&&e--;var i=t&&this.lookAhead===0&&!this.matchPrevAvail;return this.huffmanFlushBlock(this.dataWindow,this.blockStart,e,i),this.blockStart+=e,!i},o.prototype.fillWindow=function(){for(this.stringStart>=this.windowSize+this.maxDist&&this.slideWindow();this.lookAhead<262&&this.inputOffset<this.inputEnd;){var t=2*this.windowSize-this.lookAhead-this.stringStart;t>this.inputEnd-this.inputOffset&&(t=this.inputEnd-this.inputOffset),this.dataWindow.set(this.inputBuffer.subarray(this.inputOffset,this.inputOffset+t),this.stringStart+this.lookAhead),this.inputOffset+=t,this.totalBytesIn+=t,this.lookAhead+=t}this.lookAhead>=3&&this.updateHash()},o.prototype.slideWindow=function(){this.dataWindow.set(this.dataWindow.subarray(this.windowSize,this.windowSize+this.windowSize),0),this.matchStart-=this.windowSize,this.stringStart-=this.windowSize,this.blockStart-=this.windowSize;for(var t=0;t<this.hashSize;++t){var e=this.hashHead[t]&65535;this.hashHead[t]=e>=this.windowSize?e-this.windowSize:0}for(var t=0;t<this.windowSize;t++){var e=this.hashPrevious[t]&65535;this.hashPrevious[t]=e>=this.windowSize?e-this.windowSize:0}},o.prototype.insertString=function(){var t,e=(this.currentHash<<this.hashShift^this.dataWindow[this.stringStart+(3-1)])&this.hashMask;return this.hashPrevious[this.stringStart&this.windowMask]=t=this.hashHead[e],this.hashHead[e]=this.stringStart,this.currentHash=e,t&65535},o.prototype.findLongestMatch=function(t){var e=4096,i=258,r=this.stringStart,n,s=this.stringStart+this.matchLength,l=Math.max(this.matchLength,3-1),h=Math.max(this.stringStart-this.maxDist,0),c=this.stringStart+258-1,u=this.dataWindow[s-1],p=this.dataWindow[s],f=this.dataWindow;l>=32&&(e>>=2),i>this.lookAhead&&(i=this.lookAhead);do if(!(f[t+l]!==p||f[t+l-1]!==u||f[t]!==f[r]||f[t+1]!==f[r+1])){for(n=t+2,r+=2;f[++r]===f[++n]&&f[++r]===f[++n]&&f[++r]===f[++n]&&f[++r]===f[++n]&&f[++r]===f[++n]&&f[++r]===f[++n]&&f[++r]===f[++n]&&f[++r]===f[++n]&&r<c;);if(r>s){if(this.matchStart=t,s=r,l=r-this.stringStart,l>=i)break;u=f[s-1],p=f[s]}r=this.stringStart}while((t=this.hashPrevious[t&this.windowMask]&65535)>h&&--e!=0);return this.matchLength=Math.min(l,this.lookAhead),this.matchLength>=3},o.prototype.updateHash=function(){this.currentHash=this.dataWindow[this.stringStart]<<this.hashShift^this.dataWindow[this.stringStart+1]},o.prototype.huffmanTallyLit=function(t){return this.arrDistances[this.bufferPosition]=0,this.arrLiterals[this.bufferPosition++]=t,this.treeLiteral.codeFrequencies[t]++,this.bufferPosition>=1<<14},o.prototype.huffmanTallyDist=function(t,e){this.arrDistances[this.bufferPosition]=t,this.arrLiterals[this.bufferPosition++]=e-3;var i=this.huffmanLengthCode(e-3);this.treeLiteral.codeFrequencies[i]++,i>=265&&i<285&&(this.extraBits+=Math.floor((i-261)/4));var r=this.huffmanDistanceCode(t-1);return this.treeDistances.codeFrequencies[r]++,r>=4&&(this.extraBits+=Math.floor(r/2-1)),this.bufferPosition>=1<<14},o.prototype.huffmanFlushBlock=function(t,e,i,r){this.treeLiteral.codeFrequencies[256]++,this.treeLiteral.buildTree(),this.treeDistances.buildTree(),this.treeLiteral.calculateBLFreq(this.treeCodeLengths),this.treeDistances.calculateBLFreq(this.treeCodeLengths),this.treeCodeLengths.buildTree();for(var n=4,s=18;s>n;s--)this.treeCodeLengths.codeLengths[Pn.huffCodeLengthOrders[s]]>0&&(n=s+1);for(var l=14+n*3+this.treeCodeLengths.getEncodedLength()+this.treeLiteral.getEncodedLength()+this.treeDistances.getEncodedLength()+this.extraBits,h=this.extraBits,s=0;s<286;s++)h+=this.treeLiteral.codeFrequencies[s]*no[s];for(var s=0;s<30;s++)h+=this.treeDistances.codeFrequencies[s]*Nd[s];l>=h&&(l=h),e>=0&&i+4<l>>3?this.huffmanFlushStoredBlock(t,e,i,r):l==h?(this.pendingBufferWriteBits((1<<1)+(r?1:0),3),this.treeLiteral.setStaticCodes(wl,no),this.treeDistances.setStaticCodes(l0,Nd),this.huffmanCompressBlock(),this.huffmanReset()):(this.pendingBufferWriteBits((2<<1)+(r?1:0),3),this.huffmanSendAllTrees(n),this.huffmanCompressBlock(),this.huffmanReset())},o.prototype.huffmanFlushStoredBlock=function(t,e,i,r){this.pendingBufferWriteBits((0<<1)+(r?1:0),3),this.pendingBufferAlignToByte(),this.pendingBufferWriteShort(i),this.pendingBufferWriteShort(~i),this.pendingBufferWriteByteBlock(t,e,i),this.huffmanReset()},o.prototype.huffmanLengthCode=function(t){if(t===255)return 285;for(var e=257;t>=8;)e+=4,t>>=1;return e+t},o.prototype.huffmanDistanceCode=function(t){for(var e=0;t>=4;)e+=2,t>>=1;return e+t},o.prototype.huffmanSendAllTrees=function(t){this.treeCodeLengths.buildCodes(),this.treeLiteral.buildCodes(),this.treeDistances.buildCodes(),this.pendingBufferWriteBits(this.treeLiteral.treeLength-257,5),this.pendingBufferWriteBits(this.treeDistances.treeLength-1,5),this.pendingBufferWriteBits(t-4,4);for(var e=0;e<t;e++)this.pendingBufferWriteBits(this.treeCodeLengths.codeLengths[Pn.huffCodeLengthOrders[e]],3);this.treeLiteral.writeTree(this.treeCodeLengths),this.treeDistances.writeTree(this.treeCodeLengths)},o.prototype.huffmanReset=function(){this.bufferPosition=0,this.extraBits=0,this.treeLiteral.reset(),this.treeDistances.reset(),this.treeCodeLengths.reset()},o.prototype.huffmanCompressBlock=function(){for(var t=0;t<this.bufferPosition;t++){var e=this.arrLiterals[t]&255,i=this.arrDistances[t];if(i--!=0){var r=this.huffmanLengthCode(e);this.treeLiteral.writeCodeToStream(r);var n=Math.floor((r-261)/4);n>0&&n<=5&&this.pendingBufferWriteBits(e&(1<<n)-1,n);var s=this.huffmanDistanceCode(i);this.treeDistances.writeCodeToStream(s),n=Math.floor(s/2-1),n>0&&this.pendingBufferWriteBits(i&(1<<n)-1,n)}else this.treeLiteral.writeCodeToStream(e)}this.treeLiteral.writeCodeToStream(256)},o.prototype.pendingBufferWriteBits=function(t,e){var i=new Uint32Array(1);i[0]=this.pendingBufCache|t<<this.pendingBufBitsInCache,this.pendingBufCache=i[0],this.pendingBufBitsInCache+=e,this.pendingBufferFlushBits()},o.prototype.pendingBufferFlush=function(t){if(this.pendingBufferFlushBits(),this.pendingBufLength>0){var e=new Uint8Array(this.pendingBufLength);e.set(this.pendingBuffer.subarray(0,this.pendingBufLength),0),this.stream.push(e)}this.pendingBufLength=0},o.prototype.pendingBufferFlushBits=function(){for(var t=0;this.pendingBufBitsInCache>=8&&this.pendingBufLength<1<<16;)this.pendingBuffer[this.pendingBufLength++]=this.pendingBufCache,this.pendingBufCache>>=8,this.pendingBufBitsInCache-=8,t++;return t},o.prototype.pendingBufferWriteByteBlock=function(t,e,i){var r=t.subarray(e,e+i);this.pendingBuffer.set(r,this.pendingBufLength),this.pendingBufLength+=i},o.prototype.pendingBufferWriteShort=function(t){this.pendingBuffer[this.pendingBufLength++]=t,this.pendingBuffer[this.pendingBufLength++]=t>>8},o.prototype.pendingBufferAlignToByte=function(){this.pendingBufBitsInCache>0&&(this.pendingBuffer[this.pendingBufLength++]=this.pendingBufCache),this.pendingBufCache=0,this.pendingBufBitsInCache=0},o.initHuffmanTree=function(){for(var t=0;t<144;)wl[t]=Pn.bitReverse(48+t<<8),no[t++]=8;for(;t<256;)wl[t]=Pn.bitReverse(400-144+t<<7),no[t++]=9;for(;t<280;)wl[t]=Pn.bitReverse(0-256+t<<9),no[t++]=7;for(;t<286;)wl[t]=Pn.bitReverse(192-280+t<<8),no[t++]=8;for(t=0;t<30;t++)l0[t]=Pn.bitReverse(t<<11),Nd[t]=5},o.prototype.close=function(){do this.pendingBufferFlush(!0),this.compressData(!0)||(this.pendingBufferFlush(!0),this.pendingBufferAlignToByte(),this.noWrap||(this.pendingBufferWriteShortBytes(this.checkSum>>16),this.pendingBufferWriteShortBytes(this.checkSum&65535)),this.pendingBufferFlush(!0));while(this.inputEnd!==this.inputOffset||this.pendingBufLength!==0)},o.prototype.destroy=function(){this.stream=[],this.stream=void 0,this.pendingBuffer=void 0,this.treeLiteral=void 0,this.treeDistances=void 0,this.treeCodeLengths=void 0,this.arrLiterals=void 0,this.arrDistances=void 0,this.hashHead=void 0,this.hashPrevious=void 0,this.dataWindow=void 0,this.inputBuffer=void 0,this.pendingBufLength=void 0,this.pendingBufCache=void 0,this.pendingBufBitsInCache=void 0,this.bufferPosition=void 0,this.extraBits=void 0,this.currentHash=void 0,this.matchStart=void 0,this.matchLength=void 0,this.matchPrevAvail=void 0,this.blockStart=void 0,this.stringStart=void 0,this.lookAhead=void 0,this.totalBytesIn=void 0,this.inputOffset=void 0,this.inputEnd=void 0,this.windowSize=void 0,this.windowMask=void 0,this.hashSize=void 0,this.hashMask=void 0,this.hashShift=void 0,this.maxDist=void 0,this.checkSum=void 0,this.noWrap=void 0},o.isHuffmanTreeInitiated=!1,o}(),Pn=function(){function o(t,e,i,r){this.writer=t,this.codeMinCount=i,this.maxLength=r,this.codeFrequency=new Uint16Array(e),this.lengthCount=new Int32Array(r)}return Object.defineProperty(o.prototype,"treeLength",{get:function(){return this.codeCount},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"codeLengths",{get:function(){return this.codeLength},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"codeFrequencies",{get:function(){return this.codeFrequency},enumerable:!0,configurable:!0}),o.prototype.setStaticCodes=function(t,e){var i=new Int16Array(t.length);i.set(t,0),this.codes=i;var r=new Uint8Array(e.length);r.set(e,0),this.codeLength=r},o.prototype.reset=function(){for(var t=0;t<this.codeFrequency.length;t++)this.codeFrequency[t]=0;this.codes=void 0,this.codeLength=void 0},o.prototype.writeCodeToStream=function(t){this.writer.pendingBufferWriteBits(this.codes[t]&65535,this.codeLength[t])},o.prototype.buildCodes=function(){var t=new Int32Array(this.maxLength);this.codes=new Int16Array(this.codeCount);for(var e=0,i=0;i<this.maxLength;i++)t[i]=e,e+=this.lengthCount[i]<<15-i;for(var r=0;r<this.codeCount;r++){var n=this.codeLength[r];n>0&&(this.codes[r]=o.bitReverse(t[n-1]),t[n-1]+=1<<16-n)}},o.bitReverse=function(t){return o.reverseBits[t&15]<<12|o.reverseBits[t>>4&15]<<8|o.reverseBits[t>>8&15]<<4|o.reverseBits[t>>12]},o.prototype.getEncodedLength=function(){for(var t=0,e=0;e<this.codeFrequency.length;e++)t+=this.codeFrequency[e]*this.codeLength[e];return t},o.prototype.calculateBLFreq=function(t){for(var e,i,r,n=-1,s=0;s<this.codeCount;){r=1;var l=this.codeLength[s];for(l===0?(e=138,i=3):(e=6,i=3,n!==l&&(t.codeFrequency[l]++,r=0)),n=l,s++;s<this.codeCount&&n===this.codeLength[s]&&(s++,!(++r>=e)););r<i?t.codeFrequency[n]+=r:n!==0?t.codeFrequency[16]++:r<=10?t.codeFrequency[17]++:t.codeFrequency[18]++}},o.prototype.writeTree=function(t){for(var e,i,r,n=-1,s=0;s<this.codeCount;){r=1;var l=this.codeLength[s];for(l===0?(e=138,i=3):(e=6,i=3,n!==l&&(t.writeCodeToStream(l),r=0)),n=l,s++;s<this.codeCount&&n===this.codeLength[s]&&(s++,!(++r>=e)););if(r<i)for(;r-- >0;)t.writeCodeToStream(n);else n!==0?(t.writeCodeToStream(16),this.writer.pendingBufferWriteBits(r-3,2)):r<=10?(t.writeCodeToStream(17),this.writer.pendingBufferWriteBits(r-3,3)):(t.writeCodeToStream(18),this.writer.pendingBufferWriteBits(r-11,7))}},o.prototype.buildTree=function(){for(var t=this.codeFrequency.length,e=new Int32Array(t),i=0,r=0,n=0;n<t;n++){var s=this.codeFrequency[n];if(s!==0){for(var l=i++,h=0;l>0&&this.codeFrequency[e[h=Math.floor((l-1)/2)]]>s;)e[l]=e[h],l=h;e[l]=n,r=n}}for(;i<2;)e[i++]=r<2?++r:0;this.codeCount=Math.max(r+1,this.codeMinCount);for(var c=i,u=c,p=new Int32Array(4*i-2),f=new Int32Array(2*i-1),g=0;g<i;g++){var C=e[g],L=2*g;p[L]=C,p[L+1]=-1,f[g]=this.codeFrequency[C]<<8,e[g]=g}this.constructHuffmanTree(e,i,f,u,p),this.buildLength(p)},o.prototype.constructHuffmanTree=function(t,e,i,r,n){do{for(var s=t[0],l=t[--e],h=i[l],c=0,u=1;u<e;)u+1<e&&i[t[u]]>i[t[u+1]]&&u++,t[c]=t[u],c=u,u=c*2+1;for(;(u=c)>0&&i[t[c=Math.floor((u-1)/2)]]>h;)t[u]=t[c];t[u]=l;var p=t[0];l=r++,n[2*l]=s,n[2*l+1]=p;var f=Math.min(i[s]&255,i[p]&255);for(i[l]=h=i[s]+i[p]-f+1,c=0,u=1;u<e;)u+1<e&&i[t[u]]>i[t[u+1]]&&u++,t[c]=t[u],c=u,u=c*2+1;for(;(u=c)>0&&i[t[c=Math.floor((u-1)/2)]]>h;)t[u]=t[c];t[u]=l}while(e>1)},o.prototype.buildLength=function(t){this.codeLength=new Uint8Array(this.codeFrequency.length);for(var e=Math.floor(t.length/2),i=Math.floor((e+1)/2),r=0,n=0;n<this.maxLength;n++)this.lengthCount[n]=0;if(r=this.calculateOptimalCodeLength(t,r,e),r!==0){var s=this.maxLength-1;do{for(;this.lengthCount[--s]===0;);do this.lengthCount[s]--,this.lengthCount[++s]++,r-=1<<this.maxLength-1-s;while(r>0&&s<this.maxLength-1)}while(r>0);this.recreateTree(t,r,i)}},o.prototype.recreateTree=function(t,e,i){this.lengthCount[this.maxLength-1]+=e,this.lengthCount[this.maxLength-2]-=e;for(var r=2*i,n=this.maxLength;n!==0;n--)for(var s=this.lengthCount[n-1];s>0;){var l=2*t[r++];t[l+1]===-1&&(this.codeLength[t[l]]=n,s--)}},o.prototype.calculateOptimalCodeLength=function(t,e,i){var r=new Int32Array(i);r[i-1]=0;for(var n=i-1;n>=0;n--){var s=2*n+1;if(t[s]!==-1){var l=r[n]+1;l>this.maxLength&&(l=this.maxLength,e++),r[t[s-1]]=r[t[s]]=l}else{var l=r[n];this.lengthCount[l-1]++,this.codeLength[t[s-1]]=r[n]}}return e},o.reverseBits=[0,8,4,12,2,10,6,14,1,9,5,13,3,11,7,15],o.huffCodeLengthOrders=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],o}(),tE=function(){function o(){}return o.checksumUpdate=function(t,e,i,r){var n=new Uint32Array(1);n[0]=t;for(var s=n[0],l=n[0]=s&65535,h=n[0]=s>>o.checkSumBitOffset;r>0;){var c=Math.min(r,o.checksumIterationCount);for(r-=c;--c>=0;)l=l+(n[0]=e[i++]&255),h=h+l;l%=o.checksumBase,h%=o.checksumBase}return s=h<<o.checkSumBitOffset|l,s},o.checkSumBitOffset=16,o.checksumBase=65521,o.checksumIterationCount=3800,o}(),iE=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Tr=function(o){iE(t,o);function t(e,i){var r=o.call(this,e)||this;return r.dicPrefix="stream",r.dicSuffix="endstream",r.clonedObject2=null,r.bCompress=!0,r.isImageStream=!1,r.isFontStream=!1,typeof e!="undefined"||typeof i!="undefined"?(r.dataStream2=[],r.dataStream2=i,r.bCompress2=!1):(r.dataStream2=[],r.bCompress2=!0),r}return Object.defineProperty(t.prototype,"internalStream",{get:function(){return this.dataStream2},set:function(e){this.dataStream2=[],this.dataStream2=e,this.modify()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isImage",{get:function(){return this.isImageStream},set:function(e){this.isImageStream=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFont",{get:function(){return this.isFontStream},set:function(e){this.isFontStream=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"compress",{get:function(){return this.bCompress},set:function(e){this.bCompress=e,this.modify()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.dataStream2},set:function(e){this.dataStream2=[],this.dataStream2=e,this.modify()},enumerable:!0,configurable:!0}),t.prototype.clearStream=function(){this.internalStream=[],this.items.containsKey(this.dictionaryProperties.filter)&&this.remove(this.dictionaryProperties.filter),this.bCompress=!0,this.modify()},t.prototype.write=function(e){if(e==null)throw new Error("ArgumentNullException:text");if(e.length<=0)throw new Error("ArgumentException: Can not write an empty string, text");this.dataStream2.push(e),this.modify()},t.prototype.writeBytes=function(e){if(e===null)throw new Error("ArgumentNullException:data");if(e.length<=0)throw new Error("ArgumentException: Can not write an empty bytes, data");for(var i="",r=0;r<e.length;r++)i+=String.fromCharCode(e[r]);this.dataStream2.push(i),this.modify()},t.prototype.onCmapBeginSave=function(){this.cmapBeginSave.sender.cmapBeginSave()},t.prototype.onFontProgramBeginSave=function(){this.fontProgramBeginSave.sender.fontProgramBeginSave()},t.prototype.compressContent=function(e,i){if(this.bCompress){for(var r=[],n=0;n<e.length;n++)r.push(e.charCodeAt(n));var s=new Uint8Array(r),l=new eE;l.write(s,0,s.length),l.close(),e=l.getCompressedString,this.addFilter(this.dictionaryProperties.flatedecode)}return e},t.prototype.addFilter=function(e){var i=this.items.getValue(this.dictionaryProperties.filter);if(i instanceof Ai){var r=i;i=r.object}var n=i,s=i;s!=null&&(n=new Zi,n.insert(0,s),this.items.setValue(this.dictionaryProperties.filter,n)),s=new $t(e),n==null?this.items.setValue(this.dictionaryProperties.filter,s):n.insert(0,s)},t.prototype.save=function(e){typeof this.cmapBeginSave!="undefined"&&this.onCmapBeginSave(),typeof this.fontProgramBeginSave!="undefined"&&this.onFontProgramBeginSave();for(var i="",r=0;r<this.data.length;r++)i=i+this.data[r];i.length>1&&!this.isImage&&!this.isFont&&(i=`q\r
`+i+`Q\r
`),i=this.compressContent(i,e);var n=i.length;this.items.setValue(this.dictionaryProperties.length,new It(n)),o.prototype.save.call(this,e,!1),e.write(this.dicPrefix),e.write(_e.newLine),i.length>0&&e.write(i),e.write(_e.newLine),e.write(this.dicSuffix),e.write(_e.newLine)},t.bytesToString=function(e){for(var i="",r=0;r<e.length;r++)i=i+String.fromCharCode(e[r]);return i},t}(Ei),rE=function(){function o(t){this.sender=t}return o}(),nE=function(){function o(t){this.sender=t}return o}(),xl;(function(o){var t;(function(i){i[i.None=0]="None",i[i.Ascii=1]="Ascii",i[i.Unicode=2]="Unicode"})(t=o.ForceEncoding||(o.ForceEncoding={}));var e;(function(i){i[i.StringValue=0]="StringValue",i[i.ByteBuffer=1]="ByteBuffer"})(e||(e={}))})(xl||(xl={}));var Lr=function(){function o(t){if(this.bHex=!1,this.position1=-1,this.clonedObject1=null,this.bDecrypted=!1,this.isParentDecrypted=!1,this.isPacked=!1,this.isFormField=!1,this.isColorSpace=!1,this.isHexString=!0,typeof t=="undefined")this.bHex=!1;else if(!(t.length>0&&t[0]==="0xfeff")){this.stringValue=t,this.data=[];for(var e=0;e<t.length;++e)this.data.push(t.charCodeAt(e))}}return Object.defineProperty(o.prototype,"hex",{get:function(){return this.bHex},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"value",{get:function(){return this.stringValue},set:function(t){this.stringValue=t,this.data=null},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"status",{get:function(){return this.status1},set:function(t){this.status1=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isSaving",{get:function(){return this.isSaving1},set:function(t){this.isSaving1=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"objectCollectionIndex",{get:function(){return this.index1},set:function(t){this.index1=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"clonedObject",{get:function(){return this.clonedObject1},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"position",{get:function(){return this.position1},set:function(t){this.position1=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"CrossTable",{get:function(){return this.crossTable},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"converted",{get:function(){return this.bConverted},set:function(t){this.bConverted=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"encode",{get:function(){return this.bForceEncoding},set:function(t){this.bForceEncoding=t},enumerable:!0,configurable:!0}),o.bytesToHex=function(t){if(t==null)return"";var e="";return e},o.prototype.save=function(t){if(t===null)throw new Error("ArgumentNullException : writer");this.encode!==void 0&&this.encode===xl.ForceEncoding.Ascii?t.write(this.pdfEncode()):t.write(o.stringMark[0]+this.value+o.stringMark[1])},o.prototype.pdfEncode=function(){var t="";if(this.encode!==void 0&&this.encode===xl.ForceEncoding.Ascii){for(var e=this.escapeSymbols(this.value),i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);t=o.stringMark[0]+t+o.stringMark[1]}else t=this.value;return t},o.prototype.escapeSymbols=function(t){for(var e=[],i=0;i<t.length;i++){var r=t.charCodeAt(i);switch(r){case 40:case 41:e.push(92),e.push(r);break;case 13:e.push(92),e.push(114);break;case 92:e.push(92),e.push(r);break;default:e.push(r);break}}return e},o.prototype.clone=function(t){if(this.clonedObject1!==null&&this.clonedObject1.CrossTable===t)return this.clonedObject1;this.clonedObject1=null;var e=new o(this.stringValue);return e.bHex=this.bHex,e.crossTable=t,e.isColorSpace=this.isColorSpace,this.clonedObject1=e,e},o.toUnicodeArray=function(t,e){if(t==null)throw new Error("Argument Null Exception : value");for(var i=0,r=[],n=0;n<t.length;n++){var s=t.charCodeAt(n);r.push(s/256>>>0),r.push(s&255)}return r},o.byteToString=function(t){if(t==null)throw new Error("Argument Null Exception : stream");for(var e="",i=0;i<t.length;++i)e+=String.fromCharCode(t[i]);return e},o.stringMark="()",o.hexStringMark="<>",o.hexFormatPattern="{0:X2}",o}(),Bd=function(){function o(t,e){this.index3=-1,this.position3=-1,this.objNumber=0,this.genNumber=0,typeof t=="number"&&typeof e=="number"?(this.objNumber=t,this.genNumber=e):(this.objNumber=Number(t),this.genNumber=Number(e))}return Object.defineProperty(o.prototype,"status",{get:function(){return this.status3},set:function(t){this.status3=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isSaving",{get:function(){return this.isSaving3},set:function(t){this.isSaving3=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"objectCollectionIndex",{get:function(){return this.index3},set:function(t){this.index3=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"position",{get:function(){return this.position3},set:function(t){this.position3=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"clonedObject",{get:function(){var t=null;return t},enumerable:!0,configurable:!0}),o.prototype.save=function(t){t.write(this.toString())},o.prototype.toString=function(){return this.objNumber.toString()+" "+this.genNumber.toString()+" R"},o.prototype.clone=function(t){return null},o}(),Ai=function(){function o(t,e){this.index4=-1,this.position4=-1,this.objectIndex=-1,this.dictionaryProperties=new $i,this.initialize(t)}return Object.defineProperty(o.prototype,"status",{get:function(){return this.status4},set:function(t){this.status4=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isSaving",{get:function(){return this.isSaving4},set:function(t){this.isSaving4=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"objectCollectionIndex",{get:function(){return this.index4},set:function(t){this.index4=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"position",{get:function(){return this.position4},set:function(t){this.position4=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"clonedObject",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"object",{get:function(){return this.primitiveObject},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"reference",{get:function(){return this.pdfReference},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"index",{get:function(){return this.objectIndex},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"element",{get:function(){return this.primitiveObject},enumerable:!0,configurable:!0}),o.prototype.initialize=function(t){if(t instanceof Zi||t instanceof Ei||t instanceof $t||t instanceof It||t instanceof Tr||t instanceof Bd||t instanceof Lr)this.primitiveObject=t;else{var e=t;this.initialize(e.element)}},o.prototype.save=function(t){var e=t.position,i=t.document.crossTable;this.object.isSaving=!0;var r=null;r=i.getReference(this.object),r.save(t)},o.prototype.clone=function(t){var e=null,i=null,r="",n=null;return null},o}(),El;(function(o){o[o.Free=0]="Free",o[o.Normal=1]="Normal",o[o.Packed=2]="Packed"})(El||(El={}));var sE=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Fd=function(o){sE(t,o);function t(){var e=o.call(this)||this;return e.sections=null,e.tempDictionaryProperties=new $i,e.items.setValue(new $i().type,new $t("Catalog")),e}return Object.defineProperty(t.prototype,"pages",{get:function(){return this.sections},set:function(e){var i=e.element;this.sections=e,this.items.setValue(this.tempDictionaryProperties.pages,new Ai(e))},enumerable:!0,configurable:!0}),t}(Ei),h0=function(){function o(){this.objects=new Ii,this.maxGenNumIndex=0,this.objectCount=0,this.dictionaryProperties=new $i}return Object.defineProperty(o.prototype,"isMerging",{get:function(){return this.merging},set:function(t){this.merging=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"trailer",{get:function(){return this.internalTrailer==null&&(this.internalTrailer=new Tr),this.internalTrailer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"document",{get:function(){return this.pdfDocument},set:function(t){this.pdfDocument=t,this.items=this.pdfDocument.pdfObjects},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"pdfObjects",{get:function(){return this.items},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"objectCollection",{get:function(){return this.pdfDocument.pdfObjects},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"count",{get:function(){return this.objectCount},set:function(t){this.objectCount=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"nextObjNumber",{get:function(){return this.count=this.count+1,this.count},enumerable:!0,configurable:!0}),o.prototype.save=function(t,e){this.saveHead(t);var i=!1;this.mappedReferences=null,this.objects.clear(),this.markTrailerReferences(),this.saveObjects(t);var r=this.count,n=t.position;this.registerObject(0,new Bd(0,-1),!0);var s=0;t.write(_e.xref),t.write(_e.newLine),this.saveSections(t),this.saveTrailer(t,this.count,s),this.saveTheEndess(t,n),this.count=r;for(var l=0;l<this.objectCollection.count;++l){var h=this.objectCollection.items(l);h.object.isSaving=!1}if(typeof e=="undefined")return t.stream.buffer;t.stream.save(e)},o.prototype.saveTheEndess=function(t,e){t.write(_e.newLine+_e.startxref+_e.newLine),t.write(e.toString()+_e.newLine),t.write(_e.eof+_e.newLine)},o.prototype.saveTrailer=function(t,e,i){t.write(_e.trailer+_e.newLine);var r=this.trailer;r.items.setValue(this.dictionaryProperties.size,new It(this.objectCount+1)),r=new Ei(r),r.setEncrypt(!1),r.save(t)},o.prototype.saveSections=function(t){var e=0,i=0;do i=this.prepareSubsection(e),this.saveSubsection(t,e,i),e+=i;while(i!==0)},o.prototype.saveSubsection=function(t,e,i){if(!(i<=0||e>=this.count)){var r="{0} {1}{2}";t.write(e+" "+(i+1)+_e.newLine);for(var n=e;n<=e+i;++n){var s=this.objects.getValue(n),l="";s.type===El.Free?l=this.getItem(s.offset,65535,!0):l=this.getItem(s.offset,s.generation,!1),t.write(l)}}},o.prototype.getItem=function(t,e,i){var r="",n=10-t.toString().length;e<=0&&(e=0);for(var s=5-e.toString().length<=0?0:5-e.toString().length,l=0;l<n;l++)r=r+"0";r=r+t.toString()+" ";for(var l=0;l<s;l++)r=r+"0";return r=r+e.toString()+" ",r=r+(i?_e.f:_e.n)+_e.newLine,r},o.prototype.prepareSubsection=function(t){for(var e=0,i,r=this.count,n=0;n<this.document.pdfObjects.count;n++)var s=this.document.pdfObjects.items(n).reference,l=s.toString(),h=l.split(" ");if(t>=r)return e;for(i=t;i<r;++i)break;for(t=i;i<r;++i)++e;return e},o.prototype.markTrailerReferences=function(){var t,e=this.trailer.items.keys(),i=this.trailer.items.values()},o.prototype.saveHead=function(t){var e=this.generateFileVersion(t.document);t.write("%PDF-"+e),t.write(_e.newLine)},o.prototype.generateFileVersion=function(t){var e=4,i="1."+e.toString();return i},o.prototype.getReference=function(t,e){if(typeof e=="undefined"){var i=!1;return this.getReference(t,i)}else return this.getSubReference(t,e)},o.prototype.getSubReference=function(t,e){var i=!1,r,n=null;if(this.items.count>0&&t.objectCollectionIndex>0&&this.items.count>t.objectCollectionIndex-1){var s=this.document.pdfObjects.getReference(t,r);n=s.reference,r=s.wasNew}if(n==null?t.status===Cl.Registered?r=!1:r=!0:r=!1,n==null){var l=this.nextObjNumber;n=new Bd(l,0);var h=void 0;if(r){this.document.pdfObjects.add(t),this.document.pdfObjects.trySetReference(t,n,h);var c=this.document.pdfObjects.count-1,u=this.document.pdfObjects.objectCollections[c].reference.objNumber,p=this.document.pdfObjects.objectCollections[this.document.pdfObjects.count-1];this.document.pdfObjects.mainObjectCollection.setValue(u,p),t.position=-1}else this.document.pdfObjects.trySetReference(t,n,h);t.objectCollectionIndex=n.objNumber,t.status=Cl.None,i=!0}return e=i||this.bForceNew,n},o.prototype.saveObjects=function(t){for(var e=this.objectCollection,i=0;i<e.count;++i){var r=e.items(i),n=r.object;n.isSaving=!0,this.saveIndirectObject(n,t)}},o.prototype.saveIndirectObject=function(t,e){var i=this.getReference(t);t instanceof Fd&&this.trailer.items.setValue(this.dictionaryProperties.root,i),this.pdfDocument.currentSavingObj=i;var r=!1;r=t.getArchive();var n=!(t instanceof Tr||!r||t instanceof Fd),s=!1;this.registerObject(e.position,i),this.doSaveObject(t,i,e)},o.prototype.doSaveObject=function(t,e,i){var r=i.length;i.write(e.objNumber.toString()),i.write(_e.whiteSpace),i.write(e.genNumber.toString()),i.write(_e.whiteSpace),i.write(_e.obj),i.write(_e.newLine),t.save(i);var n=i.stream;i.write(_e.endObj),i.write(_e.newLine)},o.prototype.registerObject=function(t,e,i){typeof i=="boolean"?(this.objects.setValue(e.objNumber,new c0(t,e,i)),this.maxGenNumIndex=Math.max(this.maxGenNumIndex,e.genNumber)):typeof i=="undefined"&&(this.objects.setValue(e.objNumber,new c0(t,e)),this.maxGenNumIndex=Math.max(this.maxGenNumIndex,e.genNumber))},o.dereference=function(t){var e=t;return e!=null&&(t=e.object),t},o}(),c0=function(){function o(t,e,i){var r=t;this.offsetNumber=r;var n=e;this.generation=n.genNumber,this.object=n.objNumber,typeof i=="undefined"?this.type=El.Normal:this.type=El.Free}return Object.defineProperty(o.prototype,"objectNumber",{get:function(){return this.object},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"offset",{get:function(){var t;return t=this.offsetNumber,t},enumerable:!0,configurable:!0}),o}(),oi=function(){function o(t,e){typeof t=="undefined"?(this.x=0,this.y=0):(t!==null?this.x=t:this.x=0,e!==null?this.y=e:this.y=0)}return o}(),St=function(){function o(t,e){typeof e=="undefined"?(this.height=0,this.width=0):(e!==null?this.height=e:this.height=0,t!==null?this.width=t:this.width=0)}return o}(),bi=function(){function o(t,e,i,r){if(typeof t==typeof t&&typeof t=="undefined")this.x=0,this.y=0,this.height=0,this.width=0;else if(t instanceof oi&&e instanceof St&&typeof i=="undefined"){var n=t;this.x=n.x,this.y=n.y;var s=e;this.height=s.height,this.width=s.width}else{var l=t,h=e,c=i,u=r;this.x=l,this.y=h,this.height=u,this.width=c}}return o}(),Hd=function(){function o(t,e,i,r){this.left=t,this.top=e,this.right=i,this.bottom=r}return Object.defineProperty(o.prototype,"width",{get:function(){return this.right-this.left},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"topLeft",{get:function(){return new oi(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"size",{get:function(){return new St(this.width,this.height)},enumerable:!0,configurable:!0}),o.prototype.toString=function(){return this.topLeft+"x"+this.size},o}(),aE=function(){function o(){}return o.letter=new St(612,792),o.note=new St(540,720),o.legal=new St(612,1008),o.a0=new St(2380,3368),o.a1=new St(1684,2380),o.a2=new St(1190,1684),o.a3=new St(842,1190),o.a4=new St(595,842),o.a5=new St(421,595),o.a6=new St(297,421),o.a7=new St(210,297),o.a8=new St(148,210),o.a9=new St(105,148),o.a10=new St(74,105),o.b0=new St(2836,4008),o.b1=new St(2004,2836),o.b2=new St(1418,2004),o.b3=new St(1002,1418),o.b4=new St(709,1002),o.b5=new St(501,709),o.archE=new St(2592,3456),o.archD=new St(1728,2592),o.archC=new St(1296,1728),o.archB=new St(864,1296),o.archA=new St(648,864),o.flsa=new St(612,936),o.halfLetter=new St(396,612),o.letter11x17=new St(792,1224),o.ledger=new St(1224,792),o}(),oE=function(){function o(){this.pdfMargin=40,this.setMargins(this.pdfMargin)}return Object.defineProperty(o.prototype,"left",{get:function(){return this.leftMargin},set:function(t){this.leftMargin=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"top",{get:function(){return this.topMargin},set:function(t){this.topMargin=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"right",{get:function(){return this.rightMargin},set:function(t){this.rightMargin=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"bottom",{get:function(){return this.bottomMargin},set:function(t){this.bottomMargin=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"all",{set:function(t){this.setMargins(t)},enumerable:!0,configurable:!0}),o.prototype.setMargins=function(t,e,i,r){typeof e=="undefined"?this.leftMargin=this.topMargin=this.rightMargin=this.bottomMargin=t:typeof i=="undefined"?(this.leftMargin=this.rightMargin=t,this.bottomMargin=this.topMargin=e):(this.leftMargin=t,this.topMargin=e,this.rightMargin=i,this.bottomMargin=r)},o.prototype.clone=function(){return this},o}(),lE=function(){function o(t){this.pageMargins=new oE,this.pageSize=aE.a4,this.rotateAngle=Pd.RotateAngle0,this.pageOrientation=fa.Portrait,this.pageOrigin=new oi(0,0),this.isRotation=!1,typeof t=="number"&&this.pageMargins.setMargins(t)}return Object.defineProperty(o.prototype,"size",{get:function(){return this.pageSize},set:function(t){this.setSize(t)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"orientation",{get:function(){return this.pageOrientation},set:function(t){this.pageOrientation!==t&&(this.pageOrientation=t,this.updateSize(t))},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"margins",{get:function(){return this.pageMargins},set:function(t){this.pageMargins=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"width",{get:function(){return this.pageSize.width},set:function(t){this.pageSize.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this.pageSize.height},set:function(t){this.pageSize.height=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"origin",{get:function(){return this.pageOrigin},set:function(t){this.pageOrigin=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"rotate",{get:function(){return this.rotateAngle},set:function(t){this.rotateAngle=t,this.isRotation=!0},enumerable:!0,configurable:!0}),o.prototype.updateSize=function(t){var e=Math.min(this.pageSize.width,this.pageSize.height),i=Math.max(this.pageSize.width,this.pageSize.height);switch(t){case fa.Portrait:this.pageSize=new St(e,i);break;case fa.Landscape:this.pageSize=new St(i,e);break}},o.prototype.clone=function(){var t=this;return t.pageMargins=this.pageMargins.clone(),t},o.prototype.getActualSize=function(){var t=this.width-(this.margins.left+this.margins.right),e=this.height-(this.margins.top+this.margins.bottom),i=new St(t,e);return i},o.prototype.setSize=function(t){var e=Math.min(t.width,t.height),i=Math.max(t.width,t.height);this.orientation===fa.Portrait?this.pageSize=new St(e,i):this.pageSize=new St(i,e)},o}(),u0;(function(o){o[o.Left=0]="Left",o[o.Center=1]="Center",o[o.Right=2]="Right"})(u0||(u0={}));var Ms;(function(o){o[o.Top=0]="Top",o[o.Middle=1]="Middle",o[o.Bottom=2]="Bottom"})(Ms||(Ms={}));var wn;(function(o){o[o.Left=0]="Left",o[o.Center=1]="Center",o[o.Right=2]="Right",o[o.Justify=3]="Justify"})(wn||(wn={}));var ns;(function(o){o[o.Fill=0]="Fill",o[o.Stroke=1]="Stroke",o[o.FillStroke=2]="FillStroke",o[o.None=3]="None",o[o.ClipFlag=4]="ClipFlag",o[o.ClipFill=4]="ClipFill",o[o.ClipStroke=5]="ClipStroke",o[o.ClipFillStroke=6]="ClipFillStroke",o[o.Clip=7]="Clip"})(ns||(ns={}));var p0;(function(o){o[o.Miter=0]="Miter",o[o.Round=1]="Round",o[o.Bevel=2]="Bevel"})(p0||(p0={}));var d0;(function(o){o[o.Flat=0]="Flat",o[o.Round=1]="Round",o[o.Square=2]="Square"})(d0||(d0={}));var Nn;(function(o){o[o.Solid=0]="Solid",o[o.Dash=1]="Dash",o[o.Dot=2]="Dot",o[o.DashDot=3]="DashDot",o[o.DashDotDot=4]="DashDotDot",o[o.Custom=5]="Custom"})(Nn||(Nn={}));var so;(function(o){o[o.Winding=0]="Winding",o[o.Alternate=1]="Alternate"})(so||(so={}));var Ri;(function(o){o[o.Rgb=0]="Rgb",o[o.Cmyk=1]="Cmyk",o[o.GrayScale=2]="GrayScale",o[o.Indexed=3]="Indexed"})(Ri||(Ri={}));var xc;(function(o){o[o.Normal=0]="Normal",o[o.Multiply=1]="Multiply",o[o.Screen=2]="Screen",o[o.Overlay=3]="Overlay",o[o.Darken=4]="Darken",o[o.Lighten=5]="Lighten",o[o.ColorDodge=6]="ColorDodge",o[o.ColorBurn=7]="ColorBurn",o[o.HardLight=8]="HardLight",o[o.SoftLight=9]="SoftLight",o[o.Difference=10]="Difference",o[o.Exclusion=11]="Exclusion",o[o.Hue=12]="Hue",o[o.Saturation=13]="Saturation",o[o.Color=14]="Color",o[o.Luminosity=15]="Luminosity"})(xc||(xc={}));var ao;(function(o){o[o.Centimeter=0]="Centimeter",o[o.Pica=1]="Pica",o[o.Pixel=2]="Pixel",o[o.Point=3]="Point",o[o.Inch=4]="Inch",o[o.Document=5]="Document",o[o.Millimeter=6]="Millimeter"})(ao||(ao={}));var f0;(function(o){o[o.Fit=0]="Fit",o[o.Center=1]="Center",o[o.Stretch=2]="Stretch",o[o.Tile=3]="Tile"})(f0||(f0={}));var Bn;(function(o){o[o.None=0]="None",o[o.LeftToRight=1]="LeftToRight",o[o.RightToLeft=2]="RightToLeft"})(Bn||(Bn={}));var Mi;(function(o){o[o.Regular=0]="Regular",o[o.Bold=1]="Bold",o[o.Italic=2]="Italic",o[o.Underline=4]="Underline",o[o.Strikeout=8]="Strikeout"})(Mi||(Mi={}));var Br;(function(o){o[o.Helvetica=0]="Helvetica",o[o.Courier=1]="Courier",o[o.TimesRoman=2]="TimesRoman",o[o.Symbol=3]="Symbol",o[o.ZapfDingbats=4]="ZapfDingbats"})(Br||(Br={}));var v0;(function(o){o[o.Standard=0]="Standard",o[o.TrueType=1]="TrueType",o[o.TrueTypeEmbedded=2]="TrueTypeEmbedded"})(v0||(v0={}));var Fn;(function(o){o[o.None=0]="None",o[o.Word=1]="Word",o[o.WordOnly=2]="WordOnly",o[o.Character=3]="Character"})(Fn||(Fn={}));var Ps;(function(o){o[o.None=0]="None",o[o.SuperScript=1]="SuperScript",o[o.SubScript=2]="SubScript"})(Ps||(Ps={}));var Vd;(function(o){o[o.Unknown=0]="Unknown",o[o.StandardEncoding=1]="StandardEncoding",o[o.MacRomanEncoding=2]="MacRomanEncoding",o[o.MacExpertEncoding=3]="MacExpertEncoding",o[o.WinAnsiEncoding=4]="WinAnsiEncoding",o[o.PdfDocEncoding=5]="PdfDocEncoding",o[o.IdentityH=6]="IdentityH"})(Vd||(Vd={}));var Al;(function(o){o[o.Apple=0]="Apple",o[o.Microsoft=4]="Microsoft",o[o.Trimmed=6]="Trimmed"})(Al||(Al={}));var Fr;(function(o){o[o.Unknown=0]="Unknown",o[o.Symbol=1]="Symbol",o[o.Unicode=2]="Unicode",o[o.Macintosh=3]="Macintosh"})(Fr||(Fr={}));var va;(function(o){o[o.AppleUnicode=0]="AppleUnicode",o[o.Macintosh=1]="Macintosh",o[o.Iso=2]="Iso",o[o.Microsoft=3]="Microsoft"})(va||(va={}));var Ec;(function(o){o[o.Undefined=0]="Undefined",o[o.Unicode=1]="Unicode"})(Ec||(Ec={}));var zd;(function(o){o[o.Roman=0]="Roman",o[o.Japanese=1]="Japanese",o[o.Chinese=2]="Chinese"})(zd||(zd={}));var ma;(function(o){o[o.FixedPitch=1]="FixedPitch",o[o.Serif=2]="Serif",o[o.Symbolic=4]="Symbolic",o[o.Script=8]="Script",o[o.Nonsymbolic=32]="Nonsymbolic",o[o.Italic=64]="Italic",o[o.ForceBold=262144]="ForceBold"})(ma||(ma={}));var ga;(function(o){o[o.Arg1And2AreWords=1]="Arg1And2AreWords",o[o.ArgsAreXyValues=2]="ArgsAreXyValues",o[o.RoundXyToGrid=4]="RoundXyToGrid",o[o.WeHaveScale=8]="WeHaveScale",o[o.Reserved=16]="Reserved",o[o.MoreComponents=32]="MoreComponents",o[o.WeHaveAnXyScale=64]="WeHaveAnXyScale",o[o.WeHaveTwoByTwo=128]="WeHaveTwoByTwo",o[o.WeHaveInstructions=256]="WeHaveInstructions",o[o.UseMyMetrics=512]="UseMyMetrics"})(ga||(ga={}));var m0=function(){function o(t){if(t==null)throw new Error("ArgumentNullException:stream");this.stream=t}return o.prototype.clear=function(){this.stream.clearStream()},o.prototype.setGraphicsState=function(t){t instanceof $t?(this.stream.write(t.toString()),this.stream.write(_e.whiteSpace),this.writeOperator(_e.setGraphicsState)):(this.stream.write(_e.slash),this.stream.write(t),this.stream.write(_e.whiteSpace),this.writeOperator(_e.setGraphicsState))},o.prototype.executeObject=function(t){this.stream.write(t.toString()),this.stream.write(_e.whiteSpace),this.writeOperator(_e.paintXObject),this.stream.write(_e.newLine)},o.prototype.closePath=function(){this.writeOperator(_e.closePath)},o.prototype.clipPath=function(t){this.stream.write(_e.clipPath),t&&this.stream.write(_e.evenOdd),this.stream.write(_e.whiteSpace),this.stream.write(_e.endPath),this.stream.write(_e.newLine)},o.prototype.closeFillStrokePath=function(t){this.stream.write(_e.closeFillStrokePath),t?(this.stream.write(_e.evenOdd),this.stream.write(_e.newLine)):this.stream.write(_e.newLine)},o.prototype.fillStrokePath=function(t){this.stream.write(_e.fillStroke),t?(this.stream.write(_e.evenOdd),this.stream.write(_e.newLine)):this.stream.write(_e.newLine)},o.prototype.fillPath=function(t){this.stream.write(_e.fill),t?(this.stream.write(_e.evenOdd),this.stream.write(_e.newLine)):this.stream.write(_e.newLine)},o.prototype.endPath=function(){this.writeOperator(_e.n)},o.prototype.closeFillPath=function(t){this.writeOperator(_e.closePath),this.stream.write(_e.fill),t?(this.stream.write(_e.evenOdd),this.stream.write(_e.newLine)):this.stream.write(_e.newLine)},o.prototype.closeStrokePath=function(){this.writeOperator(_e.closeStrokePath)},o.prototype.setTextScaling=function(t){this.stream.write(It.floatToString(t)),this.stream.write(_e.whiteSpace),this.writeOperator(_e.setTextScaling)},o.prototype.strokePath=function(){this.writeOperator(_e.stroke)},o.prototype.restoreGraphicsState=function(){this.writeOperator(_e.restoreState)},o.prototype.saveGraphicsState=function(){this.writeOperator(_e.saveState)},o.prototype.startNextLine=function(t,e){typeof t=="undefined"?this.writeOperator(_e.goToNextLine):t instanceof oi?(this.writePoint(t),this.writeOperator(_e.setCoords)):(this.writePoint(t,e),this.writeOperator(_e.setCoords))},o.prototype.showText=function(t){this.checkTextParam(t),this.writeText(t),this.writeOperator(_e.setText)},o.prototype.setLeading=function(t){this.stream.write(It.floatToString(t)),this.stream.write(_e.whiteSpace),this.writeOperator(_e.setTextLeading)},o.prototype.beginPath=function(t,e){this.writePoint(t,e),this.writeOperator(_e.beginPath)},o.prototype.beginText=function(){this.writeOperator(_e.beginText)},o.prototype.endText=function(){this.writeOperator(_e.endText)},o.prototype.appendRectangle=function(t,e,i,r){t instanceof bi?this.appendRectangle(t.x,t.y,t.width,t.height):(this.writePoint(t,e),this.writePoint(i,r),this.writeOperator(_e.appendRectangle))},o.prototype.appendLineSegment=function(t,e){t instanceof oi?this.appendLineSegment(t.x,t.y):(this.writePoint(t,e),this.writeOperator(_e.appendLineSegment))},o.prototype.setTextRenderingMode=function(t){this.stream.write(t.toString()),this.stream.write(_e.whiteSpace),this.writeOperator(_e.setRenderingMode)},o.prototype.setCharacterSpacing=function(t){this.stream.write(It.floatToString(t)),this.stream.write(_e.whiteSpace),this.stream.write(_e.setCharacterSpace),this.stream.write(_e.newLine)},o.prototype.setWordSpacing=function(t){this.stream.write(It.floatToString(t)),this.stream.write(_e.whiteSpace),this.writeOperator(_e.setWordSpace)},o.prototype.showNextLineText=function(t,e){t instanceof Lr?(this.checkTextParam(t),this.writeText(t),this.writeOperator(_e.setTextOnNewLine)):(this.checkTextParam(t),this.writeText(t,e),this.writeOperator(_e.setTextOnNewLine))},o.prototype.setColorSpace=function(t,e){if(t instanceof $t&&typeof e=="boolean"){var i=t,r=e,n=r?_e.selectcolorspaceforstroking:_e.selectcolorspacefornonstroking;this.stream.write(i.toString()),this.stream.write(_e.whiteSpace),this.stream.write(n),this.stream.write(_e.newLine)}else{var i=t,r=e;this.setColorSpace(new $t(i),r)}},o.prototype.modifyCtm=function(t){if(t==null)throw new Error("ArgumentNullException:matrix");this.stream.write(t.toString()),this.stream.write(_e.whiteSpace),this.writeOperator(_e.modifyCtm)},o.prototype.setFont=function(t,e,i){if(typeof e=="string")this.setFont(t,new $t(e),i);else{if(t==null)throw new Error("ArgumentNullException:font");this.stream.write(e.toString()),this.stream.write(_e.whiteSpace),this.stream.write(It.floatToString(i)),this.stream.write(_e.whiteSpace),this.writeOperator(_e.setFont)}},o.prototype.writeOperator=function(t){this.stream.write(t),this.stream.write(_e.newLine)},o.prototype.checkTextParam=function(t){if(t==null)throw new Error("ArgumentNullException:text");if(typeof t=="string"&&t==="")throw new Error("ArgumentException:The text can not be an empty string, text")},o.prototype.writeText=function(t,e){if(t instanceof Lr&&typeof e=="undefined")this.stream.write(t.pdfEncode());else{var i=void 0,r=void 0;e?(i=Lr.hexStringMark[0],r=Lr.hexStringMark[1]):(i=Lr.stringMark[0],r=Lr.stringMark[1]),this.stream.write(i),this.stream.write(t),this.stream.write(r)}},o.prototype.writePoint=function(t,e){if(t instanceof oi&&typeof e=="undefined")this.writePoint(t.x,t.y);else{var i=t;this.stream.write(It.floatToString(i)),this.stream.write(_e.whiteSpace),e=this.updateY(e),this.stream.write(It.floatToString(e)),this.stream.write(_e.whiteSpace)}},o.prototype.updateY=function(t){return-t},o.prototype.write=function(t){var e="";e+=t,e+=_e.newLine,this.writeOperator(e)},o.prototype.writeComment=function(t){if(t!=null&&t.length>0){var e="";e+=_e.comment,e+=_e.whiteSpace,e+=t,this.writeOperator(e)}else throw new Error("Invalid comment")},o.prototype.setColorAndSpace=function(t,e,i){t.isEmpty||(this.stream.write(t.toString(e,i)),this.stream.write(_e.newLine))},o.prototype.setLineDashPattern=function(t,e){this.setLineDashPatternHelper(t,e)},o.prototype.setLineDashPatternHelper=function(t,e){var i="[";if(t.length>1)for(var r=0;r<t.length;r++)r===t.length-1?i+=t[r].toString():i+=t[r].toString()+" ";i+="] ",i+=e.toString(),i+=" "+_e.setDashPattern,this.stream.write(i),this.stream.write(_e.newLine)},o.prototype.setMiterLimit=function(t){this.stream.write(It.floatToString(t)),this.stream.write(_e.whiteSpace),this.writeOperator(_e.setMiterLimit)},o.prototype.setLineWidth=function(t){this.stream.write(It.floatToString(t)),this.stream.write(_e.whiteSpace),this.writeOperator(_e.setLineWidth)},o.prototype.setLineCap=function(t){this.stream.write(t.toString()),this.stream.write(_e.whiteSpace),this.writeOperator(_e.setLineCapStyle)},o.prototype.setLineJoin=function(t){this.stream.write(t.toString()),this.stream.write(_e.whiteSpace),this.writeOperator(_e.setLineJoinStyle)},Object.defineProperty(o.prototype,"position",{get:function(){return this.stream.position},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"length",{get:function(){var t=0;if(this.stream.data.length!==0&&this.stream.data.length!==-1)for(var e=0;e<this.stream.data.length;e++)t+=this.stream.data[e].length;return t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"document",{get:function(){return null},enumerable:!0,configurable:!0}),o.prototype.appendBezierSegment=function(t,e,i,r,n,s){t instanceof oi&&e instanceof oi&&i instanceof oi?(this.writePoint(t.x,t.y),this.writePoint(e.x,e.y),this.writePoint(i.x,i.y)):(this.writePoint(t,e),this.writePoint(i,r),this.writePoint(n,s)),this.writeOperator(_e.appendbeziercurve)},o.prototype.setColourWithPattern=function(t,e,i){if(t!=null){var r=t.length,n=0;for(n=0;n<r;++n)this.stream.write(t[n].toString()),this.stream.write(_e.whiteSpace)}e!=null&&(this.stream.write(e.toString()),this.stream.write(_e.whiteSpace)),i?this.writeOperator(_e.setColorAndPatternStroking):this.writeOperator(_e.setColorAndPattern)},o}(),ya=function(){function o(t,e,i,r){typeof t=="undefined"?typeof e!="undefined"&&typeof i!="undefined"&&typeof r!="undefined"?this.assignRGB(e,i,r):this.filled=!1:t instanceof o?(this.redColor=t.r,this.greenColor=t.g,this.blueColor=t.b,this.grayColor=t.gray,this.alpha=t.alpha,this.filled=this.alpha!==0):typeof t=="number"&&typeof e=="undefined"&&typeof i=="undefined"&&typeof r=="undefined"?(t<0&&(t=0),t>1&&(t=1),this.redColor=t*o.maxColourChannelValue,this.greenColor=t*o.maxColourChannelValue,this.blueColor=t*o.maxColourChannelValue,this.cyanColor=t,this.magentaColor=t,this.yellowColor=t,this.blackColor=t,this.grayColor=t,this.alpha=o.maxColourChannelValue,this.filled=!0):typeof r=="undefined"?this.assignRGB(t,e,i):this.assignRGB(e,i,r,t)}return o.prototype.assignRGB=function(t,e,i,r){typeof t=="undefined"||typeof e=="undefined"||typeof i=="undefined"?this.filled=!1:(this.cyanColor=0,this.magentaColor=0,this.yellowColor=0,this.blackColor=0,this.grayColor=0,this.redColor=t,this.greenColor=e,this.blueColor=i,typeof r=="undefined"?this.alpha=o.maxColourChannelValue:this.alpha=r,this.filled=!0,this.assignCMYK(t,e,i))},o.prototype.assignCMYK=function(t,e,i){var r=t/o.maxColourChannelValue,n=e/o.maxColourChannelValue,s=i/o.maxColourChannelValue,l=It.min(1-r,1-n,1-s),h=l===1?0:(1-r-l)/(1-l),c=l===1?0:(1-n-l)/(1-l),u=l===1?0:(1-s-l)/(1-l);this.blackColor=l,this.cyanColor=h,this.magentaColor=c,this.yellowColor=u},Object.defineProperty(o.prototype,"r",{get:function(){return this.redColor},set:function(t){this.redColor=t,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"red",{get:function(){return this.r/o.maxColourChannelValue},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"b",{get:function(){return this.blueColor},set:function(t){this.blueColor=t,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"blue",{get:function(){return this.b/o.maxColourChannelValue},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"c",{get:function(){return this.cyanColor},set:function(t){t<0?this.cyanColor=0:t>1?this.cyanColor=1:this.cyanColor=t,this.assignRGB(this.cyanColor,this.magentaColor,this.yellowColor,this.blackColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"k",{get:function(){return this.blackColor},set:function(t){t<0?this.blackColor=0:t>1?this.blackColor=1:this.blackColor=t,this.assignRGB(this.cyanColor,this.magentaColor,this.yellowColor,this.blackColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"m",{get:function(){return this.magentaColor},set:function(t){t<0?this.magentaColor=0:t>1?this.magentaColor=1:this.magentaColor=t,this.assignRGB(this.cyanColor,this.magentaColor,this.yellowColor,this.blackColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"y",{get:function(){return this.yellowColor},set:function(t){t<0?this.yellowColor=0:t>1?this.yellowColor=1:this.yellowColor=t,this.assignRGB(this.cyanColor,this.magentaColor,this.yellowColor,this.blackColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"g",{get:function(){return this.greenColor},set:function(t){this.greenColor=t,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"green",{get:function(){return this.g/o.maxColourChannelValue},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"gray",{get:function(){return(this.redColor+this.greenColor+this.blueColor)/(o.maxColourChannelValue*3)},set:function(t){t<0?this.grayColor=0:t>1?this.grayColor=1:this.grayColor=t,this.r=this.grayColor*o.maxColourChannelValue,this.g=this.grayColor*o.maxColourChannelValue,this.b=this.grayColor*o.maxColourChannelValue,this.assignCMYK(this.redColor,this.greenColor,this.blueColor),this.filled=!0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isEmpty",{get:function(){return!this.filled},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"a",{get:function(){return this.alpha},set:function(t){t<0?this.alpha=0:this.alpha=t,this.filled=!0},enumerable:!0,configurable:!0}),o.prototype.toString=function(t,e){if(this.isEmpty)return"";var i="";switch(t){case Ri.Rgb:i=this.rgbToString(e);break;case Ri.GrayScale:i=this.grayScaleToString(e);break;case Ri.Cmyk:i=this.cmykToString(e);break}return i},o.prototype.grayScaleToString=function(t){var e=this.gray,i="",r=null;return r=t?o.grayStringsSroke.containsKey(e)?o.grayStringsSroke.getValue(e):null:o.grayStringsFill.containsKey(e)?o.grayStringsFill.getValue(e):null,r==null?t&&(i=e.toString()+" G",o.grayStringsSroke.setValue(e,i)):i=r.toString(),i+_e.newLine},o.prototype.rgbToString=function(t){var e=this.r,i=this.g,r=this.b,n=(e<<16)+(i<<8)+r;t&&(n+=1<<24);var s="",l=null;if(o.rgbStrings.containsKey(n)&&(l=o.rgbStrings.getValue(n)),l==null){var h=e/o.maxColourChannelValue,c=i/o.maxColourChannelValue,u=r/o.maxColourChannelValue;t?s=h.toString()+" "+c.toString()+" "+u.toString()+" RG":s=h.toString()+" "+c.toString()+" "+u.toString()+" rg",o.rgbStrings.setValue(n,s)}else s=l.toString();return s+_e.newLine},o.prototype.cmykToString=function(t){var e=this.c,i=this.m,r=this.y,n=this.b,s="";return s=e.toString()+" "+i.toString()+" "+r.toString()+" "+n.toString()+" K",s+_e.newLine},o.prototype.toArray=function(t){var e=new Zi;switch(t){case Ri.Rgb:e.add(new It(this.red)),e.add(new It(this.green)),e.add(new It(this.blue));break}return e},o.rgbStrings=new Ii,o.grayStringsSroke=new Ii,o.grayStringsFill=new Ii,o.maxColourChannelValue=255,o}(),ba=function(){function o(){}return o.prototype.clone=function(){return this},o}(),hE=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),oo=function(o){hE(t,o);function t(e){var i=o.call(this)||this;return i.pdfColor=e,i}return Object.defineProperty(t.prototype,"color",{get:function(){return this.pdfColor},set:function(e){this.pdfColor=e},enumerable:!0,configurable:!0}),t.prototype.monitorChanges=function(e,i,r,n,s){if(i==null)throw new Error("ArgumentNullException:streamWriter");var l=!1;if(e==null)return l=!0,i.setColorAndSpace(this.pdfColor,s,!1),l;var h=e;return l=!0,i.setColorAndSpace(this.pdfColor,s,!1),l},t.prototype.resetChanges=function(e){e.setColorAndSpace(new ya(0,0,0),Ri.Rgb,!1)},t}(ba),Ac=function(){function o(t,e){this.pdfColor=new ya(0,0,0),this.dashOffsetValue=0,this.penDashPattern=[0],this.pdfDashStyle=Nn.Solid,this.pdfLineCap=0,this.pdfLineJoin=0,this.penWidth=1,this.internalMiterLimit=0,this.colorSpace=Ri.Rgb,t instanceof ba?this.setBrush(t):t instanceof ya&&(this.color=t),typeof e=="number"&&(this.width=e)}return Object.defineProperty(o.prototype,"color",{get:function(){return this.pdfColor},set:function(t){this.pdfColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dashOffset",{get:function(){return typeof this.dashOffsetValue=="undefined"||this.dashOffsetValue==null?0:this.dashOffsetValue},set:function(t){this.dashOffsetValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dashPattern",{get:function(){return this.penDashPattern},set:function(t){this.penDashPattern=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dashStyle",{get:function(){return this.pdfDashStyle},set:function(t){if(this.pdfDashStyle!==t)switch(this.pdfDashStyle=t,this.pdfDashStyle){case Nn.Custom:break;case Nn.Dash:this.penDashPattern=[3,1];break;case Nn.Dot:this.penDashPattern=[1,1];break;case Nn.DashDot:this.penDashPattern=[3,1,1,1];break;case Nn.DashDotDot:this.penDashPattern=[3,1,1,1,1,1];break;case Nn.Solid:break;default:this.pdfDashStyle=Nn.Solid,this.penDashPattern=[0];break}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lineCap",{get:function(){return this.pdfLineCap},set:function(t){this.pdfLineCap=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lineJoin",{get:function(){return this.pdfLineJoin},set:function(t){this.pdfLineJoin=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"miterLimit",{get:function(){return this.internalMiterLimit},set:function(t){this.internalMiterLimit=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"width",{get:function(){return this.penWidth},set:function(t){this.penWidth=t},enumerable:!0,configurable:!0}),o.prototype.clone=function(){var t=this;return t},o.prototype.setBrush=function(t){var e=t;e!=null&&e instanceof oo&&(this.color=e.color,this.pdfBrush=e),this.color=e.color,this.pdfBrush=e},o.prototype.monitorChanges=function(t,e,i,r,n,s){var l=!1;r=!0,t==null&&(l=!0),l=this.dashControl(t,r,e),e.setLineWidth(this.width),e.setLineJoin(this.lineJoin),e.setLineCap(this.lineCap);var h=this.miterLimit;h>0&&(e.setMiterLimit(h),l=!0);var c=this.pdfBrush;return e.setColorAndSpace(this.color,n,!0),l=!0,l},o.prototype.dashControl=function(t,e,i){e=!0;var r=this.width,n=this.getPattern();return i.setLineDashPattern(n,this.dashOffset*r),e},o.prototype.getPattern=function(){for(var t=this.dashPattern,e=0;e<t.length;++e)t[e]*=this.width;return t},o}(),Tc=function(){function o(t,e){this.scalingFactor=100,this.wordWrapType=Fn.Word,this.internalLineLimit=!0,this.wordWrapType=Fn.Word,typeof t!="undefined"&&typeof t!="string"&&(this.textAlignment=t),typeof e!="undefined"&&(this.verticalAlignment=e)}return Object.defineProperty(o.prototype,"alignment",{get:function(){return this.textAlignment},set:function(t){this.textAlignment=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"textDirection",{get:function(){return this.direction},set:function(t){this.direction=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lineAlignment",{get:function(){return typeof this.verticalAlignment=="undefined"||this.verticalAlignment==null?Ms.Top:this.verticalAlignment},set:function(t){this.verticalAlignment=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"rightToLeft",{get:function(){return typeof this.isRightToLeft=="undefined"||this.isRightToLeft==null?!1:this.isRightToLeft},set:function(t){this.isRightToLeft=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"characterSpacing",{get:function(){return typeof this.internalCharacterSpacing=="undefined"||this.internalCharacterSpacing==null?0:this.internalCharacterSpacing},set:function(t){this.internalCharacterSpacing=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"wordSpacing",{get:function(){return typeof this.internalWordSpacing=="undefined"||this.internalWordSpacing==null?0:this.internalWordSpacing},set:function(t){this.internalWordSpacing=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lineSpacing",{get:function(){return typeof this.leading=="undefined"||this.leading==null?0:this.leading},set:function(t){this.leading=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"clipPath",{get:function(){return typeof this.clip=="undefined"||this.clip==null?!1:this.clip},set:function(t){this.clip=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"subSuperScript",{get:function(){return typeof this.pdfSubSuperScript=="undefined"||this.pdfSubSuperScript==null?Ps.None:this.pdfSubSuperScript},set:function(t){this.pdfSubSuperScript=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"paragraphIndent",{get:function(){return typeof this.internalParagraphIndent=="undefined"||this.internalParagraphIndent==null?0:this.internalParagraphIndent},set:function(t){this.internalParagraphIndent=t,this.firstLineIndent=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lineLimit",{get:function(){return this.internalLineLimit},set:function(t){this.internalLineLimit=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"measureTrailingSpaces",{get:function(){return typeof this.trailingSpaces=="undefined"||this.trailingSpaces==null?!1:this.trailingSpaces},set:function(t){this.trailingSpaces=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"noClip",{get:function(){return typeof this.isNoClip=="undefined"||this.isNoClip==null?!1:this.isNoClip},set:function(t){this.isNoClip=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"wordWrap",{get:function(){return this.wordWrapType},set:function(t){this.wordWrapType=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"horizontalScalingFactor",{get:function(){return this.scalingFactor},set:function(t){if(t<=0)throw new Error("ArgumentOutOfRangeException:The scaling factor cant be less of equal to zero, ScalingFactor");this.scalingFactor=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"firstLineIndent",{get:function(){return typeof this.initialLineIndent=="undefined"||this.initialLineIndent==null?0:this.initialLineIndent},set:function(t){this.initialLineIndent=t},enumerable:!0,configurable:!0}),o.prototype.clone=function(){var t=this;return t},o}(),kr=function(){function o(t){if(this.currentPosition=0,t==null)throw new Error("ArgumentNullException:text");this.text=t}return Object.defineProperty(o.prototype,"length",{get:function(){return this.text.length},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"end",{get:function(){return this.currentPosition===this.text.length},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"position",{get:function(){return this.currentPosition},set:function(t){this.currentPosition=t},enumerable:!0,configurable:!0}),o.getCharsCount=function(t,e){if(typeof e=="string"){if(t==null)throw new Error("ArgumentNullException:wholeText");for(var i=0,r=0;r=t.indexOf(e,r),r!==-1;)i++,r++;return i}else{if(t==null)throw new Error("ArgumentNullException:text");if(e==null)throw new Error("ArgumentNullException:symbols");for(var n=0,s=0,l=t.length;s<l;s++){var h=t[s];this.contains(e,h)&&n++}return n}},o.prototype.readLine=function(){for(var t=this.currentPosition;t<this.length;){var e=this.text[t];switch(e){case"\r":case`
`:{var i=this.text.substr(this.currentPosition,t-this.currentPosition);return this.currentPosition=t+1,e==="\r"&&this.currentPosition<this.length&&this.text[this.currentPosition]===`
`&&this.currentPosition++,i}}t++}if(t>this.currentPosition){var r=this.text.substr(this.currentPosition,t-this.currentPosition);return this.currentPosition=t,r}return null},o.prototype.peekLine=function(){var t=this.currentPosition,e=this.readLine();return this.currentPosition=t,e},o.prototype.readWord=function(){for(var t=this.currentPosition;t<this.length;){var e=this.text[t];switch(e){case"\r":case`
`:var i=this.text.substr(this.currentPosition,t-this.currentPosition);return this.currentPosition=t+1,e==="\r"&&this.currentPosition<this.length&&this.text[this.currentPosition]===`
`&&this.currentPosition++,i;case" ":case"	":{t===this.currentPosition&&t++;var r=this.text.substr(this.currentPosition,t-this.currentPosition);return this.currentPosition=t,r}}t++}if(t>this.currentPosition){var n=this.text.substr(this.currentPosition,t-this.currentPosition);return this.currentPosition=t,n}return null},o.prototype.peekWord=function(){var t=this.currentPosition,e=this.readWord();return this.currentPosition=t,e},o.prototype.read=function(t){if(typeof t=="undefined"){var e="0";return this.end||(e=this.text[this.currentPosition],this.currentPosition++),e}else{for(var i=0,r="";!this.end&&i<t;){var e=this.read();r=r+e,i++}return r}},o.prototype.peek=function(){var t="0";return this.end||(t=this.text[this.currentPosition]),t},o.prototype.close=function(){this.text=null},o.prototype.readToEnd=function(){var t;return this.currentPosition===0?t=this.text:t=this.text.substr(this.currentPosition,this.length-this.currentPosition),this.currentPosition=this.length,t},o.contains=function(t,e){for(var i=!1,r=0;r<t.length;r++)if(t[r]===e){i=!0;break}return i},o.whiteSpace=" ",o.tab="	",o.spaces=[o.whiteSpace,o.tab],o.whiteSpacePattern="^[ 	]+$",o}(),_d=function(){function o(){this.isOverloadWithPosition=!1}return o.prototype.layout=function(t,e,i,r,n,s,l){if(r instanceof bi){this.initialize(t,e,i,r,n),this.isOverloadWithPosition=s,this.clientSize=l;var h=this.doLayout();return this.clear(),h}else{this.initialize(t,e,i,r),this.isOverloadWithPosition=n,this.clientSize=s;var h=this.doLayout();return this.clear(),h}},o.prototype.initialize=function(t,e,i,r,n){if(typeof n=="number"){if(t==null)throw new Error("ArgumentNullException:text");if(e==null)throw new Error("ArgumentNullException:font");this.text=t,this.font=e,this.format=i,this.size=new St(r.width,r.height),this.rectangle=r,this.pageHeight=n,this.reader=new kr(t)}else this.initialize(t,e,i,new bi(new oi(0,0),r),0)},o.prototype.clear=function(){this.font=null,this.format=null,this.reader.close(),this.reader=null,this.text=null},o.prototype.doLayout=function(){for(var t=new jd,e=new jd,i=[],r=this.reader.peekLine(),n=this.getLineIndent(!0);r!=null;){if(e=this.layoutLine(r,n),e!==null||typeof e!="undefined"){var s=0,l=this.copyToResult(t,e,i,s),h=l.success;if(s=l.numInserted,!h){this.reader.read(s);break}}this.reader.readLine(),r=this.reader.peekLine(),n=this.getLineIndent(!1)}return this.finalizeResult(t,i),t},o.prototype.getLineIndent=function(t){var e=0;return this.format!=null&&(e=t?this.format.firstLineIndent:this.format.paragraphIndent,e=this.size.width>0?Math.min(this.size.width,e):e),e},o.prototype.getLineHeight=function(){var t=this.font.height;return this.format!=null&&this.format.lineSpacing!==0&&(t=this.format.lineSpacing+this.font.height),t},o.prototype.getLineWidth=function(t){var e=this.font.getLineWidth(t,this.format);return e},o.prototype.layoutLine=function(t,e){var i=new jd;i.layoutLineHeight=this.getLineHeight();var r=[],n=this.size.width,s=this.getLineWidth(t)+e,l=an.FirstParagraphLine,h=!0;if(n<=0||Math.round(s)<=Math.round(n))this.addToLineResult(i,r,t,s,an.NewLineBreak|l);else{var c="",u="";s=e;var p=e,f=new kr(t),g=f.peekWord(),C=!1;for(g.length!==f.length&&g===" "&&(u=u+g,c=c+g,f.position+=1,g=f.peekWord());g!=null;){u=u+g;var L=this.getLineWidth(u.toString())+p;if(u.toString()===" "&&(u="",L=0),L>n){if(this.getWrapType()===Fn.None)break;if(u.length===g.length)if(this.getWrapType()===Fn.WordOnly){i.textRemainder=t.substring(f.position);break}else if(u.length===1){c=c+g;break}else{h=!1,u="",g=f.peek().toString();continue}else{if(this.getLineWidth(g.toString())>n?this.format.wordWrap=Fn.Character:typeof this.format!="undefined"&&this.format!==null&&(this.format.wordWrap=Fn.Word),this.getWrapType()!==Fn.Character||!h){var D=c.toString();D!==" "&&this.addToLineResult(i,r,D,s,an.LayoutBreak|l),this.isOverloadWithPosition&&(n=this.clientSize.width),u="",c="",s=0,p=0,L=0,l=an.None,g=h?g:f.peekWord(),h=!0}else h=!1,u="",u=u+c.toString(),g=f.peek().toString();continue}}c=c+g,s=L,h?(f.readWord(),g=f.peekWord()):(f.read(),g=f.peek().toString())}if(c.length>0){var D=c.toString();this.addToLineResult(i,r,D,s,an.NewLineBreak|an.LastParagraphLine)}f.close()}i.layoutLines=[];for(var R=0;R<r.length;R++)i.layoutLines.push(r[R]);return r=[],i},o.prototype.addToLineResult=function(t,e,i,r,n){var s=new cE;s.text=i,s.width=r,s.lineType=n,e.push(s);var l=t.actualSize;l.height+=this.getLineHeight(),l.width=Math.max(l.width,r),t.size=l},o.prototype.copyToResult=function(t,e,i,r){var n=!0,s=this.format!=null&&!this.format.lineLimit,l=t.actualSize.height,h=this.size.height;if(this.pageHeight>0&&h+this.rectangle.y>this.pageHeight&&(h=this.rectangle.y-this.pageHeight,h=Math.max(h,-h)),r=0,e.lines!=null)for(var c=0,u=e.lines.length;c<u;c++){var p=l+e.lineHeight;if(p<=h||h<=0||s){var f=e.lines[c];r+=f.text.length,f=this.trimLine(f,i.length===0),i.push(f);var g=t.actualSize;g.width=Math.max(g.width,f.width),t.size=g,l=p}else{n=!1;break}}if(l!=t.size.height){var C=t.actualSize;C.height=l,t.size=C}return{success:n,numInserted:r}},o.prototype.finalizeResult=function(t,e){t.layoutLines=[];for(var i=0;i<e.length;i++)t.layoutLines.push(e[i]);t.layoutLineHeight=this.getLineHeight(),this.reader.end||(t.textRemainder=this.reader.readToEnd()),e=[]},o.prototype.trimLine=function(t,e){var i=t.text,r=t.width,n=(t.lineType&an.FirstParagraphLine)==0,s=this.format==null||!this.format.rightToLeft,l=kr.spaces;return i=i.trim(),i.length!==t.text.length&&(r=this.getLineWidth(i),(t.lineType&an.FirstParagraphLine)>0&&(r+=this.getLineIndent(e))),t.text=i,t.width=r,t},o.prototype.getWrapType=function(){var t=this.format!=null?this.format.wordWrap:Fn.Word;return t},o}(),jd=function(){function o(){}return Object.defineProperty(o.prototype,"remainder",{get:function(){return this.textRemainder},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"actualSize",{get:function(){return typeof this.size=="undefined"&&(this.size=new St(0,0)),this.size},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lines",{get:function(){return this.layoutLines},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lineHeight",{get:function(){return this.layoutLineHeight},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"empty",{get:function(){return this.layoutLines==null||this.layoutLines.length===0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lineCount",{get:function(){var t=this.empty?0:this.layoutLines.length;return t},enumerable:!0,configurable:!0}),o}(),cE=function(){function o(){}return Object.defineProperty(o.prototype,"lineType",{get:function(){return this.type},set:function(t){this.type=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"text",{get:function(){return this.content},set:function(t){this.content=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"width",{get:function(){return this.lineWidth},set:function(t){this.lineWidth=t},enumerable:!0,configurable:!0}),o}(),an;(function(o){o[o.None=0]="None",o[o.NewLineBreak=1]="NewLineBreak",o[o.LayoutBreak=2]="LayoutBreak",o[o.FirstParagraphLine=4]="FirstParagraphLine",o[o.LastParagraphLine=8]="LastParagraphLine"})(an||(an={}));var Ns=function(){function o(t,e){this.fontStyle=Mi.Regular,typeof t=="number"&&typeof e=="undefined"?this.fontSize=t:(this.fontSize=t,this.setStyle(e))}return Object.defineProperty(o.prototype,"name",{get:function(){return this.metrics.name},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"size",{get:function(){return this.fontSize},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this.metrics.getHeight(null)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"style",{get:function(){return this.fontStyle},set:function(t){this.fontStyle=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"bold",{get:function(){return(this.style&Mi.Bold)>0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"italic",{get:function(){return(this.style&Mi.Italic)>0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"strikeout",{get:function(){return(this.style&Mi.Strikeout)>0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"underline",{get:function(){return(this.style&Mi.Underline)>0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"metrics",{get:function(){return this.fontMetrics},set:function(t){this.fontMetrics=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"element",{get:function(){return this.pdfFontInternals},enumerable:!0,configurable:!0}),o.prototype.measureString=function(t,e,i,r,n){if(typeof t=="string"&&typeof e=="undefined")return this.measureString(t,null);if(typeof t=="string"&&(e instanceof Tc||e==null)&&typeof i=="undefined"&&typeof r=="undefined"){var s=e,l=0,h=0;return this.measureString(t,s,l,h)}else if(typeof t=="string"&&(e instanceof Tc||e==null)&&typeof i=="number"&&typeof r=="number"){var s=e;return this.measureString(t,0,s,i,r)}else if(typeof t=="string"&&typeof e=="number"&&(i instanceof Tc||i==null)&&typeof r=="number"&&typeof n=="number"){var c=new St(e,0),u=i;return this.measureString(t,c,u,r,n)}else{if(t==null)throw Error('ArgumentNullException("text")');var s=e,u=i,p=new _d,f=p.layout(t,this,u,s,!1,new St(0,0));return r=t.length,n=f.empty?0:f.lines.length,f.actualSize}},o.prototype.equalsTo=function(t){var e=this.equalsToFont(t);return e},o.prototype.getInternals=function(){return this.pdfFontInternals},o.prototype.setInternals=function(t){if(t==null)throw new Error("ArgumentNullException:internals");this.pdfFontInternals=t},o.prototype.setStyle=function(t){this.fontStyle=t},o.prototype.applyFormatSettings=function(t,e,i){var r=i;if(e!=null&&i>0&&(e.characterSpacing!==0&&(r+=(t.length-1)*e.characterSpacing),e.wordSpacing!==0)){var n=kr.spaces,s=kr.getCharsCount(t,n);r+=s*e.wordSpacing}return r},o.charSizeMultiplier=.001,o.syncObject=new Object,o}(),Bs=function(){function o(t){this.radDegFactor=180/Math.PI,typeof t=="undefined"?this.transformationMatrix=new g0(1,0,0,1,0,0):this.transformationMatrix=new g0(1,0,0,-1,0,0)}return Object.defineProperty(o.prototype,"matrix",{get:function(){return this.transformationMatrix},set:function(t){this.transformationMatrix=t},enumerable:!0,configurable:!0}),o.prototype.translate=function(t,e){this.transformationMatrix.translate(t,e)},o.prototype.scale=function(t,e){this.transformationMatrix.elements[0]=t,this.transformationMatrix.elements[3]=e},o.prototype.rotate=function(t){t=t*Math.PI/180,this.transformationMatrix.elements[0]=Math.cos(t),this.transformationMatrix.elements[1]=Math.sin(t),this.transformationMatrix.elements[2]=-Math.sin(t),this.transformationMatrix.elements[3]=Math.cos(t)},o.prototype.toString=function(){for(var t="",e=" ",i=0,r=this.transformationMatrix.elements.length;i<r;i++){var n=this.matrix.elements[i];t+=It.floatToString(this.transformationMatrix.elements[i]),t+=e}return t},o.prototype.multiply=function(t){this.transformationMatrix.multiply(t.matrix)},o.degreesToRadians=function(t){return this.degRadFactor*t},o.prototype.radiansToDegrees=function(t){return this.radDegFactor*t},o.prototype.clone=function(){return this},o.degRadFactor=Math.PI/180,o}(),g0=function(){function o(t,e,i,r,n,s){typeof t=="undefined"?this.metrixElements=[]:typeof t=="number"?(this.metrixElements=[],this.metrixElements.push(t),this.metrixElements.push(e),this.metrixElements.push(i),this.metrixElements.push(r),this.metrixElements.push(n),this.metrixElements.push(s)):this.metrixElements=t}return Object.defineProperty(o.prototype,"elements",{get:function(){return this.metrixElements},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"offsetX",{get:function(){return this.metrixElements[4]},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"offsetY",{get:function(){return this.metrixElements[5]},enumerable:!0,configurable:!0}),o.prototype.translate=function(t,e){this.metrixElements[4]=t,this.metrixElements[5]=e},o.prototype.transform=function(t){var e=t.x,i=t.y,r=e*this.elements[0]+i*this.elements[2]+this.offsetX,n=e*this.elements[1]+i*this.elements[3]+this.offsetY;return new oi(r,n)},o.prototype.multiply=function(t){var e=[];e.push(this.elements[0]*t.elements[0]+this.elements[1]*t.elements[2]),e[1]=this.elements[0]*t.elements[1]+this.elements[1]*t.elements[3],e[2]=this.elements[2]*t.elements[0]+this.elements[3]*t.elements[2],e[3]=this.elements[2]*t.elements[1]+this.elements[3]*t.elements[3],e[4]=this.offsetX*t.elements[0]+this.offsetY*t.elements[2]+t.offsetX,e[5]=this.offsetX*t.elements[1]+this.offsetY*t.elements[3]+t.offsetY;for(var i=0;i<e.length;i++)this.elements[i]=e[i]},o.prototype.dispose=function(){this.metrixElements=null},o.prototype.clone=function(){var t=new o(this.metrixElements);return t},o}(),uE=function(){function o(){this.pdf="PDF",this.text="Text",this.imageB="ImageB",this.imageC="ImageC",this.imageI="ImageI"}return o}(),y0=function(){function o(){this.mKeys=[],this.mValues=[]}return o.prototype.size=function(){return this.mKeys.length},o.prototype.add=function(t,e){if(t==null||e===void 0||e===null)throw new ReferenceError("Provided key or value is not valid.");var i=this.mKeys.indexOf(t);if(i<0)return this.mKeys.push(t),this.mValues.push(e),1;throw new RangeError("An item with the same key has already been added.")},o.prototype.keys=function(){return this.mKeys},o.prototype.values=function(){return this.mValues},o.prototype.getValue=function(t){if(t==null)throw new ReferenceError("Provided key is not valid.");var e=this.mKeys.indexOf(t);if(e<0)throw new RangeError("No item with the specified key has been added.");return this.mValues[e]},o.prototype.setValue=function(t,e){if(t==null)throw new ReferenceError("Provided key is not valid.");var i=this.mKeys.indexOf(t);i<0?(this.mKeys.push(t),this.mValues.push(e)):this.mValues[i]=e},o.prototype.remove=function(t){if(t==null)throw new ReferenceError("Provided key is not valid.");var e=this.mKeys.indexOf(t);if(e<0)throw new RangeError("No item with the specified key has been added.");return this.mKeys.splice(e,1),this.mValues.splice(e,1),!0},o.prototype.containsKey=function(t){if(t==null)throw new ReferenceError("Provided key is not valid.");var e=this.mKeys.indexOf(t);return!(e<0)},o.prototype.clear=function(){this.mKeys=[],this.mValues=[]},o}(),Wd=function(){function o(t,e,i){this.dictionary=new Ei,this.dictionaryProperties=new $i,this.dictionary.items.setValue(this.dictionaryProperties.CA,new It(t)),this.dictionary.items.setValue(this.dictionaryProperties.ca,new It(e)),this.dictionary.items.setValue(this.dictionaryProperties.BM,new $t(i.toString()))}return Object.defineProperty(o.prototype,"element",{get:function(){return this.dictionary},enumerable:!0,configurable:!0}),o}(),pE=function(){function o(){this.automaticFieldsInformation=[]}return Object.defineProperty(o.prototype,"automaticFields",{get:function(){return this.automaticFieldsInformation},enumerable:!0,configurable:!0}),o.prototype.add=function(t){return this.automaticFields.push(t)},o}(),dE=function(){function o(){}return o.prototype.drawHelper=function(t,e,i){var r=e!==0||i!==0,n=null;r&&(n=t.save(),t.translateTransform(e,i)),this.drawInternal(t),r&&t.restore(n)},o}(),fE=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),vE=function(o){fE(t,o);function t(){var e=o.call(this)||this;return e.internalBounds=new bi(0,0,0,0),e.internalTemplateSize=new St(0,0),e}return Object.defineProperty(t.prototype,"bounds",{get:function(){return this.internalBounds},set:function(e){this.internalBounds=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return new St(this.bounds.width,this.bounds.height)},set:function(e){this.bounds.width=e.width,this.bounds.height=e.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"location",{get:function(){return new oi(this.bounds.x,this.bounds.y)},set:function(e){this.bounds.x=e.x,this.bounds.y=e.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this.internalFont},set:function(e){this.internalFont=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"brush",{get:function(){return this.internalBrush},set:function(e){this.internalBrush=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pen",{get:function(){return this.internalPen},set:function(e){this.internalPen=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stringFormat",{get:function(){return this.internalStringFormat},set:function(e){this.internalStringFormat=e},enumerable:!0,configurable:!0}),t.prototype.performDrawHelper=function(e,i,r,n){if(this.bounds.height===0||this.bounds.width===0){var s=this.getValue(e);this.internalTemplateSize=this.getFont().measureString(s,this.size,this.stringFormat)}},t.prototype.draw=function(e,i,r){if(typeof i=="undefined"){var n=new oi(0,0);this.draw(e,n)}else if(i instanceof oi)this.draw(e,i.x,i.y);else{this.drawHelper(e,i,r);var s=new b0(this,new oi(i,r));e.automaticFields.add(s)}},t.prototype.getSize=function(){return this.bounds.height===0||this.bounds.width===0?this.internalTemplateSize:this.size},t.prototype.drawInternal=function(e){},t.prototype.getBrush=function(){return typeof this.internalBrush=="undefined"||this.internalBrush==null?new oo(new ya(0,0,0)):this.internalBrush},t.prototype.getFont=function(){return typeof this.internalFont=="undefined"||this.internalFont==null?Ic.defaultFont:this.internalFont},t.prototype.getPageFromGraphics=function(e){if(typeof e.page!="undefined"&&e.page!==null){var i=e.page;return i}else{var i=e.currentPage;return i}},t}(dE),b0=function(){function o(t,e,i,r){this.pageNumberFieldLocation=new oi,this.pageNumberField=null,this.scaleX=1,this.scaleY=1,typeof e=="undefined"&&t instanceof o?(this.pageNumberField=t.field,this.pageNumberFieldLocation=t.location,this.scaleX=t.scalingX,this.scaleY=t.scalingY):typeof i=="undefined"&&e instanceof oi&&t instanceof vE?(this.pageNumberField=t,this.pageNumberFieldLocation=e):(this.pageNumberField=t,this.pageNumberFieldLocation=e,this.scaleX=i,this.scaleY=r)}return Object.defineProperty(o.prototype,"location",{get:function(){return this.pageNumberFieldLocation},set:function(t){this.pageNumberFieldLocation=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"field",{get:function(){return this.pageNumberField},set:function(t){this.pageNumberField=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"scalingX",{get:function(){return this.scaleX},set:function(t){this.scaleX=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"scalingY",{get:function(){return this.scaleY},set:function(t){this.scaleY=t},enumerable:!0,configurable:!0}),o}(),Tl=function(){function o(t){this.mPosition=0,this.buffer=new Uint8Array(t),this.dataView=new DataView(this.buffer.buffer)}return Object.defineProperty(o.prototype,"position",{get:function(){return this.mPosition},set:function(t){this.mPosition=t},enumerable:!0,configurable:!0}),o.prototype.read=function(t,e,i){for(var r=e;r<i;r++){var n=this.position;t.buffer[r]=this.readByte(n),this.position++}},o.prototype.getBuffer=function(t){return this.buffer[t]},o.prototype.writeFromBase64String=function(t){var e=this.encodedString(t);this.buffer=e},o.prototype.encodedString=function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i,r,n,s,l,h,c,u=0,p=0,f="data:";t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");var g=t.length*3/4;t.charAt(t.length-1)===e.charAt(64)&&g--;for(var C=new Uint8Array(g|0);u<t.length;)s=e.indexOf(t.charAt(u++)),l=e.indexOf(t.charAt(u++)),h=e.indexOf(t.charAt(u++)),c=e.indexOf(t.charAt(u++)),i=s<<2|l>>4,r=(l&15)<<4|h>>2,n=(h&3)<<6|c,C[p++]=i,C[p++]=r,C[p++]=n;return C},o.prototype.readByte=function(t){return this.buffer[t]},Object.defineProperty(o.prototype,"internalBuffer",{get:function(){return this.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"count",{get:function(){return this.buffer.byteLength},enumerable:!0,configurable:!0}),o.prototype.readNextTwoBytes=function(t){var e=t.readByte(this.position);return this.position++,e<<=8,e|=t.readByte(this.position),this.position++,e},o}(),C0=function(){function o(){}return Object.defineProperty(o.prototype,"empty",{get:function(){var t=this.offset===this.length&&this.length===this.checksum&&this.checksum===0;return t},enumerable:!0,configurable:!0}),o}(),mE=function(){function o(){}return o}(),gE=function(){function o(){}return o}(),yE=function(){function o(){}return o}(),S0=function(){function o(){}return Object.defineProperty(o.prototype,"isItalic",{get:function(){return(this.macStyle&2)!=0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isBold",{get:function(){return(this.macStyle&1)!=0},enumerable:!0,configurable:!0}),o}(),bE=function(){function o(){}return o}(),CE=function(){function o(){}return o}(),SE=function(){function o(){}return o}(),wE=function(){function o(){}return o}(),xE=function(){function o(){}return o}(),EE=function(){function o(){}return o}(),Ll=function(){function o(){}return Object.defineProperty(o.prototype,"empty",{get:function(){var t=this.index===this.width&&this.width===this.charCode&&this.charCode===0;return t},enumerable:!0,configurable:!0}),o.prototype.compareTo=function(t){var e=t;return this.index-e.index},o}(),AE=function(){function o(){}return o}(),TE=function(){function o(){}return o}(),LE=function(){function o(){}return o}(),kE=function(){function o(){}return o}(),IE=function(){function o(){}return o}(),w0=function(){function o(t){this.int32Size=4,this.int16Size=2,this.int64Size=8,this.bufferLength=t,this.buffer=[]}return Object.defineProperty(o.prototype,"data",{get:function(){if(this.buffer.length<this.bufferLength)for(var t=this.bufferLength-this.buffer.length,e=0;e<t;e++)this.buffer.push(0);return this.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"position",{get:function(){return(this.internalPosition===void 0||this.internalPosition===null)&&(this.internalPosition=0),this.internalPosition},enumerable:!0,configurable:!0}),o.prototype.writeShort=function(t){var e=[(t&65280)>>8,t&255];this.flush(e)},o.prototype.writeInt=function(t){var e=(t&4278190080)>>24;e=e<0?256+e:e;var i=(t&16711680)>>16;i=i<0?256+i:i;var r=(t&65280)>>8;r=r<0?256+r:r;var n=t&255;n=n<0?256+n:n;var s=[(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255];this.flush(s)},o.prototype.writeUInt=function(t){var e=[(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255];this.flush(e)},o.prototype.writeString=function(t){if(t==null)throw new Error("Argument Null Exception : value");for(var e=[],i=0;i<t.length;i++)e.push(t.charCodeAt(i));this.flush(e)},o.prototype.writeBytes=function(t){this.flush(t)},o.prototype.flush=function(t){if(t===null)throw new Error("Argument Null Exception : buff");for(var e=this.position,i=0;i<t.length;i++)this.buffer[e]=t[i],e++;this.internalPosition+=t.length},o}(),DE=function(){function o(t){this.int32Size=4,this.isTtcFont=!1,this.isMacTtf=!1,this.metricsName="",this.isMacTTF=!1,this.missedGlyphs=0,this.tableNames=["cvt ","fpgm","glyf","head","hhea","hmtx","loca","maxp","prep"],this.entrySelectors=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4],this.fontData=t,this.initialize()}return Object.defineProperty(o.prototype,"macintosh",{get:function(){return(this.macintoshDictionary===null||this.macintoshDictionary===void 0)&&(this.macintoshDictionary=new Ii),this.macintoshDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"microsoft",{get:function(){return(this.microsoftDictionary===null||this.microsoftDictionary===void 0)&&(this.microsoftDictionary=new Ii),this.microsoftDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"macintoshGlyphs",{get:function(){return(this.internalMacintoshGlyphs===null||this.internalMacintoshGlyphs===void 0)&&(this.internalMacintoshGlyphs=new Ii),this.internalMacintoshGlyphs},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"microsoftGlyphs",{get:function(){return(this.internalMicrosoftGlyphs===null||this.internalMicrosoftGlyphs===void 0)&&(this.internalMicrosoftGlyphs=new Ii),this.internalMicrosoftGlyphs},enumerable:!0,configurable:!0}),o.prototype.initialize=function(){this.metrics===void 0&&(this.metrics=new S0),this.readFontDictionary();var t=this.readNameTable(),e=this.readHeadTable();this.initializeFontName(t),this.metrics.macStyle=e.macStyle},o.prototype.readFontDictionary=function(){this.offset=0;var t=this.checkPreambula(),e=this.readInt16(this.offset),i=this.readInt16(this.offset),r=this.readInt16(this.offset),n=this.readInt16(this.offset);this.tableDirectory===void 0&&(this.tableDirectory=new Ii);for(var s=0;s<e;++s){var l=new C0,h=this.readString(this.int32Size);l.checksum=this.readInt32(this.offset),l.offset=this.readInt32(this.offset),l.length=this.readInt32(this.offset),this.tableDirectory.setValue(h,l)}this.lowestPosition=this.offset,this.isTtcFont||this.fixOffsets()},o.prototype.fixOffsets=function(){for(var t=Number.MAX_VALUE,e=this.tableDirectory.keys(),i=0;i<e.length;i++){var r=this.tableDirectory.getValue(e[i]),n=r.offset;if(t>n&&(t=n,t<=this.lowestPosition))break}var s=t-this.lowestPosition;if(s!==0){for(var l=new Ii,i=0;i<e.length;i++){var r=this.tableDirectory.getValue(e[i]);r.offset-=s,l.setValue(e[i],r)}this.tableDirectory=l}},o.prototype.checkPreambula=function(){var t=this.readInt32(this.offset);if(this.isMacTtf=t===1953658213,t!==65536&&t!==1953658213&&t!==1330926671){this.isTtcFont=!0,this.offset=0;var e=this.readString(4);if(e!=="ttcf")throw new Error("Can not read TTF font data");this.offset+=4;var i=this.readInt32(this.offset);if(i<0)throw new Error("Can not read TTF font data");this.offset=this.readInt32(this.offset),t=this.readInt32(this.offset)}return t},o.prototype.readNameTable=function(){var t=this.getTable("name");this.offset=t.offset;var e=new mE;e.formatSelector=this.readUInt16(this.offset),e.recordsCount=this.readUInt16(this.offset),e.offset=this.readUInt16(this.offset),e.nameRecords=[];for(var i=12,r=this.offset,n=0;n<e.recordsCount;n++){this.offset=r;var s=new gE;s.platformID=this.readUInt16(this.offset),s.encodingID=this.readUInt16(this.offset),s.languageID=this.readUInt16(this.offset),s.nameID=this.readUInt16(this.offset),s.length=this.readUInt16(this.offset),s.offset=this.readUInt16(this.offset),this.offset=t.offset+e.offset+s.offset;var l=s.platformID===0||s.platformID===3;s.name=this.readString(s.length,l),e.nameRecords[n]=s,r+=i}return e},o.prototype.readHeadTable=function(){var t=this.getTable("head");this.offset=t.offset;var e=new yE;return e.version=this.readFixed(this.offset),e.fontRevision=this.readFixed(this.offset),e.checkSumAdjustment=this.readUInt32(this.offset),e.magicNumber=this.readUInt32(this.offset),e.flags=this.readUInt16(this.offset),e.unitsPerEm=this.readUInt16(this.offset),e.created=this.readInt64(this.offset),e.modified=this.readInt64(this.offset),e.xMin=this.readInt16(this.offset),e.yMin=this.readInt16(this.offset),e.xMax=this.readInt16(this.offset),e.yMax=this.readInt16(this.offset),e.macStyle=this.readUInt16(this.offset),e.lowestReadableSize=this.readUInt16(this.offset),e.fontDirectionHint=this.readInt16(this.offset),e.indexToLocalFormat=this.readInt16(this.offset),e.glyphDataFormat=this.readInt16(this.offset),e},o.prototype.readHorizontalHeaderTable=function(){var t=this.getTable("hhea");this.offset=t.offset;var e=new bE;return e.version=this.readFixed(this.offset),e.ascender=this.readInt16(this.offset),e.descender=this.readInt16(this.offset),e.lineGap=this.readInt16(this.offset),e.advanceWidthMax=this.readUInt16(this.offset),e.minLeftSideBearing=this.readInt16(this.offset),e.minRightSideBearing=this.readInt16(this.offset),e.xMaxExtent=this.readInt16(this.offset),e.caretSlopeRise=this.readInt16(this.offset),e.caretSlopeRun=this.readInt16(this.offset),this.offset+=10,e.metricDataFormat=this.readInt16(this.offset),e.numberOfHMetrics=this.readUInt16(this.offset),e},o.prototype.readOS2Table=function(){var t=this.getTable("OS/2");this.offset=t.offset;var e=new CE;return e.version=this.readUInt16(this.offset),e.xAvgCharWidth=this.readInt16(this.offset),e.usWeightClass=this.readUInt16(this.offset),e.usWidthClass=this.readUInt16(this.offset),e.fsType=this.readInt16(this.offset),e.ySubscriptXSize=this.readInt16(this.offset),e.ySubscriptYSize=this.readInt16(this.offset),e.ySubscriptXOffset=this.readInt16(this.offset),e.ySubscriptYOffset=this.readInt16(this.offset),e.ySuperscriptXSize=this.readInt16(this.offset),e.ySuperscriptYSize=this.readInt16(this.offset),e.ySuperscriptXOffset=this.readInt16(this.offset),e.ySuperscriptYOffset=this.readInt16(this.offset),e.yStrikeoutSize=this.readInt16(this.offset),e.yStrikeoutPosition=this.readInt16(this.offset),e.sFamilyClass=this.readInt16(this.offset),e.panose=this.readBytes(10),e.ulUnicodeRange1=this.readUInt32(this.offset),e.ulUnicodeRange2=this.readUInt32(this.offset),e.ulUnicodeRange3=this.readUInt32(this.offset),e.ulUnicodeRange4=this.readUInt32(this.offset),e.vendorIdentifier=this.readBytes(4),e.fsSelection=this.readUInt16(this.offset),e.usFirstCharIndex=this.readUInt16(this.offset),e.usLastCharIndex=this.readUInt16(this.offset),e.sTypoAscender=this.readInt16(this.offset),e.sTypoDescender=this.readInt16(this.offset),e.sTypoLineGap=this.readInt16(this.offset),e.usWinAscent=this.readUInt16(this.offset),e.usWinDescent=this.readUInt16(this.offset),e.ulCodePageRange1=this.readUInt32(this.offset),e.ulCodePageRange2=this.readUInt32(this.offset),e.version>1?(e.sxHeight=this.readInt16(this.offset),e.sCapHeight=this.readInt16(this.offset),e.usDefaultChar=this.readUInt16(this.offset),e.usBreakChar=this.readUInt16(this.offset),e.usMaxContext=this.readUInt16(this.offset)):(e.sxHeight=0,e.sCapHeight=0,e.usDefaultChar=0,e.usBreakChar=0,e.usMaxContext=0),e},o.prototype.readPostTable=function(){var t=this.getTable("post");this.offset=t.offset;var e=new SE;return e.formatType=this.readFixed(this.offset),e.italicAngle=this.readFixed(this.offset),e.underlinePosition=this.readInt16(this.offset),e.underlineThickness=this.readInt16(this.offset),e.isFixedPitch=this.readUInt32(this.offset),e.minType42=this.readUInt32(this.offset),e.maxType42=this.readUInt32(this.offset),e.minType1=this.readUInt32(this.offset),e.maxType1=this.readUInt32(this.offset),e},o.prototype.readWidthTable=function(t,e){var i=this.getTable("hmtx");this.offset=i.offset;for(var r=[],n=0;n<t;n++){var s=new wE;s.advanceWidth=this.readUInt16(this.offset),s.lsb=this.readInt16(this.offset);var l=s.advanceWidth*1e3/e;r.push(Math.floor(l))}return r},o.prototype.readCmapTable=function(){var t=this.getTable("cmap");this.offset=t.offset;var e=new EE;e.version=this.readUInt16(this.offset),e.tablesCount=this.readUInt16(this.offset);for(var i=this.offset,r=[],n=0;n<e.tablesCount;n++){this.offset=i;var s=new xE;s.platformID=this.readUInt16(this.offset),s.encodingID=this.readUInt16(this.offset),s.offset=this.readUInt32(this.offset),i=this.offset,this.readCmapSubTable(s),r[n]=s}return r},o.prototype.readCmapSubTable=function(t){var e=this.getTable("cmap");this.offset=e.offset+t.offset;var i=this.readUInt16(this.offset),r=this.getCmapEncoding(t.platformID,t.encodingID),n=r===Fr.Macintosh?va.Macintosh:va.Microsoft;if(r!==Fr.Unknown)switch(i){case Al.Apple:this.readAppleCmapTable(t,r);break;case Al.Microsoft:this.readMicrosoftCmapTable(t,r);break;case Al.Trimmed:this.readTrimmedCmapTable(t,r);break}},o.prototype.readAppleCmapTable=function(t,e){var i=this.getTable("cmap");this.offset=i.offset+t.offset;var r=new TE;r.format=this.readUInt16(this.offset),r.length=this.readUInt16(this.offset),r.version=this.readUInt16(this.offset),(this.maxMacIndex===null||this.maxMacIndex===void 0)&&(this.maxMacIndex=0);for(var n=0;n<256;++n){var s=new Ll;s.index=this.readByte(this.offset),s.width=this.getWidth(s.index),s.charCode=n,this.macintosh.setValue(n,s),this.addGlyph(s,e),this.maxMacIndex=Math.max(n,this.maxMacIndex)}},o.prototype.readMicrosoftCmapTable=function(t,e){var i=this.getTable("cmap");this.offset=i.offset+t.offset;var r=e===Fr.Unicode?this.microsoft:this.macintosh,n=new LE;n.format=this.readUInt16(this.offset),n.length=this.readUInt16(this.offset),n.version=this.readUInt16(this.offset),n.segCountX2=this.readUInt16(this.offset),n.searchRange=this.readUInt16(this.offset),n.entrySelector=this.readUInt16(this.offset),n.rangeShift=this.readUInt16(this.offset);var s=n.segCountX2/2;n.endCount=this.readUshortArray(s),n.reservedPad=this.readUInt16(this.offset),n.startCount=this.readUshortArray(s),n.idDelta=this.readUshortArray(s),n.idRangeOffset=this.readUshortArray(s);var l=n.length/2-8-s*4;n.glyphID=this.readUshortArray(l);for(var h=0,c=0,u=0;u<s;u++)for(var p=n.startCount[u];p<=n.endCount[u]&&p!==65535;p++){if(n.idRangeOffset[u]===0)h=p+n.idDelta[u]&65535;else{if(c=u+n.idRangeOffset[u]/2-s+p-n.startCount[u],c>=n.glyphID.length)continue;h=n.glyphID[c]+n.idDelta[u]&65535}var f=new Ll;f.index=h,f.width=this.getWidth(f.index);var g=e===Fr.Symbol&&(p&65280)==61440?p&255:p;f.charCode=g,r.setValue(g,f),this.addGlyph(f,e)}},o.prototype.readTrimmedCmapTable=function(t,e){var i=this.getTable("cmap");this.offset=i.offset+t.offset;var r=new kE;r.format=this.readUInt16(this.offset),r.length=this.readUInt16(this.offset),r.version=this.readUInt16(this.offset),r.firstCode=this.readUInt16(this.offset),r.entryCount=this.readUInt16(this.offset);for(var n=0;n<r.entryCount;++n){var s=new Ll;s.index=this.readUInt16(this.offset),s.width=this.getWidth(s.index),s.charCode=n+r.firstCode,this.macintosh.setValue(n,s),this.addGlyph(s,e),this.maxMacIndex=Math.max(n,this.maxMacIndex)}},o.prototype.initializeFontName=function(t){for(var e=0;e<t.recordsCount;e++){var i=t.nameRecords[e];if(i.nameID===1?this.metrics.fontFamily=i.name:i.nameID===6&&(this.metrics.postScriptName=i.name),this.metrics.fontFamily!==null&&this.metrics.fontFamily!==void 0&&this.metrics.postScriptName!==null&&this.metrics.postScriptName!==void 0)break}},o.prototype.getTable=function(t){var e=new C0,i;return this.tableDirectory.containsKey(t)&&(i=this.tableDirectory.getValue(t)),i!=null&&(e=i),e},o.prototype.getWidth=function(t){return t=t<this.width.length?t:this.width.length-1,this.width[t]},o.prototype.getCmapEncoding=function(t,e){var i=Fr.Unknown;return t==va.Microsoft&&e==Ec.Undefined?i=Fr.Symbol:t==va.Microsoft&&e==Ec.Unicode?i=Fr.Unicode:t==va.Macintosh&&e==zd.Roman&&(i=Fr.Macintosh),i},o.prototype.addGlyph=function(t,e){var i=null;switch(e){case Fr.Unicode:i=this.microsoftGlyphs;break;case Fr.Macintosh:case Fr.Symbol:i=this.macintoshGlyphs;break}i.setValue(t.index,t)},o.prototype.initializeMetrics=function(t,e,i,r,n,s){this.initializeFontName(t);for(var l=!1,h=0;h<s.length;h++){var c=s[h],u=this.getCmapEncoding(c.platformID,c.encodingID);if(u===Fr.Symbol){l=!0;break}}this.metrics.isSymbol=l,this.metrics.macStyle=e.macStyle,this.metrics.isFixedPitch=n.isFixedPitch!==0,this.metrics.italicAngle=n.italicAngle;var p=1e3/e.unitsPerEm;this.metrics.winAscent=r.sTypoAscender*p,this.metrics.macAscent=i.ascender*p,this.metrics.capHeight=r.sCapHeight!==0?r.sCapHeight:.7*e.unitsPerEm*p,this.metrics.winDescent=r.sTypoDescender*p,this.metrics.macDescent=i.descender*p,this.metrics.leading=(r.sTypoAscender-r.sTypoDescender+r.sTypoLineGap)*p,this.metrics.lineGap=Math.ceil(i.lineGap*p);var f=e.xMin*p,g=Math.ceil(this.metrics.macAscent+this.metrics.lineGap),C=e.xMax*p,L=this.metrics.macDescent;this.metrics.fontBox=new Hd(f,g,C,L),this.metrics.stemV=80,this.metrics.widthTable=this.updateWidth(),this.metrics.contains=this.tableDirectory.containsKey("CFF"),this.metrics.subScriptSizeFactor=e.unitsPerEm/r.ySubscriptYSize,this.metrics.superscriptSizeFactor=e.unitsPerEm/r.ySuperscriptYSize},o.prototype.updateWidth=function(){var t=256,e=[];if(this.metrics.isSymbol)for(var i=0;i<t;i++){var r=this.getGlyph(String.fromCharCode(i));e[i]=r.empty?0:r.width}else for(var n=[],s="?",l=String.fromCharCode(32),i=0;i<t;i++){n[0]=i;var h=this.getString(n,0,n.length),c=h.length>0?h[0]:s,r=this.getGlyph(c);r.empty?(r=this.getGlyph(l),e[i]=r.empty?0:r.width):e[i]=r.width}return e},o.prototype.getDefaultGlyph=function(){var t=this.getGlyph(kr.whiteSpace);return t},o.prototype.getString=function(t,e,i){for(var r="",n=0;n<i;n++)r+=String.fromCharCode(t[n+e]);return r},o.prototype.readLocaTable=function(t){var e=this.getTable("loca");this.offset=e.offset;var i=new AE,r=null;if(t){var n=e.length/2;r=[];for(var s=0;s<n;s++)r[s]=this.readUInt16(this.offset)*2}else{var n=e.length/4;r=[];for(var s=0;s<n;s++)r[s]=this.readUInt32(this.offset)}return i.offsets=r,i},o.prototype.updateGlyphChars=function(t,e){t.containsKey(0)||t.setValue(0,0);for(var i=new Ii,r=t.keys(),n=0;n<r.length;n++)i.setValue(r[n],t.getValue(r[n]));for(var n=0;n<r.length;n++){var s=r[n];this.processCompositeGlyph(t,s,e)}},o.prototype.processCompositeGlyph=function(t,e,i){if(e<i.offsets.length-1){var r=i.offsets[e];if(r!==i.offsets[e+1]){var n=this.getTable("glyf");this.offset=n.offset+r;var s=new IE;if(s.numberOfContours=this.readInt16(this.offset),s.xMin=this.readInt16(this.offset),s.yMin=this.readInt16(this.offset),s.xMax=this.readInt16(this.offset),s.yMax=this.readInt16(this.offset),s.numberOfContours<0)for(var l=0,h=!0;h;){var c=this.readUInt16(this.offset),u=this.readUInt16(this.offset);if(t.containsKey(u)||t.setValue(u,0),(c&ga.MoreComponents)==0)break;l=(c&ga.Arg1And2AreWords)!=0?4:2,(c&ga.WeHaveScale)!=0?l+=2:(c&ga.WeHaveAnXyScale)!=0?l+=4:(c&ga.WeHaveTwoByTwo)!=0&&(l+=2*4),this.offset+=l}}}},o.prototype.generateGlyphTable=function(t,e,i,r){i=[];var n=t.keys();n.sort(function(D,R){return D-R});for(var s=0,l=0;l<n.length;l++){var h=n[l];e.offsets.length>0&&(s+=e.offsets[h+1]-e.offsets[h])}var c=this.align(s);r=[];for(var l=0;l<c;l++)r.push(0);for(var u=0,p=0,f=this.getTable("glyf"),l=0;l<e.offsets.length;l++)if(i.push(u),p<n.length&&n[p]===l){++p,i[l]=u;var g=e.offsets[l],C=e.offsets[l+1]-g;if(C>0){this.offset=f.offset+g;var L=this.read(r,u,C);r=L.buffer,u+=C}}return{glyphTableSize:s,newLocaTable:i,newGlyphTable:r}},o.prototype.updateLocaTable=function(t,e,i){if(t===null)throw new Error("Argument Null Exception : newLocaTable");for(var r=e?t.length*2:t.length*4,n=this.align(r),s=new w0(n),l=0;l<t.length;l++){var h=t[l];e?(h/=2,s.writeShort(h)):s.writeInt(h)}return{newLocaUpdated:s.data,newLocaSize:r}},o.prototype.align=function(t){return t+3&~3},o.prototype.getFontProgram=function(t,e,i,r){if(t===null)throw new Error("Argument Null Exception : newLocaTableOut");if(e===null)throw new Error("Argument Null Exception : newGlyphTable");var n=this.tableNames,s=this.getFontProgramLength(t,e,0),l=s.fontProgramLength,h=s.numTables,c=new w0(l);c.writeInt(65536),c.writeShort(h);var u=this.entrySelectors[h];return c.writeShort((1<<(u&31))*16),c.writeShort(u),c.writeShort((h-(1<<(u&31)))*16),this.writeCheckSums(c,h,t,e,i,r),this.writeGlyphs(c,t,e),c.data},o.prototype.getFontProgramLength=function(t,e,i){if(t===null)throw new Error("Argument Null Exception : newLocaTableOut");if(e===null)throw new Error("Argument Null Exception : newGlyphTable");i=2;for(var r=this.tableNames,n=0,s=0;s<r.length;s++){var l=r[s];if(l!=="glyf"&&l!=="loca"){var h=this.getTable(l);h.empty||(++i,n+=this.align(h.length))}}n+=t.length,n+=e.length;var c=i*16+3*4;return n+=c,{fontProgramLength:n,numTables:i}},o.prototype.writeCheckSums=function(t,e,i,r,n,s){if(t===null)throw new Error("Argument Null Exception : writer");if(i===null)throw new Error("Argument Null Exception : newLocaTableOut");if(r===null)throw new Error("Argument Null Exception : newGlyphTable");for(var l=this.tableNames,h=e*16+3*4,c=0,u=0;u<l.length;u++){var p=l[u],f=this.getTable(p);if(!f.empty){if(t.writeString(p),p==="glyf"){var g=this.calculateCheckSum(r);t.writeInt(g),c=n}else if(p==="loca"){var g=this.calculateCheckSum(i);t.writeInt(g),c=s}else t.writeInt(f.checksum),c=f.length;t.writeUInt(h),t.writeUInt(c),h+=this.align(c)}}},o.prototype.calculateCheckSum=function(t){if(t===null)throw new Error("Argument Null Exception : bytes");for(var e=0,i=0,r=0,n=0,s=0,l=0;l<(t.length+1)/4;l++)s+=t[e++]&255,n+=t[e++]&255,r+=t[e++]&255,i+=t[e++]&255;var h=i;return h+=r<<8,h+=n<<16,h+=s<<24,h},o.prototype.writeGlyphs=function(t,e,i){if(t===null)throw new Error("Argument Null Exception : writer");if(e===null)throw new Error("Argument Null Exception : newLocaTableOut");if(i===null)throw new Error("Argument Null Exception : newGlyphTable");for(var r=this.tableNames,n=0;n<r.length;n++){var s=r[n],l=this.getTable(s);if(!l.empty)if(s==="glyf")t.writeBytes(i);else if(s==="loca")t.writeBytes(e);else{for(var h=this.align(l.length),c=[],u=0;u<h;u++)c.push(0);this.offset=l.offset;var p=this.read(c,0,l.length);t.writeBytes(p.buffer)}}},o.prototype.setOffset=function(t){this.offset=t},o.prototype.createInternals=function(){this.metrics=new S0;var t=this.readNameTable(),e=this.readHeadTable();this.bIsLocaShort=e.indexToLocalFormat===0;var i=this.readHorizontalHeaderTable(),r=this.readOS2Table(),n=this.readPostTable();this.width=this.readWidthTable(i.numberOfHMetrics,e.unitsPerEm);var s=this.readCmapTable();this.initializeMetrics(t,e,i,r,n,s)},o.prototype.getGlyph=function(t){if(typeof t=="number"){var e=null;!this.metrics.isSymbol&&this.microsoftGlyphs!=null?this.microsoftGlyphs.containsKey(t)&&(e=this.microsoftGlyphs.getValue(t)):this.metrics.isSymbol&&this.macintoshGlyphs!=null&&this.macintoshGlyphs.containsKey(t)&&(e=this.macintoshGlyphs.getValue(t));var i=e!=null?e:this.getDefaultGlyph();return i}else{var r=null,n=t.charCodeAt(0);!this.metrics.isSymbol&&this.microsoft!==null?this.microsoft.containsKey(n)?(r=this.microsoft.getValue(n),n!==kr.whiteSpace.charCodeAt(0)&&(this.isFontPresent=!0)):n!==kr.whiteSpace.charCodeAt(0)&&(this.isFontPresent=!1):(this.metrics.isSymbol&&this.macintosh!==null||this.isMacTTF)&&(this.maxMacIndex!==0?n%=this.maxMacIndex+1:n=(n&65280)==61440?n&255:n,this.macintosh.containsKey(n)&&(r=this.macintosh.getValue(n),this.isFontPresent=!0)),t===kr.whiteSpace&&r===null&&(r=new Ll);var i=r!==null?r:this.getDefaultGlyph();return i}},o.prototype.getGlyphChars=function(t){if(t==null)throw new Error("Argument Null Exception : chars");for(var e=new Ii,i=t.keys(),r=0;r<i.length;r++){var n=i[r],s=this.getGlyph(n);s.empty||e.setValue(s.index,n.charCodeAt(0))}return e},o.prototype.getAllGlyphs=function(){for(var t=[],e=new Ll,i=0,r=0;r<this.width.length;r++){var n=this.width[r];e.index=i,e.width=n,t.push(e),i++}return t},o.prototype.readFontProgram=function(t){var e=this.getGlyphChars(t),i=this.readLocaTable(this.bIsLocaShort);e.size()<t.size()&&(this.missedGlyphs=t.size()-e.size()),this.updateGlyphChars(e,i);var r=this.generateGlyphTable(e,i,null,null),n=r.glyphTableSize,s=r.newLocaTable,l=r.newGlyphTable,h=this.updateLocaTable(s,this.bIsLocaShort,null),c=h.newLocaSize,u=h.newLocaUpdated,p=this.getFontProgram(u,l,n,c);return p},o.prototype.convertString=function(t){if(t===null)throw new Error("Argument Null Exception : text");for(var e="",i=0,r=0;r<t.length;r++){var n=t[r],s=this.getGlyph(n);s.empty||(e+=String.fromCharCode(s.index),i++)}return e},o.prototype.getCharWidth=function(t){var e=this.getGlyph(t);e=e.empty?this.getDefaultGlyph():e;var i=e.empty?0:e.width;return i},o.prototype.readString=function(t,e){if(e===void 0)return this.readString(t,!1);var i="";if(e)for(var r=0;r<t;r++)r%2!=0&&(i+=String.fromCharCode(this.fontData[this.offset])),this.offset+=1;else for(var r=0;r<t;r++)i+=String.fromCharCode(this.fontData[this.offset]),this.offset+=1;return i},o.prototype.readFixed=function(t){var e=this.readInt16(t),i=this.readInt16(t+2),r=i/16384;return e+r},o.prototype.readInt32=function(t){var e=this.fontData[t+3],i=this.fontData[t+2],r=this.fontData[t+1],n=this.fontData[t];return this.offset+=4,e+(i<<8)+(r<<16)+(n<<24)},o.prototype.readUInt32=function(t){var e=this.fontData[t+3],i=this.fontData[t+2],r=this.fontData[t+1],n=this.fontData[t];return this.offset+=4,e|i<<8|r<<16|n<<24},o.prototype.readInt16=function(t){var e=(this.fontData[t]<<8)+this.fontData[t+1];return e=e&1<<15?e-65536:e,this.offset+=2,e},o.prototype.readInt64=function(t){var e=this.readInt32(t+4),i=this.readInt32(t)*4294967296+e;return e<0&&(i+=4294967296),i},o.prototype.readUInt16=function(t){var e=this.fontData[t]<<8|this.fontData[t+1];return this.offset+=2,e},o.prototype.readUshortArray=function(t){for(var e=[],i=0;i<t;i++)e[i]=this.readUInt16(this.offset);return e},o.prototype.readBytes=function(t){for(var e=[],i=0;i<t;i++)e.push(this.fontData[this.offset]),this.offset+=1;return e},o.prototype.readByte=function(t){var e=this.fontData[t];return this.offset+=1,e},o.prototype.read=function(t,e,i){if(t===null)throw new Error("Argument Null Exception : buffer");var r=0,n=0;do{for(var s=0;s<i-r&&this.offset+s<this.fontData.length;s++)t[e+s]=this.fontData[this.offset+s];n=i-r,this.offset+=n,r+=n}while(r<i);return{buffer:t,written:r}},o}(),OE=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),lo=function(){function o(){this.lineGap=0}return o.prototype.getAscent=function(t){var e=this.ascent*Ns.charSizeMultiplier*this.getSize(t);return e},o.prototype.getDescent=function(t){var e=this.descent*Ns.charSizeMultiplier*this.getSize(t);return e},o.prototype.getLineGap=function(t){var e=this.lineGap*Ns.charSizeMultiplier*this.getSize(t);return e},o.prototype.getHeight=function(t){for(var e,i=["cambria","candara","constantia","corbel","cariadings"],r=[],n=0;n<i.length;n++){var s=i[n];r.push(s)}return this.getDescent(t)<0?e=this.getAscent(t)-this.getDescent(t)+this.getLineGap(t):e=this.getAscent(t)+this.getDescent(t)+this.getLineGap(t),e},o.prototype.getSize=function(t){var e=this.size;if(t!=null)switch(t.subSuperScript){case Ps.SubScript:e/=this.subScriptSizeFactor;break;case Ps.SuperScript:e/=this.superscriptSizeFactor;break}return e},o.prototype.clone=function(){var t=this;return t.widthTable=x0.clone(),t},Object.defineProperty(o.prototype,"widthTable",{get:function(){return this.internalWidthTable},set:function(t){this.internalWidthTable=t},enumerable:!0,configurable:!0}),o}(),x0=function(){function o(){}return o.clone=function(){return null},o}(),Ir=function(o){OE(t,o);function t(e){var i=o.call(this)||this;if(e==null)throw new Error("ArgumentNullException:widths");return i.widths=e,i}return t.prototype.items=function(e){if(e<0||e>=this.widths.length)throw new Error("ArgumentOutOfRangeException:index, The character is not supported by the font.");var i=this.widths[e];return i},Object.defineProperty(t.prototype,"length",{get:function(){return this.widths.length},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var e=this;return e.widths=this.widths,e},t.prototype.toArray=function(){var e=new Zi(this.widths);return e},t}(x0),RE=function(){function o(t,e){if(this.nameString="ABCDEFGHIJKLMNOPQRSTUVWXYZ",this.dictionaryProperties=new $i,this.isCompress=!1,this.isEmbedFont=!1,this.cmapPrefix=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap`+_e.newLine+`/CIDSystemInfo << /Registry (Adobe)/Ordering (UCS)/Supplement 0>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange`+_e.newLine,this.cmapEndCodespaceRange="endcodespacerange"+_e.newLine,this.cmapBeginRange="beginbfrange"+_e.newLine,this.cmapEndRange="endbfrange"+_e.newLine,this.cmapSuffix=`endbfrange
endcmap
CMapName currentdict /CMap defineresource pop
end end`+_e.newLine,t==null)throw new Error("ArgumentNullException:base64String");this.fontSize=e,this.fontString=t,this.Initialize()}return o.prototype.getCharWidth=function(t){var e=this.ttfReader.getCharWidth(t);return e},o.prototype.getLineWidth=function(t){for(var e=0,i=0,r=t.length;i<r;i++){var n=t[i],s=this.getCharWidth(n);e+=s}return e},o.prototype.Initialize=function(){var t=new Tl(this.fontString.length);t.writeFromBase64String(this.fontString),this.fontData=t.internalBuffer,this.ttfReader=new DE(this.fontData),this.ttfMetrics=this.ttfReader.metrics},o.prototype.createInternals=function(){this.fontDictionary=new Ei,this.fontProgram=new Tr,this.cmap=new Tr,this.descendantFont=new Ei,this.metrics=new lo,this.ttfReader.createInternals(),this.ttfMetrics=this.ttfReader.metrics,this.initializeMetrics(),this.subsetName=this.getFontName(),this.createDescendantFont(),this.createCmap(),this.createFontDictionary(),this.createFontProgram()},o.prototype.getInternals=function(){return this.fontDictionary},o.prototype.initializeMetrics=function(){var t=this.ttfReader.metrics;this.metrics.ascent=t.macAscent,this.metrics.descent=t.macDescent,this.metrics.height=t.macAscent-t.macDescent+t.lineGap,this.metrics.name=t.fontFamily,this.metrics.postScriptName=t.postScriptName,this.metrics.size=this.fontSize,this.metrics.widthTable=new Ir(t.widthTable),this.metrics.lineGap=t.lineGap,this.metrics.subScriptSizeFactor=t.subScriptSizeFactor,this.metrics.superscriptSizeFactor=t.superscriptSizeFactor,this.metrics.isBold=t.isBold},o.prototype.getFontName=function(){for(var t="",e,i=0;i<6;i++){var r=Math.floor(Math.random()*(25-0+1))+0;t+=this.nameString[r]}return t+="+",t+=this.ttfReader.metrics.postScriptName,e=t.toString(),e=this.formatName(e),e},o.prototype.formatName=function(t){var e=t.replace("(","#28");return e=e.replace(")","#29"),e=e.replace("[","#5B"),e=e.replace("]","#5D"),e=e.replace("<","#3C"),e=e.replace(">","#3E"),e=e.replace("{","#7B"),e=e.replace("}","#7D"),e=e.replace("/","#2F"),e=e.replace("%","#25"),e.replace(" ","#20")},o.prototype.createDescendantFont=function(){this.descendantFont.isFont=!0,this.descendantFont.descendantFontBeginSave=new Xx(this),this.descendantFont.items.setValue(this.dictionaryProperties.type,new $t(this.dictionaryProperties.font)),this.descendantFont.items.setValue(this.dictionaryProperties.subtype,new $t(this.dictionaryProperties.cIDFontType2)),this.descendantFont.items.setValue(this.dictionaryProperties.baseFont,new $t(this.subsetName)),this.descendantFont.items.setValue(this.dictionaryProperties.cIDToGIDMap,new $t(this.dictionaryProperties.identity)),this.descendantFont.items.setValue(this.dictionaryProperties.dw,new It(1e3)),this.fontDescriptor=this.createFontDescriptor(),this.descendantFont.items.setValue(this.dictionaryProperties.fontDescriptor,new Ai(this.fontDescriptor));var t=this.createSystemInfo();this.descendantFont.items.setValue(this.dictionaryProperties.cIDSystemInfo,t)},o.prototype.createFontDescriptor=function(){var t=new Ei,e=this.ttfReader.metrics;return t.isFont=!0,t.items.setValue(this.dictionaryProperties.type,new $t(this.dictionaryProperties.fontDescriptor)),t.items.setValue(this.dictionaryProperties.fontName,new $t(this.subsetName)),t.items.setValue(this.dictionaryProperties.flags,new It(this.getDescriptorFlags())),t.items.setValue(this.dictionaryProperties.fontBBox,Zi.fromRectangle(this.getBoundBox())),t.items.setValue(this.dictionaryProperties.missingWidth,new It(e.widthTable[32])),t.items.setValue(this.dictionaryProperties.stemV,new It(e.stemV)),t.items.setValue(this.dictionaryProperties.italicAngle,new It(e.italicAngle)),t.items.setValue(this.dictionaryProperties.capHeight,new It(e.capHeight)),t.items.setValue(this.dictionaryProperties.ascent,new It(e.winAscent)),t.items.setValue(this.dictionaryProperties.descent,new It(e.winDescent)),t.items.setValue(this.dictionaryProperties.leading,new It(e.leading)),t.items.setValue(this.dictionaryProperties.avgWidth,new It(e.widthTable[32])),t.items.setValue(this.dictionaryProperties.fontFile2,new Ai(this.fontProgram)),t.items.setValue(this.dictionaryProperties.maxWidth,new It(e.widthTable[32])),t.items.setValue(this.dictionaryProperties.xHeight,new It(0)),t.items.setValue(this.dictionaryProperties.stemH,new It(0)),t},o.prototype.createCmap=function(){this.cmap.cmapBeginSave=new rE(this)},o.prototype.createFontDictionary=function(){this.fontDictionary.isFont=!0,this.fontDictionary.fontDictionaryBeginSave=new $x(this),this.fontDictionary.items.setValue(this.dictionaryProperties.type,new $t(this.dictionaryProperties.font)),this.fontDictionary.items.setValue(this.dictionaryProperties.baseFont,new $t(this.subsetName)),this.fontDictionary.items.setValue(this.dictionaryProperties.subtype,new $t(this.dictionaryProperties.type0)),this.fontDictionary.items.setValue(this.dictionaryProperties.encoding,new $t(this.dictionaryProperties.identityH));var t=new Zi,e=new Ai(this.descendantFont);t.isFont=!0,t.add(e),this.fontDictionary.items.setValue(this.dictionaryProperties.descendantFonts,t)},o.prototype.createFontProgram=function(){this.fontProgram.fontProgramBeginSave=new nE(this)},o.prototype.createSystemInfo=function(){var t=new Ei;return t.items.setValue(this.dictionaryProperties.registry,new Lr("Adobe")),t.items.setValue(this.dictionaryProperties.ordering,new Lr(this.dictionaryProperties.identity)),t.items.setValue(this.dictionaryProperties.supplement,new It(0)),t},o.prototype.descendantFontBeginSave=function(){if(this.usedChars!==null&&this.usedChars!==void 0&&this.usedChars.size()>0){var t=this.getDescendantWidth();t!==null&&this.descendantFont.items.setValue(this.dictionaryProperties.w,t)}},o.prototype.cmapBeginSave=function(){this.generateCmap()},o.prototype.fontDictionaryBeginSave=function(){this.usedChars!==null&&this.usedChars!==void 0&&this.usedChars.size()>0&&!this.fontDictionary.containsKey(this.dictionaryProperties.toUnicode)&&this.fontDictionary.items.setValue(this.dictionaryProperties.toUnicode,new Ai(this.cmap))},o.prototype.fontProgramBeginSave=function(){this.isCompress=!0,this.generateFontProgram()},o.prototype.getDescendantWidth=function(){var t=new Zi;if(this.usedChars!==null&&this.usedChars!==void 0&&this.usedChars.size()>0){for(var e=[],i=this.usedChars.keys(),r=0;r<i.length;r++){var n=i[r],s=this.ttfReader.getGlyph(n);s.empty||e.push(s)}e.sort(function(p,f){return p.index-f.index});for(var l=0,h=0,c=!1,u=new Zi,r=0;r<e.length;r++){var s=e[r];c||(c=!0,l=s.index,h=s.index-1),(h+1!==s.index||r+1===e.length)&&e.length>1&&(t.add(new It(l)),r!==0&&t.add(u),l=s.index,u=new Zi),u.add(new It(s.width)),r+1===e.length&&(t.add(new It(l)),t.add(u)),h=s.index}}return t},o.prototype.generateCmap=function(){if(this.usedChars!==null&&this.usedChars!==void 0&&this.usedChars.size()>0){var t=this.ttfReader.getGlyphChars(this.usedChars);if(t.size()>0){var e=t.keys().sort(),i=e[0],r=e[e.length-1],n=this.toHexString(i,!1)+this.toHexString(r,!1)+_e.newLine,s="";s+=this.cmapPrefix,s+=n,s+=this.cmapEndCodespaceRange;for(var l=0,h=0;h<e.length;h++){l===0&&(h!==0&&(s+=this.cmapEndRange),l=Math.min(100,e.length-h),s+=l,s+=_e.whiteSpace,s+=this.cmapBeginRange),l-=1;var c=e[h];s+=this.toHexString(c,!0)+this.toHexString(c,!0)+this.toHexString(t.getValue(c),!0)+`
`}s+=this.cmapSuffix,this.cmap.clearStream(),this.cmap.isFont=!0,this.cmap.write(s)}}},o.prototype.generateFontProgram=function(){var t=null;this.usedChars=this.usedChars===null||this.usedChars===void 0?new Ii:this.usedChars,this.ttfReader.setOffset(0),t=this.ttfReader.readFontProgram(this.usedChars),this.fontProgram.clearStream(),this.fontProgram.isFont=!0,this.fontProgram.writeBytes(t)},o.prototype.getDescriptorFlags=function(){var t=0,e=this.ttfReader.metrics;return e.isFixedPitch&&(t|=ma.FixedPitch),e.isSymbol?t|=ma.Symbolic:t|=ma.Nonsymbolic,e.isItalic&&(t|=ma.Italic),e.isBold&&(t|=ma.ForceBold),t},o.prototype.getBoundBox=function(){var t=this.ttfReader.metrics.fontBox,e=Math.abs(t.right-t.left),i=Math.abs(t.top-t.bottom),r=new bi(t.left,t.bottom,e,i);return r},o.prototype.toHexString=function(t,e){var i=t.toString(16);return e&&(i=i.toUpperCase()),"<0000".substring(0,5-i.length)+i+">"},o.prototype.setSymbols=function(t){if(t===null)throw new Error("Argument Null Exception : text");(this.usedChars===null||this.usedChars===void 0)&&(this.usedChars=new Ii);for(var e=0;e<t.length;e++){var i=t[e];this.usedChars.setValue(i,String.fromCharCode(0))}this.isEmbedFont===!1&&this.getDescendantWidth()},o}(),E0=function(){function o(){this.arabicCharTable=[["\u0621","\uFE80"],["\u0622","\uFE81","\uFE82"],["\u0623","\uFE83","\uFE84"],["\u0624","\uFE85","\uFE86"],["\u0625","\uFE87","\uFE88"],["\u0626","\uFE89","\uFE8A","\uFE8B","\uFE8C"],["\u0627","\uFE8D","\uFE8E"],["\u0628","\uFE8F","\uFE90","\uFE91","\uFE92"],["\u0629","\uFE93","\uFE94"],["\u062A","\uFE95","\uFE96","\uFE97","\uFE98"],["\u062B","\uFE99","\uFE9A","\uFE9B","\uFE9C"],["\u062C","\uFE9D","\uFE9E","\uFE9F","\uFEA0"],["\u062D","\uFEA1","\uFEA2","\uFEA3","\uFEA4"],["\u062E","\uFEA5","\uFEA6","\uFEA7","\uFEA8"],["\u062F","\uFEA9","\uFEAA"],["\u0630","\uFEAB","\uFEAC"],["\u0631","\uFEAD","\uFEAE"],["\u0632","\uFEAF","\uFEB0"],["\u0633","\uFEB1","\uFEB2","\uFEB3","\uFEB4"],["\u0634","\uFEB5","\uFEB6","\uFEB7","\uFEB8"],["\u0635","\uFEB9","\uFEBA","\uFEBB","\uFEBC"],["\u0636","\uFEBD","\uFEBE","\uFEBF","\uFEC0"],["\u0637","\uFEC1","\uFEC2","\uFEC3","\uFEC4"],["\u0638","\uFEC5","\uFEC6","\uFEC7","\uFEC8"],["\u0639","\uFEC9","\uFECA","\uFECB","\uFECC"],["\u063A","\uFECD","\uFECE","\uFECF","\uFED0"],["\u0640","\u0640","\u0640","\u0640","\u0640"],["\u0641","\uFED1","\uFED2","\uFED3","\uFED4"],["\u0642","\uFED5","\uFED6","\uFED7","\uFED8"],["\u0643","\uFED9","\uFEDA","\uFEDB","\uFEDC"],["\u0644","\uFEDD","\uFEDE","\uFEDF","\uFEE0"],["\u0645","\uFEE1","\uFEE2","\uFEE3","\uFEE4"],["\u0646","\uFEE5","\uFEE6","\uFEE7","\uFEE8"],["\u0647","\uFEE9","\uFEEA","\uFEEB","\uFEEC"],["\u0648","\uFEED","\uFEEE"],["\u0649","\uFEEF","\uFEF0","\uFBE8","\uFBE9"],["\u064A","\uFEF1","\uFEF2","\uFEF3","\uFEF4"],["\u0671","\uFB50","\uFB51"],["\u0679","\uFB66","\uFB67","\uFB68","\uFB69"],["\u067A","\uFB5E","\uFB5F","\uFB60","\uFB61"],["\u067B","\uFB52","\uFB53","\uFB54","\uFB55"],["\u067E","\uFB56","\uFB57","\uFB58","\uFB59"],["\u067F","\uFB62","\uFB63","\uFB64","\uFB65"],["\u0680","\uFB5A","\uFB5B","\uFB5C","\uFB5D"],["\u0683","\uFB76","\uFB77","\uFB78","\uFB79"],["\u0684","\uFB72","\uFB73","\uFB74","\uFB75"],["\u0686","\uFB7A","\uFB7B","\uFB7C","\uFB7D"],["\u0687","\uFB7E","\uFB7F","\uFB80","\uFB81"],["\u0688","\uFB88","\uFB89"],["\u068C","\uFB84","\uFB85"],["\u068D","\uFB82","\uFB83"],["\u068E","\uFB86","\uFB87"],["\u0691","\uFB8C","\uFB8D"],["\u0698","\uFB8A","\uFB8B"],["\u06A4","\uFB6A","\uFB6B","\uFB6C","\uFB6D"],["\u06A6","\uFB6E","\uFB6F","\uFB70","\uFB71"],["\u06A9","\uFB8E","\uFB8F","\uFB90","\uFB91"],["\u06AD","\uFBD3","\uFBD4","\uFBD5","\uFBD6"],["\u06AF","\uFB92","\uFB93","\uFB94","\uFB95"],["\u06B1","\uFB9A","\uFB9B","\uFB9C","\uFB9D"],["\u06B3","\uFB96","\uFB97","\uFB98","\uFB99"],["\u06BA","\uFB9E","\uFB9F"],["\u06BB","\uFBA0","\uFBA1","\uFBA2","\uFBA3"],["\u06BE","\uFBAA","\uFBAB","\uFBAC","\uFBAD"],["\u06C0","\uFBA4","\uFBA5"],["\u06C1","\uFBA6","\uFBA7","\uFBA8","\uFBA9"],["\u06C5","\uFBE0","\uFBE1"],["\u06C6","\uFBD9","\uFBDA"],["\u06C7","\uFBD7","\uFBD8"],["\u06C8","\uFBDB","\uFBDC"],["\u06C9","\uFBE2","\uFBE3"],["\u06CB","\uFBDE","\uFBDF"],["\u06CC","\uFBFC","\uFBFD","\uFBFE","\uFBFF"],["\u06D0","\uFBE4","\uFBE5","\uFBE6","\uFBE7"],["\u06D2","\uFBAE","\uFBAF"],["\u06D3","\uFBB0","\uFBB1"]],this.alef="\u0627",this.alefHamza="\u0623",this.alefHamzaBelow="\u0625",this.alefMadda="\u0622",this.lam="\u0644",this.hamza="\u0621",this.zeroWidthJoiner="\u200D",this.hamzaAbove="\u0654",this.hamzaBelow="\u0655",this.wawHamza="\u0624",this.yehHamza="\u0626",this.waw="\u0648",this.alefMaksura="\u0649",this.yeh="\u064A",this.farsiYeh="\u06CC",this.shadda="\u0651",this.madda="\u0653",this.lwa="\uFEFB",this.lwawh="\uFEF7",this.lwawhb="\uFEF9",this.lwawm="\uFEF5",this.bwhb="\u06D3",this.fathatan="\u064B",this.superScriptalef="\u0670",this.vowel=1,this.arabicMapTable=new Ii;for(var t=0;t<this.arabicCharTable.length;t++)this.arabicMapTable.setValue(this.arabicCharTable[t][0],this.arabicCharTable[t])}return o.prototype.getCharacterShape=function(t,e){if(t>=this.hamza&&t<=this.bwhb){var i=[];if(this.arabicMapTable.getValue(t))return i=this.arabicMapTable.getValue(t),i[e+1]}else if(t>=this.lwawm&&t<=this.lwa)return t;return t},o.prototype.shape=function(t,e){for(var i="",r="",n=0;n<t.length;n++){var s=t[n];if(s>="\u0600"&&s<="\u06FF")r=r+s;else{if(r.length>0){var l=this.doShape(r.toString(),0);i=i+l,r=""}i=i+s}}if(r.length>0){var l=this.doShape(r.toString(),0);i=i+l}return i.toString()},o.prototype.doShape=function(t,e){for(var i="",r=0,n=0,s=0,l="",h=new Ud,c=new Ud;s<t.length;)if(l=t[s++],r=this.ligature(l,c),r===0){var u=this.getShapeCount(l);n=u===1?0:2,h.Shapes>2&&(n+=1),n=n%c.Shapes,c.Value=this.getCharacterShape(c.Value,n),i=this.append(i,h,e),h=c,c=new Ud,c.Value=l,c.Shapes=u,c.Ligature++}return n=h.Shapes>2?1:0,n=n%c.Shapes,c.Value=this.getCharacterShape(c.Value,n),i=this.append(i,h,e),i=this.append(i,c,e),i.toString()},o.prototype.append=function(t,e,i){return e.Value!==""&&(t=t+e.Value,e.Ligature-=1,e.Type!==""&&((i&this.vowel)==0&&(t=t+e.Type),e.Ligature-=1),e.vowel!==""&&((i&this.vowel)==0&&(t=t+e.vowel),e.Ligature-=1)),t},o.prototype.ligature=function(t,e){if(e.Value!==""){var i=0;if(t>=this.fathatan&&t<=this.hamzaBelow||t===this.superScriptalef){if(i=1,e.vowel!==""&&t!==this.shadda&&(i=2),t===this.shadda)if(e.Type==null)e.Type=this.shadda;else return 0;else t===this.hamzaBelow?e.Value===this.alef?(e.Value=this.alefHamzaBelow,i=2):t===this.lwa?(e.Value=this.lwawhb,i=2):e.Type=this.hamzaBelow:t===this.hamzaAbove?e.Value===this.alef?(e.Value=this.alefHamza,i=2):e.Value===this.lwa?(e.Value=this.lwawh,i=2):e.Value===this.waw?(e.Value=this.wawHamza,i=2):e.Value===this.yeh||e.Value===this.alefMaksura||e.Value===this.farsiYeh?(e.Value=this.yehHamza,i=2):e.Type=this.hamzaAbove:t===this.madda?e.Value===this.alef&&(e.Value=this.alefMadda,i=2):e.vowel=t;return i===1&&e.Ligature++,i}return e.vowel!==""?0:(e.Value===this.lam&&(t===this.alef?(e.Value=this.lwa,e.Shapes=2,i=3):t===this.alefHamza?(e.Value=this.lwawh,e.Shapes=2,i=3):t===this.alefHamzaBelow?(e.Value=this.lwawhb,e.Shapes=2,i=3):t===this.alefMadda&&(e.Value=this.lwawm,e.Shapes=2,i=3)),i)}else return 0},o.prototype.getShapeCount=function(t){if(t>=this.hamza&&t<=this.bwhb&&!(t>=this.fathatan&&t<=this.hamzaBelow||t===this.superScriptalef)){var e=[];if(this.arabicMapTable.getValue(t))return e=this.arabicMapTable.getValue(t),e.length-1}else if(t===this.zeroWidthJoiner)return 4;return 1},o}(),Ud=function(){function o(){this.shapeValue="",this.shapeType="",this.shapeVowel="",this.shapeLigature=0,this.shapeShapes=1}return Object.defineProperty(o.prototype,"Value",{get:function(){return this.shapeValue},set:function(t){this.shapeValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"Type",{get:function(){return this.shapeType},set:function(t){this.shapeType=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"vowel",{get:function(){return this.shapeVowel},set:function(t){this.shapeVowel=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"Ligature",{get:function(){return this.shapeLigature},set:function(t){this.shapeLigature=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"Shapes",{get:function(){return this.shapeShapes},set:function(t){this.shapeShapes=t},enumerable:!0,configurable:!0}),o}(),ME=function(){function o(){this.indexes=[],this.indexLevels=[],this.mirroringShapeCharacters=new Ii,this.update()}return o.prototype.doMirrorShaping=function(t){for(var e=[],i=0;i<t.length;i++)(this.indexLevels[i]&1)==1&&this.mirroringShapeCharacters.containsKey(t[i].charCodeAt(0))?e[i]=String.fromCharCode(this.mirroringShapeCharacters.getValue(t[i].charCodeAt(0))):e[i]=t[i].toString();for(var r="",n=0;n<e.length;n++)r=r+e[n];return r},o.prototype.getLogicalToVisualString=function(t,e){var i=new PE;this.indexLevels=i.getVisualOrder(t,e),this.setDefaultIndexLevel(),this.doOrder(0,this.indexLevels.length-1);for(var r=this.doMirrorShaping(t),n="",s=0;s<this.indexes.length;s++){var l=this.indexes[s];n+=r[l]}return n.toString()},o.prototype.setDefaultIndexLevel=function(){for(var t=0;t<this.indexLevels.length;t++)this.indexes[t]=t},o.prototype.doOrder=function(t,e){for(var i=this.indexLevels[t],r=i,n=i,s=i,l=t+1;l<=e;++l){var h=this.indexLevels[l];h>i?i=h:h<r&&(r=h),n&=h,s|=h}if((s&1)!=0){if((n&1)==1){this.reArrange(t,e+1);return}for(r|=1;i>=r;){for(var c=t;;){for(;c<=e&&!(this.indexLevels[c]>=i);)c+=1;if(c>e)break;for(var u=c+1;u<=e&&!(this.indexLevels[u]<i);)u+=1;this.reArrange(c,u),c=u+1}i-=1}}},o.prototype.reArrange=function(t,e){var i=(t+e)/2;for(--e;t<i;++t,--e){var r=this.indexes[t];this.indexes[t]=this.indexes[e],this.indexes[e]=r}},o.prototype.update=function(){this.mirroringShapeCharacters.setValue(40,41),this.mirroringShapeCharacters.setValue(41,40),this.mirroringShapeCharacters.setValue(60,62),this.mirroringShapeCharacters.setValue(62,60),this.mirroringShapeCharacters.setValue(91,93),this.mirroringShapeCharacters.setValue(93,91),this.mirroringShapeCharacters.setValue(123,125),this.mirroringShapeCharacters.setValue(125,123),this.mirroringShapeCharacters.setValue(171,187),this.mirroringShapeCharacters.setValue(187,171),this.mirroringShapeCharacters.setValue(8249,8250),this.mirroringShapeCharacters.setValue(8250,8249),this.mirroringShapeCharacters.setValue(8261,8262),this.mirroringShapeCharacters.setValue(8262,8261),this.mirroringShapeCharacters.setValue(8317,8318),this.mirroringShapeCharacters.setValue(8318,8317),this.mirroringShapeCharacters.setValue(8333,8334),this.mirroringShapeCharacters.setValue(8334,8333),this.mirroringShapeCharacters.setValue(8712,8715),this.mirroringShapeCharacters.setValue(8713,8716),this.mirroringShapeCharacters.setValue(8714,8717),this.mirroringShapeCharacters.setValue(8715,8712),this.mirroringShapeCharacters.setValue(8716,8713),this.mirroringShapeCharacters.setValue(8717,8714),this.mirroringShapeCharacters.setValue(8725,10741),this.mirroringShapeCharacters.setValue(8764,8765),this.mirroringShapeCharacters.setValue(8765,8764),this.mirroringShapeCharacters.setValue(8771,8909),this.mirroringShapeCharacters.setValue(8786,8787),this.mirroringShapeCharacters.setValue(8787,8786),this.mirroringShapeCharacters.setValue(8788,8789),this.mirroringShapeCharacters.setValue(8789,8788),this.mirroringShapeCharacters.setValue(8804,8805),this.mirroringShapeCharacters.setValue(8805,8804),this.mirroringShapeCharacters.setValue(8806,8807),this.mirroringShapeCharacters.setValue(8807,8806),this.mirroringShapeCharacters.setValue(8808,8809),this.mirroringShapeCharacters.setValue(8809,8808),this.mirroringShapeCharacters.setValue(8810,8811),this.mirroringShapeCharacters.setValue(8811,8810),this.mirroringShapeCharacters.setValue(8814,8815),this.mirroringShapeCharacters.setValue(8815,8814),this.mirroringShapeCharacters.setValue(8816,8817),this.mirroringShapeCharacters.setValue(8817,8816),this.mirroringShapeCharacters.setValue(8818,8819),this.mirroringShapeCharacters.setValue(8819,8818),this.mirroringShapeCharacters.setValue(8820,8821),this.mirroringShapeCharacters.setValue(8821,8820),this.mirroringShapeCharacters.setValue(8822,8823),this.mirroringShapeCharacters.setValue(8823,8822),this.mirroringShapeCharacters.setValue(8824,8825),this.mirroringShapeCharacters.setValue(8825,8824),this.mirroringShapeCharacters.setValue(8826,8827),this.mirroringShapeCharacters.setValue(8827,8826),this.mirroringShapeCharacters.setValue(8828,8829),this.mirroringShapeCharacters.setValue(8829,8828),this.mirroringShapeCharacters.setValue(8830,8831),this.mirroringShapeCharacters.setValue(8831,8830),this.mirroringShapeCharacters.setValue(8832,8833),this.mirroringShapeCharacters.setValue(8833,8832),this.mirroringShapeCharacters.setValue(8834,8835),this.mirroringShapeCharacters.setValue(8835,8834),this.mirroringShapeCharacters.setValue(8836,8837),this.mirroringShapeCharacters.setValue(8837,8836),this.mirroringShapeCharacters.setValue(8838,8839),this.mirroringShapeCharacters.setValue(8839,8838),this.mirroringShapeCharacters.setValue(8840,8841),this.mirroringShapeCharacters.setValue(8841,8840),this.mirroringShapeCharacters.setValue(8842,8843),this.mirroringShapeCharacters.setValue(8843,8842),this.mirroringShapeCharacters.setValue(8847,8848),this.mirroringShapeCharacters.setValue(8848,8847),this.mirroringShapeCharacters.setValue(8849,8850),this.mirroringShapeCharacters.setValue(8850,8849),this.mirroringShapeCharacters.setValue(8856,10680),this.mirroringShapeCharacters.setValue(8866,8867),this.mirroringShapeCharacters.setValue(8867,8866),this.mirroringShapeCharacters.setValue(8870,10974),this.mirroringShapeCharacters.setValue(8872,10980),this.mirroringShapeCharacters.setValue(8873,10979),this.mirroringShapeCharacters.setValue(8875,10981),this.mirroringShapeCharacters.setValue(8880,8881),this.mirroringShapeCharacters.setValue(8881,8880),this.mirroringShapeCharacters.setValue(8882,8883),this.mirroringShapeCharacters.setValue(8883,8882),this.mirroringShapeCharacters.setValue(8884,8885),this.mirroringShapeCharacters.setValue(8885,8884),this.mirroringShapeCharacters.setValue(8886,8887),this.mirroringShapeCharacters.setValue(8887,8886),this.mirroringShapeCharacters.setValue(8905,8906),this.mirroringShapeCharacters.setValue(8906,8905),this.mirroringShapeCharacters.setValue(8907,8908),this.mirroringShapeCharacters.setValue(8908,8907),this.mirroringShapeCharacters.setValue(8909,8771),this.mirroringShapeCharacters.setValue(8912,8913),this.mirroringShapeCharacters.setValue(8913,8912),this.mirroringShapeCharacters.setValue(8918,8919),this.mirroringShapeCharacters.setValue(8919,8918),this.mirroringShapeCharacters.setValue(8920,8921),this.mirroringShapeCharacters.setValue(8921,8920),this.mirroringShapeCharacters.setValue(8922,8923),this.mirroringShapeCharacters.setValue(8923,8922),this.mirroringShapeCharacters.setValue(8924,8925),this.mirroringShapeCharacters.setValue(8925,8924),this.mirroringShapeCharacters.setValue(8926,8927),this.mirroringShapeCharacters.setValue(8927,8926),this.mirroringShapeCharacters.setValue(8928,8929),this.mirroringShapeCharacters.setValue(8929,8928),this.mirroringShapeCharacters.setValue(8930,8931),this.mirroringShapeCharacters.setValue(8931,8930),this.mirroringShapeCharacters.setValue(8932,8933),this.mirroringShapeCharacters.setValue(8933,8932),this.mirroringShapeCharacters.setValue(8934,8935),this.mirroringShapeCharacters.setValue(8935,8934),this.mirroringShapeCharacters.setValue(8936,8937),this.mirroringShapeCharacters.setValue(8937,8936),this.mirroringShapeCharacters.setValue(8938,8939),this.mirroringShapeCharacters.setValue(8939,8938),this.mirroringShapeCharacters.setValue(8940,8941),this.mirroringShapeCharacters.setValue(8941,8940),this.mirroringShapeCharacters.setValue(8944,8945),this.mirroringShapeCharacters.setValue(8945,8944),this.mirroringShapeCharacters.setValue(8946,8954),this.mirroringShapeCharacters.setValue(8947,8955),this.mirroringShapeCharacters.setValue(8948,8956),this.mirroringShapeCharacters.setValue(8950,8957),this.mirroringShapeCharacters.setValue(8951,8958),this.mirroringShapeCharacters.setValue(8954,8946),this.mirroringShapeCharacters.setValue(8955,8947),this.mirroringShapeCharacters.setValue(8956,8948),this.mirroringShapeCharacters.setValue(8957,8950),this.mirroringShapeCharacters.setValue(8958,8951),this.mirroringShapeCharacters.setValue(8968,8969),this.mirroringShapeCharacters.setValue(8969,8968),this.mirroringShapeCharacters.setValue(8970,8971),this.mirroringShapeCharacters.setValue(8971,8970),this.mirroringShapeCharacters.setValue(9001,9002),this.mirroringShapeCharacters.setValue(9002,9001),this.mirroringShapeCharacters.setValue(10088,10089),this.mirroringShapeCharacters.setValue(10089,10088),this.mirroringShapeCharacters.setValue(10090,10091),this.mirroringShapeCharacters.setValue(10091,10090),this.mirroringShapeCharacters.setValue(10092,10093),this.mirroringShapeCharacters.setValue(10093,10092),this.mirroringShapeCharacters.setValue(10094,10095),this.mirroringShapeCharacters.setValue(10095,10094),this.mirroringShapeCharacters.setValue(10096,10097),this.mirroringShapeCharacters.setValue(10097,10096),this.mirroringShapeCharacters.setValue(10098,10099),this.mirroringShapeCharacters.setValue(10099,10098),this.mirroringShapeCharacters.setValue(10100,10101),this.mirroringShapeCharacters.setValue(10101,10100),this.mirroringShapeCharacters.setValue(10197,10198),this.mirroringShapeCharacters.setValue(10198,10197),this.mirroringShapeCharacters.setValue(10205,10206),this.mirroringShapeCharacters.setValue(10206,10205),this.mirroringShapeCharacters.setValue(10210,10211),this.mirroringShapeCharacters.setValue(10211,10210),this.mirroringShapeCharacters.setValue(10212,10213),this.mirroringShapeCharacters.setValue(10213,10212),this.mirroringShapeCharacters.setValue(10214,10215),this.mirroringShapeCharacters.setValue(10215,10214),this.mirroringShapeCharacters.setValue(10216,10217),this.mirroringShapeCharacters.setValue(10217,10216),this.mirroringShapeCharacters.setValue(10218,10219),this.mirroringShapeCharacters.setValue(10219,10218),this.mirroringShapeCharacters.setValue(10627,10628),this.mirroringShapeCharacters.setValue(10628,10627),this.mirroringShapeCharacters.setValue(10629,10630),this.mirroringShapeCharacters.setValue(10630,10629),this.mirroringShapeCharacters.setValue(10631,10632),this.mirroringShapeCharacters.setValue(10632,10631),this.mirroringShapeCharacters.setValue(10633,10634),this.mirroringShapeCharacters.setValue(10634,10633),this.mirroringShapeCharacters.setValue(10635,10636),this.mirroringShapeCharacters.setValue(10636,10635),this.mirroringShapeCharacters.setValue(10637,10640),this.mirroringShapeCharacters.setValue(10638,10639),this.mirroringShapeCharacters.setValue(10639,10638),this.mirroringShapeCharacters.setValue(10640,10637),this.mirroringShapeCharacters.setValue(10641,10642),this.mirroringShapeCharacters.setValue(10642,10641),this.mirroringShapeCharacters.setValue(10643,10644),this.mirroringShapeCharacters.setValue(10644,10643),this.mirroringShapeCharacters.setValue(10645,10646),this.mirroringShapeCharacters.setValue(10646,10645),this.mirroringShapeCharacters.setValue(10647,10648),this.mirroringShapeCharacters.setValue(10648,10647),this.mirroringShapeCharacters.setValue(10680,8856),this.mirroringShapeCharacters.setValue(10688,10689),this.mirroringShapeCharacters.setValue(10689,10688),this.mirroringShapeCharacters.setValue(10692,10693),this.mirroringShapeCharacters.setValue(10693,10692),this.mirroringShapeCharacters.setValue(10703,10704),this.mirroringShapeCharacters.setValue(10704,10703),this.mirroringShapeCharacters.setValue(10705,10706),this.mirroringShapeCharacters.setValue(10706,10705),this.mirroringShapeCharacters.setValue(10708,10709),this.mirroringShapeCharacters.setValue(10709,10708),this.mirroringShapeCharacters.setValue(10712,10713),this.mirroringShapeCharacters.setValue(10713,10712),this.mirroringShapeCharacters.setValue(10714,10715),this.mirroringShapeCharacters.setValue(10715,10714),this.mirroringShapeCharacters.setValue(10741,8725),this.mirroringShapeCharacters.setValue(10744,10745),this.mirroringShapeCharacters.setValue(10745,10744),this.mirroringShapeCharacters.setValue(10748,10749),this.mirroringShapeCharacters.setValue(10749,10748),this.mirroringShapeCharacters.setValue(10795,10796),this.mirroringShapeCharacters.setValue(10796,10795),this.mirroringShapeCharacters.setValue(10797,10796),this.mirroringShapeCharacters.setValue(10798,10797),this.mirroringShapeCharacters.setValue(10804,10805),this.mirroringShapeCharacters.setValue(10805,10804),this.mirroringShapeCharacters.setValue(10812,10813),this.mirroringShapeCharacters.setValue(10813,10812),this.mirroringShapeCharacters.setValue(10852,10853),this.mirroringShapeCharacters.setValue(10853,10852),this.mirroringShapeCharacters.setValue(10873,10874),this.mirroringShapeCharacters.setValue(10874,10873),this.mirroringShapeCharacters.setValue(10877,10878),this.mirroringShapeCharacters.setValue(10878,10877),this.mirroringShapeCharacters.setValue(10879,10880),this.mirroringShapeCharacters.setValue(10880,10879),this.mirroringShapeCharacters.setValue(10881,10882),this.mirroringShapeCharacters.setValue(10882,10881),this.mirroringShapeCharacters.setValue(10883,10884),this.mirroringShapeCharacters.setValue(10884,10883),this.mirroringShapeCharacters.setValue(10891,10892),this.mirroringShapeCharacters.setValue(10892,10891),this.mirroringShapeCharacters.setValue(10897,10898),this.mirroringShapeCharacters.setValue(10898,10897),this.mirroringShapeCharacters.setValue(10899,10900),this.mirroringShapeCharacters.setValue(10900,10899),this.mirroringShapeCharacters.setValue(10901,10902),this.mirroringShapeCharacters.setValue(10902,10901),this.mirroringShapeCharacters.setValue(10903,10904),this.mirroringShapeCharacters.setValue(10904,10903),this.mirroringShapeCharacters.setValue(10905,10906),this.mirroringShapeCharacters.setValue(10906,10905),this.mirroringShapeCharacters.setValue(10907,10908),this.mirroringShapeCharacters.setValue(10908,10907),this.mirroringShapeCharacters.setValue(10913,10914),this.mirroringShapeCharacters.setValue(10914,10913),this.mirroringShapeCharacters.setValue(10918,10919),this.mirroringShapeCharacters.setValue(10919,10918),this.mirroringShapeCharacters.setValue(10920,10921),this.mirroringShapeCharacters.setValue(10921,10920),this.mirroringShapeCharacters.setValue(10922,10923),this.mirroringShapeCharacters.setValue(10923,10922),this.mirroringShapeCharacters.setValue(10924,10925),this.mirroringShapeCharacters.setValue(10925,10924),this.mirroringShapeCharacters.setValue(10927,10928),this.mirroringShapeCharacters.setValue(10928,10927),this.mirroringShapeCharacters.setValue(10931,10932),this.mirroringShapeCharacters.setValue(10932,10931),this.mirroringShapeCharacters.setValue(10939,10940),this.mirroringShapeCharacters.setValue(10940,10939),this.mirroringShapeCharacters.setValue(10941,10942),this.mirroringShapeCharacters.setValue(10942,10941),this.mirroringShapeCharacters.setValue(10943,10944),this.mirroringShapeCharacters.setValue(10944,10943),this.mirroringShapeCharacters.setValue(10945,10946),this.mirroringShapeCharacters.setValue(10946,10945),this.mirroringShapeCharacters.setValue(10947,10948),this.mirroringShapeCharacters.setValue(10948,10947),this.mirroringShapeCharacters.setValue(10949,10950),this.mirroringShapeCharacters.setValue(10950,10949),this.mirroringShapeCharacters.setValue(10957,10958),this.mirroringShapeCharacters.setValue(10958,10957),this.mirroringShapeCharacters.setValue(10959,10960),this.mirroringShapeCharacters.setValue(10960,10959),this.mirroringShapeCharacters.setValue(10961,10962),this.mirroringShapeCharacters.setValue(10962,10961),this.mirroringShapeCharacters.setValue(10963,10964),this.mirroringShapeCharacters.setValue(10964,10963),this.mirroringShapeCharacters.setValue(10965,10966),this.mirroringShapeCharacters.setValue(10966,10965),this.mirroringShapeCharacters.setValue(10974,8870),this.mirroringShapeCharacters.setValue(10979,8873),this.mirroringShapeCharacters.setValue(10980,8872),this.mirroringShapeCharacters.setValue(10981,8875),this.mirroringShapeCharacters.setValue(10988,10989),this.mirroringShapeCharacters.setValue(10989,10988),this.mirroringShapeCharacters.setValue(10999,11e3),this.mirroringShapeCharacters.setValue(11e3,10999),this.mirroringShapeCharacters.setValue(11001,11002),this.mirroringShapeCharacters.setValue(11002,11001),this.mirroringShapeCharacters.setValue(12296,12297),this.mirroringShapeCharacters.setValue(12297,12296),this.mirroringShapeCharacters.setValue(12298,12299),this.mirroringShapeCharacters.setValue(12299,12298),this.mirroringShapeCharacters.setValue(12300,12301),this.mirroringShapeCharacters.setValue(12301,12300),this.mirroringShapeCharacters.setValue(12302,12303),this.mirroringShapeCharacters.setValue(12303,12302),this.mirroringShapeCharacters.setValue(12304,12305),this.mirroringShapeCharacters.setValue(12305,12304),this.mirroringShapeCharacters.setValue(12308,12309),this.mirroringShapeCharacters.setValue(12309,12308),this.mirroringShapeCharacters.setValue(12310,12311),this.mirroringShapeCharacters.setValue(12311,12310),this.mirroringShapeCharacters.setValue(12312,12313),this.mirroringShapeCharacters.setValue(12313,12312),this.mirroringShapeCharacters.setValue(12314,12315),this.mirroringShapeCharacters.setValue(12315,12314),this.mirroringShapeCharacters.setValue(65288,65289),this.mirroringShapeCharacters.setValue(65289,65288),this.mirroringShapeCharacters.setValue(65308,65310),this.mirroringShapeCharacters.setValue(65310,65308),this.mirroringShapeCharacters.setValue(65339,65341),this.mirroringShapeCharacters.setValue(65341,65339),this.mirroringShapeCharacters.setValue(65371,65373),this.mirroringShapeCharacters.setValue(65373,65371),this.mirroringShapeCharacters.setValue(65375,65376),this.mirroringShapeCharacters.setValue(65376,65375),this.mirroringShapeCharacters.setValue(65378,65379),this.mirroringShapeCharacters.setValue(65379,65378)},o}(),PE=function(){function o(){this.types=[],this.textOrder=-1,this.rtlCharacterTypes=new Array(65536),this.L=0,this.LRE=1,this.LRO=2,this.R=3,this.AL=4,this.RLE=5,this.RLO=6,this.PDF=7,this.EN=8,this.ES=9,this.ET=10,this.AN=11,this.CS=12,this.NSM=13,this.BN=14,this.B=15,this.S=16,this.WS=17,this.ON=18,this.charTypes=[this.L,this.EN,this.BN,this.ES,this.ES,this.S,this.ET,this.ET,this.B,this.AN,this.AN,this.S,this.CS,this.CS,this.WS,this.NSM,this.NSM,this.B,this.BN,27,this.BN,28,30,this.B,31,31,this.S,32,32,this.WS,33,34,this.ON,35,37,this.ET,38,42,this.ON,43,43,this.ET,44,44,this.CS,45,45,this.ET,46,46,this.CS,47,47,this.CS,48,57,this.EN,58,58,this.CS,59,64,this.ON,65,90,this.L,91,96,this.ON,97,122,this.L,123,126,this.ON,127,132,this.BN,133,133,this.B,134,159,this.BN,160,160,this.CS,161,161,this.ON,162,165,this.ET,166,169,this.ON,170,170,this.L,171,175,this.ON,176,177,this.ET,178,179,this.EN,180,180,this.ON,181,181,this.L,182,184,this.ON,185,185,this.EN,186,186,this.L,187,191,this.ON,192,214,this.L,215,215,this.ON,216,246,this.L,247,247,this.ON,248,696,this.L,697,698,this.ON,699,705,this.L,706,719,this.ON,720,721,this.L,722,735,this.ON,736,740,this.L,741,749,this.ON,750,750,this.L,751,767,this.ON,768,855,this.NSM,856,860,this.L,861,879,this.NSM,880,883,this.L,884,885,this.ON,886,893,this.L,894,894,this.ON,895,899,this.L,900,901,this.ON,902,902,this.L,903,903,this.ON,904,1013,this.L,1014,1014,this.ON,1015,1154,this.L,1155,1158,this.NSM,1159,1159,this.L,1160,1161,this.NSM,1162,1417,this.L,1418,1418,this.ON,1419,1424,this.L,1425,1441,this.NSM,1442,1442,this.L,1443,1465,this.NSM,1466,1466,this.L,1467,1469,this.NSM,1470,1470,this.R,1471,1471,this.NSM,1472,1472,this.R,1473,1474,this.NSM,1475,1475,this.R,1476,1476,this.NSM,1477,1487,this.L,1488,1514,this.R,1515,1519,this.L,1520,1524,this.R,1525,1535,this.L,1536,1539,this.AL,1540,1547,this.L,1548,1548,this.CS,1549,1549,this.AL,1550,1551,this.ON,1552,1557,this.NSM,1558,1562,this.L,1563,1563,this.AL,1564,1566,this.L,1567,1567,this.AL,1568,1568,this.L,1569,1594,this.AL,1595,1599,this.L,1600,1610,this.AL,1611,1624,this.NSM,1625,1631,this.L,1632,1641,this.AN,1642,1642,this.ET,1643,1644,this.AN,1645,1647,this.AL,1648,1648,this.NSM,1649,1749,this.AL,1750,1756,this.NSM,1757,1757,this.AL,1758,1764,this.NSM,1765,1766,this.AL,1767,1768,this.NSM,1769,1769,this.ON,1770,1773,this.NSM,1774,1775,this.AL,1776,1785,this.EN,1786,1805,this.AL,1806,1806,this.L,1807,1807,this.BN,1808,1808,this.AL,1809,1809,this.NSM,1810,1839,this.AL,1840,1866,this.NSM,1867,1868,this.L,1869,1871,this.AL,1872,1919,this.L,1920,1957,this.AL,1958,1968,this.NSM,1969,1969,this.AL,1970,2304,this.L,2305,2306,this.NSM,2307,2363,this.L,2364,2364,this.NSM,2365,2368,this.L,2369,2376,this.NSM,2377,2380,this.L,2381,2381,this.NSM,2382,2384,this.L,2385,2388,this.NSM,2389,2401,this.L,2402,2403,this.NSM,2404,2432,this.L,2433,2433,this.NSM,2434,2491,this.L,2492,2492,this.NSM,2493,2496,this.L,2497,2500,this.NSM,2501,2508,this.L,2509,2509,this.NSM,2510,2529,this.L,2530,2531,this.NSM,2532,2545,this.L,2546,2547,this.ET,2548,2560,this.L,2561,2562,this.NSM,2563,2619,this.L,2620,2620,this.NSM,2621,2624,this.L,2625,2626,this.NSM,2627,2630,this.L,2631,2632,this.NSM,2633,2634,this.L,2635,2637,this.NSM,2638,2671,this.L,2672,2673,this.NSM,2674,2688,this.L,2689,2690,this.NSM,2691,2747,this.L,2748,2748,this.NSM,2749,2752,this.L,2753,2757,this.NSM,2758,2758,this.L,2759,2760,this.NSM,2761,2764,this.L,2765,2765,this.NSM,2766,2785,this.L,2786,2787,this.NSM,2788,2800,this.L,2801,2801,this.ET,2802,2816,this.L,2817,2817,this.NSM,2818,2875,this.L,2876,2876,this.NSM,2877,2878,this.L,2879,2879,this.NSM,2880,2880,this.L,2881,2883,this.NSM,2884,2892,this.L,2893,2893,this.NSM,2894,2901,this.L,2902,2902,this.NSM,2903,2945,this.L,2946,2946,this.NSM,2947,3007,this.L,3008,3008,this.NSM,3009,3020,this.L,3021,3021,this.NSM,3022,3058,this.L,3059,3064,this.ON,3065,3065,this.ET,3066,3066,this.ON,3067,3133,this.L,3134,3136,this.NSM,3137,3141,this.L,3142,3144,this.NSM,3145,3145,this.L,3146,3149,this.NSM,3150,3156,this.L,3157,3158,this.NSM,3159,3259,this.L,3260,3260,this.NSM,3261,3275,this.L,3276,3277,this.NSM,3278,3392,this.L,3393,3395,this.NSM,3396,3404,this.L,3405,3405,this.NSM,3406,3529,this.L,3530,3530,this.NSM,3531,3537,this.L,3538,3540,this.NSM,3541,3541,this.L,3542,3542,this.NSM,3543,3632,this.L,3633,3633,this.NSM,3634,3635,this.L,3636,3642,this.NSM,3643,3646,this.L,3647,3647,this.ET,3648,3654,this.L,3655,3662,this.NSM,3663,3760,this.L,3761,3761,this.NSM,3762,3763,this.L,3764,3769,this.NSM,3770,3770,this.L,3771,3772,this.NSM,3773,3783,this.L,3784,3789,this.NSM,3790,3863,this.L,3864,3865,this.NSM,3866,3892,this.L,3893,3893,this.NSM,3894,3894,this.L,3895,3895,this.NSM,3896,3896,this.L,3897,3897,this.NSM,3898,3901,this.ON,3902,3952,this.L,3953,3966,this.NSM,3967,3967,this.L,3968,3972,this.NSM,3973,3973,this.L,3974,3975,this.NSM,3976,3983,this.L,3984,3991,this.NSM,3992,3992,this.L,3993,4028,this.NSM,4029,4037,this.L,4038,4038,this.NSM,4039,4140,this.L,4141,4144,this.NSM,4145,4145,this.L,4146,4146,this.NSM,4147,4149,this.L,4150,4151,this.NSM,4152,4152,this.L,4153,4153,this.NSM,4154,4183,this.L,4184,4185,this.NSM,4186,5759,this.L,5760,5760,this.WS,5761,5786,this.L,5787,5788,this.ON,5789,5905,this.L,5906,5908,this.NSM,5909,5937,this.L,5938,5940,this.NSM,5941,5969,this.L,5970,5971,this.NSM,5972,6001,this.L,6002,6003,this.NSM,6004,6070,this.L,6071,6077,this.NSM,6078,6085,this.L,6086,6086,this.NSM,6087,6088,this.L,6089,6099,this.NSM,6100,6106,this.L,6107,6107,this.ET,6108,6108,this.L,6109,6109,this.NSM,6110,6127,this.L,6128,6137,this.ON,6138,6143,this.L,6144,6154,this.ON,6155,6157,this.NSM,6158,6158,this.WS,6159,6312,this.L,6313,6313,this.NSM,6314,6431,this.L,6432,6434,this.NSM,6435,6438,this.L,6439,6443,this.NSM,6444,6449,this.L,6450,6450,this.NSM,6451,6456,this.L,6457,6459,this.NSM,6460,6463,this.L,6464,6464,this.ON,6465,6467,this.L,6468,6469,this.ON,6470,6623,this.L,6624,6655,this.ON,6656,8124,this.L,8125,8125,this.ON,8126,8126,this.L,8127,8129,this.ON,8130,8140,this.L,8141,8143,this.ON,8144,8156,this.L,8157,8159,this.ON,8160,8172,this.L,8173,8175,this.ON,8176,8188,this.L,8189,8190,this.ON,8191,8191,this.L,8192,8202,this.WS,8203,8205,this.BN,8206,8206,this.L,8207,8207,this.R,8208,8231,this.ON,8232,8232,this.WS,8233,8233,this.B,8234,8234,this.LRE,8235,8235,this.RLE,8236,8236,this.PDF,8237,8237,this.LRO,8238,8238,this.RLO,8239,8239,this.WS,8240,8244,this.ET,8245,8276,this.ON,8277,8278,this.L,8279,8279,this.ON,8280,8286,this.L,8287,8287,this.WS,8288,8291,this.BN,8292,8297,this.L,8298,8303,this.BN,8304,8304,this.EN,8305,8307,this.L,8308,8313,this.EN,8314,8315,this.ET,8316,8318,this.ON,8319,8319,this.L,8320,8329,this.EN,8330,8331,this.ET,8332,8334,this.ON,8335,8351,this.L,8352,8369,this.ET,8370,8399,this.L,8400,8426,this.NSM,8427,8447,this.L,8448,8449,this.ON,8450,8450,this.L,8451,8454,this.ON,8455,8455,this.L,8456,8457,this.ON,8458,8467,this.L,8468,8468,this.ON,8469,8469,this.L,8470,8472,this.ON,8473,8477,this.L,8478,8483,this.ON,8484,8484,this.L,8485,8485,this.ON,8486,8486,this.L,8487,8487,this.ON,8488,8488,this.L,8489,8489,this.ON,8490,8493,this.L,8494,8494,this.ET,8495,8497,this.L,8498,8498,this.ON,8499,8505,this.L,8506,8507,this.ON,8508,8511,this.L,8512,8516,this.ON,8517,8521,this.L,8522,8523,this.ON,8524,8530,this.L,8531,8543,this.ON,8544,8591,this.L,8592,8721,this.ON,8722,8723,this.ET,8724,9013,this.ON,9014,9082,this.L,9083,9108,this.ON,9109,9109,this.L,9110,9168,this.ON,9169,9215,this.L,9216,9254,this.ON,9255,9279,this.L,9280,9290,this.ON,9291,9311,this.L,9312,9371,this.EN,9372,9449,this.L,9450,9450,this.EN,9451,9751,this.ON,9752,9752,this.L,9753,9853,this.ON,9854,9855,this.L,9856,9873,this.ON,9874,9887,this.L,9888,9889,this.ON,9890,9984,this.L,9985,9988,this.ON,9989,9989,this.L,9990,9993,this.ON,9994,9995,this.L,9996,10023,this.ON,10024,10024,this.L,10025,10059,this.ON,10060,10060,this.L,10061,10061,this.ON,10062,10062,this.L,10063,10066,this.ON,10067,10069,this.L,10070,10070,this.ON,10071,10071,this.L,10072,10078,this.ON,10079,10080,this.L,10081,10132,this.ON,10133,10135,this.L,10136,10159,this.ON,10160,10160,this.L,10161,10174,this.ON,10175,10191,this.L,10192,10219,this.ON,10220,10223,this.L,10224,11021,this.ON,11022,11903,this.L,11904,11929,this.ON,11930,11930,this.L,11931,12019,this.ON,12020,12031,this.L,12032,12245,this.ON,12246,12271,this.L,12272,12283,this.ON,12284,12287,this.L,12288,12288,this.WS,12289,12292,this.ON,12293,12295,this.L,12296,12320,this.ON,12321,12329,this.L,12330,12335,this.NSM,12336,12336,this.ON,12337,12341,this.L,12342,12343,this.ON,12344,12348,this.L,12349,12351,this.ON,12352,12440,this.L,12441,12442,this.NSM,12443,12444,this.ON,12445,12447,this.L,12448,12448,this.ON,12449,12538,this.L,12539,12539,this.ON,12540,12828,this.L,12829,12830,this.ON,12831,12879,this.L,12880,12895,this.ON,12896,12923,this.L,12924,12925,this.ON,12926,12976,this.L,12977,12991,this.ON,12992,13003,this.L,13004,13007,this.ON,13008,13174,this.L,13175,13178,this.ON,13179,13277,this.L,13278,13279,this.ON,13280,13310,this.L,13311,13311,this.ON,13312,19903,this.L,19904,19967,this.ON,19968,42127,this.L,42128,42182,this.ON,42183,64284,this.L,64285,64285,this.R,64286,64286,this.NSM,64287,64296,this.R,64297,64297,this.ET,64298,64310,this.R,64311,64311,this.L,64312,64316,this.R,64317,64317,this.L,64318,64318,this.R,64319,64319,this.L,64320,64321,this.R,64322,64322,this.L,64323,64324,this.R,64325,64325,this.L,64326,64335,this.R,64336,64433,this.AL,64434,64466,this.L,64467,64829,this.AL,64830,64831,this.ON,64832,64847,this.L,64848,64911,this.AL,64912,64913,this.L,64914,64967,this.AL,64968,65007,this.L,65008,65020,this.AL,65021,65021,this.ON,65022,65023,this.L,65024,65039,this.NSM,65040,65055,this.L,65056,65059,this.NSM,65060,65071,this.L,65072,65103,this.ON,65104,65104,this.CS,65105,65105,this.ON,65106,65106,this.CS,65107,65107,this.L,65108,65108,this.ON,65109,65109,this.CS,65110,65118,this.ON,65119,65119,this.ET,65120,65121,this.ON,65122,65123,this.ET,65124,65126,this.ON,65127,65127,this.L,65128,65128,this.ON,65129,65130,this.ET,65131,65131,this.ON,65132,65135,this.L,65136,65140,this.AL,65141,65141,this.L,65142,65276,this.AL,65277,65278,this.L,65279,65279,this.BN,65280,65280,this.L,65281,65282,this.ON,65283,65285,this.ET,65286,65290,this.ON,65291,65291,this.ET,65292,65292,this.CS,65293,65293,this.ET,65294,65294,this.CS,65295,65295,this.ES,65296,65305,this.EN,65306,65306,this.CS,65307,65312,this.ON,65313,65338,this.L,65339,65344,this.ON,65345,65370,this.L,65371,65381,this.ON,65382,65503,this.L,65504,65505,this.ET,65506,65508,this.ON,65509,65510,this.ET,65511,65511,this.L,65512,65518,this.ON,65519,65528,this.L,65529,65531,this.BN,65532,65533,this.ON,65534,65535,this.L];for(var t=0;t<this.charTypes.length;++t)for(var e=this.charTypes[t],i=this.charTypes[++t],r=this.charTypes[++t];e<=i;)this.rtlCharacterTypes[e++]=r}return o.prototype.getVisualOrder=function(t,e){this.types=this.getCharacterCode(t),this.textOrder=e?this.LRE:this.L,this.doVisualOrder();for(var i=[],r=0;r<this.levels.length;r++)i[r]=this.levels[r];return i},o.prototype.getCharacterCode=function(t){for(var e=[],i=0;i<t.length;i++)e[i]=this.rtlCharacterTypes[t[i].charCodeAt(0)];return e},o.prototype.setDefaultLevels=function(){for(var t=0;t<this.length;t++)this.levels[t]=this.textOrder},o.prototype.setLevels=function(){this.setDefaultLevels();for(var t=0;t<this.length;++t){var e=this.levels[t];(e&128)!=0&&(e&=127,this.result[t]=(e&1)==0?this.L:this.R),this.levels[t]=e}},o.prototype.updateLevels=function(t,e,i){if((e&1)==0)for(var r=t;r<i;++r)this.result[r]===this.R?this.levels[r]+=1:this.result[r]!==this.L&&(this.levels[r]+=2);else for(var r=t;r<i;++r)this.result[r]!==this.R&&(this.levels[r]+=1)},o.prototype.doVisualOrder=function(){this.length=this.types.length,this.result=this.types,this.levels=[],this.setLevels(),this.length=this.getEmbeddedCharactersLength();for(var t=this.textOrder,e=0;e<this.length;){for(var i=this.levels[e],r=(Math.max(t,i)&1)==0?this.L:this.R,n=e+1;n<this.length&&this.levels[n]===i;)++n;var s=n<this.length?this.levels[n]:this.textOrder,l=(Math.max(s,i)&1)==0?this.L:this.R;this.checkNSM(e,n,i,r,l),this.updateLevels(e,i,n),t=i,e=n}this.checkEmbeddedCharacters(this.length)},o.prototype.getEmbeddedCharactersLength=function(){for(var t=0,e=0;e<this.length;++e)this.types[e]===this.LRE||this.types[e]===this.RLE||this.types[e]===this.LRO||this.types[e]===this.RLO||this.types[e]===this.PDF||this.types[e]===this.BN||(this.result[t]=this.result[e],this.levels[t]=this.levels[e],t++);return t},o.prototype.checkEmbeddedCharacters=function(t){for(var e=this.types.length-1;e>=0;--e)this.types[e]===this.LRE||this.types[e]===this.RLE||this.types[e]===this.LRO||this.types[e]===this.RLO||this.types[e]===this.PDF||this.types[e]===this.BN?(this.result[e]=this.types[e],this.levels[e]=-1):(t-=1,this.result[e]=this.result[t],this.levels[e]=this.levels[t]);for(var e=0;e<this.types.length;e++)this.levels[e]===-1&&(e===0?this.levels[e]=this.textOrder:this.levels[e]=this.levels[e-1])},o.prototype.checkNSM=function(t,e,i,r,n){for(var s=r,l=t;l<e;++l)this.result[l]===this.NSM?this.result[l]=s:s=this.result[l];this.checkEuropeanDigits(t,e,i,r,n)},o.prototype.checkEuropeanDigits=function(t,e,i,r,n){for(var s=t;s<e;++s)if(this.result[s]===this.EN){for(var l=s-1;l>=t;--l)if(this.result[l]===this.L||this.result[l]===this.R||this.result[l]===this.AL){this.result[l]===this.AL&&(this.result[s]=this.AN);break}}this.checkArabicCharacters(t,e,i,r,n)},o.prototype.checkArabicCharacters=function(t,e,i,r,n){for(var s=t;s<e;++s)this.result[s]===this.AL&&(this.result[s]=this.R);this.checkEuropeanNumberSeparator(t,e,i,r,n)},o.prototype.checkEuropeanNumberSeparator=function(t,e,i,r,n){for(var s=t+1;s<e-1;++s)if(this.result[s]===this.ES||this.result[s]===this.CS){var l=this.result[s-1],h=this.result[s+1];l===this.EN&&h===this.EN?this.result[s]=this.EN:this.result[s]===this.CS&&l===this.AN&&h===this.AN&&(this.result[s]=this.AN)}this.checkEuropeanNumberTerminator(t,e,i,r,n)},o.prototype.checkEuropeanNumberTerminator=function(t,e,i,r,n){for(var s=t;s<e;++s)if(this.result[s]===this.ET){var l=s,h=[];h.push(this.ET);var c=this.getLength(l,e,h),u=l===t?r:this.result[l-1];if(u!==this.EN&&(u=c===e?n:this.result[c]),u===this.EN)for(var p=l;p<c;++p)this.result[p]=this.EN;s=c}this.checkOtherNeutrals(t,e,i,r,n)},o.prototype.checkOtherNeutrals=function(t,e,i,r,n){for(var s=t;s<e;++s)(this.result[s]===this.ES||this.result[s]===this.ET||this.result[s]===this.CS)&&(this.result[s]=this.ON);this.checkOtherCharacters(t,e,i,r,n)},o.prototype.checkOtherCharacters=function(t,e,i,r,n){for(var s=t;s<e;++s)if(this.result[s]===this.EN){for(var l=r,h=s-1;h>=t;--h)if(this.result[h]===this.L||this.result[h]===this.R){l=this.result[h];break}l===this.L&&(this.result[s]=this.L)}this.checkCommanCharacters(t,e,i,r,n)},o.prototype.getLength=function(t,e,i){for(--t;++t<e;){for(var r=this.result[t],n=0;n<i.length;++n)r===i[n]&&(t=this.getLength(++t,e,i));return t}return e},o.prototype.checkCommanCharacters=function(t,e,i,r,n){for(var s=t;s<e;++s)if(this.result[s]===this.WS||this.result[s]===this.ON||this.result[s]===this.B||this.result[s]===this.S){var l=s,h=[this.B,this.S,this.WS,this.ON],c=this.getLength(l,e,h),u=0,p=0,f=0;l===t?u=r:(u=this.result[l-1],u===this.AN?u=this.R:u===this.EN&&(u=this.R)),c===e?p=n:(p=this.result[c],p===this.AN?p=this.R:p===this.EN&&(p=this.R)),u===p?f=u:f=(i&1)==0?this.L:this.R;for(var g=l;g<c;++g)this.result[g]=f;s=c}},o}(),NE=function(){function o(){this.openBracket="(",this.closeBracket=")"}return o.prototype.layout=function(t,e,i,r,n){if(t==null)throw new Error("ArgumentNullException : line");if(e==null)throw new Error("ArgumentNullException : font");var s=[];return e.Unicode?s=this.customLayout(t,i,n,e,r):(s=[],s[0]=t),s},o.prototype.splitLayout=function(t,e,i,r,n){if(t==null)throw new Error("ArgumentNullException : line");if(e==null)throw new Error("ArgumentNullException : font");var s=[],l=!1;return(!l||s==null)&&(s=this.customSplitLayout(t,e,i,r,n)),s},o.prototype.getGlyphIndex=function(t,e,i,r,n){var s=!0,l=!1;if(t==null)throw new Error("ArgumentNullException : line");if(e==null)throw new Error("ArgumentNullException : font");if(r=null,t.length===0)return{success:l,glyphs:r};var h=new E0,c=h.shape(t,0),u=e.fontInternal,p=u.ttfReader;r=new Uint16Array(c.length);for(var f=0,g=0,C=c.length;g<C;g++){var L=c[g],D=p.getGlyph(L);D!==null&&typeof D!="undefined"&&(r[f++]=D.index)}return{success:s,glyphs:r}},o.prototype.customLayout=function(t,e,i,r,n){if(n===null||typeof n=="undefined"){if(t==null)throw new Error("ArgumentNullException : line");var s=null;if(i!==null&&typeof i!="undefined"&&i.textDirection!==Bn.None){var l=new ME;s=l.getLogicalToVisualString(t,e)}return s}else{if(t==null)throw new Error("ArgumentNullException : line");if(r==null)throw new Error("ArgumentNullException : font");var h=null;if(i!==null&&typeof i!="undefined"&&i.textDirection!==Bn.None){var c=new E0,u=c.shape(t,0);h=this.customLayout(u,e,i)}var s=[];if(n){for(var p=h.split(""),f=p.length,g=0;g<f;g++)p[g]=this.addChars(r,p[g]);s=p}else s=[],s[0]=this.addChars(r,h);return s}},o.prototype.addChars=function(t,e){var i=e;if(t==null)throw new Error("ArgumentNullException : font");if(i==null)throw new Error("ArgumentNullException : line");var r=i,n=t.fontInternal,s=n.ttfReader;t.setSymbols(r),r=s.convertString(r);var l=Lr.toUnicodeArray(r,!1);return r=Lr.byteToString(l),r},o.prototype.customSplitLayout=function(t,e,i,r,n){if(t==null)throw new Error("ArgumentNullException : line");if(e==null)throw new Error("ArgumentNullException : font");var s=this.customLayout(t,i,n),l=s.split("");return l},o}(),A0;(function(o){o[o.Paginate=0]="Paginate",o[o.OnePage=1]="OnePage"})(A0||(A0={}));var T0;(function(o){o[o.FitPage=0]="FitPage",o[o.FitElement=1]="FitElement",o[o.FitColumnsToPage=2]="FitColumnsToPage"})(T0||(T0={}));var ss;(function(o){o[o.Start=0]="Start",o[o.Line=1]="Line",o[o.Bezier3=3]="Bezier3",o[o.Bezier=3]="Bezier",o[o.PathTypeMask=7]="PathTypeMask",o[o.DashMode=16]="DashMode",o[o.PathMarker=32]="PathMarker",o[o.CloseSubpath=128]="CloseSubpath"})(ss||(ss={}));var qd=function(){function o(t){this.currentPosition=-1,this.value=t}return Object.defineProperty(o.prototype,"status",{get:function(){return this.objectStatus},set:function(t){this.objectStatus=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isSaving",{get:function(){return this.saving},set:function(t){this.saving=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"objectCollectionIndex",{get:function(){return this.index},set:function(t){this.index=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"position",{get:function(){return this.currentPosition},set:function(t){this.currentPosition=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"clonedObject",{get:function(){var t=null;return t},enumerable:!0,configurable:!0}),o.prototype.save=function(t){t.write(this.boolToStr(this.value))},o.prototype.clone=function(t){var e=new o(this.value);return e},o.prototype.boolToStr=function(t){return t?"true":"false"},o}(),BE=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ho=function(o){BE(t,o);function t(e){var i=o.call(this)||this;return i.mbackground=new ya(255,255,255),i.mbStroking=!1,i.mfunction=null,i.dictionaryProperties=new $i,i.mpatternDictionary=new Ei,i.mpatternDictionary.items.setValue(i.dictionaryProperties.type,new $t(i.dictionaryProperties.pattern)),i.mpatternDictionary.items.setValue(i.dictionaryProperties.patternType,new It(2)),i.shading=e,i.colorSpace=Ri.Rgb,i}return Object.defineProperty(t.prototype,"background",{get:function(){return this.mbackground},set:function(e){this.mbackground=e;var i=this.shading;e.isEmpty?i.remove(this.dictionaryProperties.background):i.items.setValue(this.dictionaryProperties.background,e.toArray(this.colorSpace))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"antiAlias",{get:function(){var e=this.shading,i=e.items.getValue(this.dictionaryProperties.antiAlias);return i.value},set:function(e){var i=this.shading,r=i.items.getValue(this.dictionaryProperties.antiAlias);r==null&&typeof r=="undefined"?(r=new qd(e),i.items.setValue(this.dictionaryProperties.antiAlias,r)):r.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"function",{get:function(){return this.mfunction},set:function(e){this.mfunction=e,e!=null&&typeof e!="undefined"?this.shading.items.setValue(this.dictionaryProperties.function,new Ai(this.mfunction)):this.shading.remove(this.dictionaryProperties.function)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bBox",{get:function(){var e=this.shading,i=e.items.getValue(this.dictionaryProperties.bBox);return i},set:function(e){var i=this.shading;e==null&&typeof e=="undefined"?i.remove(this.dictionaryProperties.bBox):i.items.setValue(this.dictionaryProperties.bBox,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"colorSpace",{get:function(){return this.mcolorSpace},set:function(e){var i=this.shading.items.getValue(this.dictionaryProperties.colorSpace);if(e!==this.mcolorSpace||i==null){this.mcolorSpace=e;var r=this.colorSpaceToDeviceName(e);this.shading.items.setValue(this.dictionaryProperties.colorSpace,new $t(r))}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stroking",{get:function(){return this.mbStroking},set:function(e){this.mbStroking=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"patternDictionary",{get:function(){return this.mpatternDictionary==null&&(this.mpatternDictionary=new Ei),this.mpatternDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shading",{get:function(){return this.mshading},set:function(e){if(e==null)throw new Error("ArgumentNullException : Shading");e!==this.mshading&&(this.mshading=e,this.patternDictionary.items.setValue(this.dictionaryProperties.shading,new Ai(this.mshading)))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"matrix",{get:function(){return this.mmatrix},set:function(e){if(e==null)throw new Error("ArgumentNullException : Matrix");if(e!==this.mmatrix){this.mmatrix=e.clone();var i=new Zi(this.mmatrix.matrix.elements);this.mpatternDictionary.items.setValue(this.dictionaryProperties.matrix,i)}},enumerable:!0,configurable:!0}),t.prototype.monitorChanges=function(e,i,r,n,s){var l=!1;if(e instanceof t){this.colorSpace!==s&&(this.colorSpace=s,this.resetFunction()),i.setColorSpace("Pattern",this.mbStroking);var h=r.getResources(),c=h.getName(this);i.setColourWithPattern(null,c,this.mbStroking),l=!0}return l},t.prototype.resetChanges=function(e){},t.prototype.colorSpaceToDeviceName=function(e){var i;switch(e){case Ri.Rgb:i="DeviceRGB";break}return i},t.prototype.resetPatternDictionary=function(e){this.mpatternDictionary=e},t.prototype.cloneAntiAliasingValue=function(e){if(e==null)throw new Error("ArgumentNullException : brush");var i=this.shading,r=i.items.getValue(this.dictionaryProperties.antiAlias);r!=null&&e.shading.items.setValue(this.dictionaryProperties.antiAlias,new qd(r.value))},t.prototype.cloneBackgroundValue=function(e){var i=this.background;i.isEmpty||(e.background=i)},Object.defineProperty(t.prototype,"element",{get:function(){return this.patternDictionary},enumerable:!0,configurable:!0}),t}(ba),Zd=function(){function o(t,e){if(this.dictionaryProperties=new $i,this.writeTransformation=!0,typeof t!="undefined")if(t instanceof St&&typeof e=="undefined"){this.content=new Tr;var i=new St(t.width,t.height);this.setSize(i),this.initialize()}else this.content=new Tr,this.setSize(new St(t,e)),this.initialize()}return Object.defineProperty(o.prototype,"size",{get:function(){return this.templateSize},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"width",{get:function(){return this.size.width},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this.size.height},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"graphics",{get:function(){if(this.pdfGraphics==null||typeof this.pdfGraphics=="undefined"){var t=new Gd(this),e=new Yd(this.size,t,this.content);this.pdfGraphics=e,this.pdfGraphics.initializeCoordinates()}return this.pdfGraphics},enumerable:!0,configurable:!0}),o.prototype.getResources=function(){return this.resources==null&&(this.resources=new kl,this.content.items.setValue(this.dictionaryProperties.resources,this.resources)),this.resources},o.prototype.initialize=function(){this.addType(),this.addSubType()},o.prototype.addType=function(){var t=new $t(this.dictionaryProperties.xObject);this.content.items.setValue(this.dictionaryProperties.type,t)},o.prototype.addSubType=function(){var t=new $t(this.dictionaryProperties.form);this.content.items.setValue(this.dictionaryProperties.subtype,t)},o.prototype.reset=function(t){typeof t=="undefined"?(this.resources!=null&&(this.resources=null,this.content.remove(this.dictionaryProperties.resources)),this.graphics!=null&&this.graphics.reset(this.size)):(this.setSize(t),this.reset())},o.prototype.setSize=function(t){var e=new bi(new oi(0,0),t),i=Zi.fromRectangle(e);this.content.items.setValue(this.dictionaryProperties.bBox,i),this.templateSize=t},Object.defineProperty(o.prototype,"element",{get:function(){return this.content},enumerable:!0,configurable:!0}),o}(),co;(function(o){o[o.Unknown=0]="Unknown",o[o.Bmp=1]="Bmp",o[o.Emf=2]="Emf",o[o.Gif=3]="Gif",o[o.Jpeg=4]="Jpeg",o[o.Png=5]="Png",o[o.Wmf=6]="Wmf",o[o.Icon=7]="Icon"})(co||(co={}));var FE=function(){function o(t){this.sof1Marker=193,this.sof2Marker=194,this.sof3Marker=195,this.sof5Marker=197,this.sof6Marker=198,this.sof7Marker=199,this.sof9Marker=201,this.sof10Marker=202,this.sof11Marker=203,this.sof13Marker=205,this.sof14Marker=206,this.sof15Marker=207,this.mFormat=co.Unknown,this.mbitsPerComponent=8,this.dictionaryProperties=new $i,this.mStream=t,this.initialize()}return Object.defineProperty(o.prototype,"height",{get:function(){return this.mHeight},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"width",{get:function(){return this.mWidth},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"bitsPerComponent",{get:function(){return this.mbitsPerComponent},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"size",{get:function(){return this.mImageData.count},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"imageData",{get:function(){return this.mImageData},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"imageDataAsNumberArray",{get:function(){return this.mImageData.internalBuffer.buffer},enumerable:!0,configurable:!0}),o.prototype.initialize=function(){this.mFormat===co.Unknown&&this.checkIfJpeg()&&(this.mFormat=co.Jpeg,this.parseJpegImage()),this.reset(),this.mImageData=new Tl(this.mStream.count),this.mStream.read(this.mImageData,0,this.mImageData.count)},o.prototype.reset=function(){this.mStream.position=0},o.prototype.parseJpegImage=function(){this.reset();var t=new Tl(this.mStream.count);this.mStream.read(t,0,t.count);for(var e=4,i=!1,r=t.getBuffer(e)*256+t.getBuffer(e+1);e<t.count;)if(e+=r,e<t.count)if(t.getBuffer(e+1)===192){this.mHeight=t.getBuffer(e+5)*256+t.getBuffer(e+6),this.mWidth=t.getBuffer(e+7)*256+t.getBuffer(e+8);return}else e+=2,r=t.getBuffer(e)*256+t.getBuffer(e+1);else{i=!0;break}i&&(this.mStream.position=0,this.skip(this.mStream,2),this.readExceededJPGImage(this.mStream))},Object.defineProperty(o.prototype,"format",{get:function(){return this.mFormat},enumerable:!0,configurable:!0}),o.prototype.checkIfJpeg=function(){this.reset();for(var t=0;t<o.mJpegHeader.length;t++){if(o.mJpegHeader[t]!==this.mStream.readByte(t))return!1;this.mStream.position++}return!0},o.prototype.getImageDictionary=function(){if(this.mFormat===co.Jpeg){var t=this.imageData.internalBuffer.length;this.imageStream=new Tr,this.imageStream.isImage=!0;for(var e="",i="",r=0;r<this.imageDataAsNumberArray.byteLength;r++)e+=String.fromCharCode(null,this.mStream.readByte(r));for(var r=0;r<e.length;r++)r%2!=0&&(i+=e[r]);return this.imageStream.data=[i],this.imageStream.compress=!1,this.imageStream.items.setValue(this.dictionaryProperties.type,new $t(this.dictionaryProperties.xObject)),this.imageStream.items.setValue(this.dictionaryProperties.subtype,new $t(this.dictionaryProperties.image)),this.imageStream.items.setValue(this.dictionaryProperties.width,new It(this.width)),this.imageStream.items.setValue(this.dictionaryProperties.height,new It(this.height)),this.imageStream.items.setValue(this.dictionaryProperties.bitsPerComponent,new It(this.bitsPerComponent)),this.imageStream.items.setValue(this.dictionaryProperties.filter,new $t(this.dictionaryProperties.dctdecode)),this.imageStream.items.setValue(this.dictionaryProperties.colorSpace,new $t(this.getColorSpace())),this.imageStream.items.setValue(this.dictionaryProperties.decodeParms,this.getDecodeParams()),this.imageStream}else return this.imageStream},o.prototype.getColorSpace=function(){return this.dictionaryProperties.deviceRgb},o.prototype.getDecodeParams=function(){var t=new Ei;return t.items.setValue(this.dictionaryProperties.columns,new It(this.width)),t.items.setValue(this.dictionaryProperties.blackIs1,new qd(!0)),t.items.setValue(this.dictionaryProperties.k,new It(-1)),t.items.setValue(this.dictionaryProperties.predictor,new It(15)),t.items.setValue(this.dictionaryProperties.bitsPerComponent,new It(this.bitsPerComponent)),t},o.prototype.readExceededJPGImage=function(t){this.mStream=t;for(var e=!0;e;){var i=this.getMarker(t);switch(i){case this.sof1Marker:case this.sof2Marker:case this.sof3Marker:case this.sof5Marker:case this.sof6Marker:case this.sof7Marker:case this.sof9Marker:case this.sof10Marker:case this.sof11Marker:case this.sof13Marker:case this.sof14Marker:case this.sof15Marker:t.position+=3,this.mHeight=this.mStream.readNextTwoBytes(t),this.mWidth=this.mStream.readNextTwoBytes(t),e=!1;break;default:this.skipStream(t);break}}},o.prototype.skip=function(t,e){this.mStream=t;var i=new Tl(e);this.mStream.read(i,0,i.count)},o.prototype.getMarker=function(t){var e=0,i=32;for(i=t.readByte(this.mStream.position),t.position++;i!==255;)e++,i=t.readByte(this.mStream.position),t.position++;do i=t.readByte(this.mStream.position),t.position++;while(i===255);return i},o.prototype.skipStream=function(t){var e=this.mStream.readNextTwoBytes(t)-2;e>0&&(t.position+=e)},o.mPngHeader=[137,80,78,71,13,10,26,10],o.mJpegHeader=[255,216],o.GIF_HEADER="G,I,F,8",o.BMP_HEADER="B,M",o}(),Lc=function(){function o(t){this.updateProportionsHelper(t)}return o.prototype.convertUnits=function(t,e,i){return this.convertFromPixels(this.convertToPixels(t,e),i)},o.prototype.convertToPixels=function(t,e){var i=e,r=t*this.proportions[i];return r},o.prototype.convertFromPixels=function(t,e){var i=e,r=t/this.proportions[i];return r},o.prototype.updateProportionsHelper=function(t){this.proportions=[t/2.54,t/6,1,t/72,t,t/300,t/25.4]},o.horizontalResolution=96,o.verticalResolution=96,o}(),L0=function(){function o(){}return Object.defineProperty(o.prototype,"width",{get:function(){return this.imageWidth},set:function(t){this.imageWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this.imageHeight},set:function(t){this.imageHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"size",{set:function(t){this.width=t.width,this.height=t.height},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"physicalDimension",{get:function(){return this.imagePhysicalDimension=this.getPointSize(this.width,this.height,this.horizontalResolution,this.verticalResolution),new St(this.width,this.height)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"element",{get:function(){return this.imageStream},enumerable:!0,configurable:!0}),o.prototype.getPointSize=function(t,e,i,r){if(typeof i=="undefined"){var n=Lc.horizontalResolution,s=Lc.verticalResolution,l=this.getPointSize(t,e,n,s);return l}else{var h=new Lc(i),c=new Lc(r),u=h.convertUnits(t,ao.Pixel,ao.Point),p=c.convertUnits(e,ao.Pixel,ao.Point),l=new St(u,p);return l}},o}(),HE=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),k0=function(o){HE(t,o);function t(e){var i=o.call(this)||this;return i.imageStatus=!0,i.dictionaryProperties=new $i,i.loadImage(e),i}return t.prototype.loadImage=function(e){var i=this.initializeAsync(e)},t.prototype.initializeAsync=function(e){var i=new Tl(e.length);i.writeFromBase64String(e),this.decoder=new FE(i),this.height=this.decoder.height,this.width=this.decoder.width,this.bitsPerComponent=this.decoder.bitsPerComponent},t.prototype.save=function(){this.imageStatus=!0,this.imageStream=this.decoder.getImageDictionary()},t}(L0),VE=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),kl=function(o){VE(t,o);function t(e){var i=o.call(this,e)||this;return i.properties=new Ei,i}return Object.defineProperty(t.prototype,"names",{get:function(){return this.getNames()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"document",{get:function(){return this.pdfDocument},set:function(e){this.pdfDocument=e},enumerable:!0,configurable:!0}),t.prototype.getName=function(e){var i=e.element,r=null;if(this.names.containsKey(i)&&(r=this.names.getValue(i)),r==null){var n=this.generateName();r=new $t(n),this.names.setValue(i,r),e instanceof Ns?this.add(e,r):e instanceof Zd?this.add(e,r):e instanceof ho||e instanceof Ca?this.add(e,r):e instanceof Wd?this.add(e,r):(e instanceof L0||e instanceof k0)&&this.add(e,r)}return r},t.prototype.getNames=function(){this.pdfNames==null&&(this.pdfNames=new y0);var e=this.items.getValue(this.dictionaryProperties.font);if(e!=null){var i=e,r=e;r=h0.dereference(e)}return this.pdfNames},t.prototype.requireProcedureSet=function(e){if(e==null)throw new Error("ArgumentNullException:procedureSetName");var i=this.items.getValue(this.dictionaryProperties.procset);i==null&&(i=new Zi,this.items.setValue(this.dictionaryProperties.procset,i));var r=new $t(e);i.contains(r)||i.add(r)},t.prototype.removeFont=function(e){for(var i=null,r=this.pdfNames.keys(),n=0;n<this.pdfNames.size();n++)if(this.pdfNames.getValue(r[n])===new $t(e)){i=r[n];break}i!=null&&this.pdfNames.remove(i)},t.prototype.generateName=function(){var e=zE.getNewGuidString();return e},t.prototype.add=function(e,i){if(e instanceof Ns){var r=null,n=this.items.getValue(this.dictionaryProperties.font);if(n!=null){var s=n;r=n,r=n}else r=new Ei,this.items.setValue(this.dictionaryProperties.font,r);r.items.setValue(i.value,new Ai(e.element))}else if(e instanceof Zd){var l=void 0;l=this.items.getValue(this.dictionaryProperties.xObject),l==null&&(l=new Ei,this.items.setValue(this.dictionaryProperties.xObject,l)),l.items.setValue(i.value,new Ai(e.element))}else if(e instanceof ba){if(e instanceof ho||e instanceof Ca){var h=e.element;if(h!=null){var c=this.items.getValue(this.dictionaryProperties.pattern);c==null&&(c=new Ei,this.items.setValue(this.dictionaryProperties.pattern,c)),c.items.setValue(i.value,new Ai(h))}}}else if(e instanceof Wd){var h=e.element,u=null;u=this.items.getValue(this.dictionaryProperties.extGState),u==null&&(u=new Ei,this.items.setValue(this.dictionaryProperties.extGState,u)),u.items.setValue(i.value,new Ai(h))}else{var l=this.Dictionary.items.getValue(this.dictionaryProperties.xObject),p=void 0;typeof this.pdfDocument!="undefined"&&(p=this.pdfDocument.sections.element.items.getValue(this.dictionaryProperties.resources).items.getValue(this.dictionaryProperties.xObject));var f=this.Dictionary.items.values(),g=!1,C=void 0;if(typeof this.pdfDocument!="undefined"&&(typeof p===void 0||p==null))p=new Ei,this.pdfDocument.sections.element.items.getValue(this.dictionaryProperties.resources).items.setValue(this.dictionaryProperties.xObject,p);else if(typeof this.pdfDocument!="undefined")for(var L=p.items.values(),D=0;D<L.length;D++)typeof L[D]!="undefined"&&typeof L[D].element!="undefined"&&L[D].element.data[0]===e.element.data[0]&&(C=L[D],g=!0);if(l==null&&(l=new Ei,this.Dictionary.items.setValue(this.dictionaryProperties.xObject,l)),g&&typeof C!="undefined")l.items.setValue(i.value,C);else{var s=new Ai(e.element);l.items.setValue(i.value,s),typeof this.pdfDocument!="undefined"&&p.items.setValue(i.value,s)}}},t}(Ei),zE=function(){function o(){}return o.getNewGuidString=function(){return"aaaaaaaa-aaaa-4aaa-baaa-aaaaaaaaaaaa".replace(/[ab]/g,function(t){var e=Math.random()*16|0,i=t==="a"?e:e&3|8;return i.toString(16)})},o}(),_E=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ca=function(o){_E(t,o);function t(e,i){var r=o.call(this)||this;r.mStroking=!1,r.mLocation=new oi(0,0),r.mDictionaryProperties=new $i;var n=null;return e instanceof Hd?n=e:e instanceof St&&(n=new Hd(0,0,e.width,e.height)),i!==null&&i instanceof Fs&&(r.mPage=i),r.brushStream=new Tr,r.mResources=new kl,r.brushStream.items.setValue(r.mDictionaryProperties.resources,r.mResources),r.setBox(n),r.setObligatoryFields(),i!==null&&i instanceof Fs&&(r.mPage=i,r.graphics.colorSpace=i.document.colorSpace),r}return t.prototype.initialize=function(e,i,r,n){this.mPage=i,this.mLocation=r,this.mTransformationMatrix=n,this.tempBrushStream=this.brushStream,this.brushStream=new Tr;var s=new kl;return this.brushStream.items.setValue(this.mDictionaryProperties.resources,s),this.setBox(e),this.setObligatoryFields(),this},Object.defineProperty(t.prototype,"location",{get:function(){return this.mLocation},set:function(e){this.mLocation=e},enumerable:!0,configurable:!0}),t.prototype.setObligatoryFields=function(){if(this.brushStream.items.setValue(this.mDictionaryProperties.patternType,new It(1)),this.brushStream.items.setValue(this.mDictionaryProperties.paintType,new It(1)),this.brushStream.items.setValue(this.mDictionaryProperties.tilingType,new It(1)),this.brushStream.items.setValue(this.mDictionaryProperties.xStep,new It(this.mBox.right-this.mBox.left)),this.brushStream.items.setValue(this.mDictionaryProperties.yStep,new It(this.mBox.bottom-this.mBox.top)),this.mPage!=null&&this.mLocation!=null)if(this.mTransformationMatrix==null&&typeof this.mTransformationMatrix=="undefined"){var e=this.mPage.size.height%this.rectangle.size.height-this.mLocation.y;this.brushStream.items.setValue(this.mDictionaryProperties.matrix,new Zi([1,0,0,1,this.mLocation.x,e]))}else{var e=0,i=this.mTransformationMatrix.matrix.elements;this.mPage.size.height>this.rectangle.size.height?e=this.mTransformationMatrix.matrix.offsetY-this.mPage.size.height%this.rectangle.size.height:e=this.mPage.size.height%this.rectangle.size.height+this.mTransformationMatrix.matrix.offsetY,this.brushStream.items.setValue(this.mDictionaryProperties.matrix,new Zi([i[0],i[1],i[2],i[3],i[4],e]))}},t.prototype.setBox=function(e){this.mBox=e;var i=new bi(this.mBox.left,this.mBox.top,this.mBox.right,this.mBox.bottom);this.brushStream.items.setValue(this.mDictionaryProperties.bBox,Zi.fromRectangle(i))},Object.defineProperty(t.prototype,"rectangle",{get:function(){return this.mBox},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.mBox.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphics",{get:function(){if(this.mGraphics==null&&typeof this.mGraphics=="undefined"){var e=new Gd(this),i=new Yd(this.size,e,this.brushStream);this.mGraphics=i,this.mResources=this.getResources(),this.mGraphics.initializeCoordinates()}return this.mGraphics},enumerable:!0,configurable:!0}),t.prototype.getResources=function(){return this.mResources},Object.defineProperty(t.prototype,"stroking",{get:function(){return this.mStroking},set:function(e){this.mStroking=e},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var e=this.initialize(this.rectangle,this.mPage,this.location,this.mTransformationMatrix);return this.mTransformationMatrix!=null&&this.mTransformationMatrix.matrix!=null&&e.brushStream.items.setValue(this.mDictionaryProperties.matrix,new Zi(this.mTransformationMatrix.matrix.elements)),e.brushStream.data=this.tempBrushStream.data,e.mResources=new kl(this.mResources),e.brushStream.items.setValue(this.mDictionaryProperties.resources,e.mResources),e},t.prototype.monitorChanges=function(e,i,r,n,s){var l=!1;if(e!==this){i.setColorSpace("Pattern",this.mStroking);var h=r.getResources(),c=h.getName(this);i.setColourWithPattern(null,c,this.mStroking),l=!0}else if(e instanceof t){i.setColorSpace("Pattern",this.mStroking);var u=r.getResources(),p=u.getName(this);i.setColourWithPattern(null,p,this.mStroking),l=!0}return l},t.prototype.resetChanges=function(e){},Object.defineProperty(t.prototype,"element",{get:function(){return this.brushStream},enumerable:!0,configurable:!0}),t}(ba),Yd=function(){function o(t,e,i){this.currentColorSpace=Ri.Rgb,this.previousTextRenderingMode=ns.Fill,this.previousCharacterSpacing=0,this.previousWordSpacing=0,this.previousTextScaling=100,this.procedureSets=new uE,this.isNormalRender=!0,this.isUseFontSize=!1,this.isItalic=!1,this.isEmfTextScaled=!1,this.isEmf=!1,this.isEmfPlus=!1,this.isBaselineFormat=!0,this.emfScalingFactor=new St(0,0),this.colorSpaceChanged=!1,this.dictionaryProperties=new $i,this.isOverloadWithPosition=!1,this.isPointOverload=!1,this.currentColorSpaces=["RGB","CMYK","GrayScale","Indexed"],this.isImageOptimized=!1,this.graphicsState=[],this.istransparencySet=!1,this.internalAutomaticFields=null,this.startCutIndex=-1,this.getResources=e,this.canvasSize=t,i instanceof m0?this.pdfStreamWriter=i:this.pdfStreamWriter=new m0(i),this.initialize()}return Object.defineProperty(o.prototype,"stringLayoutResult",{get:function(){return this.pdfStringLayoutResult},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"size",{get:function(){return this.canvasSize},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"mediaBoxUpperRightBound",{get:function(){return typeof this.internalMediaBoxUpperRightBound=="undefined"&&(this.internalMediaBoxUpperRightBound=0),this.internalMediaBoxUpperRightBound},set:function(t){this.internalMediaBoxUpperRightBound=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"clientSize",{get:function(){return new St(this.clipBounds.width,this.clipBounds.height)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"colorSpace",{get:function(){return this.currentColorSpace},set:function(t){this.currentColorSpace=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"streamWriter",{get:function(){return this.pdfStreamWriter},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"matrix",{get:function(){return this.transformationMatrix==null&&(this.transformationMatrix=new Bs),this.transformationMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"layer",{get:function(){return this.pageLayer},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"page",{get:function(){return this.pageLayer.page},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"automaticFields",{get:function(){return(this.internalAutomaticFields==null||typeof this.internalAutomaticFields=="undefined")&&(this.internalAutomaticFields=new pE),this.internalAutomaticFields},enumerable:!0,configurable:!0}),o.prototype.initialize=function(){this.bStateSaved=!1,this.currentPen=null,this.currentBrush=null,this.currentFont=null,this.currentColorSpace=Ri.Rgb,this.bCSInitialized=!1,this.transformationMatrix=null,this.previousTextRenderingMode=-1,this.previousCharacterSpacing=-1,this.previousWordSpacing=-1,this.previousTextScaling=-100,this.currentStringFormat=null,this.clipBounds=new bi(new oi(0,0),this.size),this.getResources.getResources().requireProcedureSet(this.procedureSets.pdf)},o.prototype.drawPdfTemplate=function(t,e,i){if(typeof i=="undefined"){if(t==null)throw Error("ArgumentNullException-template");this.drawPdfTemplate(t,e,t.size)}else{if(t==null)throw Error("ArgumentNullException-template");var r=t.width>0?i.width/t.width:1,n=t.height>0?i.height/t.height:1,s=!(r===1&&n===1),l=this.save(),h=new Bs;this.pageLayer!=null&&this.getTranslateTransform(e.x,e.y+i.height,h),s&&this.getScaleTransform(r,n,h),this.pdfStreamWriter.modifyCtm(h);var c=this.getResources.getResources(),u=c.getName(t);this.pdfStreamWriter.executeObject(u),this.restore(l);var p=t.graphics;if(p!=null)for(var f=0;f<p.automaticFields.automaticFields.length;f++){var g=p.automaticFields.automaticFields[f],C=new oi(g.location.x+e.x,g.location.y+e.y),L=t.size.width==0?0:i.width/t.size.width,D=t.size.height==0?0:i.height/t.size.height;this.automaticFields.add(new b0(g.field,C,L,D)),this.page.dictionary.modify()}this.getResources.getResources().requireProcedureSet(this.procedureSets.imageB),this.getResources.getResources().requireProcedureSet(this.procedureSets.imageC),this.getResources.getResources().requireProcedureSet(this.procedureSets.imageI),this.getResources.getResources().requireProcedureSet(this.procedureSets.text)}},o.prototype.drawString=function(t,e,i,r,n,s,l,h,c){if(typeof t=="string"&&e instanceof Ns&&(i instanceof Ac||i===null)&&(r instanceof ba||r===null)&&typeof n=="number"&&typeof s=="number"&&(l instanceof Tc||l===null)&&typeof h=="undefined")this.isOverloadWithPosition=!0,this.drawString(t,e,i,r,n,s,this.clientSize.width-n,0,l);else{var u=i,p=r,f=n,g=s,C=l,L=h,D=c,R=new _d,B=R.layout(t,e,D,new St(C,L),this.isOverloadWithPosition,this.clientSize);if(!B.empty){var H=this.checkCorrectLayoutRectangle(B.actualSize,f,g,D);C<=0&&(f=H.x,C=H.width),L<=0&&(g=H.y,L=H.height),this.drawStringLayoutResult(B,e,u,p,new bi(f,g,C,L),D),this.isEmfTextScaled=!1,this.emfScalingFactor=new St(0,0)}this.getResources.getResources().requireProcedureSet(this.procedureSets.text),this.isNormalRender=!0,this.pdfStringLayoutResult=B,this.isUseFontSize=!1}},o.prototype.drawLine=function(t,e,i,r,n){if(e instanceof oi){var s=e,l=i;this.drawLine(t,s.x,s.y,l.x,l.y)}else{var s=e,l=i,h=r,c=n;this.stateControl(t,null,null);var u=this.streamWriter;u.beginPath(s,l),u.appendLineSegment(h,c),u.strokePath(),this.getResources.getResources().requireProcedureSet(this.procedureSets.pdf)}},o.prototype.drawRectangle=function(t,e,i,r,n,s){if(t instanceof Ac&&typeof e=="number"){var l=i;this.drawRectangle(t,null,e,l,r,n)}else if(t instanceof ba&&typeof e=="number"){var l=i;this.drawRectangle(null,t,e,l,r,n)}else{var l=i,h=r,c=n,u=s;if(e instanceof Ca){this.bCSInitialized=!1;var p=this.matrix.matrix.offsetX+l,f=void 0;this.layer!=null&&this.layer.page!=null?f=this.layer.page.size.height-this.matrix.matrix.offsetY+h:f=this.clientSize.height-this.matrix.matrix.offsetY+h,e.location=new oi(p,f),e.graphics.colorSpace=this.colorSpace}else e instanceof ho&&(e.colorSpace=this.colorSpace);e instanceof oo&&e.color.isEmpty&&(e=null);var g=t,C=e;this.stateControl(g,C,null),this.streamWriter.appendRectangle(l,h,c,u),this.drawPathHelper(g,C,!1)}},o.prototype.drawPathHelper=function(t,e,i,r){if(typeof i=="boolean"){var n=i;this.drawPathHelper(t,e,so.Winding,n)}else{var n=i,s=r,l=t!=null,h=e!=null,c=n===so.Alternate;l&&h?this.streamWriter.fillStrokePath(c):!l&&!h?this.streamWriter.endPath():l?this.streamWriter.strokePath():this.streamWriter.fillPath(c)}},o.prototype.drawImage=function(t,e,i,r,n){if(typeof e=="number"&&typeof i=="number"&&typeof r=="undefined"){var s=t.physicalDimension;this.drawImage(t,e,i,s.width,s.height)}else{var l=e,h=i,c=r,u=n;t.save();var p=new Bs;this.getTranslateTransform(l,h+u,p),this.getScaleTransform(r,n,p),this.pdfStreamWriter.write("q"),this.pdfStreamWriter.modifyCtm(p);var f=this.getResources.getResources();typeof this.pageLayer!="undefined"&&this.page!=null&&(f.document=this.page.document);var g=f.getName(t);typeof this.pageLayer!="undefined"&&this.page.setResources(f),this.pdfStreamWriter.executeObject(g),this.pdfStreamWriter.write(_e.restoreState),this.pdfStreamWriter.write(_e.newLine);var C=this.getResources.getResources();C.requireProcedureSet(this.procedureSets.imageB),C.requireProcedureSet(this.procedureSets.imageC),C.requireProcedureSet(this.procedureSets.imageI),C.requireProcedureSet(this.procedureSets.text)}},o.prototype.getLineBounds=function(t,e,i,r,n){var s;if(!e.empty&&t<e.lineCount&&t>=0){var l=e.lines[t],h=this.getTextVerticalAlignShift(e.actualSize.height,r.height,n),c=h+r.y+e.lineHeight*t,u=l.width,p=this.getHorizontalAlignShift(u,r.width,n),f=this.getLineIndent(l,n,r,t===0);p+=this.rightToLeft(n)?0:f;var g=r.x+p,C=this.shouldJustify(l,r.width,n)?r.width-f:u-f,L=e.lineHeight;s=new bi(g,c,C,L)}else s=new bi(0,0,0,0);return s},o.prototype.checkCorrectLayoutRectangle=function(t,e,i,r){var n=new bi(e,i,t.width,t.width);if(r!=null){switch(r.alignment){case wn.Center:n.x-=n.width/2;break;case wn.Right:n.x-=n.width;break}switch(r.lineAlignment){case Ms.Middle:n.y-=n.height/2;break;case Ms.Bottom:n.y-=n.height;break}}return n},o.prototype.setLayer=function(t){this.pageLayer=t;var e=t.page;e!=null&&typeof e!="undefined"&&(e.beginSave=this.pageSave)},o.prototype.pageSave=function(t){if(t.graphics.automaticFields!=null)for(var e=0;e<t.graphics.automaticFields.automaticFields.length;e++){var i=t.graphics.automaticFields.automaticFields[e];i.field.performDraw(t.graphics,i.location,i.scalingX,i.scalingY)}},o.prototype.drawStringLayoutResult=function(t,e,i,r,n,s){if(t.empty)throw new Error("ArgumentNullException:result");this.applyStringSettings(e,i,r,s,n);var l=s!=null?s.horizontalScalingFactor:100;l!==this.previousTextScaling&&!this.isEmfTextScaled&&(this.pdfStreamWriter.setTextScaling(l),this.previousTextScaling=l);var h=s==null||s.lineSpacing===0?e.height:s.lineSpacing+e.height,c=s!=null&&s.subSuperScript===Ps.SubScript,u=0;u=c?h-(e.height+e.metrics.getDescent(s)):h-e.metrics.getAscent(s),this.shift=u,this.pdfStreamWriter.startNextLine(n.x,n.y-u),this.pdfStreamWriter.setLeading(+h);for(var p=0,f="",g=0;g<t.lines.length;g++)if(p+=t.lineHeight,n.y+p>this.clientSize.height){this.startCutIndex=g;break}for(var C=this.startCutIndex;C<t.lines.length&&C>=0;C++)f+=t.lines[C].text;var L=new bi(n.x,n.y,n.width,n.height);if(this.drawLayoutResult(t,e,s,n),this.underlineStrikeoutText(i,r,t,e,L,s),this.isEmfPlus=!1,this.isUseFontSize=!1,this.startCutIndex!==-1){var D=this.getNextPage();D.graphics.drawString(f,e,i,r,n.x,0,n.width,0,s)}},o.prototype.getNextPage=function(){var t=this.currentPage.section,e=null,i=t.indexOf(this.currentPage);return i===t.count-1?e=t.add():e=t.getPages()[i+1],e},o.prototype.setClip=function(t,e){typeof e=="undefined"?this.setClip(t,so.Winding):(this.pdfStreamWriter.appendRectangle(t),this.pdfStreamWriter.clipPath(e===so.Alternate))},o.prototype.applyStringSettings=function(t,e,i,r,n){i instanceof Ca?(this.bCSInitialized=!1,i.graphics.colorSpace=this.colorSpace):i instanceof ho&&(this.bCSInitialized=!1,i.colorSpace=this.colorSpace);var s=!1,l=this.getTextRenderingMode(e,i,r);this.stateControl(e,i,t,r),this.pdfStreamWriter.beginText(),l!==this.previousTextRenderingMode&&(this.pdfStreamWriter.setTextRenderingMode(l),this.previousTextRenderingMode=l);var h=r!=null?r.characterSpacing:0;h!==this.previousCharacterSpacing&&!this.isEmfTextScaled&&(this.pdfStreamWriter.setCharacterSpacing(h),this.previousCharacterSpacing=h);var c=r!=null?r.wordSpacing:0;c!==this.previousWordSpacing&&(this.pdfStreamWriter.setWordSpacing(c),this.previousWordSpacing=c)},o.prototype.getTextVerticalAlignShift=function(t,e,i){var r=0;if(e>=0&&i!=null&&i.lineAlignment!==Ms.Top)switch(i.lineAlignment){case Ms.Middle:r=(e-t)/2;break;case Ms.Bottom:r=e-t;break}return r},o.prototype.drawLayoutResult=function(t,e,i,r){var n=this.getTextVerticalAlignShift(t.actualSize.height,r.height,i);n!==0&&this.pdfStreamWriter.startNextLine(0,n);for(var s=e,l=s!=null&&s.isUnicode,h=s!=null&&s.isEmbedFont,c=t.lines,u=0,p=c.length;u<p&&u!==this.startCutIndex;u++){var f=c[u],g=f.text,C=f.width,L=this.getHorizontalAlignShift(C,r.width,i),D=this.getLineIndent(f,i,r,u===0);L+=this.rightToLeft(i)?0:D,L!==0&&!this.isEmfTextScaled&&this.pdfStreamWriter.startNextLine(L,0),l?this.drawUnicodeLine(f,r,e,i):this.drawAsciiLine(f,r,e,i),L!==0&&!this.isEmfTextScaled&&this.pdfStreamWriter.startNextLine(-L,0),this.isOverloadWithPosition&&c.length>1&&(this.pdfStreamWriter.startNextLine(-r.x,0),r.x=0,r.width=this.clientSize.width,this.isOverloadWithPosition=!1,this.isPointOverload=!0)}this.getResources.getResources().requireProcedureSet(this.procedureSets.text),n!==0&&this.pdfStreamWriter.startNextLine(0,-(n-t.lineHeight)),this.pdfStreamWriter.endText()},o.prototype.drawAsciiLine=function(t,e,i,r){this.justifyLine(t,e.width,r);var n="";if(t.text.indexOf("(")!==-1||t.text.indexOf(")")!==-1)for(var s=0;s<t.text.length;s++)t.text[s]==="("?n+="\\(":t.text[s]===")"?n+="\\)":n+=t.text[s];n===""&&(n=t.text);var l="("+n+")";this.pdfStreamWriter.showNextLineText(new Lr(l))},o.prototype.drawUnicodeLine=function(t,e,i,r){var n=t.text,s=t.width,l=r!==null&&typeof r!="undefined"&&r.rightToLeft,h=r!==null&&typeof r!="undefined"&&(r.wordSpacing!==0||r.alignment===wn.Justify),c=i,u=this.justifyLine(t,e.width,r),p=new NE;if(l||r!==null&&typeof r!="undefined"&&r.textDirection!==Bn.None){var f=null,g=r!==null&&typeof r!="undefined"&&r.alignment===wn.Right;r!==null&&typeof r!="undefined"&&r.textDirection!==Bn.None?f=p.layout(n,c,r.textDirection===Bn.RightToLeft,h,r):f=p.layout(n,c,g,h,r);var C=null;f.length>1?r!==null&&typeof r!="undefined"&&r.textDirection!==Bn.None?C=p.splitLayout(n,c,r.textDirection===Bn.RightToLeft,h,r):C=p.splitLayout(n,c,g,h,r):C=[n],this.drawUnicodeBlocks(f,C,c,r,u)}else if(h){var L=this.breakUnicodeLine(n,c,null),f=L.tokens,C=L.words;this.drawUnicodeBlocks(f,C,c,r,u)}else{var D=this.convertToUnicode(n,c),R=this.getUnicodeString(D);this.streamWriter.showNextLineText(R)}},o.prototype.drawUnicodeBlocks=function(t,e,i,r,n){if(t==null)throw new Error("Argument Null Exception : blocks");if(e==null)throw new Error("Argument Null Exception : words");if(i==null)throw new Error("Argument Null Exception : font");this.streamWriter.startNextLine();var s=0,l=0,h=0,c=0;try{r!==null&&typeof r!="undefined"&&(h=r.firstLineIndent,c=r.paragraphIndent,r.firstLineIndent=0,r.paragraphIndent=0);var u=i.getCharWidth(kr.whiteSpace,r)+n,p=r!=null?r.characterSpacing:0,f=r!==null&&typeof r!="undefined"&&n===0?r.wordSpacing:0;u+=p+f;for(var g=0;g<t.length;g++){var C=t[g],L=e[g],D=0;if(s!==0&&this.streamWriter.startNextLine(s,0),L.length>0){D+=i.measureString(L,r).width,D+=p;var R=this.getUnicodeString(C);this.streamWriter.showText(R)}g!==t.length-1&&(s=D+u,l+=s)}l>0&&this.streamWriter.startNextLine(-l,0)}finally{r!==null&&typeof r!="undefined"&&(r.firstLineIndent=h,r.paragraphIndent=c)}},o.prototype.breakUnicodeLine=function(t,e,i){if(t===null)throw new Error("Argument Null Exception : line");i=t.split(null);for(var r=[],n=0;n<i.length;n++){var s=i[n],l=this.convertToUnicode(s,e);r[n]=l}return{tokens:r,words:i}},o.prototype.getUnicodeString=function(t){if(t===null)throw new Error("Argument Null Exception : token");var e=new Lr(t);return e.converted=!0,e.encode=xl.ForceEncoding.Ascii,e},o.prototype.convertToUnicode=function(t,e){var i=null;if(t==null)throw new Error("Argument Null Exception : text");if(e==null)throw new Error("Argument Null Exception : ttfFont");if(e.fontInternal instanceof RE){var r=e.fontInternal.ttfReader;e.setSymbols(t),i=r.convertString(t);var n=Lr.toUnicodeArray(i,!1);i=Lr.byteToString(n)}return i},o.prototype.justifyLine=function(t,e,i){var r=t.text,n=t.width,s=this.shouldJustify(t,e,i),l=i!=null&&i.wordSpacing!==0,h=kr.spaces,c=kr.getCharsCount(r,h),u=0;if(s){l&&(n-=c*i.wordSpacing);var p=e-n;u=p/c,this.pdfStreamWriter.setWordSpacing(u)}else l?this.pdfStreamWriter.setWordSpacing(i.wordSpacing):this.pdfStreamWriter.setWordSpacing(0);return u},o.prototype.reset=function(t){this.canvasSize=t,this.streamWriter.clear(),this.initialize(),this.initializeCoordinates()},o.prototype.shouldJustify=function(t,e,i){var r=t.text,n=t.width,s=i!=null&&i.alignment===wn.Justify,l=e>=0&&n<e,h=kr.spaces,c=kr.getCharsCount(r,h),u=c>0&&r[0]!==kr.whiteSpace,p=(t.lineType&an.LayoutBreak)>0,f=s&&l&&u&&(p||i.alignment===wn.Justify);return f},o.prototype.underlineStrikeoutText=function(t,e,i,r,n,s){if(r.underline||r.strikeout){var l=this.createUnderlineStikeoutPen(t,e,r,s);if(l!=null){var h=this.getTextVerticalAlignShift(i.actualSize.height,n.height,s),c=0;c=n.y+h+r.metrics.getAscent(s)+1.5*l.width;for(var u=n.y+h+r.metrics.getHeight(s)/2+1.5*l.width,p=i.lines,f=0,g=i.lineCount;f<g;f++){var C=p[f],L=C.text,D=C.width,R=this.getHorizontalAlignShift(D,n.width,s),B=this.getLineIndent(C,s,n,f===0);R+=this.rightToLeft(s)?0:B;var H=n.x+R,j=this.shouldJustify(C,n.width,s)?H+n.width-B:H+D-B;if(r.underline){var W=c;this.drawLine(l,H,W,j,W),c+=i.lineHeight}if(r.strikeout){var W=u;this.drawLine(l,H,W,j,W),u+=i.lineHeight}this.isPointOverload&&p.length>1&&(n.x=0,n.width=this.clientSize.width)}this.isPointOverload=!1}}},o.prototype.createUnderlineStikeoutPen=function(t,e,i,r){var n=i.metrics.getSize(r)/20,s=null;return t!=null?s=new Ac(t.color,n):e!=null&&(s=new Ac(e,n)),s},o.prototype.getTextRenderingMode=function(t,e,i){var r=ns.None;return t!=null&&e!=null?r=ns.FillStroke:t!=null?r=ns.Stroke:r=ns.Fill,i!=null&&i.clipPath&&(r|=ns.ClipFlag),r},o.prototype.getLineIndent=function(t,e,i,r){var n=0,s=(t.lineType&an.FirstParagraphLine)>0;return e!=null&&s&&(n=r?e.firstLineIndent:e.paragraphIndent,n=i.width>0?Math.min(i.width,n):n),n},o.prototype.getHorizontalAlignShift=function(t,e,i){var r=0;if(e>=0&&i!=null&&i.alignment!==wn.Left)switch(i.alignment){case wn.Center:r=(e-t)/2;break;case wn.Right:r=e-t;break}return r},o.prototype.rightToLeft=function(t){var e=t!==null&&typeof t!="undefined"&&t.rightToLeft;return t!==null&&typeof t!="undefined"&&t.textDirection!==Bn.None&&typeof t.textDirection!="undefined"&&(e=!0),e},o.prototype.stateControl=function(t,e,i,r){if(typeof r=="undefined")this.stateControl(t,e,i,null);else{e instanceof ho&&(this.bCSInitialized=!1,e.colorSpace=this.colorSpace),e instanceof Ca&&(this.bCSInitialized=!1,e.graphics.colorSpace=this.colorSpace);var n=!1;if(e!==null){var s=e;typeof this.pageLayer!="undefined"&&this.pageLayer!=null&&this.colorSpaceChanged===!1&&(this.lastDocumentCS=this.pageLayer.page.document.colorSpace,this.lastGraphicsCS=this.pageLayer.page.graphics.colorSpace,this.colorSpace=this.pageLayer.page.document.colorSpace,this.currentColorSpace=this.pageLayer.page.document.colorSpace,this.colorSpaceChanged=!0),this.initCurrentColorSpace(this.currentColorSpace)}else if(t!=null){var l=t;typeof this.pageLayer!="undefined"&&this.pageLayer!=null&&(this.colorSpace=this.pageLayer.page.document.colorSpace,this.currentColorSpace=this.pageLayer.page.document.colorSpace),this.initCurrentColorSpace(this.currentColorSpace)}this.penControl(t,n),this.brushControl(e,n),this.fontControl(i,r,n)}},o.prototype.initCurrentColorSpace=function(t){var e=this.getResources.getResources();this.bCSInitialized||(this.currentColorSpace!=Ri.GrayScale?(this.pdfStreamWriter.setColorSpace("Device"+this.currentColorSpaces[this.currentColorSpace],!0),this.pdfStreamWriter.setColorSpace("Device"+this.currentColorSpaces[this.currentColorSpace],!1),this.bCSInitialized=!0):(this.pdfStreamWriter.setColorSpace("DeviceGray",!0),this.pdfStreamWriter.setColorSpace("DeviceGray",!1),this.bCSInitialized=!0))},o.prototype.penControl=function(t,e){t!=null&&(this.currentPen=t,t.monitorChanges(this.currentPen,this.pdfStreamWriter,this.getResources,e,this.colorSpace,this.matrix.clone()),this.currentPen=t.clone())},o.prototype.brushControl=function(t,e){if(t!=null&&typeof t!="undefined"){var i=t.clone(),r=i;if(r!==null&&typeof r!="undefined"&&!(t instanceof oo)&&!(t instanceof Ca)){var n=r.matrix,s=this.matrix.clone();n!=null&&(n.multiply(s),s=n),r.matrix=s}this.currentBrush=r;var l=t;i.monitorChanges(this.currentBrush,this.pdfStreamWriter,this.getResources,e,this.colorSpace),this.currentBrush=t,t=null}},o.prototype.fontControl=function(t,e,i){if(t!=null){var r=e!=null?e.subSuperScript:Ps.None,n=this.currentStringFormat!=null?this.currentStringFormat.subSuperScript:Ps.None;if(i||t!==this.currentFont||r!==n){var s=this.getResources.getResources();this.currentFont=t,this.currentStringFormat=e;var l=t.metrics.getSize(e);this.isEmfTextScaled=!1;var h=s.getName(t);this.pdfStreamWriter.setFont(t,h,l)}}},o.prototype.setTransparency=function(t,e,i){if(typeof e=="undefined")this.istransparencySet=!0,this.setTransparency(t,t,xc.Normal);else if(typeof e=="number"&&typeof i=="undefined")this.setTransparency(t,e,xc.Normal);else{this.trasparencies==null&&(this.trasparencies=new y0);var r=null,n=new WE(t,e,i);this.trasparencies.containsKey(n)&&(r=this.trasparencies.getValue(n)),r==null&&(r=new Wd(t,e,i),this.trasparencies.setValue(n,r));var s=this.getResources.getResources(),l=s.getName(r),h=this.streamWriter;h.setGraphicsState(l)}},o.prototype.clipTranslateMargins=function(t,e,i,r,n,s){if(t instanceof bi&&typeof e=="undefined")this.clipBounds=t,this.pdfStreamWriter.writeComment("Clip margins."),this.pdfStreamWriter.appendRectangle(t),this.pdfStreamWriter.closePath(),this.pdfStreamWriter.clipPath(!1),this.pdfStreamWriter.writeComment("Translate co-ordinate system."),this.translateTransform(t.x,t.y);else if(typeof t=="number"){var l=new bi(i,r,this.size.width-i-n,this.size.height-r-s);this.clipBounds=l,this.pdfStreamWriter.writeComment("Clip margins."),this.pdfStreamWriter.appendRectangle(l),this.pdfStreamWriter.closePath(),this.pdfStreamWriter.clipPath(!1),this.pdfStreamWriter.writeComment("Translate co-ordinate system."),this.translateTransform(t,e)}},o.prototype.updateY=function(t){return-t},o.prototype.translateTransform=function(t,e){var i=new Bs;this.getTranslateTransform(t,e,i),this.pdfStreamWriter.modifyCtm(i),this.matrix.multiply(i)},o.prototype.getTranslateTransform=function(t,e,i){return i.translate(t,this.updateY(e)),i},o.prototype.scaleTransform=function(t,e){var i=new Bs;this.getScaleTransform(t,e,i),this.pdfStreamWriter.modifyCtm(i),this.matrix.multiply(i)},o.prototype.getScaleTransform=function(t,e,i){return i==null&&(i=new Bs),i.scale(t,e),i},o.prototype.rotateTransform=function(t){var e=new Bs;this.getRotateTransform(t,e),this.pdfStreamWriter.modifyCtm(e),this.matrix.multiply(e)},o.prototype.initializeCoordinates=function(){this.pdfStreamWriter.writeComment("Change co-ordinate system to left/top."),this.mediaBoxUpperRightBound!==-this.size.height&&this.cropBox==null&&(this.mediaBoxUpperRightBound===this.size.height||this.mediaBoxUpperRightBound===0?this.translateTransform(0,this.updateY(this.size.height)):this.translateTransform(0,this.updateY(this.mediaBoxUpperRightBound)))},o.prototype.getRotateTransform=function(t,e){return(e==null||typeof e=="undefined")&&(e=new Bs),e.rotate(this.updateY(t)),e},o.prototype.save=function(){var t=new jE(this,this.matrix.clone());return t.brush=this.currentBrush,t.pen=this.currentPen,t.font=this.currentFont,t.colorSpace=this.currentColorSpace,t.characterSpacing=this.previousCharacterSpacing,t.wordSpacing=this.previousWordSpacing,t.textScaling=this.previousTextScaling,t.textRenderingMode=this.previousTextRenderingMode,this.graphicsState.push(t),this.pdfStreamWriter.saveGraphicsState(),t},o.prototype.restore=function(t){if(typeof t=="undefined")this.graphicsState.length>0&&this.doRestoreState();else if(this.graphicsState.indexOf(t)!==-1)for(;this.graphicsState.length!==0;){var e=this.doRestoreState();if(e===t)break}},o.prototype.doRestoreState=function(){var t=this.graphicsState.pop();return this.transformationMatrix=t.matrix,this.currentBrush=t.brush,this.currentPen=t.pen,this.currentFont=t.font,this.currentColorSpace=t.colorSpace,this.previousCharacterSpacing=t.characterSpacing,this.previousWordSpacing=t.wordSpacing,this.previousTextScaling=t.textScaling,this.previousTextRenderingMode=t.textRenderingMode,this.pdfStreamWriter.restoreGraphicsState(),t},o.prototype.drawPath=function(t,e,i){e instanceof Ca?(this.bCSInitialized=!1,e.graphics.colorSpace=this.colorSpace):e instanceof ho&&(this.bCSInitialized=!1,e.colorSpace=this.colorSpace),this.stateControl(t,e,null),this.buildUpPath(i.pathPoints,i.pathTypes),this.drawPathHelper(t,e,i.fillMode,!1)},o.prototype.drawArc=function(t,e,i,r,n,s,l){e instanceof bi?this.drawArc(t,e.x,e.y,e.width,e.height,i,r):l!==0&&(this.stateControl(t,null,null),this.constructArcPath(e,i,e+r,i+n,s,l),this.drawPathHelper(t,null,!1))},o.prototype.buildUpPath=function(t,e){for(var i=t.length,r=0;r<i;++r){var n=0,s=t[r];switch(e[r]&o.pathTypesValuesMask){case ss.Start:this.pdfStreamWriter.beginPath(s.x,s.y);break;case ss.Bezier3:var l=new oi(0,0),h=new oi(0,0),c=this.getBezierPoints(t,e,r,l,h);this.pdfStreamWriter.appendBezierSegment(s,c.p2,c.p3),r=c.i;break;case ss.Line:this.pdfStreamWriter.appendLineSegment(s);break;default:throw new Error("ArithmeticException - Incorrect path formation.")}n=e[r],this.checkFlags(n)}},o.prototype.getBezierPoints=function(t,e,i,r,n){var s="Malforming path.";if(++i,(e[i]&o.pathTypesValuesMask)===ss.Bezier3)if(r=t[i],++i,(e[i]&o.pathTypesValuesMask)===ss.Bezier3)n=t[i];else throw new Error("ArgumentException : errorMsg");else throw new Error("ArgumentException : errorMsg");return{i,p2:r,p3:n}},o.prototype.checkFlags=function(t){(t&ss.CloseSubpath)===ss.CloseSubpath&&this.pdfStreamWriter.closePath()},o.prototype.constructArcPath=function(t,e,i,r,n,s){var l=this.getBezierArc(t,e,i,r,n,s);if(l.length!==0){var h=[l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7]];this.pdfStreamWriter.beginPath(h[0],h[1]);var c=0;for(c=0;c<l.length;c=c+8)h=[l[c],l[c+1],l[c+2],l[c+3],l[c+4],l[c+5],l[c+6],l[c+7]],this.pdfStreamWriter.appendBezierSegment(h[2],h[3],h[4],h[5],h[6],h[7])}},o.prototype.getBezierArc=function(t,e,i,r,n,s){if(t>i){var l=void 0;l=t,t=i,i=l}if(r>e){var l=void 0;l=e,e=r,r=l}var h,c;Math.abs(s)<=90?(h=s,c=1):(c=Math.ceil(Math.abs(s)/90),h=s/c);for(var u=(t+i)/2,p=(e+r)/2,f=(i-t)/2,g=(r-e)/2,C=h*(Math.PI/360),L=Math.abs(4/3*(1-Math.cos(C))/Math.sin(C)),D=[],R=0;R<c;R++){var B=(n+R*h)*(Math.PI/180),H=(n+(R+1)*h)*(Math.PI/180),j=Math.cos(B),W=Math.cos(H),ne=Math.sin(B),ie=Math.sin(H);h>0?D.push(u+f*j,p-g*ne,u+f*(j-L*ne),p-g*(ne+L*j),u+f*(W+L*ie),p-g*(ie-L*W),u+f*W,p-g*ie):D.push(u+f*j,p-g*ne,u+f*(j+L*ne),p-g*(ne-L*j),u+f*(W-L*ie),p-g*(ie+L*W),u+f*W,p-g*ie)}return D},o.pathTypesValuesMask=15,o.transparencyObject=!1,o}(),Gd=function(){function o(t){this.sender=t}return o.prototype.getResources=function(){return this.sender.getResources()},o}(),jE=function(){function o(t,e){this.internalTextRenderingMode=ns.Fill,this.internalCharacterSpacing=0,this.internalWordSpacing=0,this.internalTextScaling=100,this.pdfColorSpace=Ri.Rgb,typeof t!="undefined"&&(this.pdfGraphics=t,this.transformationMatrix=e)}return Object.defineProperty(o.prototype,"graphics",{get:function(){return this.pdfGraphics},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"matrix",{get:function(){return this.transformationMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"characterSpacing",{get:function(){return this.internalCharacterSpacing},set:function(t){this.internalCharacterSpacing=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"wordSpacing",{get:function(){return this.internalWordSpacing},set:function(t){this.internalWordSpacing=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"textScaling",{get:function(){return this.internalTextScaling},set:function(t){this.internalTextScaling=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"pen",{get:function(){return this.pdfPen},set:function(t){this.pdfPen=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"brush",{get:function(){return this.pdfBrush},set:function(t){this.pdfBrush=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"font",{get:function(){return this.pdfFont},set:function(t){this.pdfFont=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"colorSpace",{get:function(){return this.pdfColorSpace},set:function(t){this.pdfColorSpace=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"textRenderingMode",{get:function(){return this.internalTextRenderingMode},set:function(t){this.internalTextRenderingMode=t},enumerable:!0,configurable:!0}),o}(),WE=function(){function o(t,e,i){this.alphaPen=t,this.alphaBrush=e,this.blendMode=i}return o}(),kc=function(){function o(t,e){if(this.pdfColorSpace=Ri.Rgb,this.isVisible=!0,this.sublayer=!1,this.contentLength=0,this.dictionaryProperties=new $i,t===null)throw new Error("ArgumentNullException:page");if(this.pdfPage=t,this.clipPageTemplates=!0,typeof e=="undefined")this.content=new Tr;else if(e instanceof Tr||e===null){if(e===null)throw new Error("ArgumentNullException:stream");this.content=e}else this.content=new Tr,this.clipPageTemplates=e}return Object.defineProperty(o.prototype,"colorSpace",{get:function(){return this.pdfColorSpace},set:function(t){this.pdfColorSpace=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"page",{get:function(){return this.pdfPage},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"layerId",{get:function(){return this.layerid},set:function(t){this.layerid=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"name",{get:function(){return this.layerName},set:function(t){this.layerName=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"visible",{get:function(){return this.isVisible},set:function(t){this.isVisible=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"graphics",{get:function(){return this.pdfGraphics==null&&this.initializeGraphics(this.page),this.pdfGraphics},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"layers",{get:function(){return this.layer==null?(this.layer=new I0(this.page),this.layer.sublayer=!0,this.layer):this.layer},enumerable:!0,configurable:!0}),o.prototype.add=function(){var t=new o(this.pdfPage);return t.name="",t},o.prototype.sign=function(t){return t===0?0:t>0?1:-1},o.prototype.initializeGraphics=function(t){var e=t,i=new Gd(this.page),r=null;if(this.pdfGraphics=new Yd(t.size,i,this.content),this.pdfGraphics.mediaBoxUpperRightBound=0,e!=null){var n=e.section.parent;n!=null&&(this.pdfGraphics.colorSpace=n.document.colorSpace,this.colorSpace=n.document.colorSpace)}var s=this.sign(t.origin.y)===this.sign(t.origin.x);(t.origin.x>=0&&t.origin.y>=0||!s)&&this.pdfGraphics.initializeCoordinates();var l=e.section.getActualBounds(e,!0),h=e.section.pageSettings.margins;this.clipPageTemplates?t.origin.x>=0&&t.origin.y>=0&&this.pdfGraphics.clipTranslateMargins(l):this.graphics.clipTranslateMargins(l.x,l.y,h.left,h.top,h.right,h.bottom),this.pdfGraphics.setLayer(this)},Object.defineProperty(o.prototype,"element",{get:function(){return this.content},enumerable:!0,configurable:!0}),o}(),UE=function(){function o(){}return Object.defineProperty(o.prototype,"count",{get:function(){return typeof this.collection=="undefined"&&(this.collection=[]),this.collection.length},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"list",{get:function(){return typeof this.collection=="undefined"&&(this.collection=[]),this.collection},enumerable:!0,configurable:!0}),o}(),qE=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),I0=function(o){qE(t,o);function t(e){var i=o.call(this)||this;if(i.parentLayerCount=0,i.sublayer=!1,i.optionalContent=new Ei,e instanceof D0){i.page=e;var r=e;i.parseLayers(r)}return i}return t.prototype.items=function(e,i){if(typeof e=="number"&&typeof i=="undefined"){var r=this.list[e];return r}else{if(i==null)throw new Error("ArgumentNullException: layer");if(i.page!==this.page)throw new Error("ArgumentException: The layer belongs to another page")}},t.prototype.add=function(e,i){if(typeof e=="undefined"){var r=new kc(this.page);return r.name="",this.add(r),r}else if(e instanceof kc){var n=this.list.push(e);return this.addLayer(n,e),n}else return 0},t.prototype.addLayer=function(e,i){var r=new Ai(i);this.page.contents.add(r)},t.prototype.insert=function(e,i){for(var r=[],n=this.list.length,s=e;s<n;s++)r.push(this.list.pop());this.list.push(i);for(var s=0;s<r.length;s++)this.list.push(r[s]);this.insertLayer(e,i)},t.prototype.insertLayer=function(e,i){if(i==null)throw new Error("ArgumentNullException:layer");var r=new Ai(i);this.page.contents.insert(e,r)},t.prototype.parseLayers=function(e){var i=this.page.contents,r=this.page.getResources(),n=null,s=null,l=null,h=!1;n=e.crossTable;var c=new Tr,u=new Tr,p="q",f=`
`,g="Q",C=[];C.push(p),c.data=C,i.insert(0,new Ai(c)),C=[],C.push(g),u.data=C,i.insert(i.count,new Ai(u))},t.prototype.indexOf=function(e){if(e==null)throw new Error("ArgumentNullException: layer");var i=this.list.indexOf(e);return i},t}(UE),D0=function(){function o(t){this.defLayerIndex=-1,this.modified=!1,this.dictionaryProperties=new $i,this.pageDictionary=t}return Object.defineProperty(o.prototype,"section",{get:function(){return this.pdfSection},set:function(t){this.pdfSection=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"dictionary",{get:function(){return this.pageDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"element",{get:function(){return this.pageDictionary},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"defaultLayer",{get:function(){var t=this.layers,e=this.defaultLayerIndex,i=t.items(e);return i},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"defaultLayerIndex",{get:function(){if(this.layerCollection.count===0||this.defLayerIndex===-1){var t=this.layerCollection.add();this.defLayerIndex=this.layerCollection.indexOf(t)}return this.defLayerIndex},set:function(t){if(t<0||t>this.layers.count-1)throw new Error("ArgumentOutOfRangeException : value, Index can not be less 0 and greater Layers.Count - 1");this.defLayerIndex=t,this.modified=!0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"layers",{get:function(){return(this.layerCollection==null||typeof this.layerCollection=="undefined")&&(this.layerCollection=new I0(this)),this.layerCollection},enumerable:!0,configurable:!0}),o.prototype.getResources=function(){return this.resources==null&&(this.resources=new kl,this.dictionary.items.setValue(this.dictionaryProperties.resources,this.resources)),this.resources},Object.defineProperty(o.prototype,"contents",{get:function(){var t=this.pageDictionary.items.getValue(this.dictionaryProperties.contents),e=t,i=t;return e==null&&(e=new Zi,this.pageDictionary.items.setValue(this.dictionaryProperties.contents,e)),e},enumerable:!0,configurable:!0}),o.prototype.setResources=function(t){this.resources=t,this.dictionary.items.setValue(this.dictionaryProperties.resources,this.resources),this.modified=!0},o}(),ZE=function(){function o(t){this.alreadyExistsAnnotationError="This annotatation had been already added to page",this.missingAnnotationException="Annotation is not contained in collection.",this.dictionaryProperties=new $i,this.internalAnnotations=new Zi,this.lists=[],typeof t!="undefined"&&(this.page=t)}return Object.defineProperty(o.prototype,"annotations",{get:function(){return this.internalAnnotations},set:function(t){this.internalAnnotations=t},enumerable:!0,configurable:!0}),o.prototype.add=function(t){this.doAdd(t)},o.prototype.doAdd=function(t){if(typeof t.destination!="undefined"){var e=new _d,i=e.layout(t.text,t.font,t.stringFormat,new St(t.bounds.width,0),!1,new St(0,0)),r=t.bounds.y;if(i.lines.length===1){var n=t.font.measureString(i.lines[0].text);t.bounds=new bi(new oi(t.bounds.x,r),n),t.text=i.lines[0].text,this.page.graphics.drawString(t.text,t.font,null,t.brush,t.bounds.x,t.bounds.y,t.bounds.width,t.bounds.height,null),t.setPage(this.page),this.setColor(t),this.internalAnnotations.add(new Ai(t)),this.lists.push(t)}else for(var s=0;s<i.lines.length;s++){var n=t.font.measureString(i.lines[s].text);if(s===0)t.bounds=new bi(t.bounds.x,r,n.width,n.height),t.text=i.lines[s].text,this.page.graphics.drawString(t.text,t.font,null,t.brush,t.bounds.x,r,n.width,n.height,null),t.setPage(this.page),this.setColor(t),this.internalAnnotations.add(new Ai(t)),this.lists.push(t),r+=t.bounds.height;else{var l=t.clone();l.bounds=new bi(new oi(t.bounds.x,r),n),l.text=i.lines[s].text,this.page.graphics.drawString(l.text,l.font,null,l.brush,l.bounds.x,l.bounds.y,l.bounds.width,l.bounds.height,null),l.setPage(this.page),this.setColor(l),this.internalAnnotations.add(new Ai(l)),this.lists.push(l),r+=l.bounds.height}}}else return t.setPage(this.page),this.internalAnnotations.add(new Ai(t)),this.lists.push(t)},o.prototype.setColor=function(t){var e=Ri.Rgb,i=t.color.toArray(e);t.dictionary.items.setValue(this.dictionaryProperties.c,i)},Object.defineProperty(o.prototype,"element",{get:function(){return this.internalAnnotations},enumerable:!0,configurable:!0}),o}(),YE=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Fs=function(o){YE(t,o);function t(){var e=o.call(this,new Ei)||this;return e.annotationCollection=null,e.beginSave=null,e.initialize(),e}return Object.defineProperty(t.prototype,"document",{get:function(){return this.section!==null&&this.section.parent!==null?this.section.parent.document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"graphics",{get:function(){var e=this.defaultLayer.graphics;return e.currentPage=this,e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"crossTable",{get:function(){if(this.section===null)throw new Error("PdfDocumentException : Page is not created");return this.section.parent===null?this.section.parentDocument.crossTable:this.section.parent.document.crossTable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.section.pageSettings.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"origin",{get:function(){return this.section.pageSettings.origin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"annotations",{get:function(){return this.annotationCollection==null&&(this.annotationCollection=new ZE(this),this.dictionary.items.setValue(this.dictionaryProperties.annots,this.annotationCollection.element),this.annotationCollection.annotations=this.dictionary.items.getValue(this.dictionaryProperties.annots)),this.annotationCollection},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){this.dictionary.items.setValue(this.dictionaryProperties.type,new $t("Page")),this.dictionary.pageBeginDrawTemplate=new Jx(this)},t.prototype.setSection=function(e){this.section=e,this.dictionary.items.setValue(this.dictionaryProperties.parent,new Ai(e))},t.prototype.resetProgress=function(){this.isProgressOn=!1},t.prototype.getClientSize=function(){var e=this.section.getActualBounds(this,!0);return new St(e.width,e.height)},t.prototype.pageBeginSave=function(){var e=this.document;typeof e!==void 0&&e!=null&&this.drawPageTemplates(e),this.beginSave!=null&&typeof this.beginSave!="undefined"&&this.beginSave(this)},t.prototype.drawPageTemplates=function(e){var i=this.section.containsTemplates(e,this,!1);if(i){var r=new kc(this,!1);if(this.layers.insert(0,r),this.section.drawTemplates(this,r,e,!1),r.graphics!==null&&typeof r.graphics!="undefined")for(var n=0;n<r.graphics.automaticFields.automaticFields.length;n++){var s=r.graphics.automaticFields.automaticFields[n];s.field.performDraw(r.graphics,s.location,s.scalingX,s.scalingY)}}var l=this.section.containsTemplates(e,this,!0);if(l){var h=new kc(this,!1);this.layers.add(h),this.section.drawTemplates(this,h,e,!0)}},t}(D0),O0=function(){function o(t){typeof t!="undefined"?this.pdfPage=t:this.pdfPage=null}return Object.defineProperty(o.prototype,"page",{get:function(){return this.pdfPage},enumerable:!0,configurable:!0}),o}(),GE=function(){function o(t){if(this.pdfSection=null,t==null)throw Error('ArgumentNullException("section")');this.section=t}return Object.defineProperty(o.prototype,"section",{get:function(){return this.pdfSection},set:function(t){this.pdfSection=t},enumerable:!0,configurable:!0}),o.prototype.contains=function(t){return this.section.contains(t)},o.prototype.remove=function(t){this.section.remove(t)},o.prototype.add=function(){return this.section.add()},o}(),R0=function(){function o(){}return Object.defineProperty(o.prototype,"left",{get:function(){return this.leftTemplate},set:function(t){this.leftTemplate=this.checkElement(t,ti.Left)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"top",{get:function(){return this.topTemplate},set:function(t){this.topTemplate=this.checkElement(t,ti.Top)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"right",{get:function(){return this.rightTemplate},set:function(t){this.rightTemplate=this.checkElement(t,ti.Right)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"bottom",{get:function(){return this.bottomTemplate},set:function(t){this.bottomTemplate=this.checkElement(t,ti.Bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"EvenLeft",{get:function(){return this.evenLeft},set:function(t){this.evenLeft=this.checkElement(t,ti.Left)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"EvenTop",{get:function(){return this.evenTop},set:function(t){this.evenTop=this.checkElement(t,ti.Top)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"EvenRight",{get:function(){return this.evenRight},set:function(t){this.evenRight=this.checkElement(t,ti.Right)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"EvenBottom",{get:function(){return this.evenBottom},set:function(t){this.evenBottom=this.checkElement(t,ti.Bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"OddLeft",{get:function(){return this.oddLeft},set:function(t){this.oddLeft=this.checkElement(t,ti.Left)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"OddTop",{get:function(){return this.oddTop},set:function(t){this.oddTop=this.checkElement(t,ti.Top)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"OddRight",{get:function(){return this.oddRight},set:function(t){this.oddRight=this.checkElement(t,ti.Right)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"OddBottom",{get:function(){return this.oddBottom},set:function(t){this.oddBottom=this.checkElement(t,ti.Bottom)},enumerable:!0,configurable:!0}),o.prototype.getLeft=function(t){if(t==null)throw new Error("ArgumentNullException:page");var e=null,i=this.isEven(t);return i?e=this.EvenLeft!=null?this.EvenLeft:this.left:e=this.OddLeft!=null?this.OddLeft:this.left,e},o.prototype.getTop=function(t){if(t==null)throw new Error("ArgumentNullException:page");var e=null,i=this.isEven(t);return i?e=this.EvenTop!=null?this.EvenTop:this.top:e=this.OddTop!=null?this.OddTop:this.top,e},o.prototype.getRight=function(t){if(t==null)throw new Error("ArgumentNullException:page");var e=null,i=this.isEven(t);return i?e=this.EvenRight!=null?this.EvenRight:this.right:e=this.OddRight!=null?this.OddRight:this.right,e},o.prototype.getBottom=function(t){if(t==null)throw new Error("ArgumentNullException:page");var e=null,i=this.isEven(t);return i?e=this.EvenBottom!=null?this.EvenBottom:this.bottom:e=this.OddBottom!=null?this.OddBottom:this.bottom,e},o.prototype.isEven=function(t){var e=t.section.document.pages,i=0;e.pageCollectionIndex.containsKey(t)?i=e.pageCollectionIndex.getValue(t)+1:i=e.indexOf(t)+1;var r=i%2==0;return r},o.prototype.checkElement=function(t,e){if(t!=null){if(typeof t.type!="undefined"&&t.type!==ti.None)throw new Error("NotSupportedException:Can not reassign the template element. Please, create new one.");t.type=e}return t},o}(),KE=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),XE=function(o){KE(t,o);function t(){var e=o.call(this)||this;return e.leftValue=e.topValue=e.rightValue=e.bottomValue=e.stampValue=!0,e}return Object.defineProperty(t.prototype,"applyDocumentLeftTemplate",{get:function(){return this.leftValue},set:function(e){this.leftValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"applyDocumentTopTemplate",{get:function(){return this.topValue},set:function(e){this.topValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"applyDocumentRightTemplate",{get:function(){return this.rightValue},set:function(e){this.rightValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"applyDocumentBottomTemplate",{get:function(){return this.bottomValue},set:function(e){this.bottomValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"applyDocumentStamps",{get:function(){return this.stampValue},set:function(e){this.stampValue=e},enumerable:!0,configurable:!0}),t}(R0),$E=function(){function o(t,e){this.pageAdded=new O0,this.pdfPages=[],this.dictionaryProperties=new $i,this.pdfDocument=t,typeof e=="undefined"?(this.settings=t.pageSettings.clone(),this.initialSettings=this.settings.clone()):(this.settings=e.clone(),this.initialSettings=this.settings.clone()),this.initialize()}return Object.defineProperty(o.prototype,"parent",{get:function(){return this.sectionCollection},set:function(t){this.sectionCollection=t,this.section.items.setValue(this.dictionaryProperties.parent,new Ai(t))},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"parentDocument",{get:function(){return this.pdfDocument},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"pageSettings",{get:function(){return this.settings},set:function(t){if(t!=null)this.settings=t;else throw Error("Value can not be null.")},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"element",{get:function(){return this.section},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"count",{get:function(){return this.pagesReferences.count},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"template",{get:function(){return this.pageTemplate==null&&(this.pageTemplate=new XE),this.pageTemplate},set:function(t){this.pageTemplate=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"document",{get:function(){return this.sectionCollection.document},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"pages",{get:function(){return(this.pagesCollection==null||typeof this.pagesCollection=="undefined")&&(this.pagesCollection=new GE(this)),this.pagesCollection},enumerable:!0,configurable:!0}),o.prototype.getPages=function(){return this.pdfPages},o.prototype.pointToNativePdf=function(t,e){var i=this.getActualBounds(t,!0);return e.x+=i.x,e.y=this.pageSettings.height-e.y,e},o.prototype.setPageSettings=function(t){this.settings=t,this.state.orientation=t.orientation,this.state.rotate=t.rotate,this.state.size=t.size,this.state.origin=t.origin},o.prototype.initialize=function(){this.pagesReferences=new Zi,this.section=new Ei,this.state=new QE(this.pdfDocument),this.section.sectionBeginSave=new Qx(this,this.state),this.pageCount=new It(0),this.section.items.setValue(this.dictionaryProperties.count,this.pageCount),this.section.items.setValue(this.dictionaryProperties.type,new $t(this.dictionaryProperties.pages)),this.section.items.setValue(this.dictionaryProperties.kids,this.pagesReferences)},o.prototype.containsTemplates=function(t,e,i){var r=this.getDocumentTemplates(t,e,i),n=this.getSectionTemplates(e,i);return r.length>0||n.length>0},o.prototype.getDocumentTemplates=function(t,e,i){var r=[];return this.template.applyDocumentTopTemplate&&t.template.getTop(e)!=null&&(!(t.template.getTop(e).foreground||i)||t.template.getTop(e).foreground&&i)&&r.push(t.template.getTop(e)),this.template.applyDocumentBottomTemplate&&t.template.getBottom(e)!=null&&(!(t.template.getBottom(e).foreground||i)||t.template.getBottom(e).foreground&&i)&&r.push(t.template.getBottom(e)),this.template.applyDocumentLeftTemplate&&t.template.getLeft(e)!=null&&(!(t.template.getLeft(e).foreground||i)||t.template.getLeft(e).foreground&&i)&&r.push(t.template.getLeft(e)),this.template.applyDocumentRightTemplate&&t.template.getRight(e)!=null&&(!(t.template.getRight(e).foreground||i)||t.template.getRight(e).foreground&&i)&&r.push(t.template.getRight(e)),r},o.prototype.getSectionTemplates=function(t,e){var i=[];if(this.template.getTop(t)!=null){var r=this.template.getTop(t);(!(r.foreground||e)||r.foreground&&e)&&i.push(r)}if(this.template.getBottom(t)!=null){var r=this.template.getBottom(t);(!(r.foreground||e)||r.foreground&&e)&&i.push(r)}if(this.template.getLeft(t)!=null){var r=this.template.getLeft(t);(!(r.foreground||e)||r.foreground&&e)&&i.push(r)}if(this.template.getRight(t)!=null){var r=this.template.getRight(t);(!(r.foreground||e)||r.foreground&&e)&&i.push(r)}return i},o.prototype.add=function(t){if(typeof t=="undefined"){var e=new Fs;return this.add(e),e}else{var i=this.checkPresence(t);this.pdfPages.push(t),this.pagesReferences.add(i),t.setSection(this),t.resetProgress(),this.pageAddedMethod(t)}},o.prototype.checkPresence=function(t){for(var e=new Ai(t),i=!1,r=this.parent,n=0;n<r.section.length;n++){var s=r.section[n];i=i||s.contains(t)}return e},o.prototype.contains=function(t){var e=this.indexOf(t);return 0<=e},o.prototype.indexOf=function(t){for(var e=0;e<this.pdfPages.length;e++)if(this.pdfPages[e]===t)return this.pdfPages.indexOf(t);var i=new Ai(t);return this.pagesReferences.indexOf(i)},o.prototype.pageAddedMethod=function(t){var e=new O0(t);this.onPageAdded(e);var i=this.parent;i.document.pages.onPageAdded(e),this.pageCount.intValue=this.count},o.prototype.onPageAdded=function(t){},o.prototype.getActualBounds=function(t,e,i){if(t instanceof Fs&&typeof e=="boolean"){var r=void 0,n=this.parent.document;return r=this.getActualBounds(n,t,e),r}else{t=t,e=e,i=i;var s=new bi(0,0,0,0);s.height=i?this.pageSettings.size.height:this.pageSettings.getActualSize().height,s.width=i?this.pageSettings.size.width:this.pageSettings.getActualSize().width;var l=this.getLeftIndentWidth(t,e,i),h=this.getTopIndentHeight(t,e,i),c=this.getRightIndentWidth(t,e,i),u=this.getBottomIndentHeight(t,e,i);return s.x+=l,s.y+=h,s.width-=l+c,s.height-=h+u,s}},o.prototype.getLeftIndentWidth=function(t,e,i){if(t==null)throw new Error("ArgumentNullException:document");if(e==null)throw new Error("ArgumentNullException:page");var r=i?this.pageSettings.margins.left:0,n=this.template.getLeft(e)!=null?this.template.getLeft(e).width:0,s=t.template.getLeft(e)!=null?t.template.getLeft(e).width:0;return r+=this.template.applyDocumentLeftTemplate?Math.max(n,s):n,r},o.prototype.getTopIndentHeight=function(t,e,i){if(t==null)throw new Error("ArgumentNullException:document");if(e==null)throw new Error("ArgumentNullException:page");var r=i?this.pageSettings.margins.top:0,n=this.template.getTop(e)!=null?this.template.getTop(e).height:0,s=t.template.getTop(e)!=null?t.template.getTop(e).height:0;return r+=this.template.applyDocumentTopTemplate?Math.max(n,s):n,r},o.prototype.getRightIndentWidth=function(t,e,i){if(t==null)throw new Error("ArgumentNullException:document");if(e==null)throw new Error("ArgumentNullException:page");var r=i?this.pageSettings.margins.right:0,n=this.template.getRight(e)!=null?this.template.getRight(e).width:0,s=t.template.getRight(e)!=null?t.template.getRight(e).width:0;return r+=this.template.applyDocumentRightTemplate?Math.max(n,s):n,r},o.prototype.getBottomIndentHeight=function(t,e,i){if(t==null)throw new Error("ArgumentNullException:document");if(e==null)throw new Error("ArgumentNullException:page");var r=i?this.pageSettings.margins.bottom:0,n=this.template.getBottom(e)!=null?this.template.getBottom(e).height:0,s=t.template.getBottom(e)!=null?t.template.getBottom(e).height:0;return r+=this.template.applyDocumentBottomTemplate?Math.max(n,s):n,r},o.prototype.remove=function(t){if(t==null)throw Error('ArgumentNullException("page")');var e=this.pdfPages.indexOf(t);this.pagesReferences.removeAt(e);for(var i=[],r=0;r<e;r++)i.push(this.pdfPages[r]);for(var r=e+1;r<this.pdfPages.length;r++)i.push(this.pdfPages[r]);this.pdfPages=i},o.prototype.applyPageSettings=function(t,e,i){var r=new bi(i.origin,i.size);t.items.setValue(this.dictionaryProperties.mediaBox,Zi.fromRectangle(r));var n=0;n=M0.rotateFactor*i.rotate;var s=new It(n);t.items.setValue(this.dictionaryProperties.rotate,s)},o.prototype.beginSave=function(t,e){var i=e.document;this.applyPageSettings(this.section,i.pageSettings,t)},o.prototype.drawTemplates=function(t,e,i,r){var n=this.getDocumentTemplates(i,t,r),s=this.getSectionTemplates(t,r);this.drawTemplatesHelper(e,i,n),this.drawTemplatesHelper(e,i,s)},o.prototype.drawTemplatesHelper=function(t,e,i){if(i!=null&&i.length>0)for(var r=i.length,n=0;n<r;n++){var s=i[n];s.draw(t,e)}},o}(),QE=function(){function o(t){this.pageOrientation=t.pageSettings.orientation,this.pageRotate=t.pageSettings.rotate,this.pageSize=t.pageSettings.size,this.pageOrigin=t.pageSettings.origin}return Object.defineProperty(o.prototype,"orientation",{get:function(){return this.pageOrientation},set:function(t){this.pageOrientation=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"rotate",{get:function(){return this.pageRotate},set:function(t){this.pageRotate=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"size",{get:function(){return this.pageSize},set:function(t){this.pageSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"origin",{get:function(){return this.pageOrigin},set:function(t){this.pageOrigin=t},enumerable:!0,configurable:!0}),o}(),M0=function(){function o(t){this.sections=[],this.dictionaryProperties=new $i,this.pdfDocument=t.clone(),this.initialize()}return Object.defineProperty(o.prototype,"section",{get:function(){return this.sections},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"document",{get:function(){return this.pdfDocument},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"count",{get:function(){return this.sections.length},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"element",{get:function(){return this.pages},enumerable:!0,configurable:!0}),o.prototype.initialize=function(){this.sectionCount=new It(0),this.sectionCollection=new Zi,this.pages=new Ei,this.pages.beginSave=new Kx(this),this.pages.items.setValue(this.dictionaryProperties.type,new $t("Pages")),this.pages.items.setValue(this.dictionaryProperties.kids,this.sectionCollection),this.pages.items.setValue(this.dictionaryProperties.count,this.sectionCount),this.pages.items.setValue(this.dictionaryProperties.resources,new Ei),this.setPageSettings(this.pages,this.pdfDocument.pageSettings)},o.prototype.pdfSectionCollection=function(t){if(t<0||t>=this.count)throw new Error("IndexOutOfRangeException()");return this.sections[t]},o.prototype.setPageSettings=function(t,e){var i=new bi(new oi,e.size);t.items.setValue(this.dictionaryProperties.mediaBox,Zi.fromRectangle(i))},o.prototype.add=function(t){if(typeof t=="undefined"){var e=new $E(this.pdfDocument);return this.add(e),e}else{var i=this.checkSection(t);return this.sections.push(t),t.parent=this,this.sectionCollection.add(i),this.sections.indexOf(t)}},o.prototype.checkSection=function(t){var e=new Ai(t),i=this.sectionCollection.contains(e);return e},o.prototype.countPages=function(){var t=0;return this.sections.forEach(function(e){return t+=e.count}),t},o.prototype.beginSave=function(){this.sectionCount.intValue=this.countPages()},o.rotateFactor=90,o}(),JE=function(){function o(t){this.pdfPageCollectionIndex=new Ii,this.document=t}return Object.defineProperty(o.prototype,"count",{get:function(){return this.countPages()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"pageCollectionIndex",{get:function(){return this.pdfPageCollectionIndex},enumerable:!0,configurable:!0}),o.prototype.add=function(t){if(typeof t=="undefined"){var e=new Fs;return this.add(e),e}else{var i=this.getLastSection();i.add(t)}},o.prototype.getLastSection=function(){var t=this.document.sections;t.section.length===0&&t.add();var e=t.section[t.section.length-1];return e},o.prototype.onPageAdded=function(t){},o.prototype.countPages=function(){for(var t=this.document.sections,e=0,i=0;i<t.section.length;i++)e+=t.section[i].count;return e},o.prototype.getPageByIndex=function(t){return this.getPage(t)},o.prototype.getPage=function(t){if(t<0||t>=this.count)throw Error('ArgumentOutOfRangeException("index", "Value can not be less 0")');for(var e=null,i=0,r=0,n=0,s=this.document.sections.count,l=0;l<s;l++){var h=this.document.sections.section[l];if(r=h.count,n=t-i,t>=i&&n<r){e=h.getPages()[n];break}i+=r}return e},o.prototype.indexOf=function(t){var e=-1;if(t==null)throw new Error("ArgumentNullException: page");for(var i=0,r=0,n=this.document.sections.count;r<n;r++){var s=this.document.sections.pdfSectionCollection(r);if(e=s.indexOf(t),e>=0){e+=i;break}else e=-1;i+=s.count}return e},o.prototype.remove=function(t){if(t==null)throw Error('ArgumentNullException("page")');for(var e=null,i,r=0,n=this.document.sections.count;r<n;r++)if(e=this.document.sections.pdfSectionCollection(r),e.pages.contains(t)){e.pages.remove(t);break}return e},o}(),P0=function(){function o(){this.referenceObjects=[],this.pdfFontCollection=new Ii}return o.prototype.search=function(t){var e=null,i=this.getGroup(t);return i==null?i=this.createNewGroup():i.length>0&&(e=i[0]),i.push(t),e},o.prototype.createNewGroup=function(){var t=[];return this.referenceObjects.push(t),t},o.prototype.getGroup=function(t){var e=null;if(t!==null)for(var i=this.referenceObjects.length,r=0;r<i;r++){if(this.referenceObjects.length>0){var n=this.referenceObjects[r];if(n.length>0){var s=n[0];if(t.equalsTo(s)){e=n;break}}else this.removeGroup(n)}i=this.referenceObjects.length}return e},o.prototype.removeGroup=function(t){if(t!==null){var e=this.referenceObjects.indexOf(t);this.referenceObjects.slice(e,e+1)}},o.prototype.destroy=function(){this.pdfFontCollection=void 0,this.referenceObjects=void 0},o}(),e1=function(){function o(){}return o.getMetrics=function(t,e,i){var r=null;switch(t){case Br.Helvetica:r=this.getHelveticaMetrics(t,e,i);break;case Br.Courier:r=this.getCourierMetrics(t,e,i);break;case Br.TimesRoman:r=this.getTimesMetrics(t,e,i);break;case Br.Symbol:r=this.getSymbolMetrics(t,e,i);break;case Br.ZapfDingbats:r=this.getZapfDingbatsMetrics(t,e,i);break;default:r=this.getHelveticaMetrics(Br.Helvetica,e,i);break}return r.name=t.toString(),r.subScriptSizeFactor=this.subSuperScriptFactor,r.superscriptSizeFactor=this.subSuperScriptFactor,r},o.getHelveticaMetrics=function(t,e,i){var r=new lo;return(e&Mi.Bold)>0&&(e&Mi.Italic)>0?(r.ascent=this.helveticaBoldItalicAscent,r.descent=this.helveticaBoldItalicDescent,r.postScriptName=this.helveticaBoldItalicName,r.size=i,r.widthTable=new Ir(this.arialBoldWidth),r.height=r.ascent-r.descent):(e&Mi.Bold)>0?(r.ascent=this.helveticaBoldAscent,r.descent=this.helveticaBoldDescent,r.postScriptName=this.helveticaBoldName,r.size=i,r.widthTable=new Ir(this.arialBoldWidth),r.height=r.ascent-r.descent):(e&Mi.Italic)>0?(r.ascent=this.helveticaItalicAscent,r.descent=this.helveticaItalicDescent,r.postScriptName=this.helveticaItalicName,r.size=i,r.widthTable=new Ir(this.arialWidth),r.height=r.ascent-r.descent):(r.ascent=this.helveticaAscent,r.descent=this.helveticaDescent,r.postScriptName=this.helveticaName,r.size=i,r.widthTable=new Ir(this.arialWidth),r.height=r.ascent-r.descent),r},o.getCourierMetrics=function(t,e,i){var r=new lo;return(e&Mi.Bold)>0&&(e&Mi.Italic)>0?(r.ascent=this.courierBoldItalicAscent,r.descent=this.courierBoldItalicDescent,r.postScriptName=this.courierBoldItalicName,r.size=i,r.widthTable=new Ir(this.fixedWidth),r.height=r.ascent-r.descent):(e&Mi.Bold)>0?(r.ascent=this.courierBoldAscent,r.descent=this.courierBoldDescent,r.postScriptName=this.courierBoldName,r.size=i,r.widthTable=new Ir(this.fixedWidth),r.height=r.ascent-r.descent):(e&Mi.Italic)>0?(r.ascent=this.courierItalicAscent,r.descent=this.courierItalicDescent,r.postScriptName=this.courierItalicName,r.size=i,r.widthTable=new Ir(this.fixedWidth),r.height=r.ascent-r.descent):(r.ascent=this.courierAscent,r.descent=this.courierDescent,r.postScriptName=this.courierName,r.size=i,r.widthTable=new Ir(this.fixedWidth),r.height=r.ascent-r.descent),r},o.getTimesMetrics=function(t,e,i){var r=new lo;return(e&Mi.Bold)>0&&(e&Mi.Italic)>0?(r.ascent=this.timesBoldItalicAscent,r.descent=this.timesBoldItalicDescent,r.postScriptName=this.timesBoldItalicName,r.size=i,r.widthTable=new Ir(this.timesRomanBoldItalicWidths),r.height=r.ascent-r.descent):(e&Mi.Bold)>0?(r.ascent=this.timesBoldAscent,r.descent=this.timesBoldDescent,r.postScriptName=this.timesBoldName,r.size=i,r.widthTable=new Ir(this.timesRomanBoldWidth),r.height=r.ascent-r.descent):(e&Mi.Italic)>0?(r.ascent=this.timesItalicAscent,r.descent=this.timesItalicDescent,r.postScriptName=this.timesItalicName,r.size=i,r.widthTable=new Ir(this.timesRomanItalicWidth),r.height=r.ascent-r.descent):(r.ascent=this.timesAscent,r.descent=this.timesDescent,r.postScriptName=this.timesName,r.size=i,r.widthTable=new Ir(this.timesRomanWidth),r.height=r.ascent-r.descent),r},o.getSymbolMetrics=function(t,e,i){var r=new lo;return r.ascent=this.symbolAscent,r.descent=this.symbolDescent,r.postScriptName=this.symbolName,r.size=i,r.widthTable=new Ir(this.symbolWidth),r.height=r.ascent-r.descent,r},o.getZapfDingbatsMetrics=function(t,e,i){var r=new lo;return r.ascent=this.zapfDingbatsAscent,r.descent=this.zapfDingbatsDescent,r.postScriptName=this.zapfDingbatsName,r.size=i,r.widthTable=new Ir(this.zapfDingbatsWidth),r.height=r.ascent-r.descent,r},o.subSuperScriptFactor=1.52,o.helveticaAscent=931,o.helveticaDescent=-225,o.helveticaName="Helvetica",o.helveticaBoldAscent=962,o.helveticaBoldDescent=-228,o.helveticaBoldName="Helvetica-Bold",o.helveticaItalicAscent=931,o.helveticaItalicDescent=-225,o.helveticaItalicName="Helvetica-Oblique",o.helveticaBoldItalicAscent=962,o.helveticaBoldItalicDescent=-228,o.helveticaBoldItalicName="Helvetica-BoldOblique",o.courierAscent=805,o.courierDescent=-250,o.courierName="Courier",o.courierBoldAscent=801,o.courierBoldDescent=-250,o.courierBoldName="Courier-Bold",o.courierItalicAscent=805,o.courierItalicDescent=-250,o.courierItalicName="Courier-Oblique",o.courierBoldItalicAscent=801,o.courierBoldItalicDescent=-250,o.courierBoldItalicName="Courier-BoldOblique",o.timesAscent=898,o.timesDescent=-218,o.timesName="Times-Roman",o.timesBoldAscent=935,o.timesBoldDescent=-218,o.timesBoldName="Times-Bold",o.timesItalicAscent=883,o.timesItalicDescent=-217,o.timesItalicName="Times-Italic",o.timesBoldItalicAscent=921,o.timesBoldItalicDescent=-218,o.timesBoldItalicName="Times-BoldItalic",o.symbolAscent=1010,o.symbolDescent=-293,o.symbolName="Symbol",o.zapfDingbatsAscent=820,o.zapfDingbatsDescent=-143,o.zapfDingbatsName="ZapfDingbats",o.arialWidth=[278,278,355,556,556,889,667,191,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,278,278,584,584,584,556,1015,667,667,722,722,667,611,778,722,278,500,667,556,833,722,778,667,778,722,667,611,722,667,944,667,667,611,278,278,278,469,556,333,556,556,500,556,556,278,556,556,222,222,500,222,833,556,556,556,556,333,500,278,556,500,722,500,500,500,334,260,334,584,0,556,0,222,556,333,1e3,556,556,333,1e3,667,333,1e3,0,611,0,0,222,222,333,333,350,556,1e3,333,1e3,500,333,944,0,500,667,0,333,556,556,556,556,260,556,333,737,370,556,584,0,737,333,400,584,333,333,333,556,537,278,333,333,365,556,834,834,834,611,667,667,667,667,667,667,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,500,556,556,556,556,278,278,278,278,556,556,556,556,556,556,556,584,611,556,556,556,556,500,556,500],o.arialBoldWidth=[278,333,474,556,556,889,722,238,333,333,389,584,278,333,278,278,556,556,556,556,556,556,556,556,556,556,333,333,584,584,584,611,975,722,722,722,722,667,611,778,722,278,556,722,611,833,722,778,667,778,722,667,611,722,667,944,667,667,611,333,278,333,584,556,333,556,611,556,611,556,333,611,611,278,278,556,278,889,611,611,611,611,389,556,333,611,556,778,556,556,500,389,280,389,584,0,556,0,278,556,500,1e3,556,556,333,1e3,667,333,1e3,0,611,0,0,278,278,500,500,350,556,1e3,333,1e3,556,333,944,0,500,667,0,333,556,556,556,556,280,556,333,737,370,556,584,0,737,333,400,584,333,333,333,611,556,278,333,333,365,556,834,834,834,611,722,722,722,722,722,722,1e3,722,667,667,667,667,278,278,278,278,722,722,778,778,778,778,778,584,778,722,722,722,722,667,667,611,556,556,556,556,556,556,889,556,556,556,556,556,278,278,278,278,611,611,611,611,611,611,611,584,611,611,611,611,611,556,611,556],o.fixedWidth=[600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600,600],o.timesRomanWidth=[250,333,408,500,500,833,778,180,333,333,500,564,250,333,250,278,500,500,500,500,500,500,500,500,500,500,278,278,564,564,564,444,921,722,667,667,722,611,556,722,722,333,389,722,611,889,722,722,556,722,667,556,611,722,722,944,722,722,611,333,278,333,469,500,333,444,500,444,500,444,333,500,500,278,278,500,278,778,500,500,500,500,333,389,278,500,500,722,500,500,444,480,200,480,541,0,500,0,333,500,444,1e3,500,500,333,1e3,556,333,889,0,611,0,0,333,333,444,444,350,500,1e3,333,980,389,333,722,0,444,722,0,333,500,500,500,500,200,500,333,760,276,500,564,0,760,333,400,564,300,300,333,500,453,250,333,300,310,500,750,750,750,444,722,722,722,722,722,722,889,667,611,611,611,611,333,333,333,333,722,722,722,722,722,722,722,564,722,722,722,722,722,722,556,500,444,444,444,444,444,444,667,444,444,444,444,444,278,278,278,278,500,500,500,500,500,500,500,564,500,500,500,500,500,500,500,500],o.timesRomanBoldWidth=[250,333,555,500,500,1e3,833,278,333,333,500,570,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,570,570,570,500,930,722,667,722,722,667,611,778,778,389,500,778,667,944,722,778,611,778,722,556,667,722,722,1e3,722,722,667,333,278,333,581,500,333,500,556,444,556,444,333,500,556,278,333,556,278,833,556,500,556,556,444,389,333,556,500,722,500,500,444,394,220,394,520,0,500,0,333,500,500,1e3,500,500,333,1e3,556,333,1e3,0,667,0,0,333,333,500,500,350,500,1e3,333,1e3,389,333,722,0,444,722,0,333,500,500,500,500,220,500,333,747,300,500,570,0,747,333,400,570,300,300,333,556,540,250,333,300,330,500,750,750,750,500,722,722,722,722,722,722,1e3,722,667,667,667,667,389,389,389,389,722,722,778,778,778,778,778,570,778,722,722,722,722,722,611,556,500,500,500,500,500,500,722,444,444,444,444,444,278,278,278,278,500,556,500,500,500,500,500,570,500,556,556,556,556,500,556,500],o.timesRomanItalicWidth=[250,333,420,500,500,833,778,214,333,333,500,675,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,675,675,675,500,920,611,611,667,722,611,611,722,722,333,444,667,556,833,667,722,611,722,611,500,556,722,611,833,611,556,556,389,278,389,422,500,333,500,500,444,500,444,278,500,500,278,278,444,278,722,500,500,500,500,389,389,278,500,444,667,444,444,389,400,275,400,541,0,500,0,333,500,556,889,500,500,333,1e3,500,333,944,0,556,0,0,333,333,556,556,350,500,889,333,980,389,333,667,0,389,556,0,389,500,500,500,500,275,500,333,760,276,500,675,0,760,333,400,675,300,300,333,500,523,250,333,300,310,500,750,750,750,500,611,611,611,611,611,611,889,667,611,611,611,611,333,333,333,333,722,667,722,722,722,722,722,675,722,722,722,722,722,556,611,500,500,500,500,500,500,500,667,444,444,444,444,444,278,278,278,278,500,500,500,500,500,500,500,675,500,500,500,500,500,444,500,444],o.timesRomanBoldItalicWidths=[250,389,555,500,500,833,778,278,333,333,500,570,250,333,250,278,500,500,500,500,500,500,500,500,500,500,333,333,570,570,570,500,832,667,667,667,722,667,667,722,778,389,500,667,611,889,722,722,611,722,667,556,611,722,667,889,667,611,611,333,278,333,570,500,333,500,500,444,500,444,333,500,556,278,278,500,278,778,556,500,500,500,389,389,278,556,444,667,500,444,389,348,220,348,570,0,500,0,333,500,500,1e3,500,500,333,1e3,556,333,944,0,611,0,0,333,333,500,500,350,500,1e3,333,1e3,389,333,722,0,389,611,0,389,500,500,500,500,220,500,333,747,266,500,606,0,747,333,400,570,300,300,333,576,500,250,333,300,300,500,750,750,750,500,667,667,667,667,667,667,944,667,667,667,667,667,389,389,389,389,722,722,722,722,722,722,722,570,722,722,722,722,722,611,611,500,500,500,500,500,500,500,722,444,444,444,444,444,278,278,278,278,500,556,500,500,500,500,500,570,500,556,556,556,556,444,500,444],o.symbolWidth=[250,333,713,500,549,833,778,439,333,333,500,549,250,549,250,278,500,500,500,500,500,500,500,500,500,500,278,278,549,549,549,444,549,722,667,722,612,611,763,603,722,333,631,722,686,889,722,722,768,741,556,592,611,690,439,768,645,795,611,333,863,333,658,500,500,631,549,549,494,439,521,411,603,329,603,549,549,576,521,549,549,521,549,603,439,576,713,686,493,686,494,480,200,480,549,750,620,247,549,167,713,500,753,753,753,753,1042,987,603,987,603,400,549,411,549,549,713,494,460,549,549,549,549,1e3,603,1e3,658,823,686,795,987,768,768,823,768,768,713,713,713,713,713,713,713,768,713,790,790,890,823,549,250,713,603,603,1042,987,603,987,603,494,329,790,790,786,713,384,384,384,384,384,384,494,494,494,494,329,274,686,686,686,384,384,384,384,384,384,494,494,494,-1],o.zapfDingbatsWidth=[278,974,961,974,980,719,789,790,791,690,960,939,549,855,911,933,911,945,974,755,846,762,761,571,677,763,760,759,754,494,552,537,577,692,786,788,788,790,793,794,816,823,789,841,823,833,816,831,923,744,723,749,790,792,695,776,768,792,759,707,708,682,701,826,815,789,789,707,687,696,689,786,787,713,791,785,791,873,761,762,762,759,759,892,892,788,784,438,138,277,415,392,392,668,668,390,390,317,317,276,276,509,509,410,410,234,234,334,334,732,544,544,910,667,760,760,776,595,694,626,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,788,894,838,1016,458,748,924,748,918,927,928,928,834,873,828,924,924,917,930,931,463,883,836,836,867,867,696,696,874,874,760,946,771,865,771,888,967,888,831,873,927,970,918],o}(),t1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Kd=function(o){t1(t,o);function t(e,i,r){var n=o.call(this,i,typeof r=="undefined"?e instanceof t?e.style:Mi.Regular:r)||this;return n.dictionaryProperties=new $i,n.encodings=["Unknown","StandardEncoding","MacRomanEncoding","MacExpertEncoding","WinAnsiEncoding","PDFDocEncoding","IdentityH"],typeof e=="undefined"?n.pdfFontFamily=Br.Helvetica:e instanceof t?n.pdfFontFamily=e.fontFamily:n.pdfFontFamily=e,n.checkStyle(),n.initializeInternals(),n}return Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this.pdfFontFamily},enumerable:!0,configurable:!0}),t.prototype.checkStyle=function(){if(this.fontFamily===Br.Symbol||this.fontFamily===Br.ZapfDingbats){var e=this.style;e&=~(Mi.Bold|Mi.Italic),this.setStyle(e)}},t.prototype.getLineWidth=function(e,i){if(e==null)throw new Error("ArgumentNullException:line");var r=0,n=this.name;e=t.convert(e);for(var s=0,l=e.length;s<l;s++){var h=e[s],c=this.getCharWidthInternal(h,i);r+=c}var u=this.metrics.getSize(i);return r*=Ns.charSizeMultiplier*u,r=this.applyFormatSettings(e,i,r),r},t.prototype.equalsToFont=function(e){var i=!1,r=e;if(r!=null){var n=this.fontFamily===r.fontFamily,s=~(Mi.Underline|Mi.Strikeout),l=(this.style&s)==(r.style&s);i=n&&l}return i},t.prototype.initializeInternals=function(){var e=null;e=Ic.cache.search(this);var i=null,r=e1.getMetrics(this.pdfFontFamily,this.style,this.size);this.metrics=r,i=this.createInternals(),this.setInternals(i)},t.prototype.createInternals=function(){var e=new Ei;if(e.items.setValue(this.dictionaryProperties.type,new $t(this.dictionaryProperties.font)),e.items.setValue(this.dictionaryProperties.subtype,new $t(this.dictionaryProperties.type1)),e.items.setValue(this.dictionaryProperties.baseFont,new $t(this.metrics.postScriptName)),this.fontFamily!==Br.Symbol&&this.fontFamily!==Br.ZapfDingbats){var i=this.encodings[Vd.WinAnsiEncoding];e.items.setValue(this.dictionaryProperties.encoding,new $t(i))}return e},t.prototype.getCharWidthInternal=function(e,i){var r=0,n=0;n=e.charCodeAt(0),(this.name==="0"||this.name==="1"||this.name==="2"||this.name==="3"||this.name==="4")&&(n=n-t.charOffset),n=n>=0&&n!==128?n:0;var s=this.metrics,l=s.widthTable;return r=l.items(n),r},t.convert=function(e){return e},t.charOffset=32,t}(Ns),i1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ic=function(o){i1(t,o);function t(e){var i=o.call(this)||this;i.defaultMargin=40,i.streamWriter=null,i.document=i;var r=!1;typeof e=="undefined"?(t.cacheCollection=new P0,r=!1):r=e;var n=new Zx;i.setMainObjectCollection(n);var s=new h0;s.isMerging=r,s.document=i,i.setCrossTable(s);var l=new Fd;return i.setCatalog(l),n.add(l),l.position=-1,i.sectionCollection=new M0(i),i.documentPageCollection=new JE(i),l.pages=i.sectionCollection,i}return Object.defineProperty(t,"defaultFont",{get:function(){return this.defaultStandardFont==null&&(this.defaultStandardFont=new Kd(Br.Helvetica,8)),this.defaultStandardFont},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sections",{get:function(){return this.sectionCollection},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageSettings",{get:function(){return this.settings==null&&(this.settings=new lE(this.defaultMargin)),this.settings},set:function(e){this.settings=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pages",{get:function(){return this.documentPageCollection},enumerable:!0,configurable:!0}),Object.defineProperty(t,"cache",{get:function(){return typeof t.cacheCollection=="undefined"||t.cacheCollection==null?new P0:t.cacheCollection},set:function(e){this.cacheCollection=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"enableCache",{get:function(){return this.isCacheEnabled},set:function(e){this.isCacheEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"colorSpace",{get:function(){return this.pdfColorSpace===Ri.Rgb||this.pdfColorSpace===Ri.Cmyk||this.pdfColorSpace===Ri.GrayScale?this.pdfColorSpace:Ri.Rgb},set:function(e){e===Ri.Rgb||e===Ri.Cmyk||e===Ri.GrayScale?this.pdfColorSpace=e:this.pdfColorSpace=Ri.Rgb},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"template",{get:function(){return this.pageTemplate==null&&(this.pageTemplate=new R0),this.pageTemplate},set:function(e){this.pageTemplate=e},enumerable:!0,configurable:!0}),t.prototype.docSave=function(e,i,r){if(this.checkPagesPresence(),e===null)throw new Error("ArgumentNullException : stream");this.streamWriter=e;var n=new Ux(e);if(n.document=this,typeof i=="boolean"&&typeof r=="undefined")return this.crossTable.save(n);this.crossTable.save(n,i)},t.prototype.checkPagesPresence=function(){this.pages.count===0&&this.pages.add()},t.prototype.destroy=function(){this.catalog=void 0,this.colorSpace=void 0,this.currentSavingObj=void 0,this.documentPageCollection=void 0,this.isStreamCopied=void 0,this.pageSettings=void 0,this.pageTemplate=void 0,this.pdfColorSpace=void 0,this.sectionCollection=void 0,t.cache.destroy(),this.crossTable.pdfObjects.destroy(),t.cache=void 0,this.streamWriter.destroy()},t.defaultStandardFont=null,t.isCacheEnabled=!0,t}(Gx),N0=function(){function o(t,e,i,r,n){t instanceof bi&&typeof e=="undefined"?this.InitiateBounds(t.x,t.y,t.width,t.height,null):t instanceof bi&&e instanceof Fs&&typeof i=="undefined"?this.InitiateBounds(t.x,t.y,t.width,t.height,e):t instanceof oi&&e instanceof St&&typeof i=="undefined"?this.InitiateBounds(t.x,t.y,e.width,e.height,null):t instanceof oi&&e instanceof St&&i instanceof Fs&&typeof r=="undefined"?this.InitiateBounds(t.x,t.y,e.width,e.height,i):t instanceof St&&typeof e=="undefined"?this.InitiateBounds(0,0,t.width,t.height,null):typeof t=="number"&&typeof e=="number"&&typeof i=="undefined"?this.InitiateBounds(0,0,t,e,null):typeof t=="number"&&typeof e=="number"&&i instanceof Fs&&typeof r=="undefined"?this.InitiateBounds(0,0,t,e,i):typeof t=="number"&&typeof e=="number"&&typeof i=="number"&&typeof r=="number"&&typeof n=="undefined"?this.InitiateBounds(t,e,i,r,null):this.InitiateBounds(t,e,i,r,null)}return Object.defineProperty(o.prototype,"dock",{get:function(){return this.dockStyle},set:function(t){this.dockStyle=t,this.resetAlignment()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"alignment",{get:function(){return this.alignmentStyle},set:function(t){this.setAlignment(t)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"foreground",{get:function(){return this.isForeground},set:function(t){this.isForeground=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"background",{get:function(){return!this.isForeground},set:function(t){this.isForeground=!t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"location",{get:function(){return this.currentLocation},set:function(t){this.type===ti.None&&(this.currentLocation=t)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"x",{get:function(){var t=typeof this.currentLocation!="undefined"?this.currentLocation.x:0;return t},set:function(t){this.type===ti.None&&(this.currentLocation.x=t)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"y",{get:function(){var t=typeof this.currentLocation!="undefined"?this.currentLocation.y:0;return t},set:function(t){this.type===ti.None&&(this.currentLocation.y=t)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"size",{get:function(){return this.template.size},set:function(t){this.type===ti.None&&this.template.reset(t)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"width",{get:function(){return this.template.width},set:function(t){if(this.template.width!==t&&this.type===ti.None){var e=this.template.size;e.width=t,this.template.reset(e)}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this.template.height},set:function(t){if(this.template.height!==t&&this.type===ti.None){var e=this.template.size;e.height=t,this.template.reset(e)}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"graphics",{get:function(){return this.template.graphics},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"template",{get:function(){return this.pdfTemplate},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"type",{get:function(){return this.templateType},set:function(t){this.updateDocking(t),this.templateType=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"bounds",{get:function(){return new bi(new oi(this.x,this.y),this.size)},set:function(t){this.type===ti.None&&(this.location=new oi(t.x,t.y),this.size=new St(t.width,t.height))},enumerable:!0,configurable:!0}),o.prototype.InitiateBounds=function(t,e,i,r,n){this.x=t,this.y=e,this.pdfTemplate=new Zd(i,r)},o.prototype.updateDocking=function(t){if(t!==ti.None){switch(t){case ti.Top:this.dock=_i.Top;break;case ti.Bottom:this.dock=_i.Bottom;break;case ti.Left:this.dock=_i.Left;break;case ti.Right:this.dock=_i.Right;break}this.resetAlignment()}},o.prototype.resetAlignment=function(){this.alignment=Zt.None},o.prototype.setAlignment=function(t){if(this.dock===_i.None)this.alignmentStyle=t;else{var e=!1;switch(this.dock){case _i.Left:e=t===Zt.TopLeft||t===Zt.MiddleLeft||t===Zt.BottomLeft||t===Zt.None;break;case _i.Top:e=t===Zt.TopLeft||t===Zt.TopCenter||t===Zt.TopRight||t===Zt.None;break;case _i.Right:e=t===Zt.TopRight||t===Zt.MiddleRight||t===Zt.BottomRight||t===Zt.None;break;case _i.Bottom:e=t===Zt.BottomLeft||t===Zt.BottomCenter||t===Zt.BottomRight||t===Zt.None;break;case _i.Fill:e=t===Zt.MiddleCenter||t===Zt.None;break}e&&(this.alignmentStyle=t)}},o.prototype.draw=function(t,e){var i=t.page,r=this.calculateBounds(i,e);r.x===-0&&(r.x=0),t.graphics.drawPdfTemplate(this.template,new oi(r.x,r.y),new St(r.width,r.height))},o.prototype.calculateBounds=function(t,e){var i=this.bounds;return this.alignmentStyle!==Zt.None?i=this.getAlignmentBounds(t,e):this.dockStyle!==_i.None&&(i=this.getDockBounds(t,e)),i},o.prototype.getAlignmentBounds=function(t,e){var i=this.bounds;return this.type===ti.None?i=this.getSimpleAlignmentBounds(t,e):i=this.getTemplateAlignmentBounds(t,e),i},o.prototype.getSimpleAlignmentBounds=function(t,e){var i=this.bounds,r=t.section,n=r.getActualBounds(e,t,!1),s=this.x,l=this.y;switch(this.alignmentStyle){case Zt.TopLeft:s=0,l=0;break;case Zt.TopCenter:s=(n.width-this.width)/2,l=0;break;case Zt.TopRight:s=n.width-this.width,l=0;break;case Zt.MiddleLeft:s=0,l=(n.height-this.height)/2;break;case Zt.MiddleCenter:s=(n.width-this.width)/2,l=(n.height-this.height)/2;break;case Zt.MiddleRight:s=n.width-this.width,l=(n.height-this.height)/2;break;case Zt.BottomLeft:s=0,l=n.height-this.height;break;case Zt.BottomCenter:s=(n.width-this.width)/2,l=n.height-this.height;break;case Zt.BottomRight:s=n.width-this.width,l=n.height-this.height;break}return i.x=s,i.y=l,i},o.prototype.getTemplateAlignmentBounds=function(t,e){var i=this.bounds,r=t.section,n=r.getActualBounds(e,t,!1),s=this.x,l=this.y;switch(this.alignmentStyle){case Zt.TopLeft:this.type===ti.Left?(s=-n.x,l=0):this.type===ti.Top&&(s=-n.x,l=-n.y);break;case Zt.TopCenter:s=(n.width-this.width)/2,l=-n.y;break;case Zt.TopRight:this.type===ti.Right?(s=n.width+r.getRightIndentWidth(e,t,!1)-this.width,l=0):this.type===ti.Top&&(s=n.width+r.getRightIndentWidth(e,t,!1)-this.width,l=-n.y);break;case Zt.MiddleLeft:s=-n.x,l=(n.height-this.height)/2;break;case Zt.MiddleCenter:s=(n.width-this.width)/2,l=(n.height-this.height)/2;break;case Zt.MiddleRight:s=n.width+r.getRightIndentWidth(e,t,!1)-this.width,l=(n.height-this.height)/2;break;case Zt.BottomLeft:this.type===ti.Left?(s=-n.x,l=n.height-this.height):this.type===ti.Bottom&&(s=-n.x,l=n.height+r.getBottomIndentHeight(e,t,!1)-this.height);break;case Zt.BottomCenter:s=(n.width-this.width)/2,l=n.height+r.getBottomIndentHeight(e,t,!1)-this.height;break;case Zt.BottomRight:this.type===ti.Right?(s=n.width+r.getRightIndentWidth(e,t,!1)-this.width,l=n.height-this.height):this.type===ti.Bottom&&(s=n.width+r.getRightIndentWidth(e,t,!1)-this.width,l=n.height+r.getBottomIndentHeight(e,t,!1)-this.height);break}return i.x=s,i.y=l,i},o.prototype.getDockBounds=function(t,e){var i=this.bounds;return this.type===ti.None?i=this.getSimpleDockBounds(t,e):i=this.getTemplateDockBounds(t,e),i},o.prototype.getSimpleDockBounds=function(t,e){var i=this.bounds,r=t.section,n=r.getActualBounds(e,t,!1),s=this.x,l=this.y,h=this.width,c=this.height;switch(this.dockStyle){case _i.Left:s=0,l=0,h=this.width,c=n.height;break;case _i.Top:s=0,l=0,h=n.width,c=this.height;break;case _i.Right:s=n.width-this.width,l=0,h=this.width,c=n.height;break;case _i.Bottom:s=0,l=n.height-this.height,h=n.width,c=this.height;break;case _i.Fill:s=0,s=0,h=n.width,c=n.height;break}return i=new bi(s,l,h,c),i},o.prototype.getTemplateDockBounds=function(t,e){var i=this.bounds,r=t.section,n=r.getActualBounds(e,t,!1),s=r.pageSettings.getActualSize(),l=this.x,h=this.y,c=this.width,u=this.height;switch(this.dockStyle){case _i.Left:l=-n.x,h=0,c=this.width,u=n.height;break;case _i.Top:l=-n.x,h=-n.y,c=s.width,u=this.height,n.height<0&&(h=-n.y+s.height);break;case _i.Right:l=n.width+r.getRightIndentWidth(e,t,!1)-this.width,h=0,c=this.width,u=n.height;break;case _i.Bottom:l=-n.x,h=n.height+r.getBottomIndentHeight(e,t,!1)-this.height,c=s.width,u=this.height,n.height<0&&(h-=s.height);break;case _i.Fill:l=0,l=0,c=n.width,u=n.height;break}return i=new bi(l,h,c,u),i},o}(),B0=function(){function o(t){this.control=t}return o.prototype.print=function(t){this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWindow.moveTo(0,0),this.printWindow.resizeTo(screen.availWidth,screen.availHeight);var e={cancel:!1,htmlContent:this.getHTMLContent(t),name:Ig};this.control.trigger(Ig,e),e.cancel||(0,a.S0)(e.htmlContent,this.printWindow)},o.prototype.getHTMLContent=function(t){var e=(0,a.az)("div");if(t)if(t instanceof Array)for(var i=0;i<t.length;i++){var r=t[i];e.appendChild(xt(r).cloneNode(!0))}else t instanceof Element?e.appendChild(t.cloneNode(!0)):e.appendChild(xt(t).cloneNode(!0));else e.appendChild(this.control.element.cloneNode(!0));return e},o.prototype.export=function(t,e,i,r,n,s,l,h,c){var u=this,p=this.getControlsValue(r,l);n=n||p.width,s=s||p.height;var f=this.control.svgObject,g=this.control.enableCanvas,C;g||(f=(0,a.az)("canvas",{id:"ej2-canvas",attrs:{width:n.toString(),height:s.toString()}}));var L=!(a.AR.userAgent.toString().indexOf("HeadlessChrome")>-1);i=(0,a.le)(i)?fa.Landscape:i;var D='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+p.svg.outerHTML+"</svg>",R=window.URL.createObjectURL(new Blob(t==="SVG"?[D]:[new XMLSerializer().serializeToString(p.svg)],{type:"image/svg+xml"}));if(t==="SVG")if(a.AR.info.name==="msie"){var B=new Blob([new XMLSerializer().serializeToString(p.svg)],{type:"application/octet-stream"});window.navigator.msSaveOrOpenBlob(B,e+"."+t.toLocaleLowerCase())}else this.triggerDownload(e,t,R,L);else if(a.AR.info.name==="msie"){var H=f;g||(H=this.createCanvas()),C=H.toDataURL(),t==="PDF"?this.exportPdf(H,i,n,s,L,e,h,c):this.doexport(t,C,e)}else{var j=new Image,W=f.getContext("2d");j.onload=function(){W.drawImage(j,0,0),window.URL.revokeObjectURL(R),t==="PDF"?u.exportPdf(f,i,n,s,L,e,h,c):window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(f.toBlob(null),e+"."+t.toLocaleLowerCase()):u.triggerDownload(e,t,f.toDataURL("image/"+t.toLowerCase()),L)},j.src=R}g||ui(document.getElementById(this.control.element.id+"_canvas"))},o.prototype.getDataUrl=function(t){var e=this.getControlsValue([t]),i=this.control.svgObject,r=this.control.enableCanvas;r||(i=(0,a.az)("canvas",{id:"ej2-canvas",attrs:{width:e.width.toString(),height:e.height.toString()}}));var n=window.URL.createObjectURL(new Blob([new XMLSerializer().serializeToString(e.svg)],{type:"image/svg+xml"}));if(a.AR.info.name==="msie"){var s=i;r||(s=this.createCanvas());var l={name:pc,cancel:!1,dataUrl:i.toDataURL("image/png")};return t.trigger(pc,l),{element:s,dataUrl:s.toDataURL()}}else{var h=new Image,c=i.getContext("2d");return h.onload=function(){c.drawImage(h,0,0),window.URL.revokeObjectURL(n);var u={name:pc,cancel:!1,dataUrl:i.toDataURL("image/png")};return t.trigger(pc,u),u.dataUrl},h.src=n,{element:i,blobUrl:n}}},o.prototype.triggerDownload=function(t,e,i,r){(0,a.az)("a",{attrs:{download:t+"."+e.toLocaleLowerCase(),href:i}}).dispatchEvent(new MouseEvent(r?"click":"move",{view:window,bubbles:!1,cancelable:!0}))},o.prototype.getControlsValue=function(t,e){var i=0,r=0,n=this.control.enableCanvas,s=new Is("").createSvg({id:"Svg_Export_Element",width:200,height:200}),l;return t.map(function(h){var c=h.svgObject.cloneNode(!0),u=h.renderer.createGroup({style:(0,a.le)(e)||e?"transform: translateY("+r+"px)":"transform: translateX("+i+"px)"});l=c.childNodes[0]?c.childNodes[0].getAttribute("fill"):"transparent",(h.theme==="Tailwind"||h.theme==="TailwindDark"||h.theme==="Fluent")&&(l==="rgba(255,255,255, 0.0)"||l==="transparent")&&(c.childNodes[0].setAttribute("fill","rgba(255,255,255, 1)"),l="rgba(255,255,255, 1)"),n||u.appendChild(c);var p=0,f=0;h.stockLegendModule&&h.legendSettings.visible&&(h.legendSettings.position==="Bottom"||h.legendSettings.position==="Top"||h.legendSettings.position==="Auto"?p+=h.stockLegendModule.legendBounds.height:(h.legendSettings.position==="Left"||h.legendSettings.position==="Right")&&(f+=h.stockLegendModule.legendBounds.width)),i=(0,a.le)(e)||e?Math.max(h.availableSize.width+f,i):i+h.availableSize.width+f,r=(0,a.le)(e)||e?r+h.availableSize.height+p:Math.max(h.availableSize.height+p,r),n||s.appendChild(u)}),n||(s.setAttribute("width",i+""),s.setAttribute("height",r+""),s.setAttribute("style","background-color: "+l+";")),{width:i,height:r,svg:s}},o.prototype.createCanvas=function(){var t=this.control;this.canvasRender(!0,t);var e=t.svgObject;return this.canvasRender(!1,t),e},o.prototype.canvasRender=function(t,e){e.enableCanvas=t,e.preRender(),e.render()},o.prototype.exportPdf=function(t,e,i,r,n,s,l,h){var c=new Ic,u=c.pageSettings.margins,p=c.pageSettings.width,f=c.pageSettings.height,g=t.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream");c.pageSettings.orientation=e;var C=p<i?i+u.left+u.right:p,L=f<r?r+u.top+u.bottom:f;if(l!==void 0){var D=new Kd(1,l.fontSize||15),R=new N0(C,40);R.graphics.drawString(l.content+"",D,null,new oo(new ya(0,0,0)),l.x,l.y,null),c.template.top=R}if(h!==void 0){var D=new Kd(1,h.fontSize||15),B=new N0(C,40);B.graphics.drawString(h.content+"",D,null,new oo(new ya(0,0,0)),h.x,h.y,null),c.template.bottom=B}c.pageSettings.size=new St(C,L),g=g.slice(g.indexOf(",")+1),c.pages.add().graphics.drawImage(new k0(g),0,0,i,r),n&&(c.save(s+".pdf"),c.destroy())},o.prototype.doexport=function(t,e,i){var r=[],n=t||"JPG";r=[e],this.exportImage(r,i,n,e)},o.prototype.exportImage=function(t,e,i,r){for(var n=[],s=t instanceof HTMLElement?0:t.length,l=0;l<s;l++){r=t[l],r=r.replace(/^data:[a-z]*;,/,"");for(var h=r.split(","),c=atob(h[1]),u=new ArrayBuffer(c.length),p=new Uint8Array(u),f=0;f<c.length;f++)p[f]=c.charCodeAt(f);n.push(u)}for(var g=0;g<n.length;g++){var C=new Blob([n[g]],{type:"application/octet-stream"});a.AR.info.name==="msie"&&window.navigator.msSaveOrOpenBlob(C,e+"."+i.toLocaleLowerCase())}},o}(),Dc=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),$e=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},r1=function(o){Dc(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return $e([(0,a.Z9)()],t.prototype,"start",void 0),$e([(0,a.Z9)()],t.prototype,"end",void 0),$e([(0,a.Z9)([])],t.prototype,"colors",void 0),$e([(0,a.Z9)("")],t.prototype,"label",void 0),t}(a.rt),n1=function(o){Dc(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return $e([(0,a.Z9)(!1)],t.prototype,"enable",void 0),$e([(0,a.Z9)("")],t.prototype,"dashArray",void 0),$e([(0,a.Zz)({color:null,width:1},xr)],t.prototype,"line",void 0),$e([(0,a.Z9)("Both")],t.prototype,"lineType",void 0),$e([(0,a.Z9)("")],t.prototype,"verticalLineColor",void 0),$e([(0,a.Z9)("")],t.prototype,"horizontalLineColor",void 0),$e([(0,a.Z9)(1)],t.prototype,"opacity",void 0),t}(a.rt),s1=function(o){Dc(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return $e([(0,a.Z9)(!1)],t.prototype,"enableSelectionZooming",void 0),$e([(0,a.Z9)(!1)],t.prototype,"enablePinchZooming",void 0),$e([(0,a.Z9)(!1)],t.prototype,"enableMouseWheelZooming",void 0),$e([(0,a.Z9)(!0)],t.prototype,"enableDeferredZooming",void 0),$e([(0,a.Z9)("XY")],t.prototype,"mode",void 0),$e([(0,a.Z9)(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],t.prototype,"toolbarItems",void 0),$e([(0,a.Z9)(!1)],t.prototype,"enablePan",void 0),$e([(0,a.Z9)(!1)],t.prototype,"enableScrollbar",void 0),t}(a.rt),Xd=function(o){Dc(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.rotatedDataLabelCollections=[],r.animated=!1,r.isPointMouseDown=!1,r.isScrolling=!1,r.checkResize=0,r.visible=0,r.clickCount=0,r.maxPointCount=0,r.singleClickTimer=0,r.chartAreaType="Cartesian",r.isRtlEnabled=!1,r.scaleX=1,r.scaleY=1,r.chartid=57723,(0,a.sO)("mergePersistData",r.mergePersistChartData,r),r}return t.prototype.mergePersistChartData=function(){var e=window.localStorage.getItem(this.getModuleName()+this.element.id);if(!((0,a.le)(e)||e==="")){var i=JSON.parse(e),r=Object.keys(i);this.isProtectedOnChange=!0;for(var n=0,s=r;n<s.length;n++){var l=s[n];typeof this[l]=="object"&&!(0,a.le)(this[l])?(0,a.l7)(this[l],i[l]):this[l]=i[l]}this.isProtectedOnChange=!1}},t.prototype.isIdHasSpecialCharacter=function(e){var i=/^[A-Za-z ]+$/,r=/^[0-9 ]+$/,n="";if(i.test(e))return e;var s=0;r.test(e[0])&&(n+="\\3"+e[0],s=1);for(var l=s;l<e.length;l++)!i.test(e[l])&&e.indexOf("-")===-1&&e.indexOf("_")===-1&&e.indexOf("\\")===-1&&!r.test(e[l])?n+="\\"+e[l]:n+=e[l];return n},t.prototype.preRender=function(){this.element.id=this.isIdHasSpecialCharacter(this.element.id);var e="Blazor";this.isBlazor=window[e],this.allowServerDataBinding=!1,this.unWireEvents(),this.initPrivateVariable(),this.setCulture(),this.wireEvents(),this.stockChart&&(this.stockChart.tooltip.header===null&&(this.tooltip.header="<b>${point.x}</b>"),this.stockChart.tooltip.format===null&&(this.tooltip.format="High : <b>${point.high}</b><br/>Low : <b>${point.low}</b><br/>Open : <b>${point.open}</b><br/>Close : <b>${point.close}</b>",this.stockChart.series[0].volume!==""&&(this.tooltip.format+="<br/>Volume : <b>${point.volume}</b>")),this.animateSeries=!1),this.element.setAttribute("dir",this.enableRtl?"rtl":"")},t.prototype.initPrivateVariable=function(){if(this.animateSeries=!0,this.delayRedraw=!1,this.horizontalAxes=[],this.verticalAxes=[],this.refreshAxis(),this.refreshDefinition(this.rows),this.refreshDefinition(this.columns),this.tooltipModule&&(this.tooltipModule.previousPoints=[]),this.element.id===""){var e=document.getElementsByClassName("e-chart").length;this.element.id="chart_"+this.chartid+"_"+e}this.svgId=this.stockChart?this.stockChart.element.id+"_stockChart_chart":this.element.id+(this.enableCanvas?"_canvas":"_svg")},t.prototype.render=function(){var e=this;this.svgRenderer=new Is(this.element.id);var i={chart:this.isBlazor?{}:this,theme:this.theme,name:oc,cancel:!1};this.stockChart?(this.isRtlEnabled=window.getComputedStyle(document.querySelector("body")).direction==="rtl",this.cartesianChartRendering(i)):this.trigger(oc,i,function(){i.cancel||e.cartesianChartRendering(i)})},t.prototype.cartesianChartRendering=function(e){this.theme=this.isBlazor?e.theme:this.theme,this.createChartSvg(),this.setTheme(),this.markerRender=new _x(this),this.calculateAreaType(),this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.calculateVisibleAxis(),this.processData(),this.renderComplete(),this.allowServerDataBinding=!0},t.prototype.getLocalizedLabel=function(e){return this.localeObject.getConstant(e)},t.prototype.animate=function(e){this.redraw=!0,this.animated=!0,this.duration=e||1e3},t.prototype.refreshBound=function(){if(this.rotatedDataLabelCollections=[],this.legendModule&&this.legendSettings.visible&&this.legendModule.getLegendOptions(this.visibleSeries,this),this.tooltip.enable&&this.tooltipModule&&(this.tooltipModule.previousPoints=[]),this.calculateStackValues(),this.calculateBounds(),this.stockChart&&!this.stockChart.rangeFound&&(this.stockChart.enablePeriodSelector||this.stockChart.enableSelector))return null;this.renderElements(),ui("chartmeasuretext"),this.removeSelection(),this.markerRender&&this.markerRender.mergeXvalues(this.visibleSeries)},t.prototype.calculateStackValues=function(){for(var e,i=!1,r=0,n=this.visibleSeries.length;r<n;r++)e=this.visibleSeries[r],e.position=e.rectCount=void 0,(e.type.indexOf("Stacking")!==-1||e.drawType.indexOf("Stacking")!==-1&&this.chartAreaType==="PolarRadar")&&!i&&(e.calculateStackedValue(e.type.indexOf("100")>-1,this),i=!0)},t.prototype.removeSelection=function(){for(var e=0,i=this.visibleSeries;e<i.length;e++){var r=i[e];if(r.visible)for(var n=0,s=r.points;n<s.length;n++){var l=s[n];l.isSelect=!1}}xt(this.element.id+"_ej2_drag_multi_group")?(this.selectionMode.indexOf("Drag")>-1&&(this.selectionModule.filterArray=[]),ui(this.element.id+"_ej2_drag_multi_group"),this.selectionModule.calculateDragSelectedElements(this,new ft(0,0,0,0),!0)):xt(this.element.id+"_ej2_drag_group")&&(this.selectionMode!=="Lasso"&&(this.selectionModule.filterArray=[]),ui(this.element.id+"_ej2_drag_group"),this.selectionModule.calculateDragSelectedElements(this,new ft(0,0,0,0),!0))},t.prototype.renderElements=function(){this.renderBorder(),this.renderTitle(),this.renderAreaBorder(),this.renderSeriesElements(this.renderAxes()),this.renderLegend(),this.applyZoomkit(),this.performSelection(),this.setSecondaryElementPosition();for(var e=0,i=this.visibleSeries;e<i.length;e++){var r=i[e];(0,a.tx)(this.element.id+"_DataLabel","Template",r.marker.dataLabel)}this.renderAnnotation()},t.prototype.renderAxes=function(){this.yAxisElements=this.renderer.createGroup({id:this.element.id+"yAxisCollection"});var e;return this.rows.length>0&&this.columns.length>0&&(e=this.chartAxisLayoutPanel.renderAxes()),this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Behind",this.axisCollections),e},t.prototype.renderLegend=function(){if(this.legendModule&&this.legendModule.legendCollections.length&&this.legendSettings.visible){this.legendModule.calTotalPage=!0;var e=this.legendSettings.border.width,i=this.legendModule.legendBounds,r=new ft(i.x,i.y,i.width,i.height);this.enableCanvas&&(r=new ft(r.x-e/2,r.y-e/2,r.width+e,r.height+e),this.renderer.canvasClip(r)),this.legendModule.renderLegend(this,this.legendSettings,i),this.enableCanvas&&this.renderer.canvasRestore()}this.redraw||(this.stockChart?xt(this.stockChart.chartObject.id)||this.stockChart.mainObject.appendChild(this.svgObject):this.element.appendChild(this.svgObject))},t.prototype.setSecondaryElementPosition=function(){var e=xt(this.element.id+"_Secondary_Element");if(!!e){var i=this.element.getBoundingClientRect(),r=xt(this.svgId).getBoundingClientRect();e.style.left=Math.max(r.left-i.left,0)+"px",e.style.top=Math.max(r.top-i.top,0)+"px"}},t.prototype.initializeModuleElements=function(){this.dataLabelCollections=[];var e=this.element.id;this.series.length&&(this.seriesElements=this.svgRenderer.createGroup({id:e+"SeriesCollection"})),this.indicators.length&&(this.indicatorElements=this.renderer.createGroup({id:e+"IndicatorCollection"})),this.hasTrendlines()&&(this.trendLineElements=this.renderer.createGroup({id:e+"TrendLineCollection"})),this.dataLabelElements=this.renderer.createGroup({id:e+"DataLabelCollection"})},t.prototype.hasTrendlines=function(){for(var e,i=0,r=this.series;i<r.length;i++){var n=r[i];if(e=!!n.trendlines.length,e)break}return e},t.prototype.renderSeriesElements=function(e){this.initializeModuleElements();var i=this.element.id;if(this.element.tagName!=="g"){var r=is(this.redraw,i+"_Secondary_Element")||this.createElement("div");r.id=i+"_Secondary_Element",r.style.cssText="position: relative",Nt(!1,this.element,r,this.redraw)}if(this.enableCanvas){var n=document.getElementById(i+"_Secondary_Element");n=n||this.createElement("div",{id:i+"_Secondary_Element",attrs:{style:"position: relative; left:0px; top:0px"}});var s=this.svgRenderer.createSvg({id:i+"_tooltip_svg",width:this.availableSize.width,height:this.availableSize.height});s.style.cssText="position: absolute; pointer-events: none",n.appendChild(s)}this.tooltip.enable&&Nt(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:i+"_UserInteraction",style:"pointer-events:none;"}),this.redraw),this.rows.length>0&&this.columns.length>0&&(this.initializeIndicator(),this.initializeTrendLine(),this.renderSeries(),this.trendLineElements&&Nt(this.enableCanvas,this.svgObject,this.trendLineElements,this.redraw),this.appendElementsAfterSeries(e))},t.prototype.renderSeries=function(){var e;this.enableCanvas&&this.renderer.canvasClip(this.chartAxisLayoutPanel.seriesClipRect);for(var i=0,r=this.visibleSeries;i<r.length;i++){var n=r[i];n.category==="TrendLine"?e=this.series[n.sourceIndex].trendlines[n.index].visible:e=n.visible,e&&(this.visible++,vx(n,this.enableCanvas),this.enableCanvas&&this.renderCanvasSeries(n),n.renderSeries(this))}this.enableCanvas&&this.renderer.canvasRestore(),this.visible=0;var s={id:this.element.id+"_ChartAreaClipRect_",x:this.chartAxisLayoutPanel.seriesClipRect.x,y:this.chartAxisLayoutPanel.seriesClipRect.y,width:this.chartAxisLayoutPanel.seriesClipRect.width,height:this.chartAxisLayoutPanel.seriesClipRect.height,fill:"transparent","stroke-width":1,stroke:"Gray"};if(!!this.seriesElements){var l;this.chartAreaType==="PolarRadar"?l=da(this.redraw,s,this.renderer,"drawCircularClipPath"):l=da(this.redraw,s,this.renderer),this.enableCanvas||this.seriesElements.appendChild(l);var h=document.getElementById(this.element.id+"_series_svg");h?Nt(!1,h,this.seriesElements,this.redraw):Nt(this.enableCanvas,this.svgObject,this.seriesElements,this.redraw)}},t.prototype.renderCanvasSeries=function(e){var i,r;if(e.type==="Bubble"||e.type==="Scatter"||e.drawType==="Scatter"){i=i||this.svgRenderer.createSvg({id:this.element.id+"_series_svg",width:this.availableSize.width,height:this.availableSize.height}),r=r||this.createElement("div",{id:this.element.id+"_series"}),r.style.cssText="position: absolute";var n=document.getElementById(this.element.id+"_Secondary_Element");r.appendChild(i),n.appendChild(r)}i=this.enableCanvas&&(e.type==="Bubble"||e.type==="Scatter"||e.drawType==="Scatter")?i:this.svgObject;var s=this.enableCanvas&&(e.type==="Bubble"||e.type==="Scatter"||e.drawType==="Scatter")?!1:this.enableCanvas},t.prototype.initializeIndicator=function(){for(var e=0,i=this.indicators;e<i.length;e++){var r=i[e];this[On(r.type)+"IndicatorModule"]&&this[On(r.type)+"IndicatorModule"].createIndicatorElements(this,r,r.index)}this.indicatorElements&&Nt(this.enableCanvas,this.svgObject,this.indicatorElements,this.redraw)},t.prototype.initializeTrendLine=function(){for(var e=0,i=this.visibleSeries;e<i.length;e++){var r=i[e];r.trendlines.length&&this.trendLineModule.getTrendLineElements(r,this)}},t.prototype.appendElementsAfterSeries=function(e){this.chartAreaType==="PolarRadar"&&Nt(this.enableCanvas,this.svgObject,this.yAxisElements,this.redraw),Nt(this.enableCanvas,this.svgObject,e,this.redraw),(this.zoomModule&&this.zoomSettings.enableScrollbar&&this.scrollElement.childElementCount||this.scrollElement&&this.scrollElement.childElementCount)&&Nt(!1,xt(this.element.id+"_Secondary_Element"),this.scrollElement,this.redraw),this.stripLineModule&&this.stripLineModule.renderStripLine(this,"Over",this.axisCollections),this.tooltip.enable||Nt(this.enableCanvas,this.svgObject,this.renderer.createGroup({id:this.element.id+"_UserInteraction",style:"pointer-events:none;"}),this.redraw),this.stockChart&&this.stockChart.calculateStockEvents()},t.prototype.applyZoomkit=function(){this.chartAreaType!=="PolarRadar"&&!this.redraw&&this.zoomModule&&(!this.zoomSettings.enablePan||this.zoomModule.performedUI)&&this.zoomModule.applyZoomToolkit(this,this.axisCollections)},t.prototype.renderAnnotation=function(){this.annotationModule&&this.annotationModule.renderAnnotations(xt((this.stockChart?this.stockChart.element.id:this.element.id)+"_Secondary_Element"))},t.prototype.performSelection=function(){var e=[];this.selectionModule&&(e=(0,a.l7)([],this.selectionModule.selectedDataIndexes,null,!0),this.selectionModule.invokeSelection(this)),this.highlightModule&&this.highlightModule.invokeHighlight(this),e.length>0&&(this.selectionModule.selectedDataIndexes=e,this.selectionModule.redrawSelection(this,this.selectionMode))},t.prototype.processData=function(e){e===void 0&&(e=!0),this.visibleSeriesCount=0;for(var i=!0,r=0,n=0,s=this.visibleSeries;n<s.length;n++){var l=s[n];if(!l.visible&&!this.legendSettings.visible){this.visibleSeriesCount++;continue}l.category!=="Indicator"&&l.category!=="TrendLine"&&this.initializeDataModule(l)}for(var h=0,c=this.indicators;h<c.length;h++){var u=c[h];if(u.dataSource){var p=u;this.initializeDataModule(p),i=!1}}if(e&&(!this.visibleSeries.length||this.visibleSeriesCount===this.visibleSeries.length&&i)&&(this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this})),!this.stockChart&&this.visibleSeries.length>0)for(var f=0,g=this.visibleSeries;f<g.length;f++){var l=g[f];(0,a.le)(l.points)||(this.maxPointCount=Math.max(r,l.points.length),r=l.points.length)}},t.prototype.initializeDataModule=function(e){e.xData=[],e.yData=[];var i,r="isAngular";this[r]?i=Object.keys(e.dataSource).length?e.dataSource:this.dataSource:i=e.dataSource||this.dataSource,e.dataModule=new e0(i,e.query),e.refreshDataManager(this,e)},t.prototype.calculateBounds=function(){var e=this.margin,i=0,r=0,n=0,s=15,l=e.left,h=this.availableSize.width-l-e.right-this.border.width;if(this.titleCollection=[],this.subTitleCollection=[],this.title&&(this.titleCollection=io(this.title,this.titleStyle,h),i=Pt(this.title,this.titleStyle).height*this.titleCollection.length+s,this.subTitle)){for(var c=0,u=0,p=this.titleCollection;u<p.length;u++){var f=p[u];n=Pt(f,this.titleStyle).width,c=n>c?n:c}this.subTitleCollection=io(this.subTitle,this.subTitleStyle,c),r=Pt(this.subTitle,this.subTitleStyle).height*this.subTitleCollection.length+s}var g=e.top+r+i+this.chartArea.border.width*.5,C=this.availableSize.height-g-this.border.width-e.bottom;this.stockChart&&this.stockChart.legendSettings.visible&&this.stockChart.stockLegendModule&&(this.stockChart.legendSettings.position==="Top"?g+=this.stockChart.stockLegendModule.legendBounds.height:this.stockChart.legendSettings.position==="Left"&&(l+=this.stockChart.stockLegendModule.legendBounds.width)),this.initialClipRect=new ft(l,g,h,C),this.legendModule&&this.legendSettings.visible&&this.legendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null),this.chartAxisLayoutPanel.measureAxis(this.initialClipRect)},t.prototype.print=function(e){var i=new B0(this);i.print(e)},t.prototype.initTrendLines=function(){this.isProtectedOnChange=!0;for(var e=0,i=this.visibleSeries;e<i.length;e++)for(var r=i[e],n=0,s=0,l=r.trendlines;s<l.length;s++){var h=l[s],c=h;this.trendLineModule&&(c.index=n,c.sourceIndex=r.index,this.trendLineModule.initSeriesCollection(c,this),c.targetSeries&&(c.targetSeries.xAxisName=r.xAxisName,c.targetSeries.yAxisName=r.yAxisName,this.visibleSeries.push(c.targetSeries))),n++}this.isProtectedOnChange=!1},t.prototype.calculateAreaType=function(){var e=this.series[0];this.chartArea.border.width=this.stockChart?0:this.chartArea.border.width,e&&(this.requireInvertedAxis=e.type.indexOf("Bar")!==-1&&!this.isTransposed||e.type.indexOf("Bar")===-1&&this.isTransposed&&this.chartAreaType!=="PolarRadar"),this.chartAxisLayoutPanel=this.chartAreaType==="PolarRadar"?this.polarSeriesModule||this.radarSeriesModule:new Rx(this)},t.prototype.calculateVisibleAxis=function(){var e,i=[this.primaryXAxis,this.primaryYAxis];i=this.chartAreaType==="Cartesian"?i.concat(this.axes):i,this.paretoSeriesModule&&this.series[0].type==="Pareto"&&(i=i.concat(this.paretoSeriesModule.paretoAxes)),this.axisCollections=[],this.zoomModule&&(this.zoomModule.isPanning=this.zoomModule.isAxisZoomed(i)&&this.zoomSettings.enablePan,this.svgObject.setAttribute("cursor",this.zoomModule.isPanning?"pointer":"auto"),this.scrollBarModule&&(this.scrollBarModule.axes=i)),this.scrollSettingEnabled&&this.scrollBarModule&&(this.scrollBarModule.axes=i);for(var r=0,n=i.length;r<n;r++){e=i[r],e.series=[],e.labels=[],e.indexLabels={};for(var s=0,l=this.visibleSeries;s<l.length;s++){var h=l[s];this.initAxis(h,e,!0)}for(var c=0,u=this.indicators;c<u.length;c++){var p=u[c];this.initAxis(p,e,!1)}this.scrollBarModule&&!e.zoomingScrollBar&&this.scrollBarModule.injectTo(e,this),e.orientation!=null&&this.axisCollections.push(e)}this.rows.length>0&&this.columns.length>0&&this.chartAxisLayoutPanel.measure()},t.prototype.initAxis=function(e,i,r){e.xAxisName===i.name||e.xAxisName==null&&i.name==="primaryXAxis"?(i.orientation=this.requireInvertedAxis?"Vertical":"Horizontal",e.xAxis=i,r&&i.series.push(e)):(e.yAxisName===i.name||e.yAxisName==null&&i.name==="primaryYAxis")&&(i.orientation=this.requireInvertedAxis?"Horizontal":"Vertical",e.yAxis=i,r&&i.series.push(e))},t.prototype.initTechnicalIndicators=function(){for(var e=0,i=0,r=this.indicators;i<r.length;i++){var n=r[i],s=n,l=On(s.type);if(this[l+"IndicatorModule"]){s.index=e,this[l+"IndicatorModule"].initSeriesCollection(s,this);for(var h=0,c=s.targetSeries;h<c.length;h++){var u=c[h];(n.seriesName||n.dataSource)&&this.visibleSeries.push(u)}}e++}},t.prototype.refreshTechnicalIndicator=function(e){if(this.indicators.length){var i=null;if(e instanceof Ki&&e.category!=="Indicator")for(var r=0,n=this.indicators;r<n.length;r++){var s=n[r];s.seriesName===e.name&&!s.dataSource&&(i=s,i.setDataSource(e,this))}else e instanceof n0&&(i=e,i.setDataSource(e instanceof Ki?e:null,this))}},t.prototype.calculateVisibleSeries=function(){var e;this.visibleSeries=[];for(var i=this.palettes.length?this.palettes:sg(this.theme),r=i.length,n=this.series.sort(function(h,c){return h.zOrder-c.zOrder}),s=0,l=n.length;s<l;s++){switch(e=n[s],e.category=n[0].type==="Pareto"?"Pareto":"Series",e.index=s,e.interior=e.fill||i[s%r],e.type){case"Bar":case"StackingBar":case"StackingBar100":if(n[0].type.indexOf("Bar")===-1)continue;break;case"Polar":case"Radar":if(this.chartAreaType!=="PolarRadar"||this.chartAreaType==="PolarRadar"&&(e.xAxisName===null&&e.yAxisName!==null||e.xAxisName!==null&&e.yAxisName===null||e.xAxisName!==null&&e.yAxisName!==null))continue;break;case"Pareto":this.visibleSeries.push(e),this.paretoSeriesModule.initSeries(e,this);continue;default:if(this.chartAreaType==="PolarRadar"||n[0].type.indexOf("Bar")>-1)continue;break}this.visibleSeries.push(e),n[s]=e}},t.prototype.renderTitle=function(){var e,i=this.margin;if(this.title){var r=bl(this.titleStyle.textAlignment,this.enableRtl),n=Pt(this.title,this.titleStyle);e=new ft(i.left,0,this.availableSize.width-i.left-i.right,0);var s=new fr(this.element.id+"_ChartTitle",gl(e,this.titleStyle),this.margin.top+n.height*3/4,r,this.titleCollection,"","auto"),l=is(this.redraw,this.element.id+"_ChartTitle",s,this.renderer)||mr(this.renderer,s,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitle,this.svgObject,null,null,null,null,null,null,null,null,this.enableCanvas);l&&(l.setAttribute("aria-label",this.description||this.title),l.setAttribute("tabindex",this.tabIndex.toString())),this.subTitle&&this.renderSubTitle(s)}},t.prototype.renderSubTitle=function(e){for(var i=0,r=0,n=10,s=this.titleStyle.textAlignment,l=0,h=this.titleCollection;l<h.length;l++){var c=h[l];r=Pt(c,this.titleStyle).width,i=r>i?r:i}var u=Pt(this.subTitle,this.subTitleStyle),p=new ft(s==="Center"?e.x-i*.5:s==="Far"?e.x-i:e.x,0,i,0),f=new fr(this.element.id+"_ChartSubTitle",gl(p,this.subTitleStyle),e.y*e.text.length+u.height*3/4+n,bl(this.subTitleStyle.textAlignment,this.enableRtl),this.subTitleCollection,"","auto"),g=is(this.redraw,this.element.id+"_ChartSubTitle",f,this.renderer)||mr(this.renderer,f,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartTitle,this.svgObject,null,null,null,null,null,null,null,null,this.enableCanvas);g&&(g.setAttribute("aria-label",this.description||this.subTitle),g.setAttribute("tabindex",this.tabIndex.toString()))},t.prototype.renderBorder=function(){var e=0,i=0,r=this.border.width,n=this.backgroundImage,s=n?"transparent":this.background||this.themeStyle.background;this.stockChart&&this.stockChart.legendSettings.visible&&this.stockChart.stockLegendModule&&(this.stockChart.legendSettings.position==="Top"?i+=this.stockChart.stockLegendModule.legendBounds.height:this.stockChart.legendSettings.position==="Left"&&(e+=this.stockChart.stockLegendModule.legendBounds.width));var l=new Sn(this.element.id+"_ChartBorder",s,this.border,1,new ft(r*.5+e,r*.5+i,this.availableSize.width-r,this.availableSize.height-r));if(this.htmlObject=is(this.redraw,this.element.id+"_ChartBorder",l,this.renderer)||this.renderer.drawRectangle(l),Nt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw),n){var h=new Od(this.availableSize.height-r,this.availableSize.width-r,n,0,0,this.element.id+"_ChartBackground","visible","none");this.htmlObject=is(this.redraw,this.element.id+"_ChartBackground",h,this.renderer)||this.renderer.drawImage(h),Nt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw)}},t.prototype.renderAreaBorder=function(){if(this.chartAreaType==="PolarRadar")return null;var e=xt(this.element.id+"_ChartAreaBorder"),i=e?new ft(+e.getAttribute("x"),+e.getAttribute("y"),+e.getAttribute("width"),+e.getAttribute("height")):null,r=new Sn(this.element.id+"_ChartAreaBorder",this.chartArea.background,{width:this.chartArea.border.width,color:this.chartArea.border.color||this.themeStyle.areaBorder},this.chartArea.opacity,this.chartAxisLayoutPanel.seriesClipRect);this.htmlObject=this.renderer.drawRectangle(r),Nt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0,i),this.htmlObject=null;var n=this.chartArea.backgroundImage;if(n){var s=this.chartArea.border.width,l=new Od(this.initialClipRect.height-s,this.initialClipRect.width-s,n,this.initialClipRect.x,this.initialClipRect.y,this.element.id+"_ChartAreaBackground","visible","none");this.htmlObject=this.renderer.drawImage(l),Nt(this.enableCanvas,this.svgObject,this.htmlObject,this.redraw,!0,"x","y",null,null,!0,!0)}},t.prototype.addSeries=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];n=new Ki(this,"series",n),this.series.push(n)}this.refresh()},t.prototype.removeSeries=function(e){this.redraw=!1,this.series.splice(e,1),this.refresh()},t.prototype.clearSeries=function(){this.series=[],this.refresh()},t.prototype.addAxes=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];n=new dc(this,"axes",n),this.isBlazor&&(n.interval=isNaN(n.interval)?null:n.interval,n.desiredIntervals=isNaN(n.desiredIntervals)?null:n.desiredIntervals),this.axes.push(n)}this.refresh()},t.prototype.removeAxis=function(e){this.redraw=!1,this.axes.splice(e,1),this.refresh()},t.prototype.destroy=function(){this.scrollBarModule&&this.scrollBarModule.destroy(),this.markerRender&&(this.markerRender.removeEventListener(),this.markerRender=null),this.horizontalAxes=[],this.verticalAxes=[],this.visibleSeries=[],this.axisCollections=[],this.rotatedDataLabelCollections=[],this.seriesElements=null,this.chartAxisLayoutPanel=null,this.dataLabelCollections=null,this.dataLabelElements=null,this.yAxisElements=null,this.element&&(this.unWireEvents(),this.isReact&&this.clearTemplate(),o.prototype.destroy.call(this),this.enableCanvas||(this.removeSvg(),this.svgObject=null))},t.prototype.getModuleName=function(){return"chart"},t.prototype.getPersistData=function(){var e=["loaded","animationComplete","primaryXAxis","primaryYAxis"];return this.addOnPersist(e)},t.prototype.createChartSvg=function(){this.removeSvg(),Zg(this)},t.prototype.unWireEvents=function(){var e=a.AR.touchStartEvent,i=a.AR.touchMoveEvent,r=a.AR.touchEndEvent,n=a.AR.isPointer?"pointerleave":"mouseleave";/*! UnBind the Event handler */a.bi.remove(this.element,e,this.chartOnMouseDown),a.bi.remove(this.element,i,this.mouseMove),a.bi.remove(this.element,r,this.mouseEnd),a.bi.remove(this.element,"click",this.chartOnMouseClick),a.bi.remove(this.element,"dblclick",this.chartOnDoubleClick),a.bi.remove(this.element,"contextmenu",this.chartRightClick),a.bi.remove(this.element,n,this.mouseLeave),window.removeEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound),this.touchObject&&(this.touchObject.destroy(),this.touchObject=null)},t.prototype.wireEvents=function(){if(!this.element)return;/*! Find the Events type */var e=a.AR.isPointer?"pointerleave":"mouseleave";/*! Bind the Event handler */a.bi.add(this.element,a.AR.touchStartEvent,this.chartOnMouseDown,this),a.bi.add(this.element,a.AR.touchMoveEvent,this.mouseMove,this),a.bi.add(this.element,a.AR.touchEndEvent,this.mouseEnd,this),a.bi.add(this.element,"click",this.chartOnMouseClick,this),a.bi.add(this.element,"dblclick",this.chartOnDoubleClick,this),a.bi.add(this.element,"contextmenu",this.chartRightClick,this),a.bi.add(this.element,e,this.mouseLeave,this),this.resizeBound=this.chartResize.bind(this),window.addEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeBound),this.longPressBound=this.longPress.bind(this),this.touchObject=new a.Xh(this.element,{tapHold:this.longPressBound,tapHoldThreshold:500});/*! Apply the style for chart */this.setStyle(this.element)},t.prototype.chartRightClick=function(e){return this.crosshair.enable&&this.crosshairModule&&(e.buttons===2||e.which===0||e.pointerType==="touch")?(e.preventDefault(),e.stopPropagation(),!1):!0},t.prototype.setStyle=function(e){var i=this.zoomSettings,r=i.enableSelectionZooming||i.enablePinchZooming||this.selectionMode!=="None"||this.crosshair.enable||this.highlightMode!=="None";e.style.touchAction=r?"none":"element",e.style.msTouchAction=r?"none":"element",e.style.msContentZooming="none",e.style.msUserSelect="none",e.style.webkitUserSelect="none",e.style.position="relative",e.style.display="block",e.style.overflow="hidden"},t.prototype.isOrientation=function(){return"orientation"in window&&"onorientationchange"in window},t.prototype.longPress=function(e){return this.mouseX=e&&e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].clientX:0,this.mouseY=e&&e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].clientY:0,this.startMove=!0,this.setMouseXY(this.mouseX,this.mouseY),this.notify("tapHold",e),!1},t.prototype.setMouseXY=function(e,i){if(xt(this.svgId)){var r=xt(this.svgId).getBoundingClientRect(),n=this.element.getBoundingClientRect();this.mouseY=i-n.top-Math.max(r.top-n.top,0)/this.scaleX,this.mouseX=e-n.left-Math.max(r.left-n.left,0)/this.scaleY}},t.prototype.export=function(e,i){this.exportModule&&(this.exportModule.export(e,i),this.afterExport&&this.exportModule.getDataUrl(this))},t.prototype.chartResize=function(){var e=this;this.animateSeries=!1;var i={chart:this.isBlazor?{}:this,name:cc,currentSize:new ni(0,0),previousSize:new ni(this.availableSize.width,this.availableSize.height)},r={name:"beforeResize",cancelResizedEvent:!1};return this.resizeTo&&clearTimeout(this.resizeTo),this.trigger(kg,r),r.cancelResizedEvent||(this.resizeTo=+setTimeout(function(){if(e.isDestroyed||e.stockChart){clearTimeout(e.resizeTo);return}e.createChartSvg(),i.currentSize=e.availableSize,e.trigger(cc,i),e.refreshAxis(),e.refreshBound(),e.trigger("loaded",{chart:e.isBlazor?{}:e})},500)),!1},t.prototype.mouseMove=function(e){var i,r,n;return e.type==="touchmove"?(this.isTouch=!0,n=e,i=n.changedTouches[0].clientX,r=n.changedTouches[0].clientY):(this.isTouch=e.pointerType==="touch"||e.pointerType==="2"||this.isTouch,i=e.clientX,r=e.clientY),xt(this.svgId)&&(this.setMouseXY(i,r),this.chartOnMouseMove(e)),!1},t.prototype.mouseLeave=function(e){var i,r,n;return e.type==="touchleave"?(this.isTouch=!0,n=e,i=n.changedTouches[0].clientX,r=n.changedTouches[0].clientY):(this.isTouch=e.pointerType==="touch"||e.pointerType==="2",i=e.clientX,r=e.clientY),this.setMouseXY(i,r),this.chartOnMouseLeave(e),!1},t.prototype.chartOnMouseLeave=function(e){var i=e.target,r=a.AR.isPointer?"pointerleave":"mouseleave";return this.trigger(Ag,{target:i.id,x:this.mouseX,y:this.mouseY}),ui(this.element.id+"_EJ2_AxisLabel_Tooltip"),this.isChartDrag=this.isPointMouseDown=!1,this.notify(r,e),!1},t.prototype.chartOnDoubleClick=function(e){var i=e.target;return this.trigger(wg,{target:i.id,x:this.mouseX,y:this.mouseY}),!1},t.prototype.chartOnMouseClick=function(e){var i=this,r=e.target;this.trigger(Sg,{target:r.id,x:this.mouseX,y:this.mouseY}),this.clickCount++;var n=0,s="isAngular";if(this[s]){var l="observers";n=this.pointDoubleClick[l].length>0?400:0}else n=this.pointDoubleClick?400:0;return this.clickCount===1&&this.pointClick?this.singleClickTimer=+setTimeout(function(){i.clickCount=0,i.triggerPointEvent(xg,e)},n):this.clickCount===2&&this.pointDoubleClick&&(clearTimeout(this.singleClickTimer),this.clickCount=0,this.triggerPointEvent(qw,e)),this.axisLabelClick&&this.triggerAxisLabelClickEvent(Uw,e),this.notify("click",e),!1},t.prototype.triggerPointEvent=function(e,i){var r=i,n=new Md(this),s=n.getData();s.series&&s.point&&this.trigger(e,{series:this.isBlazor?{}:s.series,point:s.point,seriesIndex:s.series.index,pointIndex:s.point.index,x:this.mouseX,y:this.mouseY,pageX:r.pageX,pageY:r.pageY})},t.prototype.triggerAxisLabelClickEvent=function(e,i){var r=i.target,n=i;if(r.id.indexOf("_AxisLabel_")!==-1){var s=r.id.split("_AxisLabel_"),l=+s[0].slice(-1),h=+s[1],c=this.axisCollections[l];c.visible&&(l===0||l===1)&&this.trigger(e,{chart:this,axis:c,text:c.visibleLabels[h].text,labelID:r.id,index:h,location:new Rt(n.pageX,n.pageY),value:c.visibleLabels[h].value})}},t.prototype.chartOnMouseMove=function(e){var i=e.target;return this.trigger(Cg,{target:i.id,x:this.mouseX,y:this.mouseY}),this.pointMove&&this.triggerPointEvent(Eg,e),this.isTouch||(this.titleTooltip(e,this.mouseX,this.mouseY),this.axisTooltip(e,this.mouseX,this.mouseY)),this.dataEditingModule&&this.dataEditingModule.pointMouseMove(e),this.notify(a.AR.touchMoveEvent,e),this.isTouch=!1,!1},t.prototype.titleTooltip=function(e,i,r,n){var s=e.target.id,l=s===this.element.id+"_ChartTitle"||s===this.element.id+"_ChartSubTitle"||s.indexOf("_AxisTitle")>-1||s.indexOf("_legend_title")>-1,h=0;if(s.indexOf("_AxisTitle")>-1&&(h=parseInt(s.replace(this.element.id,"").replace("AxisLabel_","").split("_")[2],10)),l&&e.target.textContent.indexOf("...")>-1){var c=s===this.element.id+"_ChartTitle"?this.title:s.indexOf("_AxisTitle")>-1?this.axisCollections[h].title:s.indexOf("_ChartSubTitle")>-1?this.subTitle:this.legendSettings.title;to(c,i,r,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",xt(this.element.id+"_Secondary_Element"),n)}else ui(this.element.id+"_EJ2_Title_Tooltip")},t.prototype.axisTooltip=function(e,i,r,n){var s=e.target.id;if((s.indexOf("AxisLabel")>-1||s.indexOf("Axis_MultiLevelLabel")>-1)&&e.target.textContent.indexOf("...")>-1){var l=this.legendSettings.visible||this.primaryXAxis.title==="";to(this.findAxisLabel(s),i,r,this.element.offsetWidth,this.element.id+"_EJ2_AxisLabel_Tooltip",xt(this.element.id+"_Secondary_Element"),n,l)}else ui(this.element.id+"_EJ2_AxisLabel_Tooltip")},t.prototype.findAxisLabel=function(e){var i;return e.indexOf("AxisLabel")>-1?(i=e.replace(this.element.id,"").replace("AxisLabel_","").split("_"),this.axisCollections[parseInt(i[0],10)].visibleLabels[parseInt(i[1],10)].originalText):(i=e.replace(this.element.id,"").replace("Axis_MultiLevelLabel_Level_","").replace("Text_","").split("_"),this.axisCollections[parseInt(i[0],10)].multiLevelLabels[parseInt(i[1],10)].categories[parseInt(i[2],10)].text)},t.prototype.chartOnMouseDown=function(e){var i,r,n,s,l=a.AR.isDevice?20:30,h=this.element.getBoundingClientRect(),c=e.target;this.trigger(Tg,{target:c.id,x:this.mouseX,y:this.mouseY}),e.type==="touchstart"?(this.isTouch=!0,s=e,i=s.changedTouches[0].clientX,r=s.changedTouches[0].clientY,n=s.target):(this.isTouch=e.pointerType==="touch",i=e.clientX,r=e.clientY,n=e.target);var u=xt(this.svgId).getBoundingClientRect();return this.mouseDownX=this.previousMouseMoveX=i-h.left-Math.max(u.left-h.left,0),this.mouseDownY=this.previousMouseMoveY=r-h.top-Math.max(u.top-h.top,0),this.isTouch&&(this.isDoubleTap=new Date().getTime()<this.threshold&&n.id.indexOf(this.element.id+"_Zooming_")===-1&&(this.mouseDownX-l>=this.mouseX||this.mouseDownX+l>=this.mouseX)&&(this.mouseDownY-l>=this.mouseY||this.mouseDownY+l>=this.mouseY)&&(this.mouseX-l>=this.mouseDownX||this.mouseX+l>=this.mouseDownX)&&(this.mouseY-l>=this.mouseDownY||this.mouseY+l>=this.mouseDownY)),this.dataEditingModule&&this.dataEditingModule.pointMouseDown(),this.notify(a.AR.touchStartEvent,e),!1},t.prototype.mouseEnd=function(e){var i,r,n;return e.type==="touchend"?(n=e,r=n.changedTouches[0].clientX,this.isTouch=!0,i=n.changedTouches[0].clientY):(i=e.clientY,r=e.clientX,this.isTouch=e.pointerType==="touch"||e.pointerType==="2"),this.setMouseXY(r,i),this.chartOnMouseUp(e),!1},t.prototype.chartOnMouseUp=function(e){var i=e.target;return this.trigger(Lg,{target:i.id,x:this.mouseX,y:this.mouseY}),this.isChartDrag=!1,this.isTouch&&(this.titleTooltip(e,this.mouseX,this.mouseY,this.isTouch),this.axisTooltip(e,this.mouseX,this.mouseY,this.isTouch),this.threshold=new Date().getTime()+300),this.dataEditingModule&&this.dataEditingModule.pointMouseUp(),!this.enableCanvas&&this.seriesElements&&this.seriesElements.removeAttribute("clip-path"),this.notify(a.AR.touchEndEvent,e),!1},t.prototype.setCulture=function(){this.intl=new a.eC,this.setLocaleConstants(),this.localeObject=new a.E7(this.getModuleName(),this.defaultLocalConstants,this.locale)},t.prototype.setAnnotationValue=function(e,i){var r=xt(this.element.id+"_Annotation_Collections"),n=this.annotations[e],s;i!==null&&(n.content=i,r?(ui(this.element.id+"_Annotation_"+e),s=this.createElement("div"),this.annotationModule.processAnnotation(n,e,s),r.appendChild(s.children[0])):this.annotationModule.renderAnnotations(xt(this.element.id+"_Secondary_Element")))},t.prototype.setLocaleConstants=function(){this.defaultLocalConstants={ZoomIn:"Zoom in",Zoom:"Zoom",ZoomOut:"Zoom out",Pan:"Pan",Reset:"Reset",ResetZoom:"Reset Zoom"}},t.prototype.setTheme=function(){/*! Set theme */this.themeStyle=ag(this.theme)},t.prototype.requiredModules=function(){var e=this,i=[],r=this.series,n=!1,s,l=!1,h=!1,c=!1,u=this.zoomSettings;return this.chartAreaType=r.length>0&&(r[0].type==="Polar"||r[0].type==="Radar")?"PolarRadar":"Cartesian",this.tooltip.enable&&i.push({member:"Tooltip",args:[this]}),r.map(function(p){e.isLegend=e.legendSettings.visible&&(p.name!==""||!!e.isLegend),s=p.type.indexOf("100")!==-1?p.type.replace("100","")+"Series":p.type+"Series",l=p.errorBar.visible||l,c=p.marker.dataLabel.visible||c,h=p.dragSettings.enable||h,i.some(function(f){return f.member===s})||i.push({member:s,args:[e,r]}),e.chartAreaType==="PolarRadar"&&i.push({member:p.drawType+"Series",args:[e,r]}),p.type==="Pareto"&&(i.push({member:"ColumnSeries",args:[e,r]}),i.push({member:"LineSeries",args:[e,r]}))}),this.findIndicatorModules(i),this.findTrendLineModules(i),i=this.findAxisModule(i),n=this.annotations.some(function(p){return p.content!==null}),l&&i.push({member:"ErrorBar",args:[this,r]}),this.isLegend&&i.push({member:"Legend",args:[this]}),(this.enableExport||this.allowExport)&&i.push({member:"Export",args:[this]}),this.chartAreaType!=="PolarRadar"&&!this.scrollSettingEnabled&&(u.enableSelectionZooming||u.enableMouseWheelZooming||u.enablePinchZooming||u.enablePan||u.enableScrollbar)&&(i.push({member:"Zoom",args:[this,this.zoomSettings]}),u.enableScrollbar&&i.push({member:"ScrollBar",args:[this]})),this.selectionMode!=="None"&&!(this.chartAreaType==="PolarRadar"&&this.selectionMode.indexOf("Drag")>-1)&&i.push({member:"Selection",args:[this]}),this.highlightMode!=="None"&&i.push({member:"Highlight",args:[this]}),c&&i.push({member:"DataLabel",args:[this,r]}),h&&i.push({member:"DataEditing",args:[this]}),n&&i.push({member:"Annotation",args:[this]}),this.chartAreaType!=="PolarRadar"&&this.crosshair.enable&&i.push({member:"Crosshair",args:[this]}),i},t.prototype.findAxisModule=function(e){var i=[];i.push(this.primaryXAxis),i.push(this.primaryYAxis),i=i.concat(this.axes);for(var r=!1,n=!1,s=!1,l=!1,h=!1,c=!1,u=0,p=i;u<p.length;u++){var f=p[u];r=f.valueType==="DateTime"||r,n=f.valueType==="Category"||n,s=f.valueType==="Logarithmic"||s,h=f.valueType==="DateTimeCategory"||h,l=this.findStriplineVisibility(f.stripLines)||l,c=f.multiLevelLabels.length>0||c,this.scrollSettingEnabled=f.scrollbarSettings.enable?!0:this.scrollSettingEnabled}return r&&e.push({member:"DateTime",args:[this]}),n&&e.push({member:"Category",args:[this]}),s&&e.push({member:"Logarithmic",args:[this]}),l&&e.push({member:"StripLine",args:[this]}),c&&e.push({member:"MultiLevelLabel",args:[this]}),h&&e.push({member:"DateTimeCategory",args:[this]}),this.scrollSettingEnabled&&e.push({member:"ScrollBar",args:[this]}),e},t.prototype.findIndicatorModules=function(e){var i,r,n=this.indicators;if(this.indicators.length){e.push({member:"LineSeries",args:[this]}),n.map(function(c){i=i||c.type==="Macd",r=r||c.type==="BollingerBands"}),i&&e.push({member:"ColumnSeries",args:[this]}),r&&e.push({member:"RangeAreaSeries",args:[this]}),r&&e.push({member:"SplineRangeAreaSeries",args:[this]});for(var s=0,l=this.indicators;s<l.length;s++){var h=l[s];e.push({member:h.type+"Indicator",args:[this]})}}},t.prototype.findTrendLineModules=function(e){for(var i,r,n=function(u){var p;u.trendlines.map(function(f){p=p||f.marker.visible,i=!!(i||f.type==="Linear"||f.type==="MovingAverage"),r=!!(r||!i)}),p&&e.push({member:"Marker",args:[s,u]})},s=this,l=0,h=this.series;l<h.length;l++){var c=h[l];n(c)}(i||r)&&e.push({member:"TrendLine",args:[this]}),i&&e.push({member:"LineSeries",args:[this]}),r&&e.push({member:"SplineSeries",args:[this]})},t.prototype.findStriplineVisibility=function(e){for(var i=!1,r=0,n=e;r<n.length;r++){var s=n[r];if(s.visible){i=!0;break}}return i},t.prototype.removeSvg=function(){if(this.redraw)return null;if(Cc(this),this.enableCanvas&&this.svgObject&&this.svgObject.tagName==="CANVAS")return this.renderer.clearRect(new ft(0,0,this.availableSize.width,this.availableSize.height)),this.svgObject.parentNode&&(0,a.Od)(this.svgObject),null;ui(this.element.id+"_Secondary_Element"),this.isReact&&this.clearTemplate();var e=0;if(this.zoomModule&&this.zoomModule.pinchTarget&&(this.zoomModule.pinchTarget.id="",this.zoomModule.pinchTarget.setAttribute("opacity","0"),this.svgObject.appendChild(this.zoomModule.pinchTarget),e=1),!(0,a.le)(this.resizeTo)){if(this.resizeTo!==this.checkResize&&this.isBlazor&&this.element.childElementCount)for(var i=document.querySelectorAll(".e-chart"),r=0;r<i.length;r++)for(var n=i[r];n.firstChild;)(0,a.Od)(n.firstChild);this.checkResize=this.resizeTo}if(this.svgObject){for(;this.svgObject.childNodes.length>e;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&!this.stockChart&&(0,a.Od)(this.svgObject)}},t.prototype.refreshDefinition=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];n.axes=[]}},t.prototype.refreshAxis=function(){var e=this.primaryXAxis;e.rect=new ft(void 0,void 0,0,0),e=this.primaryYAxis,e.isStack100=!1,e.rect=new ft(void 0,void 0,0,0);for(var i=0,r=this.axes;i<r.length;i++){var n=r[i];e=n,e.rect=new ft(void 0,void 0,0,0),e.isStack100=!1}if(this.paretoSeriesModule&&this.series[0].type==="Pareto")for(var s=0,l=this.paretoSeriesModule.paretoAxes;s<l.length;s++){var n=l[s];e=n,e.rect=new ft(void 0,void 0,0,0),e.isStack100=!1}},t.prototype.axisChange=function(e){return!e.name&&!e.valueType?!1:(this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(),!0)},t.prototype.getVisibleSeries=function(e,i){for(var r=0,n=e;r<n.length;r++){var s=n[r];if(i===s.index)return s}return null},t.prototype.refreshLiveData=function(){this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(!1),this.isBlazor||(this.enableCanvas?this.createChartSvg():this.removeSvg(),this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}))},t.prototype.removeStyles=function(){ui(this.element.id+"_ej2_chart_selection"),ui(this.element.id+"_ej2_chart_highlight")},t.prototype.onPropertyChanged=function(e,i){var r=!1,n=!1;this.animateSeries=!1;var s;if(!this.delayRedraw){for(var l=0,h=Object.keys(e);l<h.length;l++){var c=h[l];switch(c){case"primaryXAxis":s=e.primaryXAxis,n=this.axisChange(s),e.primaryXAxis.edgeLabelPlacement&&(r=!0),e.primaryXAxis.crosshairTooltip||(n=!0),(!(0,a.le)(s.isInversed)||!(0,a.le)(s.opposedPosition))&&this.primaryXAxis.setIsInversedAndOpposedPosition();break;case"primaryYAxis":s=e.primaryYAxis,n=this.axisChange(s),e.primaryYAxis.edgeLabelPlacement&&(r=!0),e.primaryYAxis.crosshairTooltip||(n=!0),(!(0,a.le)(s.isInversed)||!(0,a.le)(s.opposedPosition))&&this.primaryYAxis.setIsInversedAndOpposedPosition();break;case"axes":for(var u=0,p=Object.keys(e.axes);u<p.length;u++){var f=p[u];s=e.axes[f],n=n||this.axisChange(s),s.crosshairTooltip||(n=!0),(!(0,a.le)(s.isInversed)||!(0,a.le)(s.opposedPosition))&&this.axes[f].setIsInversedAndOpposedPosition()}break;case"height":case"width":this.createChartSvg(),n=!0;break;case"subTitle":case"title":n=!0;break;case"titleStyle":e.titleStyle&&(e.titleStyle.size||e.titleStyle.textOverflow)?n=!0:r=!0;break;case"subTitleStyle":e.subTitleStyle&&(e.subTitleStyle.size||e.subTitleStyle.textOverflow)?n=!0:r=!0;break;case"border":r=!0;break;case"dataSource":this.processData(!1),n=!0;break;case"enableCanvas":this.refresh();break;case"series":for(var g=this.series.length,C=!1,L=void 0,D=void 0,R=0;R<g;R++)L=e.series[R],this.isBlazor&&L&&(L.visible!==i.series[R].visible||L.isClosed||L.marker||L.emptyPointSettings||L.type||L.boxPlotMode||L.showMean)&&(D=!0),L&&(L.dataSource||L.query||L.errorBar||L.xName||L.yName||L.size||L.high||L.low||L.open||L.close||L.fill||L.name||L.marker||D)&&((0,a.l7)(this.getVisibleSeries(this.visibleSeries,R),L,null,!0),C=!0);C&&(this.calculateVisibleSeries(),this.initTechnicalIndicators(),this.initTrendLines(),this.refreshDefinition(this.columns),this.refreshDefinition(this.rows),this.calculateVisibleAxis(),this.processData(!1),n=!0);break;case"indicators":n=!0;break;case"zoomSettings":(e.zoomSettings.enableScrollbar||i.zoomSettings.enableScrollbar)&&(n=!0),r=!0;break;case"background":r=!0;break;case"chartArea":e.chartArea.border&&e.chartArea.border.width&&(n=!0),r=!0;break;case"legendSettings":(!e.legendSettings.background||!e.legendSettings.opacity)&&(n=!0),r=!0;break;case"palettes":this.calculateVisibleSeries(),r=!0;break;case"selectedDataIndexes":this.selectionModule&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.selectedDataIndexes=this.selectedDataIndexes,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,i.selectionMode,!0));break;case"selectionMode":this.selectionModule&&e.selectionMode&&e.selectionMode.indexOf("Drag")===-1&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,i.selectionMode,!0));break;case"isMultiSelect":this.selectionModule&&!e.isMultiSelect&&this.selectionModule.selectedDataIndexes.length>1&&(this.selectionModule.currentMode=this.selectionMode,this.selectionModule.styleId=this.element.id+"_ej2_chart_selection",this.selectionModule.redrawSelection(this,i.selectionMode));break;case"highlightMode":case"selectionPattern":case"highlightPattern":this.removeStyles(),r=!0;break;case"theme":this.animateSeries=!0;break;case"locale":case"currencyCode":this.isBlazor?(this.setCulture(),r=!0):this.refresh();break;case"tooltip":this.tooltipModule&&(this.tooltipModule.previousPoints=[],this.tooltip.template&&(this.tooltipModule.template=this.tooltip.template));break}}!n&&r&&(this.rotatedDataLabelCollections=[],this.removeSvg(),this.renderElements(),this.trigger("loaded",{chart:this.isBlazor?{}:this})),n&&(this.enableCanvas?this.createChartSvg():this.removeSvg(),this.isReact&&this.clearTemplate(),this.refreshAxis(),this.refreshBound(),this.trigger("loaded",{chart:this.isBlazor?{}:this}),this.redraw=!1,this.animated=!1)}},$e([(0,a.Z9)(null)],t.prototype,"width",void 0),$e([(0,a.Z9)(null)],t.prototype,"height",void 0),$e([(0,a.Z9)("")],t.prototype,"title",void 0),$e([(0,a.Z9)("")],t.prototype,"dataSource",void 0),$e([(0,a.Zz)(Mr.chartTitleFont,Pr)],t.prototype,"titleStyle",void 0),$e([(0,a.Z9)("")],t.prototype,"subTitle",void 0),$e([(0,a.Zz)(Mr.chartSubTitleFont,Pr)],t.prototype,"subTitleStyle",void 0),$e([(0,a.Zz)({},sc)],t.prototype,"margin",void 0),$e([(0,a.Zz)({color:"#DDDDDD",width:0},xr)],t.prototype,"border",void 0),$e([(0,a.Z9)(null)],t.prototype,"background",void 0),$e([(0,a.Zz)({border:{color:null,width:.5},background:"transparent"},Lw)],t.prototype,"chartArea",void 0),$e([(0,a.Zz)({name:"primaryXAxis"},dc)],t.prototype,"primaryXAxis",void 0),$e([(0,a.Zz)({name:"primaryYAxis"},dc)],t.prototype,"primaryYAxis",void 0),$e([(0,a.FE)([{}],Qw)],t.prototype,"rows",void 0),$e([(0,a.FE)([{}],Jw)],t.prototype,"columns",void 0),$e([(0,a.FE)([{}],dc)],t.prototype,"axes",void 0),$e([(0,a.FE)([{}],Ki)],t.prototype,"series",void 0),$e([(0,a.FE)([{}],Zw)],t.prototype,"annotations",void 0),$e([(0,a.Z9)([])],t.prototype,"palettes",void 0),$e([(0,a.Z9)("Material")],t.prototype,"theme",void 0),$e([(0,a.Zz)({},hg)],t.prototype,"tooltip",void 0),$e([(0,a.Zz)({},n1)],t.prototype,"crosshair",void 0),$e([(0,a.Zz)({},i0)],t.prototype,"legendSettings",void 0),$e([(0,a.FE)([{}],r1)],t.prototype,"rangeColorSettings",void 0),$e([(0,a.Zz)({},s1)],t.prototype,"zoomSettings",void 0),$e([(0,a.Z9)("")],t.prototype,"highlightColor",void 0),$e([(0,a.Z9)("None")],t.prototype,"selectionMode",void 0),$e([(0,a.Z9)("None")],t.prototype,"highlightMode",void 0),$e([(0,a.Z9)("None")],t.prototype,"selectionPattern",void 0),$e([(0,a.Z9)("None")],t.prototype,"highlightPattern",void 0),$e([(0,a.Z9)(!1)],t.prototype,"isMultiSelect",void 0),$e([(0,a.Z9)(!1)],t.prototype,"allowMultiSelection",void 0),$e([(0,a.Z9)(!0)],t.prototype,"enableExport",void 0),$e([(0,a.Z9)(!1)],t.prototype,"allowExport",void 0),$e([(0,a.FE)([],og)],t.prototype,"selectedDataIndexes",void 0),$e([(0,a.Z9)(!1)],t.prototype,"useGroupingSeparator",void 0),$e([(0,a.Z9)(!1)],t.prototype,"enableAutoIntervalOnBothAxis",void 0),$e([(0,a.Z9)(!1)],t.prototype,"isTransposed",void 0),$e([(0,a.Z9)(!1)],t.prototype,"enableCanvas",void 0),$e([(0,a.Z9)(null)],t.prototype,"backgroundImage",void 0),$e([(0,a.FE)([],n0)],t.prototype,"indicators",void 0),$e([(0,a.Z9)(!0)],t.prototype,"enableAnimation",void 0),$e([(0,a.Z9)(null)],t.prototype,"description",void 0),$e([(0,a.Z9)(1)],t.prototype,"tabIndex",void 0),$e([(0,a.Z9)(!0)],t.prototype,"enableSideBySidePlacement",void 0),$e([(0,a.ju)()],t.prototype,"resized",void 0),$e([(0,a.ju)()],t.prototype,"beforeResize",void 0),$e([(0,a.ju)()],t.prototype,"annotationRender",void 0),$e([(0,a.ju)()],t.prototype,"beforePrint",void 0),$e([(0,a.ju)()],t.prototype,"loaded",void 0),$e([(0,a.ju)()],t.prototype,"beforeExport",void 0),$e([(0,a.ju)()],t.prototype,"afterExport",void 0),$e([(0,a.ju)()],t.prototype,"load",void 0),$e([(0,a.ju)()],t.prototype,"animationComplete",void 0),$e([(0,a.ju)()],t.prototype,"legendRender",void 0),$e([(0,a.ju)()],t.prototype,"textRender",void 0),$e([(0,a.ju)()],t.prototype,"pointRender",void 0),$e([(0,a.ju)()],t.prototype,"seriesRender",void 0),$e([(0,a.ju)()],t.prototype,"axisLabelRender",void 0),$e([(0,a.ju)()],t.prototype,"axisLabelClick",void 0),$e([(0,a.ju)()],t.prototype,"axisRangeCalculated",void 0),$e([(0,a.ju)()],t.prototype,"axisMultiLabelRender",void 0),$e([(0,a.ju)()],t.prototype,"legendClick",void 0),$e([(0,a.ju)()],t.prototype,"multiLevelLabelClick",void 0),$e([(0,a.ju)()],t.prototype,"tooltipRender",void 0),$e([(0,a.ju)()],t.prototype,"sharedTooltipRender",void 0),$e([(0,a.ju)()],t.prototype,"chartMouseMove",void 0),$e([(0,a.ju)()],t.prototype,"chartMouseClick",void 0),$e([(0,a.ju)()],t.prototype,"chartDoubleClick",void 0),$e([(0,a.ju)()],t.prototype,"pointClick",void 0),$e([(0,a.ju)()],t.prototype,"pointDoubleClick",void 0),$e([(0,a.ju)()],t.prototype,"pointMove",void 0),$e([(0,a.ju)()],t.prototype,"chartMouseLeave",void 0),$e([(0,a.ju)()],t.prototype,"chartMouseDown",void 0),$e([(0,a.ju)()],t.prototype,"chartMouseUp",void 0),$e([(0,a.ju)()],t.prototype,"dragComplete",void 0),$e([(0,a.ju)()],t.prototype,"selectionComplete",void 0),$e([(0,a.ju)()],t.prototype,"zoomComplete",void 0),$e([(0,a.ju)()],t.prototype,"onZooming",void 0),$e([(0,a.ju)()],t.prototype,"scrollStart",void 0),$e([(0,a.ju)()],t.prototype,"scrollEnd",void 0),$e([(0,a.ju)()],t.prototype,"scrollChanged",void 0),$e([(0,a.ju)()],t.prototype,"dragStart",void 0),$e([(0,a.ju)()],t.prototype,"drag",void 0),$e([(0,a.ju)()],t.prototype,"dragEnd",void 0),$e([(0,a.Z9)("USD")],t.prototype,"currencyCode",void 0),t=$e([a.Zl],t),t}(a.wA),Oc=function(){function o(){}return o.prototype.getSideBySideInfo=function(t){if(t.chart.enableSideBySidePlacement&&!t.position&&this.getSideBySidePositions(t),t.columnWidthInPixel)return new In(0,0);var e=t.type==="Histogram"||!t.chart.enableSideBySidePlacement?0:t.position,i=t.type==="Histogram"||!t.chart.enableSideBySidePlacement?1:t.rectCount;t.isRectSeries=!0;var r=t.chart.visibleSeries,n=t.chart.enableSideBySidePlacement?t.columnSpacing:0,s=t.columnWidth===null||isNaN(+t.columnWidth)?t.type==="Histogram"?1:.7:t.columnWidth,l=Hg(t.xAxis,r),h=l*s,c,u=e/i-.5,p=new In(u,u+1/i);if(!(isNaN(p.start)||isNaN(p.end))){if(t.groupName&&t.type.indexOf("Stacking")===-1){var f=.7;t.chart.series.filter(function(D){D.columnWidth>f&&(f=D.columnWidth)});var g=l*f,C=new In(p.start*g,p.end*g),L=(C.delta-(p.end*h-p.start*h))/2;p=new In(C.start+L,C.end-L)}else p=new In(p.start*h,p.end*h);c=n*p.delta,p=new In(p.start+c/2,p.end-c/2)}return p},o.prototype.getRectangle=function(t,e,i,r,n){var s=Ar(t,e,n.xAxis,n.yAxis,n.chart.requireInvertedAxis),l=Ar(i,r,n.xAxis,n.yAxis,n.chart.requireInvertedAxis);return new ft(Math.min(s.x,l.x),Math.min(s.y,l.y),Math.abs(l.x-s.x),Math.abs(l.y-s.y))},o.prototype.getSideBySidePositions=function(t){for(var e=t.chart,i=0,r=e.columns;i<r.length;i++)for(var n=r[i],s=0,l=e.rows;s<l.length;s++){var h=l[s];this.findRectPosition(t.findSeriesCollection(n,h,!1))}},o.prototype.findRectPosition=function(t){for(var e=[],i={rectCount:0,position:null},r=0;r<t.length;r++){var n=t[r];if(n.type.indexOf("Stacking")!==-1||n.groupName!==""){var s=n.type.indexOf("Stacking")!==-1?n.stackingGroup:n.type+n.groupName;s?e[s]===void 0?(n.position=i.rectCount,e[s]=i.rectCount++):n.position=e[s]:i.position===null?(n.position=i.rectCount,i.position=i.rectCount++):n.position=i.position}else n.position=i.rectCount++}for(var r=0;r<t.length;r++){var n=t[r];n.rectCount=i.rectCount}},o.prototype.updateSymbolLocation=function(t,e,i){i.chart.requireInvertedAxis?this.updateYRegion(t,e,i):this.updateXRegion(t,e,i),i.type==="Histogram"&&(t.minimum=+t.x-i.histogramValues.binWidth/2,t.maximum=+t.x+i.histogramValues.binWidth/2)},o.prototype.updateXRegion=function(t,e,i){t.symbolLocations.push({x:e.x+e.width/2,y:i.seriesType==="BoxPlot"||i.seriesType.indexOf("HighLow")!==-1||t.yValue>=0==!i.yAxis.isAxisInverse?e.y:e.y+e.height}),this.getRegion(t,e,i),i.type==="RangeColumn"&&t.symbolLocations.push({x:e.x+e.width/2,y:e.y+e.height})},o.prototype.updateYRegion=function(t,e,i){t.symbolLocations.push({x:i.seriesType==="BoxPlot"||i.seriesType.indexOf("HighLow")!==-1||t.yValue>=0==!i.yAxis.isAxisInverse?e.x+e.width:e.x,y:e.y+e.height/2}),this.getRegion(t,e,i),i.type==="RangeColumn"&&t.symbolLocations.push({x:e.x,y:e.y+e.height/2})},o.prototype.renderMarker=function(t){t.marker&&t.marker.visible&&t.chart.markerRender.render(t)},o.prototype.getRegion=function(t,e,i){if(t.y===0){var r=i.marker&&i.marker.width?i.marker.width:0,n=i.marker&&i.marker.height?i.marker.height:0;t.regions.push(new ft(t.symbolLocations[0].x-r,t.symbolLocations[0].y-n,2*r,2*n))}else t.regions.push(e)},o.prototype.triggerEvent=function(t,e,i,r){var n={cancel:!1,name:Ds,series:t,point:e,fill:t.setPointColor(e,i),border:t.setBorderColor(e,r)};return t.chart.trigger(Ds,n),e.color=n.fill,n},o.prototype.drawRectangle=function(t,e,i,r){var n=t.chart,s=n.requireInvertedAxis?i.height:i.width;if(s<=0)return null;var l;e.y===0?l=this.calculateRoundedRectPath(i,0,0,0,0):l=this.calculateRoundedRectPath(i,t.cornerRadius.topLeft,t.cornerRadius.topRight,t.cornerRadius.bottomLeft,t.cornerRadius.bottomRight);var h=t.category==="Indicator"?n.element.id+"_Indicator_"+t.index+"_"+t.name+"_Point_"+e.index:n.element.id+"_Series_"+t.index+"_Point_"+e.index,c=is(n.redraw,h),u=c?c.getAttribute("d"):"",p=new er(h,r.fill,r.border.width,r.border.color,t.opacity,t.dashArray,l),f=n.renderer.drawPath(p,new Int32Array([t.clipRect.x,t.clipRect.y]));switch(t.seriesType){case"XY":f.setAttribute("aria-label",e.x.toString()+":"+e.yValue.toString());break;case"HighLow":f.setAttribute("aria-label",e.x.toString()+":"+e.high.toString()+":"+e.low.toString());break}Nt(t.chart.enableCanvas,t.seriesElement,f,n.redraw),t.chart.enableCanvas||gc(f,l,n.redraw,u,n.duration)},o.prototype.animate=function(t){for(var e=t.seriesElement.childNodes,i=t.category==="Indicator"?0:1,r=ua(t),n=0,s=r;n<s.length;n++){var l=s[n];!l.symbolLocations.length&&!(t.type==="BoxAndWhisker"&&l.regions.length)||(this.animateRect(e[i],t,l),i++)}},o.prototype.animateRect=function(t,e,i){var r=e.animation,n=e.chart.animated?e.chart.duration:r.duration,s=Ad("Linear"),l=i.yValue<0,h,c,u=+i.regions[0].height,p=+i.regions[0].width,f,g;e.chart.requireInvertedAxis?(c=+i.regions[0].y,e.type.indexOf("Stacking")>-1?(h=Er(0,e.yAxis)*e.yAxis.rect.width,f=h,g=c):(h=+i.regions[0].x,g=l?c:c+u,f=e.seriesType.indexOf("HighLow")!==-1||e.type.indexOf("Waterfall")!==-1?h+p/2:l!==e.yAxis.isAxisInverse?h+p:h)):(h=+i.regions[0].x,e.type.indexOf("Stacking")>-1?(c=(1-Er(0,e.yAxis))*e.yAxis.rect.height,f=h,g=c):(c=+i.regions[0].y,g=e.seriesType.indexOf("HighLow")!==-1||e.type.indexOf("Waterfall")!==-1?c+u/2:l!==e.yAxis.isAxisInverse?c:c+u,f=l?h:h+p));var C;(0,a.le)(t)||(t.style.visibility="hidden",new a.fw({}).animate(t,{duration:n,delay:r.delay,progress:function(L){L.timeStamp>=L.delay&&(t.style.visibility="visible",e.chart.requireInvertedAxis?(p=p||1,C=s(L.timeStamp-L.delay,0,p,L.duration),t.setAttribute("transform","translate("+f+" "+g+") scale("+C/p+", 1) translate("+-f+" "+-g+")")):(u=u||1,C=s(L.timeStamp-L.delay,0,u,L.duration),t.setAttribute("transform","translate("+f+" "+g+") scale(1,"+C/u+") translate("+-f+" "+-g+")")))},end:function(){t.setAttribute("transform","translate(0,0)");var L=e.seriesElement;if((t===L.lastElementChild||i.index===e.points.length-1||e.type==="Waterfall"&&t===L.children[L.childElementCount-2])&&(e.chart.trigger("animationComplete",{series:e.chart.isBlazor?{}:e}),e.type==="Waterfall"))for(var D=L.childNodes,R=0;R<D.length;R++)D[R].id.indexOf("Connector")!==-1&&(D[R].style.visibility="visible",D[R].setAttribute("transform","translate(0,0)"))}}))},o.prototype.calculateRoundedRectPath=function(t,e,i,r,n){return"M "+t.x+" "+(e+t.y)+" Q "+t.x+" "+t.y+" "+(t.x+e)+" "+t.y+" L "+(t.x+t.width-i)+" "+t.y+" Q "+(t.x+t.width)+" "+t.y+" "+(t.x+t.width)+" "+(t.y+i)+" L "+(t.x+t.width)+" "+(t.y+t.height-n)+" Q "+(t.x+t.width)+" "+(t.y+t.height)+" "+(t.x+t.width-n)+" "+(t.y+t.height)+" L "+(t.x+r)+" "+(t.y+t.height)+" Q "+t.x+" "+(t.y+t.height)+" "+t.x+" "+(t.y+t.height-r)+" L "+t.x+" "+(e+t.y)+" Z"},o}(),a1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),o1=function(o){a1(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(e){for(var i,r=this.getSideBySideInfo(e),n=Math.max(e.yAxis.visibleRange.min,0),s,l=0,h=e.points;l<h.length;l++){var c=h[l];if(c.symbolLocations=[],c.regions=[],c.visible&&ts(e.points[c.index-1],c,e.points[c.index+1],e)){i=this.getRectangle(c.xValue+r.start,c.yValue,c.xValue+r.end,n,e),i.width=e.columnWidthInPixel?e.columnWidthInPixel:i.width,i.x=e.columnWidthInPixel?i.x-(e.columnWidthInPixel/2*e.rectCount-e.columnWidthInPixel*e.index):i.x;var u=e.category==="Indicator"?c.color:e.interior;s=this.triggerEvent(e,c,u,{width:e.border.width,color:e.border.color}),s.cancel||(this.updateSymbolLocation(c,i,e),this.drawRectangle(e,c,i,s))}}this.renderMarker(e)},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.getModuleName=function(){return"ColumnSeries"},t.prototype.destroy=function(){},t}(Oc),l1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),h1=function(o){l1(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(e){for(var i=Math.max(e.yAxis.visibleRange.min,0),r=this.getSideBySideInfo(e),n,s,l=0,h=e.points;l<h.length;l++){var c=h[l];c.symbolLocations=[],c.regions=[],c.visible&&ts(e.points[c.index-1],c,e.points[c.index+1],e)&&(n=this.getRectangle(c.xValue+r.start,c.yValue,c.xValue+r.end,i,e),n.height=e.columnWidthInPixel?e.columnWidthInPixel:n.height,n.y=e.columnWidthInPixel?n.y-(e.columnWidthInPixel/2*e.rectCount-e.columnWidthInPixel*e.index):n.y,s=this.triggerEvent(e,c,e.interior,{width:e.border.width,color:e.border.color}),s.cancel||(this.updateSymbolLocation(c,n,e),this.drawRectangle(e,c,n,s)))}this.renderMarker(e)},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"BarSeries"},t}(Oc),c1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),u1=function(o){c1(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(e){e.isRectSeries=!0;for(var i=this.getSideBySideInfo(e),r,n,s=e.stackedValues,l=ua(e),h=0,c=l;h<c.length;h++){var u=c[h];u.symbolLocations=[],u.regions=[],u.visible&&ts(l[u.index-1],u,l[u.index+1],e)&&(r=this.getRectangle(u.xValue+i.start,s.endValues[u.index],u.xValue+i.end,s.startValues[u.index],e),r.width=e.columnWidthInPixel?e.columnWidthInPixel:r.width,r.x=e.columnWidthInPixel?r.x-e.columnWidthInPixel/2:r.x,n=this.triggerEvent(e,u,e.interior,{width:e.border.width,color:e.border.color}),n.cancel||(this.drawRectangle(e,u,r,n),this.updateSymbolLocation(u,r,e)))}this.renderMarker(e)},t.prototype.doAnimation=function(e){this.animate(e)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingColumnSeries"},t}(Oc),p1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),d1=function(o){p1(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.calculateDateTimeNiceInterval=function(e,i,r,n,s){s===void 0&&(s=!0);var l=24*60*60*1e3,h=new Date(r),c=new Date(n),u=Math.abs((h.getTime()-c.getTime())/l),p;e.actualIntervalType=e.intervalType;var f=e.intervalType;switch(f){case"Years":p=this.calculateNumericNiceInterval(e,u/365,i);break;case"Quarter":p=this.calculateNumericNiceInterval(e,u/365*4,i);break;case"Months":p=this.calculateNumericNiceInterval(e,u/30,i);break;case"Weeks":p=this.calculateNumericNiceInterval(e,u/7,i);break;case"Days":p=this.calculateNumericNiceInterval(e,u,i);break;case"Hours":p=this.calculateNumericNiceInterval(e,u*24,i);break;case"Minutes":p=this.calculateNumericNiceInterval(e,u*24*60,i);break;case"Seconds":p=this.calculateNumericNiceInterval(e,u*24*60*60,i);break;case"Auto":return p=this.calculateNumericNiceInterval(e,u/365,i),p>=1?(e.actualIntervalType="Years",p):(p=this.calculateNumericNiceInterval(e,u/365*4,i),p>=1&&!s?(e.actualIntervalType="Quarter",p):(p=this.calculateNumericNiceInterval(e,u/30,i),p>=1?(e.actualIntervalType="Months",p):(p=this.calculateNumericNiceInterval(e,u/7,i),p>=1&&!s?(e.actualIntervalType="Weeks",p):(p=this.calculateNumericNiceInterval(e,u,i),p>=1?(e.actualIntervalType="Days",p):(p=this.calculateNumericNiceInterval(e,u*24,i),p>=1?(e.actualIntervalType="Hours",p):(p=this.calculateNumericNiceInterval(e,u*24*60,i),p>=1?(e.actualIntervalType="Minutes",p):(p=this.calculateNumericNiceInterval(e,u*24*60*60,i),e.actualIntervalType="Seconds",p)))))))}return p},t.prototype.getSkeleton=function(e,i,r,n){var s,l=e.actualIntervalType;return e.skeleton?e.skeleton:(l==="Years"?n?s=(e.isChart&&e.valueType==="DateTime","y"):s=e.isChart?e.valueType==="DateTime"&&e.isIntervalInDecimal?"y":"yMMM":"y":l==="Quarter"?s=n?"y":"yMMM":l==="Months"?n?s=(e.isChart,"m"):s=e.isChart?"MMMd":"MMM":l==="Weeks"?s=n?"m":"MEd":l==="Days"?n?s="d":s=e.isChart?this.getDayFormat(e,i,r):"MMMd":l==="Hours"?n?s="t":s=e.isChart?e.valueType==="DateTime"?"Hm":"EHm":"h":l==="Minutes"?n?s="T":s=e.isChart?"Hms":"hm":n?s="T":s=e.isChart?"Hms":"hms",s)},t.prototype.getMonthFormat=function(e,i,r){return new Date(i).getFullYear()===new Date(r).getFullYear()?e.isIntervalInDecimal?"MMM":"MMM d":"y MMM"},t.prototype.getDayFormat=function(e,i,r){return e.valueType==="DateTime"?new Date(i).getMonth()!==new Date(r).getMonth()?"MMMd":e.isIntervalInDecimal?"d":"Ehm":"yMd"},t.prototype.findCustomFormats=function(e,i,r){var n=e.labelFormat?e.labelFormat:"";return e.isChart&&!e.skeleton&&e.actualIntervalType==="Months"&&!n&&(n=e.valueType==="DateTime"?this.getMonthFormat(e,i,r):"yMMM"),n},t}(vg),f1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),v1=function(o){f1(t,o);function t(e){return o.call(this,e)||this}return t.prototype.calculateRangeAndInterval=function(e,i){this.calculateRange(i),this.getActualRange(i,e),this.applyRangePadding(i,e),this.calculateVisibleLabels(i)},t.prototype.getActualRange=function(e,i){this.initializeDoubleRange(e),e.actualRange={},e.interval?e.actualRange.interval=Math.ceil(e.interval):e.actualRange.interval=Math.max(1,Math.floor(e.doubleRange.delta/Vg(i,e))),e.actualRange.min=e.doubleRange.start,e.actualRange.max=e.doubleRange.end,e.actualRange.delta=e.doubleRange.delta},t.prototype.applyRangePadding=function(e,i){var r=e.labelPlacement==="BetweenTicks"&&this.chart.chartAreaType!=="PolarRadar"?.5:0;r>0?(e.actualRange.min-=r,e.actualRange.max+=r):e.actualRange.max+=e.actualRange.max?0:.5,e.doubleRange=new In(e.actualRange.min,e.actualRange.max),e.actualRange.delta=e.doubleRange.delta,this.calculateVisibleRange(i,e)},t.prototype.calculateVisibleLabels=function(e){/*! Generate axis labels */e.visibleLabels=[];var i=Math.ceil(e.visibleRange.min),r;(e.zoomFactor<1||e.zoomPosition>0)&&(i=e.visibleRange.min-e.visibleRange.min%e.visibleRange.interval);var n;for(e.startLabel=e.labels[Math.round(e.visibleRange.min)],e.endLabel=e.labels[Math.floor(e.visibleRange.max)];i<=e.visibleRange.max;i+=e.visibleRange.interval)r=(0,a.l7)({},(0,a.NA)("properties",e.labelStyle),null,!0),pa(i,e.visibleRange)&&e.labels.length>0&&(n=Math.round(i),Td(this.chart,n,e.labels[n]?e.labels[n].toString():n.toString(),r,e));e.getMaxLabelWidth&&e.getMaxLabelWidth(this.chart)},t.prototype.getModuleName=function(){return"Category"},t.prototype.destroy=function(){},t}(d1),Rc=function(){function o(t){this.chart=t}return o.prototype.enableComplexProperty=function(t){for(var e=[],i=[],r=t.xAxis.visibleRange,n=t.yAxis.visibleRange,s=t.points,l=t.clipRect,h=Math.abs(r.delta/l.width),c=Math.abs(n.delta/l.height),u=s[0]&&s[0].x>h?0:h,p=s[0]&&s[0].y>c?0:c,f=0,g=0,C=0,L=s;C<L.length;C++){var D=L[C];D.symbolLocations=[],f=D.xValue?D.xValue:r.min,g=D.yValue?D.yValue:n.min,(Math.abs(u-f)>=h||Math.abs(p-g)>=c)&&(e.push(D),u=f,p=g)}for(var R,B=0;B<e.length;B++)R=e[B],!((0,a.le)(R.x)||R.x===""||t.category==="Indicator"&&(isNaN(R.xValue)||isNaN(R.yValue)))&&i.push(R);return i},o.prototype.getLineDirection=function(t,e,i,r,n,s){var l="";if(t!=null){var h=n(t.xValue,t.yValue,i.xAxis,i.yAxis,r,i),c=n(e.xValue,e.yValue,i.xAxis,i.yAxis,r,i);l=s+" "+h.x+" "+h.y+" L "+c.x+" "+c.y+" "}return l},o.prototype.appendLinePath=function(t,e,i){var r=xt(t.id),n=e.chart,s=r?r.getAttribute("d"):null,l=e.chart.renderer.drawPath(t,new Int32Array([e.clipRect.x,e.clipRect.y]));l&&l.setAttribute("clip-path",i),e.pathElement=l,e.chart.enableCanvas||e.seriesElement.appendChild(l),e.isRectSeries=!1,gc(r,t.d,e.chart.redraw,s,n.duration)},o.prototype.renderMarker=function(t){t.marker&&t.marker.visible&&t.chart.markerRender.render(t)},o.prototype.doProgressiveAnimation=function(t,e){var i=new a.fw({}),r=t.pathElement,n=r.getAttribute("stroke-dasharray"),s=t.pathElement.getTotalLength(),l;r.style.visibility="hidden",i.animate(r,{duration:e.duration,delay:e.delay,progress:function(h){h.timeStamp>=h.delay&&(r.style.visibility="visible",l=Math.abs(Math.round((h.timeStamp-h.delay)*s/h.duration)),r.setAttribute("stroke-dasharray",l+","+s))},end:function(){r.setAttribute("stroke-dasharray",n),t.chart.trigger("animationComplete",{series:t.chart.isBlazor?{}:t})}})},o.prototype.storePointLocation=function(t,e,i,r){var n=e.marker&&e.marker.width?e.marker.width:0,s=e.marker&&e.marker.height?e.marker.height:0;t.symbolLocations.push(r(t.xValue,t.yValue,e.xAxis,e.yAxis,i,e)),t.regions.push(new ft(t.symbolLocations[0].x-n,t.symbolLocations[0].y-s,2*n,2*s))},o.prototype.withinYRange=function(t,e){return t.yValue>=e.visibleRange.min&&t.yValue<=e.visibleRange.max},o.prototype.getFirstLastVisiblePoint=function(t){for(var e=null,i=null,r=0,n=t;r<n.length;r++){var s=n[r];e===null&&s.visible&&(e=i=s),i=s.visible?s:i}return{first:e||t[0],last:i||t[t.length-1]}},o.prototype.doLinearAnimation=function(t,e){var i=t.clipRectElement.childNodes[0].childNodes[0],r=t.chart.animated?t.chart.duration:e.duration,n=Ad("Linear"),s=+i.getAttribute("height"),l=+i.getAttribute("width"),h=+i.getAttribute("x"),c=t.chart.requireInvertedAxis?+i.getAttribute("height")+ +i.getAttribute("y"):+i.getAttribute("y"),u;i.style.visibility="hidden",new a.fw({}).animate(i,{duration:r,delay:e.delay,progress:function(p){p.timeStamp>=p.delay&&(i.style.visibility="visible",t.chart.requireInvertedAxis?(u=n(p.timeStamp-p.delay,0,s,p.duration),i.setAttribute("transform","translate("+h+" "+c+") scale(1,"+u/s+") translate("+-h+" "+-c+")")):(u=n(p.timeStamp-p.delay,0,l,p.duration),i.setAttribute("transform","translate("+h+" "+c+") scale("+u/l+", 1) translate("+-h+" "+-c+")")))},end:function(){i.setAttribute("transform","translate(0,0)"),t.chart.trigger("animationComplete",{series:t.chart.isBlazor?{}:t})}})},o}(),m1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),g1=function(o){m1(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.getAreaPathDirection=function(e,i,r,n,s,l,h){var c="",u;return l===null&&(u=s(e,i,r.xAxis,r.yAxis,n,r),c+=h+" "+u.x+" "+u.y+" "),c},t.prototype.getAreaEmptyDirection=function(e,i,r,n,s){var l="";return l+=this.getAreaPathDirection(e.x,e.y,r,n,s,null,"L"),l+=this.getAreaPathDirection(i.x,i.y,r,n,s,null,"L"),l},t.prototype.setPointColor=function(e,i,r,n,s){if(r.pointColorMapping===""){for(var l=void 0,h=void 0,c=0;c<s.length;c++)if(l=s[c],h=n?e.xValue:e.yValue,h<=this.getAxisValue(l.value,n?r.xAxis:r.yAxis,r.chart)||!l.value&&l.value!==0){e.interior=l.color;break}return e.interior==null&&(e.interior=r.interior),!1}else return i?r.setPointColor(e,r.interior)!==r.setPointColor(i,r.interior):!1},t.prototype.sortSegments=function(e,i){var r=this,n=e.segmentAxis==="X"?e.xAxis:e.yAxis,s=[].concat(i);return s.sort(function(l,h){return r.getAxisValue(l.value,n,e.chart)-r.getAxisValue(h.value,n,e.chart)})},t.prototype.applySegmentAxis=function(e,i,r){var n=this;if(e.pointColorMapping!=="")return i.map(function(R){n.appendLinePath(R,e,"")}),null;var s=e.segmentAxis==="X",l=s?e.xAxis:e.yAxis,h=e.chart,c;this.includeSegment(r,l,e,r.length);for(var u=r.length,p,f,g,C=function(R){c=r[R],p=L.getAxisValue(c.value,l,e.chart),f=L.createClipRect(R?L.getAxisValue(r[R-1].value,l,e.chart):l.visibleRange.min,p,e,R,s),f&&i.map(function(B){g={"clip-path":f,"stroke-dasharray":c.dashArray,opacity:B.opacity,stroke:e.type.indexOf("Line")>-1?c.color||e.interior:e.border.color,"stroke-width":B["stroke-width"],fill:e.type.indexOf("Line")>-1?"none":c.color||e.interior,id:B.id+"_Segment_"+R,d:B.d},gc(xt(g.id),g.d,h.redraw),e.seriesElement.appendChild(h.renderer.drawPath(g))})},L=this,D=0;D<u;D++)C(D)},t.prototype.includeSegment=function(e,i,r,n){if(n<=0)return e.push({value:i.visibleRange.max,color:r.interior}),null;this.getAxisValue(e[n-1].value,i,r.chart)<i.visibleRange.max&&e.push({value:i.visibleRange.max,color:r.interior})},t.prototype.createClipRect=function(e,i,r,n,s){var l=r.chart.requireInvertedAxis,h=Ar(s?e:r.xAxis.visibleRange.min,s?r.yAxis.visibleRange.max:i,r.xAxis,r.yAxis,l),c=Ar(s?i:r.xAxis.visibleRange.max,s?r.yAxis.visibleRange.min:e,r.xAxis,r.yAxis,l);c=l?[h,h=c][0]:c;var u;return c.x-h.x>0&&c.y-h.y>0?(u=new Sn(r.chart.element.id+"_ChartSegment"+r.index+"ClipRect_"+n,"transparent",{width:1,color:"Gray"},1,{x:h.x,y:h.y,width:c.x-h.x,height:c.y-h.y}),r.seriesElement.appendChild(da(r.chart.redraw,u,r.chart.renderer)),"url(#"+r.chart.element.id+"_ChartSegment"+r.index+"ClipRect_"+n+")"):null},t.prototype.getAxisValue=function(e,i,r){if(e===null&&(e=i.visibleRange.max),i.valueType==="DateTime"){var n={skeleton:"full",type:"dateTime"};return Date.parse(r.intl.getDateParser(n)(r.intl.getDateFormat(n)(new Date(vn.j.parse.parseJson({val:e}).val))))}else if(i.valueType.indexOf("Category")>-1){var s=i.valueType==="DateTimeCategory"?e.getTime().toString():e;return i.labels.indexOf(s)<0?+e:i.labels.indexOf(s)}else return+e},t}(Rc),y1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),b1=function(o){y1(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(e,i,r,n){var s=null,l="",h=e.chart&&e.chart.chartAreaType==="PolarRadar",c=Math.max(e.yAxis.visibleRange.min,0);if(h){var u=this.getFirstLastVisiblePoint(e.points);c=u.first.yValue}for(var p,f=e.emptyPointSettings&&e.emptyPointSettings.mode==="Drop",g=e.border?e.border.width:0,C=e.border?e.border.color:"transparent",L=e.chart.chartAreaType==="PolarRadar"?dl:Ar,D=this.enableComplexProperty(e),R,B=0;B<D.length;B++)R=D[B],p=R.xValue,R.symbolLocations=[],R.regions=[],R.visible&&ts(D[B-1],R,D[B+1],e)&&(l+=this.getAreaPathDirection(p,c,e,n,L,s,"M"),s=s||new Rt(p,c),l+=this.getAreaPathDirection(p,R.yValue,e,n,L,null,"L"),D[B+1]&&!D[B+1].visible&&(!h||h&&this.withinYRange(D[B+1],r))&&!f&&(l+=this.getAreaEmptyDirection({x:p,y:c},s,e,n,L),s=null),this.storePointLocation(R,e,n,L));if(h&&l!==""){var H="",j=this.chart;H+=this.getAreaPathDirection(0,c,e,n,L,null,"L"),(i.isAxisInverse||r.isAxisInverse)&&(l+=e.type==="Polar"?j.polarSeriesModule.getPolarIsInversedPath(i,H):j.radarSeriesModule.getRadarIsInversedPath(i,H)),l=l.concat(l+" Z")}this.appendLinePath(new er(e.chart.element.id+"_Series_"+e.index,e.interior,g,C,e.opacity,e.dashArray,e.points.length>1&&l!==""?l+this.getAreaPathDirection(e.points[e.points.length-1].xValue,e.chart.chartAreaType==="PolarRadar"?e.points[e.points.length-1].yValue:c,e,n,L,null,"L"):""),e,""),this.renderMarker(e)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"AreaSeries"},t.prototype.doAnimation=function(e){var i=e.animation;this.doLinearAnimation(e,i)},t}(g1),C1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),S1=function(o){C1(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(e,i,r,n){var s=e.chart.chartAreaType==="PolarRadar",l=s?dl:Ar,h="",c=this.enableComplexProperty(e),u=c.length,p=e.stackedValues,f,g,C=s?Math.max(e.yAxis.visibleRange.min,p.endValues[0]):Math.max(e.yAxis.visibleRange.min,p.startValues[0]),L=0,D,R;u>0&&(D=l(c[0].xValue,C,i,r,n,e),h=h.concat("M "+D.x+" "+D.y+" "));for(var B=e.chart&&e.chart.chartAreaType==="PolarRadar",H=0;H<u;H++)if(f=c[H].index,c[H].symbolLocations=[],c[H].regions=[],c[H].visible&&ts(c[H-1],c[H],c[H+1],e))D=l(c[H].xValue,p.endValues[f],i,r,n,e),h=h.concat("L "+D.x+" "+D.y+" "),c[H].symbolLocations.push(l(c[H].xValue,p.endValues[f],i,r,n,e)),c[H].regions.push(new ft(c[H].symbolLocations[0].x-e.marker.width,c[H].symbolLocations[0].y-e.marker.height,2*e.marker.width,2*e.marker.height));else if(!B&&e.emptyPointSettings.mode!=="Drop"){for(var j=H-1;j>=L;j--)f=c[j].index,R=l(c[j].xValue,p.startValues[f],i,r,n,e),h=h.concat("L "+R.x+" "+R.y+" ");c[H+1]&&c[H+1].visible&&(!B||B&&this.withinYRange(c[H+1],r))&&(g=c[H+1].index,D=l(c[H+1].xValue,p.startValues[g],i,r,n,e),h=h.concat("M "+D.x+" "+D.y+" ")),L=H+1}if(e.chart.chartAreaType==="PolarRadar"&&c.length>1){var W=this.getFirstLastVisiblePoint(e.points),ne=this.chart;D={x:W.first.xValue,y:p.endValues[W.first.index]},R=l(D.x,D.y,i,r,n,e),h+="L "+R.x+" "+R.y+" ",this.chart.visible===1&&(i.isAxisInverse||r.isAxisInverse)&&(this.chart.enableAnimation=!1,h=e.type==="Polar"?ne.polarSeriesModule.getPolarIsInversedPath(i,h):ne.radarSeriesModule.getRadarIsInversedPath(i,h))}if(!B||B&&e.index!==this.getFirstSeriesIndex(e.chart.visibleSeries)){for(var j=u-1;j>=L;j--)if(f=c[j].index,!(B&&!c[j].visible)){var ie=this.getPreviousSeries(e);(ie.emptyPointSettings.mode!=="Drop"||!ie.points[j].isEmpty)&&(R=l(c[j].xValue,p.startValues[f],i,r,n,e),p.startValues[f]===p.endValues[f]&&(R.y=Math.floor(R.y)),h=h.concat((j===u-1&&s?"M":"L")+" "+R.x+" "+R.y+" "))}}var me=new er(e.chart.element.id+"_Series_"+e.index,e.interior,e.border.width,e.border.color,e.opacity,e.dashArray,h);this.appendLinePath(me,e,""),this.renderMarker(e)},t.prototype.doAnimation=function(e){var i=e.animation;this.doLinearAnimation(e,i)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingAreaSeries"},t.prototype.getPreviousSeries=function(e){for(var i=e.chart.visibleSeries,r=0,n=i.length;r<n;r++)if(e.index===i[r].index&&r!==0)return i[r-1];return i[0]},t.prototype.getFirstSeriesIndex=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(n.visible)return n.index}return 0},t}(Rc),Mc=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),wt=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},w1=function(o){Mc(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return wt([(0,a.Z9)(null)],t.prototype,"content",void 0),wt([(0,a.Z9)("0")],t.prototype,"x",void 0),wt([(0,a.Z9)("0")],t.prototype,"y",void 0),wt([(0,a.Z9)("Pixel")],t.prototype,"coordinateUnits",void 0),wt([(0,a.Z9)("Chart")],t.prototype,"region",void 0),wt([(0,a.Z9)("Middle")],t.prototype,"verticalAlignment",void 0),wt([(0,a.Z9)("Center")],t.prototype,"horizontalAlignment",void 0),wt([(0,a.Z9)(null)],t.prototype,"description",void 0),t}(a.rt),x1=function(o){Mc(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return wt([(0,a.Z9)(!1)],t.prototype,"visible",void 0),wt([(0,a.Z9)(!0)],t.prototype,"showZero",void 0),wt([(0,a.Z9)(null)],t.prototype,"name",void 0),wt([(0,a.Z9)("transparent")],t.prototype,"fill",void 0),wt([(0,a.Z9)("Inside")],t.prototype,"position",void 0),wt([(0,a.Z9)(5)],t.prototype,"rx",void 0),wt([(0,a.Z9)(5)],t.prototype,"ry",void 0),wt([(0,a.Z9)(0)],t.prototype,"angle",void 0),wt([(0,a.Z9)(!1)],t.prototype,"enableRotation",void 0),wt([(0,a.Zz)({width:null,color:null},xr)],t.prototype,"border",void 0),wt([(0,a.Zz)({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},Pr)],t.prototype,"font",void 0),wt([(0,a.Zz)({},Ja)],t.prototype,"connectorStyle",void 0),wt([(0,a.Z9)(null)],t.prototype,"template",void 0),t}(a.rt),E1=function(o){Mc(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return wt([(0,a.Z9)("50%")],t.prototype,"x",void 0),wt([(0,a.Z9)("50%")],t.prototype,"y",void 0),t}(a.rt),F0=function(){function o(){this.visible=!0,this.symbolLocation=null,this.region=null,this.labelRegion=null,this.labelVisible=!0,this.regions=null,this.isExplode=!1,this.isClubbed=!1,this.isSliced=!1,this.argsData=null,this.isLabelUpdated=null,this.initialLabelRegion=null}return o}(),A1=function(o){Mc(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.points=[],e.clubbedPoints=[],e.sumOfPoints=0,e.isRectSeries=!0,e.clipRect=new ft(0,0,0,0),e.category="Series",e.rightSidePoints=[],e.leftSidePoints=[],e}return t.prototype.refreshDataManager=function(e,i){var r=this,n=this.dataSource||e.dataSource;if(!(n instanceof Oe.h)&&(0,a.le)(this.query)){this.dataManagerSuccess({result:n,count:n.length},e,i);return}var s=this.dataModule.getData(this.dataModule.generateQuery().requiresCount());s.then(function(l){return r.dataManagerSuccess(l,e)})},t.prototype.dataManagerSuccess=function(e,i,r){r===void 0&&(r=!0);var n={name:hc,series:this,data:e.result};i.allowServerDataBinding=!1,i.trigger(hc,n),this.resultData=e.result!==""?e.result:[],!i.isBlazor&&!r&&this.getPoints(this.resultData,i),(++i.seriesCounts===i.visibleSeries.length&&r||window.Blazor&&!r&&i.seriesCounts===1)&&(this.getPoints(this.resultData,i),i.refreshChart())},t.prototype.getPoints=function(e,i){var r=Object.keys(e).length;if(this.sumOfPoints=0,r===0)return this.points=[],null;this.findSumOfPoints(e),this.points=[],this.clubbedPoints=[],this.sumOfClub=0;for(var n,s=this.palettes.length?this.palettes:sg(i.theme),l=yi(this.groupTo,this.sumOfPoints),h=0;h<r;h++){n=this.setPoints(e,h,s,i);var c=n.y;this.isClub(n,l,h)?(n.index=this.clubbedPoints.length,n.isExplode=!0,this.clubbedPoints.push(n),n.isSliced=!0):((0,a.le)(n.y)&&(n.visible=!1),this.pushPoints(n,s))}if(this.lastGroupTo=this.groupTo,this.sumOfClub>0){var u=this.generateClubPoint();this.pushPoints(u,s);var p=this.points.length-1;this.clubbedPoints.map(function(f){f.index+=p,f.color=u.color})}this.clubbedPoints.length&&this.explode&&this.type==="Pie"&&(this.explodeAll||this.points[this.points.length-1].index===this.explodeIndex)&&(this.points.splice(this.points.length-1,1),this.points=this.points.concat(this.clubbedPoints))},t.prototype.generateClubPoint=function(){var e=new F0;return e.isClubbed=!0,e.x="Others",e.y=this.sumOfClub,e.text=e.originalText=e.x+": "+this.sumOfClub,e.sliceRadius="80%",e},t.prototype.pushPoints=function(e,i){e.index=this.points.length,e.isExplode=this.explodeAll||e.index===this.explodeIndex,e.color=e.color||i[e.index%i.length],this.points.push(e)},t.prototype.isClub=function(e,i,r){if(!(0,a.le)(i)){if(this.groupMode==="Value"&&Math.abs(e.y)<=i)return this.sumOfClub+=Math.abs(e.y),!0;if(this.groupMode==="Point"&&r>=i)return this.sumOfClub+=Math.abs(e.y),!0}return!1},t.prototype.findSumOfPoints=function(e){for(var i=Object.keys(e).length,r=0;r<i;r++)!(0,a.le)(e[r])&&!(0,a.le)(e[r][this.yName])&&!isNaN(e[r][this.yName])&&(this.sumOfPoints+=Math.abs(e[r][this.yName]))},t.prototype.setPoints=function(e,i,r,n){var s=new F0;return s.x=(0,a.NA)(this.xName,e[i]),s.y=(0,a.NA)(this.yName,e[i]),s.percentage=+(s.y/this.sumOfPoints*100).toFixed(2),s.legendImageUrl=(0,a.NA)(this.legendImageUrl,e[i]),s.color=(0,a.NA)(this.pointColorMapping,e[i]),s.text=s.originalText=(0,a.NA)(this.dataLabel.name||"",e[i]),s.tooltip=(0,a.NA)(this.tooltipMappingName||"",e[i]),s.sliceRadius=(0,a.NA)(this.radius,e[i]),s.sliceRadius=(0,a.le)(s.sliceRadius)?"80%":s.sliceRadius,s.separatorY=n.intl.formatNumber(s.y,{useGrouping:n.useGroupingSeparator}),this.setAccEmptyPoint(s,i,e,r),s},t.prototype.renderSeries=function(e,i){var r=i?xt(e.element.id+"_Series_"+this.index):e.renderer.createGroup({id:e.element.id+"_Series_"+this.index});this.renderPoints(e,r,i);var n;e.accumulationDataLabelModule&&this.dataLabel.visible&&(n=e.renderer.createGroup({id:e.element.id+"_datalabel_Series_"+this.index}),n.style.visibility=this.animation.enable&&e.animateSeries&&this.type==="Pie"?"hidden":"visible",this.renderDataLabel(e,n,i)),this.type==="Pie"&&(this.findMaxBounds(this.labelBound,this.accumulationBound),e.pieSeriesModule.animateSeries(e,this.animation,this,r)),e.accumulationLegendModule&&(this.labelBound.x-=e.explodeDistance,this.labelBound.y-=e.explodeDistance,this.labelBound.height+=e.explodeDistance-this.labelBound.y,this.labelBound.width+=e.explodeDistance-this.labelBound.x)},t.prototype.renderPoints=function(e,i,r){for(var n=e.element.id+"_Series_"+this.index+"_Point_",s,l=0,h=this.points;l<h.length;l++){var c=h[l],u={cancel:!1,name:Ds,series:this,point:c,fill:c.color,border:this.isEmpty(c)?{width:this.emptyPointSettings.border.width,color:this.emptyPointSettings.border.color}:{width:this.border.width,color:this.border.color}};e.trigger(Ds,u),c.color=u.fill,s=new er(n+c.index,c.color,u.border.width||1,u.border.color||c.color,this.opacity,"",""),e[On(this.type)+"SeriesModule"].renderPoint(c,this,e,s,i,r)}Nt(!1,e.getSeriesElement(),i,r)},t.prototype.renderDataLabel=function(e,i,r){e.accumulationDataLabelModule.findAreaRect();var n=(0,a.az)("div",{id:e.element.id+"_Series_0_DataLabelCollections"});this.leftSidePoints=[],this.rightSidePoints=[];for(var s=[],l=[],h=0,c=this.points;h<c.length;h++){var u=c[h];u.visible&&(this.dataLabel.showZero||!this.dataLabel.showZero&&(u.y!==0||u.y===0&&this.emptyPointSettings.mode==="Zero"))&&e.accumulationDataLabelModule.renderDataLabel(u,this.dataLabel,i,this.points,this.index,n,r),u.midAngle>=90&&u.midAngle<=270?this.leftSidePoints.push(u):u.midAngle>=0&&u.midAngle<=90?l.push(u):s.push(u)}if(s.sort(function(f,g){return f.midAngle-g.midAngle}),l.sort(function(f,g){return f.midAngle-g.midAngle}),this.leftSidePoints.sort(function(f,g){return f.midAngle-g.midAngle}),this.rightSidePoints=s.concat(l),e.accumulationDataLabelModule.drawDataLabels(this,this.dataLabel,i,n,r),this.dataLabel.template!==null&&n.childElementCount){var p=e.accumulationDataLabelModule.drawDataLabels.bind(e.accumulationDataLabelModule,this,this.dataLabel,i,n,r);e.isReact&&e.renderReactTemplates(p),Nt(!1,xt(e.element.id+"_Secondary_Element"),n,r)}Nt(!1,e.getSeriesElement(),i,r)},t.prototype.findMaxBounds=function(e,i){e.x=i.x<e.x?i.x:e.x,e.y=i.y<e.y?i.y:e.y,e.height=i.y+i.height>e.height?i.y+i.height:e.height,e.width=i.x+i.width>e.width?i.x+i.width:e.width},t.prototype.setAccEmptyPoint=function(e,i,r,n){if(!((0,a.le)(e.y)||isNaN(e.y)))return null;switch(e.color=this.emptyPointSettings.fill||e.color,this.emptyPointSettings.mode){case"Zero":e.y=0,e.visible=!0;break;case"Average":var s=r[i-1]&&r[i-1][this.yName]||0,l=r[i+1]&&r[i+1][this.yName]||0;e.y=(Math.abs(s)+Math.abs(l))/2,this.sumOfPoints+=e.y,e.visible=!0;break;default:e.visible=!1;break}},t.prototype.isEmpty=function(e){return e.color===this.emptyPointSettings.fill},wt([(0,a.Z9)("")],t.prototype,"dataSource",void 0),wt([(0,a.Z9)()],t.prototype,"query",void 0),wt([(0,a.Z9)("")],t.prototype,"xName",void 0),wt([(0,a.Z9)("")],t.prototype,"name",void 0),wt([(0,a.Z9)("")],t.prototype,"tooltipMappingName",void 0),wt([(0,a.Z9)("")],t.prototype,"yName",void 0),wt([(0,a.Z9)(!0)],t.prototype,"visible",void 0),wt([(0,a.Zz)({color:null,width:0},xr)],t.prototype,"border",void 0),wt([(0,a.Zz)(null,Ed)],t.prototype,"animation",void 0),wt([(0,a.Z9)("SeriesType")],t.prototype,"legendShape",void 0),wt([(0,a.Z9)("")],t.prototype,"legendImageUrl",void 0),wt([(0,a.Z9)("")],t.prototype,"pointColorMapping",void 0),wt([(0,a.Z9)(null)],t.prototype,"selectionStyle",void 0),wt([(0,a.Z9)(null)],t.prototype,"groupTo",void 0),wt([(0,a.Z9)("Value")],t.prototype,"groupMode",void 0),wt([(0,a.Zz)({},x1)],t.prototype,"dataLabel",void 0),wt([(0,a.Z9)([])],t.prototype,"palettes",void 0),wt([(0,a.Z9)(0)],t.prototype,"startAngle",void 0),wt([(0,a.Z9)(null)],t.prototype,"endAngle",void 0),wt([(0,a.Z9)("80%")],t.prototype,"radius",void 0),wt([(0,a.Z9)("0")],t.prototype,"innerRadius",void 0),wt([(0,a.Z9)("Pie")],t.prototype,"type",void 0),wt([(0,a.Z9)(!0)],t.prototype,"enableTooltip",void 0),wt([(0,a.Z9)(!1)],t.prototype,"explode",void 0),wt([(0,a.Z9)("30%")],t.prototype,"explodeOffset",void 0),wt([(0,a.Z9)(!1)],t.prototype,"explodeAll",void 0),wt([(0,a.Z9)(null)],t.prototype,"explodeIndex",void 0),wt([(0,a.Zz)({mode:"Drop"},lg)],t.prototype,"emptyPointSettings",void 0),wt([(0,a.Z9)(0)],t.prototype,"gapRatio",void 0),wt([(0,a.Z9)("80%")],t.prototype,"width",void 0),wt([(0,a.Z9)("80%")],t.prototype,"height",void 0),wt([(0,a.Z9)("20%")],t.prototype,"neckWidth",void 0),wt([(0,a.Z9)("20%")],t.prototype,"neckHeight",void 0),wt([(0,a.Z9)("Linear")],t.prototype,"pyramidMode",void 0),wt([(0,a.Z9)(1)],t.prototype,"opacity",void 0),t}(a.rt);function T1(o,t){for(var e=0,i=t;e<i.length;e++){var r=i[e];if(o===r.index)return r}return t[0]}function H0(o,t){for(var e=0,i=t;e<i.length;e++){var r=i[e];if(r.index===o)return r}return null}var $d=function(){function o(t){this.accumulation=t}return Object.defineProperty(o.prototype,"center",{get:function(){return this.pieCenter||(this.accumulation.visibleSeries[0].type==="Pie"?this.accumulation.pieSeriesModule.pieBaseCenter:null)},set:function(t){this.pieCenter=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"radius",{get:function(){return this.pieRadius!==void 0?this.pieRadius:this.accumulation.pieSeriesModule.pieBaseRadius},set:function(t){this.pieRadius=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"labelRadius",{get:function(){return this.pieLabelRadius!==void 0?this.pieLabelRadius:this.accumulation.pieSeriesModule.pieBaseLabelRadius},set:function(t){this.pieLabelRadius=t},enumerable:!0,configurable:!0}),o.prototype.isCircular=function(){return this.accumulation.type==="Pie"},o.prototype.isVariousRadius=function(){return this.accumulation.pieSeriesModule.isRadiusMapped},o.prototype.processExplode=function(t){if(t.target.id.indexOf("_Series_")>-1||t.target.id.indexOf("_datalabel_")>-1){var e=mc(t.target.id).point;if(isNaN(e)||t.target.id.indexOf("_datalabel_")>-1&&this.accumulation.visibleSeries[0].points[e].labelPosition==="Outside")return null;this.explodePoints(e,this.accumulation),this.deExplodeAll(e,this.accumulation.enableAnimation?300:0)}},o.prototype.invokeExplode=function(){for(var t=this.accumulation.visibleSeries[0],e=this.accumulation.enableAnimation?300:0,i=0,r=t.points;i<r.length;i++){var n=r[i];n.isExplode&&n.y!==0&&this.pointExplode(n.index,n,e)}if(this.accumulation.accumulationSelectionModule&&this.accumulation.selectionMode!=="None"&&this.accumulation.accumulationSelectionModule.selectedDataIndexes.length)for(var s=0,l=this.accumulation.accumulationSelectionModule.selectedDataIndexes;s<l.length;s++){var h=l[s];this.explodePoints(h.point,this.accumulation,!0),this.deExplodeAll(h.point,e)}},o.prototype.deExplodeAll=function(t,e){for(var i=this.accumulation.element.id+"_Series_0_Point_",r=this.accumulation.visibleSeries[0].points,n=0,s=r;n<s.length;n++){var l=s[n];(t!==l.index&&!l.isSliced||l.isClubbed)&&(l.isExplode=!1,this.deExplodeSlice(l.index,i,e))}},o.prototype.explodePoints=function(t,e,i){i===void 0&&(i=!1);var r=e.visibleSeries[0],n=r.points,s=H0(t,n),l=!0,h=this.accumulation.enableAnimation?300:0;if((0,a.le)(s))return null;var c=!i&&(s.isSliced||r.clubbedPoints.length&&n[n.length-1].index===r.clubbedPoints[r.clubbedPoints.length-1].index);r.type==="Pie"&&(c||s.isClubbed)&&(l=this.clubPointExplode(t,s,r,n,e,h,c)),l&&s.y!==0&&this.pointExplode(t,s,h,i)},o.prototype.getSum=function(t){var e=0;return t.map(function(i){e+=i.visible?i.y:0}),e},o.prototype.clubPointExplode=function(t,e,i,r,n,s,l){if(l===void 0&&(l=!1),e.isClubbed)return n.animateSeries=!1,r.splice(r.length-1,1),i.clubbedPoints.map(function(c){c.visible=!0,c.isExplode=!0}),n.visibleSeries[0].points=r.concat(i.clubbedPoints),this.deExplodeAll(t,s),i.sumOfPoints=this.getSum(n.visibleSeries[0].points),n.refreshChart(),!1;if(l||e.isSliced){n.animateSeries=!1,r.splice(r.length-i.clubbedPoints.length,i.clubbedPoints.length);var h=i.generateClubPoint();if(h.index=r.length,h.color=i.clubbedPoints[0].color,r.push(h),i.sumOfPoints=this.getSum(r),this.deExplodeAll(t,s),h.isExplode=!1,n.visibleSeries[0].points=r,n.refreshChart(),this.pointExplode(h.index,r[h.index],0,!0),h.isExplode=!1,this.deExplodeSlice(h.index,n.element.id+"_Series_0_Point_",s),e.isSliced)return!1}return!0},o.prototype.pointExplode=function(t,e,i,r){var n,s=this.accumulation.element.id+"_Series_0_Point_",l=this.accumulation;this.isCircular()?n=cr(e.midAngle,l.explodeDistance,this.center):n={x:e.labelRegion&&e.labelRegion.x<e.region.x?-l.explodeDistance:l.explodeDistance,y:0},this.isExplode(s+t)||r?(e.isExplode=!0,this.explodeSlice(t,n,s,this.center||{x:0,y:0},i)):(e.isExplode=!1,this.deExplodeSlice(t,s,i))},o.prototype.isExplode=function(t){var e=xt(t),i=e?e.getAttribute("transform"):null;return e&&(i==="translate(0, 0)"||i===null||i==="translate(0)")},o.prototype.deExplodeSlice=function(t,e,i){var r=xt(e+t);if(r){var n=r.parentNode.lastChild.hasAttribute("transform");n&&r.parentNode.lastChild.removeAttribute("transform")}var s=r?r.getAttribute("transform"):null;if(this.accumulation.enableAnimation&&r&&s&&s!=="translate(0, 0)"&&s!=="translate(0)"){var l=/translate\((-?\d+\.?\d*),?\s*(-?\d+[.]?\d*)?\)/.exec(s);this.performAnimation(t,e,0,0,+l[1],+l[2]||0,i,!0)}else this.performAnimation(t,e,0,0,0,0,i,!0)},o.prototype.setTranslate=function(t,e,i,r){this.setElementTransform(e+t,i),this.accumulation.visibleSeries[0].dataLabel.visible&&(e=this.accumulation.element.id+"_datalabel_Series_0_",this.setElementTransform(e+"shape_"+t,i),this.setElementTransform(e+"text_"+t,i+r),this.setElementTransform(e+"connector_"+t,i))},o.prototype.setElementTransform=function(t,e){var i=xt(t);i&&i.setAttribute("transform",e)},o.prototype.explodeSlice=function(t,e,i,r,n){this.performAnimation(t,i,0,0,e.x-r.x,e.y-r.y,n)},o.prototype.performAnimation=function(t,e,i,r,n,s,l,h){var c=this,u=this.accumulation,p=e.split("_"),f=parseInt(e.split("_")[p.length-3],10),g=u.visibleSeries[f].points[t];if(l<=0)return this.setTranslate(t,e,"translate("+n+", "+s+")",g.transform),null;var C,L;new a.fw({}).animate((0,a.az)("div"),{duration:l,progress:function(D){C=ur(D.timeStamp,i,n,D.duration),L=ur(D.timeStamp,r,s,D.duration),c.setTranslate(t,e,"translate("+(h?n-C:C)+", "+(h?s-L:L)+")",g.transform)},end:function(){c.setTranslate(t,e,"translate("+(h?i:n)+", "+(h?i:s)+")",g.transform)}})},o}(),L1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),k1=function(o){L1(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.initProperties=function(e,i){this.accumulation=e,this.size=Math.min(e.initialClipRect.width,e.initialClipRect.height),this.initAngles(i);var r=parseInt(i.radius,10);if((i.radius.indexOf("%")!==-1||typeof r=="number")&&!isNaN(r))this.isRadiusMapped=!1,this.pieBaseRadius=yi(i.radius,this.size/2),this.innerRadius=yi(i.innerRadius,this.pieBaseRadius),this.pieBaseLabelRadius=i.dataLabel.position==="Inside"?(this.pieBaseRadius-this.innerRadius)/2+this.innerRadius:this.pieBaseRadius+yi(i.dataLabel.connectorStyle.length||"4%",this.size/2);else{var n=[];this.isRadiusMapped=!0;for(var s=0;s<Object.keys(i.points).length;s++)i.points[s].sliceRadius.indexOf("%")!==-1?n[s]=yi(i.points[s].sliceRadius,this.size/2):n[s]=parseInt(i.points[s].sliceRadius,10);var l=Math.min.apply(null,n),h=Math.max.apply(null,n);this.pieBaseRadius=this.seriesRadius=h,this.innerRadius=yi(i.innerRadius,this.seriesRadius),this.innerRadius=this.innerRadius>l?this.innerRadius/2:this.innerRadius}this.radius=this.pieBaseRadius,this.labelRadius=this.pieBaseLabelRadius,e.explodeDistance=i.explode?yi(i.explodeOffset,this.pieBaseRadius):0,this.findCenter(e,i),this.center=this.pieBaseCenter,this.defaultLabelBound(i,i.dataLabel.visible,i.dataLabel.position),this.totalAngle-=.001},t.prototype.getLabelRadius=function(e,i){return e.dataLabel.position==="Inside"?(yi(i.sliceRadius,this.pieBaseRadius)-this.innerRadius)/2+this.innerRadius:yi(i.sliceRadius,this.seriesRadius)+yi(e.dataLabel.connectorStyle.length||"4%",this.size/2)},t.prototype.findCenter=function(e,i){this.accumulation=e,this.pieBaseCenter={x:yi(e.center.x,e.initialClipRect.width)+e.initialClipRect.x,y:yi(e.center.y,e.initialClipRect.height)+e.initialClipRect.y};var r=this.getSeriesBound(i),n=new Rt(r.x+r.width/2,r.y+r.height/2);this.pieBaseCenter.x+=this.pieBaseCenter.x-n.x,this.pieBaseCenter.y+=this.pieBaseCenter.y-n.y,this.accumulation.origin=this.pieBaseCenter},t.prototype.initAngles=function(e){var i=(0,a.le)(e.endAngle)?e.startAngle:e.endAngle;this.totalAngle=(i-e.startAngle)%360,this.startAngle=e.startAngle-90,this.totalAngle=this.totalAngle<=0?360+this.totalAngle:this.totalAngle,this.startAngle=(this.startAngle<0?this.startAngle+360:this.startAngle)%360},t.prototype.defaultLabelBound=function(e,i,r){var n=this.getSeriesBound(e);e.accumulationBound=n,e.labelBound=new ft(n.x,n.y,n.width+n.x,n.height+n.y),i&&r==="Outside"&&(e.labelBound=new ft(Infinity,Infinity,-Infinity,-Infinity))},t.prototype.getSeriesBound=function(e){var i=new ft(Infinity,Infinity,-Infinity,-Infinity);this.initAngles(e);var r=this.startAngle,n=this.totalAngle,s=(this.startAngle+n)%360;s=s===0?360:s,e.findMaxBounds(i,this.getRectFromAngle(r)),e.findMaxBounds(i,this.getRectFromAngle(s)),e.findMaxBounds(i,new ft(this.pieBaseCenter.x,this.pieBaseCenter.y,0,0));var l=(Math.floor(r/90)*90+90)%360,h=Math.floor(s/90)*90%360;h=h===0?360:h,(n>=90||h===l)&&(e.findMaxBounds(i,this.getRectFromAngle(l)),e.findMaxBounds(i,this.getRectFromAngle(h))),(r===0||r+n>=360)&&e.findMaxBounds(i,this.getRectFromAngle(0));for(var c=l===h?0:Math.floor(n/90),u=1;u<c;u++)l=l+90,(l<h||s<r||n===360)&&e.findMaxBounds(i,this.getRectFromAngle(l));return i.width-=i.x,i.height-=i.y,i},t.prototype.getRectFromAngle=function(e){var i=cr(e,this.pieBaseRadius,this.pieBaseCenter);return new ft(i.x,i.y,0,0)},t.prototype.getPathArc=function(e,i,r,n,s){var l=r-i;l=l<0?l+360:l;var h=l<180?0:1;return!s&&s===0?this.getPiePath(e,cr(i,n,e),cr(r,n,e),n,h):this.getDoughnutPath(e,cr(i,n,e),cr(r,n,e),n,cr(i,s,e),cr(r,s,e),s,h)},t.prototype.getPiePath=function(e,i,r,n,s){return"M "+e.x+" "+e.y+" L "+i.x+" "+i.y+" A "+n+" "+n+" 0 "+s+" 1 "+r.x+" "+r.y+" Z"},t.prototype.getDoughnutPath=function(e,i,r,n,s,l,h,c){return"M "+i.x+" "+i.y+" A "+n+" "+n+" 0 "+c+" 1 "+r.x+" "+r.y+" L "+l.x+" "+l.y+" A "+h+" "+h+" 0 "+c+",0 "+s.x+" "+s.y+" Z"},t.prototype.doAnimation=function(e,i){var r=this,n=i.startAngle-90,s=this.accumulation.duration?this.accumulation.duration:i.animation.duration,l;this.pieBaseCenter.x+=1;var h=Math.max(this.accumulation.availableSize.height,this.accumulation.availableSize.width)*.75;h+=h*.414;var c=Ad("Linear");new a.fw({}).animate(e,{duration:s,delay:i.animation.delay,progress:function(u){l=c(u.timeStamp,n,r.totalAngle,u.duration),e.setAttribute("d",r.getPathArc(r.pieBaseCenter,n,l,h,0))},end:function(){r.pieBaseCenter.x-=1,e.setAttribute("d",r.getPathArc(r.pieBaseCenter,0,359.99999,h,0)),r.accumulation.trigger(Ww,r.accumulation.isBlazor?{}:{series:i,accumulation:r.accumulation,chart:r.accumulation});var u=xt(r.accumulation.element.id+"_datalabel_Series_"+i.index);u.style.visibility=r.accumulation.isDestroyed?"hidden":"visible"}})},t}($d),I1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),V0=function(o){I1(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.renderPoint=function(e,i,r,n,s,l){var h=i.sumOfPoints;e.startAngle=this.startAngle;var c=e.visible?e.y:0,u=h?Math.abs(c)/h*this.totalAngle:null,p=Math.PI/180*(90-(360-this.startAngle)-90);this.radius=this.isRadiusMapped?yi(e.sliceRadius,this.seriesRadius):this.radius,n.d=this.getPathOption(e,u,this.startAngle%360),e.midAngle=(this.startAngle-u/2)%360,e.endAngle=this.startAngle%360,e.symbolLocation=cr(e.midAngle,(this.radius+this.innerRadius)/2,this.center),l?(s.appendChild(r.renderer.drawPath(n)),this.refresh(e,u,p,r,n)):(s.appendChild(r.renderer.drawPath(n)),e.degree=u,e.start=p)},t.prototype.findSeries=function(e){var i=3,r=2,n=this.innerRadius===0?this.radius+i:this.innerRadius-i,s=this.innerRadius===0?n+r:n-r;this.toggleInnerPoint(e,n,s)},t.prototype.toggleInnerPoint=function(e,i,r){var n=e.target,s=mc(n.id,!0),l=e.target.id.substring(0,e.target.id.indexOf("Series")-1),h=document.getElementById(this.accumulation.element.id+"PointHover_Border"),c,u=s.series,p=s.point,f=xt(l+"_Series_"+u+"_Point_"+p);if(!isNaN(s.series)&&f){if(!(0,a.le)(u)&&!isNaN(u)&&!(0,a.le)(p)&&!isNaN(p)){var g=this.accumulation.visibleSeries[0].points[p],C=f.getAttribute("class")===l+"_ej2_deselected"?this.accumulation.tooltip.enable?.5:.3:this.accumulation.tooltip.enable?.5:1,L=this.getPathArc(this.accumulation.pieSeriesModule.center,g.startAngle%360,(g.startAngle+g.degree)%360,i,r);h&&l===this.accumulation.element.id&&(h.getAttribute("d")!==L||g.isExplode)&&(h.parentNode.removeChild(h),h=null);var D=xt(l+"_Series_"+u);if(!h&&(!g.isExplode||g.isExplode&&e.type!=="click")){var R=new er(l+"PointHover_Border",g.color,1,g.color,C,"",L);if(c=this.accumulation.renderer.drawPath(R),c.removeAttribute("transform"),this.accumulation.selectionMode!=="None"&&e.target.hasAttribute("class")&&this.accumulation.accumulationSelectionModule.addSvgClass(c,e.target.getAttribute("class")),D.appendChild(c),g.isExplode&&c){var B=f.getAttribute("transform");c.setAttribute("transform",B)}}}}else h&&(this.removeBorder(h,1e3),h=null)},t.prototype.removeBorder=function(e,i){e&&setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},i)},t.prototype.refresh=function(e,i,r,n,s){var l=this,h=xt(s.id),c=n.duration?n.duration:300;new a.fw({}).animate((0,a.az)("div"),{duration:c,delay:0,progress:function(u){var p=ur(u.timeStamp,e.degree,i-e.degree,u.duration),f=ur(u.timeStamp,e.start,r-e.start,u.duration);f=(f/(Math.PI/180)+360)%360,h.setAttribute("d",l.getPathOption(e,p,f)),e.isExplode&&n.accBaseModule.explodePoints(e.index,n,!0),h.style.visibility="visible"},end:function(){h.style.visibility=e.visible?"visible":"hidden",h.setAttribute("d",s.d),e.degree=i,e.start=r}})},t.prototype.getPathOption=function(e,i,r){if(!i)return"";var n=this.getPathArc(this.center,r%360,(r+i)%360,this.isRadiusMapped?yi(e.sliceRadius,this.seriesRadius):this.radius,this.innerRadius);return this.startAngle+=i,n},t.prototype.animateSeries=function(e,i,r,n){var s=e.element.id+"SeriesGroup"+r.index;if(r.animation.enable&&e.animateSeries){var l=e.renderer.createClipPath({id:s+"_clipPath"}),h=new er(s+"_slice","transparent",1,"transparent",1,"",""),c=e.renderer.drawPath(h);l.appendChild(c),e.svgObject.appendChild(l),n.style.cssText="clip-path:url(#"+l.id+"); -webkit-clip-path:url(#"+l.id+");",this.doAnimation(c,r)}},t.prototype.getModuleName=function(){return"PieSeries"},t.prototype.destroy=function(){},t}(k1),D1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Dt=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},z0=function(o){D1(t,o);function t(e,i){var r=o.call(this,e,i)||this;return r.animateselected=!1,r.explodeDistance=0,r.chartid=57724,r}return t.prototype.animate=function(e){this.duration=e||700,this.animateselected=!0,this.animateSeries=!1;var i=0,r=[],n=[],s=[],l=this.visibleSeries[0],h=[];if(h=l.dataSource,l.sumOfPoints=0,l.points.length<Object.keys(l.dataSource).length)this.refresh();else if(l.points.length>Object.keys(l.dataSource).length){var c=this.visibleSeries[0];c.points=c.points.filter(function(g){return g.visible=!1,n.push(g.index),r.push(g.color),h.some(function(C){var L=C;return g.x===L.x&&(g.visible=!0,s.push(g.index),g.index=i,i++),g.x===L.x})});for(var u=n.filter(function(g){return s.indexOf(g)<0}),p=n.length-u.length,f=n.length-1;f>=p;f--)ui("container_Series_0_Point_"+n[f]);for(var f=0;f<c.points.length;f++)c.points[f].y=c.dataSource[f].y,c.points[f].color=r[f],c.sumOfPoints+=c.dataSource[f].y;this.redraw=this.enableAnimation,this.animateSeries=!1,this.calculateBounds(),this.renderElements()}else{for(var f=0;f<l.points.length;f++)l.points[f].y=l.dataSource[f][l.yName],l.points[f].color=l.dataSource[f][l.pointColorMapping]!=null?l.dataSource[f][l.pointColorMapping]:l.points[f].color,l.sumOfPoints+=l.dataSource[f][l.yName];this.redraw=this.enableAnimation,this.animateSeries=!1,this.removeSvg(),this.refreshPoints(l.points),this.renderElements()}},Object.defineProperty(t.prototype,"type",{get:function(){return this.series&&this.series.length?this.series[0].type:"Pie"},enumerable:!0,configurable:!0}),t.prototype.preRender=function(){var e="Blazor";if(this.isBlazor=window[e],this.allowServerDataBinding=!1,this.unWireEvents(),this.setCulture(),this.animateSeries=!0,this.element.id===""){var i=document.getElementsByClassName("e-accumulationchart").length;this.element.id="acc_chart_"+this.chartid+"_"+i}Dd(this),this.wireEvents(),this.element.setAttribute("dir",this.enableRtl?"rtl":"")},t.prototype.setTheme=function(){/*! Set theme for accumulation chart */this.themeStyle=ag(this.theme)},t.prototype.render=function(){var e=this;this.element.className.indexOf("e-accumulationchart")===-1&&this.element.classList.add("e-accumulationchart");var i={chart:this.isBlazor?{}:this,accumulation:this.isBlazor?{}:this,theme:this.theme,name:oc,cancel:!1};this.trigger(oc,i,function(){e.theme=e.isBlazor?i.theme:e.theme,e.setTheme(),e.accBaseModule=new $d(e),e.pieSeriesModule=new V0(e),e.calculateVisibleSeries(),e.processData(),e.renderComplete(),e.allowServerDataBinding=!0})},t.prototype.unWireEvents=function(){/*! Find the Events type */var e=a.AR.isPointer,i=a.AR.touchStartEvent,r=a.AR.touchMoveEvent,n=a.AR.touchEndEvent,s=e?"pointerleave":"mouseleave";/*! UnBind the Event handler */a.bi.remove(this.element,r,this.accumulationMouseMove),a.bi.remove(this.element,n,this.accumulationMouseEnd),a.bi.remove(this.element,i,this.accumulationMouseStart),a.bi.remove(this.element,"click",this.accumulationOnMouseClick),a.bi.remove(this.element,"dblclick",this.accumulationOnDoubleClick),a.bi.remove(this.element,"contextmenu",this.accumulationRightClick),a.bi.remove(this.element,s,this.accumulationMouseLeave),window.removeEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResizeBound)},t.prototype.wireEvents=function(){if(!this.element)return;/*! Find the Events type */var e=a.AR.isPointer,i=a.AR.touchStartEvent,r=a.AR.touchEndEvent,n=a.AR.touchMoveEvent,s=e?"pointerleave":"mouseleave";/*! Bind the Event handler */a.bi.add(this.element,n,this.accumulationMouseMove,this),a.bi.add(this.element,r,this.accumulationMouseEnd,this),a.bi.add(this.element,i,this.accumulationMouseStart,this),a.bi.add(this.element,"click",this.accumulationOnMouseClick,this),a.bi.add(this.element,"dblclick",this.accumulationOnDoubleClick,this),a.bi.add(this.element,"contextmenu",this.accumulationRightClick,this),a.bi.add(this.element,s,this.accumulationMouseLeave,this),this.accumulationResizeBound=this.accumulationResize.bind(this),window.addEventListener(a.AR.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.accumulationResizeBound),new a.Xh(this.element);/*! Apply the style for chart */this.setStyle(this.element)},t.prototype.setMouseXY=function(e){var i,r,n=xt(this.element.id+"_svg");if(n&&this.element){var s=n.getBoundingClientRect(),l=this.element.getBoundingClientRect();if(e.type.indexOf("touch")>-1){this.isTouch=!0;var h=e;r=h.changedTouches[0].clientY,i=h.changedTouches[0].clientX}else this.isTouch=e.pointerType==="touch"||e.pointerType==="2",i=e.clientX,r=e.clientY;this.mouseY=r-l.top-Math.max(s.top-l.top,0),this.mouseX=i-l.left-Math.max(s.left-l.left,0)}},t.prototype.accumulationMouseEnd=function(e){return this.setMouseXY(e),this.trigger(Lg,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.isTouch&&(this.titleTooltip(e,this.mouseX,this.mouseY,this.isTouch),this.accumulationDataLabelModule&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(e,this.mouseX,this.mouseY,this.isTouch),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(e)),this.notify(a.AR.touchEndEvent,e),!1},t.prototype.accumulationMouseStart=function(e){return this.setMouseXY(e),this.trigger(Tg,{target:e.target.id,x:this.mouseX,y:this.mouseY}),!1},t.prototype.accumulationResize=function(){var e=this;this.animateSeries=!1;var i={accumulation:this.isBlazor?{}:this,previousSize:new ni(this.availableSize.width,this.availableSize.height),name:cc,currentSize:new ni(0,0),chart:this.isBlazor?{}:this},r={name:"beforeResize",cancelResizedEvent:!1};return this.resizeTo&&clearTimeout(this.resizeTo),this.trigger(kg,r),r.cancelResizedEvent||(this.resizeTo=+setTimeout(function(){if(e.isDestroyed){clearTimeout(e.resizeTo);return}Dd(e),i.currentSize=e.availableSize,e.trigger(cc,i),e.refreshSeries(),e.refreshChart()},500)),!1},t.prototype.print=function(e){var i=document.getElementById(this.element.id+"_Series_0").style.clipPath;document.getElementById(this.element.id+"_Series_0").style.clipPath="";var r=new B0(this);r.print(e),document.getElementById(this.element.id+"_Series_0").style.clipPath=i},t.prototype.export=function(e,i){this.exportModule&&(this.exportModule.export(e,i),this.afterExport&&this.exportModule.getDataUrl(this))},t.prototype.setStyle=function(e){e.style.touchAction="element",e.style.msTouchAction="element",e.style.msContentZooming="none",e.style.msUserSelect="none",e.style.webkitUserSelect="none",e.style.position="relative",e.style.display="block"},t.prototype.setAnnotationValue=function(e,i){var r=this.annotations[e],n,s=xt(this.element.id+"_Annotation_Collections");i&&(r.content=i,s?(n=this.createElement("div"),ui(this.element.id+"_Annotation_"+e),this.annotationModule.processAnnotation(r,e,n),s.appendChild(n.children[0])):this.annotationModule.renderAnnotations(xt(this.element.id+"_Secondary_Element")))},t.prototype.accumulationMouseMove=function(e){return xt(this.element.id+"_svg")&&(this.setMouseXY(e),this.trigger(Cg,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.pointMove&&this.triggerPointEvent(Eg,e.target,e),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.move(e),this.accumulationDataLabelModule&&this.visibleSeries[0]&&this.visibleSeries[0].dataLabel.visible&&this.accumulationDataLabelModule.move(e,this.mouseX,this.mouseY),this.isTouch||this.titleTooltip(e,this.mouseX,this.mouseY),this.enableBorderOnMouseMove&&this.type==="Pie"&&this.pieSeriesModule&&sn(this.mouseX,this.mouseY,this.initialClipRect)&&this.pieSeriesModule.findSeries(e),this.notify(a.AR.touchMoveEvent,e)),!1},t.prototype.titleTooltip=function(e,i,r,n){var s=e.target.id,l=s===this.element.id+"_title"||s===this.element.id+"_subTitle"||s===this.element.id+"_chart_legend_title";if(e.target.textContent.indexOf("...")>-1&&l){var h=s===this.element.id+"_title"?this.title:s===this.element.id+"_subTitle"?this.subTitle:this.legendSettings.title;to(h,i,r,this.element.offsetWidth,this.element.id+"_EJ2_Title_Tooltip",xt(this.element.id+"_Secondary_Element"),n)}else ui(this.element.id+"_EJ2_Title_Tooltip")},t.prototype.accumulationOnDoubleClick=function(e){return this.trigger(wg,{target:e.target.id,x:this.mouseX,y:this.mouseY}),!1},t.prototype.accumulationOnMouseClick=function(e){return this.setMouseXY(e),this.accumulationLegendModule&&this.legendSettings.visible&&this.accumulationLegendModule.click(e),this.selectionMode!=="None"&&this.accumulationSelectionModule&&this.accumulationSelectionModule.calculateSelectedElements(this,e),this.visibleSeries[0].explode&&this.accBaseModule.processExplode(e),this.enableBorderOnMouseMove&&this.pieSeriesModule&&this.type==="Pie"&&this.pieSeriesModule.findSeries(e),this.trigger(Sg,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.pointClick&&this.triggerPointEvent(xg,e.target,e),!1},t.prototype.triggerPointEvent=function(e,i,r){var n=r,s=mc(i.id,!0);s.series>=0&&s.point>=0&&this.trigger(e,{series:this.isBlazor?{}:this.series[s.series],point:this.series[s.series].points[s.point],seriesIndex:s.series,pointIndex:s.point,x:this.mouseX,y:this.mouseY,pageX:n.pageX,pageY:n.pageY})},t.prototype.accumulationRightClick=function(e){return e.buttons===2||e.pointerType==="touch"?(e.preventDefault(),e.stopPropagation(),!1):!0},t.prototype.accumulationMouseLeave=function(e){this.setMouseXY(e),this.trigger(Ag,{target:e.target.id,x:this.mouseX,y:this.mouseY}),this.notify(a.AR.isPointer?"pointerleave":"mouseleave",e);var i=document.getElementById(this.element.id+"PointHover_Border");return i&&(this.pieSeriesModule.removeBorder(i,1e3),i=null),!1},t.prototype.setCulture=function(){this.intl=new a.eC},t.prototype.createPieSvg=function(){this.removeSvg(),Zg(this)},t.prototype.removeSvg=function(){if(this.redraw)return null;if(Cc(this),ui(this.element.id+"_Secondary_Element"),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&(0,a.Od)(this.svgObject)}ui("EJ2_legend_tooltip"),ui("EJ2_datalabel_tooltip"),ui(this.element.id+"PointHover_Border")},t.prototype.createSecondaryElement=function(){var e=is(this.redraw,this.element.id+"_Secondary_Element")||this.createElement("div",{id:this.element.id+"_Secondary_Element",styles:"position: relative"});Nt(!1,this.element,e,this.redraw)},t.prototype.calculateVisibleSeries=function(){this.visibleSeries=[];for(var e=0,i=this.series.length;e<i;e++)if(this.series[e].index=e,this.series[e].type===this.type&&this.visibleSeries.length===0){this.visibleSeries.push(this.series[e]);break}},t.prototype.processData=function(e){e===void 0&&(e=!0),this.seriesCounts=0;for(var i=0,r=this.visibleSeries;i<r.length;i++){var n=r[i];n.dataModule=new e0(n.dataSource||this.dataSource,n.query),n.refreshDataManager(this,e)}},t.prototype.refreshChart=function(){this.doGrouppingProcess(),this.createPieSvg(),this.calculateBounds(),this.renderElements(),ui("chartmeasuretext")},t.prototype.doGrouppingProcess=function(){var e=this.visibleSeries[0];!(0,a.le)(e.resultData)&&!(0,a.le)(e.lastGroupTo)&&e.lastGroupTo!==e.groupTo&&e.getPoints(e.resultData,this)},t.prototype.calculateBounds=function(){this.initialClipRect=new ft(this.margin.left,this.margin.top,this.availableSize.width,this.availableSize.height),this.titleCollection=[],this.subTitleCollection=[];var e=0,i=0,r=0,n=0;if(this.titleCollection=io(this.title,this.titleStyle,this.initialClipRect.width),e=this.title?Pt(this.title,this.titleStyle).height*this.titleCollection.length:e,this.subTitle){for(var s=0,l=this.titleCollection;s<l.length;s++){var h=l[s];n=Pt(h,this.titleStyle).width,r=n>r?n:r}this.subTitleCollection=io(this.subTitle,this.subTitleStyle,r),i=Pt(this.subTitle,this.subTitleStyle).height*this.subTitleCollection.length}ox(this.initialClipRect,new ft(0,i+e,this.margin.right+this.margin.left,this.margin.bottom+this.margin.top)),this.calculateLegendBounds()},t.prototype.calculateLegendBounds=function(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.getLegendOptions(this,this.visibleSeries),this.accumulationLegendModule.calculateLegendBounds(this.initialClipRect,this.availableSize,null)},t.prototype.renderElements=function(){this.renderBorder(),this.createSecondaryElement(),this.renderSeries(),this.renderTitle(),this.renderLegend(),Nt(!1,this.element,this.svgObject,this.redraw),this.processSelection(),this.processExplode(),this.renderAnnotation(),this.setSecondaryElementPosition(),(0,a.tx)(this.element.id+"_DataLabel","Template",this.series[0].dataLabel),this.trigger("loaded",{accumulation:this.isBlazor?{}:this,chart:this.isBlazor?{}:this}),this.animateSeries=!1},t.prototype.setSecondaryElementPosition=function(){var e=xt(this.element.id+"_Secondary_Element");if(!!e){var i=this.element.getBoundingClientRect(),r=xt(this.element.id+"_svg").getBoundingClientRect();e.style.left=Math.max(r.left-i.left,0)+"px",e.style.top=Math.max(r.top-i.top,0)+"px"}},t.prototype.renderAnnotation=function(){this.annotationModule&&this.annotationModule.renderAnnotations(xt(this.element.id+"_Secondary_Element"))},t.prototype.processExplode=function(){if(this.redraw||!this.visibleSeries[0].explode)return null;this.accBaseModule.invokeExplode()},t.prototype.renderSeries=function(){this.redraw||this.svgObject.appendChild(this.renderer.createGroup({id:this.element.id+"_SeriesCollection"}));for(var e=0,i=this.visibleSeries;e<i.length;e++){var r=i[e];r.visible&&this[On(r.type)+"SeriesModule"]&&(this[On(r.type)+"SeriesModule"].initProperties(this,r),r.renderSeries(this,this.redraw))}},t.prototype.renderBorder=function(){var e=this.border.width;Nt(!1,this.svgObject,this.renderer.drawRectangle(new Sn(this.element.id+"_border",this.background||this.themeStyle.background,this.border,1,new ft(e/2,e/2,this.availableSize.width-e,this.availableSize.height-e))),this.redraw);var i=this.backgroundImage;if(i){var r=new Od(this.availableSize.height-e,this.availableSize.width-e,i,0,0,this.element.id+"_background","visible","none");Nt(!1,this.svgObject,this.renderer.drawImage(r),this.redraw)}},t.prototype.renderLegend=function(){if(!this.accumulationLegendModule||!this.legendSettings.visible)return null;this.accumulationLegendModule.legendCollections.length&&(this.visibleSeries[0].type==="Pie"&&this.accumulationLegendModule.getSmartLegendLocation(this.visibleSeries[0].labelBound,this.accumulationLegendModule.legendBounds,this.margin),this.accumulationLegendModule.renderLegend(this,this.legendSettings,this.accumulationLegendModule.legendBounds,this.redraw))},t.prototype.processSelection=function(){var e=[];this.accumulationSelectionModule&&this.selectionMode!=="None"&&(e=(0,a.l7)([],this.accumulationSelectionModule.selectedDataIndexes,null,!0),this.accumulationSelectionModule.invokeSelection(this)),this.accumulationHighlightModule&&this.highlightMode!=="None"&&this.accumulationHighlightModule.invokeHighlight(this),e.length>0&&(this.accumulationSelectionModule.selectedDataIndexes=e,this.accumulationSelectionModule.redrawSelection(this))},t.prototype.renderTitle=function(){var e=this.margin;if(!this.title)return null;var i=bl(this.titleStyle.textAlignment,this.enableRtl),r=Pt(this.title,this.titleStyle),n=20,s=this.margin.top+r.height*3/4,l=this.accumulationLegendModule==null?0:this.legendSettings.position=="Top"?this.accumulationLegendModule.legendBounds.height:0,h=this.explodeDistance==0?0:this.explodeDistance,c=l!=0?0:h/2,u=new ft(e.left,0,this.availableSize.width-e.left-e.right,0),p=new fr(this.element.id+"_title",gl(u,this.titleStyle),s,i,this.titleCollection,"","auto");p.x=parseInt(this.series[0].radius)>=80?p.x:this.accBaseModule.center.x,p.y=parseInt(this.series[0].radius)>=80?p.y:this.accBaseModule.center.y-this.accBaseModule.radius-n-s-l-c,this.series[0].type==="Pie"&&parseInt(this.series[0].radius)<80&&(p.x=this.accBaseModule.center.x-r.width/2<this.initialClipRect.x?r.width/2+this.initialClipRect.x:this.accBaseModule.center.x+r.width/2>this.initialClipRect.x+this.initialClipRect.width?this.initialClipRect.x+this.initialClipRect.width-r.width/2-this.initialClipRect.x:p.x,p.y=p.y<this.initialClipRect.y-l?this.initialClipRect.y-l:p.y);var f=mr(this.renderer,p,this.titleStyle,this.titleStyle.color||this.themeStyle.chartTitle,this.svgObject,!1,this.redraw);f&&f.setAttribute("aria-label",this.title),this.subTitle&&this.renderSubTitle(p)},t.prototype.renderSubTitle=function(e){for(var i=0,r=0,n=10,s=this.titleStyle.textAlignment,l=Pt(this.subTitle,this.subTitleStyle),h=0,c=this.titleCollection;h<c.length;h++){var u=c[h];r=Pt(u,this.titleStyle).width,i=r>i?r:i}var p=new ft(s==="Center"?e.x-i/2:s==="Far"?e.x-i:e.x,0,i,0),f=new fr(this.element.id+"_subTitle",gl(p,this.subTitleStyle),e.y*e.text.length+l.height*3/4+n,bl(this.subTitleStyle.textAlignment,this.enableRtl),this.subTitleCollection,"","auto");mr(this.renderer,f,this.subTitleStyle,this.subTitleStyle.color||this.themeStyle.chartTitle,this.svgObject,!1,this.redraw)},t.prototype.getSeriesElement=function(){return this.svgObject.getElementsByTagName("g")[0]},t.prototype.refreshSeries=function(){for(var e=0,i=this.visibleSeries;e<i.length;e++){var r=i[e];this.refreshPoints(r.points)}},t.prototype.refreshPoints=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];n.labelPosition=null,n.labelRegion=null,n.labelVisible=!0}},t.prototype.getModuleName=function(){return"accumulationchart"},t.prototype.destroy=function(){this.element&&(this.unWireEvents(),o.prototype.destroy.call(this),this.element.classList.remove("e-accumulationchart"),this.removeSvg(),this.svgObject=null)},t.prototype.requiredModules=function(){var e=[],i=!1;return e.push({member:this.type+"Series",args:[this]}),this.legendSettings.visible&&e.push({member:"AccumulationLegend",args:[this]}),this.findDatalabelVisibility()&&e.push({member:"AccumulationDataLabel",args:[this]}),this.tooltip.enable&&e.push({member:"AccumulationTooltip",args:[this]}),this.selectionMode!=="None"&&e.push({member:"AccumulationSelection",args:[this]}),this.highlightMode!=="None"&&e.push({member:"AccumulationHighlight",args:[this]}),(this.enableExport||this.allowExport)&&e.push({member:"Export",args:[this]}),i=this.annotations.some(function(r){return r.content!==null}),i&&e.push({member:"Annotation",args:[this]}),e},t.prototype.findDatalabelVisibility=function(){for(var e=0,i=this.series;e<i.length;e++){var r=i[e];if(r.dataLabel.visible)return!0}return!1},t.prototype.changeVisibleSeries=function(e,i){for(var r=0,n=e;r<n.length;r++){var s=n[r];if(i===s.index)return s}return null},t.prototype.getPersistData=function(){return""},t.prototype.onPropertyChanged=function(e,i){for(var r={refreshElements:!1,refreshBounds:!1},n=0,s=Object.keys(e);n<s.length;n++){var l=s[n];switch(l){case"theme":this.animateSeries=!0;break;case"title":case"subTitle":case"height":case"width":case"margin":r.refreshBounds=!0;break;case"titleStyle":e.titleStyle&&(e.titleStyle.size||e.titleStyle.textOverflow)?r.refreshBounds=!0:r.refreshElements=!0;break;case"subTitleStyle":e.subTitleStyle&&(e.subTitleStyle.size||e.subTitleStyle.textOverflow)?r.refreshBounds=!0:r.refreshElements=!0;break;case"legendSettings":r.refreshBounds=!0,r.refreshElements=!0;break;case"dataSource":this.processData(!1),r.refreshBounds=!0;break;case"series":if(!this.animateselected){for(var h=this.series.length,c=!1,u=void 0,p=void 0,f=0;f<h;f++)u=e.series[f],this.isBlazor&&(u.startAngle||u.endAngle||u.explodeOffset||u.neckHeight||u.neckWidth||u.radius||u.innerRadius||u.groupMode||u.emptyPointSettings)&&(p=!0),e.series[f]&&(e.series[f].dataSource||e.series[f].yName||e.series[f].xName||e.series[f].dataLabel||p)&&((0,a.l7)(this.changeVisibleSeries(this.visibleSeries,f),u,null,!0),c=!0),e.series[f]&&!(0,a.le)(e.series[f].explodeIndex)&&e.series[f].explodeIndex>=0&&e.series[f].explodeIndex!==i.series[f].explodeIndex?(this.accBaseModule.explodePoints(e.series[f].explodeIndex,this),this.accBaseModule.deExplodeAll(e.series[f].explodeIndex,this.enableAnimation?300:0)):e.series[f].explodeIndex<0&&this.accBaseModule.deExplodeAll(e.series[f].explodeIndex,this.enableAnimation?300:0);c&&(this.processData(!1),r.refreshBounds=!0)}this.animateselected=!1,this.redraw=!1;break;case"locale":case"currencyCode":o.prototype.refresh.call(this);break;case"background":case"border":case"annotations":case"enableSmartLabels":r.refreshElements=!0;break;case"isMultiSelect":case"selectedDataIndexes":case"selectionMode":this.accumulationSelectionModule&&((0,a.le)(this.accumulationSelectionModule.selectedDataIndexes)?this.accumulationSelectionModule.invokeSelection(this):this.accumulationSelectionModule.redrawSelection(this));break}}!r.refreshBounds&&r.refreshElements?(this.createPieSvg(),this.renderElements()):r.refreshBounds&&(this.refreshSeries(),this.createPieSvg(),this.calculateBounds(),this.renderElements())},Dt([(0,a.Z9)(null)],t.prototype,"width",void 0),Dt([(0,a.Z9)(null)],t.prototype,"height",void 0),Dt([(0,a.Z9)(null)],t.prototype,"title",void 0),Dt([(0,a.Z9)(null)],t.prototype,"backgroundImage",void 0),Dt([(0,a.Zz)({},E1)],t.prototype,"center",void 0),Dt([(0,a.Z9)("")],t.prototype,"dataSource",void 0),Dt([(0,a.Zz)(Mr.chartTitleFont,Pr)],t.prototype,"titleStyle",void 0),Dt([(0,a.Z9)(null)],t.prototype,"subTitle",void 0),Dt([(0,a.Zz)(Mr.chartSubTitleFont,Pr)],t.prototype,"subTitleStyle",void 0),Dt([(0,a.Zz)({},i0)],t.prototype,"legendSettings",void 0),Dt([(0,a.Zz)({},hg)],t.prototype,"tooltip",void 0),Dt([(0,a.Z9)("None")],t.prototype,"selectionMode",void 0),Dt([(0,a.Z9)("None")],t.prototype,"highlightMode",void 0),Dt([(0,a.Z9)("None")],t.prototype,"selectionPattern",void 0),Dt([(0,a.Z9)("None")],t.prototype,"highlightPattern",void 0),Dt([(0,a.Z9)(!0)],t.prototype,"enableBorderOnMouseMove",void 0),Dt([(0,a.Z9)(!1)],t.prototype,"isMultiSelect",void 0),Dt([(0,a.Z9)(!0)],t.prototype,"enableAnimation",void 0),Dt([(0,a.FE)([],og)],t.prototype,"selectedDataIndexes",void 0),Dt([(0,a.Zz)({},sc)],t.prototype,"margin",void 0),Dt([(0,a.Z9)(!0)],t.prototype,"enableSmartLabels",void 0),Dt([(0,a.Zz)({color:"#DDDDDD",width:0},xr)],t.prototype,"border",void 0),Dt([(0,a.Z9)(null)],t.prototype,"background",void 0),Dt([(0,a.FE)([{}],A1)],t.prototype,"series",void 0),Dt([(0,a.FE)([{}],w1)],t.prototype,"annotations",void 0),Dt([(0,a.Z9)("Material")],t.prototype,"theme",void 0),Dt([(0,a.Z9)(!1)],t.prototype,"useGroupingSeparator",void 0),Dt([(0,a.Z9)(!0)],t.prototype,"enableExport",void 0),Dt([(0,a.Z9)(!1)],t.prototype,"allowExport",void 0),Dt([(0,a.ju)()],t.prototype,"loaded",void 0),Dt([(0,a.ju)()],t.prototype,"load",void 0),Dt([(0,a.ju)()],t.prototype,"seriesRender",void 0),Dt([(0,a.ju)()],t.prototype,"legendRender",void 0),Dt([(0,a.ju)()],t.prototype,"textRender",void 0),Dt([(0,a.ju)()],t.prototype,"tooltipRender",void 0),Dt([(0,a.ju)()],t.prototype,"pointRender",void 0),Dt([(0,a.ju)()],t.prototype,"annotationRender",void 0),Dt([(0,a.ju)()],t.prototype,"beforePrint",void 0),Dt([(0,a.ju)()],t.prototype,"chartMouseMove",void 0),Dt([(0,a.ju)()],t.prototype,"chartMouseClick",void 0),Dt([(0,a.ju)()],t.prototype,"chartDoubleClick",void 0),Dt([(0,a.ju)()],t.prototype,"pointClick",void 0),Dt([(0,a.ju)()],t.prototype,"pointMove",void 0),Dt([(0,a.ju)()],t.prototype,"animationComplete",void 0),Dt([(0,a.ju)()],t.prototype,"chartMouseDown",void 0),Dt([(0,a.ju)()],t.prototype,"chartMouseLeave",void 0),Dt([(0,a.ju)()],t.prototype,"chartMouseUp",void 0),Dt([(0,a.ju)()],t.prototype,"beforeResize",void 0),Dt([(0,a.ju)()],t.prototype,"resized",void 0),Dt([(0,a.ju)()],t.prototype,"afterExport",void 0),Dt([(0,a.ju)()],t.prototype,"selectionComplete",void 0),Dt([(0,a.Z9)("USD")],t.prototype,"currencyCode",void 0),t=Dt([a.Zl],t),t}(a.wA),O1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),R1=function(o){O1(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(e,i,r,n){for(var s,l,h="",c=null,u="M",p=e.chart&&e.chart.chartAreaType==="PolarRadar",f=e.emptyPointSettings&&e.emptyPointSettings.mode==="Drop",g=p?dl:Ar,C=e.category==="TrendLine"?e.points:this.enableComplexProperty(e),L=0,D=C;L<D.length;L++){var R=D[L];R.regions=[],R.symbolLocations=[],R.visible&&ts(C[R.index-1],R,C[R.index+1],e)?(h+=this.getLineDirection(c,R,e,n,g,u),u=c?"L":u,c=R,this.storePointLocation(R,e,n,g)):(c=f?c:null,u=f?u:"M")}if(p&&e.isClosed){var B=this.getFirstLastVisiblePoint(C);l=g(B.last.xValue,B.last.yValue,i,r,n,e),s=g(B.first.xValue,B.first.yValue,i,r,n,e),h=h.concat(u+" "+l.x+" "+l.y+" L "+s.x+" "+s.y)}var H=e.category==="Indicator"?e.chart.element.id+"_Indicator_"+e.index+"_"+e.name:e.category==="TrendLine"?e.chart.element.id+"_Series_"+e.sourceIndex+"_TrendLine_"+e.index:e.chart.element.id+"_Series_"+(e.index===void 0?e.category:e.index),j=new er(H,"none",e.width,e.interior,e.opacity,e.dashArray,h);this.appendLinePath(j,e,""),this.renderMarker(e)},t.prototype.doAnimation=function(e){var i=e.animation;this.doProgressiveAnimation(e,i)},t.prototype.getModuleName=function(){return"LineSeries"},t.prototype.destroy=function(){},t}(Rc),M1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),P1=function(o){M1(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(e,i,r,n){for(var s=e.chart.chartAreaType==="PolarRadar",l=s?dl:Ar,h="",c=this.enableComplexProperty(e),u=c.length,p=e.stackedValues,f,g,C,L,D=0;D<u;D++)c[D].regions=[],c[D].symbolLocations=[],f=c[D].index,c[D].visible&&ts(c[D-1],c[D],c[D+1],e)?(C=l(c[D].xValue,p.endValues[f],i,r,n,e),h=h.concat((D?"L":"M")+" "+C.x+" "+C.y+" "),c[D].symbolLocations.push(l(c[D].xValue,p.endValues[f],i,r,n,e)),c[D].regions.push(new ft(c[D].symbolLocations[0].x-e.marker.width,c[D].symbolLocations[0].y-e.marker.height,2*e.marker.width,2*e.marker.height))):e.emptyPointSettings.mode!=="Drop"&&c[D+1]&&c[D+1].visible&&(g=c[D+1].index,C=l(c[D+1].xValue,p.endValues[g],i,r,n,e),h=h.concat("M "+C.x+" "+C.y+" "));e.chart.chartAreaType==="PolarRadar"&&c.length>1&&(C={y:p.endValues[0],x:e.points[0].xValue},L=l(C.x,C.y,i,r,n,e),h+="L "+L.x+" "+L.y+" ");var R=new er(e.chart.element.id+"_Series_"+e.index,"none",e.width,e.interior,e.opacity,e.dashArray,h);this.appendLinePath(R,e,""),this.renderMarker(e)},t.prototype.doAnimation=function(e){var i=e.animation;this.doLinearAnimation(e,i)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingLineSeries"},t}(Rc),N1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),B1=function(o){N1(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(e){for(var i=this.getSideBySideInfo(e),r=e.stackedValues,n,s,l=0,h=e.points;l<h.length;l++){var c=h[l];c.symbolLocations=[],c.regions=[],c.visible&&ts(e.points[c.index-1],c,e.points[c.index+1],e)&&(n=this.getRectangle(c.xValue+i.start,r.endValues[c.index],c.xValue+i.end,r.startValues[c.index],e),n.height=e.columnWidthInPixel?e.columnWidthInPixel:n.height,n.y=e.columnWidthInPixel?n.y-e.columnWidthInPixel/2:n.y,s=this.triggerEvent(e,c,e.interior,{width:e.border.width,color:e.border.color}),s.cancel||(this.drawRectangle(e,c,n,s),this.updateSymbolLocation(c,n,e)))}this.renderMarker(e)},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"StackingBarSeries"},t.prototype.doAnimation=function(e){this.animate(e)},t}(Oc),F1=function(){function o(){}return o.prototype.render=function(t,e,i,r){t.isRectSeries=!1;for(var n=t.marker,s=this.enableComplexProperty(t),l,h=t.chart.chartAreaType==="PolarRadar"?dl:Ar,c,u=t.chart.redraw,p=0,f=s;p<f.length;p++){var g=f[p];c=u&&g.symbolLocations?g.symbolLocations[0]:null,g.symbolLocations=[],g.regions=[],g.visible&&ts(s[g.index-1],g,s[g.index+1],t)&&(l={cancel:!1,name:Ds,series:t,point:g,fill:t.setPointColor(g,t.interior),border:t.setBorderColor(g,{width:t.border.width,color:t.border.color}),height:n.height,width:n.width,shape:n.shape},t.chart.trigger(Ds,l),l.cancel?g.marker={visible:!0}:(g.symbolLocations.push(h(g.xValue,g.yValue,e,i,r,t)),g.color=l.fill,this.refresh(t,g,l,c)))}},o.prototype.enableComplexProperty=function(t){for(var e=[],i=[],r=t.yAxis.visibleRange,n=t.xAxis.visibleRange,s=t.clipRect,l=t.points,h=Math.abs(r.delta/s.height),c=Math.abs(n.delta/s.width),u=l[0]&&l[0].y>h?0:h,p=l[0]&&l[0].x>c?0:c,f=0,g=0,C=0,L=l;C<L.length;C++){var D=L[C];D.symbolLocations=[],f=D.yValue?D.yValue:r.min,g=D.xValue?D.xValue:n.min,(Math.abs(u-f)>=h||Math.abs(p-g)>=c)&&(i.push(D),u=f,p=g)}for(var R,B=0;B<i.length;B++)R=i[B],!((0,a.le)(R.x)||R.x==="")&&e.push(R);return e},o.prototype.refresh=function(t,e,i,r){var n=t.chart,s,l,h=t.marker,c=i.point.marker.imageUrl||h.imageUrl,u=new er(n.element.id+"_Series_"+t.index+"_Point_"+e.index,i.fill,i.border.width,i.border.color,t.opacity,null);n.redraw&&xt(u.id)&&(s=i.shape==="Circle"?"c":"",l=xt(u.id).getAttribute("d")),Nt(!1,t.seriesElement,qr(e.symbolLocations[0],i.shape,new ni(i.width,i.height),c,u,e.x.toString()+":"+e.yValue.toString(),t.chart.svgRenderer,t.clipRect),n.redraw,!0,s+"x",s+"y",r,l),e.regions.push(new ft(e.symbolLocations[0].x-h.width,e.symbolLocations[0].y-h.height,2*h.width,2*h.height)),e.marker={border:i.border,fill:i.fill,height:i.height,visible:!0,width:i.width,shape:i.shape,imageUrl:c}},o.prototype.doAnimation=function(t){for(var e=t.animation.duration,i=t.animation.delay,r=t.seriesElement.childNodes,n=1,s=0,l=t.points;s<l.length;s++){var h=l[s];!h.symbolLocations.length||!r[n]||(fl(r[n],i,e,t,h.index,h.symbolLocations[0],!1),n++)}},o.prototype.getModuleName=function(){return"ScatterSeries"},o.prototype.destroy=function(){},o}(),H1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),V1=function(o){H1(t,o);function t(e){var i=o.call(this,e)||this;return i.library=i,i.addEventListener(),i}return t.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(a.AR.touchMoveEvent,this.mouseMove,this),this.chart.on("click",this.click,this),this.chart.on(a.AR.touchEndEvent,this.mouseEnd,this))},t.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(a.AR.touchMoveEvent,this.mouseMove),this.chart.off("click",this.click),this.chart.off(a.AR.touchEndEvent,this.mouseEnd))},t.prototype.mouseMove=function(e){if(this.chart.legendSettings.visible&&!this.chart.isTouch&&(this.move(e),this.chart.highlightModule&&this.chart.highlightMode!=="None"))for(var i=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_"],r=e.target.id,n=void 0,s=0,l=i;s<l.length;s++){var h=l[s];if(r.indexOf(h)>-1){n=parseInt(r.split(h)[1],10),this.chart.highlightModule.legendSelection(this.chart,n,e);break}}},t.prototype.mouseEnd=function(e){this.chart.legendSettings.visible&&this.chart.isTouch&&this.move(e)},t.prototype.getLegendOptions=function(e,i){this.legendCollections=[];var r,n,s=[];this.isRtlEnable=i.enableRtl,this.isReverse=!this.isRtlEnable&&i.legendSettings.reverse,e.length>1&&(this.legend.mode="Series");for(var l=0,h=e;l<h.length;l++){var c=h[l];if(this.legend.mode==="Series")c.category!=="Indicator"&&(r=i.chartAreaType==="PolarRadar"?c.drawType:c.type,n=c.pointColorMapping&&c.points.length>0&&c.points[0].interior?c.points[0].interior:c.interior,this.legendCollections.push(new ro(c.name,n,c.legendShape,c.category==="TrendLine"?this.chart.series[c.sourceIndex].trendlines[c.index].visible:c.visible,r,c.legendImageUrl,c.marker.shape,c.marker.visible)));else if(this.legend.mode==="Point")for(var u=function(ie){r=i.chartAreaType==="PolarRadar"?c.drawType:c.type,n=ie.interior?ie.interior:c.interior,p.legendCollections.filter(function(me){return me.text===ie.x.toString()}).length===0&&p.legendCollections.push(new ro(ie.x.toString(),n,c.legendShape,c.category==="TrendLine"?p.chart.series[c.sourceIndex].trendlines[c.index].visible:ie.visible,r,"",c.marker.shape,c.marker.visible))},p=this,f=0,g=c.points;f<g.length;f++){var C=g[f];u(C)}else if(this.legend.mode==="Range")for(var L=0,D=c.points;L<D.length;L++){var C=D[L];r=i.chartAreaType==="PolarRadar"?c.drawType:c.type,n=C.interior?C.interior:c.interior;var R="Others";if(s.indexOf(n)<0&&(s.push(n),i.rangeColorSettings.length>=1&&i.rangeColorSettings[0].colors.length===1)){for(var B=0,H=i.rangeColorSettings;B<H.length;B++){var j=H[B];j.colors[0]===n&&(R=j.label)}this.legendCollections.push(new ro(R,n,c.legendShape,c.category==="TrendLine"?this.chart.series[c.sourceIndex].trendlines[c.index].visible:C.visible,r,"",c.marker.shape,c.marker.visible))}}else if(this.legendCollections.length===0&&i.rangeColorSettings.length>0){var W=i.rangeColorSettings[0].start.toString(),ne=i.rangeColorSettings[i.rangeColorSettings.length-1].end.toString();this.legendCollections.push(new ro(W,c.interior,"Rectangle",!0,r,"",c.marker.shape,c.marker.visible)),this.legendCollections.push(new ro(ne,c.interior,"Rectangle",!0,r,"",c.marker.shape,c.marker.visible))}}this.isReverse&&i.legendSettings.mode!=="Gradient"&&this.legendCollections.reverse()},t.prototype.getLegendBounds=function(e,i,r){this.calculateLegendTitle(r,i),this.isTitle=!!r.title,this.chartRowCount=1,this.rowHeights=[],this.columnHeights=[],this.pageHeights=[];var n=r.padding,s=r.titlePosition,l=0,h,c=0,u=this.arrowWidth,p=this.arrowHeight,f=this.isVertical&&!r.enablePages?p:0,g=this.isTitle&&s==="Top"?this.legendTitleSize.height+this.fivePixel:0;g=this.isTitle&&this.isVertical&&s!=="Top"?this.legendTitleSize.height+this.fivePixel:g,this.isVertical?c=r.width?0:e.width/100*5:l=r.height?0:e.height/100*5,i.height+=l,i.width+=c;var C=r.shapeWidth,L=r.shapePadding,D=0,R=0,B=0,H=0,j=0,W=0,ne=0,ie,me=!1;this.maxItemHeight=Math.max(Pt("MeasureText",r.textStyle).height,r.shapeHeight);for(var ve=0;ve<this.legendCollections.length;ve++)if(h=this.legendCollections[ve],uc.test(h.text)&&(h.text=Yg(h.text,uc)),Dg.test(h.text)&&(h.text=Yg(h.text,Dg)),ie={fill:h.fill,text:h.text,shape:h.shape,markerShape:h.markerShape,name:mg,cancel:!1},this.chart.trigger(mg,ie),h.render=!ie.cancel,h.text=ie.text,h.fill=ie.fill,h.shape=ie.shape,h.markerShape=ie.markerShape,h.textSize=Pt(h.text,r.textStyle),C=h.text?r.shapeWidth:0,L=h.text?r.shapePadding:0,h.render&&h.text){me=!0,B=C+L+(r.maximumLabelWidth?r.maximumLabelWidth:h.textSize.width)+n,R=R+B,!r.enablePages&&!this.isVertical&&(ne=this.isTitle&&s!=="Top"?this.legendTitleSize.width+this.fivePixel:0,ne+=u),this.getLegendHeight(h,r,i,R,this.maxItemHeight,n),(i.width<n+R+ne||this.isVertical)&&(D=Math.max(D,R+n+ne-(this.isVertical?0:B)),W===0&&B!==R&&(W=1),R=this.isVertical?0:B,W++,j=0,H=f);var Ee=W>0?W-1:0;this.rowHeights[Ee]=Math.max(this.rowHeights[Ee]?this.rowHeights[Ee]:0,h.textSize.height),this.columnHeights[j]=(this.columnHeights[j]?this.columnHeights[j]:0)+h.textSize.height+n,j++}H=Math.max.apply(null,this.columnHeights)+n+g,H=Math.max(H,this.maxItemHeight+n+n+g),this.isPaging=i.height<H,this.isPaging&&!r.enablePages&&(this.isVertical?H=H:H=this.maxItemHeight+n+n+(s==="Top"?g:0)),this.totalPages=W,!this.isPaging&&!this.isVertical&&(R+=this.isTitle&&s!=="Top"?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0),me?this.setBounds(Math.max(R+n,D),H,r,i):this.setBounds(0,0,r,i)},t.prototype.getLegendHeight=function(e,i,r,n,s,l){var h=e.textSize.width,c=i.shapePadding+l*2+i.shapeWidth;switch(i.textWrap){case"Wrap":case"AnyWhere":h>i.maximumLabelWidth||h+n>r.width?e.textCollection=yl(e.text,i.maximumLabelWidth?Math.min(i.maximumLabelWidth,r.width-c):r.width-c,i.textStyle):e.textCollection.push(e.text),e.textSize.height=s*e.textCollection.length;break}},t.prototype.getRenderPoint=function(e,i,r,n,s,l,h,c){var u=this.legend.padding,p=r+(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:n.textSize.width),f=n.location.x+(this.isRtlEnable?-p:p);this.isWithinBounds(f,(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:e.textSize.width)+r,s)||this.isVertical?(e.location.x=i.x,l!==h&&this.chartRowCount++,e.location.y=l===h?n.location.y:n.location.y+(this.isVertical?n.textSize.height:this.rowHeights[this.chartRowCount-2])+u):(e.location.x=l===h?n.location.x:f,e.location.y=n.location.y);var g=this.isRtlEnable?e.location.x-r+this.legend.shapeWidth/2-this.legendBounds.x:this.legendBounds.x+this.legendBounds.width-(e.location.x+r-this.legend.shapeWidth/2);g=this.legend.maximumLabelWidth?Math.min(this.legend.maximumLabelWidth,g):g,this.legend.textOverflow=="Ellipsis"&&this.legend.textWrap=="Normal"&&(e.text=Rn(+g.toFixed(4),e.text,this.legend.textStyle))},t.prototype.isWithinBounds=function(e,i,r){return this.isRtlEnable?e-i<r.x-this.legend.shapeWidth/2:e+i>r.x+r.width+this.legend.shapeWidth/2},t.prototype.LegendClick=function(e,i){var r=this.chart,n=r.legendSettings.mode==="Series"?e:0,s=this.isReverse?this.legendCollections.length-1-e:e,l=r.visibleSeries[n],h=this.legendCollections[s],c="isProtectedOnChange";if(r.legendSettings.mode==="Series"){var u={legendText:h.text,legendShape:h.shape,chart:r.isBlazor?{}:r,series:l,points:l.points,name:eo,cancel:!1};this.chart.trigger(eo,u),l.legendShape=u.legendShape,l.fill!==null&&(r.visibleSeries[e].interior=l.fill),r.legendSettings.toggleVisibility?(l.category==="TrendLine"?r.series[l.sourceIndex].trendlines[l.index].visible?r.series[l.sourceIndex].trendlines[l.index].visible=!1:r.series[l.sourceIndex].trendlines[l.index].visible=!0:(l.chart[c]=!0,this.changeSeriesVisiblity(l,l.visible)),h.visible=l.category==="TrendLine"?r.series[l.sourceIndex].trendlines[l.index].visible:l.visible,this.refreshLegendToggle(r,l)):r.highlightModule?r.highlightModule.legendSelection(r,e,i):r.selectionModule&&r.selectionModule.legendSelection(r,e,i),l.chart[c]=!1}else if(r.legendSettings.mode==="Point"){var p=l.points[e],u={legendText:h.text,legendShape:h.shape,chart:r.isBlazor?{}:r,series:l,points:[p],name:eo,cancel:!1};if(this.chart.trigger(eo,u),r.legendSettings.toggleVisibility){p.visible=!p.visible;var f=this.legendCollections[e];f.visible=p.visible,this.refreshLegendToggle(r,l)}}else if(r.legendSettings.mode==="Range"){for(var g=[],f=this.legendCollections[e],C=0,L=l.points;C<L.length;C++){var p=L[C];f.fill===(p.interior||l.interior)&&g.push(p)}var u={legendText:h.text,legendShape:h.shape,chart:r.isBlazor?{}:r,series:l,points:g,name:eo,cancel:!1};if(this.chart.trigger(eo,u),r.legendSettings.toggleVisibility){f.visible=!f.visible;for(var D=0,R=g;D<R.length;D++){var p=R[D];p.visible=!p.visible}this.refreshLegendToggle(r,l)}}},t.prototype.refreshLegendToggle=function(e,i){var r=[];if(e.selectionModule&&(r=(0,a.l7)([],e.selectionModule.selectedDataIndexes,null,!0)),e.svgObject.childNodes.length>0&&!e.enableAnimation&&!e.enableCanvas){for(;e.svgObject.lastChild;)e.svgObject.removeChild(e.svgObject.lastChild);(0,a.Od)(e.svgObject)}e.animateSeries=!1,e.redraw=e.enableAnimation,e.rotatedDataLabelCollections=[],ui(Nr(e.element.id+"_Secondary_Element").querySelectorAll(".ejSVGTooltip")[0]),Cc(e),this.redrawSeriesElements(i,e),e.removeSvg(),e.refreshAxis(),i.refreshAxisLabel(),this.refreshSeries(e.visibleSeries);for(var n=0,s=e.visibleSeries;n<s.length;n++){var l=s[n];(0,a.le)(l)||e.markerRender.removeHighlightedMarker(l,null,!0)}e.refreshBound(),e.trigger("loaded",{chart:e}),r.length>0&&(e.selectionModule.selectedDataIndexes=r,e.selectionModule.redrawSelection(e,e.selectionMode)),e.highlightModule&&e.highlightMode!=="None"&&e.highlightModule.redrawSelection(e,e.highlightMode),e.redraw=!1},t.prototype.changeSeriesVisiblity=function(e,i){e.visible=!i,this.isSecondaryAxis(e.xAxis)&&(e.xAxis.internalVisibility=e.xAxis.series.some(function(r){return r.visible})),this.isSecondaryAxis(e.yAxis)&&(e.yAxis.internalVisibility=e.yAxis.series.some(function(r){return r.visible}))},t.prototype.isSecondaryAxis=function(e){return this.chart.axes.indexOf(e)>-1},t.prototype.redrawSeriesElements=function(e,i){if(!i.redraw)return null;ui(i.element.id+"_Series_"+(e.index===void 0?e.category:e.index)+"_DataLabelCollections")},t.prototype.refreshSeries=function(e){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(n.type.indexOf("Spline")>-1){var s=n.type.indexOf("Area")>-1||n.drawType.indexOf("Area")>-1,l=n.type.indexOf("Range")>-1;this.chart["spline"+(s?l?"RangeArea":"Area":"")+"SeriesModule"].findSplinePoint(n)}n.position=void 0}},t.prototype.click=function(e){var i=this;if(!!this.chart.legendSettings.visible){for(var r=this.chart.mouseX,n=this.chart.mouseY,s=[],l=e.target.id,h=[this.legendID+"_text_",this.legendID+"_shape_marker_",this.legendID+"_shape_"],c,u=0,p=h;u<p.length;u++){var f=p[u];if(l.indexOf(f)>-1){c=parseInt(l.split(f)[1],10),this.LegendClick(c,e);break}}l.indexOf(this.legendID+"_pageup")>-1?this.changePage(e,!0):l.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(e,!1),this.chart.enableCanvas&&this.pagingRegions.length&&this.checkWithinBounds(r,n),s=this.legendRegions.filter(function(g){return sn(r,n+(i.isPaging?(i.currentPageNumber-1)*i.translatePage(i.chart.enableCanvas,null,1,2):0),g.rect)}),s.length&&this.chart.enableCanvas&&this.LegendClick(s[0].index,e)}},t.prototype.checkWithinBounds=function(e,i){var r=this.chart.renderer,n=this.legendBounds,s=this.chart.legendSettings.border.width,l=new ft(n.x,n.y,n.width,n.height);if(l.x=l.x-s/2,l.y=l.y-s/2,l.width=l.width+s,l.height=l.height+s,sn(e,i,this.pagingRegions[0]))return this.isRtlEnable?this.canvasPageUp(r,l,n):this.canvasPageDown(r,l,n),null;if(sn(e,i,this.pagingRegions[1]))return this.isRtlEnable?this.canvasPageDown(r,l,n):this.canvasPageUp(r,l,n),null},t.prototype.canvasPageDown=function(e,i,r){--this.currentPageNumber>0?(this.legendRegions=[],e.clearRect(i),e.canvasClip(new Sn("legendClipPath","transparent",{width:0,color:""},null,i)),this.renderLegend(this.chart,this.legend,r),e.canvasRestore()):++this.currentPageNumber},t.prototype.canvasPageUp=function(e,i,r){++this.currentPageNumber>0&&this.currentPageNumber<=this.totalNoOfPages?(this.legendRegions=[],e.clearRect(i),e.canvasClip(new Sn("legendClipPath","transpaent",{width:0,color:""},null,i)),this.renderLegend(this.chart,this.legend,r),e.canvasRestore()):--this.currentPageNumber},t.prototype.getModuleName=function(){return"Legend"},t.prototype.destroy=function(){this.removeEventListener()},t}(r0),z1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),_1=function(o){z1(t,o);function t(e){var i=o.call(this,e)||this;return i.element=i.chart.element,i.textStyle=e.tooltip.textStyle,i.control=e,i.template=e.tooltip.template,i}return t.prototype.getElement=function(e){return document.getElementById(e)},t.prototype.getTooltipElement=function(e){this.inverted=this.chart.requireInvertedAxis,this.header=this.control.tooltip.header===null?this.control.tooltip.shared?"<b>${point.x}</b>":"<b>${series.name}</b>":this.control.tooltip.header,this.formattedText=[];var i=document.getElementById(this.chart.element.id+"_tooltip"),r=this.chart.element.id.indexOf("stockChart")>-1;return!e&&!i||r?this.createElement():null},t.prototype.createElement=function(){var e=document.createElement("div");return e.id=this.element.id+"_tooltip",e.className="ejSVGTooltip",e.style.pointerEvents="none",e.style.position="absolute",e.style.zIndex="1",e},t.prototype.pushData=function(e,i,r,n){return e.series.enableTooltip?(n?this.currentPoints.push(e):this.currentPoints.push(e),this.stopAnimation(),r&&!document.getElementById(r.id)&&(this.chart.stockChart?document.getElementById(this.chart.stockChart.element.id+"_Secondary_Element").appendChild(r):document.getElementById(this.element.id+"_Secondary_Element").appendChild(r)),!0):!1},t.prototype.removeHighlight=function(){for(var e,i,r=0,n=this.previousPoints.length;r<n;r++){if(e=this.previousPoints[r],e.series.isRectSeries){e.series.visible&&this.highlightPoint(e.series,e.point.index,!1);continue}i=e.series}},t.prototype.highlightPoint=function(e,i,r){var n=this.getElement(this.element.id+"_Series_"+e.index+"_Point_"+i),s=this.control.accumulationSelectionModule,l=!!(s&&s.selectedDataIndexes.length>0);n&&(!l||l&&n.getAttribute("class")&&n.getAttribute("class").indexOf("_ej2_chart_selection_series_")===-1?this.chart.highlightColor!==""&&!(0,a.le)(this.chart.highlightColor)?n.setAttribute("fill",r?this.chart.highlightColor:e.pointColorMapping!==""?e.points[0].color:e.interior):n.setAttribute("opacity",(r?e.opacity/2:e.opacity).toString()):n.setAttribute("opacity",e.opacity.toString()))},t.prototype.highlightPoints=function(){for(var e=0,i=this.currentPoints;e<i.length;e++){var r=i[e];r.series.isRectSeries&&r.series.category==="Series"&&this.highlightPoint(r.series,r.point.index,!0)}},t.prototype.createTooltip=function(e,i,r,n,s,l,h,c,u,p,f,g){u===void 0&&(u=!1),p===void 0&&(p=null),f===void 0&&(f=null);var C=this.currentPoints[0].series,L=e.tooltipModule||e.accumulationTooltipModule;!L||r===null||(i?this.svgTooltip=new jw({opacity:e.tooltip.opacity,header:this.headerText,content:this.text,fill:e.tooltip.fill,border:e.tooltip.border,enableAnimation:e.tooltip.enableAnimation,location:r,shared:e.tooltip.shared,crosshair:u,shapes:l,clipBounds:this.chart.chartAreaType==="PolarRadar"?new Rt(0,0):n,areaBounds:c,palette:this.findPalette(),template:g||this.template,data:f,theme:e.theme,offset:h,textStyle:e.tooltip.textStyle,isNegative:C.isRectSeries&&C.type!=="Waterfall"&&s&&s.y<0,inverted:this.chart.requireInvertedAxis&&C.isRectSeries,arrowPadding:this.text.length>1||this.chart.stockChart?0:7,availableSize:e.availableSize,duration:this.chart.tooltip.duration,isCanvas:this.chart.enableCanvas,isTextWrap:e.tooltip.enableTextWrap&&e.getModuleName()==="chart",blazorTemplate:{name:"Template",parent:this.chart.tooltip},controlInstance:this.chart,enableRTL:e.enableRtl,controlName:"Chart",tooltipRender:function(){L.removeHighlight(),L.highlightPoints(),L.updatePreviousPoint(p)},animationComplete:function(D){D.tooltip.fadeOuted&&L.fadeOut(L.previousPoints)}},"#"+this.element.id+"_tooltip"):this.svgTooltip&&(this.svgTooltip.location=r,this.svgTooltip.content=this.text,this.svgTooltip.header=this.headerText,this.svgTooltip.offset=h,this.svgTooltip.palette=this.findPalette(),this.svgTooltip.shapes=l,this.svgTooltip.data=f,this.svgTooltip.template=this.template,this.svgTooltip.controlName="Chart",this.svgTooltip.crosshair=u,this.svgTooltip.textStyle=e.tooltip.textStyle,this.svgTooltip.isNegative=C.isRectSeries&&C.type!=="Waterfall"&&s&&s.y<0,this.svgTooltip.clipBounds=this.chart.chartAreaType==="PolarRadar"?new Rt(0,0):n,this.svgTooltip.arrowPadding=this.text.length>1||this.chart.stockChart?0:7,this.svgTooltip.dataBind()),this.chart.isReact&&this.chart.renderReactTemplates())},t.prototype.findPalette=function(){for(var e=[],i=0,r=this.currentPoints;i<r.length;i++){var n=r[i];e.push(this.findColor(n,n.series))}return e},t.prototype.findColor=function(e,i){return i.isRectSeries&&(i.type==="Candle"||i.type==="Hilo"||i.type==="HiloOpenClose")?e.point.color:(e.point.color&&e.point.color!=="#ffffff"?e.point.color:e.point.interior)||i.marker.fill||i.interior},t.prototype.updatePreviousPoint=function(e){e&&(this.currentPoints=this.currentPoints.concat(e)),this.previousPoints=(0,a.l7)([],this.currentPoints,null,!0)},t.prototype.fadeOut=function(e){var i=this.chart.enableCanvas?this.getElement(this.element.id+"_tooltip_group"):this.getElement(this.element.id+"_tooltip_svg"),r=i&&parseInt(i.getAttribute("opacity"),10)>0;r||(this.valueX=null,this.valueY=null,this.currentPoints=[],this.removeHighlight(),this.removeHighlightedMarker(e,!0),this.svgTooltip=null,this.control.trigger("animationComplete",{}))},t.prototype.removeHighlightedMarker=function(e,i){if(this.chart.markerRender)for(var r=0,n=e;r<n.length;r++){var s=n[r];ui(this.element.id+"_Series_"+s.series.index+"_Point_"+s.point.index+"_Trackball"),this.chart.markerRender.removeHighlightedMarker(s.series,s.point,i)}this.previousPoints=[]},t.prototype.removeText=function(){this.textElements=[];var e=this.getElement(this.element.id+"_tooltip_group");if(e&&e.childNodes.length>0)for(;e.lastChild&&e.childNodes.length!==1;)e.removeChild(e.lastChild)},t.prototype.stopAnimation=function(){Ug(this.toolTipInterval)},t.prototype.removeTooltip=function(e){var i=this,r=this.getElement(this.element.id+"_tooltip"),n=r?this.getElement(r.id+"parent_template"):null,s=n&&n.innerHTML!=="<div></div>";this.stopAnimation(),this.chart.isReact&&s&&this.chart.clearTemplate([n.id],[0]),r&&this.previousPoints.length>0&&(this.toolTipInterval=+setTimeout(function(){i.svgTooltip&&i.svgTooltip.fadeOut()},e))},t}(Md),j1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),W1=function(o){j1(t,o);function t(e){var i=o.call(this,e)||this;return i.accumulation=e,i.addEventListener(),i.template=i.accumulation.tooltip.template,i}return t.prototype.addEventListener=function(){this.accumulation.isDestroyed||(this.accumulation.on(a.AR.isPointer?"pointerleave":"mouseleave",this.mouseLeaveHandler,this),this.accumulation.on(a.AR.touchMoveEvent,this.mouseMoveHandler,this),this.accumulation.on(a.AR.touchEndEvent,this.mouseUpHandler,this))},t.prototype.mouseLeaveHandler=function(e){this.removeTooltip(this.accumulation.tooltip.fadeOutDuration)},t.prototype.mouseUpHandler=function(e){var i=this.accumulation;i.tooltip.enable&&i.isTouch&&sn(i.mouseX,i.mouseY,i.initialClipRect)&&(this.tooltip(e),this.removeTooltip(2e3))},t.prototype.mouseMoveHandler=function(e){var i=this.accumulation;i.tooltip.enable&&sn(i.mouseX,i.mouseY,i.initialClipRect)&&this.tooltip(e)},t.prototype.tooltip=function(e){var i=this.getElement(this.element.id+"_tooltip_svg"),r=i&&parseInt(i.getAttribute("opacity"),10)>0,n=this.getTooltipElement(r);this.renderSeriesTooltip(e,this.accumulation,!r,n)},t.prototype.renderSeriesTooltip=function(e,i,r,n){var s=this.getPieData(e,i,i.mouseX,i.mouseY),l=i.initialClipRect;if(this.currentPoints=[],s.point&&(!this.previousPoints[0]||this.previousPoints[0].point!==s.point)){if(this.previousPoints[0]&&s.point.index===this.previousPoints[0].point.index&&s.series.index===this.previousPoints[0].series.index)return null;this.pushData(s,r,n,!1)&&this.triggerTooltipRender(s,r,this.getTooltipText(s,i.tooltip),this.findHeader(s))}else!s.point&&this.isRemove&&(this.removeTooltip(this.accumulation.tooltip.fadeOutDuration),this.isRemove=!1)},t.prototype.triggerTooltipRender=function(e,i,r,n,s){var l=this;s===void 0&&(s=!0);var h,c={cancel:!1,name:bg,text:r,point:e.point,textStyle:this.textStyle,series:this.accumulation.isBlazor?{}:e.series,headerText:n,data:{pointX:e.point.x,pointY:e.point.y,seriesIndex:e.series.index,pointIndex:e.point.index,pointText:e.point.text,seriesName:e.series.name}},u=function(p){p.cancel?(l.removeHighlight(),(0,a.Od)(l.getElement(l.element.id+"_tooltip"))):(l.formattedText=l.formattedText.concat(p.text),l.text=l.formattedText,l.headerText=p.headerText,l.createTooltip(l.chart,i,e.point.symbolLocation,e.series.clipRect,e.point,["Circle"],0,l.chart.initialClipRect,!1,null,e.point,l.template?p.template:"")),l.isRemove=!0};u.bind(this,e),this.chart.trigger(bg,c,u)},t.prototype.getPieData=function(e,i,r,n){var s=e.target,l=mc(s.id,!0);if(!isNaN(l.series)){var h=l.series,c=l.point;if(!(0,a.le)(h)&&!isNaN(h)&&!(0,a.le)(c)&&!isNaN(c)){var u=this.getSeriesFromIndex(h,i.visibleSeries);if(u.enableTooltip)return new Kg(u.points[c],u)}}return new Kg(null,null)},t.prototype.getSeriesFromIndex=function(e,i){return i[0]},t.prototype.getTooltipText=function(e,i){var r=e.series,n=this.accumulation.useGroupingSeparator?"${point.x} : <b>${point.separatorY}</b>":"${point.x} : <b>${point.y}</b>";return n=i.format?i.format:n,this.parseTemplate(e.point,r,n)},t.prototype.findHeader=function(e){return this.header===""?"":(this.header=this.parseTemplate(e.point,e.series,this.header),this.header.replace(/<b>/g,"").replace(/<\/b>/g,"").trim()!==""?this.header:"")},t.prototype.parseTemplate=function(e,i,r){for(var n,s,l=0,h=Object.keys(e);l<h.length;l++){var c=h[l];n=new RegExp("${point."+c+"}","gm"),r=r.replace(n.source,e[c])}for(var u=0,p=Object.keys(Object.getPrototypeOf(i));u<p.length;u++){var c=p[u];n=new RegExp("${series."+c+"}","gm"),s=i[c],r=r.replace(n.source,s)}return r},t.prototype.getModuleName=function(){return"AccumulationTooltip"},t.prototype.destroy=function(e){},t}(_1),U1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),q1=function(o){U1(t,o);function t(e){var i=o.call(this,e)||this;if(i.rightSideRenderingPoints=[],i.leftSideRenderingPoints=[],i.id=e.element.id+"_datalabel_Series_",e.title){var r=Pt(e.title,e.titleStyle);i.titleRect=new ft(e.availableSize.width/2-r.width/2,e.margin.top,r.width,r.height)}return i}return t.prototype.getDataLabelPosition=function(e,i,r,n){var s=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],e):this.accumulation.pieSeriesModule.labelRadius:this.getLabelDistance(e,i);this.getLabelRegion(e,i.position,r,s,this.marginValue),e.labelAngle=e.midAngle,e.labelPosition=i.position,this.accumulation.enableSmartLabels&&this.getSmartLabel(e,i,r,n)},t.prototype.getLabelRegion=function(e,i,r,n,s,l){l===void 0&&(l=0);var h=l||e.midAngle,c=10,u=cr(h,n,this.isCircular()?this.center:this.getLabelLocation(e,i));u.y=i==="Inside"?u.y-r.height/2:u.y,u.x=i==="Inside"?u.x-r.width/2:u.x,e.labelRegion=new ft(u.x,u.y,r.width+s*2,r.height+s*2),i==="Outside"&&(e.labelRegion.y-=e.labelRegion.height/2,h>=90&&h<=270?e.labelRegion.x-=e.labelRegion.width+c:e.labelRegion.x+=c)},t.prototype.getSmartLabel=function(e,i,r,n){var s=this.isCircular(),l=s?this.radius:this.getLabelDistance(e,i),h=s?i.connectorStyle.length||"4%":"0px";l+=yi(h,l);var c=this.findPreviousPoint(n,e.index,e.labelPosition);if(i.position==="Inside"?(e.labelRegion.height-=4,e.labelRegion.width-=4,(c&&c.labelRegion&&(pr(e.labelRegion,c.labelRegion)||this.isOverlapping(e,n))||!s&&!xx(e.region,e.labelRegion))&&(e.labelPosition="Outside",s||(l=this.getLabelDistance(e,i)),this.getLabelRegion(e,e.labelPosition,r,l,this.marginValue),c=this.findPreviousPoint(n,e.index,e.labelPosition),c&&(pr(e.labelRegion,c.labelRegion)||this.isConnectorLineOverlapping(e,c))&&this.setOuterSmartLabel(c,e,i.border.width,l,r,this.marginValue))):c&&c.labelRegion&&(pr(e.labelRegion,c.labelRegion)||this.isOverlapping(e,n)||this.isConnectorLineOverlapping(e,c))&&this.setOuterSmartLabel(c,e,i.border.width,l,r,this.marginValue),this.isOverlapping(e,n)&&(this.accumulation.type==="Pyramid"||this.accumulation.type==="Funnel")){var u="OutsideLeft",p=10,f=e.midAngle||0,g=s?this.radius:this.getLabelDistance(e,i),C=cr(f,-g,this.isCircular()?this.center:this.getLabelLocation(e,u));e.labelRegion=new ft(C.x,C.y,r.width+this.marginValue*2,r.height+this.marginValue*2),e.labelRegion.y-=e.labelRegion.height/2,e.labelRegion.x=e.labelRegion.x-p-e.labelRegion.width,c&&c.labelRegion&&(pr(e.labelRegion,c.labelRegion)||this.isOverlapping(e,n)||this.isConnectorLineOverlapping(e,c))&&this.setOuterSmartLabel(c,e,i.border.width,g,r,this.marginValue)}},t.prototype.move=function(e,i,r,n){var s=this;if(e.target.textContent.indexOf("...")>-1){var l=e.target.id.split(this.id);if(l.length===2){var h=parseInt(l[1].split("_text_")[0],10),c=parseInt(l[1].split("_text_")[1],10);if(!isNaN(h)&&!isNaN(c)){n&&ui(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip");var u=T1(h,this.accumulation.visibleSeries).points[c];to(u.text||u.y.toString(),i,r,this.areaRect.width,this.accumulation.element.id+"_EJ2_Datalabel_Tooltip",xt(this.accumulation.element.id+"_Secondary_Element"))}}}else ui(this.accumulation.element.id+"_EJ2_Datalabel_Tooltip");n&&(clearTimeout(this.clearTooltip),this.clearTooltip=+setTimeout(function(){ui(s.accumulation.element.id+"_EJ2_Datalabel_Tooltip")},1e3))},t.prototype.findPreviousPoint=function(e,i,r){for(var n=e[0],s=i-1;s>=0;s--)if(n=e[s],n.visible&&n.labelVisible&&n.labelRegion&&n.labelPosition===r)return n;return null},t.prototype.isOverlapping=function(e,i){for(var r=e.index-1;r>=0;r--)if(i[r].visible&&i[r].labelVisible&&i[r].labelRegion&&e.labelRegion&&e.labelVisible&&pr(e.labelRegion,i[r].labelRegion))return!0;return!1},t.prototype.textTrimming=function(e,i,r,n){if(pr(e.labelRegion,i)){var s=e.labelRegion.width;n==="Right"?s=i.x-e.labelRegion.x:n==="Left"?(s=e.labelRegion.x-(i.x+i.width),s<0&&(s+=e.labelRegion.width,e.labelRegion.x=i.x+i.width)):n==="InsideRight"?s=i.x+i.width-e.labelRegion.x:n==="InsideLeft"?(s=e.labelRegion.x+e.labelRegion.width-i.x,s<e.labelRegion.width&&(e.labelRegion.x=i.x)):this.setPointVisibileFalse(e),e.labelVisible&&e.labelRegion&&(s<e.labelRegion.width&&(e.label=Rn(s-this.marginValue*2,e.label,r),e.labelRegion.width=s),e.label.length===3&&e.label.indexOf("...")>-1&&this.setPointVisibileFalse(e))}},t.prototype.setPointVisibileFalse=function(e){e.labelVisible=!1,e.labelRegion=null},t.prototype.setPointVisibleTrue=function(e){e.labelVisible=!0},t.prototype.setOuterSmartLabel=function(e,i,r,n,s,l){if(!this.isCircular())this.setSmartLabelForSegments(i,e);else{var h=this.getOverlappedAngle(e.labelRegion,i.labelRegion,i.midAngle,r*2);for(this.getLabelRegion(i,"Outside",s,n,l,h),h>i.endAngle&&(h=i.midAngle),i.labelAngle=h;i.labelVisible&&(pr(e.labelRegion,i.labelRegion)||h<=e.labelAngle||this.isConnectorLineOverlapping(i,e))&&!(h>i.endAngle);)i.labelAngle=h,this.getLabelRegion(i,"Outside",s,n,l,h),h+=.1}},t.prototype.setSmartLabelForSegments=function(e,i){var r=e.labelRegion,n=this.accumulation.type==="Funnel"?i.labelRegion.y-(r.y+r.height):e.labelRegion.y-(i.labelRegion.y+i.labelRegion.height);n<0&&(e.labelRegion.y+=this.accumulation.type==="Funnel"?n:-n)},t.prototype.isConnectorLineOverlapping=function(e,i){var r;!this.isCircular()&&e.labelRegion.x<e.region.x&&(r="outsideLeft");var n=this.getLabelLocation(e,r),s=new Rt(0,0);this.getEdgeOfLabel(e.labelRegion,e.labelAngle,s,0,e);var l=this.getLabelLocation(i),h=new Rt(0,0);return this.getEdgeOfLabel(i.labelRegion,i.labelAngle,h,0,e),this.isLineRectangleIntersect(n,s,e.labelRegion)||this.isLineRectangleIntersect(n,s,i.labelRegion)||this.isLineRectangleIntersect(l,h,e.labelRegion)},t.prototype.isLineRectangleIntersect=function(e,i,r){var n=[new Rt(Math.round(r.x),Math.round(r.y)),new Rt(Math.round(r.x+r.width),Math.round(r.y)),new Rt(Math.round(r.x+r.width),Math.round(r.y+r.height)),new Rt(Math.round(r.x),Math.round(r.y+r.height))];e.x=Math.round(e.x),e.y=Math.round(e.y),i.x=Math.round(i.x),i.y=Math.round(i.y);for(var s=0;s<n.length;s++)if(this.isLinesIntersect(e,i,n[s],n[(s+1)%n.length]))return!0;return!1},t.prototype.isLinesIntersect=function(e,i,r,n){var s=i.y-e.y,l=e.x-i.x,h=s*e.x+l*e.y,c=n.y-r.y,u=r.x-n.x,p=c*r.x+u*r.y,f=s*u-c*l;if(f!==0){var g=(u*h-l*p)/f,C=(s*p-c*h)/f,L=Math.min(e.x,i.x)<=g&&g<=Math.max(e.x,i.x);return L=L&&Math.min(e.y,i.y)<=C&&C<=Math.max(e.y,i.y),L=L&&Math.min(r.x,n.x)<=g&&g<=Math.max(r.x,n.x),L=L&&Math.min(r.y,n.y)<=C&&C<=Math.max(r.y,n.y),L}return!1},t.prototype.getOverlappedAngle=function(e,i,r,n){var s=e.x;return r>=90&&r<=270?(i.y=e.y-(n+i.height/2),s=e.x+e.width):i.y=e.y+e.height+n,hx(this.center,new Rt(s,i.y))},t.prototype.getConnectorPath=function(e,i,r,n){n===void 0&&(n=0);var s=r.connectorStyle,l=this.isCircular()?this.isVariousRadius()?this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],i):this.labelRadius:this.getLabelDistance(i,r),h=this.getConnectorStartPoint(i,s),c=this.accumulation.enableSmartLabels?i.midAngle:n||i.midAngle,u=new Rt(0,0),p=this.getEdgeOfLabel(e,c,u,s.width,i);if(s.type==="Curve")if(this.isCircular()){var f=l-(this.isVariousRadius()?yi(i.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius);return i.isLabelUpdated?u=this.getPerpendicularDistance(h,i):(u=cr(c,l-f/2,this.center),i.labelPosition==="Outside"&&r.position==="Inside"&&(u=cr(c,l-f*1.25,this.center))),"M "+h.x+" "+h.y+" Q "+u.x+" "+u.y+" "+p.x+" "+p.y}else return this.getPolyLinePath(h,p);else return"M "+h.x+" "+h.y+" L "+u.x+" "+u.y+" L "+p.x+" "+p.y},t.prototype.getPolyLinePath=function(e,i){var r=[e,i];if(e.y===i.y)return"M "+e.x+" "+e.y+" L "+i.x+" "+i.y;for(var n="M",s=0;s<=16;s++){var l=s/16,h=this.getBezierPoint(l,r,0,2);n+=h.x+","+h.y,s!==16&&(n+=" L")}return n},t.prototype.getBezierPoint=function(e,i,r,n){if(n===1)return i[r];var s=this.getBezierPoint(e,i,r,n-1),l=this.getBezierPoint(e,i,r+1,n-1),h=(s.x,s.x),c=(s.y,s.y),u=(l.x,l.x),p=(l.y,l.y),f=(1-e)*h+e*u,g=(1-e)*c+e*p;return s.x?{x:f,y:g}:{x:f,y:g}},t.prototype.getEdgeOfLabel=function(e,i,r,n,s){n===void 0&&(n=1);var l=new Rt(e.x,e.y);return i>=90&&i<=270?(l.x+=e.width+n/2,l.y+=e.height/2,r.x=l.x+10,r.y=l.y):s&&s.region&&s.region.x>s.labelRegion.x?(l.x+=n*2+e.width,l.y+=e.height/2,r.x=l.x+10,r.y=l.y):(l.x-=n/2,l.y+=e.height/2,r.x=l.x-10,r.y=l.y),l},t.prototype.getLabelDistance=function(e,i){if(e.labelPosition&&i.position!==e.labelPosition||i.connectorStyle.length){var r=yi(i.connectorStyle.length||"70px",this.accumulation.initialClipRect.width);if(r<this.accumulation.initialClipRect.width)return r}var n=e.labelPosition||i.position,s=this.accumulation.visibleSeries[0],l=(this.accumulation.initialClipRect.width-s.triangleSize.width)/2,h;switch(n){case"Inside":return 0;case"Outside":return h=e.symbolLocation.x+e.labelOffset.x,this.accumulation.initialClipRect.width-h-l}},t.prototype.getLabelLocation=function(e,i){if(i===void 0&&(i="Outside"),this.accumulation.type!=="Pie"){i=i==="OutsideLeft"?"OutsideLeft":e.labelPosition||i;var r={x:e.symbolLocation.x,y:e.symbolLocation.y-e.labelOffset.y};switch(i){case"Inside":r.y=e.region.y+e.region.height/2;break;case"Outside":r.x+=e.labelOffset.x;break;case"OutsideLeft":r.x-=e.labelOffset.x}return r}else return cr(e.midAngle,this.isVariousRadius()?yi(e.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius,this.center)},t.prototype.getConnectorStartPoint=function(e,i){var r;return!this.isCircular()&&e.region.x>e.labelRegion.x&&(r="OutsideLeft"),this.isCircular()?cr(e.midAngle,(this.isVariousRadius()?yi(e.sliceRadius,this.accumulation.pieSeriesModule.seriesRadius):this.radius)-i.width,this.center):this.getLabelLocation(e,r)},t.prototype.findAreaRect=function(){this.areaRect=new ft(0,0,this.accumulation.availableSize.width,this.accumulation.availableSize.height);var e=this.accumulation.margin;Dn(this.areaRect,new Mn(e.left,e.right,e.top,e.bottom))},t.prototype.renderDataLabel=function(e,i,r,n,s,l,h){var c=this.accumulation.element.id+"_datalabel_Series_"+s+"_",u=this.accumulation.renderer.createGroup({id:c+"g_"+e.index});e.label=e.originalText||e.y.toString();var p={width:i.border.width,color:i.border.color},f=(0,a.l7)({},(0,a.NA)("properties",i.font),null,!0),g={cancel:!1,name:lc,series:this.accumulation.visibleSeries[0],point:e,text:e.label,border:p,color:i.fill,template:i.template,font:f};this.accumulation.trigger(lc,g),e.argsData=g;var C=g.template!==null;e.labelVisible=!g.cancel,e.text=e.label=g.text,Number(e.label)&&(e.label=this.accumulation.intl.formatNumber(+e.label,{useGrouping:this.accumulation.useGroupingSeparator})),this.marginValue=g.border.width?5+g.border.width:1;var L=(0,a.az)("div",{id:this.accumulation.element.id+"_Series_"+0+"_DataLabel_"+e.index,styles:"position: absolute;background-color:"+g.color+";"+_g(i.font)+";border:"+g.border.width+"px solid "+g.border.color+";"});this.calculateLabelSize(C,L,e,n,g,u,c,i,h)},t.prototype.calculateLabelSize=function(e,i,r,n,s,l,h,c,u,p,f){var g=e?f?{width:p.width,height:p.height}:this.getTemplateSize(i,r,s,u,e,n,l,h,c):Pt(r.label,c.font);g.height+=4,g.width+=4,r.textSize=g,r.templateElement=i,this.getDataLabelPosition(r,c,g,n),r.labelRegion&&this.correctLabelRegion(r.labelRegion,r.textSize)},t.prototype.drawDataLabels=function(e,i,r,n,s){var l,h,c=e.leftSidePoints.concat(e.rightSidePoints);c.sort(function(ve,Ee){return ve.index-Ee.index}),e.type==="Pie"&&this.accumulation.enableSmartLabels&&this.extendedLabelsCalculation();for(var u=0,p=c;u<p.length;u++){var f=p[u];if(!(0,a.le)(f.argsData)&&!(0,a.le)(f.y)){this.finalizeDatalabels(f,c,i);var g=this.accumulation.element.id+"_datalabel_Series_"+0+"_",C=this.accumulation.renderer.createGroup({id:g+"g_"+f.index}),L=void 0,D=void 0,R=void 0;if(f.visible&&f.labelVisible){if(l=h=i.angle,f.argsData.template)this.setTemplateStyle(f.templateElement,f,n,i.font.color,f.color,s);else{D=new Rt(f.labelRegion.x+this.marginValue,f.labelRegion.y+f.textSize.height*3/4+this.marginValue),R=xt(g+"shape_"+f.index);var B=R?new Rt(+R.getAttribute("x"),+R.getAttribute("y")):null;L=this.accumulation.renderer.drawRectangle(new Sn(g+"shape_"+f.index,f.argsData.color,f.argsData.border,1,f.labelRegion,i.rx,i.ry)),Nt(!1,C,L,s,!0,"x","y",B,null,!1,!1,null,this.accumulation.duration);var H=f.textSize.width,j=f.textSize.height,W=void 0;l!==0&&i.enableRotation?(f.labelPosition==="Outside"?h=0:f.midAngle>=90&&f.midAngle<=270?h=f.midAngle+180:h=f.midAngle,W="rotate("+h+","+(D.x+H/2)+","+(D.y-j/4)+")"):(l?h=l>360?l-360:l<-360?l+360:l:h=0,W="rotate("+h+","+(D.x+H/2)+","+D.y+")"),f.transform=W,mr(this.accumulation.renderer,new fr(g+"text_"+f.index,D.x,D.y,this.accumulation.enableRtl?"end":"start",f.label,W,"auto",h),f.argsData.font,f.argsData.font.color||this.getSaturatedColor(f,f.argsData.color),C,!1,s,!0,!1,this.accumulation.duration),R=null}if(this.accumulation.accumulationLegendModule&&this.accumulation.legendSettings.visible&&(i.position==="Outside"||this.accumulation.enableSmartLabels)&&this.accumulation.visibleSeries[0].findMaxBounds(this.accumulation.visibleSeries[0].labelBound,f.labelRegion),f.labelPosition==="Outside"){var ne=xt(g+"connector_"+f.index),ie=ne?ne.getAttribute("d"):"",me=this.accumulation.renderer.drawPath(new er(g+"connector_"+f.index,"transparent",i.connectorStyle.width,i.connectorStyle.color||f.color,1,i.connectorStyle.dashArray,this.getConnectorPath((0,a.l7)({},f.labelRegion,null,!0),f,i,f.labelAngle)));Nt(!1,C,me,s,!0,null,null,null,ie,!1,!1,null,this.accumulation.duration)}Nt(!1,r,C,s)}}}},t.prototype.finalizeDatalabels=function(e,i,r){if((this.isOverlapping(e,i)||this.titleRect&&e.labelRegion&&pr(e.labelRegion,this.titleRect))&&this.isCircular()&&e.labelPosition==="Outside"&&this.setPointVisibileFalse(e),this.accumulation.accumulationLegendModule&&this.accumulation.legendSettings.visible&&e.labelVisible&&e.labelRegion){var n=this.accumulation.accumulationLegendModule.legendBounds;this.accumulation.visibleSeries[0].type!="Pie"&&this.accumulation.legendSettings.position=="Left"&&r.position==="Outside"&&(e.labelRegion.x=e.labelRegion.x+n.width);var s=this.accumulation.legendSettings.border.width/2;this.textTrimming(e,new ft(n.x-s,n.y-s,n.width+2*s,n.height+2*s),r.font,this.accumulation.accumulationLegendModule.position)}if(e.labelVisible&&e.labelRegion){var l=this.isCircular()?e.labelRegion.x>=this.center.x?"InsideRight":"InsideLeft":e.labelRegion.x>=e.region.x?"InsideRight":"InsideLeft";this.textTrimming(e,this.areaRect,r.font,l)}e.labelVisible&&e.labelRegion&&(e.labelRegion.y+e.labelRegion.height>this.areaRect.y+this.areaRect.height||e.labelRegion.y<this.areaRect.y||e.labelRegion.x<this.areaRect.x||e.labelRegion.x+e.labelRegion.width>this.areaRect.x+this.areaRect.width)&&this.setPointVisibileFalse(e)},t.prototype.getTemplateSize=function(e,i,r,n,s,l,h,c,u){e=zg(e,i.index,r.template,this.accumulation,i,this.accumulation.visibleSeries[0],this.accumulation.element.id+"_DataLabel",0,r,s,l,h,c,u,n);var p=jg(e,n);return{width:p.width,height:p.height}},t.prototype.setTemplateStyle=function(e,i,r,n,s,l){if(e.style.left=i.labelRegion.x+"px",e.style.top=i.labelRegion.y+"px",e.style.color=n||this.getSaturatedColor(i,s),this.accumulation.isBlazor){var h=this.isCircular()?i.labelRegion.x>=this.center.x?"InsideRight":"InsideLeft":i.labelRegion.x>=i.region.x?"InsideRight":"InsideLeft";h==="InsideRight"?e.style.transform="translate(0%, -50%)":e.style.transform="translate(-100%, -50%)"}e.childElementCount&&(Nt(!1,r,e,l,!0,"left","top"),this.doTemplateAnimation(this.accumulation,e))},t.prototype.getSaturatedColor=function(e,i){var r;this.marginValue>=1?r=i==="transparent"?this.getLabelBackground(e):i:r=this.getLabelBackground(e),r=r==="transparent"?this.accumulation.theme.indexOf("Dark")>-1?"black":"white":r;var n=bc(Zr(r)),s=Math.round((n.r*299+n.g*587+n.b*114)/1e3);return s>=128?"black":"white"},t.prototype.doTemplateAnimation=function(e,i){var r=e.visibleSeries[0],n=r.animation.delay+r.animation.duration;r.animation.enable&&e.animateSeries&&(i.style.visibility="hidden",kd(i,n,200,"ZoomIn"))},t.prototype.getLabelBackground=function(e){return e.labelPosition==="Outside"?this.accumulation.background||this.accumulation.themeStyle.background:e.y?e.color:this.accumulation.theme.indexOf("dark")?"white":"black"},t.prototype.correctLabelRegion=function(e,i,r){r===void 0&&(r=4),e.height-=r,e.width-=r,e.x+=r/2,e.y+=r/2,i.height-=r,i.width-=r},t.prototype.getModuleName=function(){return"AccumulationDataLabel"},t.prototype.destroy=function(){},t.prototype.extendedLabelsCalculation=function(){var e=this,i=this.accumulation.series[0];i.rightSidePoints.forEach(function(r,n,s){r.initialLabelRegion=r.labelRegion,r.isLabelUpdated=0,e.skipPoints(r,s,n)}),i.leftSidePoints.forEach(function(r,n,s){r.initialLabelRegion=r.labelRegion,r.isLabelUpdated=0,e.skipPoints(r,s,n)}),this.arrangeLeftSidePoints(i),this.isIncreaseAngle=!1,this.arrangeRightSidePoints(i)},t.prototype.arrangeRightSidePoints=function(e){var i,r,n=e.rightSidePoints.filter(function(f){return f.labelVisible&&f.labelPosition==="Outside"});this.rightSideRenderingPoints=n;var s,l,h=n[n.length-1],c;h&&h.labelAngle>90&&h.labelAngle<270&&(this.isIncreaseAngle=!0,this.changeLabelAngle(h,89));for(var u=n.length-1;u>=0;u--)if(l=n[u],c=n[u+1],this.isOverlapWithNext(l,n,u)&&l.labelVisible||!(l.labelAngle<=90||l.labelAngle>=270))if(s=h.labelAngle+10,r=!0,i?this.isIncreaseAngle=!1:s>90&&s<270&&c.isLabelUpdated&&(this.isIncreaseAngle=!0),this.isIncreaseAngle)for(var p=u+1;p>0;p--)this.decreaseAngle(n[p],n[p-1],e,!0);else for(var p=u+1;p<n.length;p++)this.increaseAngle(n[p-1],n[p],e,!0);else r&&c&&!c.isLabelUpdated&&(i=!0)},t.prototype.arrangeLeftSidePoints=function(e){var i=this,r=e.leftSidePoints.filter(function(p){return p.labelVisible&&p.labelPosition==="Outside"});this.leftSideRenderingPoints=r;for(var n,s,l,h,c=0;c<r.length;c++)if(s=r[c],n=r[c-1],this.isOverlapWithPrevious(s,r,c)&&s.labelVisible||!(s.labelAngle<270))if(l=!0,h&&(this.isIncreaseAngle=!1),this.isIncreaseAngle)for(var u=c;u<r.length;u++)this.increaseAngle(r[u-1],r[u],e,!1);else for(var u=c;u>0;u--)this.decreaseAngle(r[u],r[u-1],e,!1),r.filter(function(p,f){p.isLabelUpdated&&r[f].labelAngle-10<100&&(i.isIncreaseAngle=!0)});else l&&n&&n.isLabelUpdated&&(h=!0)},t.prototype.decreaseAngle=function(e,i,r,n){if((0,a.le)(e)||(0,a.le)(i))return null;var s=1;if(n)for(;pr(e.labelRegion,i.labelRegion)||!this.isVariousRadius()&&!(i.labelRegion.height+i.labelRegion.y<e.labelRegion.y);){var l=i.midAngle-s;if(l<0&&(l=360+l),l<=270&&l>=90){l=270,this.isIncreaseAngle=!0;break}this.changeLabelAngle(i,l),s++}else for(e.labelAngle>270&&(this.changeLabelAngle(e,270),i.labelAngle=270);pr(e.labelRegion,i.labelRegion)||!this.isVariousRadius()&&e.labelRegion.y+e.labelRegion.height>i.labelRegion.y;){var l=i.midAngle-s;if(!(l<=270&&l>=90)){l=90,this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(i,l),pr(e.labelRegion,i.labelRegion)&&!r.leftSidePoints.indexOf(i)&&l-1<90&&l-1>270){this.changeLabelAngle(e,e.labelAngle+1),this.arrangeLeftSidePoints(r);break}s++}},t.prototype.increaseAngle=function(e,i,r,n){if((0,a.le)(e)||(0,a.le)(i))return null;var s=1;if(n)for(;pr(e.labelRegion,i.labelRegion)||!this.isVariousRadius()&&!(e.labelRegion.y+e.labelRegion.height<i.labelRegion.y);){var l=i.midAngle+s;if(l<270&&l>90){l=90,this.isIncreaseAngle=!0;break}if(this.changeLabelAngle(i,l),pr(e.labelRegion,i.labelRegion)&&l+1>90&&l+1<270&&this.rightSideRenderingPoints.indexOf(i)===this.rightSideRenderingPoints.length-1){this.changeLabelAngle(e,e.labelAngle-1),i.labelRegion=i.initialLabelRegion,this.arrangeRightSidePoints(r);break}s++}else for(;pr(e.labelRegion,i.labelRegion)||!this.isVariousRadius()&&e.labelRegion.y<i.labelRegion.y+i.labelRegion.height;){var l=i.midAngle+s;if(!(l<270&&l>90)){l=270,this.isIncreaseAngle=!1;break}this.changeLabelAngle(i,l),s++}},t.prototype.changeLabelAngle=function(e,i){var r=this.accumulation.series[0].dataLabel,n;this.isVariousRadius()&&(n=this.accumulation.pieSeriesModule.getLabelRadius(this.accumulation.visibleSeries[0],e));var s=e.labelPosition==="Outside"&&this.accumulation.enableSmartLabels&&r.position==="Inside"?this.radius+yi(r.connectorStyle.length||"4%",this.accumulation.pieSeriesModule.size/2):this.isVariousRadius()?n:this.accumulation.pieSeriesModule.labelRadius+10,l=this.isVariousRadius()?n:s;this.getLabelRegion(e,"Outside",e.textSize,l,this.marginValue,i),e.isLabelUpdated=1,e.labelAngle=i},t.prototype.isOverlapWithPrevious=function(e,i,r){for(var n=0;n<r;n++)if(n!==i.indexOf(e)&&i[n].visible&&i[n].labelVisible&&i[n].labelRegion&&e.labelRegion&&e.labelVisible&&pr(e.labelRegion,i[n].labelRegion))return!0;return!1},t.prototype.isOverlapWithNext=function(e,i,r){for(var n=r;n<i.length;n++)if(n!==i.indexOf(e)&&i[n].visible&&i[n].labelVisible&&i[n].labelRegion&&e.labelRegion&&e.labelVisible&&pr(e.labelRegion,i[n].labelRegion))return!0;return!1},t.prototype.skipPoints=function(e,i,r){if(r>0&&(e.midAngle<285&&e.midAngle>255||e.midAngle<105&&e.midAngle>75)){var n=i[r-1],s=e.endAngle%360-e.startAngle%360,l=n.endAngle%360-n.startAngle%360;l<=s&&s<5&&n.labelVisible&&this.setPointVisibleTrue(e)}else if(r>1&&(e.midAngle<300&&e.midAngle>240||e.midAngle<120&&e.midAngle>60)){var h=i[r-1],c=i[r-2],s=e.endAngle%360-e.startAngle%360,l=h.endAngle%360-h.startAngle%360,u=c.endAngle%360-c.startAngle%360;s<3&&l<3&&u<3&&h.labelVisible&&e.labelVisible&&this.setPointVisibleTrue(e)}},t.prototype.getPerpendicularDistance=function(e,i){var r,n=10,s=n+10*Math.sin(i.midAngle*Math.PI/360);return i.midAngle>270&&i.midAngle<360?r=new Rt(e.x+s*Math.cos((360-i.midAngle)*Math.PI/180),e.y-s*Math.sin((360-i.midAngle)*Math.PI/180)):i.midAngle>0&&i.midAngle<90?r=new Rt(e.x+s*Math.cos(i.midAngle*Math.PI/180),e.y+s*Math.sin(i.midAngle*Math.PI/180)):i.midAngle>0&&i.midAngle<90?r=new Rt(e.x-s*Math.cos((i.midAngle-90)*Math.PI/180),e.y+s*Math.sin((i.midAngle-90)*Math.PI/180)):r=new Rt(e.x-s*Math.cos((i.midAngle-180)*Math.PI/180),e.y-s*Math.sin((i.midAngle-180)*Math.PI/180)),r},t}($d),Z1=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Y1=function(o){Z1(t,o);function t(e){var i=o.call(this,e)||this;return i.library=i,i.titleRect=new ft(0,e.margin.top,0,0),i.addEventListener(),i}return t.prototype.addEventListener=function(){this.chart.isDestroyed||(this.chart.on(a.AR.touchMoveEvent,this.mouseMove,this),this.chart.on(a.AR.touchEndEvent,this.mouseEnd,this),this.chart.on("click",this.click,this))},t.prototype.removeEventListener=function(){this.chart.isDestroyed||(this.chart.off(a.AR.touchMoveEvent,this.mouseMove),this.chart.off("click",this.click),this.chart.off(a.AR.touchEndEvent,this.mouseEnd))},t.prototype.mouseMove=function(e){this.chart.legendSettings.visible&&!this.chart.isTouch&&this.chart.accumulationHighlightModule&&this.chart.highlightMode!=="None"&&this.click(e)},t.prototype.mouseEnd=function(e){this.chart.legendSettings.visible&&this.chart.isTouch&&this.move(e)},t.prototype.getLegendOptions=function(e,i){this.legendCollections=[],this.isRtlEnable=e.enableRtl,this.isReverse=!this.isRtlEnable&&e.legendSettings.reverse;for(var r=0;r<1;r++){var n=i[r].type;(n==="Pie"||n==="Doughnut")&&(n=i[r].innerRadius!=="0"&&i[r].innerRadius!=="0%"?"Doughnut":"Pie");for(var s=0,l=i[r].points;s<l.length;s++){var h=l[s];!(0,a.le)(h.x)&&!(0,a.le)(h.y)&&this.legendCollections.push(new ro(h.x.toString(),h.color,i[r].legendShape,h.visible,n,h.legendImageUrl,null,null,h.index,i[r].index))}this.isReverse&&this.legendCollections.reverse()}},t.prototype.getLegendBounds=function(e,i,r){this.calculateLegendTitle(r,i),this.isTitle=!!r.title;var n=0,s=0,l;this.chartRowCount=1,this.rowHeights=[],this.columnHeights=[],this.pageHeights=[];var h=r.padding,c=r.titlePosition,u=0,p=this.arrowWidth,f=r.enablePages?0:this.arrowHeight;this.isVertical?n=r.width?0:e.width/100*5:s=r.height?0:e.height/100*5,i.width+=n,i.height+=s;var g=r.shapePadding,C=r.maximumLabelWidth?r.maximumLabelWidth:0,L=r.shapeWidth,D=0,R=0,B=0,H=[],j=[],W=0,ne=0,ie=0,me=0,ve=0;this.maxItemHeight=Math.max(Pt("MeasureText",r.textStyle).height,r.shapeHeight);for(var Ee,le=!1,de=0;de<this.legendCollections.length;de++)if(l=this.legendCollections[de],Ee={fill:l.fill,text:l.text,shape:l.shape,name:"legendRender",cancel:!1},this.chart.trigger("legendRender",Ee),l.render=!Ee.cancel,l.text=Ee.text.indexOf("&")>-1?this.convertHtmlEntities(Ee.text):Ee.text,l.fill=Ee.fill,l.shape=Ee.shape,l.textSize=Pt(l.text,r.textStyle),l.render&&l.text!=="")if(le=!0,me=L+g+(r.maximumLabelWidth?r.maximumLabelWidth:l.textSize.width)+h,this.getLegendHeight(l,r,i,D,this.maxItemHeight,h),this.isVertical)ie+=l.textSize.height+h,ie+h+f>i.height&&(D=D+C,W=this.getPageWidth(j),this.totalPages=Math.max(B,this.totalPages||1),D-W+me>i.width?(j.push(D-W),B=this.rowHeights.length,ne=B):B=ne,H.push(C),C=0,ie=l.textSize.height+h,l.textSize.height+h,R++),this.columnHeights[R]=(this.columnHeights[R]?this.columnHeights[R]:0)+l.textSize.height+h,C=Math.max(me,C),this.rowHeights[B]=Math.max(this.rowHeights[B]?this.rowHeights[B]:0,l.textSize.height),B++;else{r.enablePages||(u=this.isTitle&&c!=="Top"?this.legendTitleSize.width+this.fivePixel:0,u+=p),D=D+me,i.width<h+D+u&&(C=Math.max(C,D+h+u-me),B===0&&me!==D&&(B=1),D=me,B++,R=0);var fe=B&&B-1;this.rowHeights[fe]=Math.max(this.rowHeights[fe]?this.rowHeights[fe]:0,l.textSize.height),this.columnHeights[R]=(this.columnHeights[R]?this.columnHeights[R]:0)+l.textSize.height+h,R++}ve=c==="Top"?this.legendTitleSize.height:0,this.isVertical?(D=D+C,this.isPaging=i.width<D+h,ie=Math.max.apply(null,this.columnHeights)+h+f+ve,ie=Math.max(ie,(this.totalPages||1)*(this.maxItemHeight+h)+h+f),this.isPaging=this.isPaging&&this.totalPages>1,H.push(C)):(this.totalPages=this.totalRowCount=B,ie=Math.max.apply(null,this.columnHeights)+h+f+ve,this.isPaging=i.height<ie,ie=!r.enablePages&&this.isPaging?this.maxItemHeight+h+h+ve:ie,ie=Math.max(ie,this.maxItemHeight+h+h+ve),this.isPaging||(D+=this.isTitle&&c!=="Top"?this.fivePixel+this.legendTitleSize.width+this.fivePixel:0)),this.maxColumns=0;var Le=this.isVertical?this.getMaxColumn(H,i.width,h,D+h):Math.max(D+h,C);le?this.setBounds(Le,ie,r,i):this.setBounds(0,0,r,i)},t.prototype.getPageWidth=function(e){for(var i=0,r=0;r<e.length;r++)i+=e[r];return i},t.prototype.getLegendHeight=function(e,i,r,n,s,l){var h=e.textSize.width,c=i.shapePadding+l*2+i.shapeWidth;switch(i.textWrap){case"Wrap":case"AnyWhere":h>i.maximumLabelWidth||h+n>r.width?e.textCollection=yl(e.text,i.maximumLabelWidth?Math.min(i.maximumLabelWidth,r.width-c):r.width-c,i.textStyle):e.textCollection.push(e.text),e.textSize.height=s*e.textCollection.length;break}},t.prototype.convertHtmlEntities=function(e){var i=e.replace("&amp;","&").replace("&lt;","<").replace("&gt;",">").replace("&quot;",'"').replace("&nbsp;"," ").replace("&cent;","\xA2").replace("&pound;","\xA3").replace("&yen;","\xA5").replace("&euro;","\u20AC").replace("&copy;","\xA9").replace("&reg;","\xAE");return i=i.replace("&#38;","&").replace("&#60;","<").replace("&#62;",">").replace("&#34;",'"').replace("&#160;"," ").replace("&#162;","\xA2").replace("&#163;","\xA3").replace("&#165;","\xA5").replace("&#8364;","\u20AC").replace("&#169;","\xA9").replace("&#174;","\xAE"),i},t.prototype.getMaxColumn=function(e,i,r,n){var s=r;this.maxColumnWidth=Math.max.apply(null,e);for(var l=0,h=e;l<h.length;l++){var c=h[l];if(s+=this.maxColumnWidth,this.maxColumns++,s+r>i){s-=this.maxColumnWidth,this.maxColumns--;break}}this.isPaging=s<n&&this.totalPages>1,s===r&&(s=i),this.maxColumns=Math.max(1,this.maxColumns),this.maxWidth=s;var u=this.maxColumnWidth+r,p=0,f=this.columnHeights.length;if(this.isPaging&&this.isVertical){for(var g=1;g<f;g++)u+=this.maxColumnWidth+r,u>i&&(this.pageHeights.push(p!=g-1?Math.max.apply(null,this.columnHeights.slice(p,g-1)):this.columnHeights[p]),u=this.maxColumnWidth+r,p=g);this.pageHeights.push(p!=f-1?Math.max.apply(null,this.columnHeights.slice(p,f-1)):this.columnHeights[p]),this.totalPages=this.pageHeights.length}return s},t.prototype.getAvailWidth=function(e,i){return this.isVertical&&(i=this.maxWidth),i-(this.legend.padding*2+this.legend.shapeWidth+this.legend.shapePadding)},t.prototype.getRenderPoint=function(e,i,r,n,s,l,h){var c=this.legend.padding,u=n.location.y+this.maxItemHeight/4+(n.textCollection.length>0?(n.textCollection.length-1)*this.maxItemHeight:0);if(this.isVertical)if(l===h||u+e.textSize.height+c>s.y+s.height){e.location.x=n.location.x+(l===h?0:this.isRtlEnable?-this.maxColumnWidth:this.maxColumnWidth),e.location.y=i.y;var p=this.legend.shapeWidth/2+c;this.pageXCollections.push(e.location.x+(this.isRtlEnable?p:-p))}else e.location.x=n.location.x,e.location.y=n.location.y+n.textSize.height+c;else{var f=r+(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:n.textSize.width),g=n.location.x+(this.isRtlEnable?-f:f);this.isWithinBounds(g,(this.legend.maximumLabelWidth?this.legend.maximumLabelWidth:e.textSize.width)+r,s,this.legend.shapeWidth/2)?(l!==h&&this.chartRowCount++,e.location.y=l===h?n.location.y:n.location.y+this.rowHeights[this.chartRowCount-2]+c,e.location.x=i.x):(e.location.y=n.location.y,e.location.x=l===h?n.location.x:g)}var C=this.getAvailWidth(e.location.x,this.legendBounds.width);C=this.legend.maximumLabelWidth?Math.min(this.legend.maximumLabelWidth,C):C,this.legend.textOverflow=="Ellipsis"&&this.legend.textWrap=="Normal"&&(e.text=Rn(+C.toFixed(4),e.text,this.legend.textStyle))},t.prototype.isWithinBounds=function(e,i,r,n){return this.isRtlEnable?e-i<r.x-n:e+i>r.x+r.width+n},t.prototype.getSmartLegendLocation=function(e,i,r){var n;switch(this.position){case"Left":n=(e.x-i.width-r.left)/2,i.x=e.x-i.width<r.left?i.x:e.x-i.width-n;break;case"Right":n=(this.chart.availableSize.width-r.right-(e.x+e.width+i.width))/2,i.x=e.x+e.width+i.width>this.chart.availableSize.width-r.right?i.x:e.x+e.width+n;break;case"Top":this.getTitleRect(this.chart),n=(e.y-i.height-(this.titleRect.y+this.titleRect.height))/2,i.y=e.y-i.height<r.top?i.y:e.y-i.height-n;break;case"Bottom":n=(this.chart.availableSize.height-r.bottom-(e.y+e.height+i.height))/2,i.y=e.y+e.height+i.height>this.chart.availableSize.height-r.bottom?i.y:e.y+e.height+n;break}},t.prototype.getTitleRect=function(e){if(!e.title)return null;var i=Pt(e.title,e.titleStyle);this.titleRect=new ft(e.availableSize.width/2-i.width/2,e.margin.top,i.width,i.height)},t.prototype.legendByIndex=function(e,i){for(var r=0,n=i;r<n.length;r++){var s=n[r];if(s.pointIndex===e)return s}return null},t.prototype.click=function(e){var i=e.target.id,r=this.chart,n=[this.legendID+"_text_",this.legendID+"_shape_",this.legendID+"_shape_marker_"];if(this.chart.accumulationSelectionModule)var s=(0,a.l7)([],this.chart.accumulationSelectionModule.selectedDataIndexes,null,!0);this.chart.animateSeries=!1;for(var l=0,h=n;l<h.length;l++){var c=h[l];if(i.indexOf(c)>-1){var u=parseInt(i.split(c)[1],10);if(this.chart.legendSettings.toggleVisibility&&!isNaN(u)){var p=this.chart.visibleSeries[0],f=H0(u,p.points),g=this.legendByIndex(u,this.legendCollections);f.visible=!f.visible,g.visible=f.visible,p.sumOfPoints+=f.visible?f.y:-f.y,r.redraw=r.enableAnimation,this.sliceVisibility(u,f.visible),r.removeSvg(),Cc(r),this.chart.refreshPoints(p.points),this.chart.renderElements()}else this.chart.accumulationSelectionModule&&!isNaN(u)?this.chart.accumulationSelectionModule.legendSelection(this.chart,0,u,e):this.chart.accumulationHighlightModule&&!isNaN(u)&&this.chart.accumulationHighlightModule.legendSelection(this.chart,0,u,e)}}i.indexOf(this.legendID+"_pageup")>-1?this.changePage(e,!0):i.indexOf(this.legendID+"_pagedown")>-1&&this.changePage(e,!1),r.redraw=!1},t.prototype.sliceVisibility=function(e,i){var r=this.chart.element.id+"_Series_0_Point_";this.chart.visibleSeries[0].dataLabel.visible&&(r=this.chart.element.id+"_datalabel_Series_0_",this.sliceAnimate(xt(r+"g_"+e),i))},t.prototype.sliceAnimate=function(e,i){if(!e)return null;new a.fw({}).animate(e,{duration:300,delay:0,name:i?"FadeIn":"FadeOut",end:function(r){r.element.style.visibility=i?"visible":"hidden"}})},t.prototype.getModuleName=function(){return"AccumulationLegend"},t.prototype.destroy=function(){this.removeEventListener()},t}(r0),Pc=ae(34819),G1=function(){function o(t){this.errorHeight=0,this.chart=t}return o.prototype.initPrivateVariables=function(t,e){var i="",r="",n=t.chart.renderer,s=t.index===void 0?t.category:t.index;t.chart.chartAreaType==="Cartesian"&&(i="translate("+t.clipRect.x+","+t.clipRect.y+")",r="url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+s+")"),e.dataLabel.visible&&(t.shapeElement=n.createGroup({id:this.chart.element.id+"ShapeGroup"+s,transform:i,"clip-path":"url(#"+this.chart.element.id+"_ChartSeriesClipRect_"+s+")"}),t.textElement=n.createGroup({id:this.chart.element.id+"TextGroup"+s,transform:i,"clip-path":r})),this.markerHeight=t.type==="Scatter"||e.visible?e.height/2:0,this.commonId=this.chart.element.id+"_Series_"+s+"_Point_",this.calculateErrorHeight(t,t.marker.dataLabel.position),this.chartBackground=this.chart.chartArea.background==="transparent"?this.chart.background||this.chart.themeStyle.background:this.chart.chartArea.background},o.prototype.calculateErrorHeight=function(t,e){if(t.errorBar.visible)if(t.errorBar.visible&&this.chart.chartAreaType!=="PolarRadar"){var i=t.errorBar.direction,r=this.chart.errorBarModule.positiveHeight,n=this.chart.errorBarModule.negativeHeight;this.isRectSeries(t)?((e==="Top"||e==="Auto")&&(i==="Both"||i==="Minus"?this.errorHeight=n:this.errorHeight=0),(e==="Outer"||e==="Auto")&&(i==="Both"||i==="Plus"?this.errorHeight=r:this.errorHeight=0)):((e==="Top"||e==="Outer"||e==="Auto")&&((i==="Both"||i==="Plus")&&!t.chart.isTransposed?this.errorHeight=r:this.errorHeight=0),(e==="Bottom"||e==="Auto")&&(i==="Both"||i==="Minus"?this.errorHeight=n:this.errorHeight=0))}else this.errorHeight=0;else return null},o.prototype.isRectSeries=function(t){return t.isRectSeries||t.type==="RangeArea"||t.type==="SplineRangeArea"},o.prototype.render=function(t,e,i){this.initPrivateVariables(t,t.marker);var r,n={x:0,y:0},s,l,h,c,u,p,f;this.inverted=e.requireInvertedAxis,this.yAxisInversed=t.yAxis.isAxisInverse;for(var g=e.redraw,C=!1,L=[],D=e.element.id+"_Series_"+(t.index===void 0?t.category:t.index)+"_DataLabelCollections",R=(0,a.az)("div",{id:D}),B=ua(t),H,j,W,ne=0;ne<B.length;ne++){if(H=B[ne],!i.showZero&&(H.y!==0||H.y===0&&t.emptyPointSettings.mode==="Zero"))return null;this.margin=i.margin;var ie=[],me=void 0,ve=void 0,Ee=void 0,le=void 0,de=void 0,fe=!0,Le=t.clipRect,ke=void 0;C=!1,p=f=i.angle,c={width:i.border.width,color:i.border.color};var Me=(0,a.l7)({},(0,a.NA)("properties",i.font),null,!0);if(H.symbolLocations.length&&H.symbolLocations[0]||t.type==="BoxAndWhisker"&&H.regions.length){ie=wx(H,t,e),me=ie.length;for(var De=0;De<me;De++)if(h={cancel:!1,name:lc,series:t,point:H,text:ie[De],border:c,color:i.fill,template:i.template,font:Me,location:n,textSize:Pt(ie[De],i.font)},e.trigger(lc,h),!h.cancel)if(this.fontBackground=h.color,this.isDataLabelShape(h),this.markerHeight=t.type==="Bubble"?H.regions[0].height/2:this.markerHeight,h.template!==null)this.createDataLabelTemplate(R,t,i,H,h,De,g);else{if(u=Pt(h.text,i.font),r=this.calculateTextPosition(H,t,u,i,De),e.chartAreaType==="PolarRadar")for(var Fe=0,Pe=e.chartAxisLayoutPanel.visibleAxisLabelRect;Fe<Pe.length;Fe++){var Ye=Pe[Fe];if(pr(new ft(r.x,r.y,r.width,r.height),Ye)){fe=!1;break}}var Ze=new ft(r.x+Le.x,r.y+Le.y,r.width,r.height);if(i.enableRotation){var nt=this.getRectanglePoints(r);if(j=r.x+r.width/2,W=r.y+r.height/2,L=Ng(nt,j,W,p),C=this.isDataLabelOverlapWithChartBound(L,e,Le),!C){this.chart.rotatedDataLabelCollections.push(L);for(var it=this.chart.rotatedDataLabelCollections.length-1,et=it;et>=0;et--)if(this.chart.rotatedDataLabelCollections[it]&&this.chart.rotatedDataLabelCollections[et-1]&&Bg(this.chart.rotatedDataLabelCollections[it],this.chart.rotatedDataLabelCollections[et-1])){C=!0,this.chart.rotatedDataLabelCollections[it]=null;break}}}else C=ml(this.chart.chartAreaType!=="PolarRadar"&&t.type.indexOf("Stacking")>-1?new ft(r.x-10,r.y,r.width,r.height):r,e.dataLabelCollections,Le);if((!C||i.labelIntersectAction==="None")&&fe){e.dataLabelCollections.push(Ze),this.isShape&&(ke=e.renderer.drawRectangle(new Sn(this.commonId+H.index+"_TextShape_"+De,h.color,h.border,i.opacity,r,i.rx,i.ry),new Int32Array([Le.x,Le.y])),t.shapeElement&&t.shapeElement.appendChild(ke));var at=this.fontBackground==="transparent"?this.chart.theme.indexOf("Dark")>-1?"black":"white":this.fontBackground;s=bc(Zr(at)),l=Math.round((s.r*299+s.g*587+s.b*114)/1e3),ve=r.x+this.margin.left+u.width/2+n.x,Ee=r.y+this.margin.top+u.height*3/4+n.y,n={x:0,y:0},p!==0&&i.enableRotation?(le=j,de=W,f=p>360?p-360:p<-360?p+360:p):(f=0,le=r.x,de=r.y),mr(e.renderer,new fr(this.commonId+H.index+"_Text_"+De,ve,Ee,"middle",h.text,"rotate("+f+","+le+","+de+")","auto",f),h.font,h.font.color||(l>=128||t.type==="Hilo"?"black":"white"),t.textElement,!1,g,!0,!1,t.chart.duration,t.clipRect,null,null,e.enableCanvas)}}}}R.childElementCount&&(e.enableCanvas?xt(e.element.id+"_Secondary_Element").appendChild(R):Nt(e.enableCanvas,xt(e.element.id+"_Secondary_Element"),R,e.redraw,!1,"x","y",null,"",!1,!1,null,e.duration))},o.prototype.getRectanglePoints=function(t){var e=new Rt(t.x,t.y),i=new Rt(t.x+t.width,t.y),r=new Rt(t.x+t.width,t.y+t.height),n=new Rt(t.x,t.y+t.height);return[e,i,r,n]},o.prototype.isDataLabelOverlapWithChartBound=function(t,e,i){for(var r=0;r<t.length;r++)if(!sn(t[r].x+i.x,t[r].y+i.y,e.initialClipRect))return!0;return!1},o.prototype.createDataLabelTemplate=function(t,e,i,r,n,s,l){this.margin={left:0,right:0,bottom:0,top:0};var h=e.clipRect,c=zg((0,a.az)("div",{id:this.chart.element.id+"_Series_"+(e.index===void 0?e.category:e.index)+"_DataLabel_"+r.index+(s?"_"+s:""),styles:"position: absolute;background-color:"+n.color+";"+_g(i.font)+";border:"+n.border.width+"px solid "+n.border.color+";"}),r.index,n.template,this.chart,r,e,this.chart.element.id+"_DataLabel",s);this.calculateTemplateLabelSize(t,c,r,e,i,s,h,l)},o.prototype.calculateTemplateLabelSize=function(t,e,i,r,n,s,l,h,c){var u=jg(e,h,c),p=this.calculateTextPosition(i,r,{width:u.width,height:u.height},n,s),f=0,g=0,C=!1;c&&(C=u.width===0||u.height===0),e.style.left=(this.chart.chartAreaType==="PolarRadar"?0:r.clipRect.x)+p.x-f+"px",e.style.top=(this.chart.chartAreaType==="PolarRadar"?0:r.clipRect.y)+p.y+g+"px";var L=this.fontBackground==="transparent"?this.chart.theme.indexOf("Dark")>-1?"black":"white":this.fontBackground,D=bc(Zr(L)),R=r.chart.requireInvertedAxis?r.xAxis:r.yAxis,B=r.chart.requireInvertedAxis?r.yAxis:r.xAxis;e.style.color=n.font.color||(Math.round((D.r*299+D.g*587+D.b*114)/1e3)>=128?"black":"white"),e.childElementCount&&!C&&(!ml(p,this.chart.dataLabelCollections,l)||n.labelIntersectAction==="None")&&(r.seriesType!=="XY"||i.yValue===void 0||pa(i.yValue,r.yAxis.visibleRange)||r.type.indexOf("Stacking")>-1||r.type.indexOf("100")>-1&&pa(r.stackedValues.endValues[i.index],r.yAxis.visibleRange))&&pa(i.xValue,r.xAxis.visibleRange)&&parseFloat(e.style.top)>=R.rect.y&&parseFloat(e.style.left)>=B.rect.x&&parseFloat(e.style.top)<=R.rect.y+R.rect.height&&parseFloat(e.style.left)<=B.rect.x+B.rect.width&&(this.chart.dataLabelCollections.push(new ft(p.x+l.x,p.y+l.y,p.width,p.height)),Nt(this.chart.enableCanvas,t,e,h,!0,"left","top"),r.animation.enable&&this.chart.animateSeries&&!this.chart.enableCanvas?this.doDataLabelAnimation(r,e):this.chart.enableCanvas&&t.appendChild(e))},o.prototype.calculateTextPosition=function(t,e,i,r,n){var s=n>1&&e.type==="Candle"?t.regions[1]:t.regions[0];n>1&&e.type==="HiloOpenClose"&&(s=n===2?t.regions[1]:t.regions[2]);var l;l=this.getLabelLocation(t,e,i,n);var h=5,c=e.clipRect;if(!this.chart.requireInvertedAxis||!this.isRectSeries(e)||e.type==="BoxAndWhisker"){this.locationX=l.x;var u=i.height+this.borderWidth*2+this.markerHeight+this.margin.bottom+this.margin.top+h;l.y=r.position==="Auto"?l.y:this.calculateAlignment(u,l.y,r.alignment,this.isRectSeries(e)?t.yValue<0:!1),l.y=!this.isRectSeries(e)||e.type==="BoxAndWhisker"?this.calculatePathPosition(l.y,r.position,e,t,i,n):this.calculateRectPosition(l.y,s,t.yValue<0!==this.yAxisInversed,r.position,e,i,n,t),this.isRectSeries(e)&&this.chart.chartAreaType==="PolarRadar"&&(l=this.calculatePolarRectPosition(l,r.position,e,t,i,n,r.alignment,u))}else{this.locationY=l.y;var u=i.width+this.borderWidth+this.margin.left+this.margin.right-h;l.x=r.position==="Auto"?l.x:this.calculateAlignment(u,l.x,r.alignment,t.yValue<0)+(this.chart.chartAreaType!=="PolarRadar"&&e.type.indexOf("Stacking")>-1&&t.yValue===0?h:0),l.x=this.calculateRectPosition(l.x,s,t.yValue<0!==this.yAxisInversed,r.position,e,i,n,t)}var p=yc(l,i,this.margin);!(r.enableRotation===!0&&r.angle!==0)&&!(p.y>c.y+c.height||p.x>c.x+c.width||p.x+p.width<0||p.y+p.height<0)&&(p.x=p.x<0?h:p.x,p.y=p.y<0&&r.labelIntersectAction!=="None"?h:p.y,p.x-=p.x+p.width>c.x+c.width?p.x+p.width-(c.x+c.width)+h:0,p.y-=p.y+p.height>c.y+c.height?p.y+p.height-(c.y+c.height)+h:0,this.fontBackground=this.fontBackground==="transparent"?this.chartBackground:this.fontBackground);var f;return this.inverted&&e.isRectSeries&&p.x+p.width>s.x+s.width&&(f=!0),this.fontBackground=f?this.chartBackground:this.fontBackground,p},o.prototype.calculatePolarRectPosition=function(t,e,i,r,n,s,l,h){var c=5,u,p=this.chart.availableSize.width,f=l==="Center"?0:l==="Far"?1:-1,g=r.regionData.startAngle-.5*Math.PI+(r.regionData.endAngle-r.regionData.startAngle)/2;return s===0?u=r.regionData.radius<r.regionData.innerRadius?r.regionData.innerRadius:r.regionData.radius:u=r.regionData.radius>r.regionData.innerRadius?r.regionData.innerRadius:r.regionData.radius,this.fontBackground=this.fontBackground==="transparent"?this.chartBackground:this.fontBackground,i.drawType.indexOf("Stacking")>-1?e=e==="Outer"?"Top":e:i.drawType.indexOf("Range")>-1&&(e=e==="Outer"||e==="Top"?e:"Auto"),e==="Outer"?u=s===0?u+2*c+this.markerHeight:u-2*c-this.markerHeight:e==="Middle"?(u=u/2+c,i.drawType==="StackingColumn"&&(u=r.regionData.innerRadius+(r.regionData.radius-r.regionData.innerRadius)/2+c-n.height/2)):e==="Top"?u=s===0?u-2*c-this.markerHeight:u+2*c+this.markerHeight:e==="Bottom"?(u=2*c,u+=i.drawType==="StackingColumn"?r.regionData.innerRadius+this.markerHeight:0):s===0?u=u>=i.chart.radius?u-c:i.drawType==="StackingColumn"?u-2*c:u+2*c:u=u>=i.chart.radius?u+c:u-2*c,u+=h*f,t.x=i.clipRect.width/2+i.clipRect.x+u*Math.cos(g),i.drawType==="StackingColumn"?t.x=t.x<p/2?t.x+n.width/2:t.x>p/2?t.x-n.width/2:t.x:i.drawType==="Column"&&(t.x=t.x<p/2?t.x-n.width/2:t.x>p/2?t.x+n.width/2:t.x),t.y=i.clipRect.height/2+i.clipRect.y+u*Math.sin(g),t},o.prototype.getLabelLocation=function(t,e,i,r){var n=new Rt(0,0),s=e.type==="Candle"&&r>1?t.regions[1]:t.regions[0];e.type==="HiloOpenClose"&&(s=r===2?t.regions[1]:t.regions[2]);var l=e.xAxis,h=e.yAxis,c=e.chart.requireInvertedAxis;if(e.type==="BoxAndWhisker"){switch(this.markerHeight=0,r){case 0:n=Ar(t.xValue,t.median,l,h,c);break;case 1:n=Ar(t.xValue,t.maximum,l,h,c);break;case 2:n=Ar(t.xValue,t.minimum,l,h,c);break;case 3:n=Ar(t.xValue,t.upperQuartile,l,h,c);break;case 4:n=Ar(t.xValue,t.lowerQuartile,l,h,c);break;default:{n=Ar(t.xValue,t.outliers[r-5],l,h,c),this.markerHeight=e.marker.height/2;break}}c?n.y=t.regions[0].y+t.regions[0].height/2:n.x=t.regions[0].x+t.regions[0].width/2}else r===0||r===1?n=new Rt(t.symbolLocations[0].x,t.symbolLocations[0].y):(r===2||r===3)&&e.type==="Candle"?n=new Rt(t.symbolLocations[1].x,t.symbolLocations[1].y):c?n={x:s.x+s.width/2,y:s.y}:n={x:s.x+s.width,y:s.y+s.height/2};if(r>1&&e.type==="HiloOpenClose")if(e.chart.requireInvertedAxis){var u=s.height;n.y=s.y+u/2+2*(r===2?1:-1)}else{var p=s.width;n.x=s.x+p/2+2*(r===2?1:-1)}return n},o.prototype.calculateRectPosition=function(t,e,i,r,n,s,l,h){if(n.chart.chartAreaType==="PolarRadar")return null;var c=5,u=this.margin,p=this.inverted?s.width:s.height,f=this.borderWidth+p/2+(r!=="Outer"&&n.type.indexOf("Column")>-1&&Math.abs(e.height-s.height)<c?0:c);switch(n.type==="StackingColumn100"||n.type==="StackingBar100"?r=r==="Outer"?"Top":r:n.type.indexOf("Range")>-1?r=r==="Outer"||r==="Top"?r:"Auto":n.type==="Waterfall"&&(r=r==="Auto"?"Middle":r),r){case"Bottom":t=this.inverted?i?t+e.width-f-u.left:t-e.width+f+u.right:i?t-e.height+f+u.top:t+e.height-f-u.bottom;break;case"Middle":t=t=this.inverted?i?t+e.width/2:t-e.width/2:i?t-e.height/2:t+e.height/2;break;case"Auto":t=this.calculateRectActualPosition(t,e,i,n,s,l,h);break;default:f+=this.errorHeight,t=this.calculateTopAndOuterPosition(t,e,r,n,l,f,i);break}var g=this.inverted?t<e.x||t>e.x+e.width:t<e.y||t>e.y+e.height;this.fontBackground=g?this.fontBackground==="transparent"?this.chartBackground:this.fontBackground:this.fontBackground==="transparent"?h.color||n.interior:this.fontBackground;var C=n.chart.series.length;if(r==="Outer"&&n.type.indexOf("Stacking")>-1&&C-1>n.index){for(var L=void 0,D=void 0,R=n.index+1;R<C;R++)if(L=n.chart.series[R],D=L.points[h.index],L.type.indexOf("Stacking")>-1&&L.type.indexOf("100")===-1){this.fontBackground=D&&(D.yValue<0&&h.yValue<0||D.yValue>0&&h.yValue>0)?D?D.color:L.interior:this.fontBackground;break}}return t},o.prototype.calculatePathPosition=function(t,e,i,r,n,s){var l=5;switch(i.type.indexOf("Area")>-1&&i.type!=="RangeArea"&&i.type!=="SplineRangeArea"&&this.yAxisInversed&&i.marker.dataLabel.position!=="Auto"&&(e=e==="Top"?"Bottom":e==="Bottom"?"Top":e),this.fontBackground=this.fontBackground==="transparent"?this.chartBackground:this.fontBackground,e){case"Top":case"Outer":t=t-this.markerHeight-this.borderWidth-n.height/2-this.margin.bottom-l-this.errorHeight;break;case"Bottom":t=t+this.markerHeight+this.borderWidth+n.height/2+this.margin.top+l+this.errorHeight;break;case"Auto":t=this.calculatePathActualPosition(t,this.markerHeight,i,r,n,s);break}return t},o.prototype.isDataLabelShape=function(t){this.isShape=t.color!=="transparent"||t.border.width>0,this.borderWidth=t.border.width,this.isShape||(this.margin={left:0,right:0,bottom:0,top:0})},o.prototype.calculateRectActualPosition=function(t,e,i,r,n,s,l){for(var h,c,u=!0,p=0,f=this.chart.dataLabelCollections,g=r.type.indexOf("Range")!==-1||r.type==="Hilo"?2:4;u&&p<g;){var C=this.getPosition(p);r.type.indexOf("Stacking")>-1&&C==="Outer"&&(C="Top",p++),h=this.calculateRectPosition(t,e,i,C,r,n,s,l),this.inverted?(c=yc(new Rt(h,this.locationY),n,this.margin),u=c.x<0||ml(c,f,r.clipRect)||c.x+c.width>r.clipRect.width):(c=yc(new Rt(this.locationX,h),n,this.margin),u=c.y<0||ml(c,f,r.clipRect)||c.y>r.clipRect.height),p++}return h},o.prototype.calculateAlignment=function(t,e,i,r){switch(i){case"Far":e=this.inverted?r?e-t:e+t:r?e+t:e-t;break;case"Near":e=this.inverted?r?e+t:e-t:r?e-t:e+t;break;case"Center":e=e;break}return e},o.prototype.calculateTopAndOuterPosition=function(t,e,i,r,n,s,l){var h=this.margin,c;switch(r.type){case"RangeColumn":case"RangeArea":case"SplineRangeArea":case"Hilo":c=n===0&&!this.yAxisInversed||n===1&&this.yAxisInversed,t=this.updateLabelLocation(i,t,s,h,e,c);break;case"Candle":c=(n===0||n===2)&&!this.yAxisInversed||(n===1||n===3)&&this.yAxisInversed,t=this.updateLabelLocation(i,t,s,h,e,c,n>1);break;case"HiloOpenClose":n<=1?(c=n===0&&!this.yAxisInversed||n===1&&this.yAxisInversed,t=this.updateLabelLocation(i,t,s,h,e,c)):this.yAxisInversed?t=this.inverted?t-s-h.right:t+s+h.top:t=this.inverted?t+s+h.left:t-s-h.bottom;break;default:l&&i==="Top"||!l&&i==="Outer"?t=this.inverted?t+s+h.left+this.markerHeight:t-s-h.bottom-this.markerHeight:t=this.inverted?t-s-h.right-this.markerHeight:t+s+h.top+this.markerHeight;break}return t},o.prototype.updateLabelLocation=function(t,e,i,r,n,s,l){return l===void 0&&(l=!1),this.inverted?s?e=t==="Outer"&&!l?e+i+r.left+this.markerHeight:e-i-r.right-this.markerHeight:e=t==="Outer"&&!l?e-n.width-i-r.right-this.markerHeight:e-n.width+i+r.left+this.markerHeight:s?e=t==="Outer"&&!l?e-i-r.bottom-this.markerHeight:e+i+r.top+this.markerHeight:e=t==="Outer"&&!l?e+n.height+i+r.top+this.markerHeight:e+n.height-i-r.bottom-this.markerHeight,e},o.prototype.calculatePathActualPosition=function(t,e,i,r,n,s){var l=i.points,h=r.index,c=l[h].yValue,u,p=l.length-1>h?l[h+1]:null,f=h>0?l[h-1]:null,g,C=!0,L,D,R,B=this.chart.dataLabelCollections;if(i.type==="Bubble")u="Top";else if(i.type.indexOf("Step")>-1)u="Top",h&&(u=!f||!f.visible||c>f.yValue!==this.yAxisInversed||c===f.yValue?"Top":"Bottom");else if(i.type==="BoxAndWhisker")s===1||s===3||s>4?u=i.yAxis.isAxisInverse?"Bottom":"Top":s===2||s===4?u=i.yAxis.isAxisInverse?"Top":"Bottom":(C=!1,u="Middle",g=this.calculatePathPosition(t,u,i,r,n,s));else if(h===0)u=!p||!p.visible||c>p.yValue||c<p.yValue&&this.yAxisInversed?"Top":"Bottom";else if(h===l.length-1)u=!f||!f.visible||c>f.yValue||c<f.yValue&&this.yAxisInversed?"Top":"Bottom";else if(!p.visible&&!(f&&f.visible))u="Top";else if(!p.visible||!f)u=p.yValue>c||f&&f.yValue>c?"Bottom":"Top";else{var H=(p.yValue-f.yValue)/2,j=H*h+(p.yValue-H*(h+1));u=this.yAxisInversed?j<c?"Bottom":"Top":j<c?"Top":"Bottom"}for(D=u==="Bottom",R=["Outer","Top","Bottom","Middle","Auto"].indexOf(u);C&&R<4;)g=this.calculatePathPosition(t,this.getPosition(R),i,r,n,s),L=yc(new Rt(this.locationX,g),n,this.margin),C=L.y<0||ml(L,B,i.clipRect)||L.y+L.height>i.clipRect.height,R=D?R-1:R+1,D=!1;return g},o.prototype.doDataLabelAnimation=function(t,e){for(var i=t.shapeElement.childNodes,r=t.textElement.childNodes,n=t.animation.delay+t.animation.duration,s=t.chart.animated?t.chart.duration:200,l,h=e?1:r.length,c,u=0;u<h;u++)c=r[u],e?(e.style.visibility="hidden",kd(e,n,s,"ZoomIn")):(l=new Rt(+c.getAttribute("x")+ +c.getAttribute("width")/2,+c.getAttribute("y")+ +c.getAttribute("height")/2),fl(c,n,s,t,null,l,!0),i[u]&&(c=i[u],l=new Rt(+c.getAttribute("x")+ +c.getAttribute("width")/2,+c.getAttribute("y")+ +c.getAttribute("height")/2),fl(c,n,s,t,null,l,!0)))},o.prototype.getPosition=function(t){return["Outer","Top","Bottom","Middle","Auto"][t]},o.prototype.getModuleName=function(){return"DataLabel"},o.prototype.destroy=function(){},o}();Xd.Inject(o1,R1,h1,b1,u1,P1,B1,F1),Xd.Inject(S1,v1,V1,Lo,G1),z0.Inject(V0,W1,q1,Y1);var Qd=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(pe.hAg,this.initiateChartHandler,this),this.parent.on(E.tB,this.refreshChartCellObj,this),this.parent.on(pe.Ll5,this.updateChartHandler,this),this.parent.on(E.k0,this.deleteChart,this),this.parent.on(E.gs,this.clearBorder,this),this.parent.on(E.jh,this.insertChartHandler,this),this.parent.on(E.uU,this.chartRangeHandler,this),this.parent.on(E.dG,this.chartDesignTabHandler,this),this.parent.on(E.x3,this.updateChartElement,this),this.parent.on(E.o,this.undoRedoForChartDesign,this)},o.prototype.insertChartHandler=function(t){var e="Column";switch(t.id){case"clusteredColumn":e="Column";break;case"stackedColumn":e="StackingColumn";break;case"stackedColumn100":e="StackingColumn100";break;case"clusteredBar":e="Bar";break;case"stackedBar":e="StackingBar";break;case"stackedBar100":e="StackingBar100";break;case"area":e="Area";break;case"stackedArea":e="StackingArea";break;case"stackedArea100":e="StackingArea100";break;case"line":e="Line";break;case"stackedLine":e="StackingLine";break;case"stackedLine100":e="StackingLine100";break;case"pie":e="Pie";break;case"doughnut":e="Doughnut";break;case"scatter":e="Scatter";break}var i=[{type:e}];t.isChart?this.parent.notify(pe.UyC,{chart:i}):this.parent.notify(E.dG,{chartType:e,triggerEvent:!0})},o.prototype.chartRangeHandler=function(){var t=document.querySelector(".e-datavisualization-chart.e-ss-overlay-active");if(t)for(var e=t.getElementsByClassName("e-control")[0].id,i=this.parent.chartColl,r=i.length,n=0;n<r;n++){var s=document.getElementById(i[n].id);t&&s&&i[n].id===e&&this.parent.notify(pe.hAg,{option:i[n],chartCount:this.parent.chartCount,isRefresh:!0})}},o.prototype.getPropertyValue=function(t,e,i){var r=(0,w.$Su)(t,e,(0,w.zfV)(this.parent,i));if(r){var n=void 0;if(r.format){var s={value:r.value,format:r.format,onLoad:!0,formattedText:r.value,isRightAlign:!1,cell:r,rowIndex:t.toString(),colIndex:e.toString()};if(this.parent.notify(pe.eYQ,s),typeof s.value=="number"){var l=new RegExp(`[!@#$%^&()+=';,{}|":<>~_-]`,"g");s.formattedText=s.formattedText.toString().replace(l,""),n=parseInt(s.formattedText.toString(),10)}else n=s.formattedText&&s.formattedText.toString()}else n=r.value;return(0,a.le)(n)?"":n}else return""},o.prototype.updateChartHandler=function(t){var e=this.initiateChartHandler({option:t.chart,isRefresh:!0}),i=this.parent.element.querySelector("."+t.chart.id);if(i){var r=(0,a.Xr)(i,"chart");(0,a.le)(r)&&(r=(0,a.Xr)(i,"accumulationchart")),r.series=e,r.refresh()}},o.prototype.refreshChartCellObj=function(t){var e=(0,a.o8)(t.sheetIdx)?this.parent.activeSheetIndex:t.sheetIdx,i=(0,w.zfV)(this.parent,e),r=(0,w.$Su)(t.prevRowIdx,t.prevColIdx,i),n=(0,w.$Su)(t.currentRowIdx,t.currentColIdx,i),s=r?r.chart:[],l,h,c=s&&s.length?s.length:0;if(r&&r.chart){for(var u=0;u<c;u++)if(s[u].id===t.id.split("_overlay")[0]){l=s[u],l.height=t.currentHeight,l.width=t.currentWidth,l.top=t.currentTop,l.left=t.currentLeft,s.splice(u,1);for(var p=0,f=this.parent.chartColl.length;p<f;p++)l.id===this.parent.chartColl[p].id&&(l.height=t.currentHeight,this.parent.chartColl[p].width=t.currentWidth,this.parent.chartColl[p].top=t.currentTop,this.parent.chartColl[p].left=t.currentLeft)}if(n&&n.chart&&(h=n.chart,l&&h.push(l)),h?(0,w.Jxt)(t.currentRowIdx,t.currentColIdx,i,{chart:h},!0):(0,w.Jxt)(t.currentRowIdx,t.currentColIdx,i,{chart:[l]},!0),t.requestType==="chartRefresh"&&!t.isUndoRedo){var g={requestType:"chartRefresh",currentRowIdx:t.currentRowIdx,currentColIdx:t.currentColIdx,currentWidth:t.currentWidth,prevHeight:t.prevHeight,prevWidth:t.prevWidth,prevRowIdx:t.prevRowIdx,prevColIdx:t.prevColIdx,prevTop:t.prevTop,prevLeft:t.prevLeft,currentTop:t.currentTop,currentLeft:t.currentLeft,currentHeight:t.currentHeight,id:t.id,sheetIdx:e};this.parent.notify("actionComplete",{eventArgs:g,action:"chartRefresh"})}}},o.prototype.processChartRange=function(t,e,i){var r,n,s,l=t[0],h=t[1],c=!1,u=t[2],p=t[3],f=l===u,g=h===p,C=this.getPropertyValue(l,p,e),L=this.getPropertyValue(u,h,e),D=this.getPropertyValue(l,h,e);return(!(0,pe.hj$)(L)||!D)&&(c=!0),(0,a.le)(D)&&!f&&!g||i.type==="Scatter"&&t[3]-t[1]==1?(r=[l+1,h,u,h],n=[l+1,h+1,u,p],s=[l,h+1,l,p]):!(0,a.le)(L)&&c&&!f&&!g?!(0,a.le)(C)&&(!(0,pe.hj$)(C)||!D)?(r=[l+1,h,u,h],n=[l+1,h+1,u,p],s=[l,h+1,l,p]):(r=[l,h,u,h],n=[l,h+1,u,p]):(n=[l,h,u,p],!(0,a.le)(C)&&!(0,pe.hj$)(C)&&!(0,pe.v9)(C)?(s=[l,h,l,p],n[0]=n[0]+1):(0,a.le)(D)&&(f||g)&&(s=[l,h,l,p],f?(n[1]=n[1]+1,s[3]=s[1]):n[0]=n[0]+1)),{xRange:r,yRange:n,lRange:s}},o.prototype.toIntrnlRange=function(t,e){return t?typeof t=="string"&&(t=pe.dK5[t]):t=pe.dK5[this.parent.sheets[e].selectedRange],t},o.prototype.getRangeData=function(t){t.range=this.toIntrnlRange(t.range,t.sheetIdx);var e=[],i=[];return this.pushRowData(t,t.range[0],t.range[1],t.range[2],t.range[3],i,e,!0,t.isYvalue),i},o.prototype.pushRowData=function(t,e,i,r,n,s,l,h,c){for(var u=i,p=this.parent.sheets[t.sheetIdx],f;e<=r;){if((0,w.gSQ)(p,e)){e++;continue}for(i=u;i<=n;){if((0,w.NqJ)(p,i)){i++;continue}var g=(0,w.$Su)(e,i,p,!1,!0);if(g.format&&!c){var C={value:g.value,format:g.format,onLoad:!0,formattedText:g.value,rowIndex:e.toString(),colIndex:i.toString(),isRightAlign:!1,cell:g};this.parent.notify(pe.eYQ,C),f=C.formattedText?C.formattedText.toString():""}else f=g.value||(g.value===0?0:"");s.push({value:f}),i++}e++}l.push(e)},o.prototype.toArrayData=function(t){for(var e="value",i,r=0,n=[],s=t.length;r<s;)i=t[r],Object.keys(i).length?e in i&&n.push(i[e]):n.push(""),r++;return n},o.prototype.getVirtualXValues=function(t){for(var e=1,i=[];e<t;)i.push(e.toString()),e++;return i},o.prototype.processChartSeries=function(t,e,i,r,n){t=t||{};var s="",l={},h,c,u,p,f,g={},C,L=0,D=0,R=[],B;e=(0,a.le)(e)?this.parent.getActiveSheet().index:e;var H=this.parent.sheets[e],j=this.getRangeData({range:r,sheetIdx:e,skipFormula:!0,isYvalue:!0}),W=r[2]-r[0]+1-this.parent.hiddenCount(r[0],r[2],"rows",H),ne=r[3]-r[1]+1-this.parent.hiddenCount(r[0],r[2],"columns",H);t.isSeriesInRows?(c=n?this.toArrayData(this.getRangeData({range:n,sheetIdx:e,skipFormula:!1,isYvalue:!1})):this.getVirtualXValues(ne+1),i&&(u=this.toArrayData(this.getRangeData({range:i,sheetIdx:e,skipFormula:!1,isYvalue:!1}))),p=W):(c=i?this.toArrayData(this.getRangeData({range:i,sheetIdx:e,skipFormula:!1,isYvalue:!1})):this.getVirtualXValues(W+1),n&&(u=this.toArrayData(this.getRangeData({range:n,sheetIdx:e,skipFormula:!1,isYvalue:!1}))),p=ne);var ie=c.length,me=t.isSeriesInRows?1:p;for((0,a.le)(t.dataLabelSettings)||(l.visible=t.dataLabelSettings.visible,l.position=t.dataLabelSettings.position);L<p;){for(C=0,f=[],D=t.isSeriesInRows?D:L;C<ie;)j[D]&&(h=j[D].value,(0,pe.hj$)(h)?h=Number(h):(B=(0,pe.twf)(h),h=isNaN(B)?0:B),f.push({x:c[C],y:h})),D+=me,C++;if(u&&u.length>0?s=u[L]:s="series"+L,t.type){var ve=t.type;if(ve==="Line"||ve==="StackingLine"||ve==="StackingLine100")g={dataSource:f,type:t.type,xName:"x",yName:"y",name:s.toString(),marker:{visible:!0,width:10,height:10,dataLabel:l}};else if(ve==="Scatter")g={dataSource:f,type:t.type,xName:"x",yName:"y",name:s.toString(),marker:{visible:!1,width:12,height:12,shape:"Circle",dataLabel:l}};else if(ve==="Pie"||ve==="Doughnut"){var Ee=t.type==="Pie"?"0%":"40%",le=l.visible,de=(0,a.le)(l.position)?"Inside":l.position==="Outer"?"Outside":"Inside";g={dataSource:f,dataLabel:{visible:(0,a.le)(le)?!1:le,position:de,name:"text",font:{fontWeight:"600"}},radius:"100%",xName:"x",yName:"y",innerRadius:Ee}}else g={dataSource:f,type:t.type,xName:"x",yName:"y",name:s.toString(),marker:{dataLabel:l}}}R.push(g),L++}var fe;return t.type&&(fe={series:R,xRange:t.isSeriesInRows?n:i,yRange:r,lRange:t.isSeriesInRows?i:n}),fe},o.prototype.primaryYAxisFormat=function(t){if((0,a.le)(t))return"{value}";var e,i=(0,w.$Su)(t[0],t[1],this.parent.getActiveSheet());if(i&&i.format){if(e=(0,Pc.K2)(i.format),e==="Accounting")return"${value}";if(e==="Currency")return"${value}";if(e==="Percentage")return"{value}%"}return"{value}"},o.prototype.focusChartRange=function(t,e,i){var r=["e-rcborderright","e-rcborderbottom","e-vcborderright","e-vcborderbottom","e-bcborderright","e-bcborderbottom"];this.clearBorder();var n,s=this.parent.getActiveSheet(),l=!!(s.frozenRows||s.frozenColumns);i&&(l?n=i:this.parent.notify(E.R8,{startcell:{rowIndex:i[0],colIndex:i[1]},endcell:{rowIndex:i[2],colIndex:i[3]},classes:[r[0],r[1]]})),t&&(l?n?(n[0]=Math.min(i[0],t[0]),n[1]=Math.min(i[1],t[1]),n[2]=Math.max(i[2],t[2]),n[3]=Math.max(i[3],t[3])):n=t:this.parent.notify(E.R8,{startcell:{rowIndex:t[0],colIndex:t[1]},endcell:{rowIndex:t[2],colIndex:t[3]},classes:[r[2],r[3]]})),l&&n?this.parent.notify(E.R8,{startcell:{rowIndex:Math.min(n[0],e[0]),colIndex:Math.min(n[1],e[1])},endcell:{rowIndex:Math.max(n[2],e[2]),colIndex:Math.max(n[3],e[3])},classes:[r[4],r[5]]}):this.parent.notify(E.R8,{startcell:{rowIndex:e[0],colIndex:e[1]},endcell:{rowIndex:e[2],colIndex:e[3]},classes:[r[4],r[5]]})},o.prototype.clearBorder=function(){var t=this.parent.getActiveSheet();if(t.frozenColumns||t.frozenRows){var e=[].slice.call(this.parent.element.getElementsByClassName("e-chart-range"));e.forEach(function(p){(0,a.og)(p)});return}for(var i=this.parent.getMainContent(),r=["e-rcborderright","e-rcborderbottom","e-vcborderright","e-vcborderbottom","e-bcborderright","e-bcborderbottom"],n=0,s=r.length;n<s;n++)for(var l=i.querySelectorAll("."+r[n]),h=0,c=l.length;h<c;h++){var u=l[h];u.classList.remove(r[n])}},o.prototype.initiateChartHandler=function(t){var e=t.option,i=!0;i=(0,a.le)(t.isInitCell)?!0:!t.isInitCell,t.triggerEvent=(0,a.le)(t.triggerEvent)?!0:t.triggerEvent;var r;t.isRefresh=(0,a.le)(t.isRefresh)?!1:t.isRefresh;var n=e.range&&e.range.indexOf("!")>0?(0,w.Q8D)(this.parent,e.range.split("!")[0]):this.parent.activeSheetIndex,s=(0,w.zfV)(this.parent,n),l=e.range?e.range:this.parent.getActiveSheet().selectedRange,h=(0,pe.dK5)(l),c={},u,p;if(!this.parent.allowChart&&s.isProtected)return r;var f={sheetIndex:n,reqType:"shape",type:"actionBegin",shapeType:"chart",action:"create",options:e,range:l,operation:"create"};if(c=f.options,l=f.range,c=c||{},h.length>0){var g=h[2]-h[0],C=h[3]-h[1];g<C&&(u=!0)}c.isSeriesInRows=u?!0:c.isSeriesInRows?c.isSeriesInRows:!1,t.dataSheetIdx=(0,a.le)(t.dataSheetIdx)?n:t.dataSheetIdx;var L=this.processChartRange(h,t.dataSheetIdx,c),D=L.xRange,R=L.yRange,B=L.lRange;n===this.parent.activeSheetIndex&&i&&this.focusChartRange(D,R,B);var H=this.processChartSeries(c,t.dataSheetIdx,D,R,B),j={majorGridLines:e.primaryXAxis&&e.primaryXAxis.majorGridLines&&!(0,a.le)(e.primaryXAxis.majorGridLines.width)?{width:e.primaryXAxis.majorGridLines.width}:{width:0},minorGridLines:e.primaryXAxis&&e.primaryXAxis.minorGridLines&&!(0,a.le)(e.primaryXAxis.minorGridLines.width)?{width:e.primaryXAxis.minorGridLines.width}:{width:0},minorTicksPerInterval:e.primaryXAxis&&e.primaryXAxis.minorGridLines&&e.primaryXAxis.minorGridLines.width>0?5:0,lineStyle:{width:0},valueType:"Category",visible:e.primaryXAxis?e.primaryXAxis.visible:!0,title:e.primaryXAxis?e.primaryXAxis.title:""},W={lineStyle:{width:0},majorGridLines:e.primaryYAxis&&e.primaryYAxis.majorGridLines&&!(0,a.le)(e.primaryYAxis.majorGridLines.width)?{width:e.primaryYAxis.majorGridLines.width}:{width:1},minorGridLines:e.primaryYAxis&&e.primaryYAxis.minorGridLines&&!(0,a.le)(e.primaryYAxis.minorGridLines.width)?{width:e.primaryYAxis.minorGridLines.width}:{width:0},minorTicksPerInterval:e.primaryYAxis&&e.primaryYAxis.minorGridLines&&e.primaryYAxis.minorGridLines.width>0?5:0,labelFormat:this.primaryYAxisFormat(R),visible:e.primaryYAxis?e.primaryYAxis.visible:!0,title:e.primaryYAxis?e.primaryYAxis.title:""};if(t.isRefresh)return H.series;if(t.triggerEvent){if(p={type:e.type,theme:e.theme,isSeriesInRows:e.isSeriesInRows,range:e.range,id:e.id,height:e.height,width:e.width,posRange:t.range,isInitCell:t.isInitCell,cancel:!1},this.parent.notify(w.ya2,{eventArgs:p,action:"beforeInsertChart"}),p.cancel)return[];e.type=p.type,e.theme=p.theme,e.isSeriesInRows=p.isSeriesInRows,e.range=p.range,e.id=p.id,e.height=p.height,e.width=p.width}var ne=e.id+"_overlay",ie=this.parent.serviceLocator.getService(ef),me=!(0,a.le)(t.isInitCell)&&t.isInitCell?t.range:l,ve=ie.insertOverlayElement(ne,me,(0,pe.MJG)(this.parent,me));ve.classList.add("e-datavisualization-chart"),ve.style.width=e.width+"px",ve.style.height=e.height+"px",s.frozenRows||s.frozenColumns?ie.adjustFreezePaneSize(e,ve,me):(ve.style.top=(0,a.le)(e.top)?ve.style.top:e.top+"px",ve.style.left=(0,a.le)(e.left)?ve.style.left:e.left+"px",e.top=parseInt(ve.style.top.replace("px",""),10),e.left=parseInt(ve.style.left.replace("px",""),10)),this.parent.notify(E.Cj,{height:e.height,width:e.width});var Ee=e.type==="Pie"||e.type==="Doughnut"?{position:"Bottom",visible:!0}:{};(0,a.le)(e.legendSettings)||(Ee.visible=e.legendSettings.visible,Ee.position=e.legendSettings.position);var le=this.parent.createElement("div",{id:e.id,className:e.id});return e.type!=="Pie"&&e.type!=="Doughnut"?(this.chart=new Xd({primaryXAxis:j,primaryYAxis:W,chartArea:{border:{width:0}},title:e.title,legendSettings:Ee,theme:e.theme,series:H.series,tooltip:{enable:!0},width:ve.style.width,height:ve.style.height,load:function(de){var fe=e.theme;fe=fe||"Material",de.chart.theme=fe},beforeResize:function(de){de.cancelResizedEvent=!0}}),this.chart.appendTo(le)):(this.chart=new z0({title:e.title,legendSettings:Ee,theme:e.theme,series:H.series,width:ve.style.width,height:ve.style.height,center:{x:"50%",y:"50%"},enableSmartLabels:!0,enableAnimation:!0,load:function(de){var fe=e.theme;fe=fe||"Material",de.chart.theme=fe},beforeResize:function(de){de.cancelResizedEvent=!0}}),this.chart.appendTo(le)),ve.appendChild(le),ve.classList.contains("e-ss-overlay-active")&&this.parent.notify(E.A$,{id:ve.id}),t.triggerEvent&&this.parent.notify(E.Av,{eventArgs:p,action:"insertChart"}),r},o.prototype.deleteChart=function(t){this.clearBorder();var e=null,i=this.parent.getActiveSheet();if((0,a.le)(t.id)?(e=document.querySelector(".e-datavisualization-chart.e-ss-overlay-active"),t.id=e?e.getElementsByClassName("e-control")[0].id:null):(t.id=t.id.includes("overlay")?t.id:t.id+"_overlay",e=document.getElementById(t.id)),!(0,a.le)(t.id)){t.id=t.id.includes("overlay")?t.id:t.id+"_overlay";for(var r,n,s,l=!1,h,c=0,u=this.parent.chartColl.length;c<u;c++)if(this.parent.chartColl[c].id===t.id.split("_overlay")[0]){h=this.parent.chartColl[c];break}var p={id:h.id,range:h.range,type:h.type,theme:h.theme,height:h.height,width:h.width,isSeriesInRows:h.isSeriesInRows,isInitCell:!0,posRange:null,top:h.top,left:h.left,cancel:!1};if(e){var f=void 0,g=void 0;if(i.frozenRows||i.frozenColumns){var C=e.getBoundingClientRect();f={clientY:C.top},g={clientX:C.left},C.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(f.target=this.parent.getColumnHeaderContent()),C.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(g.target=this.parent.getRowHeaderTable())}else f={clientY:e.offsetTop,isImage:!0},g={clientX:e.offsetLeft,isImage:!0};this.parent.notify(pe.g2O,{id:t.id}),this.parent.notify(E.M7,f),this.parent.notify(E.oU,g),l=!0,r=f.clientY,n=g.clientX,i=this.parent.sheets[this.parent.activeSheetIndex]}else{this.parent.notify(pe.g2O,{id:t.id});var L=t.range&&t.range.indexOf("!")>0?(0,w.Q8D)(this.parent,t.range.split("!")[0]):this.parent.activeSheetIndex,D=t.range?t.range.indexOf("!")>0?t.range.split("!")[1]:t.range.split("!")[0]:this.parent.getActiveSheet().selectedRange,R=(0,pe.dK5)(D);r=R[0],n=R[1],i=this.parent.sheets[L]}var B=(0,w.$Su)(r,n,i);B&&(s=B.chart);for(var H=s?s.length:null,c=0;c<H;c++)t.id===s[c].id+"_overlay"&&s.splice(c,1);l&&(document.getElementById(t.id).remove(),this.parent.notify(E.k3,{})),(0,w.Jxt)(r,n,i,{chart:s},!0),p.posRange=(0,pe.qkm)(r,n),t.isUndoRedo||this.parent.notify(E.Av,{eventArgs:p,action:"deleteChart"})}},o.prototype.updateChartModel=function(t,e,i,r,n){var s=e;e=e;var l=this.parent.chartColl[r].id;if(!(n&&["PHAxes","PVAxes","PHAxisTitle","PVAxisTitle","GLMajorHorizontal","GLMajorVertical","GLMinorHorizontal","GLMinorVertical"].indexOf(t)>-1)){for(var h=0,c=i.chart.length;h<c;h++)if(i.chart[h].id===l)switch(t){case"PHAxes":case"PHAxisTitle":(0,a.le)(i.chart[h].primaryXAxis)&&(i.chart[h].primaryXAxis={},this.parent.chartColl[r].primaryXAxis={}),t==="PHAxes"?(i.chart[h].primaryXAxis.visible=e.primaryXAxis.visible,this.parent.chartColl[r].primaryXAxis.visible=e.primaryXAxis.visible):t==="PHAxisTitle"&&(i.chart[h].primaryXAxis.title=e.primaryXAxis.title,this.parent.chartColl[r].primaryXAxis.title=e.primaryXAxis.title);break;case"PVAxes":case"PVAxisTitle":(0,a.le)(i.chart[h].primaryYAxis)&&(i.chart[h].primaryYAxis={},this.parent.chartColl[r].primaryYAxis={}),t==="PVAxes"?(i.chart[h].primaryYAxis.visible=e.primaryYAxis.visible,this.parent.chartColl[r].primaryYAxis.visible=e.primaryYAxis.visible):t==="PVAxisTitle"&&(i.chart[h].primaryYAxis.title=e.primaryYAxis.title,this.parent.chartColl[r].primaryYAxis.title=e.primaryYAxis.title);break;case"ChartTitleNone":case"ChartTitleAbove":i.chart[h].title=e.title,this.parent.chartColl[r].title=e.title;break;case"DLNone":case"DLCenter":case"DLInsideend":case"DLInsidebase":case"DLOutsideend":if((0,a.le)(i.chart[h].dataLabelSettings)&&(i.chart[h].dataLabelSettings={},this.parent.chartColl[r].dataLabelSettings={}),t==="DLNone")i.chart[h].dataLabelSettings.visible=!1,this.parent.chartColl[r].dataLabelSettings.visible=!1;else{i.chart[h].dataLabelSettings.visible=!0,this.parent.chartColl[r].dataLabelSettings.visible=!0;var u=void 0;n?u=s.series[0].dataLabel.position==="Outside"?"Outer":"Middle":u=e.series[0].marker.dataLabel.position,i.chart[h].dataLabelSettings.position=u,this.parent.chartColl[r].dataLabelSettings.position=u}break;case"GLMajorHorizontal":(0,a.le)(i.chart[h].primaryYAxis)&&(i.chart[h].primaryYAxis={},this.parent.chartColl[r].primaryYAxis={}),(0,a.le)(i.chart[h].primaryYAxis.majorGridLines)&&(i.chart[h].primaryYAxis.majorGridLines={},this.parent.chartColl[r].primaryYAxis.majorGridLines={}),i.chart[h].primaryYAxis.majorGridLines.width=e.primaryYAxis.majorGridLines.width,this.parent.chartColl[r].primaryYAxis.majorGridLines.width=e.primaryYAxis.majorGridLines.width;break;case"GLMajorVertical":(0,a.le)(i.chart[h].primaryXAxis)&&(i.chart[h].primaryXAxis={},this.parent.chartColl[r].primaryXAxis={}),(0,a.le)(i.chart[h].primaryXAxis.majorGridLines)&&(i.chart[h].primaryXAxis.majorGridLines={},this.parent.chartColl[r].primaryXAxis.majorGridLines={}),i.chart[h].primaryXAxis.majorGridLines.width=e.primaryXAxis.majorGridLines.width,this.parent.chartColl[r].primaryXAxis.majorGridLines.width=e.primaryXAxis.majorGridLines.width;break;case"GLMinorHorizontal":(0,a.le)(i.chart[h].primaryYAxis)&&(i.chart[h].primaryYAxis={},this.parent.chartColl[r].primaryYAxis={}),(0,a.le)(i.chart[h].primaryYAxis.minorGridLines)&&(i.chart[h].primaryYAxis.minorGridLines={},this.parent.chartColl[r].primaryYAxis.minorGridLines={}),i.chart[h].primaryYAxis.minorGridLines.width=e.primaryYAxis.minorGridLines.width,this.parent.chartColl[r].primaryYAxis.minorGridLines.width=e.primaryYAxis.minorGridLines.width;break;case"GLMinorVertical":(0,a.le)(i.chart[h].primaryXAxis)&&(i.chart[h].primaryXAxis={},this.parent.chartColl[r].primaryXAxis={}),(0,a.le)(i.chart[h].primaryXAxis.minorGridLines)&&(i.chart[h].primaryXAxis.minorGridLines={},this.parent.chartColl[r].primaryXAxis.minorGridLines={}),i.chart[h].primaryXAxis.minorGridLines.width=e.primaryXAxis.minorGridLines.width,this.parent.chartColl[r].primaryXAxis.minorGridLines.width=e.primaryXAxis.minorGridLines.width;break;case"LegendNone":case"LegendsRight":case"LegendsLeft":case"LegendsBottom":case"LegendsTop":if((0,a.le)(i.chart[h].legendSettings)&&(i.chart[h].legendSettings={},this.parent.chartColl[r].legendSettings={}),i.chart[h].legendSettings.visible=e.legendSettings.visible,this.parent.chartColl[r].legendSettings.visible=e.legendSettings.visible,t!=="LegendNone"){i.chart[h].legendSettings.position=e.legendSettings.position,this.parent.chartColl[r].legendSettings.position=e.legendSettings.position;break}}}},o.prototype.updateChartElement=function(t,e,i,r,n,s,l,h){if(!(s&&["PHAxes","PVAxes","PHAxisTitle","PVAxisTitle","GLMajorHorizontal","GLMajorVertical","GLMinorHorizontal","GLMinorVertical"].indexOf(t)>-1)){var c;switch(t){case"PHAxes":e=e,e.primaryXAxis.visible=!e.primaryXAxis.visible;break;case"PVAxes":e=e,e.primaryYAxis.visible=!e.primaryYAxis.visible;break;case"PHAxisTitle":e=e,e.primaryXAxis.title=n;break;case"PVAxisTitle":e=e,e.primaryYAxis.title=n;break;case"ChartTitleNone":e.title="";break;case"ChartTitleAbove":e.title=n;break;case"DLNone":case"DLCenter":case"DLInsideend":case"DLInsidebase":case"DLOutsideend":if(e=e,c=e.series,t==="DLNone")for(var u=0,p=c.length;u<p;u++)s?c[u].dataLabel.visible=!1:c[u].marker.dataLabel.visible=!1;else for(var u=0,p=c.length;u<p;u++)if(s){var f=t==="DLOutsideend"?"Outside":"Inside";c[u].dataLabel.visible=!0,c[u].dataLabel.position=f}else{var f=t==="DLCenter"?"Middle":t==="DLInsideend"?"Top":t==="DLInsidebase"?"Bottom":t==="DLOutsideend"?"Outer":c[0].marker.dataLabel.position;c[u].marker.dataLabel.visible=!0,c[u].marker.dataLabel.position=f}e.series=c,s&&e.refresh();break;case"GLMajorHorizontal":e=e,e.primaryYAxis.majorGridLines.width=e.primaryYAxis.majorGridLines.width===0?1:0;break;case"GLMajorVertical":e=e,e.primaryXAxis.majorGridLines.width=e.primaryXAxis.majorGridLines.width===0?1:0;break;case"GLMinorHorizontal":e=e,e.primaryYAxis.minorTicksPerInterval=e.primaryYAxis.minorGridLines.width===0?5:0,e.primaryYAxis.minorGridLines.width=e.primaryYAxis.minorGridLines.width===0?1:0;break;case"GLMinorVertical":e=e,e.primaryXAxis.minorTicksPerInterval=e.primaryXAxis.minorGridLines.width===0?5:0,e.primaryXAxis.minorGridLines.width=e.primaryXAxis.minorGridLines.width===0?1:0;break;case"LegendNone":e.legendSettings.visible=!1;break;case"LegendsRight":case"LegendsLeft":case"LegendsBottom":case"LegendsTop":e.legendSettings.visible=!0,e.legendSettings.position=t==="LegendsRight"?"Right":t==="LegendsLeft"?"Left":t==="LegendsBottom"?"Bottom":t==="LegendsTop"?"Top":e.legendSettings.position;break}if(this.updateChartModel(t,e,i,r,s),h){var g={addChartEle:t,id:e.element.id+"_overlay",title:n,address:l};this.parent.notify(E.Av,{action:"chartDesign",eventArgs:g})}}},o.prototype.undoRedoForChartDesign=function(t){var e=document.getElementById(t.id);if(!!e){var i=this.getChartElement(e),r=(0,a.Xr)(i,"chart");(0,a.le)(r)&&(r=(0,a.Xr)(i,"accumulationchart"));for(var n=this.parent.getAddressInfo(t.address),s=(0,w.$Su)(n.indices[0],n.indices[1],(0,w.zfV)(this.parent,n.sheetIndex)),l=this.getChartCollectionId(i.id),h,c=t.addChartEle,u=t.title,p=0;p<t.beforeActionData.cellDetails[0].chart.length;p++)if(i.id===t.beforeActionData.cellDetails[0].chart[p].id){h=t.beforeActionData.cellDetails[0].chart[p];break}if(t.switchRowColumn)this.switchRowColumn(l,i.id,r,s);else if(t.chartTheme)this.switchChartTheme(l,i.id,t.isUndo?h.theme:t.chartTheme,r,s);else if(t.chartType)this.switchChartType(l,i.id,t.isUndo?h.type:t.chartType,r,s);else if(t.addChartEle){if(t.isUndo){var f=void 0;switch(c){case"DLNone":case"DLCenter":case"DLInsideend":case"DLInsidebase":case"DLOutsideend":f=h.dataLabelSettings&&h.dataLabelSettings.position,c=f==="Middle"?"DLCenter":f==="Top"?"DLInsideend":f==="Bottom"?"DLInsidebase":f==="Outer"?"DLOutsideend":"DLNone";break;case"LegendNone":case"LegendsRight":case"LegendsLeft":case"LegendsBottom":case"LegendsTop":h.legendSettings&&!h.legendSettings.visible?f="LegendNone":(f=h.legendSettings&&h.legendSettings.position,c=f==="Right"?"LegendsRight":f==="Left"?"LegendsLeft":f==="Bottom"?"LegendsBottom":f==="Top"?"LegendsTop":"LegendsBottom");break;case"PVAxisTitle":u=h.primaryYAxis&&h.primaryYAxis.title;break;case"PHAxisTitle":u=h.primaryXAxis&&h.primaryXAxis.title;break;case"ChartTitleNone":case"ChartTitleAbove":u=h.title;break}}this.updateChartElement(c,r,s,l,u,null,t.address)}}},o.prototype.chartDesignTabHandler=function(t){var e=!1,i=this.parent.sheets[this.parent.activeSheetIndex],r=t.switchRowColumn,n=t.chartType,s=t.chartTheme,l=t.addChartEle,h=null,c,u=t.id?document.getElementById(t.id):document.querySelector(".e-datavisualization-chart.e-ss-overlay-active");if(!!u){var p=l==="ChartTitleAbove"||l==="PHAxisTitle"||l==="PVAxisTitle",f,g;if(i.frozenRows||i.frozenColumns){var C=u.getBoundingClientRect();f={clientY:C.top},g={clientX:C.left},C.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(f.target=this.parent.getColumnHeaderContent()),C.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(g.target=this.parent.getRowHeaderTable())}else f={clientY:u.offsetTop,isImage:!0},g={clientX:u.offsetLeft,isImage:!0};this.parent.notify(E.M7,f),this.parent.notify(E.oU,g);var L=(0,w.$Su)(f.clientY,g.clientX,i),D=i.name+"!"+(0,pe.qkm)(f.clientY,g.clientX);if(t.triggerEvent){var R={switchRowColumn:t.switchRowColumn,chartType:t.chartType,chartTheme:t.chartTheme,addChartEle:t.addChartEle,id:u.id,address:D,cancel:!1};if(this.parent.notify(w.ya2,{action:"chartDesign",eventArgs:R}),R.cancel)return}var B=this.getChartElement(u),H=B.getAttribute("id");if(c=this.getChartCollectionId(H),B&&(h=(0,a.Xr)(B,"chart"),(0,a.le)(h)&&(h=(0,a.Xr)(B,"accumulationchart"),e=!0)),r&&!e&&this.switchRowColumn(c,H,h,L),n&&this.switchChartType(c,H,n,h,L),s&&this.switchChartTheme(c,H,s,h,L),l)if(p&&!t.title){if(this.parent.element.getElementsByClassName("e-title-dlg").length>0)return;this.titleDlgHandler(l,h,L,c,e,D,t.triggerEvent)}else this.updateChartElement(l,h,L,c,t.title,e);if(t.triggerEvent&&!p){var R={switchRowColumn:t.switchRowColumn,chartType:t.chartType,chartTheme:t.chartTheme,addChartEle:t.addChartEle,id:u.id,address:D};this.parent.notify(E.Av,{action:"chartDesign",eventArgs:R})}}},o.prototype.switchRowColumn=function(t,e,i,r){this.parent.chartColl[t].isSeriesInRows=(0,a.le)(this.parent.chartColl[t].isSeriesInRows)?!0:!this.parent.chartColl[t].isSeriesInRows;for(var n=0,s=r.chart.length;n<s;n++)r.chart[n].id===e&&(r.chart[n].isSeriesInRows=(0,a.le)(r.chart[n].isSeriesInRows)?!0:!r.chart[n].isSeriesInRows);var l=this.initiateChartHandler({option:this.parent.chartColl[t],isRefresh:!0});i.series=l},o.prototype.switchChartTheme=function(t,e,i,r,n){this.parent.chartColl[t].theme=i;for(var s=0,l=n.chart.length;s<l;s++)n.chart[s].id===e&&(n.chart[s].theme=i);r.theme=i,r.refresh()},o.prototype.switchChartType=function(t,e,i,r,n){var s=this.parent.chartColl[t].type;this.parent.chartColl[t].type=i;for(var l=0,h=n.chart.length;l<h;l++)n.chart[l].id===e&&(n.chart[l].type=i);if(i!=="Pie"&&i!=="Doughnut")if(s==="Pie"||s==="Doughnut")this.changeCharType(t);else{for(var c=r.series,l=0,u=c.length;l<u;l++)c[l].type=i;r.series=c,r.refresh()}else if(s==="Pie"||s==="Doughnut"){for(var c=r.series,l=0,u=c.length;l<u;l++)c[l].innerRadius=i==="Pie"?"0%":"40%";r.series=c,r.refresh()}else this.changeCharType(t)},o.prototype.getChartElement=function(t){var e=t.querySelector(".e-chart");return(0,a.le)(e)&&(e=t.querySelector(".e-accumulationchart")),e},o.prototype.getChartCollectionId=function(t){for(var e,i=0,r=this.parent.chartColl.length;i<r;i++)t===this.parent.chartColl[i].id&&(e=i);return e},o.prototype.changeCharType=function(t){var e=document.getElementById(this.parent.chartColl[t].id),i=(0,a.oq)(e,".e-datavisualization-chart");i.remove(),this.parent.notify(pe.hAg,{option:this.parent.chartColl[t],isInitCell:!1,triggerEvent:!1,isPaste:!1}),e=document.getElementById(this.parent.chartColl[t].id),i=(0,a.oq)(e,".e-datavisualization-chart"),i.classList.contains("e-ss-overlay-active")||i.classList.add("e-ss-overlay-active")},o.prototype.titleDlgHandler=function(t,e,i,r,n,s,l){var h=this,c="";if(!(n&&(t==="PHAxisTitle"||t==="PVAxisTitle"))){var u=this.parent.serviceLocator.getService(Ve),p=this.parent.serviceLocator.getService(Yt);p.show({width:375,showCloseIcon:!0,isModal:!0,cssClass:"e-title-dlg",header:t==="chart_abovechart"?u.getConstant("ChartTitle"):t==="PHAxisTitle"?u.getConstant("HorizontalAxisTitle"):u.getConstant("VerticalAxisTitle"),target:document.querySelector(".e-control.e-spreadsheet"),beforeOpen:function(){p.dialogInstance.content=h.titleDlgContent(t,e),p.dialogInstance.dataBind(),h.parent.element.focus()},buttons:[{buttonModel:{content:u.getConstant("Ok"),isPrimary:!0,cssClass:"e-btn e-clearall-btn e-flat"},click:function(){var f=h.parent.element.querySelector(".e-title-dlg").getElementsByClassName("e-title-dlg-content")[0];c=f.getElementsByTagName("input")[0].value,p.hide(),h.updateChartElement(t,e,i,r,c,null,s,l)}}]}),p.dialogInstance.refresh()}},o.prototype.titleDlgContent=function(t,e){var i=this.parent.serviceLocator.getService(Ve),r=i.getConstant("EnterTitle"),n=this.parent.createElement("div",{className:"e-title-dlg-content"}),s=this.parent.createElement("span",{className:"e-header e-top-header",innerHTML:r}),l=this.parent.createElement("input",{className:"e-input",id:"titleInput",attrs:{type:"text"}});return n.appendChild(s),n.appendChild(l),e&&(t==="PHAxisTitle"?l.value=e.primaryXAxis.title?e.primaryXAxis.title:l.value:t==="PVAxisTitle"?l.value=e.primaryYAxis.title?e.primaryYAxis.title:l.value:l.value=e.title?e.title:l.value),n},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(pe.hAg,this.initiateChartHandler),this.parent.off(E.tB,this.refreshChartCellObj),this.parent.off(pe.Ll5,this.updateChartHandler),this.parent.off(E.k0,this.deleteChart),this.parent.off(E.gs,this.clearBorder),this.parent.off(E.jh,this.insertChartHandler),this.parent.off(E.uU,this.chartRangeHandler),this.parent.off(E.dG,this.chartDesignTabHandler),this.parent.off(E.x3,this.updateChartElement),this.parent.off(E.o,this.undoRedoForChartDesign))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null;var t=null;this.chart&&(t=this.chart.element,this.chart.destroy()),t&&(0,a.og)(t),this.chart=null},o.prototype.getModuleName=function(){return"spreadsheetChart"},o}(),HR=function(){function o(){tf.Inject(jp,Up,Zp,gr,Ci,So,wo,gi,w.vdt,Yp,rm,Gp,Kp,xo,qp,Jp,sf,Bu,Qc,wd,Pu,Fu,Hu,Vu,Qu,$u,tp,ip,rp,xd,Qd,np)}return o.prototype.getModuleName=function(){return"basic"},o.prototype.destroy=function(){},o}(),VR=function(){function o(){tf.Inject(jp,Up,Zp,gr,Ci,So,wo,gi,Pc.vd,Yp,Gp,Kp,xo,qp,Jp,Qc,sf,Bu,wd,Pu,Fu,Hu,Vu,$u,Qu,tp,ip,xd,rp,Qd,np)}return o.prototype.getModuleName=function(){return"all"},o.prototype.destroy=function(){},o}(),_0=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Jd=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},K1=function(o){_0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Jd([(0,a.Z9)(!1)],t.prototype,"isFinite",void 0),Jd([(0,a.Z9)(!0)],t.prototype,"enableVirtualization",void 0),t}(a.rt),X1=function(o){_0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Jd([(0,a.Z9)("Multiple")],t.prototype,"mode",void 0),t}(a.rt),zR="e-disabled",j0="e-wraptext",Ve="spreadsheetLocale",Yt="dialog",$1="actionEvents",ef="shape",Q1={Custom:["#ffffff","#000000","#e7e6e6","#44546a","#4472c4","#ed7d31","#a5a5a5","#ffc000","#70ad47","#ff0000","#f2f2f2","#808080","#cfcdcd","#d5dce4","#d9e2f3","#fbe4d5","#ededed","#fff2cc","#e2efd9","#ffcccc","#d9d9d9","#595959","#aeaaaa","#acb9ca","#b4c6e7","#f7caac","#dbdbdb","#ffe599","#c5e0b3","#ff8080","#bfbfbf","#404040","#747070","#8496b0","#8eaadb","#f4b083","#c9c9c9","#ffd966","#a8d08d","#ff3333","#a6a6a6","#262626","#3b3838","#323e4f","#2f5496","#c45911","#7b7b7b","#bf8f00","#538135","#b30000","#7f7f7f","#0d0d0d","#161616","#212934","#1f3763","#823b0b","#525252","#7f5f00","#375623","#660000"]},J1={Custom:["#ffffff","#000000","#ffff00","#00ff00","#00ffff","#0000ff","#ff0000","#000080","#800080","#996633","#f2f2f2","#808080","#ffffcc","#b3ffb3","#ccffff","#ccccff","#ffcccc","#ccccff","#ff80ff","#f2e6d9","#d9d9d9","#595959","#ffff80","#80ff80","#b3ffff","#8080ff","#ff8080","#8080ff","#ff00ff","#dfbf9f","#bfbfbf","#404040","#ffff33","#33ff33","#33ffff","#3333ff","#ff3333","#0000b3","#b300b3","#c68c53","#a6a6a6","#262626","#e6e600","#00b300","#009999","#000099","#b30000","#000066","#660066","#86592d","#7f7f7f","#0d0d0d","#999900","#006600","#006666","#000066","#660000","#00004d","#4d004d","#734d26"]},Yr={UP:38,DOWN:40,LEFT:37,RIGHT:39,FIRSTALPHABET:65,LASTALPHABET:90,SPACE:32,BACKSPACE:8,TAB:9,DELETE:46,ENTER:13,ESC:27},eA={FindValue:"Find value",ReplaceValue:"Replace value",FindReplaceTooltip:"Find & Replace",InsertingEmptyValue:"Reference value is not valid.",ReplaceAllEnd:" matches replaced with ",ByRow:"By Rows",ByColumn:"By Columns",MatchCase:"Match case   ",MatchExactCellElements:"Match exact cell contents",Replace:"Replace...",Find:"Find and Replace...",Goto:"Goto...",EntercellAddress:"Enter cell address",GotoSpecial:"GotoSpecial...",FindAndReplace:"Find and Replace",FindNextBtn:"Find Next",FindPreviousBtn:"Find Previous",ReplaceBtn:"Replace",ReplaceAllBtn:"Replace All",GotoHeader:"Go To",GotoSpecialHeader:"Go To Special",Sheet:"Sheet",Workbook:"Workbook",NoElements:"We couldn't find what you were looking for.",FindWhat:"Find what",ReplaceWith:"Replace with",Cut:"Cut",Copy:"Copy",Paste:"Paste",PasteSpecial:"Paste Special",Link:"Link",Spreadsheet:"Spreadsheet",SpreadsheetHyperlink:"SpreadsheetHyperlink",Hyperlink:"Hyperlink",EditHyperlink:"Edit Hyperlink",OpenHyperlink:"Open Hyperlink",RemoveHyperlink:"Remove Hyperlink",InvalidHyperlinkAlert:"The address of this site is not valid. Check the address and try again.",InsertLink:"Insert Link",EditLink:"Edit Link",All:"All",Values:"Values",Formats:"Formats",Bold:"Bold",Font:"Font",FontSize:"Font Size",Italic:"Italic",Underline:"Underline",Strikethrough:"Strikethrough",TextColor:"Text Color",FillColor:"Fill Color",HorizontalAlignment:"Horizontal Alignment",AlignLeft:"Align Left",AlignCenter:"Center",AlignRight:"Align Right",VerticalAlignment:"Vertical Alignment",AlignTop:"Align Top",AlignMiddle:"Align Middle",AlignBottom:"Align Bottom",WrapText:"Wrap Text",MergeCells:"Merge Cells",MergeAll:"Merge All",MergeHorizontally:"Merge Horizontally",MergeVertically:"Merge Vertically",Unmerge:"Unmerge",UnmergeCells:"Unmerge Cells",SelectMergeType:"Select Merge Type",MergeCellsAlert:"Merging cells will only preserve the top-leftmost(Uppermost) value. Merge anyway?",PasteMergeAlert:'We can"t do that to a merge cell.',Borders:"Borders",TopBorders:"Top Borders",LeftBorders:"Left Borders",RightBorders:"Right Borders",BottomBorders:"Bottom Borders",AllBorders:"All Borders",HorizontalBorders:"Horizontal Borders",VerticalBorders:"Vertical Borders",OutsideBorders:"Outside Borders",InsideBorders:"Inside Borders",NoBorders:"No Borders",BorderColor:"Border Color",BorderStyle:"Border Style",InsertFunction:"Insert Function",Insert:"Insert",Delete:"Delete",DuplicateSheet:"Duplicate",MoveRight:"Move Right",MoveLeft:"Move Left",Rename:"Rename",Hide:"Hide",FileName:"File Name",EnterName:"Enter Name",InvalidFileName:"File name contains invalid character.",PROPER:"Converts a text to proper case; first letter to uppercase and other letters to lowercase.",Unhide:"Unhide",NameBox:"Name Box",ShowHeaders:"Show Headers",HideHeaders:"Hide Headers",ShowGridLines:"Show Gridlines",ExtendValidation:"The selection contains some cells without data validation. Do you want to extend validation to these cells?",Yes:"Yes",No:"No",HideGridLines:"Hide Gridlines",FreezePanes:"Freeze Panes",FreezeRows:"Freeze Rows",FreezeColumns:"Freeze Columns",UnfreezePanes:"Unfreeze Panes",UnfreezeRows:"Unfreeze Rows",UnfreezeColumns:"Unfreeze Columns",AddSheet:"Add Sheet",ListAllSheets:"List All Sheets",FullScreen:"Full Screen",CollapseToolbar:"Collapse Toolbar",ExpandToolbar:"Expand Toolbar",CollapseFormulaBar:"Collapse Formula Bar",ExpandFormulaBar:"Expand Formula Bar",File:"File",Home:"Home",Formulas:"Formulas",View:"View",New:"New",Open:"Open",SaveAs:"Save As",Update:"Update",ExcelXlsx:"Microsoft Excel",ExcelXls:"Microsoft Excel 97-2003",CSV:"Comma-separated values",FormulaBar:"Formula Bar",Sort:"Sort",SortAscending:"Ascending",SortDescending:"Descending",CustomSort:"Custom Sort",AddColumn:"Add Column",ContainsHeader:"Data contains header",CaseSensitive:"Case sensitive",SortBy:"Sort by",ThenBy:"Then by",SelectAColumn:"Select a column",SortEmptyFieldError:"Sort criteria column should not be empty.",SortDuplicateFieldError:" is mentioned more than once. Duplicate columns must be removed.",SortOutOfRangeError:"Select a cell or range inside the used range and try again.",MultiRangeSortError:"This can't be done on a multiple range selection. Select a single range and try again.",SortAndFilter:"Sort & Filter",Filter:"Filter",ClearAllFilter:"Clear",ClearFilterFrom:"Clear Filter From ",ReapplyFilter:"Reapply",FilterCellValue:"Filter by Value of Selected Cell",FilterOutOfRangeError:"Select a cell or range inside the used range and try again.",HideRow:"Hide Row",HideRows:"Hide Rows",UnHideRows:"UnHide Rows",HideColumn:"Hide Column",HideColumns:"Hide Columns",UnHideColumns:"UnHide Columns",InsertRow:"Insert Row",InsertRows:"Insert Rows",Above:"Above",Below:"Below",InsertColumn:"Insert Column",InsertColumns:"Insert Columns",Before:"Before",After:"After",DeleteRow:"Delete Row",DeleteRows:"Delete Rows",DeleteColumn:"Delete Column",DeleteColumns:"Delete Columns",Ok:"OK",Close:"Close",Cancel:"Cancel",Apply:"Apply",MoreColors:"More Colors",StandardColors:"Standard Colors",General:"General",Number:"Number",Currency:"Currency",Accounting:"Accounting",ShortDate:"Short Date",LongDate:"Long Date",Time:"Time",Percentage:"Percentage",Fraction:"Fraction",Scientific:"Scientific",Text:"Text",Custom:"Custom",MobileFormulaBarPlaceHolder:"Enter value or Formula",NumberFormat:"Number Format",PasteAlert:"You can't paste this here, because the copy area and paste area aren't in the same size. Please try pasting in a different range.",DestroyAlert:"Are you sure you want to destroy the current workbook without saving and create a new workbook?",SheetRenameInvalidAlert:"Sheet name contains invalid character.",SheetRenameEmptyAlert:"Sheet name cannot be empty.",SheetRenameAlreadyExistsAlert:"Sheet name already exists. Please enter another name.",DeleteSheetAlert:"You can't undo deleting sheets, and you might be removing some data. If you don't need it, click OK to delete.",DeleteSingleLastSheetAlert:"A Workbook must contain at least one visible worksheet.",PickACategory:"Pick a category",Description:"Description",UnsupportedFile:"Unsupported File",InvalidUrl:"Invalid URL",SUM:"Adds a series of numbers and/or cells.",SUMIF:"Adds the cells based on specified condition.",SUMIFS:"Adds the cells based on specified conditions.",ABS:"Returns the value of a number without its sign.",RAND:"Returns a random number between 0 and 1.",RANDBETWEEN:"Returns a random integer based on specified values.",FLOOR:"Rounds a number down to the nearest multiple of a given factor.",CEILING:"Rounds a number up to the nearest multiple of a given factor.",PRODUCT:"Multiplies a series of numbers and/or cells.",INT:"Returns a number to the nearest integer.",ROUNDUP:"Rounds a number away from zero.",SUMPRODUCT:"Returns sum of the product of given ranges of arrays.",SORT:"Sorts a range of an array",T:"Checks whether a value is text or not and returns the text.",EXACT:"Checks whether a two text strings are exactly same and returns TRUE or FALSE.",LEN:"Returns a number of characters in a given string.",MOD:"Returns a remainder after a number is divided by divisor.",ODD:"Rounds a positive number up and negative number down to the nearest odd integer.",PI:"Returns the value of pi.",COUNTBLANK:"Returns the number of empty cells in a specified range of cells.",EVEN:"Rounds a positive number up and negative number down to the nearest even integer.",DECIMAL:"Converts a text representation of a number in a given base into a decimal number.",DEGREES:"Converts radians to degrees.",ADDRESS:"Returns a cell reference as text, given specified row and column numbers.",TIME:"Converts hours, minutes, seconds to the time formatted text.",CHAR:"Returns the character from the specified number.",CODE:"Returns the numeric code for the first character in a given string.",DOLLAR:"Converts the number to currency formatted text.",SMALL:"Returns the k-th smallest value in a given array.",LARGE:"Returns the k-th largest value in a given array.",FACT:"Returns the factorial of a number.",MEDIAN:"Returns the median of the given set of numbers.",EDATE:"Returns a date with given number of months before or after the specified date.",DATEVALUE:"Converts a date string into date value.",HOUR:"Returns the number of hours in a specified time string.",SECOND:"Returns the number of seconds in a specified time string.",MINUTE:"Returns the number of minutes in a specified time string.",NOW:"Returns the current date and time.",MONTH:"Returns the number of months in a specified date string.",TODAY:"Returns the current date as date value.",WEEKDAY:"Returns the day of the week corresponding to a date.",AVERAGE:"Calculates average for the series of numbers and/or cells excluding text.",AVERAGEIF:"Calculates average for the cells based on specified criterion.",AVERAGEIFS:"Calculates average for the cells based on specified conditions.",AVERAGEA:"Calculates the average for the cells evaluating TRUE as 1, text and FALSE as 0.",COUNT:"Counts the cells that contain numeric values in a range.",COUNTIF:"Counts the cells based on specified condition.",COUNTIFS:"Counts the cells based on specified conditions.",COUNTA:"Counts the cells that contains values in a range.",MIN:"Returns the smallest number of the given arguments.",MAX:"Returns the largest number of the given arguments.",DATE:"Returns the date based on given year, month, and day.",DAY:"Returns the day from the given date.",DAYS:"Returns the number of days between two dates.",IF:"Returns value based on the given expression.",IFS:"Returns value based on the given multiple expressions.",CalculateAND:"Returns TRUE if all the arguments are TRUE, otherwise returns FALSE.",CalculateOR:"Returns TRUE if any of the arguments are TRUE, otherwise returns FALSE.",IFERROR:"Returns value if no error found else it will return specified value.",CHOOSE:"Returns a value from list of values, based on index number.",INDEX:"Returns a value of the cell in a given range based on row and column number.",FIND:"Returns the position of a string within another string, which is case sensitive",TEXT:"Converts a value to text in specified number format.",CONCATENATE:"Combines two or more strings together.",CONCAT:"Concatenates a list or a range of text strings.",SUBTOTAL:"Returns subtotal for a range using the given function number.",RADIANS:"Converts degrees into radians.",MATCH:"Returns the relative position of a specified value in given range.",LN:"Returns the natural logarithm of a number.",INTERCEPT:"Calculates the point of the Y-intercept line via linear regression.",UNIQUE:"Returns a unique values from a range or array",SLOPE:"Returns the slope of the line from linear regression of the data points.",DefineNameExists:"This name already exists, try different name.",DefineNameInValid:"The name that you entered is not valid.",CircularReference:"When a formula refers to one or more circular references, this may result in an incorrect calculation.",ShowRowsWhere:"Show rows where:",OR:"OR",AND:"AND",CustomFilterDatePlaceHolder:"Choose a date",CustomFilterPlaceHolder:"Enter the value",CustomFilter:"Custom Filter",Between:"Between",DateTimeFilter:"DateTime Filters",Undo:"Undo",Redo:"Redo",DateFilter:"Date Filters",TextFilter:"Text Filters",NumberFilter:"Number Filters",ClearFilter:"Clear Filter",NoResult:"No Matches Found",FilterFalse:"False",FilterTrue:"True",Blanks:"Blanks",SelectAll:"Select All",GreaterThanOrEqual:"Greater Than Or Equal",GreaterThan:"Greater Than",LessThanOrEqual:"Less Than Or Equal",LessThan:"Less Than",NotEqual:"Not Equal",Equal:"Equal",Contains:"Contains",EndsWith:"Ends With",StartsWith:"Starts With",ClearButton:"Clear",FilterButton:"Filter",CancelButton:"Cancel",OKButton:"OK",Search:"Search",ProtectSheet:"Protect Sheet",UnprotectSheet:"Unprotect Sheet",LockCells:"Lock Cells",SelectCells:"Select Locked cells",SelectUnLockedCells:"Select Unlocked Cells",FormatCells:"Format cells",FormatRows:"Format rows",FormatColumns:"Format columns",InsertLinks:"Insert links",ProtectContent:"Protect the contents of locked cells",ProtectAllowUser:" Allow all users of this worksheet to:",EditAlert:"The cell you're trying to change is protected. To make change, unprotect the sheet.",SearchWithin:"Search within",SearchBy:"Search by",Reference:"Reference",DataValidation:"Data Validation",CLEARALL:"Clear All",APPLY:"Apply",CellRange:"Cell Range",Allow:"Allow",Data:"Data",Minimum:"Minimum",Maximum:"Maximum",IgnoreBlank:"Ignore blank",WholeNumber:"Whole Number",Decimal:"Decimal",Date:"Date",TextLength:"Text Length",List:"List",NotBetween:"Not between",EqualTo:"Equal to",NotEqualTo:"Not equal to",Greaterthan:"Greater than",Lessthan:"Less than",GreaterThanOrEqualTo:"Greater than or equal to",LessThanOrEqualTo:"Less than or equal to",InCellDropDown:"In-cell-dropdown",Sources:"Sources",Value:"Value",Retry:"Retry",EnterValue:"Enter value",DialogError:"The list source must be a reference to single row or column.",MinMaxError:"The Maximum must be greater than or equal to the Minimum.",MoreValidation:`This selection contains more than one validation. 
 Erase current settings and continue?`,FileNameError:`A file name can't contain characters like \\ / : * ? " < > [ ] |`,ListLengthError:"The list values allows only upto 256 charcters",ValidationError:"This value doesn't match the data validation restrictions defined for the cell.",EmptyError:"You must enter a value",ClearHighlight:"Clear Highlight",HighlightInvalidData:"Highlight Invalid Data",ClearValidation:"Clear Validation",HighlightCellsRules:"Highlight Cells Rules",CFEqualTo:"Equal To",TextThatContains:"Text that Contains",Save:"Save",EmptyFileName:"File name cannot be empty.",LargeName:"The name is too long.",ADateOccuring:"A Date Occuring",DuplicateValues:"Duplicate Values",TopBottomRules:"Top/Bottom Rules",Top10Items:"Top 10 Items",Top10:"Top 10",Bottom10Items:"Bottom 10 Items",Bottom10:"Bottom 10",AboveAverage:"Above Average",BelowAverage:"Below Average",FormatCellsGreaterThan:"Format cells that are GREATER THAN:",FormatCellsLessThan:"Format cells that are LESS THAN:",FormatCellsBetween:"Format cells that are BETWEEN:",FormatCellsEqualTo:"Format cells that are EQUAL TO:",FormatCellsThatContainTheText:"Format cells that contain the text:",FormatCellsThatContainADateOccurring:"Format cells that contain a date occurring:",FormatCellsDuplicate:"Format cells that contain:",FormatCellsTop:"Format cells that rank in the TOP:",FormatCellsBottom:"Format cells that rank in the BOTTOM:",FormatCellsAbove:"Format cells that are ABOVE AVERAGE:",FormatCellsBelow:"Format cells that are BELOW AVERAGE:",With:"with",DataBars:"Data Bars",ColorScales:"Color Scales",IconSets:"Icon Sets",ClearRules:"Clear Rules",SelectedCells:"Clear Rules from Selected Cells",EntireSheet:"Clear Rules from Entire Sheet",ISNUMBER:"Returns true when the value parses as a numeric value.",ROUND:"Rounds a number to a specified number of digits.",GEOMEAN:"Returns the geometric mean of an array or range of positive data.",POWER:"Returns the result of a number raised to power",LOG:"Returns the logarithm of a number to the base that you specify.",TRUNC:"Returns the truncated value of a number to a specified number of decimal places.",EXP:"Returns e raised to the power of the given number.",Clear:"Clear",ClearContents:"Clear Contents",ClearAll:"Clear All",ClearFormats:"Clear Formats",ClearHyperlinks:"Clear Hyperlinks",LightRedFillWithDarkRedText:"Light Red Fill with Dark Red Text",YellowFillWithDarkYellowText:"Yellow Fill with Dark Yellow Text",GreenFillWithDarkGreenText:"Green Fill with Dark Green Text",RedFill:"Red Fill",RedText:"Red Text",Duplicate:"Duplicate",Unique:"Unique",And:"and",WebPage:"WEB PAGE",ThisDocument:"THIS DOCUMENT",DisplayText:"Display Text",Url:"URL",CellReference:"Cell Reference",DefinedNames:"Defined Names",EnterTheTextToDisplay:"Enter the text to display",EnterTheUrl:"Enter the URL",Image:"Image",ConditionalFormatting:"Conditional Formatting",BlueDataBar:"Blue Data Bar",GreenDataBar:"Green Data Bar",RedDataBar:"Red Data Bar",OrangeDataBar:"Orange Data Bar",LightblueDataBar:"Light blue Data Bar",PurpleDataBar:"Purple Data Bar",GYRColorScale:"Green - Yellow - Red Color Scale",RYGColorScale:"Red - Yellow - Green Color Scale",GWRColorScale:"Green - White - Red Color Scale",RWGColorScale:"Red - White - Green Color Scale",BWRColorScale:"Blue - White - Red Color Scale",RWBColorScale:"Red - White - Blue Color Scale",WRColorScale:"White - Red Color Scale",RWColorScale:"Red - White Color Scale",GWColorScale:"Green - White Color Scale",WGColorScale:"White - Green Color Scale",GYColorScale:"Green - Yellow Color Scale",YGColorScale:"Yellow - Green Color Scale",ThreeArrowsColor:"3 Arrows (Colored)",ThreeArrowsGray:"3 Arrows (Gray)",ThreeTriangles:"3 Triangles",FourArrowsColor:"4 Arrows (Gray)",FourArrowsGray:"4 Arrows (Colored)",FiveArrowsColor:"5 Arrows (Gray)",FiveArrowsGray:"5 Arrows (Colored)",ThreeTrafficLights1:"3 Traffic Lights (Unrimmed)",ThreeTrafficLights2:"3 Traffic Lights (Rimmed)",ThreeSigns:"3 Signs",FourTrafficLights:"4 Traffic Lights",RedToBlack:"Red To Black",ThreeSymbols1:"3 Symbols (Circled)",ThreeSymbols2:"3 Symbols (Uncircled)",ThreeFlags:"3 Flags",ThreeStars:"3 Stars",FourRatings:"4 Ratings",FiveQuarters:"5 Quarters",FiveRatings:"5 Ratings",FiveBoxes:"5 Boxes",Chart:"Chart",Column:"Column",Bar:"Bar",Area:"Area",Pie:"Pie",Doughnut:"Doughnut",PieAndDoughnut:"Pie/Doughnut",Line:"Line",Radar:"Radar",Scatter:"Scatter",ChartDesign:"Chart Design",ClusteredColumn:"Clustered Column",StackedColumn:"Stacked Column",StackedColumn100:"100% Stacked Column",ClusteredBar:"Clustered Bar",StackedBar:"Stacked Bar",StackedBar100:"100% Stacked Bar",StackedArea:"Stacked Area",StackedArea100:"100% Stacked Area",StackedLine:"Stacked Line",StackedLine100:"100% Stacked Line",AddChartElement:"Add Chart Element",Axes:"Axes",AxisTitle:"Axis Title",ChartTitle:"Chart Title",DataLabels:"Data Labels",Gridlines:"Gridlines",Legends:"Legends",PrimaryHorizontal:"Primary Horizontal",PrimaryVertical:"Primary Vertical",None:"None",AboveChart:"Above Chart",Center:"Center",InsideEnd:"Inside End",InsideBase:"Inside Base",OutsideEnd:"OutSide End",PrimaryMajorHorizontal:"Primary Major Horizontal",PrimaryMajorVertical:"Primary Major Vertical",PrimaryMinorHorizontal:"Primary Minor Horizontal",PrimaryMinorVertical:"Primary Minor Vertical",Right:"Right",Left:"Left",Bottom:"Bottom",Top:"Top",SwitchRowColumn:"Switch Row/Column",ChartTheme:"Chart Theme",ChartType:"Chart Type",Material:"Material",Fabric:"Fabric",Bootstrap:"Bootstrap",HighContrastLight:"HighContrast Light",MaterialDark:"Material Dark",FabricDark:"Fabric Dark",HighContrast:"HighContrast",BootstrapDark:"Bootstrap Dark",Bootstrap4:"Bootstrap4",Bootstrap5Dark:"Bootstrap5 Dark",Bootstrap5:"Bootstrap5",Tailwind:"Tailwind",TailwindDark:"TailwindDark",VerticalAxisTitle:"Vertical Axis Title",HorizontalAxisTitle:"Horizontal Axis Title",EnterTitle:"Enter Title",ProtectWorkbook:"Protect Workbook",Password:"Password (optional):",unProtectPassword:"Password",EnterThePassword:"Enter the password",ConfirmPassword:"Confirm Password",EnterTheConfirmPassword:"Re-enter your password",PasswordAlert:"Confirmation password is not identical",UnProtectWorkbook:"Unprotect Workbook",UnProtectPasswordAlert:"The password you supplied is not correct.",InCorrectPassword:"Unable to open the file or worksheet with the given password",PasswordAlertMsg:"Please enter the password",ConfirmPasswordAlertMsg:"Please enter the confirm password",IsProtected:"is protected",PDF:"PDF document",AutoFillMergeAlertMsg:"To do this, all the merged cells need to be the same size",FillSeries:"Fill Series",CopyCells:"Copy Cells",FillFormattingOnly:"Fill Formatting Only",FillWithoutFormatting:"Fill Without Formatting",CustomFormat:"Custom Number Formats",CustomFormatSample:"Type",UnProtectWorksheet:"Unprotect Sheet",ReEnterPassword:"Re-enter password to proceed",SheetPassword:"Password to unprotect sheet:",Fluent:"Fluent",FluentDark:"FluentDark"},Il=ae(28197),tA=function(){function o(t){this.colGroupWidth=30,this.parent=t,this.col=t.createElement("col"),this.rowRenderer=t.serviceLocator.getService("row"),this.cellRenderer=t.serviceLocator.getService("cell"),this.addEventListener()}return o.prototype.refreshSelectALLContent=function(){var t,e=this.parent.getActiveSheet();if(e.frozenColumns||e.frozenRows){var i=this.getSelectAllTable().querySelector("thead"),r=this.rowRenderer.render();i.appendChild(r),t=this.parent.createElement("th",{className:"e-select-all-cell"}),r.appendChild(t)}else t=this.headerPanel.firstElementChild,t.classList.add("e-select-all-cell");t.appendChild(this.parent.createElement("button",{className:"e-selectall",id:this.parent.element.id+"_select_all"}))},o.prototype.updateLeftColGroup=function(t,e){t&&(this.colGroupWidth=t),e||(e=this.getRowHeaderPanel());var i=e.querySelector("table"),r=this.parent.getActiveSheet(),n;if(t)i.querySelector("colgroup").firstElementChild.style.width=this.colGroupWidth+"px";else{n=this.parent.createElement("colgroup");var s=this.col.cloneNode();s.style.width=this.colGroupWidth+"px",n.appendChild(s),i.insertBefore(n,i.querySelector("tbody"))}(r.frozenRows||r.frozenColumns)&&(i=this.getSelectAllTable(),t?i.querySelector("colgroup").firstElementChild.style.width=this.colGroupWidth+"px":i.insertBefore(n.cloneNode(!0),i.querySelector("thead"))),this.setPanelWidth(r,e),this.setPanelHeight(r)},o.prototype.setPanelWidth=function(t,e){var i=this.getScrollSize(!0),r=this.getRowHeaderWidth(t),n=this.parent.enableRtl?"right":"left";if(t.frozenColumns){var s=document.getElementById(this.parent.element.id+"_sheet").getElementsByClassName("e-frozen-column")[0];s.style.height="calc(100% - "+i+"px)",s.style[n]=r-G(1)+"Px",s.style.display=""}this.setHeaderPanelWidth(this.getSelectAllContent(),r),this.getColHeaderPanel().style.width="calc(100% - "+r+"px)",this.getColHeaderPanel().style[n]=r+"px",this.setHeaderPanelWidth(e,r),this.getContentPanel().style.width="calc(100% - "+r+"px)",this.getContentPanel().style[n]=r+"px";var l=this.contentPanel.nextElementSibling?this.contentPanel.nextElementSibling:null;l&&(i?l.style.height=i+1+"px":(l.style.height="1px",l.style.borderTopWidth="0px"),l=l.firstElementChild,l.style[n]=r+"px",l.style.width="calc(100% - "+r+"px)",a.AR.userAgent.indexOf("Mac OS")>-1&&a.AR.info.name==="safari"&&(l.style.height="7px",l.style.top="-7px"))},o.prototype.getScrollSize=function(t){var e=parseInt(this.headerPanel.style[this.parent.enableRtl?"margin-left":"margin-right"],10);return e?e+(t?1:0):0},o.prototype.setHeaderPanelWidth=function(t,e){var i=[].slice.call(t.querySelectorAll("col.e-empty"));i.forEach(function(r){e+=parseInt(r.style.width,10)}),t.style.width=e+"px"},o.prototype.setPanelHeight=function(t){var e=this.getScrollSize(!0);if(t.frozenRows){var i=this.getColHeaderHeight(t);!t.showHeaders&&!t.frozenColumns?this.headerPanel.style.height=i+"px":this.headerPanel.style.height="",this.contentPanel.style.height="calc(100% - "+(i+e)+"px)";var r=document.getElementById(this.parent.element.id+"_sheet").getElementsByClassName("e-frozen-row")[0];r.style.width=a.AR.isDevice?"100%":"calc(100% - "+e+"px)",r.style.top=i-1-(t.showHeaders?1:0)+"px",r.style.display=""}else this.contentPanel.style.height="calc(100% - "+((t.showHeaders?G(31):0)+e)+"px)"},o.prototype.renderPanel=function(){this.contentPanel=this.parent.createElement("div",{className:"e-main-panel"});var t=this.parent.getActiveSheet(),e=this.parent.element.id;this.contentPanel.appendChild(this.parent.createElement("div",{className:"e-row-header",id:e+"_row_header"})),this.initHeaderPanel(),this.parent.allowScrolling&&this.parent.scrollModule.setPadding();var i=document.getElementById(this.parent.element.id+"_sheet");t.frozenColumns&&i.classList.add("e-frozen-columns"),t.frozenRows&&i.classList.add("e-frozen-rows"),this.updateHideHeaders(t,i),t.showGridLines||i.classList.add("e-hide-gridlines");var r=this.contentPanel.appendChild(this.parent.createElement("div",{className:"e-sheet-content",id:e+"_main_content"}));this.parent.allowScrolling||(r.style.overflow="hidden"),t.frozenRows&&i.appendChild(this.parent.createElement("div",{className:"e-frozen-row",styles:"display: none"})),t.frozenColumns&&i.appendChild(this.parent.createElement("div",{className:"e-frozen-column",styles:"display: none"})),a.AR.userAgent.indexOf("Mac OS")>-1&&a.AR.info.name==="safari"&&i.classList.add("e-mac-safari")},o.prototype.initHeaderPanel=function(){var t=this.parent.element.id;this.headerPanel=this.parent.createElement("div",{className:"e-header-panel"}),this.headerPanel.appendChild(this.parent.createElement("div",{className:"e-selectall-container",id:t+"_selectall"})),this.headerPanel.appendChild(this.parent.createElement("div",{className:"e-column-header",id:t+"_col_header"}))},o.prototype.createHeaderTable=function(){var t=this.contentPanel.querySelector(".e-row-header"),e=this.parent.getActiveSheet();(e.frozenRows||e.frozenColumns)&&this.updateTable(e.frozenRows?["thead","tbody"]:["thead"],"selectall",this.headerPanel.querySelector(".e-selectall-container")),this.updateTable(e.frozenRows?["thead","tbody"]:["thead"],"colhdr",this.headerPanel.querySelector(".e-column-header")),this.updateTable(["tbody"],"rowhdr",t),this.updateLeftColGroup(null,t)},o.prototype.updateTable=function(t,e,i){var r=this,n=this.parent.createElement("table",{className:"e-table",attrs:{role:"grid"}});n.classList.add("e-"+e+"-table"),i.appendChild(n),t.forEach(function(s){n.appendChild(r.parent.createElement(s))})},o.prototype.renderTable=function(t){var e=this,i,r,n,s=this.parent.getActiveSheet(),l=document.createDocumentFragment();if(l.appendChild(this.headerPanel),l.appendChild(this.contentPanel),this.parent.allowScrolling){var h=this.parent.createElement("div",{className:"e-scrollbar"});h.appendChild(this.parent.createElement("div",{className:"e-scroller"})),l.appendChild(h)}this.createHeaderTable(),this.updateTable(["tbody"],"content",this.contentPanel.lastElementChild);var c=this.parent.createElement("colgroup"),u,p=this.contentPanel.querySelector(".e-sheet-content tbody");this.refreshSelectALLContent();var f=this.getSelectAllContent().querySelector("colgroup"),g=this.getRowHeaderPanel().querySelector("colgroup"),C=this.getSelectAllContent().querySelector("thead .e-header-row"),L=this.contentPanel.querySelector(".e-row-header tbody"),D=this.getSelectAllContent().querySelector("tbody"),R=this.headerPanel.querySelector(".e-column-header thead"),B=this.headerPanel.querySelector(".e-column-header tbody"),H=this.rowRenderer.render();R.appendChild(H),this.getColHeaderTable().insertBefore(c,R);var j=this.parent.frozenRowCount(s),W=this.parent.frozenColCount(s),ne=(0,pe.Sxm)(s,W-1,!1,"columns");this.parent.notify(E.lu,{top:t.top,left:t.left});var ie=s.colCount.toString(),me=s.colCount.toString(),ve=t.top&&t.left?"RowColumn":t.top?"Row":t.left?"Column":"";this.parent.getColHeaderTable().setAttribute("aria-colcount",ie),this.parent.getRowHeaderTable().setAttribute("aria-rowcount",me);var Ee;(0,a.Y4)(this.parent.getContentTable(),{"aria-rowcount":me,"aria-colcount":ie}),t.cells.forEach(function(le,de){if(i=(0,pe.dK5)(de),(i[1]===t.indexes[1]||!r)&&(n=e.rowRenderer.render(i[0],!0),W&&j&&i[1]<W&&i[0]<j?(Ee=D.querySelector(".e-empty"),Ee?D.insertBefore(n,Ee):D.appendChild(n),r=n):W&&i[1]<W?(L.appendChild(n),r=n):(r=e.rowRenderer.render(i[0]),j&&i[0]<j?(Ee=B.querySelector(".e-empty"),Ee?B.insertBefore(r,Ee):B.appendChild(r)):p.appendChild(r),i[1]===t.indexes[1]&&(j&&i[0]<j?D.appendChild(n):L.appendChild(n))),i[1]===t.indexes[1]&&e.cellRenderer.renderRowHeader(i[0],n)),e.cellRenderer.render({colIdx:i[1],rowIdx:i[0],cell:le,address:de,lastCell:i[1]===t.indexes[3],isHeightCheckNeeded:!0,row:r,hRow:n,pRow:r.previousSibling,pHRow:n.previousSibling,isRefreshing:t.isRefreshing,first:ve?ve.includes("Row")?i[0]===t.indexes[0]?"Row":ve.includes("Column")&&i[1]===t.indexes[1]?"Column":"":i[1]===t.indexes[1]?"Column":"":""}),W&&i[1]===ne&&(r=null),le&&le.format&&((0,w.AXw)(le.format)||le.format.indexOf("*")>-1)&&e.parent.notify(w.eYQ,{cell:le,value:le.value,format:le.format,rowIndex:i[0],colIndex:i[1],td:e.parent.getCell(i[0],i[1])}),i[0]===t.indexes[0])if(W&&i[1]<W){u=e.updateCol(s,i[1],f);var fe=g.querySelector(".e-empty");fe?g.insertBefore(u.cloneNode(!0),fe):g.appendChild(u.cloneNode(!0)),e.cellRenderer.renderColHeader(i[1],C)}else e.updateCol(s,i[1],c),e.cellRenderer.renderColHeader(i[1],H)}),this.parent[E.NB]&&this.parent[E.Vi](),p.parentElement.insertBefore(c.cloneNode(!0),p),$(function(){if(!!e.parent){var le=e.parent.getMainContent(),de=document.getElementById(e.parent.element.id+"_sheet");if(de.childElementCount>2&&de.querySelector(".e-header-panel")!==e.headerPanel&&J(de),de.appendChild(l),de.style.backgroundColor="",e.checkRowHeightChanged(t,s),t.top&&(le.parentElement.scrollTop=t.top),t.left&&(le.scrollLeft=t.left,e.parent.getColumnHeaderContent().scrollLeft=t.left),e.parent.notify(E.eT,t),e.checkTableWidth(s),e.parent.notify(E.vJ,{action:"renderEditor"}),!t.initLoad&&!e.parent.isOpen&&e.parent.hideSpinner(),oe(le,{busy:!1}),e.parent.trigger(E.ru,{}),e.parent.isEdit&&e.parent.notify(E.aW,null),t.initLoad){var fe=!0;if(e.parent.scrollSettings.enableVirtualization){for(var Le=0;Le<s.ranges.length;Le++)if(s.ranges[Le].info.count-1>e.parent.viewport.bottomIndex){fe=!1;break}}fe?e.parent.isReact?setTimeout(function(){!e.parent||e.triggerCreatedEvent()}):e.triggerCreatedEvent():e.parent.isOpen||e.parent.hideSpinner()}}})},o.prototype.triggerCreatedEvent=function(){this.parent.isOpen||this.parent.hideSpinner(),this.parent.createdHandler&&(this.parent.createdHandler.observers?this.parent[E.i2].observers=this.parent.createdHandler.observers:this.parent.setProperties({created:this.parent.createdHandler},!0),this.parent.createdHandler=void 0,this.parent.trigger(E.i2,null),this.parent.notify(E.V9,null))},o.prototype.checkRowHeightChanged=function(t,e){var i={top:t.top,left:t.left,sheet:e};this.parent.notify(E.M6,i),t.top!=i.top&&(this.parent.scrollModule&&this.parent.scrollModule.offset.top.idx&&i.top-t.top<(0,w.NEZ)(e,this.parent.scrollModule.offset.top.idx)&&(this.parent.scrollModule.offset.top.size=i.top),t.top=i.top),t.left!=i.left&&(this.parent.scrollModule&&this.parent.scrollModule.offset.left.idx&&i.left-t.left<(0,Il.IQ)(e,this.parent.scrollModule.offset.left.idx)&&(this.parent.scrollModule.offset.left.size=i.left),t.left=i.left)},o.prototype.checkTableWidth=function(t){if(this.parent.scrollSettings.isFinite&&!this.parent.scrollSettings.enableVirtualization&&t.colCount-1===this.parent.viewport.rightIndex){var e=(0,Il.pG)(t,this.parent.viewport.leftIndex+this.parent.frozenColCount(t),this.parent.viewport.rightIndex),i=this.getRowHeaderWidth(t),r=this.getScrollSize();e<this.contentPanel.getBoundingClientRect().width-i-r?(this.getContentPanel().style.width=e+"px",this.getColHeaderPanel().style.width=e+"px"):this.getContentPanel().style.width.includes("calc")||(this.getContentPanel().style.width="calc(100% - "+i+"px)",this.getColHeaderPanel().style.width="calc(100% - "+i+"px)")}},o.prototype.refreshColumnContent=function(t){var e=this,i,r,n,s=0,l,h,c=this.parent.getActiveSheet(),u=document.createDocumentFragment(),p=document.createDocumentFragment(),f=this.parent.element.querySelector(".e-sheet-content tbody"),g=this.parent.element.querySelector(".e-column-header tbody"),C=this.parent.element.querySelector(".e-sheet-content colgroup");C=C.cloneNode(),u.appendChild(C),f=u.appendChild(f.cloneNode(!0));var L=C.cloneNode();p.appendChild(L);var D;D=this.parent.element.querySelector(".e-column-header thead"),D=p.appendChild(D.cloneNode(!0));var R=D.querySelector("tr");R.innerHTML="";var B=this.parent.frozenRowCount(c),H=this.parent.frozenColCount(c);B&&(g=p.appendChild(g.cloneNode(!0)));var j=(0,pe.Sxm)(c,B-1,!1),W=this.parent.scrollSettings.enableVirtualization&&this.parent.viewport.topIndex!==(0,pe.Sxm)(c,0,!0);t.cells.forEach(function(ie,me){if(i=(0,pe.dK5)(me),i[0]===t.indexes[0]&&(h=e.updateCol(c,i[1],L),C.appendChild(h.cloneNode()),e.cellRenderer.renderColHeader(i[1],R)),i[1]-H===t.indexes[1])if(i[0]<B?r=g.children[s]:r=f.children[s],r)r.innerHTML="",s++;else return;!r||(l=e.cellRenderer.render({colIdx:i[1],rowIdx:i[0],cell:ie,address:me,row:r,pRow:r.previousSibling,first:!t.skipUpdateOnFirst&&i[1]===t.indexes[1]?"Column":W&&i[0]===t.indexes[0]?"Row":"",isRefreshing:!0}),e.checkColMerge(i,t.indexes,l,ie),B&&i[0]===j&&(s=0))});var ne=function(){n=e.getColHeaderTable(),J(n),n.appendChild(p),n=e.getContentTable(),J(n),n.appendChild(u),e.parent.notify(E.e2,{refresh:"Column",prevRowColCnt:t.prevRowColCnt}),e.parent.isEdit&&e.parent.notify(E.UD,{}),e.parent.allowChart&&e.parent.notify(E.uU,null),e.parent.isOpen||e.parent.hideSpinner(),oe(e.parent.getMainContent(),{busy:!1})};t.insertDelete?ne():$(function(){return ne()})},o.prototype.refreshRowContent=function(t){var e=this,i,r,n,s=this.colGroupWidth,l=this.parent.getActiveSheet(),h,c=document.createDocumentFragment(),u=this.parent.createElement("tbody"),p=document.createDocumentFragment(),f=u.cloneNode();p.appendChild(f),c.appendChild(u);var g=this.parent.frozenColCount(l),C=(0,pe.Sxm)(l,g-1,!1,"columns"),L=this.parent.scrollSettings.enableVirtualization&&this.parent.viewport.leftIndex!==(0,pe.Sxm)(l,0,!0,"columns");t.cells.forEach(function(D,R){i=(0,pe.dK5)(R),(i[1]===t.indexes[1]||!r)&&(n=e.rowRenderer.render(i[0],!0),g&&i[1]<g?(f.appendChild(n),r=n):(i[1]===t.indexes[1]&&f.appendChild(n),r=e.rowRenderer.render(i[0]),u.appendChild(r)),i[1]===t.indexes[1]&&(e.cellRenderer.renderRowHeader(i[0],n),s=se(i[0]+1))),g&&(n=f.lastElementChild||n),h=e.cellRenderer.render({rowIdx:i[0],colIdx:i[1],cell:D,address:R,lastCell:i[1]===t.indexes[3],row:r,hRow:n,pRow:r.previousSibling,pHRow:n.previousSibling,isHeightCheckNeeded:!0,first:!t.skipUpdateOnFirst&&i[0]===t.indexes[0]?"Row":L&&i[1]===t.indexes[1]?"Column":"",isRefreshing:!0}),e.checkRowMerge(i,t.indexes,h,D),g&&i[1]===C&&(r=null)}),this.colGroupWidth!==s&&this.updateLeftColGroup(s),this.contentPanel.querySelector(".e-row-header tbody")&&((0,a.og)(this.contentPanel.querySelector(".e-row-header tbody")),this.getRowHeaderTable().appendChild(p)),this.contentPanel.querySelector(".e-sheet-content tbody")&&((0,a.og)(this.contentPanel.querySelector(".e-sheet-content tbody")),this.getContentTable().appendChild(c)),this.parent.notify(E.e2,{refresh:"Row",prevRowColCnt:t.prevRowColCnt}),this.parent.allowChart&&this.parent.notify(E.uU,{}),this.parent.isEdit&&this.parent.notify(E.UD,null),this.parent.isOpen||this.parent.hideSpinner(),oe(this.parent.getMainContent(),{busy:!1})},o.prototype.updateCol=function(t,e,i){var r=this.col.cloneNode();if(r.style.width=(0,a.Ac)((0,Il.IQ)(t,e,null,!0)),i){var n=i.querySelector(".e-empty");return n?i.insertBefore(r,n):i.appendChild(r)}else return r},o.prototype.updateColContent=function(t){var e=this;$(function(){var i,r,n,s,l=0,h,c=e.parent.getActiveSheet(),u=e.parent.element.querySelector(".e-column-header .e-header-row"),p=u.firstElementChild,f=e.parent.element.querySelector(".e-sheet-content colgroup"),g=e.parent.element.querySelector(".e-column-header colgroup"),C=f.firstElementChild,L,D=g.firstElementChild,R=e.parent.element.querySelector(".e-sheet-content tbody"),B=e.parent.element.querySelector(".e-column-header tbody"),H=e.parent.frozenRowCount(c),j=e.parent.frozenColCount(c),W=(0,pe.Sxm)(c,H-1,!1),ne=(0,pe.Sxm)(c,t.indexes[0],!0),ie;t.cells.forEach(function(me,ve){if(!L){if(i=(0,pe.dK5)(ve),t.direction==="first"&&i[1]===t.indexes[1]&&e.checkColMerge([i[0],e.parent.viewport.leftIndex+j],t.indexes,((i[0]<H?B:R).rows[l]||{cells:[]}).cells[t.indexes[3]-t.indexes[1]+1],(0,w.$Su)(i[0],e.parent.viewport.leftIndex+j,c)||{}),i[0]===ne&&(t.direction==="last"?(h=e.col.cloneNode(),h.style.width=(0,a.Ac)((0,Il.IQ)(c,i[1],null,!0)),f.insertBefore(h,C),g.insertBefore(h.cloneNode(),D),e.cellRenderer.renderColHeader(i[1],u,p)):(h=e.updateCol(c,i[1],f),g.appendChild(h.cloneNode()),e.cellRenderer.renderColHeader(i[1],u)),e.parent.scrollSettings.enableVirtualization&&t.direction&&((0,a.og)(f[t.direction+"ElementChild"]),(0,a.og)(g[t.direction+"ElementChild"]),(0,a.og)(u[t.direction+"ElementChild"]))),i[1]===t.indexes[1]){if(i[0]<H)r=B.children[l];else if(r=R.children[l],!r){L=!0;return}l++,n=r.firstElementChild}ie={colIdx:i[1],rowIdx:i[0],cell:me,address:ve,row:r,lastCell:i[1]===t.indexes[3],isHeightCheckNeeded:t.direction==="first",first:t.direction==="last"&&!t.skipUpdateOnFirst&&i[1]===t.indexes[1]?"Column":"",checkNextBorder:t.direction==="last"&&i[3]===t.indexes[3]?"Column":"",isRefreshing:t.direction==="first"},t.direction==="last"?(ie.refChild=n,s=e.cellRenderer.render(ie),e.checkColMerge(i,t.indexes,s,me,((i[0]<H?B:R).rows[l-1]||{cells:[]}).cells[1])):s=e.cellRenderer.render(ie),e.parent.scrollSettings.enableVirtualization&&t.direction&&(0,a.og)(r[t.direction+"ElementChild"]),H&&i[0]===W&&(l=0)}}),e.parent.notify(E.e2,{refresh:"Column",prevRowColCnt:t.prevRowColCnt}),e.parent.allowChart&&e.parent.notify(E.uU,null),e.parent.isEdit&&e.parent.notify(E.UD,{}),e.parent.isOpen||e.parent.hideSpinner(),oe(e.parent.getMainContent(),{busy:!1})})},o.prototype.updateRowContent=function(t){var e=this,i=this.colGroupWidth,r,n,s,l=this.parent.getActiveSheet(),h=0,c=this.parent.getMainContent().querySelector("tbody"),u=this.parent.getRowHeaderContent().querySelector("tbody"),p=document.createDocumentFragment(),f,g=document.createDocumentFragment();this.parent.showSpinner();var C=this.parent.frozenColCount(l),L=this.parent.frozenRowCount(l),D;t.cells.forEach(function(R,B){f=(0,pe.dK5)(B),t.direction==="first"&&f[0]===t.indexes[0]&&(D===void 0&&(D=(f[1]<C?u:c).rows[t.indexes[2]-t.indexes[0]+1]||null),e.checkRowMerge([e.parent.viewport.topIndex+L,f[1]],t.indexes,(D||{cells:[]}).cells[f[1]<C?h+1:h],(0,w.$Su)(e.parent.viewport.topIndex+L,f[1],l)||{})),(f[1]===t.indexes[1]||!r)&&(n=e.rowRenderer.render(f[0],!0),C&&f[1]<C?(p.appendChild(n),r=n):(r=e.rowRenderer.render(f[0]),g.appendChild(r),f[1]===t.indexes[1]&&p.appendChild(n),e.parent.scrollSettings.enableVirtualization&&t.direction&&(0,a.og)(c[t.direction+"ElementChild"])),f[1]===t.indexes[1]&&(e.cellRenderer.renderRowHeader(f[0],n),i=se(f[0]+1),e.parent.scrollSettings.enableVirtualization&&t.direction&&(0,a.og)(u[t.direction+"ElementChild"]))),C&&(n=p.lastElementChild||n),s=e.cellRenderer.render({colIdx:f[1],rowIdx:f[2],cell:R,address:B,lastCell:f[1]===t.indexes[3],row:r,pHRow:n.previousSibling,checkNextBorder:t.direction==="last"&&f[2]===t.indexes[2]?"Row":"",pRow:r.previousSibling,isHeightCheckNeeded:t.direction==="first"||t.direction==="",hRow:n,first:t.direction==="last"&&!t.skipUpdateOnFirst&&f[0]===t.indexes[0]?"Row":"",isRefreshing:t.direction==="first"}),t.direction==="last"&&c.rows.length&&e.checkRowMerge(f,t.indexes,s,R,(f[1]<C?u:c).rows[0].cells[f[1]<C?h+1:h]),h++,C&&f[1]===C-1&&(r=null,D=void 0,h=0)}),this.colGroupWidth!==i&&this.updateLeftColGroup(i),t.direction==="last"?(u.insertBefore(p,u.firstElementChild),c.insertBefore(g,c.firstElementChild)):(u.appendChild(p),c.appendChild(g)),this.parent.scrollSettings.enableVirtualization&&this.parent.notify(E.e2,{refresh:"Row",prevRowColCnt:t.prevRowColCnt}),this.parent.isEdit&&this.parent.notify(E.UD,null),this.parent.allowChart&&this.parent.notify(E.uU,{}),this.parent.isOpen||this.parent.hideSpinner(),oe(this.parent.getMainContent(),{busy:!1})},o.prototype.checkRowMerge=function(t,e,i,r,n){if(this.parent.scrollSettings.enableVirtualization&&i&&(!(0,a.le)(r.rowSpan)||!(0,a.le)(r.colSpan))){var s=this.parent.frozenRowCount(this.parent.getActiveSheet());if(t[0]===this.parent.viewport.topIndex+s){if(r.rowSpan<0){var l={td:i,rowIdx:t[0],colIdx:t[1],isRow:!0,isFreezePane:!0};if(this.parent.notify(E.Sq,l),l.insideFreezePane)return;this.parent.viewport.topIndex+s>=e[0]&&this.refreshPrevMerge(e[0]+1,t[1])}n&&(n.colSpan>1||n.rowSpan>1)&&this.cellRenderer.refresh(t[0]+(e[2]-e[0])+1,t[1],null,n)}else if(r.rowSpan>1){var h=e[2]+1;t[0]+r.rowSpan-1>h&&t[0]<h&&this.refreshPrevMerge(h,t[1],this.parent.viewport.topIndex+s)}}},o.prototype.refreshPrevMerge=function(t,e,i){var r=this.parent.getCell(t,e,this.parent.getRow(i||0,null,e));r&&r.rowSpan>1&&this.cellRenderer.refresh(t,e,null,r)},o.prototype.checkColMerge=function(t,e,i,r,n){if(this.parent.scrollSettings.enableVirtualization&&i&&t[1]===this.parent.viewport.leftIndex+this.parent.frozenColCount(this.parent.getActiveSheet())&&(!(0,a.le)(r.rowSpan)||!(0,a.le)(r.colSpan))){if(r.colSpan<0){var s={td:i,colIdx:t[1],rowIdx:t[0],isFreezePane:!0};if(this.parent.notify(E.Sq,s),s.insideFreezePane)return}n&&(n.colSpan>1||n.rowSpan>1)&&this.cellRenderer.refresh(t[0],t[1]+(e[3]-e[1])+1,null,n)}},o.prototype.toggleGridlines=function(){var t=document.getElementById(this.parent.element.id+"_sheet");this.parent.getActiveSheet().showGridLines?t.classList.remove("e-hide-gridlines"):t.classList.add("e-hide-gridlines")},o.prototype.showHideHeaders=function(){var t=this,e=this.parent.getActiveSheet();$(function(){if(e.showHeaders){var i=t.getContentPanel();t.setPanelWidth(e,t.getRowHeaderPanel()),t.setPanelHeight(e),document.getElementById(t.parent.element.id+"_sheet").classList.remove("e-hide-headers"),t.getColHeaderPanel().scrollLeft=i.scrollLeft,t.parent.selectRange(e.selectedRange)}else{if(t.updateHideHeaders(e,document.getElementById(t.parent.element.id+"_sheet")),t.setPanelHeight(e),t.parent.frozenColCount(e)||t.parent.frozenRowCount(e))t.setPanelWidth(e,t.getRowHeaderPanel()),t.parent.selectRange(e.selectedRange);else{t.getContentPanel().style.width="";var r=t.parent.enableRtl?"right":"left";t.getContentPanel().style[r]=""}t.getScrollElement().style.left=t.getRowHeaderWidth(e)+"px"}})},o.prototype.updateHideHeaders=function(t,e){t.showHeaders||e.classList.add("e-hide-headers")},o.prototype.rowHeightChanged=function(t){if(t.threshold||t.isHideShow){var e=this.parent.getActiveSheet();t.rowIdx<this.parent.frozenRowCount(e)&&this.setPanelHeight(e)}},o.prototype.colWidthChanged=function(t){if(t.threshold||t.isHideShow){var e=this.parent.getActiveSheet();t.colIdx<this.parent.frozenColCount(e)&&this.setPanelWidth(e,this.getRowHeaderPanel()),this.checkTableWidth(e)}},o.prototype.getRowHeaderWidth=function(t,e){var i=0;if(!e&&t.frozenColumns){var r=(0,pe.n53)(t.topLeftCell)[1];i=(0,Il.pG)(t,r,r+t.frozenColumns-1,!0)}return i+=t.showHeaders?G(this.colGroupWidth):0,i},o.prototype.getColHeaderHeight=function(t,e){var i=(0,pe.n53)(t.topLeftCell)[0];return(t.showHeaders&&!e?G(31):0)+(0,w.EB_)(t,i,i+t.frozenRows-1,!0)},o.prototype.getSelectAllContent=function(){return this.headerPanel.getElementsByClassName("e-selectall-container")[0]},o.prototype.getScrollElement=function(){var t=this.contentPanel.parentElement||this.contentPanel.nextElementSibling;return t&&t.querySelector(".e-scroller")},o.prototype.getSelectAllTable=function(){return this.headerPanel.getElementsByClassName("e-selectall-table")[0]},o.prototype.getColHeaderTable=function(){return this.headerPanel.getElementsByClassName("e-colhdr-table")[0]},o.prototype.getRowHeaderTable=function(){return this.contentPanel.getElementsByClassName("e-rowhdr-table")[0]},o.prototype.getContentTable=function(){return this.contentPanel.getElementsByClassName("e-content-table")[0]},o.prototype.getRowHeaderPanel=function(){return this.contentPanel.getElementsByClassName("e-row-header")[0]},o.prototype.getColHeaderPanel=function(){return this.headerPanel.getElementsByClassName("e-column-header")[0]},o.prototype.getContentPanel=function(){return this.contentPanel.getElementsByClassName("e-sheet-content")[0]},o.prototype.addEventListener=function(){this.parent.on(E.i2,this.triggerCreatedEvent,this),this.parent.on(E.QK,this.rowHeightChanged,this),this.parent.on(E.N2,this.colWidthChanged,this),this.parent.on(E.xn,this.destroy,this)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.removeEventListener=function(){this.parent.off(E.i2,this.triggerCreatedEvent),this.parent.off(E.QK,this.rowHeightChanged),this.parent.off(E.N2,this.colWidthChanged),this.parent.off(E.xn,this.destroy)},o}(),iA=function(){function o(t){this.parent=t,this.element=this.parent.createElement("tr",{attrs:{role:"row"}}),this.cellRenderer=t.serviceLocator.getService("cell")}return o.prototype.render=function(t,e,i){var r=this.element.cloneNode();if(t===void 0)return r.classList.add("e-header-row"),r;r.classList.add("e-row");var n=this.parent.getActiveSheet();(0,a.Y4)(r,{"aria-rowindex":(t+1).toString()});var s=(0,He.NE)(n,t,!0);return r.style.height=s+"px",s<20&&(r.style.lineHeight=s>0?s-1+"px":"0px"),e&&!i&&(s<20&&(r.style.lineHeight=s>=4?s-4+"px":s>0?s-1+"px":"0px",r.classList.contains("e-reach-fntsize")||r.classList.add("e-reach-fntsize")),(0,He.gS)(n,t+1)&&!(0,He.gS)(n,t-1)&&r.classList.add("e-hide-start"),t!==0&&(0,He.gS)(n,t-1)&&!(0,He.gS)(n,t+1)&&r.classList.add("e-hide-end")),r},o.prototype.refresh=function(t,e,i,r,n){var s=this,l=this.parent.getActiveSheet(),h;if(r)h=this.render(t,r,n),this.cellRenderer.renderRowHeader(t,h);else{var c,u,p=function(){for(;c<=u;)(0,He.Nq)(l,c)||s.cellRenderer.render({colIdx:c,rowIdx:t,cell:(0,He.$S)(t,c,l),address:(0,pe.qkm)(t,c),lastCell:c===u,row:h,hRow:i,isHeightCheckNeeded:!0,pRow:e,first:t===s.parent.viewport.topIndex&&(0,pe.Sxm)(l,t,!0)!==(0,pe.Sxm)(l,0,!0)?"Row":""}),c++},f=this.parent.frozenColCount(l);f&&(h=i,c=(0,pe.n53)(l.topLeftCell)[0],u=f-1,p()),h=this.render(t,r,n),c=this.parent.viewport.leftIndex+f,u=this.parent.viewport.rightIndex,p()}return h},o}(),rA=function(){function o(t){this.parent=t,this.element=this.parent.createElement("td"),this.th=this.parent.createElement("th",{className:"e-header-cell"}),this.tableRow=t.createElement("tr",{className:"e-row"}),this.parent.on(w.NK6,this.updateView,this),this.parent.on("calculateFormula",this.calculateFormula,this)}return o.prototype.renderColHeader=function(t,e,i){var r=this.th.cloneNode();(0,a.Y4)(r,{role:"columnheader","aria-colindex":(t+1).toString(),tabindex:"-1"});var n=(0,pe.AH9)(t+1);r.innerHTML=n;var s=this.parent.getActiveSheet();(0,He.Nq)(s,t+1)&&r.classList.add("e-hide-start"),t!==0&&(0,He.Nq)(s,t-1)&&r.classList.add("e-hide-end"),i?e.insertBefore(r,i):e.appendChild(r),this.parent.trigger("beforeCellRender",{cell:null,element:r,address:n,colIndex:t})},o.prototype.renderRowHeader=function(t,e,i){var r=this.element.cloneNode();(0,a.cn)([r],"e-header-cell"),(0,a.Y4)(r,{role:"rowheader",tabindex:"-1"}),r.innerHTML=(t+1).toString(),i?e.insertBefore(r,i):e.appendChild(r),this.parent.trigger("beforeCellRender",{cell:null,element:r,address:""+(t+1),rowIndex:t})},o.prototype.render=function(t){var e=this.parent.getActiveSheet();if(t.td=this.element.cloneNode(),t.td.className="e-cell",(0,a.Y4)(t.td,{role:"gridcell","aria-colindex":(t.colIdx+1).toString(),tabindex:"-1"}),this.checkMerged(t))return t.refChild?t.row.insertBefore(t.td,t.refChild):t.row.appendChild(t.td),t.td;t.isRefresh=!1,this.update(t),t.cell&&Object.keys(t.cell).length&&t.td&&(e.conditionalFormats&&e.conditionalFormats.length&&this.parent.notify(pe.uAN,{rowIdx:t.rowIdx,colIdx:t.colIdx,cell:t.cell,td:t.td,isChecked:!1}),t.td.childElementCount&&t.td.children[0].className==="e-cf-databar"&&(t.cell.style&&t.cell.style.fontSize&&(t.td.children[0].querySelector(".e-databar-value").style.fontSize=t.cell.style.fontSize),t.td.children[0].style.height="100%",t.td.children[0].firstElementChild.nextElementSibling.style.height="100%")),t.td.classList.contains("e-cell-template")||this.parent.notify(E.Yx,{td:t.td,rowIndex:t.rowIdx,colIndex:t.colIdx}),t.refChild?t.row.insertBefore(t.td,t.refChild):t.row.appendChild(t.td);var i={cell:t.cell,element:t.td,address:t.address,rowIndex:t.rowIdx,colIndex:t.colIdx,needHeightCheck:!1,row:t.row};if(this.parent.trigger("beforeCellRender",i),!e.rows[t.rowIdx]||!e.rows[t.rowIdx].customHeight){if(i.element&&i.element.children.length||i.needHeightCheck){var r=i.element.cloneNode(!0);r.style.width=(0,He.IQ)(e,t.colIdx,!0)+"px",this.tableRow.appendChild(r)}if(t.lastCell&&this.tableRow.childElementCount||i.needHeightCheck){var n=t.row||this.parent.getRow(t.rowIdx),s=(0,He.NE)(e,t.rowIdx),l=this.getRowHeightOnInit();if(l>s){var h=G(l);n.style.height=h+"px",(t.hRow||this.parent.getRow(t.rowIdx,this.parent.getRowHeaderTable())).style.height=h+"px",(0,He.vm)(e,t.rowIdx,l)}this.tableRow.innerHTML=""}}return this.setWrapByValue(e,t),i.element},o.prototype.setWrapByValue=function(t,e){e.cell&&!e.cell.wrap&&e.cell.value&&e.cell.value.toString().includes(`
`)&&((0,He.Jx)(e.rowIdx,e.colIdx,t,{wrap:!0},!0),this.parent.notify(pe.agw,{range:[e.rowIdx,e.colIdx,e.rowIdx,e.colIdx],wrap:!0,initial:!0,sheet:t,td:e.td,row:e.row,hRow:e.hRow}))},o.prototype.update=function(t){var e=this.parent.getActiveSheet(),i=this.processTemplates(t.cell,t.rowIdx,t.colIdx);if(i&&(typeof i=="string"?t.td.innerHTML=i:(J(t.td),t.td.appendChild(i)),t.td.classList.add("e-cell-template")),t.isRefresh){if(t.td.rowSpan&&(this.mergeFreezeRow(e,t.rowIdx,t.colIdx,t.td.rowSpan,t.row,!0),t.td.removeAttribute("rowSpan")),t.td.colSpan&&(this.mergeFreezeCol(e,t.rowIdx,t.colIdx,t.td.colSpan,!0),t.td.removeAttribute("colSpan")),this.checkMerged(t))return;if(t.cell&&!t.cell.hyperlink){var r=t.td.querySelector(".e-hyperlink");r&&(0,a.og)(r)}}t.cell&&t.cell.formula&&this.calculateFormula(t);var n={value:t.cell&&t.cell.value,type:t.cell&&(0,w.K2R)(t.cell.format),format:t.cell&&t.cell.format,formattedText:t.cell&&t.cell.value,onLoad:!0,isRightAlign:!1,cell:t.cell,rowIndex:t.rowIdx,colIndex:t.colIdx,isRowFill:!1,td:t.td};t.cell&&this.parent.notify(pe.eYQ,n),this.parent.refreshNode(t.td,{type:n.type,result:n.formattedText,curSymbol:(0,a.o5)(this.parent.locale,"USD"),isRightAlign:n.isRightAlign,value:n.value||"",isRowFill:n.isRowFill});var s={};if(t.cell){if(t.cell.style&&(t.cell.style.properties?s=(0,He.tC)(t.cell.style,!0):s=t.cell.style),t.cell.chart&&t.cell.chart.length>0&&this.parent.notify(pe.UyC,{chart:t.cell.chart,isInitCell:!0,range:(0,pe.qkm)(t.rowIdx,t.colIdx),isUndoRedo:!1}),t.cell.hyperlink&&this.parent.notify(E.Lu,{cell:t.cell,td:t.td,rowIdx:t.rowIdx,colIdx:t.colIdx}),t.cell.rowSpan>1){var l=t.cell.rowSpan-this.parent.hiddenCount(t.rowIdx,t.rowIdx+(t.cell.rowSpan-1));l>1&&(t.td.rowSpan=l,this.mergeFreezeRow(e,t.rowIdx,t.colIdx,l,t.row))}if(t.cell.colSpan>1){var h=t.cell.colSpan-this.parent.hiddenCount(t.colIdx,t.colIdx+(t.cell.colSpan-1),"columns");h>1&&(t.td.colSpan=h,this.mergeFreezeCol(e,t.rowIdx,t.colIdx,h))}if(t.cell.image)for(var c=0;c<t.cell.image.length;c++)t.cell.image[c]&&this.parent.notify(E.oE,{options:{src:t.cell.image[c].src,imageId:t.cell.image[c].id,height:t.cell.image[c].height,width:t.cell.image[c].width,top:t.cell.image[c].top,left:t.cell.image[c].left},range:(0,pe.i0K)([t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]),isPublic:!1})}if(t.isRefresh&&this.removeStyle(t.td,t.rowIdx,t.colIdx),t.lastCell&&this.parent.chartColl&&this.parent.chartColl.length&&this.parent.notify(pe.PpD,{cell:t.cell,rIdx:t.rowIdx,cIdx:t.colIdx,sheetIdx:this.parent.activeSheetIndex}),this.applyStyle(t,s),(t.checkCf||t.lastCell&&t.isRefresh)&&e.conditionalFormats&&e.conditionalFormats.length&&this.parent.notify(pe.xMH,{rowIdx:t.rowIdx,colIdx:t.colIdx,cell:t.cell,td:t.td}),t.checkNextBorder==="Row"){var u=this.parent.getCellStyleValue(["borderTop"],[Number(this.parent.getContentTable().rows[0].getAttribute("aria-rowindex"))-1,t.colIdx]).borderTop;u!==""&&(!t.cell||!t.cell.style||!t.cell.style.bottomPriority)&&this.parent.notify(pe.nJk,{style:{borderBottom:u},rowIdx:t.rowIdx,colIdx:t.colIdx,cell:t.td})}if(t.checkNextBorder==="Column"){var p=this.parent.getCellStyleValue(["borderLeft"],[t.rowIdx,t.colIdx+1]).borderLeft;p!==""&&(!t.cell||!t.cell.style||!t.cell.style.borderRight&&!t.cell.style.border)&&this.parent.notify(pe.nJk,{style:{borderRight:p},rowIdx:t.rowIdx,colIdx:t.colIdx,cell:t.td})}if(t.cell){if(t.cell.hyperlink&&!t.td.classList.contains("e-cell-template")){var f=void 0;typeof t.cell.hyperlink=="string"?(f=t.cell.hyperlink,f.indexOf("http://")!==0&&f.indexOf("https://")!==0&&f.indexOf("ftp://")!==0&&(t.cell.hyperlink=f.toLowerCase().indexOf("www.")===0?"http://"+f:f)):(f=t.cell.hyperlink.address,f.indexOf("http://")!==0&&f.indexOf("https://")!==0&&f.indexOf("ftp://")!==0&&(t.cell.hyperlink.address=f.toLowerCase().indexOf("www.")===0?"http://"+f:f)),this.parent.notify(E.Lu,{cell:t.cell,td:t.td,rowIdx:t.rowIdx,colIdx:t.colIdx})}t.cell.wrap&&this.parent.notify(pe.agw,{range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx],wrap:!0,sheet:e,initial:!0,td:t.td,row:t.row,hRow:t.hRow,isCustomHgt:!t.isRefresh&&(0,He.NE)(e,t.rowIdx)>20})}var g=t.cell&&t.cell.validation||e.columns&&e.columns[t.colIdx]&&e.columns[t.colIdx].validation;g&&g.isHighlighted&&this.parent.notify(w.CC2,{range:(0,pe.i0K)([t.rowIdx,t.colIdx]),td:t.td}),t.cell&&t.cell.validation&&t.cell.validation.isHighlighted&&this.parent.notify(w.CC2,{range:(0,pe.i0K)([t.rowIdx,t.colIdx]),td:t.td})},o.prototype.applyStyle=function(t,e){(Object.keys(e).length||Object.keys(this.parent.commonCellStyle).length||t.lastCell)&&this.parent.notify(pe.nJk,{style:(0,a.l7)({},this.parent.commonCellStyle,e),rowIdx:t.rowIdx,colIdx:t.colIdx,cell:t.td,first:t.first,row:t.row,lastCell:t.lastCell,hRow:t.hRow,pRow:t.pRow,isHeightCheckNeeded:t.isHeightCheckNeeded,manualUpdate:t.manualUpdate,onActionUpdate:t.onActionUpdate})},o.prototype.calculateFormula=function(t){if(t.cell.value!==void 0&&t.cell.value!==null){var e={action:"checkFormulaAdded",added:!0,address:t.address,sheetId:(t.sheetIndex===void 0?this.parent.getActiveSheet():(0,He.zf)(this.parent,t.sheetIndex)).id.toString()};if(this.parent.notify(pe.B7N,e),e.added)return}else t.formulaRefresh&&(t.cell.value="");var i=(0,pe.C2M)(t.cell.formula),r={action:"refreshCalculate",value:t.cell.formula,rowIndex:t.rowIdx,colIndex:t.colIdx,isFormula:i,sheetIndex:t.sheetIndex,isRefreshing:t.isRefreshing};this.parent.notify(pe.B7N,r),t.cell.value=(0,He.$S)(t.rowIdx,t.colIdx,(0,a.le)(t.sheetIndex)?this.parent.getActiveSheet():(0,He.zf)(this.parent,t.sheetIndex)).value},o.prototype.checkMerged=function(t){if(t.cell&&(t.cell.colSpan<0||t.cell.rowSpan<0)){var e=this.parent.getActiveSheet();if(e.frozenRows||e.frozenColumns){var i={range:[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]};this.parent.notify(w.Zf5,i);var r=this.parent.frozenRowCount(e),n=this.parent.frozenColCount(e),s=void 0;e.frozenRows&&e.frozenColumns?i.range[0]<r&&i.range[1]<n?s=t.rowIdx<r&&t.colIdx<n:i.range[0]<r?s=t.rowIdx<r:i.range[1]<n?s=t.colIdx<n:s=!0:s=r?i.range[0]>=r||t.rowIdx<r:i.range[1]>=n||t.colIdx<n,s&&(t.td.style.display="none")}else t.td.style.display="none";return t.cell.colSpan<0&&(this.parent.notify(E.y9,t),t.cell.style&&t.cell.style.borderTop&&this.applyStyle(t,{borderTop:t.cell.style.borderTop})),t.cell.rowSpan<0&&(t.isRow=!0,this.parent.notify(E.y9,t),t.cell.style&&t.cell.style.borderLeft&&this.applyStyle(t,{borderLeft:t.cell.style.borderLeft})),!0}return!1},o.prototype.mergeFreezeRow=function(t,e,i,r,n,s){var l=this.parent.frozenRowCount(t);if(l&&e<l&&e+(r-1)>=l){var h=void 0,c=0,u=void 0,p=this.parent.frozenColCount(t),f=n||this.parent.getRow(e,null,i),g=[].slice.call(f.parentElement.querySelectorAll(".e-empty"));if(s){var C=e+r-l;if(C<g.length)return;var L=0;if(C===g.length){var D=void 0,R=void 0,B=void 0;for(p&&i<p?(R=(0,w.n53)(t.topLeftCell)[1],B=p):(R=this.parent.viewport.leftIndex+p,B=this.parent.viewport.rightIndex),R;R<B;R++)R!==i&&(D=(0,He.$S)(e,R,t,!1,!0),D.rowSpan&&e+D.rowSpan-l>L&&(L=e+D.rowSpan-l));if(L===C)return}else L=C;for(var H=e+(r-1),R=L,B=g.length;R<B;R++)c+=(0,He.NE)(t,H),H--,(0,a.og)(g.pop());this.updateSpanTop(i,p,c,!0),g.length||this.updateColZIndex(i,p,!0);return}this.updateColZIndex(i,p);for(var R=l,B=e+(r-1);R<=B;R++)u=(0,He.NE)(t,R),c+=-u,!(l+g.length>R)&&(h=f.cloneNode(),h.classList.add("e-empty"),h.style.visibility="hidden",h.style.height=u+"px",f.parentElement.appendChild(h));this.updateSpanTop(i,p,c)}},o.prototype.updateSpanTop=function(t,e,i,r){var n=this.parent.serviceLocator.getService("sheet").contentPanel;if(r){if(!parseInt(n.style.top,10))return;i=parseInt(n.style.top,10)+i}if(e&&t<e&&(r||!parseInt(n.style.top,10)||i<parseInt(n.style.top,10))){n.style.top=i+"px";var s=n.nextElementSibling;s&&(s.style.top=i+"px")}},o.prototype.mergeFreezeCol=function(t,e,i,r,n){var s=this.parent.frozenColCount(t);if(s&&i<s&&i+(r-1)>=s){var l=void 0,h=void 0,c=this.parent.frozenRowCount(t),u=(e<c?this.parent.getSelectAllContent():this.parent.getRowHeaderContent()).querySelector("colgroup"),p=[].slice.call(u.querySelectorAll(".e-empty"));if(n){var f=i+r-s;if(f<p.length)return;var g=0;if(f===p.length){var C=void 0,L=void 0,D=void 0;for(c&&e<s?(L=c,D=(0,w.n53)(t.topLeftCell)[0]):(L=this.parent.viewport.bottomIndex,D=this.parent.viewport.topIndex+c),D;D<L;D++)D!==e&&(C=(0,He.$S)(D,i,t,!1,!0),C.colSpan&&i+C.colSpan-s>g&&(g=i+C.colSpan-s));if(g===f)return}else g=f;for(var D=g,L=p.length;D<L;D++)(0,a.og)(p.pop());this.parent.serviceLocator.getService("sheet").setPanelWidth(t,this.parent.getRowHeaderContent()),p.length||this.updateRowZIndex(e,c,!0);return}this.updateRowZIndex(e,c);for(var D=s,L=i+(r-1);D<=L;D++)s+p.length>D||(l=u.childNodes[0].cloneNode(),l.classList.add("e-empty"),l.style.visibility="hidden",h=(0,He.IQ)(t,D,null,!0),l.style.width=h+"px",u.appendChild(l),D===L&&this.parent.serviceLocator.getService("sheet").setPanelWidth(t,this.parent.getRowHeaderContent()))}},o.prototype.updateColZIndex=function(t,e,i){t<e?this.updateSelectAllZIndex(i):(this.parent.getColumnHeaderContent().style.zIndex=i?"":"2",this.updatedHeaderZIndex(i))},o.prototype.updateSelectAllZIndex=function(t){var e=this.parent.element.querySelector(".e-frozen-row"),i=this.parent.element.querySelector(".e-frozen-column");t?(this.parent.getSelectAllContent().style.zIndex="",e&&(e.style.zIndex=""),i&&(i.style.zIndex="")):this.parent.getRowHeaderContent().style.zIndex||this.parent.getColumnHeaderContent().style.zIndex?(this.parent.getSelectAllContent().style.zIndex="3",e&&(e.style.zIndex="4"),i&&(i.style.zIndex="4")):this.parent.getSelectAllContent().style.zIndex="2"},o.prototype.updatedHeaderZIndex=function(t){if(!t&&this.parent.getSelectAllContent().style.zIndex==="2"){this.parent.getSelectAllContent().style.zIndex="3";var e=this.parent.element.querySelector(".e-frozen-row"),i=this.parent.element.querySelector(".e-frozen-column");i&&(i.style.zIndex="4"),e&&(e.style.zIndex="4")}},o.prototype.updateRowZIndex=function(t,e,i){t<e?this.updateSelectAllZIndex(i):(this.parent.getRowHeaderContent().style.zIndex=i?"":"2",this.updatedHeaderZIndex(i))},o.prototype.processTemplates=function(t,e,i){for(var r=this.parent.getActiveSheet(),n=r.ranges,s,l=0,h=n.length;l<h;l++)if(n[l].template&&(s=(0,pe.dK5)(n[l].address.length?n[l].address:n[l].startCell),s[0]<=e&&s[1]<=i&&s[2]>=e&&s[3]>=i)){if(t)return this.compileCellTemplate(n[l].template,t);if(!(0,He.$S)(e,i,r,!0))return this.compileCellTemplate(n[l].template,(0,He.$S)(e,i,r,null,!0))}return""},o.prototype.compileCellTemplate=function(t,e){var i;if(typeof t=="string"){var r=void 0;return t.trim().indexOf("#")===0?r=document.querySelector(t).innerHTML.trim():r=t,i=(0,a.MY)(r),!this.parent.isVue||document.querySelector(t)?i(e,this.parent,"ranges","",!0)[0].outerHTML:i(e,this.parent,"ranges","")[0]}else return i=(0,a.MY)(t),i(e,this.parent,"ranges","")[0]},o.prototype.getRowHeightOnInit=function(){var t=this.parent.createElement("table",{className:"e-table e-test-table"}),e=t.appendChild(this.parent.createElement("tbody"));e.appendChild(this.tableRow),this.parent.element.appendChild(t);var i=Math.round(this.tableRow.getBoundingClientRect().height);return this.parent.element.removeChild(t),i<20?20:i},o.prototype.removeStyle=function(t,e,i){var r;if(t.style.length){r=this.parent.getCellStyleValue(["borderLeft","border"],[e,i+1]);var n=r.borderLeft||r.border;r=this.parent.getCellStyleValue(["borderTop","border"],[e+1,i]);var s=r.borderTop||r.border;n||s?[].slice.call(t.style).forEach(function(u){n&&s?!u.includes("border-right")&&!u.includes("border-bottom")&&t.style.removeProperty(u):(n&&!(u.indexOf("border-right")>-1)&&(!s||s==="none")||s&&!(u.indexOf("border-bottom")>-1)&&(!n||n==="none"))&&t.style.removeProperty(u)}):t.removeAttribute("style")}var l=this.parent.getCell(e-1,i);if(l&&l.style.borderBottom){var h=Number(l.parentElement.getAttribute("aria-rowindex"))-1;r=this.parent.getCellStyleValue(["borderBottom","border"],[h,i]),r.borderBottom||r.border||(l.style.borderBottom="")}var c=t.previousElementSibling;c&&c.style.borderRight&&(i=Number(c.getAttribute("aria-colindex"))-1,r=this.parent.getCellStyleValue(["borderRight","border"],[e,i]),r.borderRight||r.border||(c.style.borderRight=""))},o.prototype.refreshRange=function(t,e,i,r,n){var s=this.parent.getActiveSheet(),l=t.slice(),h,c;if(O(this.parent,l,!0)){for(var u=l[0];u<=l[2];u++)if(!(0,He.gS)(s,u))for(var p=l[1];p<=l[3];p++)(0,He.Nq)(s,p)||(c=this.parent.getCell(u,p),c&&(h={rowIdx:u,colIdx:p,td:c,cell:(0,He.$S)(u,p,s),isRefreshing:e,lastCell:p===l[3],isRefresh:!0,isHeightCheckNeeded:!0,manualUpdate:!0,first:"",onActionUpdate:r,checkCf:n},this.update(h),this.parent.notify(E.Yx,{td:c,rowIndex:u,colIndex:p}),i&&this.setWrapByValue(s,h)))}},o.prototype.refresh=function(t,e,i,r,n,s){var l=this.parent.getActiveSheet();if(!(!r&&((0,He.gS)(l,t)||(0,He.Nq)(l,e)))&&(r||!this.parent.scrollSettings.enableVirtualization||this.parent.insideViewport(t,e))){var h=r||this.parent.getCell(t,e);if(!h)return;var c={rowIdx:t,colIdx:e,td:h,cell:(0,He.$S)(t,e,l),isRefresh:!0,lastCell:i,isHeightCheckNeeded:!0,manualUpdate:!0,first:"",checkCf:n};this.update(c),this.parent.notify(E.Yx,{td:h,rowIndex:t,colIndex:e}),s&&this.setWrapByValue(l,c)}},o.prototype.updateView=function(t){(0,a.le)(t.sheetIndex)||t.sheetIndex===this.parent.activeSheetIndex?this.refreshRange(t.indexes,t.refreshing,t.checkWrap,!1,t.checkCf):t.refreshing&&this.calculateFormula({cell:(0,He.$S)(t.indexes[0],t.indexes[1],(0,He.zf)(this.parent,t.sheetIndex),!0,!0),rowIdx:t.indexes[0],colIdx:t.indexes[1],sheetIndex:t.sheetIndex})},o}(),nA=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.render=function(){this.parent.setProperties({activeSheetIndex:this.parent.skipHiddenSheets(this.parent.activeSheetIndex)},!0),this.parent.isMobileView()||(this.parent.notify(E.cA,null),this.parent.notify(E.y8,null));var t=this.parent.createElement("div",{id:this.parent.element.id+"_sheet_panel",className:"e-sheet-panel"});this.parent.enableRtl&&t.classList.add("e-rtl"),this.parent.element.appendChild(t),this.parent.showSheetTabs?this.parent.notify(E.LA,null):(this.parent.notify(w.B7N,{action:"initSheetInfo"}),this.parent.notify(w.B7N,{action:"initiateDefinedNames"})),this.parent.isMobileView()&&(this.parent.notify(E.y8,null),this.parent.notify(E.cA,null)),(this.parent.password.length>0||this.parent.isProtected)&&(this.parent.isProtected=!0,this.parent.showSheetTabs&&(this.parent.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),this.parent.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled"))),this.setSheetPanelSize(),this.renderSheet(t),this.checkTopLeftCell(!this.parent.refreshing)},o.prototype.checkTopLeftCell=function(t,e,i,r,n){var s=this.parent.getActiveSheet();this.parent.showSpinner();var l=s.topLeftCell==="A1",h=(0,w.n53)(s.topLeftCell),c;if(s.topLeftCell!==s.paneTopLeftCell&&(s.frozenRows||s.frozenColumns)){var u=(0,w.n53)(s.paneTopLeftCell);c=this.parent.scrollSettings.enableVirtualization,l=s.frozenRows&&s.frozenColumns?h[0]+s.frozenRows===u[0]&&h[1]+s.frozenColumns===u[1]:s.frozenRows?h[0]+s.frozenRows===u[0]&&h[1]===0:h[1]+s.frozenColumns===u[1]&&h[0]===0,h[0]&&u[0]>h[0]?this.parent.viewport.beforeFreezeHeight=(0,w.EB_)(s,0,h[0]-1,!0):this.parent.viewport.beforeFreezeHeight=0,h[1]&&u[1]>h[1]?this.parent.viewport.beforeFreezeWidth=(0,w.pGm)(s,0,h[1]-1,!0):this.parent.viewport.beforeFreezeWidth=0}else this.parent.viewport.beforeFreezeHeight=this.parent.viewport.beforeFreezeWidth=0;var p=this.parent.frozenRowCount(s),f=this.parent.frozenColCount(s);if(!this.parent.scrollSettings.enableVirtualization||l)this.refreshUI({rowIndex:h[0],colIndex:h[1],refresh:"All"},null,t,e,n),c&&(this.parent.viewport.topIndex=(0,w.Sxm)(s,p,!0)-p,this.parent.viewport.leftIndex=(0,w.Sxm)(s,f,!0,"columns")-f);else{var g=s.paneTopLeftCell===s.topLeftCell?h:(0,w.n53)(s.paneTopLeftCell),C={preventScroll:!0};C.scrollTop=i||(g[0]>p?(0,w.EB_)(s,p,g[0]-1,!0):0),C.scrollLeft=r||(g[1]>f?(0,w.pGm)(s,f,g[1]-1,!0):0),this.parent.notify(E.tr,C);var L=this.parent.getThreshold("row"),D=s.frozenRows?h[0]:h[0]>L?(0,w.Sxm)(s,h[0]-L,!0):0,R=[];s.frozenRows&&R.push(g[0]-L>p?g[0]-L:p),L=this.parent.getThreshold("col");var B=s.frozenColumns?h[1]:h[1]>L?(0,w.Sxm)(s,h[1]-L,!0,"columns"):0;s.frozenColumns?(R.length||R.push(p),R.push(g[1]-L>f?g[1]-L:f)):R.length&&R.push(f),this.refreshUI({rowIndex:D,colIndex:B,refresh:"All",top:C.scrollTop,left:C.scrollLeft,frozenIndexes:R},null,t,e,n),c&&(p&&R[0]>=p&&(this.parent.viewport.topIndex=(0,w.Sxm)(s,R[0],!0)-p),f&&R[1]>=f&&(this.parent.viewport.leftIndex=(0,w.Sxm)(s,R[1],!0,"columns")-f))}},o.prototype.renderSheet=function(t){t===void 0&&(t=document.getElementById(this.parent.element.id+"_sheet_panel")),t.appendChild(this.parent.createElement("div",{className:"e-sheet",id:this.parent.element.id+"_sheet",styles:"background-color: #fff"})),this.parent.serviceLocator.getService("sheet").renderPanel()},o.prototype.refreshUI=function(t,e,i,r,n){var s=this;t.refresh!=="All"&&this.parent.showSpinner();var l=this.parent.serviceLocator.getService("sheet"),h=this.parent.getActiveSheet(),c=(0,w.Rao)(this.parent),u={rowCount:h.rowCount,colCount:h.colCount};if(t.frozenIndexes=t.frozenIndexes?t.frozenIndexes:[],!e)if(this.parent.scrollSettings.enableVirtualization){var p=t.rowIndex+this.parent.viewport.rowCount+this.parent.getThreshold("row")*2,f=t.colIndex+this.parent.viewport.colCount+this.parent.getThreshold("col")*2,g=this.parent.frozenRowCount(h),C=this.parent.frozenColCount(h);t.frozenIndexes.length&&(p+=t.frozenIndexes[0]-g,f+=t.frozenIndexes[1]-C),t.refresh==="Row"?p+=g:p+=h.frozenRows,t.refresh==="Column"?f+=C:f+=h.frozenColumns;var L=t.frozenIndexes[0]>g?t.frozenIndexes[0]:t.rowIndex+(t.refresh==="Row"?g:h.frozenRows),D=this.parent.skipHidden(L,p,"rows",!1);if(p=D[1],L!==D[0]){var R=(0,w.n53)(h.paneTopLeftCell);R[0]===L&&this.parent.updateTopLeftCell(D[0]-g,R[1],"col")}D[0]-=g;var B=h.rowCount-1,H=0,j=t.rowIndex;if(this.parent.scrollSettings.isFinite&&p>B&&(H=p-B,p=(0,w.Sxm)(h,B,!1),D[0]+g>(0,w.Sxm)(h,g,!0))){var W=t.rowIndex-H;W=W<0?0:W,W=this.decreaseHidden(W,t.rowIndex-1,g),t.top&&W<t.rowIndex&&this.parent.notify(E.$7,{height:(0,w.EB_)(h,W+g,t.rowIndex-1+g,!0),isRender:!0}),this.parent.viewport.topIndex=D[0]=W,j=t.refresh==="Row"?W:j}t.refresh==="Row"?t.rowIndex=(0,w.Sxm)(h,j+g,!0)-g:j=t.rowIndex=g?(0,w.Sxm)(h,j,!0):D[0];var ne=t.frozenIndexes[1]>C?t.frozenIndexes[1]:t.colIndex+(t.refresh==="Column"?C:h.frozenColumns);if(D=this.parent.skipHidden(ne,f,"columns",!1),f=D[1],ne!==D[0]){var R=(0,w.n53)(h.paneTopLeftCell);R[1]===ne&&this.parent.updateTopLeftCell(R[0],D[0]-C,"row")}D[0]-=C,B=h.colCount-1,H=0;var ie=t.colIndex;if(this.parent.scrollSettings.isFinite&&f>B&&(H=f-B,f=(0,w.Sxm)(h,B,!1,"columns"),D[0]+C>(0,w.Sxm)(h,C,!0,"columns"))){var W=t.colIndex-H;W=W>-1?W:0,W=this.decreaseHidden(W,t.colIndex-1,C,"columns"),t.left&&W<t.colIndex&&this.parent.notify(E.$7,{width:(0,w.pGm)(h,W+C,t.colIndex-1+C,!0),isRender:!0}),this.parent.viewport.leftIndex=D[0]=W,ie=t.refresh==="Column"?W:ie}t.refresh==="Column"?t.colIndex=(0,w.Sxm)(h,ie+C,!0,"columns")-C:ie=t.colIndex=C?(0,w.Sxm)(h,ie,!0,"columns"):D[0],t.refresh==="Row"&&(j+=g,g&&(p+=(0,w.n53)(h.topLeftCell)[0]),f=this.parent.viewport.rightIndex),t.refresh==="Column"&&(ie+=C,C&&(f+=(0,w.n53)(h.topLeftCell)[1]),p=this.parent.viewport.bottomIndex),this.parent.viewport.topIndex=t.rowIndex,this.parent.viewport.bottomIndex=p,this.parent.viewport.leftIndex=t.colIndex,this.parent.viewport.rightIndex=f,e=(0,w.qkm)(j,ie)+":"+(0,w.qkm)(p,f)}else t.refresh==="All"&&this.updateTopLeftScrollPosition((0,a.l7)(t,{sheet:h})),this.parent.viewport.bottomIndex=h.rowCount-1,this.parent.viewport.rightIndex=h.colCount-1,e=(0,w.qkm)(t.rowIndex,t.colIndex)+":"+(0,w.qkm)(this.parent.viewport.bottomIndex,this.parent.viewport.rightIndex);t.refresh==="All"&&this.parent.trigger(E.wy,{});var me=this.parent.isOpen||this.parent.refreshing;oe(this.parent.getMainContent(),{busy:!0});var ve=this.parent.sheets.length;(0,w.YuF)(this.parent,c+"!"+e,null,null,t.frozenIndexes).then(function(Ee){if(!(!s.parent||ve<s.parent.sheets.length)){var le=s.parent.sheets.indexOf(h);if(n&&(le===-1||le!==s.parent.activeSheetIndex)){le>-1&&s.checkTopLeftCell();return}var de=[t.rowIndex,t.colIndex].concat((0,w.n53)(e.split(":")[1])),fe,Le;switch(t.refresh){case"All":l.renderTable({cells:Ee,indexes:de,top:t.top,left:t.left,initLoad:i,isRefreshing:r,isOpen:me});break;case"Row":l.refreshRowContent({cells:Ee,indexes:de,skipUpdateOnFirst:t.skipUpdateOnFirst,prevRowColCnt:u}),fe=!1,Le={isEdit:fe},s.parent.notify(E.UM,Le),Le.isEdit&&s.parent.notify(E.vJ,{action:"startEdit",refreshCurPos:!1});break;case"Column":l.refreshColumnContent({cells:Ee,indexes:de,skipUpdateOnFirst:t.skipUpdateOnFirst,prevRowColCnt:u,insertDelete:t.insertDelete});break;case"RowPart":l.updateRowContent({cells:Ee,indexes:de,direction:t.direction,skipUpdateOnFirst:t.skipUpdateOnFirst,prevRowColCnt:u});break;case"ColumnPart":l.updateColContent({cells:Ee,indexes:de,direction:t.direction,skipUpdateOnFirst:t.skipUpdateOnFirst,prevRowColCnt:u});break}s.parent&&s.parent[E.NB]&&s.parent[E.Vi]()}}),this.parent.notify(E.nQ,{refresh:t.refresh,skipTranslate:t.skipTranslate})},o.prototype.updateTopLeftScrollPosition=function(t){var e=(0,w.n53)(t.sheet.topLeftCell),i=(0,w.n53)(t.sheet.paneTopLeftCell);if(t.sheet.frozenRows){var r=this.parent.frozenRowCount(t.sheet);i[0]>r&&(t.top=(0,w.EB_)(t.sheet,r,i[0]-1,!0))}else t.rowIndex&&(t.rowIndex=0),e[0]!==0&&(t.top=(0,w.EB_)(t.sheet,0,e[0]-1,!0));if(t.sheet.frozenColumns){var n=this.parent.frozenColCount(t.sheet);i[1]>n&&(t.left=(0,w.pGm)(t.sheet,n,i[1]-1,!0))}else t.colIndex&&(t.colIndex=0),e[1]!==0&&(t.left=(0,w.pGm)(t.sheet,0,e[1]-1,!0))},o.prototype.removeSheet=function(){(0,a.Od)(document.getElementById(this.parent.element.id+"_sheet"))},o.prototype.refreshSheet=function(t,e,i,r){var n=0,s=0;if(e){var l=this.parent.element.getElementsByClassName("e-main-panel")[0];l&&(n=l.scrollTop);var h=this.parent.getMainContent();h&&(s=h.scrollLeft)}this.removeSheet(),this.renderSheet(),this.parent.notify(E.YF,{}),this.checkTopLeftCell(!1,t,n,s,r),i&&we(this.parent.element)},o.prototype.setSheetPanelSize=function(){var t=document.getElementById(this.parent.element.id+"_sheet_panel"),e=this.parent.element.getBoundingClientRect(),i;this.parent.height==="auto"?(t.style.height="260px",i=230):(i=e.height-Q(t),t.style.height=i+"px",i-=32),this.parent.viewport.height=i,this.parent.viewport.width=e.width-32,this.parent.viewport.rowCount=this.roundValue(i,20),this.parent.viewport.colCount=this.roundValue(e.width,64)},o.prototype.roundValue=function(t,e){var i=t/e,r=Math.round(i);return Math.abs(i-r)<.5?r:r-1},o.prototype.moveOrDuplicateSheetHandler=function(t){this.parent.notify(E.$c,null),t.refresh&&this.refreshSheet(t.isDuplicate)},o.prototype.decreaseHidden=function(t,e,i,r){r===void 0&&(r="rows"),t+=i,e+=i;for(var n=this.parent.getActiveSheet(),s=e;s>=t;s--)if(n[r][s]&&n[r][s].hidden&&(t--,t<i)){t=(0,w.Sxm)(n,i,!0,r);break}return t-i},o.prototype.instantiateRenderer=function(){this.parent.serviceLocator.register("cell",new rA(this.parent)),this.parent.serviceLocator.register("row",new iA(this.parent)),this.parent.serviceLocator.register("sheet",new tA(this.parent))},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o.prototype.addEventListener=function(){this.parent.on(E.T5,this.instantiateRenderer,this),this.parent.on(E.xn,this.destroy,this),this.parent.on(w.NGR,this.moveOrDuplicateSheetHandler,this),this.parent.on(E.M6,this.updateTopLeftScrollPosition,this)},o.prototype.removeEventListener=function(){this.parent.off(E.T5,this.instantiateRenderer),this.parent.off(E.xn,this.destroy),this.parent.off(w.NGR,this.moveOrDuplicateSheetHandler),this.parent.off(E.M6,this.updateTopLeftScrollPosition)},o}(),sA=function(){function o(t){this.parent=t}return o.prototype.show=function(t,e){var i=this,r;e=!!(0,a.le)(e);var n=t.close||null,s={header:"Spreadsheet",cssClass:this.parent.cssClass,target:this.parent.element,buttons:[]};t.close=function(){i.destroyDialog(),n&&n()},(0,a.l7)(s,t),e&&(r=this.parent.serviceLocator.getService(Ve).getConstant(s.buttons.length?"Cancel":"Ok"),s.buttons.push({buttonModel:{content:r,isPrimary:s.buttons.length===0},click:this.hide.bind(this)}));var l=this.parent.createElement("div");document.body.appendChild(l),this.dialogInstance=new sl(s),this.dialogInstance.createElement=this.parent.createElement,this.dialogInstance.appendTo(l),this.dialogInstance.refreshPosition()},o.prototype.destroyDialog=function(){this.dialogInstance.destroy(),(0,a.Od)(this.dialogInstance.element),this.dialogInstance=null},o.prototype.hide=function(){this.dialogInstance&&this.dialogInstance.hide()},o.prototype.destroy=function(){this.parent=null},o}(),aA=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.initializeActionBegin=function(){var t=this,e=this.parent.beforeCellFormat;this.parent.beforeCellFormat=function(s){t.actionEventHandler({evtArgs:s,evtFunc:e,actionType:"begin",eventType:"format"})};var i=this.parent.beforeOpen;this.parent.beforeOpen=function(s){t.actionEventHandler({evtArgs:s,evtFunc:i,actionType:"begin",eventType:"beforeOpen"})};var r=this.parent.beforeSave;this.parent.beforeSave=function(s){t.actionEventHandler({evtArgs:s,evtFunc:r,actionType:"begin",eventType:"beforeSave"})};var n=this.parent.beforeSort;this.parent.beforeSort=function(s){t.actionEventHandler({evtArgs:s,evtFunc:n,actionType:"begin",eventType:"beforeSort"})}},o.prototype.initializeActionComplete=function(){var t=this,e=this.parent.sortComplete;this.parent.sortComplete=function(r){t.actionEventHandler({evtArgs:r,evtFunc:e,actionType:"complete",eventType:"sorting"})};var i=this.parent.cellSave;this.parent.cellSave=function(r){t.actionEventHandler({evtArgs:r,evtFunc:i,actionType:"complete",eventType:"cellSave"})}},o.prototype.actionEventHandler=function(t){t.evtFunc&&t.evtFunc.apply(this,[t]),t.actionType==="begin"?this.actionBeginHandler({eventArgs:t.evtArgs,action:t.eventType}):this.actionCompleteHandler({eventArgs:t.evtArgs,action:t.eventType})},o.prototype.actionBeginHandler=function(t){var e=t.preventAction;delete t.preventAction;var i={action:t.action};t.isUndo&&(i.isUndo=!0,delete t.isUndo),t.isRedo&&(i.isUndo=!1,delete t.isRedo),i.args=t,this.parent.trigger("actionBegin",i),!e&&(t.action==="clipboard"||t.action==="beforeSort"||t.action==="format"||t.action==="cellSave"||t.action==="beforeWrap"||t.action==="beforeReplace"||t.action==="filter"||t.action==="beforeClear"||t.action==="beforeInsertImage"||t.action==="beforeInsertChart"||t.action==="chartDesign"||t.action==="cellDelete"||t.action==="autofill"||t.action==="removeValidation"||t.action==="hyperlink"||t.action==="removeHyperlink"||t.action==="deleteImage")&&this.parent.notify(E.e9,{args:t}),e&&(t.preventAction=!0),i.isUndo&&(t.isUndo=!0),i.isUndo===!1&&(t.isRedo=!0)},o.prototype.actionCompleteHandler=function(t){var e=t.preventAction;delete t.preventAction,this.parent.notify(w.sQc,t),t.preventEventTrigger||this.parent.trigger("actionComplete",t),!e&&t.action!=="undoRedo"&&t.action!=="gotoSheet"&&this.parent.notify(E.dW,{args:t}),this.parent.notify(E.uv,null)},o.prototype.addEventListener=function(){this.parent.on(E.Av,this.actionCompleteHandler,this),this.parent.on(w.ya2,this.actionBeginHandler,this),this.parent.on(E.xn,this.removeEventListener,this)},o.prototype.removeEventListener=function(){this.parent.off(E.Av,this.actionCompleteHandler),this.parent.off(w.ya2,this.actionBeginHandler),this.parent.off(E.xn,this.removeEventListener)},o}(),oA=function(){function o(t){this.minHeight="300px",this.minWidth="400px",this.isOverlayClicked=!1,this.isResizerClicked=!1,this.currentWidth=400,this.currenHeight=300,this.parent=t}return o.prototype.insertOverlayElement=function(t,e,i){var r=this.parent.createElement("div",{id:t,attrs:{class:"e-ss-overlay e-ss-overlay-active"},styles:"width: "+this.minWidth+";  height: "+this.minHeight}),n=(0,w.dK5)(e),s=this.parent.sheets[i],l=this.parent.frozenRowCount(s),h=this.parent.frozenColCount(s),c=d(s,n,l,h,this.parent.viewport.beforeFreezeHeight,this.parent.viewport.beforeFreezeWidth,this.parent.sheetModule.colGroupWidth);if(n[0]>=l&&n[1]<h){var u=this.parent.sheetModule.contentPanel;u.scrollTop&&(c.top-=u.scrollTop,c.top+=this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height)}if(n[1]>=h&&n[0]<l){var p=this.parent.getScrollElement();p.scrollLeft&&(c.left-=p.scrollLeft,c.left+=this.parent.sheetModule.getRowHeaderWidth(s))}var f;return n[0]<l||n[1]<h?(f=document.getElementById(this.parent.element.id+"_sheet"),l&&(n[0]>=l?c.top+=(s.showHeaders?31:0)+(0,w.EB_)(s,(0,w.n53)(s.topLeftCell)[0],l-1):h||(c.left+=this.parent.sheetModule.getRowHeaderWidth(s,!0))),h&&(n[1]>=h?c.left+=this.parent.sheetModule.getRowHeaderWidth(s):l||(c.left+=s.showHeaders?31:0))):f=this.parent.getMainContent(),r.style.top=c.top+"px",r.style.left=c.left+"px",i===this.parent.activeSheetIndex&&(f.appendChild(r),this.renderResizeHandles(r),this.addEventListener(r)),this.originalWidth=parseFloat(getComputedStyle(r,null).getPropertyValue("width").replace("px","")),this.originalHeight=parseFloat(getComputedStyle(r,null).getPropertyValue("height").replace("px","")),r},o.prototype.adjustFreezePaneSize=function(t,e,i){var r=(0,w.dK5)(i),n=this.parent.getActiveSheet(),s=this.parent.frozenRowCount(n),l=this.parent.frozenColCount(n);if(r[0]<s||r[1]<l?((0,a.le)(t.top)||(e.style.top=t.top+(n.showHeaders?31:0)-this.parent.viewport.beforeFreezeHeight+"px"),(0,a.le)(t.left)||(e.style.left=t.left+this.parent.sheetModule.getRowHeaderWidth(n,!0)-this.parent.viewport.beforeFreezeWidth+"px")):((0,a.le)(t.top)||(e.style.top=t.top-this.parent.viewport.beforeFreezeHeight-(s?(0,w.EB_)(n,(0,w.n53)(n.topLeftCell)[0],s-1):0)+"px"),(0,a.le)(t.left)||(e.style.left=t.left-this.parent.viewport.beforeFreezeWidth-(l?(0,w.pGm)(n,(0,w.n53)(n.topLeftCell)[1],l-1):0)+"px")),(0,a.le)(t.top)){var h=(0,w.n53)(n.topLeftCell)[0];t.top=this.parent.viewport.beforeFreezeHeight+(s&&h===r[0]?0:(0,w.EB_)(n,s?h:0,r[0]-1))}if((0,a.le)(t.left)){var c=(0,w.n53)(n.topLeftCell)[1];t.left=this.parent.viewport.beforeFreezeWidth+(l&&c===r[1]?0:(0,w.pGm)(n,l?c:0,r[1]-1))}},o.prototype.addEventListener=function(t){var e=t;a.bi.add(e,"mousedown",this.overlayClickHandler,this),a.bi.add(e,"mousemove",this.overlayMouseMoveHandler,this),a.bi.add(document.getElementById(this.parent.element.id+"_sheet"),"mousemove",this.overlayMouseMoveHandler,this),a.bi.add(document,"mouseup",this.overlayMouseUpHandler,this),this.parent.on(E.Cj,this.setOriginalSize,this)},o.prototype.setOriginalSize=function(t){this.originalHeight=t.height,this.originalWidth=t.width},o.prototype.overlayMouseMoveHandler=function(t){var e=t.target,i=document.getElementsByClassName("e-ss-overlay-active")[0],r=this.parent.getActiveSheet(),n=r.frozenRows||r.frozenColumns?[29,this.parent.sheetModule.getRowHeaderWidth(r,!0)]:[-1,-1],s,l,h,c,u,p;if(this.isOverlayClicked&&this.isResizerClicked)switch(this.resizer){case"e-ss-overlay-t":s=Math.max(this.originalMouseY-t.clientY+this.originalHeight,20),l=t.clientY-(this.originalMouseY-this.originalResizeTop),s>20&&l>n[0]&&(i.style.height=s+"px",i.style.top=l+"px",this.resizedReorderTop=l,this.currenHeight=s,this.parent.notify(w.$qQ,{height:i.style.height,width:i.style.width,overlayEle:i}));break;case"e-ss-overlay-r":h=this.originalWidth+(t.pageX-this.originalMouseX),h>20&&(i.style.width=h+"px",this.currentWidth=h,this.parent.notify(w.$qQ,{height:i.style.height,width:i.style.width,overlayEle:i}));break;case"e-ss-overlay-b":c=this.originalHeight+(t.pageY-this.originalMouseY),c>20&&(i.style.height=c+"px",this.currenHeight=c,this.parent.notify(w.$qQ,{height:i.style.height,width:i.style.width,overlayEle:i}));break;case"e-ss-overlay-l":u=Math.max(this.originalMouseX-t.clientX+this.originalWidth,20),p=t.clientX-(this.originalMouseX-this.originalResizeLeft),u>20&&p>n[1]&&(i.style.width=u+"px",i.style.left=p+"px",this.resizedReorderLeft=p,this.currentWidth=u,this.parent.notify(w.$qQ,{height:i.style.height,width:i.style.width,overlayEle:i}));break}else if(this.isOverlayClicked)if((0,a.oq)(e,".e-sheet")&&!e.classList.contains("e-sheet-content")||e.classList.contains("e-cell")){if(!i)return;var f=t.clientX-this.diffX,g=t.clientY-this.diffY;f>n[1]&&(i.style.left=f+"px"),g>n[0]&&(i.style.top=g+"px"),this.resizedReorderLeft=f<0?0:f,this.resizedReorderTop=g<0?0:g}else this.overlayMouseUpHandler(t,!0)},o.prototype.overlayMouseUpHandler=function(t,e){if(!this.parent.getActiveSheet().isProtected){this.isResizerClicked=!1;var i=t.target,r=document.getElementsByClassName("e-datavisualization-chart e-ss-overlay-active");i.classList.contains("e-ss-overlay")||(i=(0,a.oq)(t.target,".e-datavisualization-chart")?(0,a.oq)(t.target,".e-datavisualization-chart"):i);var n=this.parent.getActiveSheet(),s={prevTop:n.frozenRows||n.frozenColumns?this.prevY:this.originalReorderTop,prevLeft:n.frozenRows||n.frozenColumns?this.prevX:this.originalReorderLeft,currentTop:this.resizedReorderTop>=0?this.resizedReorderTop:this.originalReorderTop,currentLeft:this.resizedReorderLeft>=0?this.resizedReorderLeft:this.originalReorderLeft,id:i.id,currentHeight:this.currenHeight,currentWidth:this.currentWidth,requestType:"imageRefresh",prevHeight:this.originalHeight,prevWidth:this.originalWidth};if(this.isOverlayClicked||e){var l=void 0,h=void 0,c={clientY:s.prevTop,isImage:!0},u={clientX:s.prevLeft,isImage:!0},p=this.parent.element.getElementsByClassName("e-ss-overlay-active")[0];if(n.frozenRows||n.frozenColumns){if(!p)return;c.isImage=!1,u.isImage=!1,c.target=p,u.target=p,s.prevTop<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(c.target=this.parent.getColumnHeaderContent()),s.prevLeft<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(u.target=this.parent.getRowHeaderTable());var f=p.getBoundingClientRect();l={clientY:f.top},h={clientX:f.left},f.top<this.parent.getColumnHeaderContent().getBoundingClientRect().bottom&&(l.target=this.parent.getColumnHeaderContent()),f.left<this.parent.getRowHeaderContent().getBoundingClientRect().right&&(h.target=this.parent.getRowHeaderTable())}else l={clientY:s.currentTop,isImage:!0},h={clientX:s.currentLeft,isImage:!0};if(this.parent.notify(E.M7,c),this.parent.notify(E.M7,l),this.parent.notify(E.oU,u),this.parent.notify(E.oU,h),l.size&&(s.currentTop=l.size),h.size&&(s.currentLeft=h.size),s.prevRowIdx=c.clientY,s.prevColIdx=u.clientX,s.currentRowIdx=l.clientY,s.currentColIdx=h.clientX,(n.frozenColumns||n.frozenRows)&&!(0,a.oq)(p,".e-sheet-content")){var g=this.parent.frozenColCount(n),C=this.parent.frozenRowCount(n);if(s.currentRowIdx>=C&&s.currentColIdx>=g){var L=parseInt(p.style.top,10),D=parseInt(p.style.left,10),R=this.parent.sheetModule.contentPanel;L+=R.scrollTop,L-=this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height;var B=this.parent.getScrollElement();D+=B.scrollLeft,D-=this.parent.sheetModule.getRowHeaderWidth(n),p.style.top=L+"px",p.style.left=D+"px",this.parent.getMainContent().appendChild(p)}}r&&r[0]&&r[0].querySelector(".e-control")&&(s.id=r[0].id),this.originalReorderTop!==this.resizedReorderTop||this.originalReorderLeft!==this.resizedReorderLeft?(s.id=p.id,r&&r[0]?(s.requestType="chartRefresh",this.parent.notify(E.tB,s)):this.parent.notify(E.eh,s),this.resizedReorderTop=this.originalReorderTop,this.resizedReorderLeft=this.originalReorderLeft):(this.currenHeight!==this.originalHeight||this.originalWidth!==this.currentWidth)&&(s.id=i.id.indexOf("overlay")>0?i.id:i.parentElement?i.parentElement.id:"",r&&r[0]?(s.requestType="chartRefresh",this.parent.notify(E.tB,s)):this.parent.notify(E.eh,s),this.originalHeight=this.currenHeight,this.originalWidth=this.currentWidth)}this.isOverlayClicked=!1}},o.prototype.overlayClickHandler=function(t){if(!this.parent.getActiveSheet().isProtected){this.isOverlayClicked=!0;var e=t.target,i=t.target;e.classList.contains("e-ss-overlay")||(i=e.parentElement,(0,a.oq)(t.target,".e-datavisualization-chart")&&(i=(0,a.oq)(t.target,".e-datavisualization-chart"),this.currentWidth=parseFloat(getComputedStyle(i,null).getPropertyValue("width").replace("px","")),this.currenHeight=parseFloat(getComputedStyle(i,null).getPropertyValue("height").replace("px",""))));var r=this.parent.getActiveSheet();if((r.frozenColumns||r.frozenRows)&&(0,a.oq)(i,".e-sheet-content")){var n=parseInt(i.style.top,10),s=parseInt(i.style.left,10),l=this.parent.sheetModule.contentPanel;n-=l.scrollTop,n+=this.parent.getColumnHeaderContent().parentElement.getBoundingClientRect().height;var h=this.parent.getScrollElement();s-=h.scrollLeft,s+=this.parent.sheetModule.getRowHeaderWidth(r),i.style.top=n+"px",i.style.left=s+"px",document.getElementById(this.parent.element.id+"_sheet").appendChild(i)}this.originalReorderLeft=parseInt(i.style.left,10),this.originalReorderTop=parseInt(i.style.top,10),this.resizedReorderLeft=parseInt(i.style.left,10),this.resizedReorderTop=parseInt(i.style.top,10),this.originalResizeTop=this.originalReorderTop,this.originalResizeLeft=this.originalReorderLeft,this.originalMouseX=t.clientX,this.originalMouseY=t.clientY,this.diffX=this.originalMouseX-this.originalReorderLeft,this.diffY=this.originalMouseY-this.originalReorderTop;var c=document.getElementsByClassName("e-ss-overlay-active")[0];c&&(0,a.IV)([c],"e-ss-overlay-active"),document.getElementById(i.id).classList.add("e-ss-overlay-active"),e.classList.contains("e-ss-resizer")&&(this.resizer=e.classList[0],this.originalWidth=parseFloat(getComputedStyle(i,null).getPropertyValue("width").replace("px","")),this.originalHeight=parseFloat(getComputedStyle(i,null).getPropertyValue("height").replace("px","")),this.isResizerClicked=!0),i.classList.contains("e-datavisualization-chart")&&(this.parent.notify(w.PeM,{id:i.id}),c||this.parent.notify(E.A$,{id:i.id}));var u=i.getBoundingClientRect();this.prevX=u.left,this.prevY=u.top}},o.prototype.renderResizeHandles=function(t){for(var e=["e-ss-overlay-t","e-ss-overlay-r","e-ss-overlay-b","e-ss-overlay-l"],i=0,r,n=t;e.length>i;)r=this.parent.createElement("div",{attrs:{class:e[i]+" e-ss-resizer"},styles:"width: 8px; height: 8px; border-radius: 4px;"}),n.appendChild(r),i++},o.prototype.removeEventListener=function(){var t=document.getElementById(this.parent.element.id+"_overlay");t&&(a.bi.remove(t,"mousedown",this.overlayClickHandler),a.bi.remove(t,"mousemove",this.overlayMouseMoveHandler)),a.bi.remove(document.getElementById(this.parent.element.id+"_sheet"),"mousemove",this.overlayMouseMoveHandler),a.bi.remove(document,"mouseup",this.overlayMouseUpHandler),this.parent.off(E.Cj,this.setOriginalSize)},o.prototype.destroy=function(){this.removeEventListener(),this.parent=null},o}(),lA=ae(47799),hA=ae(55134),Dl=ae(57387),cA=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Wt=function(o,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(o,t,e,i);else for(var l=o.length-1;l>=0;l--)(s=o[l])&&(n=(r<3?s(n):r>3?s(t,e,n):s(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n},tf=function(o){cA(t,o);function t(i,r){var n=o.call(this,i)||this;return n.isValidationHighlighted=!1,n.viewport={rowCount:0,colCount:0,height:0,topIndex:0,leftIndex:0,width:0,bottomIndex:0,rightIndex:0,beforeFreezeHeight:0,beforeFreezeWidth:0},n.needsID=!0,e.Inject(jp,Up,Zp,gr,Ci,So,wo,gi,w.vdt,Yp,rm,Gp,Kp,xo,qp,Fu,w.DoV,w.rVv,w.w09,w.y9o,w.Npz,w.VPM,Jp,w.RDb,Qc,Bu,w.Yli,wd,Pu,w.zp5,Hu,Vu,w.VBC,w.WCD,$u,Dl.uZ,Qu,Dl.tU,tp,Dl.tq,ip,w.nHy,xd,rp,Pc.g,Dl.e0,Qd,Pc.s,np,Dl.aE),r&&n.appendTo(r),n}e=t,t.prototype.getCell=function(i,r,n){var s;return this.insideViewport(i,r)&&(n||(n=this.getRow(i,null,r)),r=this.getViewportIndex(r,!0),s=n&&n.cells[r]),s},t.prototype.getRow=function(i,r,n){if(!r){var s=this.getActiveSheet(),l=this.frozenRowCount(s),h=this.frozenColCount(s);(0,a.le)(n)||i>l-1&&n>h-1?r=this.getContentTable():r=i<l&&n<h?this.sheetModule.getSelectAllTable():i<l?this.getColHeaderTable():this.getRowHeaderTable()}return i=this.getViewportIndex(i),r?r.rows[i]:null},t.prototype.hiddenCount=function(i,r,n,s){n===void 0&&(n="rows"),s===void 0&&(s=this.getActiveSheet());for(var l=0,h=i;h<=r;h++)s[n][h]&&s[n][h].hidden&&l++;return l},t.prototype.getViewportIndex=function(i,r){var n=this.getActiveSheet(),s=this.frozenColCount(n),l=this.frozenRowCount(n);if(r){if(s){var h=(0,w.n53)(n.topLeftCell)[1];return i<s?(i-=this.hiddenCount(h,i,"columns"),i-=h,i+1):(i-=this.hiddenCount(this.viewport.leftIndex+s,i,"columns"),i-=this.viewport.leftIndex+s,i)}}else if(l){var c=(0,w.n53)(n.topLeftCell)[0];return i<l?(i-=this.hiddenCount(c,i),i-=c,i+1):(i-=this.hiddenCount(this.viewport.topIndex+l,i),i-=this.viewport.topIndex+l,i)}return this.scrollSettings.enableVirtualization&&(r?(i-=this.hiddenCount(this.viewport.leftIndex,i,"columns"),i-=this.viewport.leftIndex):(i-=this.hiddenCount(this.viewport.topIndex,i),i-=this.viewport.topIndex)),i},t.prototype.preRender=function(){o.prototype.preRender.call(this),this.serviceLocator=new lA.S,this.initServices()},t.prototype.initServices=function(){this.serviceLocator.register(Ve,new a.E7(this.getModuleName(),eA,this.locale)),this.serviceLocator.register(Yt,new sA(this)),this.serviceLocator.register($1,new aA(this)),this.serviceLocator.register(ef,new oA(this))},t.prototype.render=function(){o.prototype.render.call(this),this.element.setAttribute("tabindex","0"),oe(this.element,{role:"grid"}),this.renderModule=new nA(this),this.notify(E.T5,null),this.renderSpreadsheet(),this.wireEvents(),this.created&&(this[E.i2].observers?this[E.i2].observers.length>0&&(this.createdHandler={observers:this[E.i2].observers},this[E.i2].observers=[]):(this.createdHandler=this.created,this.setProperties({created:void 0},!0)))},t.prototype.renderSpreadsheet=function(){this.cssClass&&(0,a.cn)([this.element],this.cssClass.split(" ")),this.setHeight(),this.setWidth(),Ha({target:this.element},this.createElement),this.isMobileView()&&this.cssClass.indexOf("e-mobile-view")===-1&&this.element.classList.add("e-mobile-view"),this.sheetModule=this.serviceLocator.getService("sheet"),this.allowScrolling&&(this.scrollModule=new zc(this)),this.scrollSettings.enableVirtualization&&new _c(this),this.renderModule.render(),new Q0(this)},t.prototype.showSpinner=function(){jn(this.element)},t.prototype.hideSpinner=function(){Cs(this.element)},t.prototype.protectSheet=function(i,r,n){typeof i=="string"&&(i=(0,w.Q8D)(this,i)),i&&(this.setSheetPropertyOnMute(this.sheets[i],"isProtected",!0),this.setSheetPropertyOnMute(this.sheets[i],"password",n||""),this.setSheetPropertyOnMute(this.sheets[i],"protectSettings",r)),i=this.getActiveSheet().index,this.setSheetPropertyOnMute(this.getActiveSheet(),"isProtected",!0),this.setSheetPropertyOnMute(this.getActiveSheet(),"password",n||""),o.prototype.protectSheet.call(this,i,r,n)},t.prototype.unprotectSheet=function(i){typeof i=="string"&&(i=(0,w.Q8D)(this,i)),i?this.sheets[i].isProtected=!1:this.getActiveSheet().isProtected=!1,o.prototype.unprotectSheet.call(this,i)},t.prototype.find=function(i){var r=this.getActiveSheet().activeCell;if(o.prototype.findHandler.call(this,i),!i.isAction)return r!==this.getActiveSheet().activeCell?this.getActiveSheet().name+"!"+this.getActiveSheet().activeCell:null},t.prototype.replace=function(i){i={value:i.value,mode:i.mode?i.mode:"Sheet",isCSen:i.isCSen?i.isCSen:!1,isEMatch:i.isEMatch?i.isEMatch:!1,searchBy:i.searchBy?i.searchBy:"By Row",replaceValue:i.replaceValue,replaceBy:i.replaceBy,sheetIndex:(0,a.o8)(i.sheetIndex)?this.activeSheetIndex:i.sheetIndex,findOpt:i.findOpt?i.findOpt:""},o.prototype.replaceHandler.call(this,i)},t.prototype.findAll=function(i,r,n,s,l){r=r||"Sheet",l=l||this.activeSheetIndex,n=n||!1,s=s||!1;var h=[],c={value:i,mode:r,sheetIndex:l,isCSen:n,isEMatch:s,findCollection:h};return this.notify(pe.GHh,c),h},t.prototype.goTo=function(i){if(i.includes("!")){var r=i.split("!"),n=(0,w.Q8D)(this,r[0]);if(n===void 0)return;if(n!==this.activeSheetIndex){var s=r[1].split(":")[0],l=this.sheets[n];this.setSheetPropertyOnMute(l,"activeCell",s),this.setSheetPropertyOnMute(l,"selectedRange",r[1]);var h=(0,w.n53)(s);if(l.frozenColumns||l.frozenRows){var c=(0,w.n53)(l.topLeftCell);if(!(l.frozenRows&&h[0]<c[0]||l.frozenColumns&&h[1]<c[1])){var u=this.frozenRowCount(l),p=this.frozenColCount(l),f=[],g=[],C=(0,w.n53)(l.paneTopLeftCell);u?(f.push(c[0]),h[0]>=u?g.push(h[0]):g.push(C[0])):(f.push(h[0]),g.push(h[0])),p?(f.push(c[1]),h[1]>=p?g.push(h[1]):g.push(C[1])):(f.push(h[1]),g.push(h[1])),this.setSheetPropertyOnMute(l,"topLeftCell",(0,pe.qkm)(f[0],f[1])),this.setSheetPropertyOnMute(l,"paneTopLeftCell",(0,pe.qkm)(g[0],g[1]))}}else h[0]<this.viewport.rowCount&&(h[0]=0),h[1]<this.viewport.colCount&&(h[1]=0),this.updateTopLeftCell(h[0],h[1],null,l);this.activeSheetIndex=n,this.dataBind();return}}var L=(0,w.dK5)(i),D=this.getActiveSheet(),R=this.frozenRowCount(D),B=this.frozenColCount(D),H=this.insideViewport(L[0],L[1]);if(H){this.selectRange(i);var j=(0,w.n53)(D.paneTopLeftCell),W=this.viewport.height-this.getScrollElement().parentElement.getBoundingClientRect().height,ne=0,ie=0;if(R){for(var me=(0,w.n53)(D.topLeftCell),ve=me[0];ve<R;ve++)if(ne+=(0,He.NE)(D,ve),ne>W){ie=ve;break}}if(ie===0)for(var ve=j[0];ve<=this.viewport.bottomIndex;ve++)if(ne+=(0,He.NE)(D,ve),ne>W){ie=ve;break}else ve===this.viewport.bottomIndex&&(ie=this.viewport.bottomIndex);j[2]=ie;var Ee=0;if(ne=0,W=this.viewport.width-this.sheetModule.getScrollSize(),B){for(var me=(0,w.n53)(D.topLeftCell),ve=me[1];ve<B;ve++)if(ne+=(0,He.IQ)(D,ve),ne>W){Ee=ve;break}}if(Ee===0)for(var ve=j[1];ve<=this.viewport.rightIndex;ve++)if(ne+=(0,He.IQ)(D,ve),ne>W){Ee=ve;break}else ve===this.viewport.rightIndex&&(Ee=this.viewport.rightIndex);if(j[3]=Ee,L[0]>=j[0]&&L[0]<j[2]&&L[1]>=j[1]&&L[1]<j[3]||(R||B)&&(j=[].concat((0,w.n53)(D.topLeftCell),[R,j[3]]),L[0]>=j[0]&&L[0]<j[2]&&L[1]>=j[1]&&L[1]<j[3]||(j[2]=ie,j[3]=B,L[0]>=j[0]&&L[0]<j[2]&&L[1]>=j[1]&&L[1]<j[3])))return}var le=this.getMainContent().parentElement,de,fe,Le,ke,Me,De;L[0]===R?Le=0:(Le=(0,He.EB)(D,R,L[0]-1,!0),this.scrollSettings.enableVirtualization&&(De=Le+this.getContentTable().getBoundingClientRect().height,Me=parseFloat(le.querySelector(".e-virtualtrack").style.height),De>Me&&(De+=10,de=le.querySelector(".e-virtualtrack"),de.style.height=De+"px",$(function(){de.style.height=Me+"px"})))),le.scrollTop=Le,le=this.element.getElementsByClassName("e-scroller")[0],L[1]===B?Le=0:(Le=(0,w.pGm)(D,B,L[1]-1,!0),this.scrollSettings.enableVirtualization&&(De=Le+this.getContentTable().getBoundingClientRect().width,ke=parseFloat(le.querySelector(".e-virtualtrack").style.width),De>ke&&(De+=10,de=le.querySelector(".e-virtualtrack"),de.style.width=De+"px",fe=this.getColumnHeaderContent().querySelector(".e-virtualtrack"),fe.style.width=De+"px",de=this.getMainContent().querySelector(".e-virtualtrack"),de.style.width=De+"px",$(function(){de.style.width=ke+"px",fe.style.width=ke+"px"})))),le.scrollLeft=Le,H||this.selectRange(i)},t.prototype.insideViewport=function(i,r){var n=this.getActiveSheet();if(n.frozenRows||n.frozenColumns){var s=this.frozenRowCount(n),l=this.frozenColCount(n),h=(0,w.n53)(n.topLeftCell);return(i>=h[0]&&i<s||i>=this.viewport.topIndex+s&&i<=this.viewport.bottomIndex)&&(r>=h[1]&&r<l||r>=this.viewport.leftIndex+l&&r<=this.viewport.rightIndex)}else return i>=this.viewport.topIndex&&i<=this.viewport.bottomIndex&&r>=this.viewport.leftIndex&&r<=this.viewport.rightIndex},t.prototype.resize=function(){this.renderModule.setSheetPanelSize(),this.scrollSettings.enableVirtualization&&this.renderModule.refreshSheet(!1,!0)},t.prototype.cut=function(i){var r=new Promise(function(n,s){n(function(){}())});return this.notify(E.z7,i?{range:(0,w.IRR)(i),sId:this.sheets[(0,w.Q8D)(this,(0,w.HAf)(i))]?this.sheets[(0,w.Q8D)(this,(0,w.HAf)(i))].id:this.getActiveSheet().id,promise:r,invokeCopy:!0,isPublic:!0}:{promise:r,invokeCopy:!0,isPublic:!0}),r},t.prototype.copy=function(i){var r=new Promise(function(n,s){n(function(){}())});return this.notify(E.JG,i?{range:(0,w.IRR)(i),sId:this.sheets[(0,w.Q8D)(this,(0,w.HAf)(i))]?this.sheets[(0,w.Q8D)(this,(0,w.HAf)(i))].id:this.getActiveSheet().id,promise:r,invokeCopy:!0,isPublic:!0}:{promise:r,invokeCopy:!0,isPublic:!0}),r},t.prototype.paste=function(i,r){this.notify(E.v,{range:i&&(0,w.IRR)(i),sIdx:i&&(0,w.Q8D)(this,(0,w.HAf)(i)),type:r,isAction:!0,isInternal:!0})},t.prototype.updateAction=function(i){We(i,this)},t.prototype.setHeight=function(){this.height.toString().indexOf("%")>-1&&(this.element.style.minHeight="400px"),this.element.style.height=(0,a.Ac)(this.height)},t.prototype.setWidth=function(){(this.width.toString().indexOf("%")>-1||this.width==="auto")&&(this.element.style.minWidth="300px"),this.element.style.width=(0,a.Ac)(this.width)},t.prototype.setColWidth=function(i,r,n){i===void 0&&(i=64),r===void 0&&(r=0);var s=(0,a.le)(n)?this.getActiveSheet():this.sheets[n];if(s){var l=r,h=typeof i=="number"?i+"px":i;r=(0,a.le)(r)?(0,w.n53)(s.activeCell)[1]:r;var c=function(){(0,w.wDo)(s,l).width=parseInt(h,10)>0?parseInt(h,10):0,s.columns[l].customWidth=!0},u=this.frozenColCount(s);if(s.id===this.getActiveSheet().id){if(r>=this.viewport.leftIndex+u&&r<=this.viewport.rightIndex||u&&r<u){r=this.getViewportIndex(r,!0);var p=(0,He.IQ)(s,l,null,!0),f=G(parseInt(h,10))-p;f<0&&p<-f&&(f=-p),c(),this.notify(E.N2,{threshold:f,colIdx:l,checkWrapCell:!0}),ue(l,r,h,!0,this)}else{var g=(0,He.IQ)(s,r),f=void 0;parseInt(h,10)>0?f=-(g-parseInt(h,10)):f=-g,c(),this.notify(E.N2,{threshold:f,colIdx:r})}this.notify(E.uv,null)}else c()}},t.prototype.setRowHeight=function(i,r,n,s){i===void 0&&(i=20),r===void 0&&(r=0);var l=(0,a.le)(n)?this.getActiveSheet():this.sheets[n];if(l){var h=r,c=typeof i=="number"?i+"px":i;r=(0,a.le)(r)?(0,w.n53)(l.activeCell)[0]:r;var u=function(){(0,He.vm)(l,h,parseInt(c,10)>0?parseInt(c,10):0),l.rows[h].customHeight=!0};if(l.id===this.getActiveSheet().id){var p=this.frozenRowCount(l);if(r>=this.viewport.topIndex+p&&r<=this.viewport.bottomIndex||p&&r<p){r=this.getViewportIndex(h);var f=(0,He.NE)(l,h,!0),g=G(parseInt(c,10))-f;g<0&&f<-g&&(g=-f),u(),this.notify(E.QK,{threshold:g,rowIdx:h,isCustomHgt:!0}),(0,a.le)(s)&&(s=!1),s||(ue(h,r,c,!1,this),s=!1)}else{var C=(0,He.NE)(l,r),g=void 0;parseInt(c,10)>0?g=-(C-parseInt(c,10)):g=-C,u(),this.notify(E.QK,{threshold:g,rowIdx:h})}this.notify(E.uv,null)}else u()}},t.prototype.autoFit=function(i){var r=this.getIndexes(i),n=r.startIdx,s=r.endIdx,l=r.isCol,h=l?(0,w.ugT)("XFD"):1048576;if(n<=h)s>h&&(s=h);else return;for(n;n<=s;n++)this.notify(E.SC,{idx:n,isCol:l})},t.prototype.getIndexes=function(i){var r,n,s,l;if(i.indexOf(":")!==-1){var h=i.split(":");s=h[0],l=h[1]}else s=i,l=i;if(!(0,a.le)(s)){var c=this.getAddress(s);s=c.address,r=c.isCol}if(!(0,a.le)(l)){var u=this.getAddress(l);l=u.address,n=u.isCol}var p=r===!0&&n===!0,f=p?(0,w.ugT)(s.toUpperCase()):parseInt(s,10),g=p?(0,w.ugT)(l.toUpperCase()):parseInt(l,10);return{startIdx:f,endIdx:g,isCol:p}},t.prototype.getAddress=function(i){var r;return i.substring(0,1).match(/\D/g)?(r=!0,i=i.replace(/[0-9]/g,""),{address:i,isCol:r}):i.substring(0,1).match(/[0-9]/g)&&i.match(/\D/g)?{address:"",isCol:!1}:(i=(parseInt(i,10)-1).toString(),{address:i,isCol:r})},t.prototype.addHyperlink=function(i,r,n){this.insertHyperlink(i,r,n,!0)},t.prototype.removeHyperlink=function(i){this.notify(E.Th,{range:i,preventEventTrigger:!0})},t.prototype.insertHyperlink=function(i,r,n,s){if(this.allowHyperlink){var l=void 0,h=void 0,c=void 0,u=this.getActiveSheet();r=r||u.name+"!"+u.activeCell,c=(0,w.dK5)(r);for(var p=this.getCell(c[0],c[1]),f=[],g=c[0];g<=c[2];g++)for(var C=c[1];C<=c[3];C++)u.rows[g].cells[C]&&u.rows[g].cells[C].validation&&u.rows[g].cells[C].validation.isHighlighted&&p&&p.style.backgroundColor==="rgb(255, 255, 0)"&&(u.rows[g].cells[C].style={backgroundColor:"#ffff00"});for(var g=0;p&&g<p.classList.length;g++)f.push(p.classList[g]);var L={hyperlink:i,address:r,displayText:n,cancel:!1},D={hyperlink:i,address:r,displayText:n};if(s||(this.trigger(w.G$g,L),this.notify(pe.ya2,{action:"hyperlink",eventArgs:L})),!L.cancel){i=L.hyperlink,r=L.address;var R={hyperlink:i,cell:r,displayText:n,triggerEvt:!s};if(this.notify(w.g7J,R),r&&r.indexOf("!")!==-1){l=r.split("!");for(var B=this.sheets,H=0;H<B.length;H++)B[H].name===l[0]&&(h=H);u=this.sheets[h],r=l[1]}if(!u)return;if(r=r||this.getActiveSheet().activeCell,c=(0,w.dK5)(r),s||(this.trigger(w.V_l,D),this.notify(E.Av,{action:"hyperlink",eventArgs:L})),u===this.getActiveSheet()){this.serviceLocator.getService("cell").refreshRange(c);for(var g=0;g<f.length;g++)this.getCell(c[0],c[1]).classList.contains(f[g])||this.getCell(c[0],c[1]).classList.add(f[g]);this.notify(w.bUq,null)}}}},t.prototype.addDataValidation=function(i,r){o.prototype.addDataValidation.call(this,i,r)},t.prototype.removeDataValidation=function(i){o.prototype.removeDataValidation.call(this,i)},t.prototype.addInvalidHighlight=function(i){var r=i||this.dataValidationRange;if(this.isValidationHighlighted=!0,r.indexOf(",")>-1){var n="";r.includes("!")&&(n=r.split("!")[0]+"!",r=r.split("!")[1]);for(var s=r.split(","),l=0;l<s.length-1;l++)o.prototype.addInvalidHighlight.call(this,n+s[l])}else o.prototype.addInvalidHighlight.call(this,r)},t.prototype.removeInvalidHighlight=function(i){var r=i||this.dataValidationRange;if(this.isValidationHighlighted=!1,r.indexOf(",")>-1){var n="";r.includes("!")&&(n=r.split("!")[0]+"!",r=r.split("!")[1]);for(var s=r.split(","),l=0;l<s.length-1;l++)o.prototype.removeInvalidHighlight.call(this,n+s[l])}else o.prototype.removeInvalidHighlight.call(this,r)},t.prototype.conditionalFormat=function(i){o.prototype.conditionalFormat.call(this,i)},t.prototype.clearConditionalFormat=function(i){i=i||this.getActiveSheet().selectedRange,o.prototype.clearConditionalFormat.call(this,i)},t.prototype.setPanelSize=function(){if(this.height!=="auto"){var i=document.getElementById(this.element.id+"_sheet_panel");i.style.height=this.element.getBoundingClientRect().height-Q(i)+"px"}},t.prototype.open=function(i){this.isOpen=!0,o.prototype.open.call(this,i),this.isOpen&&this.showSpinner()},t.prototype.hideRow=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0),this.renderModule?this.notify(w.wtl,{startIndex:i,endIndex:r,hide:n}):o.prototype.hideRow.call(this,i,r,n)},t.prototype.hideColumn=function(i,r,n){r===void 0&&(r=i),n===void 0&&(n=!0),this.renderModule?this.notify(w.wtl,{startIndex:i,endIndex:r,hide:n,isCol:!0}):o.prototype.hideColumn.call(this,i,r,n)},t.prototype.clear=function(i){this.notify(E.MQ,{options:i,isPublic:!0})},t.prototype.refresh=function(i){this[E.NB]&&this[E.JJ](),i?(this.notify(E.EP,null),this.sheets.length=0,this.sheetNameCount=1,this.notify(pe.Iap,{}),this.createSheet(),this.activeSheetIndex=this.sheets.length-1,this.notify(E.$c,{}),this.notify(pe.B7N,{action:"initSheetInfo"}),this.renderModule.refreshSheet(),this.openModule.isImportedFile=!1,this.openModule.unProtectSheetIdx=[]):o.prototype.refresh.call(this)},t.prototype.insertImage=function(i,r){var n;for(n=0;n<i.length;n++)this.notify(E.oE,{options:i[n],range:r||this.getActiveSheet().selectedRange,isPublic:!0})},t.prototype.deleteImage=function(i,r){this.notify(E.ao,{id:i,range:r||this.getActiveSheet().selectedRange})},t.prototype.getRowHeaderContent=function(){return this.sheetModule.getRowHeaderPanel()},t.prototype.getColumnHeaderContent=function(){return this.sheetModule.getColHeaderPanel()},t.prototype.getMainContent=function(){return this.sheetModule.getContentPanel()},t.prototype.getSelectAllContent=function(){return this.sheetModule.getSelectAllContent()},t.prototype.getScrollElement=function(){return this.sheetModule.getScrollElement()},t.prototype.getContentTable=function(){return this.sheetModule.getContentTable()},t.prototype.getRowHeaderTable=function(){return this.sheetModule.getRowHeaderTable()},t.prototype.getColHeaderTable=function(){return this.sheetModule.getColHeaderTable()},t.prototype.getThreshold=function(i){var r=Math.round((this.viewport[i+"Count"]+1)/2);return r<15?15:r},t.prototype.isMobileView=function(){return(this.cssClass.indexOf("e-mobile-view")>-1||a.AR.isDevice)&&this.cssClass.indexOf("e-desktop-view")===-1&&!1},t.prototype.getValueRowCol=function(i,r,n,s,l,h){return o.prototype.getValueRowCol.call(this,i,r,n,s,l,h)},t.prototype.updateCell=function(i,r){r=r||this.getActiveSheet().activeCell,o.prototype.updateCell.call(this,i,r)},t.prototype.getRowData=function(i,r){return o.prototype.getRowData.call(this,i,r)},t.prototype.sort=function(i,r){var n=this;return this.allowSorting?o.prototype.sort.call(this,i,r).then(function(s){return n.notify(w.Vzf,s),Promise.resolve(s)}):Promise.reject()},t.prototype.setValueRowCol=function(i,r,n,s,l){if(r==="circular reference: "){var h={action:"isCircularReference",argValue:r};this.notify(E.Sn,h),r=h.argValue}o.prototype.setValueRowCol.call(this,i,r,n,s,l),this.notify(E.vJ,{action:"refreshDependentCellValue",rowIdx:n,colIdx:s,sheetIdx:(0,w.PmP)(this,i)})},t.prototype.getModuleName=function(){return"spreadsheet"},t.prototype.refreshNode=function(i,r){var n;if(i){if(r){if(r.result=(0,a.le)(r.result)?"":r.result.toString(),!r.isRowFill){var s=(0,a.Ys)(".e-fill",i);s&&((0,a.og)(s),i.style.display="table-cell");var l=(0,a.Ys)(".e-fill-sec",i);l&&(0,a.og)(l)}var h=(0,a.Ys)("#"+this.element.id+"_currency",i);if(h&&(0,a.og)(h),r.type==="Accounting"&&(0,w.hj$)(r.value)){i.querySelector("a")?i.querySelector("a").textContent=r.result.split(r.curSymbol).join(""):i.innerHTML="",i.appendChild(this.createElement("span",{id:this.element.id+"_currency",innerHTML:""+r.curSymbol,styles:"float: left"})),i.querySelector("a")||(i.innerHTML+=r.result.split(r.curSymbol).join("")),i.classList.add("e-right-align");return}else{var c=void 0;r.result&&(r.result.toLowerCase()==="true"||r.result.toLowerCase()==="false")?(r.result=r.result.toUpperCase(),c="e-center-align",r.isRightAlign=!0):c="e-right-align",n=r.result,r.isRightAlign?i.classList.add(c):i.classList.remove(c)}}n=(0,a.le)(n)?"":n;var u=i.lastChild;i.querySelector(".e-databar-value")&&(u=i.querySelector(".e-databar-value").lastChild),i.querySelector(".e-hyperlink")&&(u=i.querySelector(".e-hyperlink").lastChild);var p=i.querySelector(".e-wrap-content");p&&(p.lastChild||p.appendChild(document.createTextNode("")),u=p.lastChild),u&&(u.nodeType===3||u.nodeType===1)?r.isRowFill||(u.nodeValue=n):i.appendChild(document.createTextNode(n))}},t.prototype.calculateHeight=function(i,r,n){r===void 0&&(r=1),n===void 0&&(n=1);var s=i&&i.fontSize||this.cellStyle.fontSize,l=i.fontFamily==="Arial Black"?1.44:1.24;return(s.indexOf("pt")>-1?parseInt(s,10)*1.33:parseInt(s,10))*l*r+n*l},t.prototype.skipHidden=function(i,r,n,s){n===void 0&&(n="rows"),s===void 0&&(s=this.scrollSettings.isFinite);var l=this.getActiveSheet(),h;this.scrollSettings.isFinite&&(h=(n==="rows"?l.rowCount:l.colCount)-1);for(var c=i;c<=r;c++)if(l[n][c]&&l[n][c].hidden){if(i===c&&i++,r++,s&&r>h){r=h;break}}else if(!s&&this.scrollSettings.isFinite&&r>h&&l[n][c-1]&&l[n][c-1].hidden){r--;break}return[i,r]},t.prototype.updateActiveBorder=function(i,r){r===void 0&&(r=".e-ribbon");var n=(0,a.Ys)(r+" .e-tab-header .e-indicator",this.element);n.style.display="none",(0,a.V7)(n,{left:"",right:""}),(0,a.V7)(n,{left:i.offsetLeft+"px",right:i.parentElement.offsetWidth-(i.offsetLeft+i.offsetWidth)+"px"}),n.style.display=""},t.prototype.undo=function(){this.notify(E.Y5,{isUndo:!0,isPublic:!0})},t.prototype.redo=function(){this.notify(E.Y5,{isUndo:!1,isPublic:!0})},t.prototype.updateUndoRedoCollection=function(i){this.notify(E.dW,{args:i,isPublic:!0})},t.prototype.addDefinedName=function(i){var r={action:"addDefinedName",isAdded:!1,definedName:i};return this.notify(E.Sn,r),r.isAdded},t.prototype.removeDefinedName=function(i,r){return o.prototype.removeDefinedName.call(this,i,r)},t.prototype.mouseClickHandler=function(i){this.notify(E.V4,i)},t.prototype.mouseDownHandler=function(i){this.notify(E.uG,i)},t.prototype.keyUpHandler=function(i){(0,a.oq)(i.target,".e-find-dlg")?this.notify(w.wzZ,i):this.notify(E.yR,i)},t.prototype.keyDownHandler=function(i){(0,a.oq)(i.target,".e-findtool-dlg")||this.notify(E.SH,i)},t.prototype.freeze=function(i){if(!!this.allowFreezePane){if(i.triggerEvent){var r={row:i.row,column:i.column,cancel:!1,sheetIndex:this.activeSheetIndex};if(this.notify(pe.ya2,{eventArgs:r,action:"freezePanes"}),r.cancel)return}this.on(E.eT,this.freezePaneUpdated,this),this.freezePanes(i.row,i.column),this.notify(w.bUq,null)}},t.prototype.freezePaneUpdated=function(){this.off(E.eT,this.freezePaneUpdated);var i=this.getActiveSheet();this.notify(E.Av,{eventArgs:{row:i.frozenRows,column:i.frozenColumns,sheetIndex:this.activeSheetIndex},action:"freezePanes"})},t.prototype.wireEvents=function(){a.bi.add(this.element,"click",this.mouseClickHandler,this),a.bi.add(this.element,S(),this.mouseDownHandler,this),a.bi.add(this.element,"keyup",this.keyUpHandler,this),a.bi.add(this.element,"keydown",this.keyDownHandler,this),a.bi.add(this.element,"noderefresh",this.refreshNode,this),this.on(E.vV,this.freeze,this),this.on(w.HoA,this.refreshInsertDelete,this)},t.prototype.destroy=function(){this[E.NB]&&this[E.JJ](),this.unwireEvents(),this.notify(E.xn,null),o.prototype.destroy.call(this),this.element.innerHTML="",this.element.removeAttribute("tabindex"),this.element.removeAttribute("role"),this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("min-height"),this.element.style.removeProperty("min-width")},t.prototype.unwireEvents=function(){a.bi.remove(this.element,"click",this.mouseClickHandler),a.bi.remove(this.element,S(),this.mouseDownHandler),a.bi.remove(this.element,"keyup",this.keyUpHandler),a.bi.remove(this.element,"keydown",this.keyDownHandler),a.bi.remove(this.element,"noderefresh",this.refreshNode),this.off(E.vV,this.freeze),this.off(w.HoA,this.refreshInsertDelete)},t.prototype.refreshInsertDelete=function(i){var r=this,n,s;i.sheet.ranges.forEach(function(l){l.template&&l.address&&(s=(0,w.dK5)(l.address),n=r.updateRangeOnInsertDelete(i,s),n&&(l.address=(0,pe.i0K)(s)))}),this.setSheetPropertyOnMute(i.sheet,"ranges",i.sheet.ranges)},t.prototype.addContextMenuItems=function(i,r,n,s){n===void 0&&(n=!0),this.notify(E.SF,{items:i,text:r,insertAfter:n,isUniqueId:s})},t.prototype.removeContextMenuItems=function(i,r){this.notify(E.vG,{items:i,isUniqueId:r})},t.prototype.enableContextMenuItems=function(i,r,n){r===void 0&&(r=!0),this.notify(E.fL,{items:i,enable:r,isUniqueId:n})},t.prototype.enableFileMenuItems=function(i,r,n){r===void 0&&(r=!0),this.notify(E.$V,{items:i,enable:r,isUniqueId:n})},t.prototype.hideFileMenuItems=function(i,r,n){r===void 0&&(r=!0),this.notify(E.BT,{items:i,hide:r,isUniqueId:n})},t.prototype.addFileMenuItems=function(i,r,n,s){n===void 0&&(n=!0),this.notify(E.sO,{items:i,text:r,insertAfter:n,isUniqueId:s})},t.prototype.hideRibbonTabs=function(i,r){r===void 0&&(r=!0),this.notify(E.b6,{tabs:i,hide:r})},t.prototype.enableRibbonTabs=function(i,r){r===void 0&&(r=!0),this.notify(E.TP,{tabs:i,enable:r})},t.prototype.addRibbonTabs=function(i,r){this.notify(E.Zf,{items:i,insertBefore:r})},t.prototype.enableToolbarItems=function(i,r,n){this.notify(E.y3,[{tab:i,items:r,enable:n===void 0?!0:n}])},t.prototype.hideToolbarItems=function(i,r,n){n===void 0&&(n=!0),this.notify(E.vD,{tab:i,indexes:r,hide:n})},t.prototype.addToolbarItems=function(i,r,n){this.notify(E.Pk,{tab:i,items:r,index:n})},t.prototype.selectRange=function(i){this.isEdit&&this.notify(E.vJ,{action:"endEdit"}),this.notify(E.Y0,{address:i})},t.prototype.startEdit=function(){this.notify(E.vJ,{action:"startEdit",isNewValueEdit:!1})},t.prototype.closeEdit=function(){this.notify(E.vJ,{action:"cancelEdit"})},t.prototype.endEdit=function(){this.notify(E.vJ,{action:"endEdit"})},t.prototype.onPropertyChanged=function(i,r){var n=this;o.prototype.onPropertyChanged.call(this,i,r);for(var s=function(p){var f=void 0,g=void 0;switch(p){case"enableRtl":if(f=l.getColumnHeaderContent(),f&&(f=f.parentElement),!f)break;i.enableRtl?(f.style.marginLeft=Ie()+"px",f.style.marginRight="",document.getElementById(l.element.id+"_sheet_panel").classList.add("e-rtl")):(f.style.marginRight=Ie()+"px",f.style.marginLeft="",document.getElementById(l.element.id+"_sheet_panel").classList.remove("e-rtl")),Object.keys(i).indexOf("locale")===-1&&l.renderModule.refreshSheet();break;case"cssClass":r.cssClass&&(0,a.IV)([l.element],r.cssClass.split(" ")),i.cssClass&&(0,a.cn)([l.element],i.cssClass.split(" "));break;case"activeSheetIndex":l.renderModule.refreshSheet(),l.notify(E.Z,{idx:i.activeSheetIndex});break;case"width":l.setWidth(),l.resize();break;case"height":l.setHeight(),l.resize();break;case"showRibbon":l.notify(E.cA,{prop:"showRibbon",onPropertyChange:!0});break;case"showFormulaBar":l.notify(E.y8,{uiUpdate:!0});break;case"showSheetTabs":l.notify(E.LA,null);break;case"cellStyle":l.renderModule.refreshSheet();break;case"allowEditing":if(l.allowEditing&&(l.notify(E.vJ,{action:"renderEditor"}),l.enableKeyboardNavigation)){l.enableKeyboardNavigation=!1,l.dataBind(),l.enableKeyboardNavigation=!0,l.dataBind();var C=l.selectionSettings.mode;C!=="None"&&(l.selectionSettings.mode="None",l.dataBind(),l.selectionSettings.mode=C,l.dataBind())}break;case"allowInsert":g=l.element.getElementsByClassName("e-add-sheet-tab")[0],g&&(g.disabled=!l.allowInsert,l.allowInsert?g.classList.contains("e-disabled")&&g.classList.remove("e-disabled"):g.classList.contains("e-disabled")||g.classList.add("e-disabled"));break;case"sheets":if(i.sheets===l.sheets){l.renderModule.refreshSheet(),l.notify(E.$c,null),l.notify(pe.B7N,{action:"initSheetInfo"});break}var L;Object.keys(i.sheets).forEach(function(R,B){var H=i.sheets[R];if(H.ranges&&Object.keys(H.ranges).length){var j=Object.keys(H.ranges),W;j.forEach(function(Le,ke){H.ranges[Le].info||(W=ke)}),j.forEach(function(Le,ke){H.ranges[Le].dataSource&&((0,a.o8)(W)||!(0,a.o8)(W)&&W===ke)&&n.notify(w.vB1,{sheetIdx:R,rangeIdx:Le,isLastRange:j.length-1===ke,changedData:H.ranges[Le].dataSource})})}else if(H.paneTopLeftCell&&r.sheets&&r.sheets[R]&&r.sheets[R].paneTopLeftCell){if(n.activeSheetIndex!==Number(R))return;var ne=(0,w.n53)(H.paneTopLeftCell),ie=(0,w.n53)(r.sheets[R].paneTopLeftCell);if(ne[0]!==ie[0]){var me=n.frozenRowCount(n.getActiveSheet()),ve=ne[0]>me?(0,He.EB)(n.getActiveSheet(),me,ne[0]-1):0;n.notify(E.Of,{top:ve})}if(ne[1]!==ie[1]){var Ee=n.frozenColCount(n.getActiveSheet()),le=ne[1]>Ee?(0,w.pGm)(n.getActiveSheet(),Ee,ne[1]-1):0;n.notify(E.Of,{left:le})}}else if(B===0&&n.renderModule.refreshSheet(),n.showSheetTabs&&H.name&&!L){var de=(0,a.Ys)(".e-sheet-tabs-items",n.element),fe=Number(R);de.children[fe+1]?n.notify(E.ej,{items:de,value:H.name,idx:fe}):(n.notify(E.$c,null),L=!0)}});break;case"locale":l.refresh();break;case"password":l.password.length>0&&l.showSheetTabs&&(l.element.querySelector(".e-add-sheet-tab").setAttribute("disabled","true"),l.element.querySelector(".e-add-sheet-tab").classList.add("e-disabled"));break;case"isProtected":if(l.isProtected){var D=l.element.getElementsByClassName("e-add-sheet-tab")[0];D&&(D.disabled=l.isProtected,l.isProtected?D.classList.contains("e-disabled")&&D.classList.add("e-disabled"):D.classList.contains("e-disabled")||D.classList.remove("e-disabled"))}break;case"allowFreezePane":l.notify(E.cA,{prop:"allowFreezePane",onPropertyChange:!0});break}},l=this,h=0,c=Object.keys(i);h<c.length;h++){var u=c[h];s(u)}},t.prototype.requiredModules=function(){return U(this)},t.prototype.appendTo=function(i){o.prototype.appendTo.call(this,i)},t.prototype.filter=function(i,r){return this.allowFiltering?(r=r||this.getActiveSheet().selectedRange,o.prototype.filter.call(this,i,r)):Promise.reject()},t.prototype.clearFilter=function(i){this.notify(E.Dg,{field:i})},t.prototype.applyFilter=function(i,r){if(!this.allowFiltering)return Promise.reject();var n=new Promise(function(l,h){l(function(){}())}),s={predicates:i,range:r,isInternal:!0,promise:n};return this.notify(E.WG,s),s.promise},t.prototype.addCustomFunction=function(i,r){o.prototype.addCustomFunction.call(this,i,r),this.notify(E.YM,null)};var e;return Wt([(0,a.Z9)("")],t.prototype,"cssClass",void 0),Wt([(0,a.Z9)(!0)],t.prototype,"allowScrolling",void 0),Wt([(0,a.Z9)(!0)],t.prototype,"allowResizing",void 0),Wt([(0,a.Z9)(!0)],t.prototype,"showAggregate",void 0),Wt([(0,a.Z9)(!0)],t.prototype,"enableClipboard",void 0),Wt([(0,a.Z9)(!0)],t.prototype,"enableContextMenu",void 0),Wt([(0,a.Z9)(!0)],t.prototype,"enableKeyboardNavigation",void 0),Wt([(0,a.Z9)(!0)],t.prototype,"enableKeyboardShortcut",void 0),Wt([(0,a.Z9)(!0)],t.prototype,"allowUndoRedo",void 0),Wt([(0,a.Z9)(!0)],t.prototype,"allowWrap",void 0),Wt([(0,a.Zz)({},X1)],t.prototype,"selectionSettings",void 0),Wt([(0,a.Zz)({},K1)],t.prototype,"scrollSettings",void 0),Wt([(0,a.ju)()],t.prototype,"beforeCellRender",void 0),Wt([(0,a.ju)()],t.prototype,"beforeSelect",void 0),Wt([(0,a.ju)()],t.prototype,"select",void 0),Wt([(0,a.ju)()],t.prototype,"contextMenuBeforeOpen",void 0),Wt([(0,a.ju)()],t.prototype,"fileMenuBeforeOpen",void 0),Wt([(0,a.ju)()],t.prototype,"contextMenuBeforeClose",void 0),Wt([(0,a.ju)()],t.prototype,"dialogBeforeOpen",void 0),Wt([(0,a.ju)()],t.prototype,"fileMenuBeforeClose",void 0),Wt([(0,a.ju)()],t.prototype,"contextMenuItemSelect",void 0),Wt([(0,a.ju)()],t.prototype,"fileMenuItemSelect",void 0),Wt([(0,a.ju)()],t.prototype,"beforeDataBound",void 0),Wt([(0,a.ju)()],t.prototype,"dataBound",void 0),Wt([(0,a.ju)()],t.prototype,"dataSourceChanged",void 0),Wt([(0,a.ju)()],t.prototype,"cellEdit",void 0),Wt([(0,a.ju)()],t.prototype,"cellEditing",void 0),Wt([(0,a.ju)()],t.prototype,"cellSave",void 0),Wt([(0,a.ju)()],t.prototype,"beforeCellSave",void 0),Wt([(0,a.ju)()],t.prototype,"created",void 0),Wt([(0,a.ju)()],t.prototype,"beforeSort",void 0),Wt([(0,a.ju)()],t.prototype,"beforeHyperlinkCreate",void 0),Wt([(0,a.ju)()],t.prototype,"afterHyperlinkCreate",void 0),Wt([(0,a.ju)()],t.prototype,"beforeHyperlinkClick",void 0),Wt([(0,a.ju)()],t.prototype,"afterHyperlinkClick",void 0),Wt([(0,a.ju)()],t.prototype,"beforeConditionalFormat",void 0),Wt([(0,a.ju)()],t.prototype,"actionBegin",void 0),Wt([(0,a.ju)()],t.prototype,"actionComplete",void 0),Wt([(0,a.ju)()],t.prototype,"openComplete",void 0),Wt([(0,a.ju)()],t.prototype,"sortComplete",void 0),t=e=Wt([a.Zl],t),t}(hA.I),_R=ae(57474),W0=ae(73935),uA=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),pA=["alt","className","disabled","form","id","readOnly","style","tabIndex","title","type","name","onClick","onFocus","onBlur"],dA=["accordion","tab","splitter"],jR=0,fA=new RegExp("]"),vA=function(o){uA(t,o);function t(){var e=o!==null&&o.apply(this,arguments)||this;return e.mountingState=!1,e.attrKeys=[],e.cachedTimeOut=0,e.isAppendCalled=!1,e.initRenderCalled=!1,e.isReactForeceUpdate=!1,e.isReact=!0,e.isshouldComponentUpdateCalled=!1,e.isCreated=!1,e}return t.prototype.componentDidMount=function(){this.refreshChild(!0),this.canDelayUpdate=dA.indexOf(this.getModuleName())!==-1,this.renderReactComponent(),this.portals&&this.portals.length&&(this.mountingState=!0,this.renderReactTemplates(),this.mountingState=!1)},t.prototype.componentDidUpdate=function(e){!this.isshouldComponentUpdateCalled&&this.initRenderCalled&&!this.isReactForeceUpdate&&(this.isshouldComponentUpdateCalled=!0,e!==this.props&&this.refreshProperties(this.props,!0))},t.prototype.renderReactComponent=function(){var e=this.reactElement;e&&!this.isAppendCalled&&(this.isAppendCalled=!0,this.appendTo(e))},t.prototype.shouldComponentUpdate=function(e){return this.isshouldComponentUpdateCalled=!0,this.initRenderCalled?(this.isAppendCalled||(clearTimeout(this.cachedTimeOut),this.isAppendCalled=!0,this.appendTo(this.reactElement)),this.updateProperties(e),!0):(this.updateProperties(e,!0),!0)},t.prototype.updateProperties=function(e,i){for(var r=this,n=(0,a.l7)({},e),s=Object.keys(e),l=0,h=s;l<h.length;l++){var c=h[l],u=c==="className";if(c!=="children")if(!u&&!(0,a.le)(this.htmlattributes[c])&&this.htmlattributes[c]!==n[c]&&(this.htmlattributes[c]=n[c]),this.compareValues(this.props[c],e[c]))delete n[c];else if(this.attrKeys.indexOf(c)!==-1)if(u){this.clsName=!0;for(var p=this.props[c].split(" "),f=0;f<p.length;f++)this.element.classList.remove(p[f]);for(var g=n[c].split(" "),C=0;C<g.length;C++)this.element.classList.add(g[C])}else c!=="disabled"&&delete n[c];else(c==="value"&&e[c]===this[c]||(c==="valueTemplate"||c==="itemTemplate"||c==="headerTemplate")&&e[c].toString()===this[c].toString()||c==="content"&&typeof n[c]=="function")&&delete n[c]}n.children&&delete n.children,this.initRenderCalled&&(this.canDelayUpdate||this.props.delayUpdate)?setTimeout(function(){r.refreshProperties(n,e,i)}):this.refreshProperties(n,e,i)},t.prototype.refreshProperties=function(e,i,r){Object.keys(e).length&&(r||this.processComplexTemplate(e,this),this.setProperties(e,r)),this.refreshChild(r,i)},t.prototype.processComplexTemplate=function(e,i){var r=i.complexTemplate;if(r)for(var n in r){var s=r[n];e[n]&&(0,a.sO)(s,(0,a.NA)(n,e),e)}},t.prototype.getDefaultAttributes=function(){var e=this;this.isReact=!0;var i=Object.keys(this.props),r=["autocomplete","dropdownlist","combobox"];this.htmlattributes||(this.htmlattributes={}),this.attrKeys=pA.concat(this.controlAttributes||[]);for(var n=0,s=i;n<s.length;n++){var l=s[n];(l.indexOf("data-")!==-1||l.indexOf("aria-")!==-1||this.attrKeys.indexOf(l)!==-1)&&this.htmlattributes[l]!==this.props[l]&&(this.htmlattributes[l]=this.props[l])}if(!this.htmlattributes.ref){this.htmlattributes.ref=function(f){e.reactElement=f};var h=["autocomplete","combobox","dropdownlist","dropdowntree","multiselect","listbox","colorpicker","numerictextbox","textbox","uploader","maskedtextbox","slider","datepicker","datetimepicker","daterangepicker","timepicker","checkbox","switch","radio"];h.indexOf(this.getModuleName())!==-1&&(this.htmlattributes.key=""+t.reactUid,t.reactUid++)}if(this.clsName){for(var c=this.element.classList,u=this.htmlattributes.className,p=0;p<c.length;p++)u.indexOf(c[p])==-1&&(this.htmlattributes.className=this.htmlattributes.className+" "+c[p]);this.clsName=!1}return this.htmlattributes},t.prototype.trigger=function(e,i,r){var n=this;if(this.isDestroyed!==!0&&this.modelObserver){if(fA.test(e)){var s=(0,a.NA)(e,this);s?(s.call(this,i),r&&r.call(this,i)):r&&r.call(this,i)}(e==="change"||e==="input")&&this.props.onChange&&i.event&&this.props.onChange.call(void 0,{syntheticEvent:i.event,nativeEvent:{text:i.value},value:i.value,target:this});var l=this.isProtectedOnChange;this.isProtectedOnChange=!1,e==="created"?setTimeout(function(){n.isCreated=!0,n.isDestroyed||n.modelObserver.notify(e,i,r)}):this.modelObserver.notify(e,i,r),this.isProtectedOnChange=l}},t.prototype.compareValues=function(e,i){var r=typeof e,n=typeof i;if(r===n){if(e===i)return!0;if((!(0,a.le)(e)&&e.constructor)!==(!(0,a.le)(i)&&i.constructor))return!1;if(e instanceof Date||e instanceof RegExp||e instanceof String||e instanceof Number)return e.toString()===i.toString();if((0,a.Kn)(e)||Array.isArray(e)){var s=e,l=i;return(0,a.Kn)(s)&&(s=[e],l=[i]),this.compareObjects(s,l).status}}return!1},t.prototype.compareObjects=function(e,i,r){var n=!0,s=e.length===i.length,l=[];if(s)for(var h=0,c=i.length;h<c;h++){var u={},p=e[h],f=i[h],g=Object.keys(f);if(g.length!==0)for(var C=0,L=g;C<L.length;C++){var D=L[C],R=p[D],B=f[D];if(D==="items"){for(var H=0;H<B.length;H++)if(this.getModuleName()==="richtexteditor"&&typeof B[H]=="object")return{status:!0}}if(this.getModuleName()==="grid"&&D==="field"&&(u[D]=B),!p.hasOwnProperty(D)||!this.compareValues(R,B)){if(!r)return{status:!1};n=!1,u[D]=B}}else if(f[h]===p[h])n=!0;else{if(!r)return{status:!1};n=!1}Object.keys(u).length&&l.push({index:h,value:u,key:r})}else n=!1;return{status:n,changedProperties:l}},t.prototype.refreshChild=function(e,i){if(this.checkInjectedModules){for(var r=this.getInjectedModules()||[],n=this.getInjectedServices()||[],s=0,l=n;s<l.length;s++){var h=l[s];r.indexOf(h)===-1&&r.push(h)}this.injectedModules=r}if(this.directivekeys){var c=[],u=this.validateChildren({},this.directivekeys,i||this.props);if(u&&Object.keys(u).length){if(!e&&this.skipRefresh)for(var p=0,f=this.skipRefresh;p<f.length;p++){var g=f[p];delete u[g]}if(this.prevProperties)for(var C=Object.keys(this.prevProperties),L=0;L<C.length;L++){var D=C[L];if(!!u.hasOwnProperty(D)){var R=this.compareObjects(this.prevProperties[D],u[D],D);if(R.status)delete u[D];else{R.changedProperties.length&&(c=c.concat(R.changedProperties));var B={};B[D]=u[D],this.prevProperties=(0,a.l7)(this.prevProperties,B)}}}else this.prevProperties=(0,a.l7)({},u,{},!0);if(c.length)if(this.getModuleName()==="grid"&&D==="columns")for(var H=0,j=this.columns;H<j.length;H++){var W=(0,a.NA)("field",j[H]),ne=(0,a.NA)(H+".value.field",c);if(W===ne){var ie=(0,a.NA)(c[H].key+"."+c[H].index,this);ie&&ie.setProperties?ie.setProperties(c[H].value):(0,a.l7)(ie,c[H].value)}else this.setProperties(u,e)}else for(var me=0,ve=c;me<ve.length;me++){var Ee=ve[me],le=(0,a.NA)(Ee.key+"."+Ee.index,this);le&&le.setProperties?le.setProperties(Ee.value):(0,a.l7)(le,Ee.value)}else this.setProperties(u,e)}}},t.prototype.componentWillUnmount=function(){clearTimeout(this.cachedTimeOut);var e=["dropdowntree","checkbox"];this.initRenderCalled&&this.isAppendCalled&&this.element&&(e.indexOf(this.getModuleName())?!0:document.body.contains(this.element))&&!this.isDestroyed&&this.isCreated&&this.destroy()},t.prototype.appendReactElement=function(e,i){var r=W0.createPortal(e,i);this.portals?this.portals.push(r):this.portals=[r]},t.prototype.renderReactTemplates=function(e){this.isReactForeceUpdate=!0,e?this.forceUpdate(e):this.forceUpdate(),this.isReactForeceUpdate=!1},t.prototype.clearTemplate=function(e,i,r){var n=this,s=[];e&&e.length?Array.prototype.forEach.call(e,function(l){var h=0,c=0;if(n.portals.forEach(function(p){p.propName===l&&(s.push(c),c++)}),i&&n.portals[s[i[h]]].propName==l)n.portals.splice(i,1),h++;else for(var u=0;u<n.portals.length;u++)n.portals[u].propName==l&&(n.portals.splice(u,1),u--)}):this.portals=[],this.renderReactTemplates(r)},t.prototype.validateChildren=function(e,i,r){for(var n=!1,s=Y.Children.toArray(r.children),l=0,h=s;l<h.length;l++){var c=h[l],u=this.getChildType(c),p=i[u];if(u&&i){var f=this.getChildProps(Y.Children.toArray(c.props.children),p);f.length&&(n=!0,e[c.type.propertyName||u]=f)}}return n?e:null},t.prototype.getChildType=function(e){return e.type&&e.type.isDirective&&e.type.moduleName||""},t.prototype.getChildProps=function(e,i){for(var r=[],n=0,s=e;n<s.length;n++){var l=s[n],h=!1,c=void 0;typeof i=="string"?(h=!0,c=i):c=Object.keys(i)[0];var u=l.props,p=this.getChildType(l);if(p===c)if(h||!u.children){var f=(0,a.l7)({},u,{},!0);this.processComplexTemplate(f,l.type),r.push(f)}else{var g=this.validateChildren((0,a.l7)({},u),i[c],u)||u;g.children&&delete g.children,this.processComplexTemplate(g,l.type),r.push(g)}}return r},t.prototype.getInjectedServices=function(){for(var e=Y.Children.toArray(this.props.children),i=0,r=e;i<r.length;i++){var n=r[i];if(n.type.isService)return n.props.services}return[]},t.reactUid=1,t}(Y.Component);function mA(o,t){t.forEach(function(e){Object.getOwnPropertyNames(e.prototype).forEach(function(i){i!=="isMounted"&&i!=="replaceState"&&(o.prototype[i]=e.prototype[i])})})}var gA=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Hn=function(o){gA(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(){return null},t.isDirective=!0,t}(Y.PureComponent),yA=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),WR=function(o){yA(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.render=function(){return null},t.isService=!0,t}(Y.PureComponent),bA=(0,a.aR)();function CA(o,t){return typeof o=="string"?bA(o,t):function(e,i,r,n){var s=o,l=e;typeof s=="object"&&(s=o.template,l=(0,a.l7)({},e,o.data||{}));var h;n?h=n:h=document.createElement("div");var c=Y.createElement(s,l),u=W0.createPortal(c,h);if(u.propName=r,i.portals?i.portals.push(u):i.portals=[u],!n)return[h]}}(0,a.Wr)({compile:CA});var SA=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),U0=function(o){SA(t,o);function t(e){var i=o.call(this,e)||this;return i.initRenderCalled=!1,i.checkInjectedModules=!0,i.directivekeys={sheets:{sheet:{rows:{row:{cells:{cell:{images:"image",charts:"chart"}}}},columns:"column",ranges:"range",conditionalFormats:"conditionalFormat"}},definedNames:"definedName"},i.immediateRender=!1,i.portals=[],i}return t.prototype.render=function(){if((this.element&&!this.initRenderCalled||this.refreshing)&&!this.isReactForeceUpdate)o.prototype.render.call(this),this.initRenderCalled=!0;else return Y.createElement("div",this.getDefaultAttributes(),[].concat(this.props.children,this.portals))},t}(tf);mA(U0,[vA,Y.Component]);var q0=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),wA=function(o){q0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.moduleName="sheet",t}(Hn),xA=function(o){q0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.propertyName="sheets",t.moduleName="sheets",t}(Hn),Z0=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ol=function(o){Z0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.moduleName="row",t}(Hn),EA=function(o){Z0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.propertyName="rows",t.moduleName="rows",t}(Hn),Y0=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Nc=function(o){Y0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.moduleName="cell",t}(Hn),Bc=function(o){Y0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.propertyName="cells",t.moduleName="cells",t}(Hn),G0=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),AA=function(o){G0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.moduleName="range",t}(Hn),TA=function(o){G0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.propertyName="ranges",t.moduleName="ranges",t}(Hn),K0=function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)r.hasOwnProperty(n)&&(i[n]=r[n])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Sa=function(o){K0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.moduleName="column",t}(Hn),LA=function(o){K0(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.propertyName="columns",t.moduleName="columns",t}(Hn),zt=ae(85893),kA=function(){var t=(0,Y.useRef)(),e=(0,Y.useState)([]),i=(0,P.Z)(e,2),r=i[0],n=i[1],s=(0,Y.useState)([]),l=(0,P.Z)(s,2),h=l[0],c=l[1],u=F.A.useForm(),p=(0,P.Z)(u,1),f=p[0],g=function(j,W){console.log(j,W)},C=[{title:"No.",key:"risk_no",dataIndex:"risk_no",fixed:"left",valueType:"digit",width:100,render:function(j,W,ne,ie,me){return(0,zt.jsx)(zt.Fragment,{children:(0,zt.jsx)("p",{children:W.risk_no?W.risk_no:""})})}},{title:"Works Activity",key:"work_activity",dataIndex:"work_activity",width:400,valueType:"select",valueEnum:{"Working closely existing facility":{text:"Working closely existing facility"},"Transportation of workers/ Road accidents":{text:"Transportation of workers/ Road accidents"},"Working in deep excavation":{text:"Working in deep excavation"},"Trench excavation":{text:"Trench excavation"},Lifting:{text:"Lifting"},"Work at height":{text:"Work at height"}},render:function(j,W,ne,ie,me){return(0,zt.jsx)(zt.Fragment,{children:(0,zt.jsx)("p",{children:W.work_activity?W.work_activity:""})})}},{title:"Hazard",key:"hazard",dataIndex:"hazard",width:600,valueType:"select",fieldProps:{mode:"multiple",onChange:function(j){var W,ne=f.getFieldsValue();ne[r[0]].children||(ne[r[0]].children=[]),(W=ne[r[0]].children)===null||W===void 0||W.push({key:"".concat(r,"-").concat(ne[r[0]].children.length+1),keys:"".concat(r,"-").concat(ne[r[0]].children.length+1),hazard:j[0]}),console.log(ne[r[0]]),f.setFieldsValue(ne),f.submit()}},valueEnum:{"Gas release and Fire causing Personal injury and property damage":{text:"Gas release and Fire causing Personal injury and property damage"},"Accident transportation cause property damage":{text:"Accident transportation cause property damage"},"injury to workman":{text:"injury to workman"},"Injury to public/people":{text:"Injury to public/people"},"Excavation collapse due to not enough shoring and protection causing injury":{text:"Excavation collapse due to not enough shoring and protection causing injury"},"Lifting equipment and material":{text:"Lifting equipment and material"},"Falling object":{text:"Falling object"},"Refer to item 12 confined space entry":{text:"Refer to item 12 confined space entry"},Flooding:{text:"Flooding"},"Access is not enough":{text:"Access is not enough"},"Damage to under ground utility":{text:"Damage to under ground utility"},"Water jetting injury":{text:"Water jetting injury"},"Drowning/water logging inside the trench":{text:"Drowning/water logging inside the trench"},"Operator not competent":{text:"Operator not competent"},"Load fall while lifting cauing damage to property and injury to people":{text:"Load fall while lifting cauing damage to property and injury to people"},"Crane topple over injury to people and property damage":{text:"Crane topple over injury to people and property damage"},"Lifting equipment failure":{text:"Lifting equipment failure"},"Pinch points on body part while lifting":{text:"Pinch points on body part while lifting"},"Heavy rain during lifting cause crane topple, load drop on work crew and property":{text:"Heavy rain during lifting cause crane topple, load drop on work crew and property"},"Worker falling":{text:"Worker falling"}},render:function(j,W,ne,ie,me){return(0,zt.jsx)(zt.Fragment,{children:(0,zt.jsx)("p",{children:W.hazard?W.hazard:""})})}},{title:"Existing control",key:"existingControl",dataIndex:"existingControl",width:300,valueType:"select",fieldProps:{mode:"multiple"},valueEnum:{"Conduct Sub-contractor training before work on site for Supervisor and Worker":{text:"Conduct Sub-contractor training before work on site for Supervisor and Worker"},"Conduct daily tool box meeting":{text:"Conduct daily tool box meeting"},"Close supervision by Main Contrcactor Supervisor":{text:"Close supervision by Main Contrcactor Supervisor"},"Provide gas detector to be monitoring (ISBL)":{text:"Provide gas detector to be monitoring (ISBL)"},"Provide fire extinguisher":{text:"Provide fire extinguisher"},"Assign fire watchman during the work activity (ISBL)":{text:"Assign fire watchman during the work activity (ISBL)"},"Make the fence to isolate area":{text:"Make the fence to isolate area"}},render:function(j,W,ne,ie,me){return(0,zt.jsxs)(zt.Fragment,{children:[console.log(ie==null?void 0:ie.pageInfo),(0,zt.jsx)("div",{children:W.existingControl?W.existingControl.map(function(ve,Ee){return(0,zt.jsxs)("p",{children:[Ee+1,".",ve]})}):""})]})}},{title:"Action",key:"actions",valueType:"option",fixed:"right",width:150,render:function(j,W,ne,ie){return[(0,zt.jsx)("a",{color:"lime",onClick:function(){var ve;ie==null||(ve=ie.startEditable)===null||ve===void 0||ve.call(ie,W.keys)},children:"\u0E41\u0E01\u0E49\u0E44\u0E02"},"editable ")]}}],L=null,D=function(j){console.log(j)},R=function(j){var W,ne,ie,me,ve,Ee;console.log(j),(W=L)===null||W===void 0||W.cellFormat({fontWeight:"bold",textAlign:"center"},"A1:H1"),(ne=L)===null||ne===void 0||ne.cellFormat({verticalAlign:"middle"},"A1:H5"),(ie=L)===null||ie===void 0||ie.cellFormat({textAlign:"center"},"A2:B5"),(me=L)===null||me===void 0||me.cellFormat({textAlign:"center"},"D2:D5"),(ve=L)===null||ve===void 0||ve.wrap("E2:E5"),(Ee=L)===null||Ee===void 0||Ee.wrap("H3",!1)},B=[{No:"1","Works activity":"Weather condition",Hazard:"Work crew exposed to Lightning hazard when working on open area","Existing control":`
      1.  No work to be carried out
      2. Workers to be under shelter and away from tress and overhead services
      3. In place for container to double up as protection to workers, grounding rods for container and equipment
      `},{No:"2","Works activity":"Understanding of site safety procedure",Hazard:"Injury to people Property damage","Existing control":`
      1. Induction course
      3. SHE Management Plan                               
      4. Safety Induction & Training Procedure
      `}];return(0,zt.jsx)(zt.Fragment,{children:(0,zt.jsx)(U0,{ref:function(j){L=j},created:function(j){return R(j)},allowSave:!0,height:"500px",beforeOpen:function(j){return D(j)},children:(0,zt.jsx)(xA,{children:(0,zt.jsxs)(wA,{name:"Risk Identification Template",children:[(0,zt.jsxs)(EA,{children:[(0,zt.jsx)(Ol,{height:30}),(0,zt.jsx)(Ol,{children:(0,zt.jsx)(Bc,{children:(0,zt.jsx)(Nc,{index:7,wrap:!0})})}),(0,zt.jsx)(Ol,{children:(0,zt.jsx)(Bc,{children:(0,zt.jsx)(Nc,{index:7,wrap:!0})})}),(0,zt.jsx)(Ol,{children:(0,zt.jsx)(Bc,{children:(0,zt.jsx)(Nc,{index:7,wrap:!0})})}),(0,zt.jsx)(Ol,{children:(0,zt.jsx)(Bc,{children:(0,zt.jsx)(Nc,{index:7,wrap:!0})})})]}),(0,zt.jsx)(TA,{children:(0,zt.jsx)(AA,{dataSource:B})}),(0,zt.jsxs)(LA,{children:[(0,zt.jsx)(Sa,{width:200,index:1}),(0,zt.jsx)(Sa,{width:490}),(0,zt.jsx)(Sa,{width:490}),(0,zt.jsx)(Sa,{width:150}),(0,zt.jsx)(Sa,{width:120}),(0,zt.jsx)(Sa,{width:90}),(0,zt.jsx)(Sa,{width:180})]})]})})})})},IA=kA},13013:function(q,be,ae){"use strict";var P=ae(81555);be.Z=P.Z},65223:function(q,be,ae){"use strict";ae.d(be,{q3:function(){return w},qI:function(){return ye},RV:function(){return U},Rk:function(){return Z},aM:function(){return E},ap:function(){return a}});var P=ae(67294),F=ae(10366),Y=ae(4702),w=P.createContext({labelAlign:"right",vertical:!1,itemRef:function(){}}),ye=P.createContext(null),U=function(J){var se=(0,F.Z)(J,["prefixCls"]);return P.createElement(Y.FormProvider,se)},Z=P.createContext({prefixCls:""}),E=P.createContext({}),a=function(J){var se=J.children,re=(0,P.useMemo)(function(){return{}},[]);return P.createElement(E.Provider,{value:re},se)}},99134:function(q,be,ae){"use strict";var P=ae(67294),F=(0,P.createContext)({});be.Z=F},21584:function(q,be,ae){"use strict";var P=ae(96156),F=ae(22122),Y=ae(90484),w=ae(94184),ye=ae.n(w),U=ae(67294),Z=ae(53124),E=ae(99134),a=function(re,Ae){var Ie={};for(var Se in re)Object.prototype.hasOwnProperty.call(re,Se)&&Ae.indexOf(Se)<0&&(Ie[Se]=re[Se]);if(re!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Q=0,Se=Object.getOwnPropertySymbols(re);Q<Se.length;Q++)Ae.indexOf(Se[Q])<0&&Object.prototype.propertyIsEnumerable.call(re,Se[Q])&&(Ie[Se[Q]]=re[Se[Q]]);return Ie};function $(re){return typeof re=="number"?"".concat(re," ").concat(re," auto"):/^\d+(\.\d+)?(px|em|rem|%)$/.test(re)?"0 0 ".concat(re):re}var J=["xs","sm","md","lg","xl","xxl"],se=U.forwardRef(function(re,Ae){var Ie,Se=U.useContext(Z.E_),Q=Se.getPrefixCls,te=Se.direction,O=U.useContext(E.Z),d=O.gutter,M=O.wrap,T=O.supportFlexGap,b=re.prefixCls,k=re.span,S=re.order,m=re.offset,x=re.push,v=re.pull,y=re.className,A=re.children,I=re.flex,N=re.style,z=a(re,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),V=Q("col",b),_={};J.forEach(function(ue){var X,Ce={},ze=re[ue];typeof ze=="number"?Ce.span=ze:(0,Y.Z)(ze)==="object"&&(Ce=ze||{}),delete z[ue],_=(0,F.Z)((0,F.Z)({},_),(X={},(0,P.Z)(X,"".concat(V,"-").concat(ue,"-").concat(Ce.span),Ce.span!==void 0),(0,P.Z)(X,"".concat(V,"-").concat(ue,"-order-").concat(Ce.order),Ce.order||Ce.order===0),(0,P.Z)(X,"".concat(V,"-").concat(ue,"-offset-").concat(Ce.offset),Ce.offset||Ce.offset===0),(0,P.Z)(X,"".concat(V,"-").concat(ue,"-push-").concat(Ce.push),Ce.push||Ce.push===0),(0,P.Z)(X,"".concat(V,"-").concat(ue,"-pull-").concat(Ce.pull),Ce.pull||Ce.pull===0),(0,P.Z)(X,"".concat(V,"-rtl"),te==="rtl"),X))});var G=ye()(V,(Ie={},(0,P.Z)(Ie,"".concat(V,"-").concat(k),k!==void 0),(0,P.Z)(Ie,"".concat(V,"-order-").concat(S),S),(0,P.Z)(Ie,"".concat(V,"-offset-").concat(m),m),(0,P.Z)(Ie,"".concat(V,"-push-").concat(x),x),(0,P.Z)(Ie,"".concat(V,"-pull-").concat(v),v),Ie),y,_),K={};if(d&&d[0]>0){var oe=d[0]/2;K.paddingLeft=oe,K.paddingRight=oe}if(d&&d[1]>0&&!T){var he=d[1]/2;K.paddingTop=he,K.paddingBottom=he}return I&&(K.flex=$(I),M===!1&&!K.minWidth&&(K.minWidth=0)),U.createElement("div",(0,F.Z)({},z,{style:(0,F.Z)((0,F.Z)({},K),N),className:G,ref:Ae}),A)});se.displayName="Col",be.Z=se},92820:function(q,be,ae){"use strict";var P=ae(22122),F=ae(96156),Y=ae(90484),w=ae(28481),ye=ae(94184),U=ae.n(ye),Z=ae(67294),E=ae(53124),a=ae(98082),$=ae(24308),J=ae(93355),se=ae(99134),re=function(Q,te){var O={};for(var d in Q)Object.prototype.hasOwnProperty.call(Q,d)&&te.indexOf(d)<0&&(O[d]=Q[d]);if(Q!=null&&typeof Object.getOwnPropertySymbols=="function")for(var M=0,d=Object.getOwnPropertySymbols(Q);M<d.length;M++)te.indexOf(d[M])<0&&Object.prototype.propertyIsEnumerable.call(Q,d[M])&&(O[d[M]]=Q[d[M]]);return O},Ae=(0,J.b)("top","middle","bottom","stretch"),Ie=(0,J.b)("start","end","center","space-around","space-between","space-evenly"),Se=Z.forwardRef(function(Q,te){var O,d=Q.prefixCls,M=Q.justify,T=Q.align,b=Q.className,k=Q.style,S=Q.children,m=Q.gutter,x=m===void 0?0:m,v=Q.wrap,y=re(Q,["prefixCls","justify","align","className","style","children","gutter","wrap"]),A=Z.useContext(E.E_),I=A.getPrefixCls,N=A.direction,z=Z.useState({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}),V=(0,w.Z)(z,2),_=V[0],G=V[1],K=(0,a.Z)(),oe=Z.useRef(x);Z.useEffect(function(){var Et=$.ZP.subscribe(function(Vt){var ce=oe.current||0;(!Array.isArray(ce)&&(0,Y.Z)(ce)==="object"||Array.isArray(ce)&&((0,Y.Z)(ce[0])==="object"||(0,Y.Z)(ce[1])==="object"))&&G(Vt)});return function(){return $.ZP.unsubscribe(Et)}},[]);var he=function(){var Vt=[void 0,void 0],ce=Array.isArray(x)?x:[x,void 0];return ce.forEach(function(ee,Ne){if((0,Y.Z)(ee)==="object")for(var Te=0;Te<$.c4.length;Te++){var we=$.c4[Te];if(_[we]&&ee[we]!==void 0){Vt[Ne]=ee[we];break}}else Vt[Ne]=ee}),Vt},ue=I("row",d),X=he(),Ce=U()(ue,(O={},(0,F.Z)(O,"".concat(ue,"-no-wrap"),v===!1),(0,F.Z)(O,"".concat(ue,"-").concat(M),M),(0,F.Z)(O,"".concat(ue,"-").concat(T),T),(0,F.Z)(O,"".concat(ue,"-rtl"),N==="rtl"),O),b),ze={},We=X[0]!=null&&X[0]>0?X[0]/-2:void 0,Xe=X[1]!=null&&X[1]>0?X[1]/-2:void 0;if(We&&(ze.marginLeft=We,ze.marginRight=We),K){var tt=(0,w.Z)(X,2);ze.rowGap=tt[1]}else Xe&&(ze.marginTop=Xe,ze.marginBottom=Xe);var pt=(0,w.Z)(X,2),st=pt[0],ht=pt[1],rt=Z.useMemo(function(){return{gutter:[st,ht],wrap:v,supportFlexGap:K}},[st,ht,v,K]);return Z.createElement(se.Z.Provider,{value:rt},Z.createElement("div",(0,P.Z)({},y,{className:Ce,style:(0,P.Z)((0,P.Z)({},ze),k),ref:te}),S))});Se.displayName="Row",be.Z=Se},6999:function(q,be,ae){"use strict";var P=ae(38663),F=ae.n(P),Y=ae(80638),w=ae.n(Y)},46700:function(q,be,ae){var P={"./af":42786,"./af.js":42786,"./ar":30867,"./ar-dz":14130,"./ar-dz.js":14130,"./ar-kw":96135,"./ar-kw.js":96135,"./ar-ly":56440,"./ar-ly.js":56440,"./ar-ma":47702,"./ar-ma.js":47702,"./ar-sa":16040,"./ar-sa.js":16040,"./ar-tn":37100,"./ar-tn.js":37100,"./ar.js":30867,"./az":31083,"./az.js":31083,"./be":9808,"./be.js":9808,"./bg":68338,"./bg.js":68338,"./bm":67438,"./bm.js":67438,"./bn":8905,"./bn-bd":76225,"./bn-bd.js":76225,"./bn.js":8905,"./bo":11560,"./bo.js":11560,"./br":1278,"./br.js":1278,"./bs":80622,"./bs.js":80622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":50877,"./cv.js":50877,"./cy":47373,"./cy.js":47373,"./da":24780,"./da.js":24780,"./de":59740,"./de-at":60217,"./de-at.js":60217,"./de-ch":60894,"./de-ch.js":60894,"./de.js":59740,"./dv":5300,"./dv.js":5300,"./el":50837,"./el.js":50837,"./en-au":78348,"./en-au.js":78348,"./en-ca":77925,"./en-ca.js":77925,"./en-gb":22243,"./en-gb.js":22243,"./en-ie":46436,"./en-ie.js":46436,"./en-il":47207,"./en-il.js":47207,"./en-in":44175,"./en-in.js":44175,"./en-nz":76319,"./en-nz.js":76319,"./en-sg":31662,"./en-sg.js":31662,"./eo":92915,"./eo.js":92915,"./es":55655,"./es-do":55251,"./es-do.js":55251,"./es-mx":96112,"./es-mx.js":96112,"./es-us":71146,"./es-us.js":71146,"./es.js":55655,"./et":5603,"./et.js":5603,"./eu":77763,"./eu.js":77763,"./fa":76959,"./fa.js":76959,"./fi":11897,"./fi.js":11897,"./fil":42549,"./fil.js":42549,"./fo":94694,"./fo.js":94694,"./fr":94470,"./fr-ca":63049,"./fr-ca.js":63049,"./fr-ch":52330,"./fr-ch.js":52330,"./fr.js":94470,"./fy":5044,"./fy.js":5044,"./ga":29295,"./ga.js":29295,"./gd":2101,"./gd.js":2101,"./gl":38794,"./gl.js":38794,"./gom-deva":27884,"./gom-deva.js":27884,"./gom-latn":23168,"./gom-latn.js":23168,"./gu":95349,"./gu.js":95349,"./he":24206,"./he.js":24206,"./hi":30094,"./hi.js":30094,"./hr":30316,"./hr.js":30316,"./hu":22138,"./hu.js":22138,"./hy-am":11423,"./hy-am.js":11423,"./id":29218,"./id.js":29218,"./is":90135,"./is.js":90135,"./it":90626,"./it-ch":10150,"./it-ch.js":10150,"./it.js":90626,"./ja":39183,"./ja.js":39183,"./jv":24286,"./jv.js":24286,"./ka":12105,"./ka.js":12105,"./kk":47772,"./kk.js":47772,"./km":18758,"./km.js":18758,"./kn":79282,"./kn.js":79282,"./ko":33730,"./ko.js":33730,"./ku":1408,"./ku.js":1408,"./ky":33291,"./ky.js":33291,"./lb":36841,"./lb.js":36841,"./lo":55466,"./lo.js":55466,"./lt":57010,"./lt.js":57010,"./lv":37595,"./lv.js":37595,"./me":39861,"./me.js":39861,"./mi":35493,"./mi.js":35493,"./mk":95966,"./mk.js":95966,"./ml":87341,"./ml.js":87341,"./mn":5115,"./mn.js":5115,"./mr":10370,"./mr.js":10370,"./ms":9847,"./ms-my":41237,"./ms-my.js":41237,"./ms.js":9847,"./mt":72126,"./mt.js":72126,"./my":56165,"./my.js":56165,"./nb":64924,"./nb.js":64924,"./ne":16744,"./ne.js":16744,"./nl":93901,"./nl-be":59814,"./nl-be.js":59814,"./nl.js":93901,"./nn":83877,"./nn.js":83877,"./oc-lnc":92135,"./oc-lnc.js":92135,"./pa-in":15858,"./pa-in.js":15858,"./pl":64495,"./pl.js":64495,"./pt":89520,"./pt-br":57971,"./pt-br.js":57971,"./pt.js":89520,"./ro":96459,"./ro.js":96459,"./ru":21793,"./ru.js":21793,"./sd":40950,"./sd.js":40950,"./se":37930,"./se.js":37930,"./si":90124,"./si.js":90124,"./sk":64249,"./sk.js":64249,"./sl":14985,"./sl.js":14985,"./sq":51104,"./sq.js":51104,"./sr":49131,"./sr-cyrl":79915,"./sr-cyrl.js":79915,"./sr.js":49131,"./ss":95606,"./ss.js":95606,"./sv":98760,"./sv.js":98760,"./sw":91172,"./sw.js":91172,"./ta":27333,"./ta.js":27333,"./te":23110,"./te.js":23110,"./tet":52095,"./tet.js":52095,"./tg":27321,"./tg.js":27321,"./th":9041,"./th.js":9041,"./tk":19005,"./tk.js":19005,"./tl-ph":75768,"./tl-ph.js":75768,"./tlh":89444,"./tlh.js":89444,"./tr":72397,"./tr.js":72397,"./tzl":28254,"./tzl.js":28254,"./tzm":51106,"./tzm-latn":30699,"./tzm-latn.js":30699,"./tzm.js":51106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":67691,"./uk.js":67691,"./ur":13795,"./ur.js":13795,"./uz":6791,"./uz-latn":60588,"./uz-latn.js":60588,"./uz.js":6791,"./vi":65666,"./vi.js":65666,"./x-pseudo":14378,"./x-pseudo.js":14378,"./yo":75805,"./yo.js":75805,"./zh-cn":83839,"./zh-cn.js":83839,"./zh-hk":55726,"./zh-hk.js":55726,"./zh-mo":99807,"./zh-mo.js":99807,"./zh-tw":74152,"./zh-tw.js":74152};function F(w){var ye=Y(w);return ae(ye)}function Y(w){if(!ae.o(P,w)){var ye=new Error("Cannot find module '"+w+"'");throw ye.code="MODULE_NOT_FOUND",ye}return P[w]}F.keys=function(){return Object.keys(P)},F.resolve=Y,q.exports=F,F.id=46700}}]);
